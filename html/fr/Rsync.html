<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>rsync (Français) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.3">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Rsync_Français rootpage-Rsync_Français skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Installation</div>
		</a>
		
			<button aria-controls="toc-Installation-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Installation subsection</span>
			</button>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
			<li id="toc-Interfaces" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Interfaces">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1</span>Interfaces</div>
			</a>
			
			<ul id="toc-Interfaces-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Comme_alternative_à_cp/mv" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Comme_alternative_%C3%A0_cp/mv">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Comme alternative à cp/mv</div>
		</a>
		
			<button aria-controls="toc-Comme_alternative_à_cp/mv-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Comme alternative à cp/mv subsection</span>
			</button>
		
		<ul id="toc-Comme_alternative_à_cp/mv-sublist" class="vector-toc-list">
			<li id="toc-Mise_en_garde_sur_la_terminaison_par_slash" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Mise_en_garde_sur_la_terminaison_par_slash">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Mise en garde sur la terminaison par slash</div>
			</a>
			
			<ul id="toc-Mise_en_garde_sur_la_terminaison_par_slash-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Comme_un_utilitaire_de_sauvegarde" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Comme_un_utilitaire_de_sauvegarde">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Comme un utilitaire de sauvegarde</div>
		</a>
		
			<button aria-controls="toc-Comme_un_utilitaire_de_sauvegarde-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Comme un utilitaire de sauvegarde subsection</span>
			</button>
		
		<ul id="toc-Comme_un_utilitaire_de_sauvegarde-sublist" class="vector-toc-list">
			<li id="toc-Sauvegardes_automatisées" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Sauvegardes_automatis%C3%A9es">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>Sauvegardes automatisées</div>
			</a>
			
			<ul id="toc-Sauvegardes_automatisées-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Sauvegarde_automatique_avec_SSH" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Sauvegarde_automatique_avec_SSH">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>Sauvegarde automatique avec SSH</div>
			</a>
			
			<ul id="toc-Sauvegarde_automatique_avec_SSH-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Sauvegarde_automatique_avec_NetworkManager" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Sauvegarde_automatique_avec_NetworkManager">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3</span>Sauvegarde automatique avec NetworkManager</div>
			</a>
			
			<ul id="toc-Sauvegarde_automatique_avec_NetworkManager-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Sauvegarde_automatique_avec_systemd_et_inotify" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Sauvegarde_automatique_avec_systemd_et_inotify">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.4</span>Sauvegarde automatique avec systemd et inotify</div>
			</a>
			
			<ul id="toc-Sauvegarde_automatique_avec_systemd_et_inotify-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Sauvegarde_différentielle_sur_une_semaine" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Sauvegarde_diff%C3%A9rentielle_sur_une_semaine">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.5</span>Sauvegarde différentielle sur une semaine</div>
			</a>
			
			<ul id="toc-Sauvegarde_différentielle_sur_une_semaine-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Sauvegardes_par_instantanés_(Snapshots)" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Sauvegardes_par_instantan%C3%A9s_(Snapshots)">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.6</span>Sauvegardes par instantanés (Snapshots)</div>
			</a>
			
			<ul id="toc-Sauvegardes_par_instantanés_(Snapshots)-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Sauvegarde_système_complète" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Sauvegarde_syst%C3%A8me_compl%C3%A8te">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.7</span>Sauvegarde système complète</div>
			</a>
			
			<ul id="toc-Sauvegarde_système_complète-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Restauration_de_la_sauvegarde" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Restauration_de_la_sauvegarde">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.8</span>Restauration de la sauvegarde</div>
			</a>
			
			<ul id="toc-Restauration_de_la_sauvegarde-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Clonage_du_système_de_fichiers" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Clonage_du_syst%C3%A8me_de_fichiers">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Clonage du système de fichiers</div>
		</a>
		
		<ul id="toc-Clonage_du_système_de_fichiers-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Comme_un_daemon" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Comme_un_daemon">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Comme un daemon</div>
		</a>
		
			<button aria-controls="toc-Comme_un_daemon-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Comme un daemon subsection</span>
			</button>
		
		<ul id="toc-Comme_un_daemon-sublist" class="vector-toc-list">
			<li id="toc-Exemple_de_configuration" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Exemple_de_configuration">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1</span>Exemple de configuration</div>
			</a>
			
			<ul id="toc-Exemple_de_configuration-sublist" class="vector-toc-list">
				<li id="toc-Partage_à_partir_d'une_liste_de_fichiers" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Partage_%C3%A0_partir_d'une_liste_de_fichiers">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.1</span>Partage à partir d'une liste de fichiers</div>
			</a>
			
			<ul id="toc-Partage_à_partir_d'une_liste_de_fichiers-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Voir_aussi" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Voir_aussi">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>Voir aussi</div>
		</a>
		
		<ul id="toc-Voir_aussi-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading">rsync (Français)</h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 6 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-6" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">6 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-de mw-list-item"><a href="https://wiki.archlinux.de/title/Rsync" title="Rsync – Deutsch" lang="de" hreflang="de" class="interlanguage-link-target"><span>Deutsch</span></a></li>
<li class="interlanguage-link interwiki-en mw-list-item"><a href="../en/Rsync.html" title="Rsync – English" lang="en" hreflang="en" class="interlanguage-link-target"><span>English</span></a></li>
<li class="interlanguage-link interwiki-es mw-list-item"><a href="../es/Rsync.html" title="Rsync – español" lang="es" hreflang="es" class="interlanguage-link-target"><span>Español</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Rsync" title="Rsync – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-ru mw-list-item"><a href="../ru/Rsync.html" title="Rsync – русский" lang="ru" hreflang="ru" class="interlanguage-link-target"><span>Русский</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/Rsync" title="Rsync – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="fr" dir="ltr">
<p><span>
</span>
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>État de la traduction:</strong> Cet article est la version francophone de <a href="../en/Rsync.html" title="Rsync">rsync</a>. Date de la dernière traduction: 2022-10-03. Vous pouvez aider à synchroniser la traduction s'il y a eu des <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Rsync&amp;diff=0&amp;oldid=736193">changements</a> dans la version anglaise.</div>
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/System_backup.html" title="System backup">System backup</a></li>
<li><a href="../en/Synchronization_and_backup_programs.html" title="Synchronization and backup programs">Synchronization and backup programs</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://rsync.samba.org/">rsync</a> est un utilitaire open source permettant des transferts de fichiers rapides et incrémentés.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../fr/Help:Reading.html#Installation_de_paquets" class="mw-redirect" title="Installez">Installez</a> le paquet <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=rsync">rsync</a></span>
</p>
<p><i>rsync</i> doit être présent sur les deux machines, source et destination. 
</p>
<h3><span class="mw-headline" id="Interfaces">Interfaces</span></h3>
<ul><li>
<b>Grsync</b> — Une interface GTK+.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://www.opbyte.it/grsync/">https://www.opbyte.it/grsync/</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=grsync">grsync</a></span>
</dd></dl>
<ul><li>
<b>JotaSync</b> — Application graphique en Java Swing avec planificateur intégré.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://trixon.se/projects/jotasync/">https://trixon.se/projects/jotasync/</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/jotasync/">jotasync</a></span><sup><small>AUR</small></sup>
</dd></dl>
<ul><li>
<b>luckyBackup</b> — Interface Qt écrite en C++.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://luckybackup.sourceforge.net/index.html">https://luckybackup.sourceforge.net/index.html</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/luckybackup/">luckybackup</a></span><sup><small>AUR</small></sup>
</dd></dl>
<p>D'autres outils utilisant rsync sont <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/rdiff-backup/">rdiff-backup</a></span><sup><small>AUR</small></sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/osync/">osync</a></span><sup><small>AUR</small></sup> et <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/yarsync/">yarsync</a></span><sup><small>AUR</small></sup>.
</p>
<h2>
<span id="Comme_alternative_.C3.A0_cp.2Fmv"></span><span class="mw-headline" id="Comme_alternative_à_cp/mv">Comme alternative à cp/mv</span>
</h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> L'utilisation de rsync au lieu de cp/mv est efficace sur différents systèmes de fichiers, mais pas pour copier ou déplacer des fichiers sur le même système de fichiers. Consultez <a rel="nofollow" class="external autonumber" href="https://bbs.archlinux.org/viewtopic.php?id=271953">[1]</a>
</div>
<p>rsync peut être utilisé comme alternative avancée aux commandes <code>cp</code> ou<code>mv</code> , particulièrement le transfert de de fichiers volumineux:
</p>
<pre>$ rsync -P source destination
</pre>
<p>L'option <code>-P</code>, soit <code>--partial --progress</code> garde les fichiers partiellement transférés et affiche une barre de progression.
</p>
<p>Pour copier récursivement les sous-répertoires l'option est <code>-r --recursive</code> .
</p>
<p>Les fichiers peuvent être copiés localement comme avec la commande <i>cp</i>, mais le but essentiel de <i>rsync</i> est la copie à distance, c.a.d.. d'un hôte à un autre. 
L'emplacement distant sera signifié par la syntaxe  deux-points <b>:</b> , ex:
</p>
<pre>$ rsync source host:destination
</pre>
<p>ou
</p>
<pre>$ rsync host:source destination
</pre>
<p>Les transferts par le réseau utilisent le protocole <a href="../fr/Secure_Shell.html" title="Secure Shell (Français)">SSH</a> par défaut et <code>host</code> peut être un nom réel d'hôte existant ou un profil/alias prédéfini dans <code>.ssh/config</code>.
</p>
<p>Qu'il s'agisse d'un transfert de fichiers en local ou à distance, Rsync crée d'abord une liste des fichiers avec leurs données (par défaut, taille du fichier et dernier horodatage de modification) qui sera ensuite utilisée pour déterminer si un fichier doit être construit. Pour chaque fichier à construire, une somme de contrôle faible et forte est trouvée pour tous les blocs de sorte que chaque bloc est de longueur <b>S</b> octets, sans chevauchement, et ait un décalage divisible par <b>S</b>. En utilisant cette information, rsync peut construire un fichier de grande taille sans avoir à le transférer en entier. Pour une explication pratique et mathématique détaillée, reportez-vous respectivement au <a rel="nofollow" class="external text" href="https://rsync.samba.org/how-rsync-works.html">fonctionnement de rsync</a> et à <a rel="nofollow" class="external text" href="https://rsync.samba.org/tech_report/tech_report.html">l'algorithme de rsync</a>. 
</p>
<p>Pour utiliser rapidement des valeurs par défaut sensées, vous pouvez utiliser des alias : 
</p>
<pre>cpr() {
 rsync --archive -hh --partial --info=stats1 --info=progress2 --modify-window=1 "$@"
} 
mvr() {
 rsync --archive -hh --partial --info=stats1 --info=progress2 --modify-window=1 --remove-source-files "$@"
}
</pre>
<ul>
<li>
<code>-hh</code> : affiche les chiffres dans un format lisible humainement</li>
<li>
<code>--info=stats1,progress2</code> : <code>stats1</code> affiche les statistiques de transfert rsync avec un niveau de verbosité de 1. <code>progress2</code> imprime la progression totale du transfert par opposition à la progression du transfert par fichier (<code>progress1</code>).</li>
<li>
<code>--modify-window=1</code> : lorsque vous comparez les horodatages de deux fichiers, traitez leurs horodatages comme étant équivalents si leur différence est inférieure à 1 seconde.</li>
<li>
<code>--remove-source-files</code> : supprime les fichiers du répertoire source après qu'ils aient été synchronisés avec succès.</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> L'utilisation du terme <i>checksum</i> <b>n'est pas</b> superposable au comportement  de l'option <code>--checksum</code>. L'option <code>--checksum</code> affecte l'heuristique de saut d'un fichier utilisée avant tout transfert. Indépendamment de <code>--checksum</code>, une <i>somme de contrôle</i> est toujours utilisée pour la construction de fichier par blocs qui est la façon dont rynsc transfère un fichier.</div>
<h3><span class="mw-headline" id="Mise_en_garde_sur_la_terminaison_par_slash">Mise en garde sur la terminaison par slash</span></h3>
<p>Arch Linux utilise par défaut la convention GNU de la commande <i>cp</i> (du paquet <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=coreutils">coreutils</a></span>). Tandis que rsync suit la convention BSD de <i>cp</i>, qui accorde un traitement spécial aux répertoires sources avec barre oblique "/" finale <i>(trailing slash)</i>. Ainsi la commande:
</p>
<pre>$ rsync -r source destination
</pre>
<p>créera le répertoire "destination/source" avec le contenu de "source", alors que la commande:
</p>
<pre>$ rsync -r source/ destination
</pre>
<p>ne copie que les fichiers de "source/" directement dans "destination", sans créer le sous-répertoire "destination/source"  - comme si vous aviez lancé:
</p>
<pre>$ rsync -r source/. destination
</pre>
<p>Ce comportement est différent de celui de GNU/cp, qui traite "source" et "source/" de la même façon (mais non "source/."). De plus certains shells ajoutent automatiquement la barre oblique aux noms des répertoires en cas de complétion par touche &lt;Tab&gt;. En conséquence cette somme de facteurs pourraient amener des utilisateurs nouveaux ou occasionnels de rsync, oubliant ce comportement différent, à désorganiser ou même écraser des répertoires importants par le maintien d'une barre oblique en fin de la &lt;source&gt; dans la commande.
</p>
<p>Aussi il peut être prudent d'envelopper la commande par un script enlevant automatiquement cette barre avant le lancement de rsync:
</p>
<pre>#!/bin/bash
new_args=()
for i in "${@}"; do
    case "${i}" in
        /)
            i="/"
        ;;
        */)
            i="${i%/}"
        ;;
        esac
    new_args+=("${i}")
done
exec rsync "${new_args[@]}"</pre>
<p>Ce script peut être placé quelque part dans le chemin, et aliasé à rsync dans le fichier de démarrage du shell.
</p>
<h2><span class="mw-headline" id="Comme_un_utilitaire_de_sauvegarde">Comme un utilitaire de sauvegarde</span></h2>
<p>Le protocole rsync est facile à utiliser pour les tâches de sauvegarde, ne transférant que les fichiers modifiés depuis la précédente sauvegarde.
Ce paragraphe décrit une sauvegarde programmée très simple avec un script utilisant <i>rsync</i>,  typiquement utilisé lors de copies sur un support amovible.
</p>
<h3>
<span id="Sauvegardes_automatis.C3.A9es"></span><span class="mw-headline" id="Sauvegardes_automatisées">Sauvegardes automatisées</span>
</h3>
<p>Pour les besoins de cet exemple, le script est créé dans le répertoire <code>/etc/cron.daily</code>, pour se lancer chaque jour si le <a href="../fr/Systemd.html" class="mw-redirect" title="Daemon (Français)">daemon</a> cron est installé et correctement configuré. Configurer et utiliser <a href="../fr/Cron.html" title="Cron (Français)">cron</a> n'appartient pas à cet article. 
</p>
<p>D'abord, créer un script avec les options de commande appropriées:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/cron.daily/backup</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh
rsync -a --delete --quiet /path/to/backup /location/of/backup</pre>
<ul>
<li>
<code>-a</code> : indique quels fichiers doivent être archivés, entendu que la plupart de leurs attributs soient préservés (mais <b>non</b> les ACLs, liens matériels (hard links), ni attributs étendus tels les capabilités.</li>
<li>
<code>--delete</code> : signifie que les fichiers supprimés sur la source doivent également être supprimés sur la sauvegarde.</li>
</ul>
<p>Ici, <code>/path/to/backup</code> sera remplacé par le chemin des données à sauvegarder (<code>/home</code>, par exemple) et <code>/location/of/backup</code> sera le chemin de destination de la sauvegarde (<code>/media/disk</code>, par exemple).
</p>
<p>Terminer en rendant le script <a href="../fr/Help:Reading.html#Rendre_ex%C3%A9cutable" class="mw-redirect" title="Exécutable">exécutable</a>
</p>
<h3><span class="mw-headline" id="Sauvegarde_automatique_avec_SSH">Sauvegarde automatique avec SSH</span></h3>
<p>Si vous sauvegardez sur un hôte distant en utilisant <a href="../fr/Secure_Shell.html" title="Secure Shell (Français)">SSH</a>, utilisez ce script à la place : 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/cron.daily/backup</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash
rsync -a --delete --quiet -e ssh /folder/to/backup remoteuser@remotehost:/location/of/backup
</pre>
<ul>
<li>
<code>-e ssh</code> : indique à rsync d'utiliser SSH</li>
<li>
<code>remoteuser</code> : est le nom de l'hôte distant <code>remotehost</code>
</li>
<li>
<code>-a</code> : regroupe les options <code>-rlptgoD</code> (recursive, links, perms, times, group, owner, devices)</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
Rsync essaiera de modifier tous les fichiers précédemment sauvegardés sur la machine cible pour qu'ils correspondent à leur état actuel sur la machine source, à chaque sauvegarde incrémentale. Cela signifie que lors de la sauvegarde de fichiers appartenant à root via SSH (et lors de la préservation des permissions et des propriétaires, comme avec l'option <code>-a</code>), un accès root à la machine cible est nécessaire. La meilleure façon d'y parvenir pour l'automatisation est de configurer le daemon SSH pour permettre à root de se connecter à l'aide d'une <a rel="nofollow" class="external text" href="https://unix.stackexchange.com/a/92397">clé publique sans mot de passe</a> et d'exécuter la commande rsync en tant que root.</div>
<h3><span class="mw-headline" id="Sauvegarde_automatique_avec_NetworkManager">Sauvegarde automatique avec NetworkManager</span></h3>
<p>Ce script démarre une sauvegarde après connexion au réseau.
</p>
<p>D'abord, créez un script avec les options de commande appropriées:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/NetworkManager/dispatcher.d/backup</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash

if [ x"$2" = "xup" ] ; then
        rsync --force --ignore-errors -a --delete --bwlimit=2000 --files-from=files.rsync /path/to/backup /location/of/backup
fi</pre>
<ul>
<li>
<code>-a</code> : groupe toutes les options <code>-rlptgoD</code> recursive, links, perms, times, group, owner, devices</li>
<li>
<code>--files-from</code> : lire le chemin relatif de <i>/path/to/backup</i> à partir de ce fichier</li>
<li>
<code>--bwlimit</code> : limite la bande passante E/S; Kilo-octets par seconde</li>
</ul>
<p>Le script doit appartenir à root (consultez <a href="../fr/NetworkManager.html#Services_r%C3%A9seau_avec_le_r%C3%A9partiteur_NetworkManager" title="NetworkManager (Français)">NetworkManager (Français)#Services réseau avec le répartiteur NetworkManager</a> pour plus de détails).
</p>
<h3><span class="mw-headline" id="Sauvegarde_automatique_avec_systemd_et_inotify">Sauvegarde automatique avec systemd et inotify</span></h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>Du fait des limitations de systemd et inotify (voir <a rel="nofollow" class="external text" href="https://www.quora.com/Linux-Kernel/Inotify-monitoring-of-directories-is-not-recursive-Is-there-any-specific-reason-for-this-design-in-Linux-kernel">cette question et réponse</a>), la surveillance récursive du système de fichiers n'est pas possible. Bien que vous puissiez surveiller un répertoire et son contenu, il n'effectuera pas de récursion dans les sous-répertoires et ne surveillera pas leur contenu ; vous devez spécifier explicitement chaque répertoire à surveiller, même si ce répertoire est l'enfant d'un répertoire déjà surveillé.</li>
<li>Cette configuration est basée sur une instance de <a href="../fr/Systemd/User.html" title="Systemd (Français)/User (Français)">systemd (Français)/User (Français)</a>.</li>
</ul>
</div>
<ul><li>Au lieu d'exécuter des sauvegardes avec une programmation basée sur des intervalles temporels, comme avec <a href="../fr/Cron.html" title="Cron (Français)">cron</a>, il est possible d'exécuter une sauvegarde à chaque modification d'un des fichiers à sauvegarder.</li></ul>
<p>Les unités de chemin <code>systemd.path</code> utilisent <code>inotify</code> pour surveiller le système de fichiers, en conjonction avec des fichiers <code>systemd.service</code> pour démarrer n'importe quel processus (dans ce cas, votre sauvegarde rsync) basé alors sur un événement dans le système de fichiers.
</p>
<p>D'abord, créez l'unité de chemin <code>systemd.path</code>, lançant la surveillance des fichiers à sauvegarder:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/systemd/user/backup.path</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Vérification dans les chemins de changements dans les répertoires à sauvegarder

[Path]
PathChanged=%h/documents
PathChanged=%h/music

[Install]
WantedBy=default.target
</pre>
<p>Puis le service <code>systemd.service</code> qui sera activé par toute modification. Par défaut, un fichier de service du même nom que l'unité path (dans ce cas <code>backup.path</code>) sera activé, mais avec l'extension <code>.service</code> au lieu de <code>.path</code> (dans notre cas <code>backup.service</code>).
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Si vous avez besoin de lancer plusieurs commandes rsync, utilisez <code>Type=oneshot</code>. ceci vous permettra de spécifier de multiples paramètres <code>ExecStart=</code>, un pour chaque commande rsync, qui sera exécuté. Alternativement, vous pouvez créer un script pour effectuer toutes vos sauvegardes, exactement comme un script <a href="../fr/Cron.html" title="Cron (Français)">cron</a>.</div>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/systemd/user/backup.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Sauvagarde les fichiers

[Service]
ExecStart=/usr/bin/rsync %h/./documents %h/./music -CERrltm --delete ubuntu:
</pre>
<p>Maintenant <a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Activez">activez</a> et <a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Démarrez">démarrez</a> simplement <code>backup.path</code> comme un service systemd normal et il commencera à surveiller les changements de fichiers et démarrera automatiquement <code>backup.service</code>.
</p>
<h3>
<span id="Sauvegarde_diff.C3.A9rentielle_sur_une_semaine"></span><span class="mw-headline" id="Sauvegarde_différentielle_sur_une_semaine">Sauvegarde différentielle sur une semaine</span>
</h3>
<p>Autre possibilité utile des option de rsync, qui permet d'obtenir une sauvegarde complète (à chaque exécution) et de conserver une copie de sauvegarde différentielle des fichiers modifiés uniquement dans un répertoire distinct pour chaque jour de la semaine.
</p>
<p>D'abord, créez un script avec les options de commande appropriées:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/cron.daily/backup</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash

DAY=$(date +%A)

if [ -e /location/to/backup/incr/$DAY ] ; then
  rm -fr /location/to/backup/incr/$DAY
fi

rsync -a --delete --quiet --inplace --backup --backup-dir=/location/to/backup/incr/$DAY /folder/to/backup/ /location/to/backup/full/</pre>
<p>L'option <code>--inplace</code> implique <code>--partial</code> et met à jour les fichiers en place dans le répertoire de destination.
</p>
<h3>
<span id="Sauvegardes_par_instantan.C3.A9s_.28Snapshots.29"></span><span class="mw-headline" id="Sauvegardes_par_instantanés_(Snapshots)">Sauvegardes par instantanés (Snapshots)</span>
</h3>
<p>La même démarche peut servir au maintien d'un arbre d'instantanés de vos fichiers. Autrement dit, un répertoire avec des copies des fichiers rangées par date. Ces copies seront faites par utilisation de liens matériels (<i>hard links</i>, attribution d'un seul i-nœud) ce qui signifie que seuls les fichiers modifiés occuperont un espace supplémentaire. D'une manière générale, c'est l'idée qui sous-tend les TimeMachine d'Apple.
</p>
<p>Ce script de base est facile à implémenter, il crée des snapshots incrémentaux rapides en utilisant l'option <code>--link-dest</code> pour lier des fichiers non modifiés: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/local/bin/snapbackup.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh

# Basic snapshot-style rsync backup script 

# Configurer
OPT="-aPh"
LINK="--link-dest=/snapshots/username/last/" 
SRC="/home/username/files/"
SNAP="/snapshots/username/"
LAST="/snapshots/username/last"
date=`date "+%Y-%b-%d:_%T"`

# Lancement de rsync pour créer un instantanét
rsync $OPT $LINK $SRC ${SNAP}$date

# Suppression du lien symbolique vers l'instantané précédent
rm -f $LAST

# Création d'un nouveau lien symbolique vers le dernier instantané pour le lien matériel vers la prochaine sauvegarde 
ln -s ${SNAP}$date $LAST
</pre>
<p>Il doit y avoir un lien symbolique vers une sauvegarde complète déjà existante en tant que cible pour <code>--link-dest</code>. En cas d'effacement du plus récent des instantanés il faut recréer un lien symbolique vers le plus récent suivant. Si <code>--link-dest</code> ne trouve pas de lien symbolique fonctionnel, rsync devra re-copier la source entière au lieu des seuls fichiers modifiés. 
</p>
<p>Une version plus sophistiquée conserve une sauvegarde complète à jour <code>$SNAP/latest</code> et dans le cas où un certain nombre de fichiers ont été modifiés depuis la dernière sauvegarde complète, elle crée un instantané <code>$SNAP/$DATETAG</code> de la sauvegarde complète actuelle en utilisant <code>cp -al</code> pour lier les fichiers inchangés :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/local/bin/rsnapshot.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh

## my own rsync-based snapshot-style backup procedure
## (cc) marcio rps AT gmail.com

# config vars

SRC="/home/username/files/" #ne PAS oublier la barre oblique finale !
SNAP="/snapshots/username"
OPTS="-rltgoi --delay-updates --delete --chmod=a-w"
MINCHANGES=20

# lancer le processus avec une priorité vraiment basse

ionice -c 3 -p $$
renice +12  -p $$

# synchronisation

rsync $OPTS $SRC $SNAP/latest &gt;&gt; $SNAP/rsync.log

# test d'un nombre suffisant de fichiers modifiés
# création d'une copie en lien matériel nommée avec la date

COUNT=$( wc -l $SNAP/rsync.log|cut -d" " -f1 )
if [ $COUNT -gt $MINCHANGES ] ; then
        DATETAG=$(date +%Y-%m-%d)
        if [ ! -e $SNAP/$DATETAG ] ; then
                cp -al $SNAP/latest $SNAP/$DATETAG
                chmod u+w $SNAP/$DATETAG
                mv $SNAP/rsync.log $SNAP/$DATETAG
               chmod u-w $SNAP/$DATETAG
         fi
fi
</pre>
<p>Pour faire très très simple ce script peut-être lancé depuis une unité <a href="../fr/Systemd/Timers.html#Unit%C3%A9s_timer" title="Systemd (Français)/Timers (Français)">systemd/Timers</a>.
</p>
<h3>
<span id="Sauvegarde_syst.C3.A8me_compl.C3.A8te"></span><span class="mw-headline" id="Sauvegarde_système_complète">Sauvegarde système complète</span>
</h3>
<p>Cette section concerne l'utilisation de <i>rsync</i> pour transférer une copie de l'arborescence <code>/</code> entière, à l'exception de quelques répertoires sélectionnés. Cette approche est considérée comme meilleure que le <a href="../en/Disk_cloning.html" title="Disk cloning">clonage de disque</a> avec <code>dd</code> car elle permet d'utiliser une taille, une table de partition et un système de fichiers différents, et meilleure que la copie avec <code>cp -a</code> également, car elle permet un meilleur contrôle des permissions de fichiers, des attributs, des listes de contrôle des accès (<a href="../en/Access_Control_Lists.html" class="mw-redirect" title="ACL">ACL</a>) et des <a href="../en/File_permissions_and_attributes.html#Extended_attributes" title="File permissions and attributes">attributs étendus</a>.
</p>
<p><i>rsync</i> fonctionnera même lorsque le système est en cours d'exécution, mais les fichiers modifiés pendant le transfert peuvent ou non être transférés, ce qui peut entraîner un comportement indéfini de certains programmes utilisant les fichiers transférés.
</p>
<p>Cette approche fonctionne bien pour migrer une installation existante vers un nouveau disque dur ou <a href="../en/Solid_state_drive.html" class="mw-redirect" title="Solid state drive (Français)">SSD</a>.
</p>
<p>Exécutez la commande suivante en tant que root pour vous assurer que rsync peut accéder à tous les fichiers système et en préserver la propriété :
</p>
<pre># rsync -aAXv --exclude={"/dev/*","/proc/*","/sys/*","/tmp/*","/run/*","/mnt/*","/media/*","/home/*","/lost+found"} / /path/to/backup/directory
</pre>
<p>Les options <code>-aAX</code>, définissent un transfert en mode archive avec conservation des liens symboliques, des périphériques rattachés, autorisations et propriétés, dates de modification, <a href="../en/Access_Control_Lists.html" class="mw-redirect" title="ACL">ACLs</a> et attributs étendus (à condition que le <a href="../en/File_systems.html" class="mw-redirect" title="File system">système de fichiers</a> cible prenne en charge ces fonctions. L'option <code>-H</code> préserve les liens matériels mais consomme plus de mémoire. 
</p>
<p>L'option <code>--exclude</code> définit les fichiers à exclure, correspondant aux motifs définis. Les répertoires <code>/dev</code>, <code>/proc</code>, <code>/sys</code>, <code>/tmp</code>, et <code>/run</code> sont inclus dans la commande ci-dessus, mais le <i>contenu</i> de ces répertoires est exclu. Cela est dû au fait qu'ils sont remplis au démarrage, mais que les répertoires eux-mêmes ne sont pas créés. <code>/lost+found</code> est spécifique au système de fichiers. La commande ci-dessus dépend de l'expansion des accolades disponible dans les shells <a rel="nofollow" class="external text" href="https://www.gnu.org/software/bash/manual/html_node/Brace-Expansion.html">bash</a> et <a rel="nofollow" class="external text" href="https://zsh.sourceforge.net/Doc/Release/Expansion.html#Brace-Expansion">zsh</a>. Si vous utilisez un autre <a href="../en/Command-line_shell.html" class="mw-redirect" title="Shell">shell</a>, les motifs <code>--exclude</code> doivent être répétés manuellement. Citer les motifs d'exclusion évitera l'expansion par le <a href="../en/Command-line_shell.html" class="mw-redirect" title="Shell">shell</a>, ce qui est nécessaire, par exemple, lors de la sauvegarde via <a href="../fr/Secure_Shell.html" title="Secure Shell (Français)">SSH</a>. Terminer les chemins exclus par <code>*</code> garantit que les répertoires eux-mêmes sont créés s'ils n'existent pas déjà.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>Si vous prévoyez de sauvegarder votre système ailleurs que dans <code>/mnt</code> ou <code>/media</code>, n'oubliez pas de l'ajouter à la liste des motifs d'exclusion pour éviter une boucle infinie.</li>
<li>S'il y a des montages bind dans le système, ils doivent être exclus également afin que le contenu du montage bind ne soit copié qu'une seule fois.</li>
<li>Si vous utilisez un <a href="../fr/Swap.html#Fichier_d'%C3%A9change" class="mw-redirect" title="Fichier d'échange">fichier d'échange</a>, assurez-vous de l'exclure également.</li>
<li>Réfléchissez si vous voulez sauvegarder le répertoire <code>/home/</code>. S'il contient vos données, il peut être considérablement plus grand que le système. Sinon, pensez à exclure les sous-répertoires sans importance tels que <code>/home/*/.thumbnails/*</code>, <code>/home/*/.cache/mozilla/*</code>, <code>/home/*/.cache/chromium/*</code>, et <code>/home/*/.local/share/Trash/*</code>, en fonction des logiciels installés sur le système.</li>
<li>Si <a href="../en/File_manager_functionality.html#Mounting" class="mw-redirect" title="GVFS">GVFS</a> est installé, <code>/home/*/.gvfs</code> doit être exclu pour éviter les erreurs de rsync.</li>
<li>Si <a href="../en/Dhcpcd.html" title="Dhcpcd">Dhcpcd</a> ≥ 9.0.0 est installé, excluez le répertoire <code>/var/lib/dhcpcd/*</code> car il y monte plusieurs répertoires système en tant que sous-répertoires.</li>
</ul>
</div>
<p>Vous pouvez inclure des options rsync supplémentaires, ou en supprimer certaines, comme les suivantes. Consultez <span class="plainlinks archwiki-template-man" title="$ man 1 rsync"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/rsync.1">rsync(1)</a></span> pour la liste complète.
</p>
<ul>
<li>Si vous travaillez sur un système avec très peu de mémoire, envisagez de supprimer l'option <code>-H</code> ; cependant, cela ne devrait pas poser de problème sur la plupart des machines modernes. Il peut y avoir de nombreux liens durs sur le système de fichiers en fonction du logiciel utilisé (par exemple, si vous utilisez <a href="../en/Flatpak.html" title="Flatpak">Flatpak</a>). De nombreux liens durs résident dans le répertoire <code>/usr/</code>.</li>
<li>Vous pouvez ajouter l'option <code>--delete</code> de rsync si vous l'exécutez plusieurs fois dans le même répertoire de sauvegarde. Dans ce cas, assurez-vous que le chemin d'accès à la source ne se termine pas par <code>/*</code>, ou cette option n'aura d'effet que sur les fichiers situés dans les sous-répertoires du répertoire source, mais elle n'aura aucun effet sur les fichiers résidant directement dans le répertoire source.</li>
<li>Si vous utilisez des fichiers épars, tels que des disques virtuels, des images <a href="../en/Docker.html" title="Docker">Docker</a> et autres, vous devez ajouter l'option <code>-S</code>.</li>
<li>L'option <code>--numeric-ids</code> désactivera le mappage des noms d'utilisateurs et de groupes ; à la place, les ID numériques des groupes et des utilisateurs seront transférés. Ceci est utile lors de la sauvegarde via <a href="../fr/Secure_Shell.html" title="Secure Shell (Français)">SSH</a> ou lors de l'utilisation d'un système actif pour sauvegarder un disque système différent.</li>
<li>Choisir l'option <code>--info=progress2</code> au lieu de <code>-v</code> montrera l'information de progression globale et la vitesse de transfert au lieu de la liste des fichiers en cours de transfert.</li>
<li>Pour éviter de traverser une frontière de système de fichiers lors d'une récursion, ajoutez l'option <code>-x</code>/<code>--one-file-system</code>. Ceci empêchera la sauvegarde de tout point de montage dans la hiérarchie.</li>
</ul>
<h3><span class="mw-headline" id="Restauration_de_la_sauvegarde">Restauration de la sauvegarde</span></h3>
<p>Si vous souhaitez restaurer la sauvegarde, utilisez la même commande rsync que précédemment, mais en inversant source et destination.
</p>
<h2>
<span id="Clonage_du_syst.C3.A8me_de_fichiers"></span><span class="mw-headline" id="Clonage_du_système_de_fichiers">Clonage du système de fichiers</span>
</h2>
<p>rsync fournit le moyen de copier toutes les données d'un système de fichiers en préservant autant d'information que possible, y compris les metadata du système. C'est une procédure de clonage de données au niveau du système de fichiers où les systèmes de fichiers source et destination n'ont pas besoin d'être du même type. Il peut être utilisé pour la sauvegarde, la migration de systèmes de fichiers ou la récupération de données.
</p>
<p>Le mode <i>archive</i> de rsync (option <b>-a</b>) est presque adapté à cette tâche, sauf qu'il ne sauvegarde pas les métadonnées spéciales du système de fichiers telles que les listes de contrôle d'accès, les attributs étendus ou les propriétés de fichiers éparses. Pour un clonage réussi au niveau du système de fichiers, certaines options supplémentaires doivent être fournies:
</p>
<pre>rsync -qaHAXS SOURCE_DIR DESTINATION_DIR
</pre>
<p>Ce qui signifie (selon la page de manuel):
</p>
<pre>-H, --hard-links      preserve hard links
-A, --acls            preserve ACLs (implies --perms)
-X, --xattrs          preserve extended attributes
-S, --sparse          handle sparse files efficiently
</pre>
<p>De plus, utilisez <code>-x</code> si vous avez d'autres systèmes de fichiers montés sous l'arbre que vous voulez exclure de la copie.
La copie produite peut être simplement relue et vérifiée (par exemple après une tentative de récupération de données) au niveau du système de fichiers avec l'option récursive de <code>diff</code>:
</p>
<pre>diff -r SOURCE_DIR DESTINATION_DIR
</pre>
<p>Il est possible d'effectuer une migration réussie du système de fichiers en utilisant rsync comme décrit ici puis en mettant à jour les paramètres <a href="../fr/Fstab.html" title="Fstab (Français)">fstab</a> et <a href="../fr/Arch_boot_process.html#Chargeur_d'amor%C3%A7age" class="mw-redirect" title="Chargeur d'amorçage">chargeur d'amorçage</a> comme décrit dans <a href="../en/Migrate_installation_to_new_hardware.html" title="Migrate installation to new hardware">Migrer une installation vers un nouveau matériel (en)</a>. Ceci fournit essentiellement un moyen de convertir n'importe quel système de fichiers racine à un autre.
</p>
<h2><span class="mw-headline" id="Comme_un_daemon">Comme un daemon</span></h2>
<p><i>rsync</i> peut-être lancé en tant que <a href="../fr/Systemd.html" class="mw-redirect" title="Daemons (Français)">daemon</a> sur un serveur, à l'écoute du port <code>873</code>.
</p>
<p>Editez le modèle <code>/etc/rsyncd.conf</code>, configurez un partage et <a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Démarrez">démarrez</a> le <code>rsyncd.service</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> A partir de <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=rsync">rsync</a></span> 3.2.0-1, le paquet a adopté les fichiers d'unitées systemd en amont <code>rsyncd.service</code> et <code>rsyncd@.service</code>. Le changement pour <code>ProtectHome</code> a été commenté, la fonction de sécurité <code>ProtectSystem=full</code> sous la section <code>[Service]</code> est toujours active. Cela rend les répertoires <code>/boot/</code>, <code>/etc/</code> et <code>/usr/</code> en lecture seule. Si vous avez besoin que rsyncd écrive les répertoires système, <a href="../fr/Systemd.html#Modifier_les_unit%C3%A9s_fournies" class="mw-redirect" title="Éditez">éditez</a> l'unité et définissez <code>ProtectSystem=off</code> dans la section <code>[Service]</code> du snippet overriding.</div>
<p>Utilisation depuis le client, par exemple lister le contenu du serveur:
</p>
<pre>$ rsync rsync://<i>server/share</i>
</pre>
<p>transférer le fichier du client au serveur:
</p>
<pre>$ rsync <i>local-file</i> rsync://<i>server/share/</i>
</pre>
<p>Penser à ouvrir le port <code>873</code> dans iptables et l'authentification utilisateur.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Toutes les données transférées, y compris l'authentification de l'utilisateur, ne sont pas chiffrées.</div>
<h3><span class="mw-headline" id="Exemple_de_configuration">Exemple de configuration</span></h3>
<h4>
<span id="Partage_.C3.A0_partir_d.27une_liste_de_fichiers"></span><span class="mw-headline" id="Partage_à_partir_d'une_liste_de_fichiers">Partage à partir d'une liste de fichiers</span>
</h4>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/rsyncd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...

# Nécessaire pour traverser les frontières du système de fichiers.
#use chroot = no
read only = oui

...

[sync]
    path = /
# Liste des fichiers à copier.
    include from = /backup.list
# Exclure le reste.
    exclude = *</pre>
<p>Dans la liste de fichiers, tous les <i>chemins intermédiaires</i> sont nécessaires, sauf lorsque le caractère générique <code>***</code> est utilisé :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/backup.list</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/etc/
/etc/conf.d/
/etc/conf.d/hwclock
/etc/fonts/***
</pre>
<h2><span class="mw-headline" id="Voir_aussi">Voir aussi</span></h2>
<ul>
<li>D'autres exemples d'utilisation peuvent être trouvées sur <a rel="nofollow" class="external text" href="https://rsync.samba.org/examples.html">la page du projet</a>, dans les <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewforum.php?id=27">Community Contributions</a>, et <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewforum.php?id=33">General Programming</a> forums</li>
<li>
<a rel="nofollow" class="external text" href="https://www.pointsoftware.ch/en/howto-local-and-remote-snapshot-backup-using-rsync-with-hard-links/">Howto – local and remote snapshot backup using rsync with hard links</a> Inclut la déduplication des fichiers avec des liens matériels, la vérification d'intégrité par somme-MD5 et integrité de signature, protection par 'chattr' , règles de filtrage, quota de disques, politique de rétention avec une distribution exponentielle (rotation des sauvegardes tout en sauvegardant des sauvegardes plus récentes que les anciennes)</li>
<li><a rel="nofollow" class="external text" href="https://stackoverflow.com/questions/5527068/how-do-you-use-an-identity-file-with-rsync">Usage des fichiers/clés d'identification SSH avec rsync</a></li>
<li>
<a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=141781">Fil de discussion du forum international</a> sur les Sauvegardes</li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../fr/Category:Synchronization.html" title="Category:Synchronization (Français)">Synchronization (Français)</a></li>
<li><a href="../fr/Category:Backup.html" title="Category:Backup (Français)">Backup (Français)</a></li>
<li><a href="../fr/Category:Commands.html" title="Category:Commands (Français)">Commands (Français)</a></li>
</ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Rsync_(Fran%C3%A7ais)&amp;oldid=813146">https://wiki.archlinux.org/index.php?title=Rsync_(Français)&amp;oldid=813146</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 29 July 2024, at 06:35.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
