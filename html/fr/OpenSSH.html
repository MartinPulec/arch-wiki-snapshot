<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>OpenSSH (Français) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-OpenSSH_Français rootpage-OpenSSH_Français skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Installation</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Utilisation_du_client" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Utilisation_du_client">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Utilisation du client</div>
		</a>
		
			<button aria-controls="toc-Utilisation_du_client-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Utilisation du client subsection</span>
			</button>
		
		<ul id="toc-Utilisation_du_client-sublist" class="vector-toc-list">
			<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configuration">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Configuration</div>
			</a>
			
			<ul id="toc-Configuration-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Utilisation_du_serveur" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Utilisation_du_serveur">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Utilisation du serveur</div>
		</a>
		
			<button aria-controls="toc-Utilisation_du_serveur-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Utilisation du serveur subsection</span>
			</button>
		
		<ul id="toc-Utilisation_du_serveur-sublist" class="vector-toc-list">
			<li id="toc-Configuration_2" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configuration_2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>Configuration</div>
			</a>
			
			<ul id="toc-Configuration_2-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Gestion_des_daemons" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Gestion_des_daemons">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>Gestion des daemons</div>
			</a>
			
			<ul id="toc-Gestion_des_daemons-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Protection" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Protection">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3</span>Protection</div>
			</a>
			
			<ul id="toc-Protection-sublist" class="vector-toc-list">
				<li id="toc-Forcer_l'authentification_par_clé_publique" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Forcer_l'authentification_par_cl%C3%A9_publique">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.1</span>Forcer l'authentification par clé publique</div>
			</a>
			
			<ul id="toc-Forcer_l'authentification_par_clé_publique-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Authentification_à_deux_facteurs_et_clés_publiques" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Authentification_%C3%A0_deux_facteurs_et_cl%C3%A9s_publiques">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.2</span>Authentification à deux facteurs et clés publiques</div>
			</a>
			
			<ul id="toc-Authentification_à_deux_facteurs_et_clés_publiques-sublist" class="vector-toc-list">
				<li id="toc-Fournisseurs_d'authentification" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Fournisseurs_d'authentification">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.2.1</span>Fournisseurs d'authentification</div>
			</a>
			
			<ul id="toc-Fournisseurs_d'authentification-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Configuration_de_PAM" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Configuration_de_PAM">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.2.2</span>Configuration de PAM</div>
			</a>
			
			<ul id="toc-Configuration_de_PAM-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Protection_contre_les_attaques_par_force_brute" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Protection_contre_les_attaques_par_force_brute">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.3</span>Protection contre les attaques par force brute</div>
			</a>
			
			<ul id="toc-Protection_contre_les_attaques_par_force_brute-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Limiter_la_connexion_root" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Limiter_la_connexion_root">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.4</span>Limiter la connexion root</div>
			</a>
			
			<ul id="toc-Limiter_la_connexion_root-sublist" class="vector-toc-list">
				<li id="toc-Refuser" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Refuser">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.4.1</span>Refuser</div>
			</a>
			
			<ul id="toc-Refuser-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Restreindre" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Restreindre">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.4.2</span>Restreindre</div>
			</a>
			
			<ul id="toc-Restreindre-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Verrouillage_du_fichier_authorized_keys" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Verrouillage_du_fichier_authorized_keys">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.5</span>Verrouillage du fichier authorized_keys</div>
			</a>
			
			<ul id="toc-Verrouillage_du_fichier_authorized_keys-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Trucs_et_astuces" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Trucs_et_astuces">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Trucs et astuces</div>
		</a>
		
			<button aria-controls="toc-Trucs_et_astuces-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Trucs et astuces subsection</span>
			</button>
		
		<ul id="toc-Trucs_et_astuces-sublist" class="vector-toc-list">
			<li id="toc-Tunnel_SOCKS_chiffré" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Tunnel_SOCKS_chiffr%C3%A9">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>Tunnel SOCKS chiffré</div>
			</a>
			
			<ul id="toc-Tunnel_SOCKS_chiffré-sublist" class="vector-toc-list">
				<li id="toc-Étape_1_:_démarrer_la_connexion" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%C3%89tape_1_:_d%C3%A9marrer_la_connexion">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1.1</span>Étape 1 : démarrer la connexion</div>
			</a>
			
			<ul id="toc-Étape_1_:_démarrer_la_connexion-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Étape_2_(Variante_A)_:_configurez_votre_navigateur_(ou_d'autres_programmes)" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%C3%89tape_2_(Variante_A)_:_configurez_votre_navigateur_(ou_d'autres_programmes)">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1.2</span>Étape 2 (Variante A) : configurez votre navigateur (ou d'autres programmes)</div>
			</a>
			
			<ul id="toc-Étape_2_(Variante_A)_:_configurez_votre_navigateur_(ou_d'autres_programmes)-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Étape_2_(Variante_B)_:_configurer_une_interface_TUN_locale" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%C3%89tape_2_(Variante_B)_:_configurer_une_interface_TUN_locale">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1.3</span>Étape 2 (Variante B) : configurer une interface TUN locale</div>
			</a>
			
			<ul id="toc-Étape_2_(Variante_B)_:_configurer_une_interface_TUN_locale-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Déport_d'affichage_X11" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#D%C3%A9port_d'affichage_X11">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2</span>Déport d'affichage X11</div>
			</a>
			
			<ul id="toc-Déport_d'affichage_X11-sublist" class="vector-toc-list">
				<li id="toc-Configuration_3" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Configuration_3">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2.1</span>Configuration</div>
			</a>
			
			<ul id="toc-Configuration_3-sublist" class="vector-toc-list">
				<li id="toc-A_distance" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#A_distance">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2.1.1</span>A distance</div>
			</a>
			
			<ul id="toc-A_distance-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Client" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Client">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2.1.2</span>Client</div>
			</a>
			
			<ul id="toc-Client-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Utilisation" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Utilisation">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2.2</span>Utilisation</div>
			</a>
			
			<ul id="toc-Utilisation-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Transfert_d'autres_ports" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Transfert_d'autres_ports">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.3</span>Transfert d'autres ports</div>
			</a>
			
			<ul id="toc-Transfert_d'autres_ports-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Hôtes_de_saut" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#H%C3%B4tes_de_saut">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4</span>Hôtes de saut</div>
			</a>
			
			<ul id="toc-Hôtes_de_saut-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Inverser_SSH_à_travers_un_relais" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Inverser_SSH_%C3%A0_travers_un_relais">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.5</span>Inverser SSH à travers un relais</div>
			</a>
			
			<ul id="toc-Inverser_SSH_à_travers_un_relais-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Multiplexage" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Multiplexage">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.6</span>Multiplexage</div>
			</a>
			
			<ul id="toc-Multiplexage-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Accélérer_SSH" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Acc%C3%A9l%C3%A9rer_SSH">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.7</span>Accélérer SSH</div>
			</a>
			
			<ul id="toc-Accélérer_SSH-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Montage_d'un_système_de_fichiers_distant_avec_SSHFS" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Montage_d'un_syst%C3%A8me_de_fichiers_distant_avec_SSHFS">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.8</span>Montage d'un système de fichiers distant avec SSHFS</div>
			</a>
			
			<ul id="toc-Montage_d'un_système_de_fichiers_distant_avec_SSHFS-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Maintenir_en_vie" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Maintenir_en_vie">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.9</span>Maintenir en vie</div>
			</a>
			
			<ul id="toc-Maintenir_en_vie-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Redémarrer_automatiquement_les_tunnels_SSH_avec_systemd" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Red%C3%A9marrer_automatiquement_les_tunnels_SSH_avec_systemd">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.10</span>Redémarrer automatiquement les tunnels SSH avec systemd</div>
			</a>
			
			<ul id="toc-Redémarrer_automatiquement_les_tunnels_SSH_avec_systemd-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Autossh_-_redémarrer_automatiquement_les_sessions_et_tunnels_SSH" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Autossh_-_red%C3%A9marrer_automatiquement_les_sessions_et_tunnels_SSH">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.11</span>Autossh - redémarrer automatiquement les sessions et tunnels SSH</div>
			</a>
			
			<ul id="toc-Autossh_-_redémarrer_automatiquement_les_sessions_et_tunnels_SSH-sublist" class="vector-toc-list">
				<li id="toc-Lancer_automatiquement_autossh_au_démarrage_via_systemd" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Lancer_automatiquement_autossh_au_d%C3%A9marrage_via_systemd">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.11.1</span>Lancer automatiquement autossh au démarrage via systemd</div>
			</a>
			
			<ul id="toc-Lancer_automatiquement_autossh_au_démarrage_via_systemd-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Service_alternatif_en_cas_d'échec_du_daemon_SSH" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Service_alternatif_en_cas_d'%C3%A9chec_du_daemon_SSH">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.12</span>Service alternatif en cas d'échec du daemon SSH</div>
			</a>
			
			<ul id="toc-Service_alternatif_en_cas_d'échec_du_daemon_SSH-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Couleur_de_fond_du_terminal_basée_sur_l'hôte" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Couleur_de_fond_du_terminal_bas%C3%A9e_sur_l'h%C3%B4te">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.13</span>Couleur de fond du terminal basée sur l'hôte</div>
			</a>
			
			<ul id="toc-Couleur_de_fond_du_terminal_basée_sur_l'hôte-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Configuration_spécifique_au_réseau" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configuration_sp%C3%A9cifique_au_r%C3%A9seau">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.14</span>Configuration spécifique au réseau</div>
			</a>
			
			<ul id="toc-Configuration_spécifique_au_réseau-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Vérification_des_clés_d'hôtes_des_réseaux_privés" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#V%C3%A9rification_des_cl%C3%A9s_d'h%C3%B4tes_des_r%C3%A9seaux_priv%C3%A9s">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.15</span>Vérification des clés d'hôtes des réseaux privés</div>
			</a>
			
			<ul id="toc-Vérification_des_clés_d'hôtes_des_réseaux_privés-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Exécuter_une_commande_à_la_connexion" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Ex%C3%A9cuter_une_commande_%C3%A0_la_connexion">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.16</span>Exécuter une commande à la connexion</div>
			</a>
			
			<ul id="toc-Exécuter_une_commande_à_la_connexion-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Transfert_d'agent" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Transfert_d'agent">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.17</span>Transfert d'agent</div>
			</a>
			
			<ul id="toc-Transfert_d'agent-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Génération_de_nouvelles_clés" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#G%C3%A9n%C3%A9ration_de_nouvelles_cl%C3%A9s">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.18</span>Génération de nouvelles clés</div>
			</a>
			
			<ul id="toc-Génération_de_nouvelles_clés-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Dépannage" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#D%C3%A9pannage">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Dépannage</div>
		</a>
		
			<button aria-controls="toc-Dépannage-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Dépannage subsection</span>
			</button>
		
		<ul id="toc-Dépannage-sublist" class="vector-toc-list">
			<li id="toc-Checklist" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Checklist">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1</span>Checklist</div>
			</a>
			
			<ul id="toc-Checklist-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Connexion_refusée_ou_problème_de_timeout" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Connexion_refus%C3%A9e_ou_probl%C3%A8me_de_timeout">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2</span>Connexion refusée ou problème de timeout</div>
			</a>
			
			<ul id="toc-Connexion_refusée_ou_problème_de_timeout-sublist" class="vector-toc-list">
				<li id="toc-Redirection_de_port" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Redirection_de_port">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2.1</span>Redirection de port</div>
			</a>
			
			<ul id="toc-Redirection_de_port-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Est-ce_que_SSH_fonctionne_et_écoute_?" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Est-ce_que_SSH_fonctionne_et_%C3%A9coute_?">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2.2</span>Est-ce que SSH fonctionne et écoute ?</div>
			</a>
			
			<ul id="toc-Est-ce_que_SSH_fonctionne_et_écoute_?-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Des_règles_de_pare-feu_bloquent-elles_la_connexion_?" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Des_r%C3%A8gles_de_pare-feu_bloquent-elles_la_connexion_?">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2.3</span>Des règles de pare-feu bloquent-elles la connexion ?</div>
			</a>
			
			<ul id="toc-Des_règles_de_pare-feu_bloquent-elles_la_connexion_?-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Le_trafic_arrive-t-il_jusqu'à_votre_ordinateur_?" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Le_trafic_arrive-t-il_jusqu'%C3%A0_votre_ordinateur_?">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2.4</span>Le trafic arrive-t-il jusqu'à votre ordinateur ?</div>
			</a>
			
			<ul id="toc-Le_trafic_arrive-t-il_jusqu'à_votre_ordinateur_?-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Votre_FAI_ou_un_tiers_bloque_le_port_par_défaut_?" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Votre_FAI_ou_un_tiers_bloque_le_port_par_d%C3%A9faut_?">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2.5</span>Votre FAI ou un tiers bloque le port par défaut ?</div>
			</a>
			
			<ul id="toc-Votre_FAI_ou_un_tiers_bloque_le_port_par_défaut_?-sublist" class="vector-toc-list">
				<li id="toc-Diagnostic" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Diagnostic">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2.5.1</span>Diagnostic</div>
			</a>
			
			<ul id="toc-Diagnostic-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Solution_possible" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Solution_possible">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2.5.2</span>Solution possible</div>
			</a>
			
			<ul id="toc-Solution_possible-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Échec_de_la_lecture_de_la_socket_:_la_connexion_a_été_réinitialisée_par_le_pair" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%C3%89chec_de_la_lecture_de_la_socket_:_la_connexion_a_%C3%A9t%C3%A9_r%C3%A9initialis%C3%A9e_par_le_pair">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2.6</span>Échec de la lecture de la socket : la connexion a été réinitialisée par le pair</div>
			</a>
			
			<ul id="toc-Échec_de_la_lecture_de_la_socket_:_la_connexion_a_été_réinitialisée_par_le_pair-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id='toc-"[votre_shell]_:_No_such_file_or_directory"_/_problème_de_ssh_exchange_identification' class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href='#"[votre_shell]_:_No_such_file_or_directory"_/_probl%C3%A8me_de_ssh_exchange_identification'>
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.3</span>"[votre shell] : No such file or directory" / problème de ssh_exchange_identification</div>
			</a>
			
			<ul id='toc-"[votre_shell]_:_No_such_file_or_directory"_/_problème_de_ssh_exchange_identification-sublist' class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Message_d'erreur_&quot;Terminal_inconnu&quot;_ou_&quot;Erreur_d'ouverture_de_terminal&quot;" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Message_d'erreur_&quot;Terminal_inconnu&quot;_ou_&quot;Erreur_d'ouverture_de_terminal&quot;">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.4</span>Message d'erreur "Terminal inconnu" ou "Erreur d'ouverture de terminal"</div>
			</a>
			
			<ul id="toc-Message_d'erreur_&quot;Terminal_inconnu&quot;_ou_&quot;Erreur_d'ouverture_de_terminal&quot;-sublist" class="vector-toc-list">
				<li id="toc-TERM_hack" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#TERM_hack">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.4.1</span>TERM hack</div>
			</a>
			
			<ul id="toc-TERM_hack-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Connexion_fermée_par_x.x.x.x_[preauth]" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Connexion_ferm%C3%A9e_par_x.x.x.x_[preauth]">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.5</span>Connexion fermée par x.x.x.x [preauth]</div>
			</a>
			
			<ul id="toc-Connexion_fermée_par_x.x.x.x_[preauth]-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-subsystem_request_failed" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#subsystem_request_failed">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.6</span>subsystem request failed</div>
			</a>
			
			<ul id="toc-subsystem_request_failed-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-id_dsa_refusé_par_OpenSSH_7.0" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#id_dsa_refus%C3%A9_par_OpenSSH_7.0">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.7</span>id_dsa refusé par OpenSSH 7.0</div>
			</a>
			
			<ul id="toc-id_dsa_refusé_par_OpenSSH_7.0-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Aucune_méthode_d'échange_de_clés_correspondante_trouvée_par_OpenSSH_7.0" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Aucune_m%C3%A9thode_d'%C3%A9change_de_cl%C3%A9s_correspondante_trouv%C3%A9e_par_OpenSSH_7.0">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.8</span>Aucune méthode d'échange de clés correspondante trouvée par OpenSSH 7.0</div>
			</a>
			
			<ul id="toc-Aucune_méthode_d'échange_de_clés_correspondante_trouvée_par_OpenSSH_7.0-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Session_tmux/screen_tuée_lors_de_la_déconnexion_de_SSH" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Session_tmux/screen_tu%C3%A9e_lors_de_la_d%C3%A9connexion_de_SSH">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.9</span>Session tmux/screen tuée lors de la déconnexion de SSH</div>
			</a>
			
			<ul id="toc-Session_tmux/screen_tuée_lors_de_la_déconnexion_de_SSH-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-La_session_SSH_cesse_de_répondre" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#La_session_SSH_cesse_de_r%C3%A9pondre">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.10</span>La session SSH cesse de répondre</div>
			</a>
			
			<ul id="toc-La_session_SSH_cesse_de_répondre-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Broken_pipe" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Broken_pipe">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.11</span>Broken pipe</div>
			</a>
			
			<ul id="toc-Broken_pipe-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Démarrage_lent_des_daemons_après_un_redémarrage" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#D%C3%A9marrage_lent_des_daemons_apr%C3%A8s_un_red%C3%A9marrage">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.12</span>Démarrage lent des daemons après un redémarrage</div>
			</a>
			
			<ul id="toc-Démarrage_lent_des_daemons_après_un_redémarrage-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Terminer_une_connexion_SSH_qui_ne_répond_pas" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Terminer_une_connexion_SSH_qui_ne_r%C3%A9pond_pas">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.13</span>Terminer une connexion SSH qui ne répond pas</div>
			</a>
			
			<ul id="toc-Terminer_une_connexion_SSH_qui_ne_répond_pas-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Attention_:_l'identification_de_l'hôte_distant_a_changé_!" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Attention_:_l'identification_de_l'h%C3%B4te_distant_a_chang%C3%A9_!">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.14</span>Attention : l'identification de l'hôte distant a changé !</div>
			</a>
			
			<ul id="toc-Attention_:_l'identification_de_l'hôte_distant_a_changé_!-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Connexion_à_un_serveur_distant_sans_l'entrée_terminfo_appropriée" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Connexion_%C3%A0_un_serveur_distant_sans_l'entr%C3%A9e_terminfo_appropri%C3%A9e">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.15</span>Connexion à un serveur distant sans l'entrée terminfo appropriée</div>
			</a>
			
			<ul id="toc-Connexion_à_un_serveur_distant_sans_l'entrée_terminfo_appropriée-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-La_connexion_à_travers_l'hôte_de_saut_échoue_avec_&quot;bash_:_No_such_file_or_directory&quot;" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#La_connexion_%C3%A0_travers_l'h%C3%B4te_de_saut_%C3%A9choue_avec_&quot;bash_:_No_such_file_or_directory&quot;">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.16</span>La connexion à travers l'hôte de saut échoue avec "bash : No such file or directory"</div>
			</a>
			
			<ul id="toc-La_connexion_à_travers_l'hôte_de_saut_échoue_avec_&quot;bash_:_No_such_file_or_directory&quot;-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Voir_aussi" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Voir_aussi">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>Voir aussi</div>
		</a>
		
		<ul id="toc-Voir_aussi-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">OpenSSH (Français)</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 7 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-7" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">7 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-de mw-list-item"><a href="https://wiki.archlinux.de/title/SSH" title="SSH – Deutsch" lang="de" hreflang="de" class="interlanguage-link-target"><span>Deutsch</span></a></li>
<li class="interlanguage-link interwiki-en mw-list-item"><a href="../en/OpenSSH.html" title="OpenSSH – English" lang="en" hreflang="en" class="interlanguage-link-target"><span>English</span></a></li>
<li class="interlanguage-link interwiki-es mw-list-item"><a href="../es/OpenSSH.html" title="OpenSSH – español" lang="es" hreflang="es" class="interlanguage-link-target"><span>Español</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/OpenSSH" title="OpenSSH – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-pt mw-list-item"><a href="../pt/Secure_Shell.html" title="Secure Shell – português" lang="pt" hreflang="pt" class="interlanguage-link-target"><span>Português</span></a></li>
<li class="interlanguage-link interwiki-ru mw-list-item"><a href="../ru/OpenSSH.html" title="OpenSSH – русский" lang="ru" hreflang="ru" class="interlanguage-link-target"><span>Русский</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/OpenSSH" title="OpenSSH – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="fr" dir="ltr">
<div class="archwiki-template-box archwiki-template-box-note">
<strong>État de la traduction:</strong> Cet article est la version francophone de <a href="../en/OpenSSH.html" title="OpenSSH">OpenSSH</a>. Date de la dernière traduction: 2022-10-05. Vous pouvez aider à synchroniser la traduction s'il y a eu des <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=OpenSSH&amp;diff=0&amp;oldid=749505">changements</a> dans la version anglaise.</div>
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/SSH_keys.html" title="SSH keys">SSH keys</a></li>
<li><a href="../en/Pam_abl.html" title="Pam abl">Pam abl</a></li>
<li><a href="../en/Fail2ban.html" title="Fail2ban">fail2ban</a></li>
<li><a href="../en/Sshguard.html" title="Sshguard">sshguard</a></li>
<li><a href="../fr/SSHFS.html" title="SSHFS (Français)">SSHFS (Français)</a></li>
<li><a href="../en/Syslog-ng.html" title="Syslog-ng">Syslog-ng</a></li>
<li><a href="../en/SFTP_chroot.html" title="SFTP chroot">SFTP chroot</a></li>
<li><a href="../en/SCP_and_SFTP.html" title="SCP and SFTP">SCP and SFTP</a></li>
<li><a href="../en/VPN_over_SSH.html" title="VPN over SSH">VPN over SSH</a></li>
</ul>
</div>
<p><a href="https://en.wikipedia.org/wiki/fr:OpenSSH" class="extiw" title="wikipedia:fr:OpenSSH">OpenSSH</a> (OpenBSD Secure Shell) est un ensemble de programmes informatiques fournissant des sessions de communication chiffrées sur un réseau informatique en utilisant le protocole <a href="../fr/Secure_Shell.html" title="Secure Shell (Français)">Secure Shell</a> (SSH). Il a été créé comme alternative open source à la suite logicielle propriétaire Secure Shell offerte par SSH Communications Security. OpenSSH est développé dans le cadre du projet OpenBSD, qui est dirigé par Theo de Raadt.
</p>
<p>OpenSSH est parfois confondu avec OpenSSL, qui porte un nom proche ; cependant, les projets ont des objectifs différents et sont développés par des équipes différentes, la similitude du nom est uniquement due à des objectifs similaires.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../fr/Help:Reading.html#Installation_de_paquets" class="mw-redirect" title="Installez">Installez</a> le paquet <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=openssh">openssh</a></span>.
</p>
<h2><span class="mw-headline" id="Utilisation_du_client">Utilisation du client</span></h2>
<p>Pour se connecter à un serveur, exécutez :
</p>
<pre>$ ssh -p <i>port</i> <i>utilisateur</i> @ <i>adresse du serveur</i>.
</pre>
<p>Si le serveur n'autorise que l'authentification par clé publique, suivez <a href="../en/SSH_keys.html" title="SSH keys">SSH keys</a>.
</p>
<h3><span class="mw-headline" id="Configuration">Configuration</span></h3>
<p>Le client peut être configuré pour stocker les options et les hôtes courants. Toutes les options peuvent être déclarées globalement ou restreintes à des hôtes spécifiques. Par exemple :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.ssh/config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># global options
User <i>user</i>

# host-specific options
Host <i>myserver</i>
    Hostname <i>server-address</i>
    Port     <i>port</i>
</pre>
<p>Avec une telle configuration, les commandes suivantes sont équivalentes
</p>
<pre>$ ssh -p <i>port</i> <i>user</i>@<i>server-address'</i> (utilisateur)
$ ssh <b>myserver</b>
</pre>
<p>Consultez <span class="plainlinks archwiki-template-man" title="$ man 5 ssh_config"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ssh_config.5">ssh_config(5)</a></span> pour plus d'informations.
</p>
<p>Certaines options n'ont pas d'équivalent en ligne de commande, mais vous pouvez spécifier des options de configuration sur la ligne de commande avec <code>-o</code>. Par exemple <code>-oKexAlgorithmes=+diffie-hellman-group1-sha1</code>.
</p>
<h2><span class="mw-headline" id="Utilisation_du_serveur">Utilisation du serveur</span></h2>
<p><code>sshd</code> est le daemon du serveur OpenSSH, configuré avec <code>/etc/ssh/sshd_config</code> et géré par <code>sshd.service</code>. Chaque fois que vous modifiez la configuration, utilisez <code>sshd</code> en mode test avant de redémarrer le service pour vous assurer qu'il pourra démarrer proprement. Les configurations valides ne produisent aucune sortie.
</p>
<pre># sshd -t
</pre>
<h3><span class="mw-headline" id="Configuration_2">Configuration</span></h3>
<p>Pour autoriser l'accès uniquement à certains utilisateurs, ajoutez cette ligne :
</p>
<pre>AllowUsers <i>user1 user2</i>
</pre>
<p>Pour autoriser l'accès uniquement à certains groupes :
</p>
<pre>AllowGroups <i>group1 group2</i>
</pre>
<p>Pour ajouter un beau message de bienvenue (par exemple à partir du fichier <code>/etc/issue</code>), configurez l'option <code>Banner</code> :
</p>
<pre>Banner /etc/issue
</pre>
<p>Les clés d'hôte publiques et privées sont automatiquement générées dans <code>/etc/ssh</code> par le <a href="#Gestion_des_daemons">service</a> <i>sshdgenkeys</i> et régénérées si elles sont manquantes, même si l'option <code>HostKeyAlgorithms</code> de <code>sshd_config</code> n'en autorise que quelques-unes. Quatre paires de clés sont fournies, basées sur les algorithmes <a href="../en/SSH_keys.html#Choosing_the_authentication_key_type" title="SSH keys">dsa, rsa, ecdsa et ed25519</a>. Pour que sshd utilise une clé particulière, spécifiez l'option suivante :
</p>
<pre>HostKey /etc/ssh/ssh_host_rsa_key
</pre>
<p>Si le serveur doit être exposé au WAN, il est recommandé de changer le port par défaut de 22 à un port supérieur aléatoire comme ceci :
</p>
<pre>Port 39901
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Astuce:</strong> 
<ul>
<li>Pour vous aider à sélectionner un autre port qui n'est pas déjà attribué à un service commun, consultez la <a href="https://en.wikipedia.org/wiki/fr:Liste_de_ports_logiciels" class="extiw" title="wikipedia:fr:Liste de ports logiciels">liste des numéros de port TCP et UDP</a>. Vous pouvez également trouver des informations sur les ports en local dans <code>/etc/services</code>. Un changement de port par rapport au port 22 par défaut réduira le nombre d'entrées de journal causées par les tentatives d'authentification automatique mais ne les éliminera pas. Consultez <a href="../en/Port_knocking.html" title="Port knocking">Port knocking</a> pour des informations connexes.</li>
<li>Il est recommandé de désactiver entièrement les connexions par mot de passe. Cela augmentera considérablement la sécurité, consultez <a href="#Forcer_l'authentification_par_cl%C3%A9_publique">#Forcer l'authentification par clé publique</a> pour plus d'informations. Consultez <a href="#Protection">#Protection</a> pour plus de méthodes de sécurité recommandées.</li>
<li>OpenSSH peut écouter plusieurs ports simplement en ayant plusieurs <code>Port <i>numéro_port</i></code> lignes dans le fichier de configuration.</li>
<li>Les paires de clés d'hôte nouvelles (ou manquantes) peuvent être générées en supprimant la ou les paires que vous voulez remplacer de <code>/etc/ssh</code> et en exécutant <code>ssh-keygen -A</code> en tant que root.</li>
</ul>
</div>
<h3><span class="mw-headline" id="Gestion_des_daemons">Gestion des daemons</span></h3>
<p><a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Démarrez">Démarrez</a> et <a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Activez">activez</a> <code>sshd.service</code>. Il maintiendra le daemon SSH actif en permanence et forkera pour chaque connexion entrante. <a rel="nofollow" class="external autonumber" href="https://github.com/archlinux/svntogit-packages/blob/packages/openssh/trunk/sshd.service">[1]</a>
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=openssh">openssh</a></span> 8.0p1-3 a supprimé <code>sshd.socket</code> qui utilisait l'activation de socket de systemd en raison de sa sensibilité au déni de service. Consultez <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/62248">FS#62248</a> pour plus de détails. Si <code>sshd.socket</code> est activé lors de la mise à jour vers <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=openssh">openssh</a></span> 8.0p1-3, les unités <code>sshd.socket</code> et <code>sshd@.service</code> seront copiées dans <code>/etc/systemd/system/</code> et <a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Activez">réactivés</a>. Ceci est fait uniquement pour ne pas casser les configurations existantes, il est toujours conseillé aux utilisateurs de migrer vers <code>sshd.service</code>.</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Attention:</strong> Si vous continuez à utiliser <code>sshd.socket</code>, soyez conscient de ses problèmes :
<ul>
<li>L'unité <code>sshd.socket</code> peut échouer (par exemple, en raison d'une situation de mémoire insuffisante) et <code>Restart=always</code> ne peut pas être spécifié sur les unités de socket. Consultez <a rel="nofollow" class="external text" href="https://github.com/systemd/systemd/issues/11553">problème de systemd n°11553</a>.</li>
<li>L'utilisation de l'activation de socket peut entraîner un déni de service, car un trop grand nombre de connexions peut entraîner le refus d'activer davantage le service. Consultez le <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/62248">FS#62248</a>.</li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> L'utilisation de <code>sshd.socket</code> annule le paramètre <code>ListenAddress</code>, ce qui permet d'autoriser les connexions sur n'importe quelle adresse. Pour obtenir l'effet du paramètre <code>ListenAddress</code>, vous devez spécifier le port <i>et</i> l'IP pour <code>ListenStream</code>. (par exemple, <code>ListenStream=192.168.1.100:22</code>) en modifiant <code>sshd.socket</code>. Vous devez également ajouter <code>FreeBind=true</code> sous <code>[Socket]</code>, sinon la définition de l'adresse IP aura le même inconvénient que la définition de <code>ListenAddress</code> : la socket ne démarrera pas si le réseau n'est pas opérationnel à temps.</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Astuce:</strong> Lorsque vous utilisez l'activation de socket, une instance transitoire de <code>sshd@.service</code> sera démarrée pour chaque connexion (avec des noms d'instance différents). Par conséquent, ni <code>sshd.socket</code> ni l'instance régulière du daemon <code>sshd.service</code> ne permettent de surveiller les tentatives de connexion dans le journal. Les journaux des instances de SSH activées par socket peuvent être consultés en exécutant <code>journalctl -u "sshd@*"</code> en tant que root ou en exécutant <code>journalctl /usr/bin/sshd</code> en tant que root.</div>
<h3><span class="mw-headline" id="Protection">Protection</span></h3>
<p>Autoriser la connexion à distance via SSH est une bonne chose à des fins administratives, mais peut constituer une menace pour la sécurité de votre serveur. Souvent la cible d'attaques par force brute, l'accès SSH doit être limité correctement pour empêcher des tiers d'accéder à votre serveur.
</p>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ssh-audit">ssh-audit</a></span> offre une analyse automatisée de la configuration du serveur et du client.  Plusieurs autres bons guides et outils sont disponibles sur le sujet, par exemple :
</p>
<ul>
<li>
<a href="https://wiki.mozilla.org/Security/Guidelines/OpenSSH" class="extiw" title="mozillawiki:Security/Guidelines/OpenSSH">Article de l'équipe Mozilla Infosec</a>.</li>
<li><a rel="nofollow" class="external text" href="https://github.com/mozilla/ssh_scan">Mozilla ssh_scan</a></li>
<li><a rel="nofollow" class="external text" href="https://www.ssh-audit.com/hardening_guides.html">SSH Hardening Guides</a></li>
</ul>
<h4>
<span id="Forcer_l.27authentification_par_cl.C3.A9_publique"></span><span class="mw-headline" id="Forcer_l'authentification_par_clé_publique">Forcer l'authentification par clé publique</span>
</h4>
<p>Si un client ne peut pas s'authentifier au moyen d'une clé publique, le serveur SSH revient par défaut à l'authentification par mot de passe, ce qui permet à un utilisateur malveillant de tenter d'obtenir un accès en <a href="#Protection_contre_les_attaques_par_force_brute">force brute</a> par mot de passe. L'un des moyens les plus efficaces de se protéger contre cette attaque est de désactiver complètement les connexions par mot de passe et de forcer l'utilisation de <a href="../en/SSH_keys.html" title="SSH keys">clés SSH</a>. Ceci peut être réalisé en définissant les options suivantes dans le fichier de configuration du daemon :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ssh/sshd_config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">PasswordAuthentication no
AuthenticationMethods publickey
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Attention:</strong> Avant d'ajouter cette option à votre configuration, assurez-vous que tous les comptes nécessitant un accès SSH ont une authentification par clé publique configurée dans les fichiers <code>authorized_keys</code> correspondants. Consultez <a href="../en/SSH_keys.html#Copying_the_public_key_to_the_remote_server" title="SSH keys">SSH keys#Copying the public key to the remote server</a> pour plus d'informations.</div>
<h4>
<span id="Authentification_.C3.A0_deux_facteurs_et_cl.C3.A9s_publiques"></span><span class="mw-headline" id="Authentification_à_deux_facteurs_et_clés_publiques">Authentification à deux facteurs et clés publiques</span>
</h4>
<p>SSH peut être configuré pour nécessiter plusieurs méthodes d'authentification. Vous pouvez indiquer les méthodes d'authentification requises à l'aide de l'option <code>AuthenticationMethods</code>. Cela vous permet d'utiliser des clés publiques ainsi qu'une autorisation à deux facteurs.
</p>
<h5>
<span id="Fournisseurs_d.27authentification"></span><span class="mw-headline" id="Fournisseurs_d'authentification">Fournisseurs d'authentification</span>
</h5>
<p>Consultez <a href="../en/Google_Authenticator.html" title="Google Authenticator">Google Authenticator</a> pour configurer Google Authenticator.
</p>
<p>Pour <a rel="nofollow" class="external text" href="https://duo.com/">Duo</a>, <a href="../fr/Help:Reading.html#Installation_de_paquets" class="mw-redirect" title="Installez">installez</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/duo_unix/">duo_unix</a></span><sup><small>AUR</small></sup> qui fournira le module <code>pam_duo.so</code>. Lisez la <a rel="nofollow" class="external text" href="https://duo.com/docs/duounix">documentation Duo Unix</a> pour savoir comment configurer les informations d'identification Duo nécessaires (clé d'intégration, clé secrète, nom d'hôte API).
</p>
<h5><span class="mw-headline" id="Configuration_de_PAM">Configuration de PAM</span></h5>
<p>Pour utiliser <a href="../en/PAM.html" title="PAM">PAM</a> avec OpenSSH, éditez les fichiers suivants :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ssh/sshd_config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">KbdInteractiveAuthentication yes
AuthenticationMethods publickey keyboard-interactive:pam
</pre>
<p>Vous pouvez alors vous connecter avec une clé publique <b>ou</b> l'authentification de l'utilisateur comme requis par votre configuration PAM.
</p>
<p>Si, par contre, vous voulez authentifier l'utilisateur à la fois avec une clé publique <b>et</b> l'authentification utilisateur requise par votre configuration PAM, utilisez une virgule au lieu d'un espace pour séparer les AuthenticationMethods :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ssh/sshd_config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">KbdInteractiveAuthentication yes
AuthenticationMethods publickey<i>,</i>keyboard-interactive:pam
</pre>
<p>Si l'authentification par pubkey <b>et</b> pam est requise, vous pouvez désactiver le mot de passe :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pam.d/sshd</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">auth      required  pam_securetty.so     #disable remote root
#Require google authenticator
auth      required  pam_google_authenticator.so
#But not password
#auth      include   system-remote-login
account   include   system-remote-login
password  include   system-remote-login
session   include   system-remote-login
</pre>
<h4><span class="mw-headline" id="Protection_contre_les_attaques_par_force_brute">Protection contre les attaques par force brute</span></h4>
<p>Le forçage brutal est un concept simple : on essaie continuellement de se connecter à une page Web ou à une invite de connexion à un serveur comme SSH avec un grand nombre de combinaisons aléatoires de nom d'utilisateur et de mot de passe.
</p>
<p>Consultez <a href="../en/Uncomplicated_Firewall.html#Rate_limiting_with_ufw" class="mw-redirect" title="Ufw">ufw#Rate limiting with ufw</a> ou <a href="../en/Simple_stateful_firewall.html#Bruteforce_attacks" title="Simple stateful firewall">Simple stateful firewall#Bruteforce attacks</a> pour <a href="../en/Iptables.html" title="Iptables">iptables</a>.
</p>
<p>Vous pouvez également vous protéger contre les attaques par force brute en utilisant un script automatisé qui bloque toute personne essayant d'entrer par force brute, par exemple <a href="../en/Fail2ban.html" title="Fail2ban">fail2ban</a> ou <a href="../en/Sshguard.html" title="Sshguard">sshguard</a>.
</p>
<ul>
<li>N'autorisez les connexions SSH entrantes qu'à partir d'emplacements de confiance.</li>
<li>Utilisez <a href="../en/Fail2ban.html" title="Fail2ban">fail2ban</a> ou <a href="../en/Sshguard.html" title="Sshguard">sshguard</a> pour bloquer automatiquement les adresses IP qui échouent trop souvent à l'authentification par mot de passe.</li>
<li>Utilisez <a rel="nofollow" class="external text" href="https://github.com/jtniehof/pam_shield">pam_shield</a> pour bloquer les adresses IP qui effectuent trop de tentatives de connexion pendant une certaine période. Contrairement à <a href="../en/Fail2ban.html" title="Fail2ban">fail2ban</a> ou <a href="../en/Sshguard.html" title="Sshguard">sshguard</a>, ce programme ne prend pas en compte le succès ou l'échec de la connexion.</li>
</ul>
<h4><span class="mw-headline" id="Limiter_la_connexion_root">Limiter la connexion root</span></h4>
<p>Il est généralement considéré comme une mauvaise pratique de permettre à l'utilisateur root de se connecter sans contrainte via SSH. Il existe deux méthodes permettant de restreindre l'accès root SSH pour une sécurité accrue.
</p>
<h5><span class="mw-headline" id="Refuser">Refuser</span></h5>
<p>Sudo fournit de manière sélective les droits root pour les actions qui le nécessitent sans avoir à s'authentifier auprès du compte root. Cela permet de verrouiller le compte root contre l'accès via SSH et fonctionne potentiellement comme une mesure de sécurité contre les attaques par force brute, puisque maintenant un attaquant doit deviner le nom du compte en plus du mot de passe.
</p>
<p>SSH peut être configuré pour refuser les connexions à distance avec l'utilisateur root en modifiant la section "Authentification" du fichier de configuration du daemon. Définissez simplement <code>PermitRootLogin</code> à <code>no</code> :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ssh/sshd_config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">PermitRootLogin no</pre>
<p>Ensuite, <a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Redémarrez">redémarrez</a> le daemon SSH.
</p>
<p>Vous ne pourrez plus vous connecter par SSH sous root, mais vous pourrez toujours vous connecter avec votre utilisateur normal et utiliser <a href="../fr/Su.html" title="Su (Français)">su</a> ou <a href="../fr/Sudo.html" title="Sudo (Français)">sudo</a> pour administrer le système.
</p>
<h5><span class="mw-headline" id="Restreindre">Restreindre</span></h5>
<p>Certaines tâches automatisées, telles que la sauvegarde complète du système à distance, nécessitent un accès complet à root. Pour les autoriser de manière sécurisée, au lieu de désactiver la connexion root via SSH, il est possible de n'autoriser la connexion root que pour certaines commandes. Ceci peut être réalisé en éditant <code>~root/.ssh/authorized_keys</code>, en préfixant la clé désirée, par exemple comme suit :
</p>
<pre>command="/usr/lib/rsync/rrsync -ro /" ssh-rsa ...
</pre>
<p>Cela permettra à toute connexion avec cette clé spécifique d'exécuter la commande spécifiée entre les guillemets.
</p>
<p>L'augmentation de la surface d'attaque créée par l'exposition du nom d'utilisateur root à la connexion peut être compensée en ajoutant ce qui suit à <code>sshd_config</code> :
</p>
<pre>PermitRootLogin forced-commands-only
</pre>
<p>Ce paramètre ne limitera pas seulement les commandes que root peut exécuter via SSH, mais il désactivera également l'utilisation de mots de passe, forçant l'utilisation de l'authentification par clé publique pour le compte root.
</p>
<p>Une alternative un peu moins restrictive autorise n'importe quelle commande pour root, mais rend les attaques par force brute infaisables en imposant l'authentification par clé publique. Pour cette option, définissez :
</p>
<pre>PermitRootLogin prohibit-password
</pre>
<h4><span class="mw-headline" id="Verrouillage_du_fichier_authorized_keys">Verrouillage du fichier authorized_keys</span></h4>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Attention:</strong> Le verrouillage de ce fichier ne protège que contre les erreurs de l'utilisateur et une attaque particulière naïve en personne. Il ne fournit aucune protection contre les programmes malveillants ou les violations. Utilisez l'authentification à plusieurs facteurs, le pare-feu et la défense en profondeur pour éviter toute violation.</div>
<p>Si, pour une raison quelconque, vous pensez que l'utilisateur en question ne devrait pas pouvoir ajouter ou modifier des clés existantes, vous pouvez l'empêcher de manipuler le fichier.
</p>
<p>Sur le serveur, mettez le fichier <code>authorized_keys</code> en lecture seule pour l'utilisateur et refusez toutes les autres autorisations :
</p>
<pre>$ chmod 400 ~/.ssh/authorized_keys
</pre>
<p>Pour empêcher l'utilisateur de simplement rétablir les autorisations, <a href="../en/File_permissions_and_attributes.html#File_attributes" title="File permissions and attributes">définissez le bit immuable</a> sur le fichier <code>authorized_keys</code>. Pour empêcher l'utilisateur de renommer le répertoire <code>~/.ssh</code> et de créer un nouveau répertoire <code>~/.ssh</code> et un nouveau fichier <code>authorized_keys</code>, définissez également le bit immuable sur le répertoire <code>~/.ssh</code>. Pour ajouter ou supprimer des clés, vous devrez supprimer le bit immuable de <code>authorized_keys</code> et le rendre temporairement accessible en écriture.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Astuce:</strong> Il est recommandé d'enregistrer les modifications apportées à tout fichier <code>authorized_keys</code> via, par exemple, <a href="../en/Audit_framework.html#Audit_files_and_directories_access" title="Audit framework">auditd</a>.</div>
<h2><span class="mw-headline" id="Trucs_et_astuces">Trucs et astuces</span></h2>
<h3>
<span id="Tunnel_SOCKS_chiffr.C3.A9"></span><span class="mw-headline" id="Tunnel_SOCKS_chiffré">Tunnel SOCKS chiffré</span>
</h3>
<p>Ceci est très utile pour les utilisateurs d'ordinateurs portables connectés à diverses connexions sans fil non sécurisées. La seule chose dont vous avez besoin est un serveur SSH fonctionnant dans un endroit quelque peu sécurisé, comme votre domicile ou votre lieu de travail. Il peut être utile d'utiliser un service DNS dynamique comme <a rel="nofollow" class="external text" href="https://dyn.com/dns/">DynDNS</a> pour ne pas avoir à se souvenir de votre adresse IP.
</p>
<h4>
<span id=".C3.89tape_1_:_d.C3.A9marrer_la_connexion"></span><span class="mw-headline" id="Étape_1_:_démarrer_la_connexion">Étape 1 : démarrer la connexion</span>
</h4>
<p>Vous n'avez qu'à exécuter cette seule commande pour démarrer la connexion :
</p>
<pre>$ ssh -TND 4711 <i>user</i>@<i>host</i>
</pre>
<p>où <code><i>user</i></code> est votre nom d'utilisateur sur le serveur SSH fonctionnant sur <code><i>host</i></code>. Il vous demandera votre mot de passe, et vous serez alors connecté. L'option <code>N</code> désactive l'invite interactive, et l'option <code>D</code> spécifie le port local sur lequel écouter (vous pouvez choisir n'importe quel numéro de port si vous le souhaitez).  L'option <code>T</code> désactive l'allocation de pseudo-tty.
</p>
<p>Il est intéressant d'ajouter l'option verbose (<code>-v</code>), car vous pouvez alors vérifier que le système est réellement connecté à partir de cette sortie.
</p>
<h4>
<span id=".C3.89tape_2_.28Variante_A.29_:_configurez_votre_navigateur_.28ou_d.27autres_programmes.29"></span><span class="mw-headline" id="Étape_2_(Variante_A)_:_configurez_votre_navigateur_(ou_d'autres_programmes)">Étape 2 (Variante A) : configurez votre navigateur (ou d'autres programmes)</span>
</h4>
<p>L'étape ci-dessus n'est utile qu'en combinaison avec un navigateur web ou un autre programme qui utilise ce tunnel SOCKS nouvellement créé. Comme SSH prend actuellement en charge SOCKS v4 et SOCKS v5, vous pouvez utiliser l'un ou l'autre.
</p>
<ul><li>Pour Firefox : Dans <i>Préférences &gt; Général</i>, naviguez jusqu'au bas de la page et cliquez sur <i>Paramètres...</i>, qui se trouve à droite du titre Paramètres réseau. Ensuite, dans la nouvelle semi-fenêtre, cochez l'option <i>Configuration manuelle du proxy</i> et entrez <code>localhost</code> dans le champ de texte <i>Hôte SOCKS</i>, et le numéro de port dans le champ de texte <i>Port</i> (<code>4711</code> dans l'exemple ci-dessus) à côté.</li></ul>
<dl>
<dd>Firefox n'effectue pas automatiquement les requêtes DNS via le tunnel SOCKS. Ce problème potentiel de confidentialité peut être atténué en faisant défiler la page plus bas et en cochant la case <i>Proxy DNS when using SOCKS v5</i>. Évidemment, cela ne fonctionnera que si vous choisissez SOCKS v5 plutôt que v4.</dd>
<dd>Redémarrez Firefox pour activer ces paramètres.</dd>
</dl>
<ul><li>Pour Chromium : Vous pouvez définir les paramètres SOCKS comme variables d'environnement ou comme options de ligne de commande. Je recommande d'ajouter l'une des fonctions suivantes à votre <code>.bashrc</code> :</li></ul>
<pre>function secure_chromium {
    port=4711
    export SOCKS_SERVER=localhost:$port
    export SOCKS_VERSION=5
    chromium &amp;
    exit
}
</pre>
<p>OU
</p>
<pre>function secure_chromium {
    port=4711
    chromium --proxy-server="socks://localhost:$port" &amp;
    exit
}
</pre>
<p>Maintenant, ouvrez un terminal et faites simplement :
</p>
<pre>$ secure_chromium
</pre>
<p>Profitez de votre tunnel sécurisé !
</p>
<h4>
<span id=".C3.89tape_2_.28Variante_B.29_:_configurer_une_interface_TUN_locale"></span><span class="mw-headline" id="Étape_2_(Variante_B)_:_configurer_une_interface_TUN_locale">Étape 2 (Variante B) : configurer une interface TUN locale</span>
</h4>
<p>Cette variante est un peu plus complexe au départ, mais elle vous évite de devoir configurer manuellement chaque application une par une pour utiliser le proxy SOCKS. Elle consiste à configurer une interface TUN locale et à acheminer le trafic à travers celle-ci.
</p>
<p>Consultez <a href="../en/VPN_over_SSH.html#Set_up_badvpn_and_tunnel_interface" title="VPN over SSH">VPN over SSH#Set up badvpn and tunnel interface</a>.
</p>
<h3>
<span id="D.C3.A9port_d.27affichage_X11"></span><span class="mw-headline" id="Déport_d'affichage_X11">Déport d'affichage X11</span>
</h3>
<p>Le déport d'affichage avec X11 est un mécanisme qui permet aux interfaces graphiques des programmes X11 s'exécutant sur un système distant d'être affichées sur une machine cliente locale. Pour la redirection X11, l'hôte distant n'a pas besoin d'avoir un système X11 complet installé, mais il doit au moins avoir <i>xauth</i> installé. <i>xauth</i> est un utilitaire qui maintient les configurations <code>Xauthority</code> utilisées par le serveur et le client pour l'authentification de la session X11 (<a rel="nofollow" class="external text" href="http://xmodulo.com/2012/11/how-to-enable-x11-forwarding-using-ssh.html">source</a>).
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Attention:</strong> La redirection X11 a d'importantes implications en matière de sécurité qu'il faut au moins reconnaître en lisant les sections pertinentes des pages de manuel <span class="plainlinks archwiki-template-man" title="$ man 1 ssh"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ssh.1">ssh(1)</a></span>, <span class="plainlinks archwiki-template-man" title="$ man 5 sshd_config"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sshd_config.5">sshd_config(5)</a></span> et <span class="plainlinks archwiki-template-man" title="$ man 5 ssh_config"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ssh_config.5">ssh_config(5)</a></span>. Consultez également <a rel="nofollow" class="external text" href="https://security.stackexchange.com/questions/14815/security-concerns-with-x11-forwarding">this StackExchange question.</a>
</div>
<h4><span class="mw-headline" id="Configuration_3">Configuration</span></h4>
<h5><span class="mw-headline" id="A_distance">A distance</span></h5>
<ul>
<li>
<a href="../fr/Help:Reading.html#Installation_de_paquets" class="mw-redirect" title="Installez">installez</a> les paquets <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xorg-xauth">xorg-xauth</a></span>
</li>
<li>dans <code>/etc/ssh/ssh<b>d</b>_config</code> :
<ul>
<li>définissez <code>X11Forwarding</code> à <i>yes</i>.</li>
<li>vérifiez que les options <code>AllowTcpForwarding</code> et <code>X11UseLocalhost</code> ont pour valeur <i>yes</i>, et que <code>X11DisplayOffset</code> a pour valeur <i>10</i> (ce sont les valeurs par défaut si rien n'a été changé, consultez <span class="plainlinks archwiki-template-man" title="$ man 5 sshd_config"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sshd_config.5">sshd_config(5)</a></span>)</li>
</ul>
</li>
<li>puis <a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Redémarrez">redémarrez</a> le <a href="#Gestion_des_daemons">daemon <i>sshd</i></a>.</li>
</ul>
<h5><span class="mw-headline" id="Client">Client</span></h5>
<ul>
<li>
<a href="../fr/Help:Reading.html#Installation_de_paquets" class="mw-redirect" title="Installez">installez</a> le paquet <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xorg-xauth">xorg-xauth</a></span>
</li>
<li>Activez l'option <code>ForwardX11</code> en spécifiant le paramètre <code>-X</code> sur la ligne de commande pour les connexions opportunistes, ou en définissant <code>ForwardX11</code> à <i>yes</i> dans la configuration du <a href="#Configuration">client</a>.</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Astuce:</strong> Vous pouvez activer l'option <code>ForwardX11Trusted</code> (paramètre <code>-Y</code> sur la ligne de commande) si l'interface graphique s'affiche mal ou si vous recevez des erreurs ; cela empêchera les transferts X11 d'être soumis aux contrôles de <a rel="nofollow" class="external text" href="https://www.x.org/wiki/Development/Documentation/Security/">X11 SECURITY extension</a>. Si vous le faites, assurez-vous d'avoir lu <a href="#D%C3%A9port_d'affichage_X11">l'avertissement</a> au début de cette section.</div>
<h4><span class="mw-headline" id="Utilisation">Utilisation</span></h4>
<p>Connectez-vous à la machine distante normalement, en spécifiant le paramètre <code>-X</code> si <i>ForwardX11</i> n'a pas été activé dans le fichier de configuration du client :
</p>
<pre>$ ssh -X <i>user@host</i>
</pre>
<p>Si vous recevez des erreurs en essayant d'exécuter des applications graphiques, essayez plutôt <i>ForwardX11Trusted</i> :
</p>
<pre>$ ssh -Y <i>user@host</i>
</pre>
<p>Si vous obtenez <code>X11 forwarding request failed</code>, recommencez la configuration pour votre machine distante. Une fois que la demande de transfert X11 a réussi, vous pouvez lancer n'importe quel programme X sur le serveur distant et il sera transféré à votre session locale :
</p>
<p>$ xclock
</p>
<p>Une erreur contenant <code>Can't open display</code> indique que <code>DISPLAY</code> n'est pas correctement configuré.
</p>
<p>Soyez prudent avec certaines applications car elles vérifient qu'une instance est en cours d'exécution sur la machine locale. <a href="../en/Firefox.html" class="mw-redirect" title="Firefox (Français)">Firefox</a> est un exemple : fermez l'instance de Firefox en cours d'exécution ou utilisez le paramètre de démarrage suivant pour lancer une instance distante sur la machine locale :
</p>
<pre>$ firefox --no-remote
</pre>
<p>Si vous obtenez "X11 forwarding request failed on channel 0" lorsque vous vous connectez (et que le serveur <code>/var/log/errors.log</code> affiche "Failed to allocate internet-domain X11 display socket"), vérifiez que le paquet <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xorg-xauth">xorg-xauth</a></span> est installé. Si son installation ne fonctionne pas, essayez soit de :
</p>
<ul>
<li>activer l'option <code>AddressFamily any</code> dans <code>ssh<b>d</b>_config</code> sur le <i>serveur</i>, soit</li>
<li>Définir l'option <code>AddressFamily</code> de <code>ssh<b>d</b>_config</code> sur le <i>serveur</i> à inet.</li>
</ul>
<p>Le réglage sur inet peut résoudre les problèmes avec les clients Ubuntu sur IPv4.
</p>
<p>Pour exécuter des applications X en tant qu'autre utilisateur sur le serveur SSH, vous devez <code>xauth add</code> la ligne d'authentification prise dans <code>xauth list</code> de l'utilisateur connecté à SSH.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Astuce:</strong> <a rel="nofollow" class="external text" href="https://unix.stackexchange.com/a/12772">Ici</a> et <a rel="nofollow" class="external text" href="https://unix.stackexchange.com/a/46748">là</a> plusieurs <a rel="nofollow" class="external text" href="https://superuser.com/a/805060">liens</a> pour dépanner des soucis de <code>X11 Forwarding</code>.</div>
<h3>
<span id="Transfert_d.27autres_ports"></span><span class="mw-headline" id="Transfert_d'autres_ports">Transfert d'autres ports</span>
</h3>
<p>En plus du support intégré de SSH pour X11, il peut également être utilisé pour tunnelliser de manière sécurisée toute connexion TCP, en utilisant la redirection locale ou la redirection à distance.
</p>
<p>Le transfert local ouvre un port sur la machine locale, dont les connexions seront transférées vers l'hôte distant et de là, vers une destination donnée. Très souvent, la destination de la redirection sera la même que l'hôte distant, fournissant ainsi un shell sécurisé et, par exemple, une connexion <a href="../en/List_of_applications/Internet.html#Remote_desktop" class="mw-redirect" title="VNC">VNC</a> sécurisée, à la même machine. Le transfert local est accompli au moyen du paramètre <code>-L</code> et il accompagne la spécification du transfert sous la forme <code>&lt;port du tunnel&gt;:&lt;adresse de destination&gt;:&lt;port de destination&gt;</code>.
</p>
<p>Ainsi :
</p>
<pre>$ ssh -L 1000:mail.google.com:25 192.168.0.100
</pre>
<p>utilisera SSH pour se connecter et ouvrir un shell sur <code>192.168.0.100</code>, et créera également un tunnel depuis le port TCP 1000 de la machine locale vers mail.google.com sur le port 25. Une fois établi, les connexions à <code>localhost:1000</code> se connecteront au port SMTP de Gmail. Pour Google, il apparaîtra que cette connexion (mais pas nécessairement les données transmises par cette connexion) provient de <code>192.168.0.100</code>, et ces données seront sécurisées entre la machine locale et 192.168.0.100, mais pas entre <code>192.168.0.100</code> et Google, sauf si d'autres mesures sont prises.
</p>
<p>De même :
</p>
<pre>$ ssh -L 2000:192.168.0.100:6001 192.168.0.100
</pre>
<p>permettra les connexions à <code>localhost:2000</code> qui seront envoyées de manière transparente à l'hôte distant sur le port 6001. L'exemple précédent est utile pour les connexions VNC utilisant l'utilitaire vncserver - qui fait partie du paquet <a href="../en/TigerVNC.html" class="mw-redirect" title="Tightvnc">tightvnc</a> - qui, bien que très utile, est explicite quant à son manque de sécurité.
</p>
<p>Le transfert à distance permet à l'hôte distant de se connecter à un hôte arbitraire via le tunnel SSH et la machine locale, ce qui constitue une inversion fonctionnelle du transfert local, et est utile dans les situations où, par exemple, l'hôte distant a une connectivité limitée en raison d'un pare-feu. Il est activé avec le paramètre <code>-R</code> et une spécification de transfert sous la forme <code>&lt;port du tunnel&gt;:&lt;adresse de destination&gt;:&lt;port de destination&gt;</code>.
</p>
<p>Ainsi :
</p>
<pre>$ ssh -R 3000:irc.libera.chat:6667 192.168.0.200
</pre>
<p>fera apparaître un shell sur <code>192.168.0.200</code>, et les connexions de <code>192.168.0.200</code> à lui-même sur le port 3000 (le <code>localhost:3000</code> de l'hôte distant) seront envoyées via le tunnel à la machine locale, puis à irc.libera.chat sur le port 6667, ce qui, dans cet exemple, permet d'utiliser les programmes IRC sur l'hôte distant, même si le port 6667 lui serait normalement bloqué.
</p>
<p>La redirection locale et distante peut être utilisée pour fournir une "passerelle" sécurisée, permettant à d'autres ordinateurs de profiter d'un tunnel SSH, sans réellement exécuter SSH ou le daemon SSH en fournissant une adresse de liaison pour le début du tunnel dans le cadre de la spécification de la redirection, par exemple <code>&lt;adresse du tunnel&gt;:&lt;port du tunnel&gt;:&lt;adresse de destination&gt;:&lt;port de destination&gt;</code>. L'adresse <code>&lt;tunnel address&gt;</code> peut être n'importe quelle adresse sur la machine au début du tunnel. L'adresse <code>localhost</code> autorise les connexions via l'interface <code>localhost</code> ou loopback, et une adresse vide ou <code>*</code> autorise les connexions via n'importe quelle interface. Par défaut, le transfert est limité aux connexions provenant de la machine située au "début" du tunnel, c'est-à-dire que l'adresse <code>&lt;adresse du tunnel&gt;</code> est définie sur <code>localhost</code>. La redirection locale ne nécessite aucune configuration supplémentaire, mais la redirection à distance est limitée par la configuration du daemon SSH du serveur distant. Consultez l'option <code>GatewayPorts</code> dans <span class="plainlinks archwiki-template-man" title="$ man 5 sshd_config"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sshd_config.5">sshd_config(5)</a></span> et l'option <code>-L address</code> dans <span class="plainlinks archwiki-template-man" title="$ man 1 ssh"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ssh.1">ssh(1)</a></span> pour plus d'informations sur le transfert à distance et le transfert local, respectivement.
</p>
<h3>
<span id="H.C3.B4tes_de_saut"></span><span class="mw-headline" id="Hôtes_de_saut">Hôtes de saut</span>
</h3>
<p>Dans certains scénarios, il se peut qu'il n'y ait pas de connexion directe à votre daemon SSH cible, et l'utilisation d'un serveur de saut (ou serveur bastion) est nécessaire. Ainsi, nous essayons de connecter ensemble deux ou plusieurs tunnels SSH, et supposons que vos clés locales sont autorisées pour chaque serveur de la chaîne. Ceci est possible en utilisant le transfert d'agent SSH (<code>-A</code>) et l'allocation de pseudo-terminaux (<code>-t</code>) qui transmet votre clé locale avec la syntaxe suivante :
</p>
<pre>$ ssh -A -t -l user1 bastion1 \
  ssh -A -t -l utilisateur2 intermédiaire2 \
  ssh -A -t -l utilisateur3 cible
</pre>
<p>Une façon plus simple de le faire est d'utiliser l'option <code>-J</code> :
</p>
<pre>$ ssh -J user1@bastion1,user2@intermediate2 user3@target
</pre>
<p>Plusieurs hôtes dans la directive <code>-J</code> peuvent être séparés par une virgule, ils seront connectés dans l'ordre de la liste. La partie <code>user...@</code> n'est pas obligatoire, mais peut être utilisée. Les spécifications de l'hôte pour <code>-J</code> utilisent le fichier de configuration ssh, donc des options spécifiques par hôte peuvent être définies ici, si nécessaire.
</p>
<p>Un équivalent de l'indicateur <code>-J</code> dans le fichier de configuration est l'option <code>ProxyJump</code>, consultez <span class="plainlinks archwiki-template-man" title="$ man 5 ssh_config"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ssh_config.5">ssh_config(5)</a></span> pour plus de détails.
</p>
<h3>
<span id="Inverser_SSH_.C3.A0_travers_un_relais"></span><span class="mw-headline" id="Inverser_SSH_à_travers_un_relais">Inverser SSH à travers un relais</span>
</h3>
<p>L'idée est que le client se connecte au serveur via un autre relais, tandis que le serveur est connecté au même relais en utilisant un tunnel SSH inverse. Ceci est par exemple utile lorsque le serveur est derrière un NAT et que le relais est un serveur SSH accessible au public utilisé comme proxy auquel l'utilisateur a accès. La condition préalable est donc que les clés du client soient autorisées à la fois par le relais et le serveur et que les clés du serveur soient également autorisées par le relais pour la connexion SSH inverse.
</p>
<p>L'exemple de configuration suivant suppose que l'utilisateur1 est le compte utilisateur utilisé sur le client, l'utilisateur2 sur le relais et l'utilisateur3 sur le serveur. Tout d'abord, le serveur doit établir le tunnel inverse avec :
</p>
<pre>ssh -R 2222:localhost:22 -N user2@relay
</pre>
<p>Ce qui peut également être automatisé avec un script de démarrage, un service systemd ou <a href="#Autossh_-_red%C3%A9marrer_automatiquement_les_sessions_et_tunnels_SSH">autossh</a>.
</p>
<p>Du côté client, la connexion est établie avec :
</p>
<pre>ssh -t user2@relay ssh user3@localhost -p 2222
</pre>
<p>La commande à distance pour établir la connexion au tunnel inverse peut également être définie dans le <code>~/.ssh/authorized_keys</code> du relais en incluant le champ <code>command</code> comme suit :
</p>
<pre>command="ssh user3@localhost -p 2222" ssh-rsa KEY2 user1@client
</pre>
<p>Dans ce cas, la connexion est établie avec :
</p>
<pre>ssh user2@relay
</pre>
<p>Notez que la fonction d'autocomplétion de SCP dans le terminal du client ne fonctionne pas et que les transferts SCP eux-mêmes ne fonctionnent pas dans certaines configurations.
</p>
<h3><span class="mw-headline" id="Multiplexage">Multiplexage</span></h3>
<p>Le daemon SSH écoute généralement sur le port 22. Cependant, il est courant pour de nombreux points d'accès publics à Internet de bloquer tout le trafic qui n'est pas sur les ports HTTP/S habituels (80 et 443, respectivement), bloquant ainsi efficacement les connexions SSH. La solution immédiate à ce problème consiste à faire en sorte que <code>sshd</code> écoute en plus sur l'un des ports de la liste blanche :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ssh/sshd_config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Port 22
Port 443
</pre>
<p>Cependant, il est probable que le port 443 soit déjà utilisé par un serveur web servant du contenu HTTPS, auquel cas il est possible d'utiliser un multiplexeur, tel que <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=sslh">sslh</a></span>, qui écoute sur le port multiplexé et peut transférer intelligemment les paquets vers de nombreux services.
</p>
<h3>
<span id="Acc.C3.A9l.C3.A9rer_SSH"></span><span class="mw-headline" id="Accélérer_SSH">Accélérer SSH</span>
</h3>
<p>Il existe plusieurs options <a href="#Configuration">configuration du client</a> qui peuvent accélérer les connexions de manière globale ou pour des hôtes spécifiques. Consultez <span class="plainlinks archwiki-template-man" title="$ man 5 ssh_config"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ssh_config.5">ssh_config(5)</a></span> pour une description complète de ces options.
</p>
<ul>
<li>
<i>Use a faster cipher</i> : sur les CPUs modernes avec les instructions AESNI, <code>aes128-gcm@openssh.com</code> et <code>aes256-gcm@openssh.com</code> devraient offrir de meilleures performances que le chiffrement préféré par défaut d'openssh, habituellement <code>chacha20-poly1305@openssh.com</code>. Le chiffrement peut être sélectionné par l'option <code>-c</code>. Pour un effet permanent, mettez l'option <code>Ciphers</code> dans votre <code>~/.ssh/config</code> avec les ciphers dans le nouvel ordre préféré, par exemple :<pre>Ciphers aes128-gcm@openssh.com,aes256-gcm@openssh.com,chacha20-poly1305@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr</pre>
</li>
<li>
<i>Activer ou désactiver la compression</i> : la compression peut augmenter la vitesse sur les connexions lentes, elle est activée avec l'option <code>Compression yes</code> ou le paramètre <code>-C</code>. Cependant, l'algorithme de compression utilisé est le relativement lent <span class="plainlinks archwiki-template-man" title="$ man 1 gzip"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/gzip.1">gzip(1)</a></span> qui devient le goulot d'étranglement sur les réseaux rapides. Afin d'accélérer la connexion, il faut utiliser l'option <code>Compression no</code> sur les réseaux locaux ou rapides.</li>
<li>
<i>Partage de connexion</i> : vous pouvez faire en sorte que toutes les sessions sur le même hôte partagent une seule connexion en utilisant ces options :<pre>ControlMaster auto
ControlPersist yes
ControlPath ~/.ssh/sockets/socket-%r@%h:%p
</pre>
</li>
</ul>
<dl><dd>où <code>~/.ssh/sockets</code> peut être n'importe quel répertoire non accessible en écriture par d'autres utilisateurs.</dd></dl>
<ul>
<li>
<code>ControlPersist</code> spécifie combien de temps le maître doit attendre en arrière-plan de nouveaux clients après la fermeture de la connexion client initiale. Les valeurs possibles sont soit :
<ul>
<li>
<code>no</code> pour fermer la connexion immédiatement après la déconnexion du dernier client,</li>
<li>un temps en secondes,</li>
<li>
<code>yes</code> pour attendre éternellement, la connexion ne sera jamais fermée automatiquement.</li>
</ul>
</li>
<li>Le temps de connexion peut être raccourci en contournant la recherche IPv6 à l'aide de l'option <code>AddressFamily inet</code> ou de l'option <code>-4</code>.</li>
<li>Enfin, si vous avez l'intention d'utiliser SSH pour SFTP ou SCP, <a rel="nofollow" class="external text" href="https://www.psc.edu/index.php/hpn-ssh">High Performance SSH/SCP</a> peut augmenter considérablement le débit en augmentant dynamiquement la taille des tampons SSH. Installez le paquet <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/openssh-hpn-git/">openssh-hpn-git</a></span><sup><small>AUR</small></sup><sup>[<a href="../en/Help:Procedures.html#Fix_broken_package_links" title="Help:Procedures">broken link</a>: package not found]</sup> pour utiliser une version corrigée d'OpenSSH avec cette amélioration.</li>
</ul>
<h3>
<span id="Montage_d.27un_syst.C3.A8me_de_fichiers_distant_avec_SSHFS"></span><span class="mw-headline" id="Montage_d'un_système_de_fichiers_distant_avec_SSHFS">Montage d'un système de fichiers distant avec SSHFS</span>
</h3>
<p>Veuillez vous référer à l'article <a href="../fr/SSHFS.html" title="SSHFS (Français)">SSHFS</a> pour monter un système distant accessible par SSH dans un répertoire local, ce qui vous permettra d'effectuer n'importe quelle opération sur les fichiers montés avec n'importe quel outil (copier, renommer, éditer avec vim, etc.). <i>sshfs</i> est généralement préféré à <i>shfs</i>, ce dernier n'ayant pas été mis à jour depuis 2004.
</p>
<h3><span class="mw-headline" id="Maintenir_en_vie">Maintenir en vie</span></h3>
<p>Par défaut, la session SSH se déconnecte automatiquement si elle est restée inactive pendant un certain temps. Pour maintenir la session en vie, le client peut envoyer un signal de maintien en vie au serveur si aucune donnée n'a été reçue depuis un certain temps, ou symétriquement, le serveur peut envoyer des messages à intervalles réguliers s'il n'a pas reçu de nouvelles du client.
</p>
<ul>
<li>Du côté du <i>serveur</i>, <code>ClientAliveInterval</code> définit le délai en secondes après lequel, si aucune donnée n'a été reçue du client, <i>sshd</i> enverra une demande de réponse. La valeur par défaut est 0, aucun message n'est envoyé. Par exemple, pour demander une réponse toutes les 60 secondes au client, définissez l'option <code>ClientAliveInterval 60</code> dans votre <a href="#Configuration_2">configuration du serveur</a>. Consultez également les options <code>ClientAliveCountMax</code> et <code>TCPKeepAlive</code>.</li>
<li>Du côté <b>client</b>, <code>ServerAliveInterval</code> contrôle l'intervalle entre les demandes de réponse envoyées par le client au serveur. Par exemple, pour demander une réponse toutes les 120 secondes au serveur, ajoutez l'option <code>ServerAliveInterval 120</code> à votre <a href="#Configuration">client</a>. Consultez également les options <code>ServerAliveCountMax</code> et <code>TCPKeepAlive</code>.</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong>  Pour s'assurer qu'une session est maintenue en vie, un seul du client ou du serveur doit envoyer des demandes de maintien en vie. Si vous contrôlez à la fois les serveurs et les clients, un choix raisonnable est de ne configurer que les clients qui nécessitent une session persistante avec un <code>ServerAliveInterval</code> positif et de laisser les autres clients et serveurs dans leur configuration par défaut.</div>
<h3>
<span id="Red.C3.A9marrer_automatiquement_les_tunnels_SSH_avec_systemd"></span><span class="mw-headline" id="Redémarrer_automatiquement_les_tunnels_SSH_avec_systemd">Redémarrer automatiquement les tunnels SSH avec systemd</span>
</h3>
<p><a href="../fr/Systemd.html" title="Systemd (Français)">systemd</a> peut démarrer automatiquement les connexions SSH au démarrage/à la connexion <i>et</i> les redémarrer lorsqu'elles échouent. Cela en fait un outil utile pour la maintenance des tunnels SSH.
</p>
<p>Le service suivant peut démarrer un tunnel SSH à la connexion en utilisant les paramètres de connexion dans votre <a href="#Configuration">ssh configuration</a>. Si la connexion se ferme pour une raison quelconque, il attend 10 secondes avant de la redémarrer :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/systemd/user/tunnel.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=SSH tunnel to myserver

[Service]
Type=simple
Restart=always
RestartSec=10
ExecStart=/usr/bin/ssh -F %h/.ssh/config -N myserver
</pre>
<p>Puis <a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Activez">activez</a> et <a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Démarrez">démarrez</a> le service <a href="../fr/Systemd/User.html" title="Systemd (Français)/User (Français)">comme utilisateur</a>. Consultez <a href="#Maintenir_en_vie">#Maintenir en vie</a> pour savoir comment empêcher le tunnel de s'interrompre. Si vous souhaitez démarrer le tunnel au démarrage, vous pourriez vouloir <a href="../fr/Systemd.html#Modifier_les_unit%C3%A9s_fournies" class="mw-redirect" title="Éditez">réécrire l'unité</a> en tant que service système.
</p>
<h3>
<span id="Autossh_-_red.C3.A9marrer_automatiquement_les_sessions_et_tunnels_SSH"></span><span class="mw-headline" id="Autossh_-_redémarrer_automatiquement_les_sessions_et_tunnels_SSH">Autossh - redémarrer automatiquement les sessions et tunnels SSH</span>
</h3>
<p>Lorsqu'une session ou un tunnel ne peut être maintenu en vie, par exemple en raison de mauvaises conditions de réseau provoquant des déconnexions du client, vous pouvez utiliser <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=autossh">autossh</a></span> pour les redémarrer automatiquement.
</p>
<p>Exemples d'utilisation :
</p>
<pre>$ autossh -M 0 -o "ServerAliveInterval 45" -o "ServerAliveCountMax 2" username@example.com
</pre>
<p>Combiné avec <a href="../fr/SSHFS.html" title="SSHFS (Français)">SSHFS</a> :
</p>
<pre>$ sshfs -o reconnect,compression=yes,transform_symlinks,ServerAliveInterval=45,ServerAliveCountMax=2,ssh_command='autossh -M 0' username@example.com : /mnt/exemple 
</pre>
<p>Connexion via un proxy SOCKS défini par <a href="../en/Proxy_server.html" class="mw-redirect" title="Proxy settings">Paramètres du proxy</a> :
</p>
<pre>$ autossh -M 0 -o "ServerAliveInterval 45" -o "ServerAliveCountMax 2" -NCD 8080 username@example.com 
</pre>
<p>Avec l'option <code>-f</code>, autossh peut être exécuté en tant que processus de fond. Cependant, cela signifie que la phrase de passe ne peut pas être saisie de manière interactive.
</p>
<p>La session se termine lorsque vous tapez <code>exit</code> dans la session, ou lorsque le processus autossh reçoit un signal SIGTERM, SIGINT ou SIGKILL.
</p>
<h4>
<span id="Lancer_automatiquement_autossh_au_d.C3.A9marrage_via_systemd"></span><span class="mw-headline" id="Lancer_automatiquement_autossh_au_démarrage_via_systemd">Lancer automatiquement autossh au démarrage via systemd</span>
</h4>
<p>Si vous souhaitez lancer automatiquement autossh, vous pouvez créer un fichier d'unité systemd :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/autossh.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=AutoSSH service for port 2222
After=network.target

[Service]
Environment="AUTOSSH_GATETIME=0"
ExecStart=/usr/bin/autossh -M 0 -NL 2222:localhost:2222 -o TCPKeepAlive=yes foo@bar.com

[Install]
WantedBy=multi-user.target</pre>
<p>Ici <code>AUTOSSH_GATETIME=0</code> est une variable d'environnement qui spécifie combien de temps ssh doit être actif avant qu'autossh ne le considère comme une connexion réussie. En lui donnant la valeur 0, autossh ignore également l'échec de la première exécution de ssh. Cela peut être utile lorsque autossh est lancé au démarrage. D'autres variables d'environnement sont disponibles à <span class="plainlinks archwiki-template-man" title="$ man 1 autossh"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/autossh.1">autossh(1)</a></span>. Bien sûr, vous pouvez rendre cette unité plus complexe si nécessaire (consultez la documentation de systemd pour plus de détails), et vous pouvez évidemment utiliser vos propres options pour autossh, mais notez que le <code>-f</code> impliquant <code>AUTOSSH_GATETIME=0</code> ne fonctionne pas avec systemd. 
</p>
<p>N'oubliez pas : <a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Démarrez">démarrez</a> et/ou <a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Activez">activez</a> le service par la suite.
</p>
<p>Vous pouvez également avoir besoin de désactiver ControlMaster, par ex.
</p>
<pre>ExecStart=/usr/bin/autossh -M 0 -o ControlMaster=no -NL 2222:localhost:2222 -o TCPKeepAlive=yes foo@bar.com
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Astuce:</strong> Il est également facile de maintenir plusieurs processus autossh, pour garder plusieurs tunnels en vie. Il suffit de créer plusieurs fichiers de service avec des noms différents.</div>
<h3>
<span id="Service_alternatif_en_cas_d.27.C3.A9chec_du_daemon_SSH"></span><span class="mw-headline" id="Service_alternatif_en_cas_d'échec_du_daemon_SSH">Service alternatif en cas d'échec du daemon SSH</span>
</h3>
<p>Pour les serveurs distants ou sans affichage qui reposent exclusivement sur SSH, un échec du démarrage du daemon SSH (par exemple, après une mise à jour du système) peut empêcher l'accès à l'administration. <a href="../fr/Systemd.html" title="Systemd (Français)">systemd</a> offre une solution simple via l'option <code>OnFailure</code>.
</p>
<p>Supposons que le serveur exécute <code>sshd</code> et que <a href="../en/Telnet.html" title="Telnet">telnet</a> soit l'alternative de choix en cas d'échec. Créez un fichier comme suit. N'<a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Activez">activez</a> <b>pas</b> <code>telnet.socket</code> !
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/sshd.service.d/override.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
OnFailure=telnet.socket</pre>
<p>C'est tout. Telnet n'est pas disponible lorsque <code>sshd</code> est en cours d'exécution. Si le démarrage de <code>sshd</code> échoue, une session telnet peut être ouverte pour la récupération.
</p>
<h3>
<span id="Couleur_de_fond_du_terminal_bas.C3.A9e_sur_l.27h.C3.B4te"></span><span class="mw-headline" id="Couleur_de_fond_du_terminal_basée_sur_l'hôte">Couleur de fond du terminal basée sur l'hôte</span>
</h3>
<p>Pour mieux distinguer si vous êtes sur différents hôtes, vous pouvez définir une <a rel="nofollow" class="external text" href="https://bryangilbert.com/post/etc/term/dynamic-ssh-terminal-background-colors/">couleur de fond différente en fonction du type d'hôte</a>.
</p>
<p>Cette solution fonctionne, mais n'est pas universelle (ZSH uniquement).
</p>
<h3>
<span id="Configuration_sp.C3.A9cifique_au_r.C3.A9seau"></span><span class="mw-headline" id="Configuration_spécifique_au_réseau">Configuration spécifique au réseau</span>
</h3>
<p>Vous pouvez utiliser une configuration d'hôte spécifique au réseau auquel vous êtes connecté en utilisant un <code>Match exec</code>.
</p>
<p>Par exemple, lorsque vous utilisez nmcli, et que la connexion est configurée (manuellement ou par DHCP) pour utiliser un domaine de recherche :
</p>
<pre>Match exec "nmcli | grep domains: | grep example.com"
  CanonicalDomains example.com
  # Should you use a different username on this network
  #User username
  # Use a different known_hosts file (for private network or synchronisation)
  #UserKnownHostsFile &lt;network&gt;_known_hosts</pre>
<h3>
<span id="V.C3.A9rification_des_cl.C3.A9s_d.27h.C3.B4tes_des_r.C3.A9seaux_priv.C3.A9s"></span><span class="mw-headline" id="Vérification_des_clés_d'hôtes_des_réseaux_privés">Vérification des clés d'hôtes des réseaux privés</span>
</h3>
<p>Parce que différents serveurs sur différents réseaux sont susceptibles de partager une adresse IP privée commune, vous pourriez vouloir les traiter différemment.
</p>
<p>La meilleure solution consiste à utiliser la <a href="#Configuration_sp%C3%A9cifique_au_r%C3%A9seau">#Configuration spécifique au réseau</a> pour utiliser un <code>UserKnownHostsFile</code> différent selon le réseau sur lequel vous vous trouvez. La seconde solution, qu'il est préférable d'utiliser par défaut lorsque vous travaillez sur des réseaux nouveaux/prototypes, serait d'ignorer tout simplement les clés d'hôte pour les réseaux privés :
</p>
<pre>Host 10.* 192.168.*.* 172.31.* 172.30.* 172.2?.* 172.1?.*
    # Disable HostKey verification
    # Trust HostKey automatically
    StrictHostKeyChecking no
    # Do not save the HostKey
    UserKnownHostsFile=/dev/null
    # Do not display: "Warning: Permanently Added ..."
    LogLevel Error</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Attention:</strong> Dans un environnement de production, assurez-vous d'utiliser le nom d'hôte pour accéder à l'hôte et/ou d'utiliser les fichiers known_hosts spécifiques au réseau.</div>
<h3>
<span id="Ex.C3.A9cuter_une_commande_.C3.A0_la_connexion"></span><span class="mw-headline" id="Exécuter_une_commande_à_la_connexion">Exécuter une commande à la connexion</span>
</h3>
<p>Si vous utilisez une session interactive, il existe plusieurs façons d'exécuter une commande à la connexion :
</p>
<ul>
<li>utiliser le fichier <code>authorized_keys</code> sur l'hôte distant (consultez <code>AUTHORIZED_KEYS FILE FORMAT</code> dans <span class="plainlinks archwiki-template-man" title="$ man 8 sshd"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sshd.8">sshd(8)</a></span>)</li>
<li>utiliser <code>~/.ssh/rc</code> sur l'hôte distant si le serveur a activé l'option <code>PermitUserRC</code>.</li>
<li>Utilisez votre fichier de configuration du shell sur l'hôte distant, par exemple <code>.bashrc</code>.</li>
</ul>
<h3>
<span id="Transfert_d.27agent"></span><span class="mw-headline" id="Transfert_d'agent">Transfert d'agent</span>
</h3>
<p>Le transfert d'agent SSH vous permet d'utiliser vos clés locales lorsque vous êtes connecté à un serveur. Il est recommandé d'activer le transfert d'agent uniquement pour certains hôtes.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.ssh/config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Host <i>myserver.com</i>
    ForwardAgent yes
</pre>
<p>Ensuite, configurez un <a href="../en/SSH_keys.html#SSH_agents" class="mw-redirect" title="SSH agent">agent SSH</a> et ajoutez votre clé locale avec <i>ssh-add</i>.
</p>
<p>Si vous vous connectez maintenant à un serveur distant, vous pourrez vous connecter à d'autres services en utilisant vos clés locales.
</p>
<h3>
<span id="G.C3.A9n.C3.A9ration_de_nouvelles_cl.C3.A9s"></span><span class="mw-headline" id="Génération_de_nouvelles_clés">Génération de nouvelles clés</span>
</h3>
<p>De nouvelles clés privées de serveur peuvent être générées :
</p>
<ol>
<li>Supprimez toutes les clés, par ex : <pre># rm /etc/ssh/ssh_host_*_key*</pre>
</li>
<li>
<a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Redémarrez">Redémarrez</a> <code>sshdgenkeys.service</code> ou exécuter <code>ssh-keygen -A</code> en tant que root.</li>
</ol>
<h2>
<span id="D.C3.A9pannage"></span><span class="mw-headline" id="Dépannage">Dépannage</span>
</h2>
<h3><span class="mw-headline" id="Checklist">Checklist</span></h3>
<p>Vérifiez ces problèmes simples avant de chercher plus loin.
</p>
<ol>
<li>Le répertoire de configuration <code>~/.ssh</code>, son contenu ne doit être accessible que par l'utilisateur (vérifiez-le sur le client et le serveur), et le répertoire personnel de l'utilisateur ne doit être accessible en écriture que par l'utilisateur : <pre>$ chmod go-w ~
$ chmod 700 ~/.ssh
$ chmod 600 ~/.ssh/*
$ chown -R $USER ~/.ssh
</pre>
</li>
<li>Vérifiez que la clé publique du client (par exemple, <code>id_rsa.pub</code>) se trouve dans <code>~/.ssh/authorized_keys</code> sur le serveur.</li>
<li>Vérifiez que vous n'avez pas limité l'accès SSH avec <code>AllowUsers</code> ou <code>AllowGroups</code> dans la <a href="#Configuration_2">configuration du serveur</a>.</li>
<li>Vérifiez si l'utilisateur a défini un mot de passe. Parfois, les nouveaux utilisateurs qui ne se sont pas encore connectés au serveur n'ont pas de mot de passe.</li>
<li>
<a href="../fr/Help:Reading.html#Postposer,_ajouter,_cr%C3%A9er,_modifier" class="mw-redirect" title="Ajoutez">Ajoutez</a> <code>LogLevel DEBUG</code> à <code>/etc/ssh/sshd_config</code>.</li>
<li>Exécutez <code>journalctl -xe</code> en tant que root pour les éventuels messages (d'erreur).</li>
<li>
<a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Redémarrez">Redémarrez</a> <code>sshd</code> et déconnexion/login sur le client et le serveur.</li>
</ol>
<h3>
<span id="Connexion_refus.C3.A9e_ou_probl.C3.A8me_de_timeout"></span><span class="mw-headline" id="Connexion_refusée_ou_problème_de_timeout">Connexion refusée ou problème de timeout</span>
</h3>
<h4><span class="mw-headline" id="Redirection_de_port">Redirection de port</span></h4>
<p>Si vous êtes derrière un mode/routeur NAT (ce qui est probable, sauf si vous êtes sur un VPS ou un hôte à adresse publique), assurez-vous que votre routeur transfère les connexions ssh entrantes vers votre machine. Trouvez l'adresse IP interne du serveur avec <code>$ ip addr</code> et configurez votre routeur pour qu'il transfère le TCP sur votre port SSH vers cette IP. <a rel="nofollow" class="external text" href="https://portforward.com">portforward.com</a> peut vous aider à le faire.
</p>
<h4>
<span id="Est-ce_que_SSH_fonctionne_et_.C3.A9coute_.3F"></span><span class="mw-headline" id="Est-ce_que_SSH_fonctionne_et_écoute_?">Est-ce que SSH fonctionne et écoute ?</span>
</h4>
<p>L'utilitaire <a href="../en/Network_configuration.html#Investigate_sockets" title="Network configuration">ss</a> affiche tous les processus qui écoutent un port TCP avec la ligne de commande suivante :
</p>
<pre>$ ss --tcp --listening
</pre>
<p>Si la commande ci-dessus ne montre pas que le système écoute le port <code>ssh</code>, alors SSH ne fonctionne pas : vérifiez le <a href="../en/Systemd/Journal.html" class="mw-redirect" title="Journal">journal</a> pour les erreurs, etc.
</p>
<h4>
<span id="Des_r.C3.A8gles_de_pare-feu_bloquent-elles_la_connexion_.3F"></span><span class="mw-headline" id="Des_règles_de_pare-feu_bloquent-elles_la_connexion_?">Des règles de pare-feu bloquent-elles la connexion ?</span>
</h4>
<p><a href="../fr/Iptables.html" title="Iptables (Français)">iptables</a> peut bloquer les connexions sur le port <code>22</code>. Vérifiez-le avec :
</p>
<pre># iptables -nvL</pre>
<p>et recherchez les règles qui pourraient bloquer des paquets sur la chaîne <code>INPUT</code>. Ensuite, si nécessaire, débloquez le port avec une commande telle que : 
</p>
<pre># iptables -I INPUT 1 -p tcp --dport 22 -j ACCEPT
</pre>
<p>Pour plus d'aide sur la configuration des pare-feu, consultez <a href="../fr/Category:Firewalls.html" class="mw-redirect" title="Pare-feu">pare-feu</a>.
</p>
<h4>
<span id="Le_trafic_arrive-t-il_jusqu.27.C3.A0_votre_ordinateur_.3F"></span><span class="mw-headline" id="Le_trafic_arrive-t-il_jusqu'à_votre_ordinateur_?">Le trafic arrive-t-il jusqu'à votre ordinateur ?</span>
</h4>
<p>Lancez une vidange du trafic sur l'ordinateur avec lequel vous avez des problèmes :
</p>
<pre># tcpdump -lnn -i any port ssh et tcp-syn
</pre>
<p>Cette opération devrait afficher des informations de base, puis attendre qu'un trafic correspondant se produise avant de l'afficher. Essayez votre connexion maintenant. Si vous ne consultez aucun résultat lorsque vous tentez de vous connecter, c'est que quelque chose d'extérieur à votre ordinateur bloque le trafic (par exemple, un pare-feu matériel, un routeur NAT, etc.).
</p>
<h4>
<span id="Votre_FAI_ou_un_tiers_bloque_le_port_par_d.C3.A9faut_.3F"></span><span class="mw-headline" id="Votre_FAI_ou_un_tiers_bloque_le_port_par_défaut_?">Votre FAI ou un tiers bloque le port par défaut ?</span>
</h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Essayez cette étape si vous <i>savez</i> que vous n'utilisez pas de pare-feu et que vous avez configuré le routeur en DMZ ou que vous avez transféré le port vers votre ordinateur, mais que cela ne fonctionne toujours pas. Vous trouverez ici des étapes de diagnostic et une solution possible.</div>
<p>Dans certains cas, votre FAI peut bloquer le port par défaut (port SSH 22), de sorte que tout ce que vous tentez (ouverture de ports, durcissement de la pile, défense contre les attaques par inondation, etc.) est inutile. Pour confirmer cela, créez un serveur sur toutes les interfaces (0.0.0.0) et connectez-vous à distance. 
</p>
<p>Si vous obtenez un message d'erreur comparable à celui-ci :
</p>
<pre>ssh : connect to host www.inet.hr port 22 : Connection refused
</pre>
<p>Cela signifie que le port n'est <b>pas</b> bloqué par le FAI, mais que le serveur n'exécute pas SSH sur ce port (consultez <a href="https://en.wikipedia.org/wiki/fr:S%C3%A9curit%C3%A9_par_l%27obscurit%C3%A9" class="extiw" title="wikipedia:fr:Sécurité par l'obscurité">wikipedia:fr:Sécurité par l'obscurité</a>).
</p>
<p>Toutefois, si vous obtenez un message d'erreur comparable à celui-ci :
</p>
<pre>ssh : connect to host 111.222.333.444 port 22 : Operation timed out 
</pre>
<p>Cela signifie que quelque chose rejette votre trafic TCP sur le port 22. En fait, ce port est furtif, soit à cause de votre pare-feu, soit à cause de l'intervention d'un tiers (comme un FAI qui bloque et/ou rejette le trafic entrant sur le port 22). Si vous savez que vous n'exécutez pas de pare-feu sur votre ordinateur et que vous savez que les Gremlins ne pullulent pas dans vos routeurs et switchs, alors votre FAI bloque le trafic.
</p>
<p>Pour vérifier, vous pouvez exécuter Wireshark sur votre serveur et écouter le trafic sur le port 22. Étant donné que Wireshark est un utilitaire de reniflage de paquets de couche 2, et que TCP/UDP sont des couches 3 et plus (consultez <a href="https://en.wikipedia.org/wiki/Internet_protocol_suite" class="extiw" title="wikipedia:Internet protocol suite">IP Network stack</a>), si vous ne recevez rien lorsque vous vous connectez à distance, il est fort probable qu'un tiers bloque le trafic sur ce port vers votre serveur.
</p>
<h5><span class="mw-headline" id="Diagnostic">Diagnostic</span></h5>
<p><a href="../fr/Help:Reading.html#Installation_de_paquets" class="mw-redirect" title="Installez">Installez</a> soit <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=tcpdump">tcpdump</a></span> soit Wireshark avec le paquet <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=wireshark-cli">wireshark-cli</a></span>.
</p>
<p>Pour tcpdump :
</p>
<pre># tcpdump -ni <i>interface</i> "port 22"
</pre>
<p>Pour Wireshark :
</p>
<pre>$ tshark -f "tcp port 22" -i <i>interface</i>
</pre>
<p>où <code><i>interface</i></code> est l'interface réseau pour une connexion WAN (consultez <code>ip a</code> pour vérifier). Si vous ne recevez aucun paquet lorsque vous essayez de vous connecter à distance, vous pouvez être certain que votre FAI bloque le trafic entrant sur le port 22.
</p>
<h5><span class="mw-headline" id="Solution_possible">Solution possible</span></h5>
<p>La solution consiste simplement à utiliser un autre port que le FAI ne bloque pas. Ouvrez le <code>/etc/ssh/sshd_config</code> et configurez le fichier pour utiliser différents ports. Par exemple, ajoutez :
</p>
<pre>Port 22
Port 1234
</pre>
<p>Assurez-vous également que les autres lignes de configuration du "Port" dans le fichier sont commentées. Le fait de commenter "Port 22" et de mettre "Port 1234" ne résoudra pas le problème car sshd n'écoutera que sur le port 1234. Utilisez les deux lignes pour exécuter le serveur SSH sur les deux ports. 
</p>
<p><a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Redémarrez">Redémarrez</a> le serveur <code>sshd.service</code> et vous avez presque terminé. Vous devez encore configurer votre ou vos clients pour qu'ils utilisent l'autre port au lieu du port par défaut. Il existe de nombreuses solutions à ce problème, mais nous allons en aborder deux ici.
</p>
<h4>
<span id=".C3.89chec_de_la_lecture_de_la_socket_:_la_connexion_a_.C3.A9t.C3.A9_r.C3.A9initialis.C3.A9e_par_le_pair"></span><span class="mw-headline" id="Échec_de_la_lecture_de_la_socket_:_la_connexion_a_été_réinitialisée_par_le_pair">Échec de la lecture de la socket : la connexion a été réinitialisée par le pair</span>
</h4>
<p>Les versions récentes d'openssh échouent parfois avec le message d'erreur ci-dessus lors de la connexion à des serveurs ssh plus anciens. Ce problème peut être contourné en définissant diverses <a href="#Configuration">options du client</a> pour cet hôte. Consultez <span class="plainlinks archwiki-template-man" title="$ man 5 ssh_config"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ssh_config.5">ssh_config(5)</a></span> pour plus d'informations sur les options suivantes.
</p>
<p>Le problème peut provenir des algorithmes de clé hôte elliptique <code>ecdsa-sha2-nistp*-cert-v01@openssh</code>. Ceux-ci peuvent être désactivés en définissant <code>HostKeyAlgorithms</code> comme une liste excluant ces algorithmes.
</p>
<p>Si cela ne fonctionne pas, il se peut que la liste des algorithmes de chiffrement soit trop longue. Définissez l'option <code>Ciphers</code> sur une liste plus courte (moins de 80 caractères devraient suffire). De même, vous pouvez essayer de raccourcir la liste des <code>MAC</code>.
</p>
<p>Consultez également la <a rel="nofollow" class="external text" href="https://www.gossamer-threads.com/lists/openssh/dev/51339">discussion</a> sur le forum des bogues d'openssh.
</p>
<h3>
<span id=".22.5Bvotre_shell.5D_:_No_such_file_or_directory.22_.2F_probl.C3.A8me_de_ssh_exchange_identification"></span><span class="mw-headline" id='"[votre_shell]_:_No_such_file_or_directory"_/_problème_de_ssh_exchange_identification'>"[votre shell] : No such file or directory" / problème de ssh_exchange_identification</span>
</h3>
<p>Une cause possible de ce problème est le besoin de certains clients SSH de trouver un chemin absolu (celui renvoyé par <code>whereis -b [votre shell]</code>, par exemple) dans <code>$SHELL</code>, même si le binaire du shell est situé dans l'une des entrées <code>$PATH</code>.
</p>
<h3>
<span id="Message_d.27erreur_.22Terminal_inconnu.22_ou_.22Erreur_d.27ouverture_de_terminal.22"></span><span class="mw-headline" id="Message_d'erreur_&quot;Terminal_inconnu&quot;_ou_&quot;Erreur_d'ouverture_de_terminal&quot;">Message d'erreur "Terminal inconnu" ou "Erreur d'ouverture de terminal"</span>
</h3>
<p>Si vous recevez les erreurs ci-dessus lors de la connexion, cela signifie que le serveur ne reconnaît pas votre terminal. Les applications Ncurses comme nano peuvent échouer avec le message "Error opening terminal".
</p>
<p>La bonne solution est d'installer le fichier terminfo du terminal du client sur le serveur. Ce fichier indique aux programmes de console sur le serveur comment interagir correctement avec votre terminal. Vous pouvez obtenir des informations sur le fichier terminfo actuel à l'aide de <code>$ infocmp</code>, puis trouver <a href="../fr/Pacman.html#Interrogation_de_la_base_de_donn%C3%A9es_des_paquets" title="Pacman (Français)">à quel paquet il appartient</a>.
</p>
<p>Si vous ne pouvez pas l'<a href="../fr/Help:Reading.html#Installation_de_paquets" class="mw-redirect" title="Installer">installer</a> normalement, vous pouvez copier votre terminfo dans votre répertoire personnel sur le serveur :
</p>
<pre>$ ssh myserver mkdir -p ~/.terminfo/${TERM:0:1}
$ scp /usr/share/terminfo/${TERM:0:1}/$TERM myserver:~/.terminfo/${TERM:0:1}/
</pre>
<p>Après avoir ouvert et fermé une session sur le serveur, le problème devrait être résolu.
</p>
<h4><span class="mw-headline" id="TERM_hack">TERM hack</span></h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Ceci ne doit être utilisé qu'en dernier recours.</div>
<p>Vous pouvez aussi simplement définir <code>TERM=xterm</code> dans votre environnement sur le serveur (par exemple dans <code>.bash_profile</code>). Cela fera taire l'erreur et permettra aux applications ncurses de s'exécuter à nouveau, mais vous pouvez avoir un comportement étrange et des problèmes graphiques à moins que les séquences de contrôle de votre terminal ne correspondent exactement à celles de xterm.
</p>
<h3>
<span id="Connexion_ferm.C3.A9e_par_x.x.x.x_.5Bpreauth.5D"></span><span class="mw-headline" id="Connexion_fermée_par_x.x.x.x_[preauth]">Connexion fermée par x.x.x.x [preauth]</span>
</h3>
<p>Si vous consultez cette erreur dans les journaux sshd, vérifiez que vous avez défini une clé d'hôte valide.
</p>
<pre>HostKey /etc/ssh/ssh_host_rsa_key
</pre>
<h3><span class="mw-headline" id="subsystem_request_failed">subsystem request failed</span></h3>
<p>Depuis <i>OpenSSH</i> 8.8, <i>scp</i> utilise <i>SFTP</i> comme protocole par défaut pour les transferts de données en demandant le sous-système nommé <code>sftp</code>. Si vous exécutez <i>scp</i> en mode verbeux, <code>scp -v</code>, vous pouvez déterminer quel sous-système votre client utilise (par exemple, <code>Sending subsystem: <i>nom_du_sous-système</i></code>). Les erreurs telles que <code>subsystem request failed on channel 0</code> peuvent être corrigées en configurant les paramètres du sous-système du serveur : <span class="plainlinks archwiki-template-man" title="$ man 5 sshd_config"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sshd_config.5#Subsystem">sshd_config(5) § Subsystem</a></span>. La configuration du serveur doit ressembler à l'exemple ci-dessous.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ssh/sshd_config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
Subsystem subsystem-name /path/to/subsystem-executable
...
</pre>
<h3>
<span id="id_dsa_refus.C3.A9_par_OpenSSH_7.0"></span><span class="mw-headline" id="id_dsa_refusé_par_OpenSSH_7.0">id_dsa refusé par OpenSSH 7.0</span>
</h3>
<p>OpenSSH 7.0 a déprécié les clés publiques DSA pour des raisons de sécurité. Si vous devez absolument les activer, définissez l'option de <a href="#Configuration">configuration</a> <code>PubkeyAcceptedKeyTypes +ssh-dss</code>. (<a rel="nofollow" class="external free" href="https://www.openssh.com/legacy.html">https://www.openssh.com/legacy.html</a> ne le mentionne pas).
</p>
<h3>
<span id="Aucune_m.C3.A9thode_d.27.C3.A9change_de_cl.C3.A9s_correspondante_trouv.C3.A9e_par_OpenSSH_7.0"></span><span class="mw-headline" id="Aucune_méthode_d'échange_de_clés_correspondante_trouvée_par_OpenSSH_7.0">Aucune méthode d'échange de clés correspondante trouvée par OpenSSH 7.0</span>
</h3>
<p>OpenSSH 7.0 a déprécié l'algorithme de clé diffie-hellman-group1-sha1 car il est faible et se trouve dans la portée théorique de l'attaque dite Logjam (consultez <a rel="nofollow" class="external free" href="https://www.openssh.com/legacy.html">https://www.openssh.com/legacy.html</a>). Si l'algorithme de clé est nécessaire pour un hôte particulier, ssh produira un message d'erreur comme celui-ci :
</p>
<pre>Unable to negotiate with 127.0.0.1: no matching key exchange method found.
Their offer: diffie-hellman-group1-sha1
</pre>
<p>La meilleure solution pour ces échecs est de mettre à jour/configurer le serveur pour ne pas utiliser les algorithmes dépréciés. Si cela n'est pas possible, vous pouvez forcer le client à réactiver l'algorithme avec l'option <a href="#Configuration">client</a>. <code>KexAlgorithmes +diffie-hellman-group1-sha1</code>.
</p>
<h3>
<span id="Session_tmux.2Fscreen_tu.C3.A9e_lors_de_la_d.C3.A9connexion_de_SSH"></span><span class="mw-headline" id="Session_tmux/screen_tuée_lors_de_la_déconnexion_de_SSH">Session tmux/screen tuée lors de la déconnexion de SSH</span>
</h3>
<p>Si vos processus sont tués à la fin de la session, il est possible que vous utilisiez l'activation de la socket et qu'elle soit tuée par <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=systemd">systemd</a></span> lorsqu'elle remarque que le processus de la session SSH a quitté. Dans ce cas, il existe deux solutions. La première consiste à éviter d'utiliser l'activation de socket en utilisant <code>ssh.service</code> au lieu de <code>ssh.socket</code>. L'autre consiste à définir <code>KillMode=process</code> dans la section Service de <code>ssh@.service</code>.
</p>
<p>Le paramètre <code>KillMode=process</code> peut également être utile avec le classique <code>ssh.service</code>, car il évite de tuer le processus de session SSH ou les processus <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=screen">screen</a></span> ou <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=tmux">tmux</a></span> lorsque le serveur est arrêté ou redémarré.
</p>
<h3>
<span id="La_session_SSH_cesse_de_r.C3.A9pondre"></span><span class="mw-headline" id="La_session_SSH_cesse_de_répondre">La session SSH cesse de répondre</span>
</h3>
<p>SSH répond aux <a href="https://en.wikipedia.org/wiki/Software_flow_control" class="extiw" title="wikipedia:Software flow control">commandes de contrôle de flux</a> <code>XON</code> et <code>XOFF</code>. Il se fige/se fige/cesse de répondre lorsque vous appuyez sur <code>Ctrl+s</code>. Utilisez <code>Ctrl+q</code> pour reprendre votre session.
</p>
<h3><span class="mw-headline" id="Broken_pipe">Broken pipe</span></h3>
<p>Si vous tentez de créer une connexion qui donne lieu à une réponse <code>Broken pipe</code> pour <code>packet_write_wait</code>, vous devez réessayer la connexion en mode débogage et consulter si la sortie se termine par une erreur :
</p>
<pre>debug3 : send packet : type 1
packet_write_wait : Connexion au port 22 de A.B.C.D : pipe cassé</pre>
<p>La ligne <code>send packet</code> ci-dessus indique que le paquet de réponse n'a jamais été reçu. Il s'ensuit donc qu'il s'agit d'un problème de <i>QoS</i>. Pour diminuer la probabilité qu'un paquet soit abandonné, définissez <code>IPQoS</code> :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ssh/ssh_config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Host *
    IPQoS reliability</pre>
<p>Le paramètre <code>reliability</code> (<code>0x04</code>) devrait résoudre le problème, ainsi que les types de service <code>0x00</code> et <code>throughput</code>. (<code>0x08</code>).
</p>
<h3>
<span id="D.C3.A9marrage_lent_des_daemons_apr.C3.A8s_un_red.C3.A9marrage"></span><span class="mw-headline" id="Démarrage_lent_des_daemons_après_un_redémarrage">Démarrage lent des daemons après un redémarrage</span>
</h3>
<p>Si vous rencontrez des temps de démarrage de daemon excessivement longs après les redémarrages (par exemple, plusieurs minutes avant que le daemon ne commence à accepter des connexions), en particulier sur des serveurs sans affichage («headless») ou virtualisés, cela peut être dû à un manque d'entropie <a rel="nofollow" class="external autonumber" href="https://bbs.archlinux.org/viewtopic.php?id=241954">[2]</a>. Cela peut être résolu en installant <a href="../en/Rng-tools.html" title="Rng-tools">Rng-tools</a> ou <a href="../en/Haveged.html" title="Haveged">Haveged</a>, selon ce qui convient à votre système. Cependant, prenez note des implications de sécurité associées discutées dans la page wiki respective de chaque paquet.
</p>
<h3>
<span id="Terminer_une_connexion_SSH_qui_ne_r.C3.A9pond_pas"></span><span class="mw-headline" id="Terminer_une_connexion_SSH_qui_ne_répond_pas">Terminer une connexion SSH qui ne répond pas</span>
</h3>
<p>Si une session client ne répond plus et ne peut être interrompue en donnant des instructions au programme en cours d'exécution (par exemple, le <a href="../en/Command-line_shell.html" class="mw-redirect" title="Shell">shell</a>), vous pouvez toujours mettre fin à la session en appuyant successivement sur <code>Enter</code>, <code>~</code> et <code>.</code> dans cet ordre.
</p>
<p>Le <code>~</code> est un caractère d'échappement pseudo-terminal (consultez <span class="plainlinks archwiki-template-man" title="$ man 1 ssh"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ssh.1#ESCAPE_CHARACTERS">ssh(1) § ESCAPE CHARACTERS</a></span>), qui peut être ajouté plusieurs fois en fonction de la session client à interrompre. Par exemple, si vous vous êtes connecté de A à B puis de B à C et que la session de B à C se fige, vous pouvez y mettre fin en appuyant sur <code>Enter</code> et en tapant <code>~~.</code>, ce qui vous laissera dans une session de travail sur B.
</p>
<h3>
<span id="Attention_:_l.27identification_de_l.27h.C3.B4te_distant_a_chang.C3.A9_.21"></span><span class="mw-headline" id="Attention_:_l'identification_de_l'hôte_distant_a_changé_!">Attention : l'identification de l'hôte distant a changé !</span>
</h3>
<p>Si le client vous avertit que la clé d'un serveur ssh a changé, vous devez vérifier que la nouvelle clé proposée appartient bien à l'opérateur du serveur. Ensuite, supprimez l'ancienne clé du fichier <code>known_hosts</code> avec <code>ssh-keygen -R $SSH_HOST</code> et acceptez la nouvelle clé comme s'il s'agissait d'un nouveau serveur.
</p>
<h3>
<span id="Connexion_.C3.A0_un_serveur_distant_sans_l.27entr.C3.A9e_terminfo_appropri.C3.A9e"></span><span class="mw-headline" id="Connexion_à_un_serveur_distant_sans_l'entrée_terminfo_appropriée">Connexion à un serveur distant sans l'entrée terminfo appropriée</span>
</h3>
<p>Lorsque vous vous connectez à des hôtes qui n'ont pas d'entrée terminfo pour votre terminal, par exemple, lorsque vous utilisez un émulateur de terminal dont l'entrée terminfo n'est pas fournie avec <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ncurses">ncurses</a></span>. (par exemple, <a href="../en/Kitty.html" title="Kitty">kitty</a> et <a href="../en/Rxvt-unicode.html" class="mw-redirect" title="Rxvt-unicode (Français)">rxvt-unicode</a>), ou lorsque vous vous connectez à des hôtes dont la base de données terminfo est limitée (par exemple, les systèmes exécutant <a href="https://en.wikipedia.org/wiki/OpenWrt" class="extiw" title="wikipedia:OpenWrt">OpenWrt</a>), divers problèmes peuvent survenir avec les logiciels qui reposent sur <span class="plainlinks archwiki-template-man" title="$ man 5 terminfo"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/terminfo.5">terminfo(5)</a></span>.
</p>
<p>Une bonne solution consiste à placer l'entrée terminfo appropriée sur l'hôte. Si cela n'est pas possible, une alternative est de définir <code>TERM</code> à une valeur qui est à la fois prise en charge par l'hôte distant et compatible avec le terminal.
</p>
<p>Depuis OpenSSH 8.7, une variable d'environnement <code>TERM</code> personnalisée peut être passée aux hôtes distants avec un simple extrait de configuration :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.ssh/config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Host example.com
  SetEnv TERM=xterm-256color</pre>
<h3>
<span id="La_connexion_.C3.A0_travers_l.27h.C3.B4te_de_saut_.C3.A9choue_avec_.22bash_:_No_such_file_or_directory.22"></span><span class="mw-headline" id="La_connexion_à_travers_l'hôte_de_saut_échoue_avec_&quot;bash_:_No_such_file_or_directory&quot;">La connexion à travers l'hôte de saut échoue avec "bash : No such file or directory"</span>
</h3>
<p>Si la variable d'environnement <code>SHELL</code> n'est pas définie sur un chemin complet et valide (sur le serveur de saut), la connexion échouera avec un message d'erreur similaire à celui-ci :
</p>
<pre>bash: No such file or directory
kex_exchange_identification: Connection closed by remote host
Connection closed by UNKNOWN port 65535
</pre>
<p>Vous pouvez simplement résoudre ce problème en définissant votre <code>SHELL</code> à un nom de chemin complet d'un shell qui sera également valide sur le serveur de saut ou en définissant une variable <code>SHELL</code> spécifique pour chaque serveur dans votre fichier <code>~/.ssh/config</code>.
</p>
<h2><span class="mw-headline" id="Voir_aussi">Voir aussi</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://www.la-samhna.de/library/brutessh.html">Se défendre contre les attaques ssh par force brute</a></li>
<li>Gestion des clés OpenSSH : <a rel="nofollow" class="external text" href="https://www.ibm.com/developerworks/library/l-keyc/index.html">Partie 1</a> sur IBM developerWorks, <a href="https://www.funtoo.org/OpenSSH_Key_Management,_Part_2" class="extiw" title="funtoo:OpenSSH Key Management, Part 2">Partie 2</a>, <a href="https://www.funtoo.org/OpenSSH_Key_Management,_Part_3" class="extiw" title="funtoo:OpenSSH Key Management, Part 3">Partie 3</a> sur funtoo.org</li>
<li><a rel="nofollow" class="external text" href="https://stribika.github.io/2015/01/04/secure-secure-shell.html">Sécuriser Secure Shell</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../fr/Category:Secure_Shell.html" title="Category:Secure Shell (Français)">Secure Shell (Français)</a></li>
<li><a href="../fr/Category:Servers.html" title="Category:Servers (Français)">Servers (Français)</a></li>
<li><a href="../fr/Category:OpenBSD.html" title="Category:OpenBSD (Français)">OpenBSD (Français)</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_with_broken_package_links.html" title="Category:Pages with broken package links">Pages with broken package links</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=OpenSSH_(Fran%C3%A7ais)&amp;oldid=801425">https://wiki.archlinux.org/index.php?title=OpenSSH_(Français)&amp;oldid=801425</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 27 February 2024, at 20:32.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
