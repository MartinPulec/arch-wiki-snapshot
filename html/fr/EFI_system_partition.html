<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>EFI system partition (Français) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-EFI_system_partition_Français rootpage-EFI_system_partition_Français skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Vérifier_s'il_y_a_une_partition_existante" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#V%C3%A9rifier_s'il_y_a_une_partition_existante">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Vérifier s'il y a une partition existante</div>
		</a>
		
		<ul id="toc-Vérifier_s'il_y_a_une_partition_existante-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Créer_la_partition" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Cr%C3%A9er_la_partition">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Créer la partition</div>
		</a>
		
			<button aria-controls="toc-Créer_la_partition-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Créer la partition subsection</span>
			</button>
		
		<ul id="toc-Créer_la_partition-sublist" class="vector-toc-list">
			<li id="toc-Disques_partitionnés_en_GPT" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Disques_partitionn%C3%A9s_en_GPT">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Disques partitionnés en GPT</div>
			</a>
			
			<ul id="toc-Disques_partitionnés_en_GPT-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Disques_partitionnés_en_MBR" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Disques_partitionn%C3%A9s_en_MBR">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>Disques partitionnés en MBR</div>
			</a>
			
			<ul id="toc-Disques_partitionnés_en_MBR-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Formater_la_partition" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Formater_la_partition">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Formater la partition</div>
		</a>
		
		<ul id="toc-Formater_la_partition-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Monter_la_partition" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Monter_la_partition">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Monter la partition</div>
		</a>
		
			<button aria-controls="toc-Monter_la_partition-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Monter la partition subsection</span>
			</button>
		
		<ul id="toc-Monter_la_partition-sublist" class="vector-toc-list">
			<li id="toc-Points_de_montage_habituels" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Points_de_montage_habituels">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>Points de montage habituels</div>
			</a>
			
			<ul id="toc-Points_de_montage_habituels-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Points_de_montage_alternatifs" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Points_de_montage_alternatifs">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2</span>Points de montage alternatifs</div>
			</a>
			
			<ul id="toc-Points_de_montage_alternatifs-sublist" class="vector-toc-list">
				<li id="toc-Avec_un_bind" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Avec_un_bind">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2.1</span>Avec un <i>bind</i>
</div>
			</a>
			
			<ul id="toc-Avec_un_bind-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Avec_systemd" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Avec_systemd">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2.2</span>Avec systemd</div>
			</a>
			
			<ul id="toc-Avec_systemd-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Avec_les_événements_du_système_de_fichiers" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Avec_les_%C3%A9v%C3%A9nements_du_syst%C3%A8me_de_fichiers">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2.3</span>Avec les événements du système de fichiers</div>
			</a>
			
			<ul id="toc-Avec_les_événements_du_système_de_fichiers-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Avec_un_hook_de_mkinitcpio" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Avec_un_hook_de_mkinitcpio">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2.4</span>Avec un <i>hook</i> de mkinitcpio</div>
			</a>
			
			<ul id="toc-Avec_un_hook_de_mkinitcpio-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Avec_un_pré-réglage_mkinitcpio" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Avec_un_pr%C3%A9-r%C3%A9glage_mkinitcpio">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2.5</span>Avec un pré-réglage mkinitcpio</div>
			</a>
			
			<ul id="toc-Avec_un_pré-réglage_mkinitcpio-sublist" class="vector-toc-list">
				<li id="toc-Remplacer_le_hook_mkinitcpio_ci-dessus" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Remplacer_le_hook_mkinitcpio_ci-dessus">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2.5.1</span>Remplacer le <i>hook</i> mkinitcpio ci-dessus</div>
			</a>
			
			<ul id="toc-Remplacer_le_hook_mkinitcpio_ci-dessus-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Un_autre_exemple" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Un_autre_exemple">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2.5.2</span>Un autre exemple</div>
			</a>
			
			<ul id="toc-Un_autre_exemple-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Avec_un_hook_pacman" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Avec_un_hook_pacman">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2.6</span>Avec un <i>hook</i> pacman</div>
			</a>
			
			<ul id="toc-Avec_un_hook_pacman-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Dépannage" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#D%C3%A9pannage">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Dépannage</div>
		</a>
		
			<button aria-controls="toc-Dépannage-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Dépannage subsection</span>
			</button>
		
		<ul id="toc-Dépannage-sublist" class="vector-toc-list">
			<li id="toc-ESP_sur_RAID1_logiciel" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#ESP_sur_RAID1_logiciel">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1</span>ESP sur RAID1 logiciel</div>
			</a>
			
			<ul id="toc-ESP_sur_RAID1_logiciel-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Le_microprogramme_ne_voit_pas_le_répertoire_EFI" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Le_microprogramme_ne_voit_pas_le_r%C3%A9pertoire_EFI">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2</span>Le microprogramme ne voit pas le répertoire EFI</div>
			</a>
			
			<ul id="toc-Le_microprogramme_ne_voit_pas_le_répertoire_EFI-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Voir_aussi" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Voir_aussi">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>Voir aussi</div>
		</a>
		
		<ul id="toc-Voir_aussi-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">EFI system partition (Français)</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 6 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-6" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">6 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-en mw-list-item"><a href="../en/EFI_system_partition.html" title="EFI system partition – English" lang="en" hreflang="en" class="interlanguage-link-target"><span>English</span></a></li>
<li class="interlanguage-link interwiki-es mw-list-item"><a href="../es/EFI_system_partition.html" title="EFI system partition – español" lang="es" hreflang="es" class="interlanguage-link-target"><span>Español</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/EFI_%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E3%83%91%E3%83%BC%E3%83%86%E3%82%A3%E3%82%B7%E3%83%A7%E3%83%B3" title="EFI システムパーティション – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-pt mw-list-item"><a href="../pt/EFI_system_partition.html" title="EFI system partition – português" lang="pt" hreflang="pt" class="interlanguage-link-target"><span>Português</span></a></li>
<li class="interlanguage-link interwiki-ru mw-list-item"><a href="../ru/EFI_system_partition.html" title="EFI system partition – русский" lang="ru" hreflang="ru" class="interlanguage-link-target"><span>Русский</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/EFI_system_partition" title="EFI system partition – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="fr" dir="ltr">
<div class="archwiki-template-box archwiki-template-box-note">
<strong>État de la traduction:</strong> Cet article est la version francophone de <a href="../en/EFI_system_partition.html" title="EFI system partition">EFI system partition</a>. Date de la dernière traduction: 2022-07-28. Vous pouvez aider à synchroniser la traduction s'il y a eu des <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=EFI_system_partition&amp;diff=0&amp;oldid=726809">changements</a> dans la version anglaise.</div>
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/Unified_Extensible_Firmware_Interface.html" title="Unified Extensible Firmware Interface">Unified Extensible Firmware Interface</a></li>
<li><a href="../fr/Arch_boot_process.html#Chargeur_d'amor%C3%A7age" class="mw-redirect" title="Chargeur d'amorçage">Chargeur d'amorçage</a></li>
</ul>
</div>
<p>L'<b>ESP</b>, pour <a href="https://en.wikipedia.org/wiki/EFI_system_partition" class="extiw" title="wikipedia:EFI system partition">EFI system partition</a> en anglais, est une partition indépendante du système d'exploitation qui sert de lieu de stockage pour les chargeurs d'amorçage EFI, les applications et les pilotes à lancer par le microprogramme UEFI. Elle est obligatoire pour le démarrage UEFI. 
</p>
<meta property="mw:PageProp/toc">
<h2>
<span id="V.C3.A9rifier_s.27il_y_a_une_partition_existante"></span><span class="mw-headline" id="Vérifier_s'il_y_a_une_partition_existante">Vérifier s'il y a une partition existante</span>
</h2>
<p>Si vous installez Arch Linux sur un ordinateur avec UEFI et un système d'exploitation installé, comme par exemple <a href="../fr/Dual_boot_with_Windows.html" title="Dual boot with Windows (Français)">Windows</a> 10, il est très probable que vous ayez déjà une partition système EFI.
</p>
<p>Pour connaître le schéma de partition du disque et la partition système, utilisez <a href="../en/Fdisk.html" title="Fdisk">fdisk</a> en tant que root sur le disque à partir duquel vous voulez démarrer :
</p>
<pre># fdisk -l /dev/sd<i>x</i>
</pre>
<p>La commande renvoie :
</p>
<ul>
<li>La table de partition du disque : elle indique <code>Disklabel type : gpt</code> si la table de partition est <a href="../en/Partitioning.html#GUID_Partition_Table" class="mw-redirect" title="GPT">GPT</a> ou <code>Disklabel type : dos</code> si elle est <a href="../en/Partitioning.html#Master_Boot_Record" class="mw-redirect" title="MBR">MBR</a>.</li>
<li>La liste des partitions sur le disque : Recherchez la partition système EFI dans la liste, elle fait généralement au moins 100 MiB et a le type <code>EFI System</code> ou <code>EFI (FAT-12/16/32)</code>. Pour confirmer qu'il s'agit bien de l'ESP, montez-la et vérifiez si elle contient un répertoire nommé <code>EFI</code> : si c'est le cas, il s'agit bien de l'ESP.</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Astuce:</strong> Pour savoir s'il s'agit d'un système de fichiers FAT12, FAT16 ou FAT32, consultez <a href="../en/FAT.html#Detecting_FAT_type" title="FAT">FAT#Detecting FAT type</a>.</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Attention:</strong> Lors d'un <i>dual-boot</i>, évitez de reformater l'ESP, car il peut contenir des fichiers nécessaires au démarrage des autres systèmes d'exploitation.</div>
<p>Si vous avez trouvé une partition système EFI existante, passez simplement à <a href="#Monter_la_partition">#Monter la partition</a>. Si vous n'en avez pas trouvé, vous devrez la créer, allez à <a href="#Cr%C3%A9er_la_partition">#Créer la partition</a>.
</p>
<h2>
<span id="Cr.C3.A9er_la_partition"></span><span class="mw-headline" id="Créer_la_partition">Créer la partition</span>
</h2>
<p>Les deux sections suivantes montrent comment créer une partition système EFI (ESP).
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Attention:</strong> La partition système EFI doit être une partition physique dans la table de partition principale du disque, pas sous LVM ni RAID logiciel etc...</div>
<p>La taille de la partition doit fournir un espace suffisant pour stocker les chargeurs d'amorçage et les autres fichiers nécessaires au démarrage.
</p>
<p>Pour éviter les problèmes d'interopérabilité avec d'autres systèmes d'exploitation <a rel="nofollow" class="external autonumber" href="https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/configure-uefigpt-based-hard-drive-partitions#diskpartitionrules">[1]</a> <a rel="nofollow" class="external autonumber" href="https://superuser.com/questions/1310927/what-is-the-absolute-minimum-size-a-uefi-partition-can-be/1310938">[2]</a>, il est recommandé de lui allouer au moins 300 MiB. Pour les anciennes implémentations UEFI et/ou celles boguées, une taille d'au moins 512 MiB peut être nécessaire. <a rel="nofollow" class="external autonumber" href="https://www.rodsbooks.com/efi-bootloaders/principles.html">[3]</a> Si aucun de ces problèmes ne vous concerne, la taille de la partition peut être aussi petite que 2 MiB, auquel cas elle ne pourra rien contenir de plus qu'un chargeur d'amorçage.
</p>
<h3>
<span id="Disques_partitionn.C3.A9s_en_GPT"></span><span class="mw-headline" id="Disques_partitionnés_en_GPT">Disques partitionnés en GPT</span>
</h3>
<p>La partition système EFI sur une <a href="../en/Partitioning.html#GUID_Partition_Table" class="mw-redirect" title="GUID Partition Table">Table de partition GUID</a> est identifiée par le <a href="https://en.wikipedia.org/wiki/GUID_Partition_Table#Partition_type_GUIDs" class="extiw" title="wikipedia:GUID Partition Table">type de partition GUID</a> <code>C12A7328-F81F-11D2-BA4B-00A0C93EC93B</code>.
</p>
<p><b>Choisissez l'une des méthodes suivantes pour créer un ESP sur un disque partitionné GPT :</b>
</p>
<ul>
<li>
<a href="../en/Fdisk.html" title="Fdisk">fdisk</a> : Créez une partition avec le type de partition <code>EFI System</code>.</li>
<li>
<a href="../en/GPT_fdisk.html" class="mw-redirect" title="Gdisk">gdisk</a> : Crée une partition avec le type de partition <code>EF00</code>.</li>
<li>
<a href="../en/Parted.html" class="mw-redirect" title="GNU Parted">GNU Parted</a> : Créez une partition avec <code>fat32</code> comme type de système de fichiers et activez l'indicateur <code>esp</code> sur celle-ci.</li>
</ul>
<p>Après avoir créé la partition, elle doit être formatée avec un système de fichiers. Passez à la section <a href="#Formater_la_partition">#Formater la partition</a> ci-dessous.
</p>
<h3>
<span id="Disques_partitionn.C3.A9s_en_MBR"></span><span class="mw-headline" id="Disques_partitionnés_en_MBR">Disques partitionnés en MBR</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>Il est recommandé d'utiliser <a href="../en/Partitioning.html#GUID_Partition_Table" class="mw-redirect" title="GPT">GPT</a> car certains firmwares peuvent ne pas prendre en charge le démarrage UEFI/MBR car il n'est pas pris en charge par <a href="../en/Dual_boot_with_Windows.html" title="Dual boot with Windows">l'installateur de Windows</a>.</li>
<li>
<i>bootctl</i> ne prends pas en charge l'installation de <a href="../en/Systemd-boot.html" title="Systemd-boot">systemd-boot</a> sur un disque partitionné MBR ; voir <a rel="nofollow" class="external text" href="https://github.com/systemd/systemd/issues/1125">le ticket 1125 systemd</a>.</li>
</ul>
<p>Voir également <a href="../en/Partitioning.html#Choosing_between_GPT_and_MBR" title="Partitioning">Choisir entre GPT et MBR</a> pour les avantages de GPT en général.
</p>
</div>
<p>La partition système EFI sur une table de partition <a href="../en/Partitioning.html#Master_Boot_Record" class="mw-redirect" title="Master Boot Record">Master Boot Record</a> est identifiée par le <a href="https://en.wikipedia.org/wiki/Partition_type" class="extiw" title="wikipedia:Partition type">l'identifiant de type partition</a> <code>EF</code>.
</p>
<p><b>Choisissez l'une</b> des méthodes suivantes pour créer un ESP pour un disque partitionné MBR :
</p>
<ul>
<li>
<a href="../en/Fdisk.html" title="Fdisk">fdisk</a> : Créez une partition primaire avec le type de partition <code>EFI (FAT-12/16/32)</code>.</li>
<li>
<a href="../en/Parted.html" class="mw-redirect" title="GNU Parted">GNU Parted</a> : Crée une partition primaire avec <code>fat32</code> comme type de système de fichiers et active l'indicateur <code>esp</code> sur celle-ci.</li>
</ul>
<p>Après avoir créé la partition, elle doit être formatée avec un système de fichiers. Passez à la section <a href="#Formater_la_partition">#Formater la partition</a> ci-dessous.
</p>
<h2><span class="mw-headline" id="Formater_la_partition">Formater la partition</span></h2>
<p>La spécification UEFI impose la prise en charge des systèmes de fichiers FAT12, FAT16 et FAT32 (voir <a rel="nofollow" class="external text" href="https://uefi.org/sites/default/files/resources/UEFI_Spec_2_9_2021_03_18.pdf#G17.1019485">UEFI specification version 2.9, section 13.3.1.1</a>), mais tout fournisseur conforme peut ajouter facultativement la prise en charge de systèmes de fichiers supplémentaires ; par exemple, le microprogramme des <a href="../en/Mac.html" class="mw-redirect" title="Mac (Français)">Macs</a> Apple prend en charge le système de fichiers HFS+.
</p>
<p>Pour éviter les problèmes potentiels avec d'autres systèmes d'exploitation et puisque la spécification UEFI dit que l'UEFI "englobe l'utilisation de FAT32 pour une partition système, et FAT12 ou FAT16 pour les supports amovibles" <a rel="nofollow" class="external autonumber" href="https://uefi.org/sites/default/files/resources/UEFI_Spec_2_9_2021_03_18.pdf#G17.1345080">[4]</a>, il est recommandé d'utiliser <a href="../en/FAT.html" class="mw-redirect" title="FAT32">FAT32</a>. Utilisez l'utilitaire <span class="plainlinks archwiki-template-man" title="$ man 8 mkfs.fat"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mkfs.fat.8">mkfs.fat(8)</a></span> de <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dosfstools">dosfstools</a></span> :
</p>
<pre># mkfs.fat -F 32 /dev/sd<i>xY</i>
</pre>
<p>Si vous obtenez le message <code>WARNING : Not enough clusters for a 32 bit FAT!</code>, réduisez la taille des clusters avec <code>mkfs.fat -s2 -F32 ...</code> ou <code>-s1</code> ; sinon la partition peut être illisible par UEFI. Consultez <span class="plainlinks archwiki-template-man" title="$ man 8 mkfs.fat"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mkfs.fat.8">mkfs.fat(8)</a></span> pour les tailles de cluster prises en charge.
</p>
<p>Pour les partitions inférieures à 32 MiB, l'utilisation de FAT32 peut ne pas être possible. Dans ce cas, formatez-la en FAT16 ou même en FAT12. Par exemple, un ESP de 2 MiB ne pourra prendre en charge que la FAT12 :
</p>
<pre># mkfs.fat -F 12 /dev/sd<i>xY</i>
</pre>
<h2><span class="mw-headline" id="Monter_la_partition">Monter la partition</span></h2>
<p>Les noyaux, les fichiers initramfs et dans la plupart des cas le <a href="../en/Microcode.html" title="Microcode">microcode</a> du processeur doivent être accessibles par le <a href="../fr/Arch_boot_process.html#Chargeur_d'amor%C3%A7age" class="mw-redirect" title="Chargeur d'amorçage">chargeur d'amorçage</a> ou l'UEFI lui-même pour réussir à démarrer le système. Ainsi, si vous voulez garder la configuration simple, votre choix de chargeur d'amorçage limite les points de montage disponibles pour la partition système EFI.
</p>
<h3><span class="mw-headline" id="Points_de_montage_habituels">Points de montage habituels</span></h3>
<p>Les scénarios les plus simples pour monter une partition système EFI sont :
</p>
<ul>
<li>
<a href="../en/File_systems.html#Mount_a_file_system" class="mw-redirect" title="Mount">monter</a> ESP sur <code>/efi</code> et utiliser un <a href="../fr/Arch_boot_process.html#Chargeur_d'amor%C3%A7age" class="mw-redirect" title="Chargeur d'amorçage">chargeur d'amorçage</a> capable d'accéder au(x) noyau(x) et aux image(s) initramfs qui sont stocké(s) ailleurs (habituellement <a href="../en/Partitioning.html#/boot" title="Partitioning">/boot</a>). Consulter <a href="../fr/Arch_boot_process.html#Chargeur_d'amor%C3%A7age" class="mw-redirect" title="Chargeur d'amorçage">chargeur d'amorçage</a> pour plus d'informations sur les exigences et les capacités du chargeur d'amorçage.</li>
<li>
<a href="../en/File_systems.html#Mount_a_file_system" class="mw-redirect" title="Mount">monter</a> ESP vers <code>/boot</code>. C'est la méthode préférée pour démarrer directement un noyau <a href="../en/EFI_boot_stub.html" class="mw-redirect" title="EFISTUB">EFISTUB</a> depuis l'UEFI ou via un gestionnaire d'amorçage comme <a href="../en/Systemd-boot.html" title="Systemd-boot">systemd-boot</a>.</li>
<li>
<a href="../en/File_systems.html#Mount_a_file_system" class="mw-redirect" title="Mount">monter</a> ESP sur <code>/efi</code> et monter en plus une "partition de chargeur d'amorçage étendu" (XBOOTLDR) sur <code>/boot</code>. Cela peut être utile lorsqu'un ESP précédemment créé est trop petit pour contenir plusieurs chargeurs d'amorçage et/ou noyaux, mais que l'ESP ne peut pas être facilement redimensionné (comme lors de l'installation de Linux après Windows pour le <a href="../fr/Dual_boot_with_Windows.html" title="Dual boot with Windows (Français)"><i>dual-boot</i></a>). Cette méthode est prise en charge par au moins <a href="../en/Systemd-boot.html#Installation_using_XBOOTLDR" title="Systemd-boot">systemd-boot</a>.</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Astuce:</strong> 
<ul>
<li>
<code>/efi</code> est un remplacement <a rel="nofollow" class="external autonumber" href="https://github.com/systemd/systemd/pull/3757#issuecomment-234290236">[5]</a> pour le point de montage ESP <code>/boot/efi</code> précédemment populaire (et peut-être encore utilisé par d'autres distributions Linux).</li>
<li>Le répertoire <code>/efi</code> n'est pas disponible par défaut, vous devrez d'abord le créer avec <span class="plainlinks archwiki-template-man" title="$ man 1 mkdir"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mkdir.1">mkdir(1)</a></span> avant d'y monter l'ESP.</li>
</ul>
</div>
<h3><span class="mw-headline" id="Points_de_montage_alternatifs">Points de montage alternatifs</span></h3>
<p>Si vous n'utilisez pas l'une des méthodes simples de <a href="#Points_de_montage_habituels">#Points de montage habituels</a>, vous devrez copier vos fichiers de démarrage sur l'ESP (désigné ci-après par <code><i>esp</i></code>).
</p>
<pre># mkdir -p <i>esp</i>/EFI/arch
# cp -a /boot/vmlinuz-linux <i>esp</i>/EFI/arch/
# cp -a /boot/initramfs-linux.img <i>esp</i>/EFI/arch/
# cp -a /boot/initramfs-linux-fallback.img <i>esp</i>/EFI/arch/
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Vous devrez peut-être aussi copier le <a href="../en/Microcode.html" title="Microcode">Microcode</a> à l'emplacement de l'entrée de démarrage.</div>
<p>En outre, vous devrez maintenir les fichiers sur l'ESP à jour avec les dernières mises à jour du noyau. Si vous ne le faites pas, vous risquez d'avoir un système non démarrable. Les sections suivantes abordent plusieurs mécanismes permettant de l'automatiser.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Si l'ESP n'est pas monté sur <code>/boot</code>, veillez à ne pas vous fier au mécanisme de <a href="../fr/Fstab.html#Montage_automatique_avec_systemd" title="Fstab (Français)">montage automatique de systemd </a> (y compris celui de <span class="plainlinks archwiki-template-man" title="$ man 8 systemd-gpt-auto-generator"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-gpt-auto-generator.8">systemd-gpt-auto-generator(8)</a></span>). Il faut toujours le monter manuellement avant toute mise à jour du système ou du noyau, sinon vous risquez de ne plus pouvoir le monter après la mise à jour, ce qui vous enfermera dans le noyau en cours d'exécution sans possibilité de mettre à jour la copie du noyau sur ESP.
<p>Alternativement, <a href="../en/Kernel_module.html#Automatic_module_loading" title="Kernel module">préchargez les modules du noyau requis au démarrage</a>, par exemple :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modules-load.d/vfat.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">vfat
nls_cp437
nls_ascii
</pre>
</div>
<h4><span class="mw-headline" id="Avec_un_bind">Avec un <i>bind</i></span></h4>
<p>Au lieu de monter l'ESP lui-même sur <code>/boot</code>, vous pouvez monter un répertoire de l'ESP sur <code>/boot</code> en utilisant un <a href="../en/File_systems.html#Mount_a_file_system" class="mw-redirect" title="Mount">mount</a> lié (<i>bind</i> en anglais, voir <span class="plainlinks archwiki-template-man" title="$ man 8 mount"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mount.8">mount(8)</a></span>). Cela permet à <a href="../fr/Pacman.html" title="Pacman (Français)">pacman</a> de mettre à jour le noyau directement tout en conservant l'ESP organisé à votre convenance.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Ceci nécessite un <a href="../en/FAT.html#Kernel_configuration" title="FAT">noyau</a> et un <a href="../fr/Arch_boot_process.html#Chargeur_d'amor%C3%A7age" class="mw-redirect" title="Chargeur d'amorçage">chargeur d'amorçage</a> compatible avec FAT32. Ce n'est pas un problème pour une installation ordinaire d'Arch, mais cela peut être problématique pour d'autres distributions (notamment celles qui nécessitent des liens symboliques dans <code>/boot/</code>). Voir le post du forum <a rel="nofollow" class="external autonumber" href="https://bbs.archlinux.org/viewtopic.php?pid=1331867#p1331867">[6]</a>.</div>
<p>Comme dans <a href="#Points_de_montage_alternatifs">#Points de montage alternatifs</a>, copiez tous les fichiers de démarrage dans un répertoire sur votre ESP, mais montez l'ESP <b>en dehors</b> de <code>/boot</code>. Ensuite, montez le répertoire en le liant :
</p>
<pre># mount --bind <i>esp</i>/EFI/arch /boot
</pre>
<p>Après avoir vérifié le succès, éditez votre <a href="../fr/Fstab.html" title="Fstab (Français)">Fstab</a> pour rendre les changements persistants :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/fstab</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"><i>esp</i>/EFI/arch /boot none defaults,bind 0 0
</pre>
<h4><span class="mw-headline" id="Avec_systemd">Avec systemd</span></h4>
<p><a href="../fr/Systemd.html" title="Systemd (Français)">Systemd</a> permet d'effectuer des tâches déclenchées par des événements. Dans ce cas particulier, la capacité à détecter un changement dans un répertoire est utilisée pour synchroniser les fichiers du noyau EFISTUB et initramfs lorsqu'ils sont mis à jour dans <code>/boot/</code>. Le fichier surveillé pour les changements est <code>initramfs-linux-fallback.img</code> car c'est le dernier fichier construit par mkinitcpio, pour s'assurer que tous les fichiers ont été construits avant de commencer la copie. Le <i>chemin systemd</i> et les fichiers de service à créer sont :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/efistub-update.path</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Copie le noyau EFISTUB sur la partition système EFI

[Path]
PathChanged=/boot/initramfs-linux-fallback.img

[Install]
WantedBy=multi-user.target
WantedBy=system-update.target</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/efistub-update.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Copie le noyau EFISTUB sur la partition système EFI

[Service]
Type=oneshot
ExecStart=/usr/bin/cp -af /boot/vmlinuz-linux <i>esp</i>/EFI/arch/
ExecStart=/usr/bin/cp -af /boot/initramfs-linux.img <i>esp</i>/EFI/arch/
ExecStart=/usr/bin/cp -af /boot/initramfs-linux-fallback.img <i>esp</i>/EFI/arch/</pre>
<p>Puis <a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Activez">activez</a> et <a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Démarrez">démarrez</a> <code>efistub-update.path</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Astuce:</strong> Pour <a href="../en/Unified_Extensible_Firmware_Interface/Secure_Boot.html" class="mw-redirect" title="Secure Boot">Secure Boot</a> avec vos propres clés, vous pouvez configurer le service pour qu'il signe également l'image en utilisant <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=sbsigntools">sbsigntools</a></span> :
<pre>ExecStart=/usr/bin/sbsign --key <i>/path/to/db.key</i> --cert <i>/path/to/db.crt</i> --output <i>esp</i>/EFI/arch/vmlinuz-linux /boot/vmlinuz-linux</pre>
</div>
<h4>
<span id="Avec_les_.C3.A9v.C3.A9nements_du_syst.C3.A8me_de_fichiers"></span><span class="mw-headline" id="Avec_les_événements_du_système_de_fichiers">Avec les événements du système de fichiers</span>
</h4>
<p><a href="../en/Autostarting.html#On_filesystem_events" title="Autostarting">Les événements du système de fichiers</a> peuvent être utilisés pour exécuter un script synchronisant le noyau EFISTUB après les mises à jour du noyau. Ci-après un exemple avec <a href="../en/Incron.html" title="Incron">incron</a>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/local/bin/efistub-update</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh
cp -af /boot/vmlinuz-linux <i>esp</i>/EFI/arch/
cp -af /boot/initramfs-linux.img <i>esp</i>/EFI/arch/
cp -af /boot/initramfs-linux-fallback.img <i>esp</i>/EFI/arch/
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Le premier paramètre <code>/boot/initramfs-linux-fallback.img</code> est le fichier à surveiller. Le deuxième paramètre <code>IN_CLOSE_WRITE</code> est l'action à surveiller. Le troisième paramètre <code>/usr/local/bin/efistub-update</code> est le script à exécuter.</div>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/incron.d/efistub-update.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/boot/initramfs-linux-fallback.img IN_CLOSE_WRITE /usr/local/bin/efistub-update
</pre>
<p>Afin d'utiliser cette méthode, <a href="../fr/Systemd.html#Utilisation_des_unit%C3%A9s" class="mw-redirect" title="Activez">activez</a> le <code>incrond.service</code>.
</p>
<h4><span class="mw-headline" id="Avec_un_hook_de_mkinitcpio">Avec un <i>hook</i> de mkinitcpio</span></h4>
<p><a href="../fr/Mkinitcpio.html" title="Mkinitcpio (Français)">Mkinitcpio</a> peut générer un <i>hook</i> qui n'a pas besoin d'un daemon au niveau du système pour fonctionner. Il génère un processus d'arrière-plan qui attend la génération de <code>vmlinuz</code>, <code>initramfs-linux.img</code>, et <code>initramfs-linux-fallback.img</code> avant de copier les fichiers.
</p>
<p>Ajoutez <code>efistub-update</code> à la liste des hooks dans <code>/etc/mkinitcpio.conf</code>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/initcpio/install/efistub-update</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/usr/bin/env bash
build() {
	/usr/local/bin/efistub-copy $$ &amp;
}

help() {
	cat &lt;&lt;HELPEOF
Ce hook attend que mkinitcpio se termine et copie le ramdisk et le noyau terminés dans l'ESP.
HELPEOF
}</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/local/bin/efistub-copy</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh

if [ "$1" -gt 0 ]
alors
	while [ -e /proc/"$1" ]
	do
		sleep .5
	done
fi

rsync -a /boot/ <i>esp</i>/

echo "/boot synchronisé avec l'ESP"
</pre>
<h4>
<span id="Avec_un_pr.C3.A9-r.C3.A9glage_mkinitcpio"></span><span class="mw-headline" id="Avec_un_pré-réglage_mkinitcpio">Avec un pré-réglage mkinitcpio</span>
</h4>
<p>Comme les <i>presets</i> dans <code>/etc/mkinitcpio.d/</code> gèrent les scripts shell, le noyau et les initramfs peuvent être copiés en éditant simplement les pré-réglages.
</p>
<h5><span class="mw-headline" id="Remplacer_le_hook_mkinitcpio_ci-dessus">Remplacer le <i>hook</i> mkinitcpio ci-dessus</span></h5>
<p>Editez le fichier <code>/etc/mkinitcpio.d/linux.preset</code> :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.d/linux.preset</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># Fichier de pré-réglage mkinitcpio pour le paquet 'linux'.

# Répertoire pour copier le noyau, les initramfs...
ESP_DIR="<i>esp</i>/EFI/arch"

ALL_config="/etc/mkinitcpio.conf"
ALL_kver="${ESP_DIR}/vmlinuz-linux"
cp -af /boot/vmlinuz-linux "${ESP_DIR}/"
[[ -e /boot/intel-ucode.img ]] &amp;&amp; cp -af /boot/intel-ucode.img "${ESP_DIR}/"
[[ -e /boot/amd-ucode.img ]] &amp;&amp; cp -af /boot/amd-ucode.img "${ESP_DIR}/"

PRESETS=('default' 'fallback')

#default_config="/etc/mkinitcpio.conf"
default_image="${ESP_DIR}/initramfs-linux.img"
default_options=""

#fallback_config="/etc/mkinitcpio.conf"
fallback_image="${ESP_DIR}/initramfs-linux-fallback.img"
fallback_options="-S autodetect"</pre>
<p>Pour tester, il suffit de lancer :
</p>
<pre># rm /boot/initramfs-linux-fallback.img /boot/initramfs-linux.img
# mkinitcpio -p linux
</pre>
<h5><span class="mw-headline" id="Un_autre_exemple">Un autre exemple</span></h5>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.d/linux.preset</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">ESP_DIR= "<i>esp</i>/EFI/arch"
cp -f "/boot/vmlinuz-linux$suffix" "$ESP_DIR/"
ALL_config="/etc/mkinitcpio.conf"
ALL_kver="$ESP_DIR/vmlinuz-linux$suffix"
PRESETS=('default')
default_config="/etc/mkinitcpio.conf"
default_image="$ESP_DIR/initramfs-linux$suffix.img"</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.d/linux-zen.preset</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">suffixe='-zen'
source /etc/mkinitcpio.d/linux.preset</pre>
<h4><span class="mw-headline" id="Avec_un_hook_pacman">Avec un <i>hook</i> pacman</span></h4>
<p>Une dernière option repose sur les <a href="../fr/Pacman.html#Hooks" title="Pacman (Français)">hooks de pacman</a> qui sont exécutés à la fin de la transaction.
</p>
<p>Le premier fichier est un <i>hook</i> qui surveille les fichiers pertinents et est exécuté s'ils ont été modifiés lors de la transaction précédente.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pacman.d/hooks/999-kernel-efi-copy.hook</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Trigger]
Type = Path
Operation = Install
Operation = Upgrade
Target = usr/lib/modules/*/vmlinuz
Target = usr/lib/initcpio/*
Target = boot/*-ucode.img

[Action]
Description = Copier linux et initramfs dans le répertoire EFI...
When = PostTransaction
Exec = /usr/local/bin/kernel-efi-copy.sh</pre>
<p>Le deuxième fichier est le script lui-même. Créez le fichier et rendez-le <a href="../fr/Help:Reading.html#Rendre_ex%C3%A9cutable" class="mw-redirect" title="Exécutable">exécutable</a> :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/local/bin/kernel-efi-copy.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh
#
# Copie les images du noyau et des initramfs dans le répertoire EFI
#

ESP_DIR="<i>esp</i>/EFI/arch"

for file in /boot/vmlinuz*
do
        cp -af "$file" "$ESP_DIR/$(basename '$file').efi"
        [ $ ? -ne 0 ] &amp;&amp; exit 1
done

for file in /boot/initramfs*
do
        cp -af "$file" "$ESP_DIR/"
        [ $ ? -ne 0 ] &amp;&amp; exit 1
done

[ -e /boot/intel-ucode.img ] &amp;&amp; cp -af /boot/intel-ucode.img "$ESP_DIR/"
[ -e /boot/amd-ucode.img ] &amp;&amp; cp -af /boot/amd-ucode.img "$ESP_DIR/"

exit 0</pre>
<h2>
<span id="D.C3.A9pannage"></span><span class="mw-headline" id="Dépannage">Dépannage</span>
</h2>
<h3><span class="mw-headline" id="ESP_sur_RAID1_logiciel">ESP sur RAID1 logiciel</span></h3>
<p>Il est possible d'intégrer l'ESP à un RAID1, mais cela entraîne un risque de corruption des données et il faut prendre d'autres précautions lors de la création de l'ESP. Voir <a rel="nofollow" class="external autonumber" href="https://bbs.archlinux.org/viewtopic.php?pid=1398710#p1398710">[7]</a> et <a rel="nofollow" class="external autonumber" href="https://bbs.archlinux.org/viewtopic.php?pid=1390741#p1390741">[8]</a> pour plus de détails ainsi que <a rel="nofollow" class="external text" href="https://outflux.net/blog/archives/2018/04/19/uefi-booting-and-raid1/">UEFI booting and RAID1</a> pour un guide détaillé avec une solution.
</p>
<p>La partie la plus importante est d'utiliser <code>--metadata 1.0</code> afin de garder les métadonnées RAID à la fin de la partition, sinon le firmware ne sera pas capable d'y accéder :
</p>
<pre># mdadm --create --verbose --level=1 <b>--metadata=1.0</b> --raid-devices=2 /dev/md/ESP /dev/sda<i>X</i> /dev/sdb<i>Y</i>
</pre>
<h3>
<span id="Le_microprogramme_ne_voit_pas_le_r.C3.A9pertoire_EFI"></span><span class="mw-headline" id="Le_microprogramme_ne_voit_pas_le_répertoire_EFI">Le microprogramme ne voit pas le répertoire EFI</span>
</h3>
<p>Si vous donnez au système de fichiers FAT un <a href="../fr/Persistent_block_device_naming.html#by-label" title="Persistent block device naming (Français)">nom de volume (i.e. un label de système de fichier)</a>, assurez-vous de le nommer autrement que <code>EFI</code>. Cela peut déclencher un bogue dans certains firmwares (dû au fait que le nom du volume correspond au nom du répertoire EFI) qui fera que le firmware agira comme si le répertoire EFI n'existait pas.
</p>
<h2><span class="mw-headline" id="Voir_aussi">Voir aussi</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://blog.uncooperative.org/uefi/linux/shim/efi%20system%20partition/2014/02/06/the-efi-system-partition.html">La partition système EFI et le comportement de démarrage par défaut</a></li>
<li>
<a rel="nofollow" class="external text" href="https://ramsdenj.com/2016/04/15/multi-boot-linux-with-one-boot-partition.html">Multi Boot Linux avec une partition de démarrage | John Ramsden</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2023-10-29 ⓘ]</sup>
</li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../fr/Category:Boot_process.html" title="Category:Boot process (Français)">Boot process (Français)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=EFI_system_partition_(Fran%C3%A7ais)&amp;oldid=791399">https://wiki.archlinux.org/index.php?title=EFI_system_partition_(Français)&amp;oldid=791399</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 29 October 2023, at 13:03.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
