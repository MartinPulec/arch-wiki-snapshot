<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-zebra-design-disabled vector-feature-custom-font-size-clientpref-disabled vector-feature-client-preferences-disabled vector-feature-typography-survey-disabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>LVM (Português) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.41.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-LVM_Português rootpage-LVM_Português skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-main-menu-container">
		</div>
	<input type="checkbox" id="vector-toc-collapsed-checkbox" class="vector-menu-checkbox">
			<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark vector-sticky-pinned-container">
				<div id="vector-toc-pinned-container" class="vector-pinned-container">
				<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Conceitos_básicos" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Conceitos_b%C3%A1sicos">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Conceitos básicos</div>
		</a>
		
			<button aria-controls="toc-Conceitos_básicos-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Conceitos básicos subsection</span>
			</button>
		
		<ul id="toc-Conceitos_básicos-sublist" class="vector-toc-list">
			<li id="toc-Blocos_de_construção_do_LVM" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Blocos_de_constru%C3%A7%C3%A3o_do_LVM">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1</span>Blocos de construção do LVM</div>
			</a>
			
			<ul id="toc-Blocos_de_construção_do_LVM-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Vantagens" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Vantagens">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.2</span>Vantagens</div>
			</a>
			
			<ul id="toc-Vantagens-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Desvantagens" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Desvantagens">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.3</span>Desvantagens</div>
			</a>
			
			<ul id="toc-Desvantagens-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Instalação" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Instala%C3%A7%C3%A3o">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Instalação</div>
		</a>
		
		<ul id="toc-Instalação-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Operações_com_volumes" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Opera%C3%A7%C3%B5es_com_volumes">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Operações com volumes</div>
		</a>
		
			<button aria-controls="toc-Operações_com_volumes-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Operações com volumes subsection</span>
			</button>
		
		<ul id="toc-Operações_com_volumes-sublist" class="vector-toc-list">
			<li id="toc-Volumes_físicos" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Volumes_f%C3%ADsicos">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>Volumes físicos</div>
			</a>
			
			<ul id="toc-Volumes_físicos-sublist" class="vector-toc-list">
				<li id="toc-Criação" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Cria%C3%A7%C3%A3o">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.1</span>Criação</div>
			</a>
			
			<ul id="toc-Criação-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Expansão" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Expans%C3%A3o">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.2</span>Expansão</div>
			</a>
			
			<ul id="toc-Expansão-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Encolhimento" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Encolhimento">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.3</span>Encolhimento</div>
			</a>
			
			<ul id="toc-Encolhimento-sublist" class="vector-toc-list">
				<li id="toc-Movendo_extensões_físicas" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Movendo_extens%C3%B5es_f%C3%ADsicas">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.3.1</span>Movendo extensões físicas</div>
			</a>
			
			<ul id="toc-Movendo_extensões_físicas-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Redimensionando_um_volume_físico" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Redimensionando_um_volume_f%C3%ADsico">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.3.2</span>Redimensionando um volume físico</div>
			</a>
			
			<ul id="toc-Redimensionando_um_volume_físico-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Redimensionando_a_partição" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Redimensionando_a_parti%C3%A7%C3%A3o">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.3.3</span>Redimensionando a partição</div>
			</a>
			
			<ul id="toc-Redimensionando_a_partição-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Grupos_de_volume" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Grupos_de_volume">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>Grupos de volume</div>
			</a>
			
			<ul id="toc-Grupos_de_volume-sublist" class="vector-toc-list">
				<li id="toc-Criando_um_grupo_de_volume" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Criando_um_grupo_de_volume">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.1</span>Criando um grupo de volume</div>
			</a>
			
			<ul id="toc-Criando_um_grupo_de_volume-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Ativando_um_grupo_de_volume" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Ativando_um_grupo_de_volume">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.2</span>Ativando um grupo de volume</div>
			</a>
			
			<ul id="toc-Ativando_um_grupo_de_volume-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Reparando_um_grupo_de_volume" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Reparando_um_grupo_de_volume">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.3</span>Reparando um grupo de volume</div>
			</a>
			
			<ul id="toc-Reparando_um_grupo_de_volume-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Desativando_um_grupo_de_volume" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Desativando_um_grupo_de_volume">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.4</span>Desativando um grupo de volume</div>
			</a>
			
			<ul id="toc-Desativando_um_grupo_de_volume-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Renomeando_um_grupo_de_volume" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Renomeando_um_grupo_de_volume">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.5</span>Renomeando um grupo de volume</div>
			</a>
			
			<ul id="toc-Renomeando_um_grupo_de_volume-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Adicionando_um_volume_físico_em_um_grupo_de_volume" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Adicionando_um_volume_f%C3%ADsico_em_um_grupo_de_volume">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.6</span>Adicionando um volume físico em um grupo de volume</div>
			</a>
			
			<ul id="toc-Adicionando_um_volume_físico_em_um_grupo_de_volume-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Removendo_uma_partição_de_um_grupo_de_volume" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Removendo_uma_parti%C3%A7%C3%A3o_de_um_grupo_de_volume">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.7</span>Removendo uma partição de um grupo de volume</div>
			</a>
			
			<ul id="toc-Removendo_uma_partição_de_um_grupo_de_volume-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Volumes_lógicos" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Volumes_l%C3%B3gicos">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3</span>Volumes lógicos</div>
			</a>
			
			<ul id="toc-Volumes_lógicos-sublist" class="vector-toc-list">
				<li id="toc-Criando_um_volume_lógico" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Criando_um_volume_l%C3%B3gico">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.1</span>Criando um volume lógico</div>
			</a>
			
			<ul id="toc-Criando_um_volume_lógico-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Renomeando_um_volume_lógico" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Renomeando_um_volume_l%C3%B3gico">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.2</span>Renomeando um volume lógico</div>
			</a>
			
			<ul id="toc-Renomeando_um_volume_lógico-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Redimensionando_um_volume_lógico_e_um_sistema_de_arquivos_de_uma_só_vez" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Redimensionando_um_volume_l%C3%B3gico_e_um_sistema_de_arquivos_de_uma_s%C3%B3_vez">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.3</span>Redimensionando um volume lógico e um sistema de arquivos de uma só vez</div>
			</a>
			
			<ul id="toc-Redimensionando_um_volume_lógico_e_um_sistema_de_arquivos_de_uma_só_vez-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Redimensionando_o_volume_lógico_e_o_sistema_de_arquivos_separadamente" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Redimensionando_o_volume_l%C3%B3gico_e_o_sistema_de_arquivos_separadamente">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.4</span>Redimensionando o volume lógico e o sistema de arquivos separadamente</div>
			</a>
			
			<ul id="toc-Redimensionando_o_volume_lógico_e_o_sistema_de_arquivos_separadamente-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Removendo_um_volume_lógico" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Removendo_um_volume_l%C3%B3gico">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.5</span>Removendo um volume lógico</div>
			</a>
			
			<ul id="toc-Removendo_um_volume_lógico-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Snapshots" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Snapshots">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Snapshots</div>
		</a>
		
			<button aria-controls="toc-Snapshots-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Snapshots subsection</span>
			</button>
		
		<ul id="toc-Snapshots-sublist" class="vector-toc-list">
			<li id="toc-Configuração" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configura%C3%A7%C3%A3o">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>Configuração</div>
			</a>
			
			<ul id="toc-Configuração-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Backups" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Backups">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2</span>Backups</div>
			</a>
			
			<ul id="toc-Backups-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Criptografia" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Criptografia">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Criptografia</div>
		</a>
		
		<ul id="toc-Criptografia-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Cache" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Cache">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>Cache</div>
		</a>
		
			<button aria-controls="toc-Cache-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Cache subsection</span>
			</button>
		
		<ul id="toc-Cache-sublist" class="vector-toc-list">
			<li id="toc-Criar_cache" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Criar_cache">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.1</span>Criar cache</div>
			</a>
			
			<ul id="toc-Criar_cache-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Remover_cache" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Remover_cache">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.2</span>Remover cache</div>
			</a>
			
			<ul id="toc-Remover_cache-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-RAID" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#RAID">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">7</span>RAID</div>
		</a>
		
			<button aria-controls="toc-RAID-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle RAID subsection</span>
			</button>
		
		<ul id="toc-RAID-sublist" class="vector-toc-list">
			<li id="toc-Configurando_RAID" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configurando_RAID">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">7.1</span>Configurando RAID</div>
			</a>
			
			<ul id="toc-Configurando_RAID-sublist" class="vector-toc-list">
				<li id="toc-Novos_volumes" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Novos_volumes">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">7.1.1</span>Novos volumes</div>
			</a>
			
			<ul id="toc-Novos_volumes-sublist" class="vector-toc-list">
				<li id="toc-RAID_0" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#RAID_0">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">7.1.1.1</span>RAID 0</div>
			</a>
			
			<ul id="toc-RAID_0-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-RAID_1" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#RAID_1">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">7.1.1.2</span>RAID 1</div>
			</a>
			
			<ul id="toc-RAID_1-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-RAID_10" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#RAID_10">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">7.1.1.3</span>RAID 10</div>
			</a>
			
			<ul id="toc-RAID_10-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Volumes_existentes" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Volumes_existentes">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">7.1.2</span>Volumes existentes</div>
			</a>
			
			<ul id="toc-Volumes_existentes-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Provisionamento_fino" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Provisionamento_fino">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">8</span>Provisionamento fino</div>
		</a>
		
			<button aria-controls="toc-Provisionamento_fino-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Provisionamento fino subsection</span>
			</button>
		
		<ul id="toc-Provisionamento_fino-sublist" class="vector-toc-list">
			<li id="toc-Exemplo:_implementando_servidores_privados_virtuais" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Exemplo:_implementando_servidores_privados_virtuais">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">8.1</span>Exemplo: implementando servidores privados virtuais</div>
			</a>
			
			<ul id="toc-Exemplo:_implementando_servidores_privados_virtuais-sublist" class="vector-toc-list">
				<li id="toc-Usando_snapshots_finos_para_salvar_mais_espaço" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Usando_snapshots_finos_para_salvar_mais_espa%C3%A7o">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">8.1.1</span>Usando snapshots finos para salvar mais espaço</div>
			</a>
			
			<ul id="toc-Usando_snapshots_finos_para_salvar_mais_espaço-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Exemplo:_atualização_de_armazenamento_com_zero_tempo_de_inatividade_(zero-downtime)" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Exemplo:_atualiza%C3%A7%C3%A3o_de_armazenamento_com_zero_tempo_de_inatividade_(zero-downtime)">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">8.2</span>Exemplo: atualização de armazenamento com zero tempo de inatividade (zero-downtime)</div>
			</a>
			
			<ul id="toc-Exemplo:_atualização_de_armazenamento_com_zero_tempo_de_inatividade_(zero-downtime)-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Customização" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Customiza%C3%A7%C3%A3o">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">9</span>Customização</div>
		</a>
		
		<ul id="toc-Customização-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Solução_de_problemas" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Solu%C3%A7%C3%A3o_de_problemas">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">10</span>Solução de problemas</div>
		</a>
		
			<button aria-controls="toc-Solução_de_problemas-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Solução de problemas subsection</span>
			</button>
		
		<ul id="toc-Solução_de_problemas-sublist" class="vector-toc-list">
			<li id="toc-Comandos_de_LVM_não_funcionam" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Comandos_de_LVM_n%C3%A3o_funcionam">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">10.1</span>Comandos de LVM não funcionam</div>
			</a>
			
			<ul id="toc-Comandos_de_LVM_não_funcionam-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Volumes_lógicos_não_aparecem" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Volumes_l%C3%B3gicos_n%C3%A3o_aparecem">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">10.2</span>Volumes lógicos não aparecem</div>
			</a>
			
			<ul id="toc-Volumes_lógicos_não_aparecem-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-LVM_em_mídia_removível" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#LVM_em_m%C3%ADdia_remov%C3%ADvel">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">10.3</span>LVM em mídia removível</div>
			</a>
			
			<ul id="toc-LVM_em_mídia_removível-sublist" class="vector-toc-list">
				<li id="toc-Suspensão/retorno_com_LVM_e_mídia_removível" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Suspens%C3%A3o/retorno_com_LVM_e_m%C3%ADdia_remov%C3%ADvel">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">10.3.1</span>Suspensão/retorno com LVM e mídia removível</div>
			</a>
			
			<ul id="toc-Suspensão/retorno_com_LVM_e_mídia_removível-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Redimensionando_um_volume_lógico_contíguo_que_falha" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Redimensionando_um_volume_l%C3%B3gico_cont%C3%ADguo_que_falha">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">10.4</span>Redimensionando um volume lógico contíguo que falha</div>
			</a>
			
			<ul id="toc-Redimensionando_um_volume_lógico_contíguo_que_falha-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id='toc-Comando_"grub-mkconfig"_reporta_erros_de_"unknown_filesystem"' class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href='#Comando_"grub-mkconfig"_reporta_erros_de_"unknown_filesystem"'>
				<div class="vector-toc-text">
				<span class="vector-toc-numb">10.5</span>Comando "grub-mkconfig" reporta erros de "unknown filesystem"</div>
			</a>
			
			<ul id='toc-Comando_"grub-mkconfig"_reporta_erros_de_"unknown_filesystem"-sublist' class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Tempo_de_volume_root_com_dispositivo_de_provisão_fina_expira_(time_out)" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Tempo_de_volume_root_com_dispositivo_de_provis%C3%A3o_fina_expira_(time_out)">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">10.6</span>Tempo de volume root com dispositivo de provisão fina expira (time out)</div>
			</a>
			
			<ul id="toc-Tempo_de_volume_root_com_dispositivo_de_provisão_fina_expira_(time_out)-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Lentidão_ao_desligar" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Lentid%C3%A3o_ao_desligar">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">10.7</span>Lentidão ao desligar</div>
			</a>
			
			<ul id="toc-Lentidão_ao_desligar-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Hibernação_em_um_volume_swap_de_provisionamento_fino" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Hiberna%C3%A7%C3%A3o_em_um_volume_swap_de_provisionamento_fino">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">10.8</span>Hibernação em um volume swap de provisionamento fino</div>
			</a>
			
			<ul id="toc-Hibernação_em_um_volume_swap_de_provisionamento_fino-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Veja_também" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Veja_tamb%C3%A9m">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">11</span>Veja também</div>
		</a>
		
		<ul id="toc-Veja_também-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

				</div>
	</nav>
		
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<label id="vector-toc-collapsed-button" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet vector-button-flush-left cdx-button--icon-only" for="vector-toc-collapsed-checkbox" role="button" aria-controls="vector-toc" tabindex="0" title="Table of Contents">
						<span class="vector-icon mw-ui-icon-wikimedia-listBullet"></span>
						<span>Toggle the table of contents</span>
					</label>
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">LVM (Português)</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 5 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-5" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">5 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-de mw-list-item"><a href="https://wiki.archlinux.de/title/LVM" title="LVM – Deutsch" lang="de" hreflang="de" class="interlanguage-link-target"><span>Deutsch</span></a></li>
<li class="interlanguage-link interwiki-en mw-list-item"><a href="../en/LVM.html" title="LVM – English" lang="en" hreflang="en" class="interlanguage-link-target"><span>English</span></a></li>
<li class="interlanguage-link interwiki-es mw-list-item"><a href="../es/LVM.html" title="LVM – español" lang="es" hreflang="es" class="interlanguage-link-target"><span>Español</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/LVM" title="LVM – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/LVM" title="LVM – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<nav class="vector-page-tools-landmark vector-sticky-pinned-container" aria-label="Page tools">
						<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
			
						</div>
	</nav>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="pt" dir="ltr">
<div class="mw-parser-output">
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Status de tradução:</strong> Esse artigo é uma tradução de <a href="../en/LVM.html" title="LVM">LVM</a>. Data da última tradução: 2024-03-11. Você pode ajudar a sincronizar a tradução, se houver <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=LVM&amp;diff=0&amp;oldid=802762">alterações</a> na versão em inglês.</div>
<div class="archwiki-template-meta-related-articles">
<p>Artigos relacionados</p>
<ul>
<li><a href="../en/LVM_on_software_RAID.html" class="mw-redirect" title="Software RAID and LVM">Software RAID and LVM</a></li>
<li><a href="../pt/Dm-crypt/Encrypting_an_entire_system.html#LUKS_dentro_do_LVM" title="Dm-crypt (Português)/Encrypting an entire system (Português)">LUKS dentro do LVM</a></li>
<li><a href="../pt/Install_Arch_Linux_on_LVM.html" title="Install Arch Linux on LVM (Português)">Instalar Arch Linux em LVM</a></li>
<li><a href="../en/Resizing_LVM-on-LUKS.html" title="Resizing LVM-on-LUKS">Resizing LVM-on-LUKS</a></li>
<li><a href="../en/Create_root_filesystem_snapshots_with_LVM.html" title="Create root filesystem snapshots with LVM">Create root filesystem snapshots with LVM</a></li>
</ul>
</div>
<p>De <a href="https://en.wikipedia.org/wiki/pt:Logical_Volume_Manager_(Linux)" class="extiw" title="wikipedia:pt:Logical Volume Manager (Linux)">Wikipédia: Gerenciador de Volume Lógico (Linux)</a>:
</p>
<dl><dd>O Gerenciador de Volume Lógico (LVM) é um <a href="https://en.wikipedia.org/wiki/pt:device_mapper" class="extiw" title="wikipedia:pt:device mapper">mapeador de dispositivos</a> que fornece <a href="https://en.wikipedia.org/wiki/logical_volume_management" class="extiw" title="wikipedia:logical volume management">gerenciamento de volume lógico</a> para o <a href="https://en.wikipedia.org/wiki/pt:Linux_(n%C3%BAcleo)" class="extiw" title="wikipedia:pt:Linux (núcleo)">kernel Linux</a>.</dd></dl>
<meta property="mw:PageProp/toc">
<h2>
<span id="Conceitos_b.C3.A1sicos"></span><span class="mw-headline" id="Conceitos_básicos">Conceitos básicos</span>
</h2>
<h3>
<span id="Blocos_de_constru.C3.A7.C3.A3o_do_LVM"></span><span class="mw-headline" id="Blocos_de_construção_do_LVM">Blocos de construção do LVM</span>
</h3>
<p>O gerenciador de volumes lógicos (LVM) utiliza um recurso do kernel chamado de <a rel="nofollow" class="external text" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/logical_volume_manager_administration/device_mapper">mapeador de dispositivo</a> (do inglês <i>device mapper</i>) para fornecer um sistema de <a href="../pt/Partitioning.html" class="mw-redirect" title="Partição">partições</a> independente do layout subjacente do disco. Com o LVM você abstrai seu dispositivo de armazenamento e passa a ter "partições virtuais", tornando a tarefa de <a href="#Redimensionando_o_volume_l%C3%B3gico_e_o_sistema_de_arquivos_separadamente">estender/diminuir</a> volumes mais fácil (embora isto esteja sujeito a potenciais limitações do sistema de arquivos).
</p>
<p>Partições virtuais permitem adição e remoção sem a preocupação de haver ou não espaço contíguo suficiente em um disco em particular. Evita aquelas situações de tentar manipular partições pelo fdisk com um disco em uso (e ficar com apreensão imaginando se o kernel está usando a tabela de partições nova ou velha), ou ainda, precisar mover outras partições para outras regiões ao longo do disco.
</p>
<p>Construção básica dos blocos pelo LVM:
</p>
<dl>
<dt>Volume físico (PV, do inglês <i>Phisical Volume</i>)</dt>
<dd>Um <i>node</i> de dispositivo em bloco Unix, usável para armazenamento pelo LVM. Exemplos: um disco rígido, uma partição <a href="../pt/Partitioning.html#Master_Boot_Record" class="mw-redirect" title="MBR (Português)">MBR</a> ou <a href="../pt/Partitioning.html#Tabela_de_Parti%C3%A7%C3%A3o_GUID" class="mw-redirect" title="GPT (Português)">GPT</a>, um arquivo de <i>loopback</i>, um mapeador de dispositivo (por exemplo, <a href="../pt/Dm-crypt.html" title="Dm-crypt (Português)">dm-crypt</a>). É responsável por hospedar um cabeçalho do LVM.</dd>
<dt>Grupo de volume (VG, do inglês <i>Volume Group</i>)</dt>
<dd>Grupo de PVs que servem como contêineres para LVs (volumes lógicos, de <i>Logical Volumes</i>). PEs (<i>Phisical Extents</i>, ou extensões físicas são alocadas de um VG para um LV).</dd>
<dt>Volume lógico ou <i>Logical Volume</i> (LV)</dt>
<dd>Uma partição virtual/lógica que reside em um VG e é composta de PEs. LVs são dispositivos de bloco Unix análogos a partições físicas, ou seja, podem ser diretamente formatadas com um <a href="../pt/File_systems.html" class="mw-redirect" title="Sistema de arquivos">sistema de arquivos</a>.</dd>
<dt>Extensão física ou <i>Physical Extent</i> (PE)</dt>
<dd>A menor extensão física contígua (4 MiB, por padrão) em um PV que pode ser atribuída para um LV. Pense em PEs como sendo partes de PVs que podem ser alocadas para qualquer LV.</dd>
</dl>
<p>Exemplo:
</p>
<pre style="white-space: pre !important; font-variant-ligatures: no-common-ligatures;">Discos físicos

  Disco1 (/dev/sda):
    ┌──────────────────────────────────────┬─────────────────────────────────────┐
    │ Partição1  50 GiB (Volume físico)    │ Partição2 80 GiB (Volume físico)    │
    │ /dev/sda1                            │ /dev/sda2                           │
    └──────────────────────────────────────┴─────────────────────────────────────┘

  Disco2 (/dev/sdb):
    ┌──────────────────────────────────────┐
    │ Partição1 120 GiB (Volume físico)    │
    │ /dev/sdb1                            │
    └──────────────────────────────────────┘
</pre>
<pre style="white-space: pre !important; font-variant-ligatures: no-common-ligatures;">Volumes lógicos do LVM

  Grupo de volume1 (/dev/MeuGrupoVol/ = /dev/sda1 + /dev/sda2 + /dev/sdb1):
    ┌─────────────────────────┬─────────────────────────┬──────────────────────────┐
    │ Volume lógico1 15 GiB   │ Volume lógico2 35 GiB   │ Volume lógico3 200 GiB   │
    │ /dev/MeuGrupoVol/rootvol│ /dev/MeuGrupoVol/homevol│ /dev/MeuGrupoVol/mediavol│
    └─────────────────────────┴─────────────────────────┴──────────────────────────┘
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Volumes lógicos são acessíveis tanto como <code>/dev/<i>NomeGrupoVolume</i>/<i>NomeVolumeLogico</i></code> quanto pelo formato <code>/dev/mapper/<i>NomeGrupoVolume-NomeVolumeLogico</i></code>. Porém <span class="plainlinks archwiki-template-man" title="$ man 8 lvm"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvm.8#VALID_NAMES">lvm(8) § VALID NAMES</a></span> recomenda o primeiro formato para "softwares e scripts" (por exemplo <a href="../pt/Fstab.html" title="Fstab (Português)">fstab</a>), pois o segundo é destinado ao "uso interno" e está sujeito a possivelmente "mudar entre lançamentos e distribuições".</div>
<h3><span class="mw-headline" id="Vantagens">Vantagens</span></h3>
<p>O LVM proporciona mais flexibilidade do que usar partições normais no disco rígido, pois permite: 
</p>
<ul>
<li>Usar qualquer quantidade de discos como se fosse um único grande disco;</li>
<li>Ter volumes lógicos estendidos sobre vários discos (Como em <a href="../pt/RAID.html" title="RAID (Português)">RAID</a>, que os volumes podem espelhar ou distribuir dados entre os discos. Tais opções podem oferecer vantagens como resiliência adicional e desempenho <a rel="nofollow" class="external autonumber" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/logical_volume_manager_administration/raid_volumes">[1]</a>);</li>
<li>Criar pequenos volumes lógicos e estendê-los "dinamicamente" à medida em que eles forem ficando cheios;</li>
<li>Redimensionar volumes lógicos independentemente da ordem que estão dispostos fisicamente no disco. Isto não depende da posição do LV dentro do VG, não havendo nem mesmo necessidade de liberar espaço disponível ao redor destes;</li>
<li>Redimensionar/criar/excluir volumes lógicos e físicos online. Os sistemas de arquivos neles ainda precisam ser redimensionados, mas alguns (como <a href="../pt/Ext4.html" title="Ext4 (Português)">Ext4</a> e <a href="../pt/Btrfs.html" title="Btrfs (Português)">Btrfs</a>) suportam redimensionamento online;</li>
<li>Migração de um LV (ou segmentos) em uso online/em tempo real por serviços para diferentes discos sem necessidade de reinicializar os serviços;</li>
<li>Criação de <i>snapshots</i> que permitem o backup de uma cópia <i>congelada</i> de um sistema de arquivos, ao mesmo tempo que minimiza o tempo de indisponibilidade dos serviços e o <i>snapshot</i> pode ser facilmente mesclado/fundido ao volume original mais tarde;</li>
<li>Suporte ao desbloqueio de volumes criptografados separados, sem necessidade de informar uma chave múltiplas vezes durante o boot ao criar um <a href="../pt/Dm-crypt/Encrypting_an_entire_system.html#LVM_dentro_do_LUKS" title="Dm-crypt (Português)/Encrypting an entire system (Português)">LVM dentro do LUKS</a>.</li>
<li>Suporte integrado de criação de <i>cache</i> dos dados usados frequentemente (<span class="plainlinks archwiki-template-man" title="$ man 7 lvmcache"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvmcache.7">lvmcache(7)</a></span>).</li>
</ul>
<h3><span class="mw-headline" id="Desvantagens">Desvantagens</span></h3>
<ul><li>Etapas adicionais em configurar o sistema (provavelmente requerendo ajustes na configuração de <a href="../en/Mkinitcpio.html" title="Mkinitcpio">mkinitcpio</a>) tornam o processo mais complicado. Precisa executar constantemente (múltiplos) daemons.</li></ul>
<ul><li>Em dual boot, note que o Windows não suporta LVM; é impossibilitado o acesso de quaisquer partições LVM à partir do Windows. Softwares de terceiros talvez permitam a montagem de certos tipos de sistemas configurados com LVM. <a rel="nofollow" class="external autonumber" href="https://www.paragon-software.com/home/linuxfs-windows/">[2]</a>
</li></ul>
<ul><li>Se seus volumes físicos não estão em uma RAID-1, RAID-5 ou RAID-6 um dos discos <i>pode</i> perder um ou mais volumes lógicos se você espalhar (ou expandir) seus volumes lógicos entre múltiplos discos não redundantes.</li></ul>
<ul><li>Não é sempre fácil encolher o espaço usado pelo gerenciador de volumes lógicos, no caso os volumes físicos usados para os volumes lógicos. Se as extensões físicas são dispersas pelo volume físico até o final, você pode precisar inspecionar os segmentos e movê-los (potencialmente para outro dispositivo físico), ou mover o mesmo dispositivo com a alocação personalizada (por exemplo, <code>--alloc anywhere</code>). Se você quiser configurar dual boot com outros sistemas operacionais (em exemplo o Microsoft Windows), o único espaço restante no dispositivo com Microsoft Windows será o espaço não usado pelo LVM, ou o que não foi usado como um volume físico.</li></ul>
<ul><li>Potencial piora de desempenho em comparação às partições simples. <a rel="nofollow" class="external autonumber" href="https://unix.stackexchange.com/questions/7122/does-lvm-impact-performance">[3]</a>
</li></ul>
<ul><li>Pode não funcionar bem com todos os sistema de arquivos, especialmente aqueles projetados para gestão de vários dispositivos. Por exemplo, <a href="../pt/Btrfs.html" title="Btrfs (Português)">Btrfs</a> oferece algumas das mesmas funcionalidades (<a rel="nofollow" class="external text" href="https://btrfs.readthedocs.io/en/latest/btrfs-device.html">suporte a múltiplos dispositivos </a>, <a rel="nofollow" class="external text" href="https://btrfs.readthedocs.io/en/latest/Subvolumes.html">(sub)volumes</a>, snapshots e <a rel="nofollow" class="external text" href="https://btrfs.readthedocs.io/en/latest/Volume-management.html">RAID</a>), e com isso pode existir conflito (leia com mais profundidade sobre os problemas com snapshots em LVM com <a href="../pt/Btrfs.html" title="Btrfs (Português)">Btrfs</a>).</li></ul>
<h2>
<span id="Instala.C3.A7.C3.A3o"></span><span class="mw-headline" id="Instalação">Instalação</span>
</h2>
<p>Certifique-se que o pacote <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lvm2">lvm2</a></span> está <a href="../pt/Pacman.html#Instalando_pacotes" class="mw-redirect" title="Instalado">instalado</a>.
</p>
<p>Se você tem volumes LVM não ativados via <a href="../pt/Arch_boot_process.html#initramfs" class="mw-redirect" title="Initramfs (Português)">initramfs</a>, <a href="../pt/Systemd.html#Usando_units" class="mw-redirect" title="Ative">ative</a> o <code>lvm2-monitor.service</code>, do qual é fornecido pelo pacote <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lvm2">lvm2</a></span>.
</p>
<h2>
<span id="Opera.C3.A7.C3.B5es_com_volumes"></span><span class="mw-headline" id="Operações_com_volumes">Operações com volumes</span>
</h2>
<h3>
<span id="Volumes_f.C3.ADsicos"></span><span class="mw-headline" id="Volumes_físicos">Volumes físicos</span>
</h3>
<h4>
<span id="Cria.C3.A7.C3.A3o"></span><span class="mw-headline" id="Criação">Criação</span>
</h4>
<p>Ao criar o PV em <code>/dev/sda1</code>, execute:
</p>
<pre># pvcreate /dev/sda1
</pre>
<p>Você pode verificar se o PV foi criado ao usar o seguinte comando:
</p>
<pre># pvs
</pre>
<h4>
<span id="Expans.C3.A3o"></span><span class="mw-headline" id="Expansão">Expansão</span>
</h4>
<p>Ao estender, ou antes de reduzir, o tamanho de um dispositivo que possui um volume físico sobre ele, você precisará expandir ou encolher o PV usando <span class="plainlinks archwiki-template-man" title="$ man 8 pvresize"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/pvresize.8">pvresize(8)</a></span>.
</p>
<p>Para expandir o PV em <code>/dev/sda1</code>, logo após de aumentar a <a href="../pt/Partitioning.html" class="mw-redirect" title="Partição">partição</a>, execute:
</p>
<pre># pvresize /dev/sda1
</pre>
<p>Com isso será automaticamente detectado o novo tamanho do dispositivo, e por fim o PV irá estender ao seu máximo.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Este comando pode ser usado enquanto o volume estiver online.</div>
<h4><span class="mw-headline" id="Encolhimento">Encolhimento</span></h4>
<p>Para encolher um volume físico antes de reduzir seu dispositivo subjacente, adicione os parâmetros <code>--setphysicalvolumesize <i>tamanho_aqui</i></code> no comando. Em exemplo:
</p>
<pre># pvresize --setphysicalvolumesize 40G /dev/sda1
</pre>
<p>O comando acima talvez mostre-lhe o seguinte erro:
</p>
<pre>/dev/sda1: cannot resize to 25599 extents as later ones are allocated.
0 physical volume(s) resized / 1 physical volume(s) not resized
</pre>
<p>Ou de forma traduzida:
</p>
<pre>/dev/sda1: não foi possível redimensionar para 25599 extensões, pois há extensões posteriormente já alocadas.
0 volume(s) físico(s) redimensionados / 1 volume(s) físico(s) não redimensionado(s).
</pre>
<p>Realmente, <i>pvresize</i> se negará a encolher um PV se o mesmo estiver com as extensões alocadas após o local que as novas últimas alocações do volume deveriam estar. É necessário executar <a href="#Movendo_extens%C3%B5es_f%C3%ADsicas">pvmove</a> de antemão para realocá-las em outro lugar no grupo de volume, e para tal deve haver espaço livre disponível.
</p>
<h5>
<span id="Movendo_extens.C3.B5es_f.C3.ADsicas"></span><span class="mw-headline" id="Movendo_extensões_físicas">Movendo extensões físicas</span>
</h5>
<p>Antes de liberar as extensões físicas que estão no final do volume, deve-se executar <code>pvdisplay -v -m</code> para vê-las. Uma alternativa seria ver os segmentos de forma tabular com <code>pvs --segments -v</code>.
</p>
<p>No exemplo abaixo, há um volume físico em <code>/dev/sdd1</code>, um grupo de volume como <code>vg1</code> e um volume lógico chamado <code>backup</code>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># pvdisplay -v -m</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">    Finding all volume groups.
    Using physical volume(s) on command line.
  --- Physical volume ---
  PV Name               /dev/sdd1
  VG Name               vg1
  PV Size               1.52 TiB / not usable 1.97 MiB
  Allocatable           yes 
  PE Size               4.00 MiB
  Total PE              399669
  Free PE               153600
  Allocated PE          246069
  PV UUID               MR9J0X-zQB4-wi3k-EnaV-5ksf-hN1P-Jkm5mW
   
  --- Physical Segments ---
  Physical extent 0 to 153600:
    FREE
  Physical extent 153601 to 307199:
    Logical volume	/dev/vg1/backup
    Logical extents	1 to 153599
  Physical extent 307200 to 307200:
    FREE
  Physical extent 307201 to 399668:
    Logical volume	/dev/vg1/backup
    Logical extents	153601 to 246068
</pre>
<p>Observe que o espaço sinalizado como <code>FREE</code> foi distribuído para outro local ao longo do volume. Nós devemos primeiramente mover todos os segmentos usados para o começo do volume.
</p>
<p>Aqui o primeiro segmento livre é de 0 a 153600, desta forma são 153601 extensões livres. Nós agora podemos mover esse número de segmentos da última extensão física para a primeira extensão. O comando portanto será:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># pvmove --alloc anywhere /dev/sdd1:307201-399668 /dev/sdd1:0-92467</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/dev/sdd1: Moved: 0.1 %
/dev/sdd1: Moved: 0.2 %
...
/dev/sdd1: Moved: 99.9 %
/dev/sdd1: Moved: 100.0 %
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> 
<ul>
<li>Este comando move 399668 - 307201 + 1 = 92468 PEs <b>do</b> último segmento <b>até</b> o primeiro segmento. Isto é possível porque o primeiro segmento contém 153600 PEs livres, do qual pode alocar os PEs movidos, ou seja, 92467 - 0 + 1 = 92468.</li>
<li>A opção <code>--alloc anywhere</code> é usada enquanto movemos os PEs para dentro da mesma partição. Em caso de diferentes partições, o comando pode parecer-se com: <pre># pvmove /dev/sdb1:1000-1999 /dev/sdc1:0-999</pre>
</li>
<li>A execução deste comando pode demorar (entre uma a duas horas) em caso de volumes extensos. É provável que seja uma boa ideia executar o comando em um <a href="../en/Tmux.html" title="Tmux">tmux</a> ou em uma sessão de <a href="../en/GNU_Screen.html" title="GNU Screen">GNU Screen</a>. Qualquer parada indesejada do processo é capaz de ser fatal.</li>
<li>Quando a operação for concluída, execute <a href="../pt/Fsck.html" title="Fsck (Português)">fsck</a> para averiguar se o seu sistema de arquivos é válido.</li>
</ul>
</div>
<h5>
<span id="Redimensionando_um_volume_f.C3.ADsico"></span><span class="mw-headline" id="Redimensionando_um_volume_físico">Redimensionando um volume físico</span>
</h5>
<p>Uma vez que todos os segmentos físicos livres estejam nas últimas extensões físicas, execute <code>vgdisplay</code> com privilégios de root e veja sua PE livre.
</p>
<p>Você pode agora executar novamente o comando:
</p>
<pre># pvresize --setphysicalvolumesize <i>tamanho</i> <i>VolumeFísico</i>
</pre>
<p>Veja o resultado:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># pvs</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">  PV         VG   Fmt  Attr PSize    PFree 
  /dev/sdd1  vg1  lvm2 a--     1t     500g
</pre>
<h5>
<span id="Redimensionando_a_parti.C3.A7.C3.A3o"></span><span class="mw-headline" id="Redimensionando_a_partição">Redimensionando a partição</span>
</h5>
<p>Por fim, você deve diminuir a partição com sua <a href="../pt/Partitioning.html#Ferramentas_de_particionamento" title="Partitioning (Português)">ferramenta de particionamento</a> favorita.
</p>
<h3><span class="mw-headline" id="Grupos_de_volume">Grupos de volume</span></h3>
<h4><span class="mw-headline" id="Criando_um_grupo_de_volume">Criando um grupo de volume</span></h4>
<p>Para criar uma VG <code>MeuGrupoVol</code> com um PV associado ao <code>/dev/sdb1</code>, execute:
</p>
<pre># vgcreate MeuGrupoVol /dev/sdb1
</pre>
<p>Você pode verificar se foi criado o VG <code>MeuGrupoVol</code> usando o seguinte comando:
</p>
<pre># vgs
</pre>
<p>Você pode vincular múltiplos PVs ao criar um VG como este:
</p>
<pre># vgcreate MeuGrupoVol /dev/sdb1 /dev/sdb2
</pre>
<h4><span class="mw-headline" id="Ativando_um_grupo_de_volume">Ativando um grupo de volume</span></h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Você pode restringir os volumes que serão ativados automaticamente ao configurar o <code>auto_activation_volume_list</code> em <code>/etc/lvm/lvm.conf</code>. Em caso de dúvida, deixe esta opção comentada.</div>
<pre># vgchange -a y MeuGrupoVol
</pre>
<p>Por padrão isto vai reativar o grupo de volume, quando for aplicável para tal. Por exemplo, se houver uma falha de drive em um espelhamento e o mesmo já substituiu a unidade: (1) execute <code>pvcreate</code>, (2) <code>vgextend</code> e (3) <code>vgreduce --removemissing --force</code>.
</p>
<h4><span class="mw-headline" id="Reparando_um_grupo_de_volume">Reparando um grupo de volume</span></h4>
<p>Para começar o processo de reconstrução do arranjo (<i>array</i>) deteriorado de um espelhamento neste exemplo, você deve executar:
</p>
<pre># lvconvert --repair /dev/MeuGrupoVol/mirror
</pre>
<p>Você pode monitorar o processo de reconstrução (Cpy%Sync Column output) com:
</p>
<pre># lvs -a -o +devices
</pre>
<h4><span class="mw-headline" id="Desativando_um_grupo_de_volume">Desativando um grupo de volume</span></h4>
<p>Apenas invoque:
</p>
<pre># vgchange -a n MeuGrupoVol
</pre>
<p>Isto irá desativar o grupo de volume e permitir-lhe a desmontagem do contêiner que está armazenando-o.
</p>
<h4><span class="mw-headline" id="Renomeando_um_grupo_de_volume">Renomeando um grupo de volume</span></h4>
<p>Use o comando <span class="plainlinks archwiki-template-man" title="$ man 8 vgrename"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/vgrename.8">vgrename(8)</a></span> para renomear um grupo de volume existente.
</p>
<p>Ambos os comandos a seguir renomeiam o grupo de volume existente de <code>MeuGrupoVol</code> para <code>meu_grupo_volume</code>:
</p>
<pre># vgrename /dev/MeuGrupoVol /dev/meu_grupo_volume
</pre>
<pre># vgrename MeuGrupoVol meu_grupo_volume
</pre>
<p>Garanta a atualização de todos os arquivos de configuração (por exemplo <code>/etc/fstab</code> ou <code>/etc/crypttab</code>) que referenciam o grupo de volume renomeado.
</p>
<h4>
<span id="Adicionando_um_volume_f.C3.ADsico_em_um_grupo_de_volume"></span><span class="mw-headline" id="Adicionando_um_volume_físico_em_um_grupo_de_volume">Adicionando um volume físico em um grupo de volume</span>
</h4>
<p>Primeiro, crie um novo volume físico no bloco do dispositivo que você deseja usar, então estenda o grupo de volume do mesmo:
</p>
<pre># pvcreate /dev/sdb1
# vgextend MeuGrupoVol /dev/sdb1
</pre>
<p>Isto, é claro, irá aumentar o número total de extensões físicas no seu grupo de volume, e que podem ser alocadas por volumes lógicos da forma que você achar melhor.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> É considerado ideal ter uma <a href="../pt/Partitioning.html#Tabela_de_parti%C3%A7%C3%A3o" class="mw-redirect" title="Tabela de partição">tabela de partição</a> abaixo do LVM, em sua mídia de armazenamento. Use para o tipo apropriado da partição: <code>8e</code> para MBR, e <code>E6D6D379-F507-44C2-A23C-238F2A3DF928</code> para partições GPT.</div>
<h4>
<span id="Removendo_uma_parti.C3.A7.C3.A3o_de_um_grupo_de_volume"></span><span class="mw-headline" id="Removendo_uma_partição_de_um_grupo_de_volume">Removendo uma partição de um grupo de volume</span>
</h4>
<p>Se você criou um volume lógico na partição, antes de tudo a <a href="#Removendo_um_volume_l%C3%B3gico">remova</a>
</p>
<p>Todos os dados daquela partição precisam ser movidos para outra partição. Felizmente, LVM torna isto fácil:
</p>
<pre># pvmove /dev/sdb1
</pre>
<p>Se você quiser mover os dados para um volume físico em específico, determine o armazenamento de destino como o segundo argumento em <code>pvmove</code>:
</p>
<pre># pvmove /dev/sdb1 /dev/sdf1
</pre>
<p>E então o volume físico precisa ser removido do grupo de volume:
</p>
<pre># vgreduce MeuGrupoVol /dev/sdb1
</pre>
<p>Ou remova todos os volumes físicos vazios:
</p>
<pre># vgreduce --all MeuGrupoVol
</pre>
<p>Por exemplo: Se você tiver um disco ruim em um grupo que não pode ser encontrado porque ele foi removido ou apresenta falha:
</p>
<pre># vgreduce --removemissing --force MeuGrupoVol
</pre>
<p>E finalmente, se você quiser usar a partição para outra coisa, e quer evitar que o LVM pense que a partição é um volume físico:
</p>
<pre># pvremove /dev/sdb1
</pre>
<h3>
<span id="Volumes_l.C3.B3gicos"></span><span class="mw-headline" id="Volumes_lógicos">Volumes lógicos</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> <span class="plainlinks archwiki-template-man" title="$ man 8 lvresize"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvresize.8">lvresize(8)</a></span> fornece mais ou menos as mesmas opções dos comandos especializados <span class="plainlinks archwiki-template-man" title="$ man 8 lvextend"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvextend.8">lvextend(8)</a></span> e <span class="plainlinks archwiki-template-man" title="$ man 8 lvreduce"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvreduce.8">lvreduce(8)</a></span>, enquanto que ao mesmo tempo permite ambos os tipos de operação. Não obstante, esses utilitários oferecem uma opção <code>-r</code>/<code>--resizefs</code> que permite redimensionar o sistema de arquivos em conjunto do LV ao usar <span class="plainlinks archwiki-template-man" title="$ man 8 fsadm"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/fsadm.8">fsadm(8)</a></span> (com suporte a <i>ext2</i>, <a href="../en/Ext3.html" title="Ext3">ext3</a>, <a href="../pt/Ext4.html" title="Ext4 (Português)">ext4</a>, <i>ReiserFs</i> e <a href="../pt/XFS.html" title="XFS (Português)">XFS</a>). Portanto, pode ser mais fácil e simples usar <code>lvresize</code> para ambas as operações e usar <code>--resizefs</code> para simplificar um pouco as coisas. A não ser que você tenha necessidades específicas ou queira total controle sobre o processo.</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Atenção:</strong> Enquanto que alargar um sistema de arquivos pode ser feito frequentemente online (isto é, enquanto estiver montado), mesmo para partições root, encolher irá quase sempre requerer primeiramente desmontar o sistema de arquivos para prevenir a perda de dados. Garanta que seu sistema de arquivos possui suporte para o que você está tentando fazer.</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Dica:</strong> Se um volume lógico será formatado em <a href="../pt/Ext4.html" title="Ext4 (Português)">ext4</a>, deixe pelo menos 256 MiB de espaço livre em seu grupo de volume para permitir o uso de <span class="plainlinks archwiki-template-man" title="$ man 8 e2scrub"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/e2scrub.8">e2scrub(8)</a></span>. Após a criação do último volume com <code>-l 100%FREE</code>, isto pode ser alcançado ao reduzir o tamanho com <code>lvreduce -L -256M <i>grupo_volume</i>/<i>volume_logico</i></code>.</div>
<h4>
<span id="Criando_um_volume_l.C3.B3gico"></span><span class="mw-headline" id="Criando_um_volume_lógico">Criando um volume lógico</span>
</h4>
<p>Para criar um LV <code>homevol</code> em um VG <code>MeuGrupoVol</code> com 300 GiB de capacidade, execute:
</p>
<pre># lvcreate -L 300G MeuGrupoVol -n homevol
</pre>
<p>Ou para criar um LV <code>homevol</code> em um VG <code>MeuGrupoVol</code> com o restante da capacidade, execute:
</p>
<pre># lvcreate -l 100%FREE MeuGrupoVol -n homevol
</pre>
<p>Para criar o LV enquanto o restringe para PVs específicos e com o VG por dentro, acrescente os volumes físicos ao comando:
</p>
<pre># lvcreate -L 300G MeuGrupoVol -n homevol /dev/sda1
</pre>
<p>O novo LV irá aparecer como <code>/dev/MeuGrupoVol/homevol</code>. Agora você pode <a href="../pt/File_systems.html#Criar_um_sistema_de_arquivos" title="File systems (Português)">formatar</a> o LV com um sistema de arquivos apropriado.
</p>
<p>Você pode verificar o LV criado usando o seguinte comando:
</p>
<pre># lvs
</pre>
<h4>
<span id="Renomeando_um_volume_l.C3.B3gico"></span><span class="mw-headline" id="Renomeando_um_volume_lógico">Renomeando um volume lógico</span>
</h4>
<p>Para renomear um volume lógico existente, use o comando <span class="plainlinks archwiki-template-man" title="$ man 8 lvrename"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvrename.8">lvrename(8)</a></span>.
</p>
<p>Ambos os comandos a seguir renomeiam o volume lógico <code>vol_velho</code> no grupo de volume <code>MeuGrupoVol</code> para <code>vol_novo</code>.
</p>
<pre># lvrename /dev/MeuGrupoVol/vol_velho /dev/MeuGrupoVol/vol_novo
</pre>
<pre># lvrename MeuGrupoVol vol_velho vol_novo
</pre>
<p>Garanta a atualização de todos os arquivos de configuração (por exemplo <code>/etc/fstab</code> ou <code>/etc/crypttab</code>) que referenciam o volume lógico renomeado.
</p>
<h4>
<span id="Redimensionando_um_volume_l.C3.B3gico_e_um_sistema_de_arquivos_de_uma_s.C3.B3_vez"></span><span class="mw-headline" id="Redimensionando_um_volume_lógico_e_um_sistema_de_arquivos_de_uma_só_vez">Redimensionando um volume lógico e um sistema de arquivos de uma só vez</span>
</h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Apenas os <a href="../pt/File_systems.html" title="File systems (Português)">sistemas de arquivos</a> <i>ext2</i>, <a href="../en/Ext3.html" title="Ext3">ext3</a>, <a href="../pt/Ext4.html" title="Ext4 (Português)">ext4</a>, <i>ReiserFS</i> e <a href="../pt/XFS.html" title="XFS (Português)">XFS</a> são suportados. Para um tipo diferente de sistema de arquivos veja <a href="#Redimensionando_o_volume_l%C3%B3gico_e_o_sistema_de_arquivos_separadamente">como redimensionar separadamente</a>.</div>
<p>Estenda o volume lógico <code>mediavol</code> em <code>MeuGrupoVol</code> para 10 GiB e redimensione o sistema de arquivos <i>de uma só vez</i>:
</p>
<pre># lvresize -L +10G --resizefs MeuGrupoVol/mediavol
</pre>
<p>Defina o tamanho do volume lógico <code>mediavol</code> em <code>MeuGrupoVol</code> para 15 GiB e redimensione o sistema de arquivos <i>de uma só vez</i>:
</p>
<pre># lvresize -L 15G --resizefs MeuGrupoVol/mediavol
</pre>
<p>Se você quiser encher todo o espaço livre disponível no grupo de volume, use o seguinte comando:
</p>
<pre># lvresize -l +100%FREE --resizefs MeuGrupoVol/mediavol
</pre>
<p>Veja <span class="plainlinks archwiki-template-man" title="$ man 8 lvresize"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvresize.8">lvresize(8)</a></span> para mais opções detalhadas.
</p>
<h4>
<span id="Redimensionando_o_volume_l.C3.B3gico_e_o_sistema_de_arquivos_separadamente"></span><span class="mw-headline" id="Redimensionando_o_volume_lógico_e_o_sistema_de_arquivos_separadamente">Redimensionando o volume lógico e o sistema de arquivos separadamente</span>
</h4>
<p>Para sistemas de arquivos não suportados por <span class="plainlinks archwiki-template-man" title="$ man 8 fsadm"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/fsadm.8">fsadm(8)</a></span>, será necessário usar <a href="../pt/File_systems.html#Tipos_de_sistemas_de_arquivos" title="File systems (Português)">utilitários apropriados</a> para redimensionar o sistema de arquivos antes de encolher o volume lógico ou depois de expandi-lo.
</p>
<p>Para estender um volume lógico <code>mediavol</code> por dentro de um grupo de volume <code>MeuGrupoVol</code> para 2 GiB <i>sem</i> encostar no sistema de arquivos:
</p>
<pre># lvresize -L +2G MeuGrupoVol/mediavol
</pre>
<p>Agora expanda o sistema de arquivos (<a href="../pt/Ext4.html" title="Ext4 (Português)">Ext4</a> neste exemplo) para o tamanho máximo do volume lógico subjacente:
</p>
<pre># resize2fs /dev/MeuGrupoVol/mediavol
</pre>
<p>Para <a href="../pt/Btrfs.html" title="Btrfs (Português)">Btrfs</a>, o <span class="plainlinks archwiki-template-man" title="$ man 8 btrfs-filesystem"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/btrfs-filesystem.8">btrfs-filesystem(8)</a></span> espera o ponto de montagem ao invés do dispositivo. O equivalente seria:
</p>
<pre># btrfs filesystem resize max <i>/mnt/meu-ponto-de-montagem</i>
</pre>
<p>Para reduzir o tamanho do volume lógico <code>mediavol</code> em <code>MeuGrupoVol</code> para 500 MiB, primeiramente calcule o tamanho resultante do sistema de arquivos, em seguida encolha o sistema de arquivos (<a href="../pt/Ext4.html" title="Ext4 (Português)">Ext4</a> neste exemplo) para o novo tamanho:
</p>
<pre># resize2fs /dev/MeuGrupoVol/mediavol <i>NovoTamanho</i>
</pre>
<p>Ao contrário do Ext4, <a href="../pt/Btrfs.html" title="Btrfs (Português)">Btrfs</a> oferece suporte ao encolhimento online (novamente, o ponto de montagem deverá ser especificado). Por exemplo:
</p>
<pre># btrfs filesystem resize -500M <i>/mnt/meu-ponto-de-montagem</i>
</pre>
<p>Quando o sistema de arquivos for encolhido, reduza o tamanho do volume lógico:
</p>
<pre># lvresize -L -500M MeuGrupoVol/mediavol
</pre>
<p>Para calcular o exato tamanho do volume lógico para os sistemas de arquivos <i>ext2</i>, <a href="../en/Ext3.html" title="Ext3">ext3</a>, <a href="../pt/Ext4.html" title="Ext4 (Português)">ext4</a>, use uma formula simples:
</p>
<p><code>LVM_EXTENTS = FS_BLOCKS × FS_BLOCKSIZE ÷ LVM_EXTENTSIZE</code>.
</p>
<p>Ou de forma traduzida:
</p>
<p><code>LVM_EXTENSÕES = SA_BLOCOS × SA_TAMANHO-DO-BLOCO ÷ LVM_TAMANHO-DA-EXTENSÃO</code>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># tune2fs -l /dev/MeuGrupoVol/mediavol | grep Block</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Block count:              102400000
Block size:               4096
Blocks per group:         32768
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># vgdisplay MeuGrupoVol | grep "PE Size"</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">PE Size               4.00 MiB
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> O tamanho do block do sistema de arquivos é em bytes. Garanta as mesmas unidades para ambos, ou seja, para o bloco e para o tamanho da extensão.</div>
<pre>102400000 blocos × 4096 bytes/blocos ÷ 4 MiB/extensões = 100000 extensões
</pre>
<p>Ao passar <code>--resizefs</code> será confirmado com a correção.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># lvreduce -l 100000 --resizefs /dev/MyVolGroup/mediavol</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
The filesystem is already 102400000 (4k) blocks long.  Nothing to do!
...
Logical volume sysvg/root successfully resized.
</pre>
<p>Ou de forma traduzida: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># lvreduce -l 100000 --resizefs /dev/MeuGrupoVol/mediavol</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
O sistema de arquivos já está alongado para 102400000 (4k) blocos. Não há nada para fazer!
...
Volume lógico sysvg/root foi redimensionado com sucesso.
</pre>
<p>Veja <span class="plainlinks archwiki-template-man" title="$ man 8 lvresize"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvresize.8">lvresize(8)</a></span> para mais opções detalhadas.
</p>
<h4>
<span id="Removendo_um_volume_l.C3.B3gico"></span><span class="mw-headline" id="Removendo_um_volume_lógico">Removendo um volume lógico</span>
</h4>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Atenção:</strong> Antes de remover o volume lógico, tenha certeza que moveu todos os dados que você gostaria de manter para outro lugar, caso o contrário você perderá tudo!</div>
<p>Primeiro, encontre o nome do volume lógico que você quer remover. Você pode pegar uma lista de todos os volumes lógicos presentes com:
</p>
<pre># lvs
</pre>
<p>Depois, procure o ponto de montagem do volume lógico escolhido:
</p>
<pre>$ lsblk
</pre>
<p>Então, desmonte o sistema de arquivos do volume lógico:
</p>
<pre># umount /<i>ponto-de-montagem</i>
</pre>
<p>Por fim, remova o volume lógico:
</p>
<pre># lvremove <i>grupo_volume</i>/<i>volume_logico</i>
</pre>
<p>Por exemplo:
</p>
<pre># lvremove MeuGrupoVol/homevol
</pre>
<p>Confirme a operação digitando <code>y</code>.
</p>
<p>Garanta a atualização de todos os arquivos de configuração (por exemplo <code>/etc/fstab</code> ou <code>/etc/crypttab</code>) que referenciam o volume lógico removido.
</p>
<p>Você pode verificar a remoção do volume lógico ao digitar <code>lvs</code> como root novamente (veja o primeiro passo desta seção).
</p>
<h2><span class="mw-headline" id="Snapshots">Snapshots</span></h2>
<p>LVM permite suporte aos CoW snapshots (Cópia em Gravação, do inglês <i>Copy-on-Write</i>). Um CoW snapshot inicialmente cria um apontamento para os dados originais; quando os blocos de dados são sobrescritos a cópia original permanece intacta, enquanto que os novos blocos são gravados em outro lugar no disco. Isto possui diversas propriedades cobiçáveis:
</p>
<ul>
<li>Criar um snapshot é rápido, pois não há cópia de dados (apenas cria uma lista bem curta de ponteiros, dos quais apontam para outras localizações no disco).</li>
<li>Snapshots requerem apenas o espaço livre suficiente para armazenar os novos blocos de dados (mais uma quantidade de armazenamento, entretanto negligenciável, para o apontamento de novos blocos). Por exemplo, para um snapshot de 35 GiB se utiliza apenas 2 GiB (incluso os dados do ponto de origem e do snapshot), portanto requer apenas 2 GiB de espaço livre.</li>
</ul>
<p>Os snapshots do LVM estão a nível de bloco; eles criam um novo dispositivo de bloco sem aparente relação com o original, exceto ao lidar com as ferramentas do LVM, logo, ao deletar arquivos na cópia original não será liberado espaço nos snapshots. Se você precisa de snapshots a nível de sistema de arquivos, é necessário que use <a href="../pt/Btrfs.html" title="Btrfs (Português)">btrfs</a>, <a href="../pt/ZFS.html" title="ZFS (Português)">ZFS</a> ou <a href="../en/Bcachefs.html" title="Bcachefs">bcachefs</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Atenção:</strong> 
<ul>
<li>Um CoW snapshot <b>não é um backup</b> porque o mesmo não faz uma segunda cópia dos dados originários. Como exemplo, um setor danificado do disco que afete os dados originais também afetará os snapshots. Com isto dito, um snapshot pode ser útil enquanto outra ferramenta gerencia um backup, como destacado logo <a href="#Backups">abaixo</a>.</li>
<li>Btrfs espera que diferentes sistemas de arquivos tenham diferentes UUIDs. Se você tirar um snapshot de um volume LVM que contem um sistema de arquivos btrfs, lembre-se de alterar o UUID do sistema de arquivos original ou da cópia antes de ambos serem montados (ou faça ser visível para o kernel; em exemplo, em caso de um daemon sem relação engatilhar um <i>escaneamento do dispositivo btrfs</i>). Para detalhes veja sobre <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/Gotchas#Block-level_copies_of_devices">btrfs na wiki Gotcha's</a>.</li>
</ul>
</div>
<h3>
<span id="Configura.C3.A7.C3.A3o"></span><span class="mw-headline" id="Configuração">Configuração</span>
</h3>
<p>É criado um snapshot de volumes lógicos da mesma forma que cria-se volumes lógicos normais.
</p>
<pre># lvcreate --size 100M --snapshot --name snap01vol /dev/MeuGrupoVol/lvol
</pre>
<p>Com este volume você pode modificar menos que 100 MiB de dados, antes que o volume de snapshot encha por completo.
</p>
<p>A reversão do volume lógico <code>lvol</code> modificado para o estado que o snapshot <code>snap01vol</code> foi criado pode ser feita com:
</p>
<pre># lvconvert --merge /dev/MyVolGroup/snap01vol
</pre>
<p>Em caso do volume lógico original estar ativo, haverá uma mesclagem no próximo reboot (esta fusão pode ser feita a partir de um LiveCD).
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> O snapshot não existirá após a mesclagem/fusão.</div>
<p>Além disso, múltiplos snapshots podem ser tirados e cada um pode ser mesclado com o volume lógico original à vontade.
</p>
<h3><span class="mw-headline" id="Backups">Backups</span></h3>
<p>Um snapshot fornece uma cópia congelada de um sistema de arquivos para a criação de backups. Por exemplo, um backup que leve duas horas fornece uma maior consistência de imagem do sistema de arquivos, isto em comparação a um backup feito diretamente na partição.
</p>
<p>O snapshot pode ser montado e feito o backup com <a href="../pt/Dd.html" title="Dd (Português)">dd</a> ou <a href="../pt/Archiving_and_compression.html" class="mw-redirect" title="Tar (Português)">tar</a>. O tamanho do arquivo de backup feito pelo <i>dd</i> será igual ao tamanho dos arquivos que residem no volume de snapshot.
</p>
<p>Para restauração é preciso apenas criar um snapshot, montá-lo, gravar ou extrair o backup nele, e por fim mesclar/fundir com a origem.
</p>
<p>Veja a página em inglês sobre <a href="../en/Create_root_filesystem_snapshots_with_LVM.html" title="Create root filesystem snapshots with LVM">Criação de snapshots do sistema de arquivos root com LVM</a> para automatizar a criação e limpeza de snapshots do root, além de criar durante o processo de inicialização do sistema os backups ou os <i>rollbacks</i> (reversões).
</p>
<h2><span class="mw-headline" id="Criptografia">Criptografia</span></h2>
<p>Veja os tópicos <a href="../pt/Dm-crypt/Encrypting_an_entire_system.html#LVM_dentro_do_LUKS" title="Dm-crypt (Português)/Encrypting an entire system (Português)">LVM dentro do LUKS</a> e <a href="../pt/Dm-crypt/Encrypting_an_entire_system.html#LUKS_dentro_do_LVM" title="Dm-crypt (Português)/Encrypting an entire system (Português)">LUKS dentro do LVM</a> para conhecer os possíveis esquemas ao combinar LUKS com LVM.
</p>
<h2><span class="mw-headline" id="Cache">Cache</span></h2>
<p>De <span class="plainlinks archwiki-template-man" title="$ man 7 lvmcache"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvmcache.7">lvmcache(7)</a></span>:
</p>
<dl><dd>O cache de volumes lógicos usa um LV pequeno e rápido para melhorar o desempenho de um LV grande e lento. Isto é feito armazenando os blocos usados frequentemente em um LV mais rápido. O LVM então refere-se ao LV pequeno e rápido como um LV de cache. O LV grande e lento é chamado de LV de origem. Devido às requisições do dm-cache (o driver do kernel), o LVM divide adicionalmente o LV de cache em dois dispositivos - um LV de cache de dados e um LV de cache de metadados. O LV de cache de dados é o local onde cópias dos blocos de dados são mantidos à partir do LV de origem para aumentar a velocidade. O LV de cache de metadados mantém informações que especificam onde os blocos de dados estão armazenados (por exemplo, no LV de origem ou no LV de cache de dados). Usuários devem familiarizar-se com esses LVs se desejarem criar volumes de cache melhores e mais robustos. Todos estes LVs associados devem residir no mesmo VG.</dd></dl>
<h3><span class="mw-headline" id="Criar_cache">Criar cache</span></h3>
<p>Converta seu disco rápido (<code>/dev/<i>disco-rápido</i></code>) para um PV e adicione-o ao seu VG (<code>MeuGrupoVol</code>) existente:
</p>
<pre># vgextend MeuGrupoVol /dev/<i>disco-rápido</i>
</pre>
<p>Crie uma área de cache com metadado automático em <code>dev/<i>disco-rápido</i></code> e converta o LV existente <code>MeuGrupoVol/rootvol</code> para um volume de cache. Tudo isso é feito em um único passo:
</p>
<pre># lvcreate --type cache --cachemode writethrough -l 100%FREE -n root_cachepool MeuGrupoVol/rootvol /dev/<i>disco-rápido</i>
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Dica:</strong> Ao invés de usar <code>-l 100%FREE</code> para alocar 100% do espaço disponível do PV <code>/dev/<i>disco-rápido</i></code><i>, você poderia usar <code>-L 20G</code> para alocar apenas 20 GiB para a área de cache.</i>
</div>
<p>O modo de cache (do inglês <i>Cachemode</i>) possui duas possibilidades de opções:
</p>
<ul>
<li>
<code>writethrough</code> garante que quaisquer dados escritos serão armazenados no LV de cache e no LV de origem. A perda do dispositivo associado ao LV de cache, neste caso, não significará a perda de quaisquer dados.</li>
<li>
<code>writeback</code> garante melhor desempenho, ao custo de maior risco de perda de dados em caso do dispositivo usado para cache falhar.</li>
</ul>
<p>Se não for indicado um <code>--cachemode</code> específico, o sistema irá assumir a opção <code>writethrough</code> por padrão.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Dica:</strong> A contagem da perda de cache pode ser vista com <i>lvdisplay</i>, ou de forma similar com <i>lvm-cache-stats</i> do pacote <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libblockdev-lvm">libblockdev-lvm</a></span>, do qual também mostrará a perda em porcentagem.</div>
<h3><span class="mw-headline" id="Remover_cache">Remover cache</span></h3>
<p>Se por algum motivo você precisar desfazer a operação de criação acima:
</p>
<pre># lvconvert --uncache MeuGrupoVol/rootvol
</pre>
<p>Isto sujeita qualquer escrita ainda pendente no cache de volta para o LV de origem, e então o deleta. Outras opções disponíveis são descritas em <span class="plainlinks archwiki-template-man" title="$ man 7 lvmcache"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvmcache.7">lvmcache(7)</a></span>.
</p>
<h2><span class="mw-headline" id="RAID">RAID</span></h2>
<p>LVM pode ser usado para criar um <a href="../pt/RAID.html#Implementa%C3%A7%C3%A3o" title="RAID (Português)">RAID em software</a>. É uma boa escolha se o usuário não tiver RAID em hardware e já estava planejando usar LVM de qualquer forma. De <span class="plainlinks archwiki-template-man" title="$ man 7 lvmraid"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvmraid.7">lvmraid(7)</a></span>:
</p>
<dl><dd>
<span class="plainlinks archwiki-template-man" title="$ man 8 lvm"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvm.8">lvm(8)</a></span> RAID é uma maneira de criar um volume lógico (LV) que usa múltiplos dispositivos físicos para aumentar performance ou tolerar falhas em dispositivos. Em LVM, os dispositivos físicos são, na verdade, volumes físicos (PVs) em um único grupo de volume (VG).</dd></dl>
<p>LVM RAID tem suporte para RAID 0, RAID 1, RAID 4, RAID 5, RAID 6 e RAID 10. Veja em <a href="https://en.wikipedia.org/wiki/Standard_RAID_levels" class="extiw" title="wikipedia:Standard RAID levels">Wikipedia:Standard RAID levels</a> para conhecer os detalhes de cada nível.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Dica:</strong> <a href="../pt/RAID.html" title="RAID (Português)">mdadm</a> pode também ser usado para criar RAID em software. De fato é mais simples, mais popular e mais fácil de configurar.</div>
<h3><span class="mw-headline" id="Configurando_RAID">Configurando RAID</span></h3>
<p>Crie os volumes físicos:
</p>
<pre># pvcreate /dev/sda2 /dev/sdb2
</pre>
<p>Crie um grupo de volume nos volumes físicos:
</p>
<pre># vgcreate MeuGrupoVol /dev/sda2 /dev/sdb2
</pre>
<h4><span class="mw-headline" id="Novos_volumes">Novos volumes</span></h4>
<p>Crie os volumes lógicos com <code>lvcreate --type <i>raidnível</i></code>. Veja <span class="plainlinks archwiki-template-man" title="$ man 7 lvmraid"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvmraid.7">lvmraid(7)</a></span> e <span class="plainlinks archwiki-template-man" title="$ man 8 lvcreate"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvcreate.8">lvcreate(8)</a></span> para mais opções.
</p>
<pre># lvcreate --type RaidNível [OPTIONS] -n Nome -L Tamanho VG [PVs]
</pre>
<h5><span class="mw-headline" id="RAID_0">RAID 0</span></h5>
<p>Por exemplo:
</p>
<pre># lvcreate -n meuraid1vol -i 2 -I 64 -L 70G GrupoVol00 /dev/nvme1n1p1 /dev/nvme0n1p1
</pre>
<p>O comando acima irá criar e separar 70 GiB (raid0) do volume lógico nomeado como "meuraid1vol" em GrupoVol00. A disjunção dos dados será distribuída entre <code>/dev/nvme1n1p1</code> e <code>/dev/nvme0n1p1</code>. O tamanho de cada parte dividida está definido para ser 64K.
</p>
<h5><span class="mw-headline" id="RAID_1">RAID 1</span></h5>
<p>Por exemplo:
</p>
<pre># lvcreate --type raid1 --mirrors 1 -L 20G -n meuraid1vol MeuGrupoVol /dev/sda2 /dev/sdb2
</pre>
<p>O comando acima irá criar um volume lógico espelhado, nomeado como "meuraid1vol" em GrupoVol00, com 20 GiB de dados em <code>/dev/sda2</code> e <code>/dev/sdb2</code>.
</p>
<h5><span class="mw-headline" id="RAID_10">RAID 10</span></h5>
<p>Por exemplo:
</p>
<pre># lvcreate -n meuraid1vol -L 100G --type raid10 -m 1 -i 2 MeuGrupoVol /dev/sdd1 /dev/sdc1 /dev/sdb1 /dev/sda5
</pre>
<p>O comando acima irá criar um volume lógico RAID10 de 100 GiB, nomeado como "meuraid1vol" em GrupoVol00, entre <code>/dev/sdd1</code>, <code>/dev/sdc1</code>, <code>/dev/sdb1</code> e <code>/dev/sda5</code>.
</p>
<h4><span class="mw-headline" id="Volumes_existentes">Volumes existentes</span></h4>
<p>Você pode converter facilmente um volume "não RAID" (por exemplo, linear) para basicamente qualquer configuração raid, contanto que você tenha dispositivos físicos suficientes para satisfazer os critérios de criação de RAID. Alguns irão requisitar seguir passos intermediários, do qual o comando <code>lvconvert</code> informará a você na linha de comando para aceitar. O <code>raid10</code> abaixo pode ser substituído por <code>raid0</code>, <code>raid1</code>, <code>raid5</code>, etc.
</p>
<pre># lvconvert --type raid10 /dev/vg01/lv01
</pre>
<p>Para usar PVs específicos:
</p>
<pre># lvconvert --type raid10 /dev/vg01/lv01 /dev/sda1 /dev/sdb2 /dev/nvme0n1p1 ...
</pre>
<p>Você pode rastrear o processo de conversão com:
</p>
<pre># watch lvs -o name,vg_name,copy_percent
</pre>
<h2><span class="mw-headline" id="Provisionamento_fino">Provisionamento fino</span></h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Quando estiver montando um sistema de arquivos em um LV fino, sempre lembre de usar a opção <code>discard</code> ou usar <a href="../en/Solid_state_drive.html#Periodic_TRIM" class="mw-redirect" title="Fstrim">fstrim</a> regularmente para permitir que o LV fino encolha a medida que arquivos forem deletados.</div>
<p>De <span class="plainlinks archwiki-template-man" title="$ man 7 lvmthin"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvmthin.7">lvmthin(7)</a></span>:
</p>
<dl><dd>Blocos em um volume lógico (LV) padrão <span class="plainlinks archwiki-template-man" title="$ man 8 lvm"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvm.8">lvm(8)</a></span> são alocados a partir do momento que o LV é criado, porém blocos em um LV de provisionamento fino são alocados a medida que há a escritura/gravação dos dados. Por conta disto, é oferecido para um LV de provisão fina um tamanho virtual, e o mesmo pode ser maior do que é fisicamente disponibilizado no armazenamento. A quantidade de armazenamento físico providenciada para LVs de provisão fina pode ao decorrer do tempo aumentar a medida que for necessário.</dd></dl>
<h3><span class="mw-headline" id="Exemplo:_implementando_servidores_privados_virtuais">Exemplo: implementando servidores privados virtuais</span></h3>
<p>Aqui vai um caso clássico de uso. Suponha que você queira começar seu próprio serviço de VPS, inicialmente hospedando cerca de 100 VPSes em um único computador com disco rígido de 930 GiB. Dificilmente qualquer um dos VPSes irá realmente usar todo o armazenamento que eles foram alocados, então ao invés de alocar 9 GiB para cada VPS, você poderia permitir que cada VPS tenha um tamanho máximo de 30 GiB e que usem provisionamento fino para somente alocar o espaço que cada VPS estará de fato usando no disco rígido. Presuma que o disco rígido de 930 GiB é <code>/dev/sdb</code>. Esta seria a configuração:
</p>
<p>Prepare o grupo de volume, <code>MeuGrupoVol</code>.
</p>
<pre># vgcreate MeuGrupoVol /dev/sdb
</pre>
<p>Crie a área fina (ou, do inglês <i>pool</i>) do LV, <code>MeuPoolFino</code>. Este LV irá providenciar os blocos para armazenamento.
</p>
<pre># lvcreate --type thin-pool -n MeuPoolFino -l 95%FREE MeuGrupoVol
</pre>
<p>A pool é composta de dois sub-volumes, o LV de dado e o LV de metadado; este comando cria ambos automaticamente, porém o espaço fino para de funcionar se ambos encherem completamente, e atualmente LVM não possui suporte para encolhimento de nenhum destes volumes. É por isso que o comando acima permite 5% de espaço extra, em caso de você precisar eventualmente expandir os sub-volumes de dado ou de metadado da área fina.
</p>
<p>Para cada VPS, crie um LV fino. Este é o dispositivo de bloco exposto ao usuário para a partição root.
</p>
<pre># lvcreate -n AlgunsClientesRoot -V 30G --thinpool MeuPoolFino MeuGrupoVol
</pre>
<p>O dispositivo de bloco <code>/dev/MeuGrupoVol/AlgunsClientesRoot</code> pode então ser usado por uma instância de <a href="../pt/VirtualBox.html" title="VirtualBox (Português)">VirtualBox</a> como partição root.
</p>
<h4>
<span id="Usando_snapshots_finos_para_salvar_mais_espa.C3.A7o"></span><span class="mw-headline" id="Usando_snapshots_finos_para_salvar_mais_espaço">Usando snapshots finos para salvar mais espaço</span>
</h4>
<p>Snapshots finos são muito mais poderosos do que snapshots convencionais, por conta de serem propriamente LVs finos. Veja o guia da Red Hat <a rel="nofollow" class="external autonumber" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/configuring_and_managing_logical_volumes/index#creating-and-managing-thinly-provisioned-volumes_configuring-and-managing-logical-volumes">[4]</a> para uma lista completa de vantagens que estes snapshots possuem.
</p>
<p>Ao invés de instalar um Linux do zero toda vez que um VPS é criado, é mais eficiente em espaço começar com apenas um LV fino contendo uma instalação básica do Linux:
</p>
<pre># lvcreate -n RootGenérico -V 30G --thinpool MeuPoolFino MeuGrupoVol
*** instalado um Linux em /dev/MeuGrupoVol/RootGenérico ***
</pre>
<p>Então crie snapshots disso para cada VPS:
</p>
<pre># lvcreate -s MeuGrupoVol/RootGenérico -n AlgunsClientesRoot
</pre>
<p>Desta forma, na área fina há apenas uma cópia de dado comum para todos os VPSes, pelo menos inicialmente. Como uma adição bônus, a criação de um novo VPS é instantânea.
</p>
<p>Em razão destes snapshots serem finos, uma operação de escrita em <code>RootGenérico</code> faz apenas uma operação CoW no total, em vez de uma operação CoW por snapshot. Isto permite-lhe atualizar o <code>RootGenérico</code> de maneira mais eficiente do que se cada VPS fosse um snapshot regular.
</p>
<h3>
<span id="Exemplo:_atualiza.C3.A7.C3.A3o_de_armazenamento_com_zero_tempo_de_inatividade_.28zero-downtime.29"></span><span class="mw-headline" id="Exemplo:_atualização_de_armazenamento_com_zero_tempo_de_inatividade_(zero-downtime)">Exemplo: atualização de armazenamento com zero tempo de inatividade (zero-downtime)</span>
</h3>
<p>Existem aplicações de provisionamento fino por fora de uma hospedagem VPS, e existe um jeito de como você pode usá-las para crescer efetivamente a capacidade de um sistema de arquivos previamente montado, sem precisar desmontá-lo. Suponha, de novo, que o servidor possui somente um disco rígido de 930 GiB. A configuração é a mesma feita para a hospedagem de VPS, exceto que há somente um LV fino e o tamanho do LV é muito maior do que o tamanho da área fina.
</p>
<pre># lvcreate -n MeuLVFino -V 16T --thinpool MeuPoolFino MeuGrupoVol
</pre>
<p>Este espaço virtual extra pode ser preenchido com um armazenamento real mais tarde, ao estender a pool fina. 
</p>
<p>Presuma agora que, depois de um certo tempo, uma atualização de armazenamento é necessária, e o novo disco rígido, <code>/dev/sdc</code>, está conectado ao servidor. Para atualizar a capacidade da área fina, adicione o novo disco rígido ao VG:
</p>
<pre># vgextend MeuGrupoVol /dev/sdc
</pre>
<p>Agora, estenda a pool fina:
</p>
<pre># lvextend -l +95%FREE MeuGrupoVol/MeuPoolFino
</pre>
<p>Em razão do tamanho do LV fino ser de 16 TiB, você poderia adicionar outro disco rígido com espaço de 15.09 TiB antes de finalmente precisar desmontar e redimensionar o sistema de arquivos.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Você provavelmente irá querer usar <a href="../pt/Ext4.html#Blocos_reservados" title="Ext4 (Português)">blocos reservados</a> ou um <a href="../en/Disk_quota.html" title="Disk quota">disk quota</a> para prevenir aplicações de tentarem usar mais armazenamento físico do que há de fato.</div>
<h2>
<span id="Customiza.C3.A7.C3.A3o"></span><span class="mw-headline" id="Customização">Customização</span>
</h2>
<p>Algumas customizações estão disponíveis ao editar <code>/etc/lvm/lvm.conf</code>. Você talvez ache útil customizar a saída de <code>lvs</code> e <code>pvs</code>, que por padrão não incluem a sincronização em % (vantajoso para ver o progresso de conversão entre, por exemplo, um volume linear para um tipo raid) e o tipo de volume lógico.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/lvm/lvm.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">report {
 	lvs_cols = "lv_name,lv_attr,lv_active,vg_name,lv_size,lv_layout,lv_allocation_policy,copy_percent,chunk_size"
	pvs_cols = "pv_name,vg_name,pv_size,pv_free,pv_used,dev_size"
}
</pre>
<h2>
<span id="Solu.C3.A7.C3.A3o_de_problemas"></span><span class="mw-headline" id="Solução_de_problemas">Solução de problemas</span>
</h2>
<h3>
<span id="Comandos_de_LVM_n.C3.A3o_funcionam"></span><span class="mw-headline" id="Comandos_de_LVM_não_funcionam">Comandos de LVM não funcionam</span>
</h3>
<ul><li>Carregue o módulo adequado:</li></ul>
<pre># modprobe dm_mod
</pre>
<p>O módulo <code>dm_mod</code> deveria ser automaticamente carregado. No caso de não acontecer, <a href="../pt/Kernel_module.html#Carregamento_autom%C3%A1tico_de_m%C3%B3dulos_com_systemd" title="Kernel module (Português)">carregue o módulo durante o boot</a>.
</p>
<ul><li>Tente antecipar comandos com <i>lvm</i> desta forma:</li></ul>
<pre># lvm pvdisplay
</pre>
<h3>
<span id="Volumes_l.C3.B3gicos_n.C3.A3o_aparecem"></span><span class="mw-headline" id="Volumes_lógicos_não_aparecem">Volumes lógicos não aparecem</span>
</h3>
<p>Se você está tentando montar volumes lógicos existentes, porém não aparecem em <code>lvscan</code>, você pode usar os comandos a seguir para ativá-los:
</p>
<pre># vgscan
# aay
</pre>
<h3>
<span id="LVM_em_m.C3.ADdia_remov.C3.ADvel"></span><span class="mw-headline" id="LVM_em_mídia_removível">LVM em mídia removível</span>
</h3>
<p>Sintomas:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># vgscan</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">  Reading all physical volumes.  This may take a while...
  /dev/backupdrive1/backup: read failed after 0 of 4096 at 319836585984: Input/output error
  /dev/backupdrive1/backup: read failed after 0 of 4096 at 319836643328: Input/output error
  /dev/backupdrive1/backup: read failed after 0 of 4096 at 0: Input/output error
  /dev/backupdrive1/backup: read failed after 0 of 4096 at 4096: Input/output error
  Found volume group "backupdrive1" using metadata type lvm2
  Found volume group "networkdrive" using metadata type lvm2
</pre>
<p>Ou de forma traduzida:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># vgscan</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">  Lendo todos os volumes físicos.  Isto pode levar um tempo...
  /dev/backupdrive1/backup: leitura falhou logo após 0 de 4096 em 319836585984: erro de Entrada/Saída
  /dev/backupdrive1/backup: leitura falhou logo após 0 de 4096 em 319836643328: erro de Entrada/Saída
  /dev/backupdrive1/backup: leitura falhou logo após 0 de 4096 em 0: erro de Entrada/Saída
  /dev/backupdrive1/backup: leitura falhou logo após 0 de 4096 em 4096: erro de Entrada/Saída
  Encontrado grupo de volume "backupdrive1" usando metadata tipo lvm2
  Encontrado grupo de volume "networkdrive" usando metadata tipo lvm2
</pre>
<p>Causa: remover um drive LVM externo sem desativar o(s) grupo(s) de volume antes. Antes de desconectar, se assegure de fazer:
</p>
<pre># vgchange -an <i>nome_grupo_volume</i>
</pre>
<p>Correção: supondo que você já tentou ativar o grupo de volume com <code>vgchange -ay <i>vg</i></code>, e está recebendo erros de Entrada/Saída:
</p>
<pre># vgchange -an <i>nome_grupo_volume</i>
</pre>
<p>Desconecte o dispositivo externo e espere alguns minutos:
</p>
<pre># vgscan
# vgchange -ay <i>nome_grupo_volume</i>
</pre>
<h4>
<span id="Suspens.C3.A3o.2Fretorno_com_LVM_e_m.C3.ADdia_remov.C3.ADvel"></span><span class="mw-headline" id="Suspensão/retorno_com_LVM_e_mídia_removível">Suspensão/retorno com LVM e mídia removível</span>
</h4>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Inaccurate.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>The factual accuracy of this article or section is disputed.</b></p>
<div>
<b>Reason:</b> A solução em questão não funciona em setups mais complexos, como LVM dentro de LUKS. (Discuss in <a href="../en/Talk:LVM.html" title="Talk:LVM">talk:LVM</a>)</div>
</div>
<p>Para que o LVM funcione adequadamente com mídias removíveis - como em uma unidade USB externa - o grupo de volume da unidade externa precisa ser desativado antes de suspender. Se isso não for feito, você pode acabar com erros de Entrada/Saída no buffer do dispositivo mapeado (após o retorno). Por esta razão, não é recomendado misturar drives externos com internos no mesmo grupo de volume.
</p>
<p>Para automaticamente desativar os grupos de volume com unidades USB externas, marque cada um dos grupos de volume com a tag <code>sleep_umount</code>, sendo desta forma:
</p>
<pre># vgchange --addtag sleep_umount <i>vg_externo</i>
</pre>
<p>Uma vez que a marcação é definida, use o seguinte arquivo unit do systemd para desativar apropriadamente os volumes antes da suspensão. Ao retornar o sistema, os drives serão automaticamente ativados pelo LVM.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/ext_usb_vg_desativar.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Desativar grupos de volume de USB externo ao suspender
Before=sleep.target

[Service]
Type=oneshot
ExecStart=-/etc/systemd/system/desativar_sleep_vgs.sh

[Install]
WantedBy=sleep.target</pre>
<p>Este é o script:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/deactivate_sleep_vgs.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh

TAG=@sleep_umount
vgs=$(vgs --noheadings -o vg_name $TAG)

echo "Desativando grupos de volume com a tag $TAG: $vgs"

# Desmonte volumes lógicos que pertencem ao grupos de volumes com a tag $TAG
for vg in $vgs; do
    for lv_dev_path in $(lvs --noheadings  -o lv_path -S lv_active=active,vg_name=$vg); do
        echo "Desmontando volume lógico $lv_dev_path"
        umount $lv_dev_path
    done
done

# Desative grupos de volumes marcados com sleep_umount
for vg in $vgs; do
    echo "Desativando grupo de volume $vg"
    vgchange -an $vg
done</pre>
<p>Por fim, <a href="../pt/Help:Reading.html#Controle_de_unidades_do_systemd" title="Help:Reading (Português)">ative</a> a unit.
</p>
<h3>
<span id="Redimensionando_um_volume_l.C3.B3gico_cont.C3.ADguo_que_falha"></span><span class="mw-headline" id="Redimensionando_um_volume_lógico_contíguo_que_falha">Redimensionando um volume lógico contíguo que falha</span>
</h3>
<p>Se estiver tentando estender um volume lógico e houver erros com:
</p>
<pre>" Insufficient suitable contiguous allocatable extents for logical volume "
</pre>
<p>Ou de forma traduzida:
</p>
<pre>" Extensões alocáveis contíguas e adequadas insuficientes para o volume lógico "
</pre>
<p>A razão é que o volume lógico foi criado com uma restrição explícita (ou, do inglês <i>policy</i>) de alocação contígua (definido por opções como <code>-C y</code> ou <code>--alloc contiguous</code>), e nenhuma extensão contígua adjacente está disponível. <a rel="nofollow" class="external autonumber" href="https://hostatic.ro/lvm-inherit-and-contiguous-policies/">[5]</a>
</p>
<p>Para corrigir, principalmente para estender o volume lógico, modifique a restrição de alocação com <code>lvchange --alloc inherit <i>volume_lógico</i></code>. Se você precisar manter a restrição de alocação contígua, uma alternativa seria mover o volume para uma área do disco com extensões livres suficientes. Veja <a rel="nofollow" class="external autonumber" href="https://superuser.com/questions/435075/how-to-align-logical-volumes-on-contiguous-physical-extents">[6]</a>.
</p>
<h3>
<span id="Comando_.22grub-mkconfig.22_reporta_erros_de_.22unknown_filesystem.22"></span><span class="mw-headline" id='Comando_"grub-mkconfig"_reporta_erros_de_"unknown_filesystem"'>Comando "grub-mkconfig" reporta erros de "unknown filesystem"</span>
</h3>
<p>Lembre-se de remover volumes snapshot antes de <a href="../pt/GRUB.html#Gerar_o_arquivo_de_configura%C3%A7%C3%A3o_principal" title="GRUB (Português)">gerar o grub.cfg</a>, pois GRUB não conseguirá reconhecer estes volumes como um sistema de arquivos.
</p>
<h3>
<span id="Tempo_de_volume_root_com_dispositivo_de_provis.C3.A3o_fina_expira_.28time_out.29"></span><span class="mw-headline" id="Tempo_de_volume_root_com_dispositivo_de_provisão_fina_expira_(time_out)">Tempo de volume root com dispositivo de provisão fina expira (time out)</span>
</h3>
<p>Com um grande número de snapshots, <code>thin_check</code> executará por um tempo longo o suficiente para que o tempo de espera pelo dispositivo root expire. Para compensar isso, adicione o parâmetro de inicialização do kernel <code>rootdelay=60</code> nas configurações do seu <i>bootloader</i>. Ou faça com que <code>thin_check</code> pule a verificação de mapeamento de blocos (veja <a rel="nofollow" class="external autonumber" href="https://www.redhat.com/archives/linux-lvm/2016-January/msg00010.html">[7]</a>) e <a href="../pt/Mkinitcpio.html#Cria%C3%A7%C3%A3o_e_ativa%C3%A7%C3%A3o_de_imagem" class="mw-redirect" title="Gere novamente o initramfs">gere novamente o initramfs</a>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/lvm/lvm.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">thin_check_options = [ "-q", "--clear-needs-check-flag", "--skip-mappings" ]</pre>
<h3>
<span id="Lentid.C3.A3o_ao_desligar"></span><span class="mw-headline" id="Lentidão_ao_desligar">Lentidão ao desligar</span>
</h3>
<p>Se você usa RAID, snapshots ou provisionamento fino e estiver experienciando uma lentidão ao desligar, garanta que <code>lvm2-monitor.service</code> esteja <a href="../pt/Help:Reading.html#Controle_de_unidades_do_systemd" title="Help:Reading (Português)">iniciado</a>. Veja <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/50420">FS#50420</a>.
</p>
<h3>
<span id="Hiberna.C3.A7.C3.A3o_em_um_volume_swap_de_provisionamento_fino"></span><span class="mw-headline" id="Hibernação_em_um_volume_swap_de_provisionamento_fino">Hibernação em um volume swap de provisionamento fino</span>
</h3>
<p>Veja em <a href="../pt/Power_management/Suspend_and_hibernate.html#Hiberna%C3%A7%C3%A3o_em_volume_LVM_de_provisionamento_fino" class="mw-redirect" title="Hibernação">Gestão de energia#hibernação em volume LVM de provisionamento fino</a>.
</p>
<h2>
<span id="Veja_tamb.C3.A9m"></span><span class="mw-headline" id="Veja_também">Veja também</span>
</h2>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://sourceware.org/lvm2/">LVM2 Resource Page</a> em SourceWare.org</li>
<li><a href="https://wiki.gentoo.org/wiki/LVM" class="extiw" title="gentoo:LVM">Gentoo:LVM</a></li>
<li><a rel="nofollow" class="external text" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/configuring_and_managing_logical_volumes/index">Red Hat Enterprise 9: Configuração e gerenciamento de volumes lógicos</a></li>
<li>
<a rel="nofollow" class="external text" href="https://www.tutonics.com/2012/11/ubuntu-lvm-guide-part-1.html">Guia do Ubuntu sobre LVM Parte 1</a><a rel="nofollow" class="external text" href="https://www.tutonics.com/2012/12/lvm-guide-part-2-snapshots.html">detalhes sobre snapshots Parte 2</a>
</li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../pt/Category:Storage_virtualization.html" title="Category:Storage virtualization (Português)">Storage virtualization (Português)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=LVM_(Portugu%C3%AAs)&amp;oldid=802990">https://wiki.archlinux.org/index.php?title=LVM_(Português)&amp;oldid=802990</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 11 March 2024, at 22:07.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
