<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-zebra-design-disabled vector-feature-custom-font-size-clientpref-disabled vector-feature-client-preferences-disabled vector-feature-typography-survey-disabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Ansible (Português) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.41.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Ansible_Português rootpage-Ansible_Português skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-main-menu-container">
		</div>
	<input type="checkbox" id="vector-toc-collapsed-checkbox" class="vector-menu-checkbox">
			<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark vector-sticky-pinned-container">
				<div id="vector-toc-pinned-container" class="vector-pinned-container">
				<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Instalação" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Instala%C3%A7%C3%A3o">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Instalação</div>
		</a>
		
		<ul id="toc-Instalação-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Uso_básico" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Uso_b%C3%A1sico">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Uso básico</div>
		</a>
		
			<button aria-controls="toc-Uso_básico-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Uso básico subsection</span>
			</button>
		
		<ul id="toc-Uso_básico-sublist" class="vector-toc-list">
			<li id="toc-Configuração" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configura%C3%A7%C3%A3o">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Configuração</div>
			</a>
			
			<ul id="toc-Configuração-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Inventário" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Invent%C3%A1rio">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>Inventário</div>
			</a>
			
			<ul id="toc-Inventário-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Ping" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Ping">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3</span>Ping</div>
			</a>
			
			<ul id="toc-Ping-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Playbook" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Playbook">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4</span>Playbook</div>
			</a>
			
			<ul id="toc-Playbook-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Vault" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Vault">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.5</span>Vault</div>
			</a>
			
			<ul id="toc-Vault-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Gerenciamento_de_pacotes" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Gerenciamento_de_pacotes">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.6</span>Gerenciamento de pacotes</div>
			</a>
			
			<ul id="toc-Gerenciamento_de_pacotes-sublist" class="vector-toc-list">
				<li id="toc-Repositórios_oficiais" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Reposit%C3%B3rios_oficiais">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.6.1</span>Repositórios oficiais</div>
			</a>
			
			<ul id="toc-Repositórios_oficiais-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-AUR" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#AUR">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.6.2</span>AUR</div>
			</a>
			
			<ul id="toc-AUR-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Dicas_e_truques" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Dicas_e_truques">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Dicas e truques</div>
		</a>
		
			<button aria-controls="toc-Dicas_e_truques-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Dicas e truques subsection</span>
			</button>
		
		<ul id="toc-Dicas_e_truques-sublist" class="vector-toc-list">
			<li id="toc-Criação_de_conta_de_usuário" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Cria%C3%A7%C3%A3o_de_conta_de_usu%C3%A1rio">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>Criação de conta de usuário</div>
			</a>
			
			<ul id="toc-Criação_de_conta_de_usuário-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Localização_do_binário_do_Python" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Localiza%C3%A7%C3%A3o_do_bin%C3%A1rio_do_Python">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>Localização do binário do Python</div>
			</a>
			
			<ul id="toc-Localização_do_binário_do_Python-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Solução_de_problemas" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Solu%C3%A7%C3%A3o_de_problemas">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Solução de problemas</div>
		</a>
		
			<button aria-controls="toc-Solução_de_problemas-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Solução de problemas subsection</span>
			</button>
		
		<ul id="toc-Solução_de_problemas-sublist" class="vector-toc-list">
			<li id="toc-Unarchive" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Unarchive">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>Unarchive</div>
			</a>
			
			<ul id="toc-Unarchive-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Veja_também" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Veja_tamb%C3%A9m">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Veja também</div>
		</a>
		
		<ul id="toc-Veja_também-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

				</div>
	</nav>
		
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<label id="vector-toc-collapsed-button" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet vector-button-flush-left cdx-button--icon-only" for="vector-toc-collapsed-checkbox" role="button" aria-controls="vector-toc" tabindex="0" title="Table of Contents">
						<span class="vector-icon mw-ui-icon-wikimedia-listBullet"></span>
						<span>Toggle the table of contents</span>
					</label>
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Ansible (Português)</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 2 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-2" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">2 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-en mw-list-item"><a href="../en/Ansible.html" title="Ansible – English" lang="en" hreflang="en" class="interlanguage-link-target"><span>English</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Ansible" title="Ansible – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<nav class="vector-page-tools-landmark vector-sticky-pinned-container" aria-label="Page tools">
						<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
			
						</div>
	</nav>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="pt" dir="ltr">
<div class="mw-parser-output">
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Status de tradução:</strong> Esse artigo é uma tradução de <a href="../en/Ansible.html" title="Ansible">Ansible</a>. Data da última tradução: 2020-04-11. Você pode ajudar a sincronizar a tradução, se houver <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Ansible&amp;diff=0&amp;oldid=605736">alterações</a> na versão em inglês.</div>
<p>Do <a rel="nofollow" class="external text" href="https://www.ansible.com/how-ansible-works">www.ansible.com</a>:
</p>
<dl><dd>Ansible é um mecanismo de automação de TI radicalmente simples que automatiza o provisionamento em nuvem, o gerenciamento de configurações, a implantação de aplicativos, a orquestração intrasserviço e muitas outras necessidades de TI.</dd></dl>
<meta property="mw:PageProp/toc">
<h2>
<span id="Instala.C3.A7.C3.A3o"></span><span class="mw-headline" id="Instalação">Instalação</span>
</h2>
<p>Na máquina de controle (mestre), <a href="../pt/Help:Reading.html#Instala%C3%A7%C3%A3o_de_pacotes" class="mw-redirect" title="Instale">instale</a> o pacote <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ansible">ansible</a></span>.
</p>
<p>Nas máquinas gerenciadas (nós), nas quais você deseja automatizar tarefas de implantação ou configuração, é necessário ter <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=python">python</a></span> e pode ser necessário indicar o <a href="#Localiza%C3%A7%C3%A3o_do_bin%C3%A1rio_do_Python">#Localização do binário do Python</a> específico em algumas circunstâncias. Uma maneira de se comunicar com o nó também é necessária, isso geralmente é <a href="../pt/Secure_Shell.html" class="mw-redirect" title="SSH (Português)">SSH</a>. Observe que uma configuração funcional <a href="../en/SSH_keys.html#Copying_the_public_key_to_the_remote_server" title="SSH keys">chave SSH key</a> facilita o uso do Ansible, mas não é necessária.
</p>
<h2>
<span id="Uso_b.C3.A1sico"></span><span class="mw-headline" id="Uso_básico">Uso básico</span>
</h2>
<h3>
<span id="Configura.C3.A7.C3.A3o"></span><span class="mw-headline" id="Configuração">Configuração</span>
</h3>
<p>Os parâmetros do Ansible são configurados no arquivo de configuração que pode ser <code>ansible.cfg</code> no diretório atual, <code>.ansible.cfg</code> no diretório inicial ou <code>/etc/ansible/ansible.cfg</code>, o que encontrar primeiro.
</p>
<p>Um modelo está disponível no <a rel="nofollow" class="external text" href="https://raw.githubusercontent.com/ansible/ansible/devel/examples/ansible.cfg">ansible.cfg exemplo no GitHub</a><sup title="Status da última verificação: 404">[<a href="https://en.wikipedia.org/wiki/pt:Wikip%C3%A9dia:Liga%C3%A7%C3%A3o_inativa" class="extiw" title="wikipedia:pt:Wikipédia:Ligação inativa">link inativo</a> 2023-07-30 ⓘ]</sup>.
</p>
<h3>
<span id="Invent.C3.A1rio"></span><span class="mw-headline" id="Inventário">Inventário</span>
</h3>
<p>A infraestrutura está listada no arquivo de inventário Ansible, cujo padrão é ser salvo no local <code>/etc/ansible/hosts</code> ou é possível especificar um arquivo de inventário diferente usando a opção de linha de comando <code>-i</code>. Por exemplo, o inventário a seguir define um cluster com 7 nós organizados em dois grupos:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ansible/hosts</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[control]
192.168.12.1
foo-[a:c].example.org
localhost ansible_connection=local

[managed]
192.168.12.2
192.168.12.3</pre>
<p>Pode-se atribuir atributos específicos para cada nó no arquivo de infraestrutura na linha correspondente ou no arquivo de configuração <code>ansible.cfg</code>. Por padrão, o Ansible executa playbooks no SSH, o parâmetro <code>ansible_connection</code> estende a conexão para:
</p>
<ul>
<li>
<code>local</code> para implantar o playbook na própria máquina de controle</li>
<li>
<code>docker</code> implanta o playbook diretamente nos contêineres do Docker</li>
</ul>
<p>Confira <a rel="nofollow" class="external text" href="https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html">Ansible - intro inventory</a> par detalhes.
</p>
<h3><span class="mw-headline" id="Ping">Ping</span></h3>
<p>Você pode verificar se todos os nós listados no inventário estão ativos com
</p>
<pre>$ ansible all -m ping
</pre>
<h3><span class="mw-headline" id="Playbook">Playbook</span></h3>
<p>Playbooks são a principal unidade organizacional para configurar e implantar toda a infraestrutura. Consulte <a rel="nofollow" class="external text" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks.html">a documentação oficial</a> para obter mais detalhes. Aqui está uma demonstração extremamente simples, na qual o administrador do inventário acima deseja executar uma atualização completa do sistema em um conjunto de hosts do Arch Linux. Primeiro, crie um arquivo de playbook, com formatação YAML (<i>sempre</i> com recuo de 2 espaços):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">syu.yml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">---
- name: All hosts up-to-date
  hosts: control managed
  become: yes
  
  tasks:
    - name: full system upgrade
      pacman:
        update_cache: yes
        upgrade: yes
</pre>
<p>Em seguida, execute o script do playbook:
</p>
<pre>$ ansible-playbook --ask-become-pass syu.yml
</pre>
<h3><span class="mw-headline" id="Vault">Vault</span></h3>
<p>Um <a rel="nofollow" class="external text" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html#vault">vault</a> ("cofre") pode ser usado para manter dados confidenciais de forma criptografada em playbooks ou funções, em vez de em texto sem formatação. A senha do cofre pode ser armazenada em texto sem formatação em um arquivo, por exemplo, <code><i>senhavault.txt</i></code> contendo <code><i>senhadovault</i></code>, para ser usada posteriormente como parâmetro de comando:
</p>
<pre>$ ansible-playbook <i>site.yml</i> --vault-id <i>senhavault.txt</i>
</pre>
<p>Para criptografar o conteúdo <code><i>o conteúdo da variável</i></code> de uma variável chamada <code><i>nomevar</i></code> usando a senha armazenada em <code><i>senha_vault.txt</i></code>, o seguinte comando deve ser usado:
</p>
<pre>$ ansible-vault encrypt_string --vault-id <i>senhavault.txt</i> '<i>o conteúdo da variável</i>' --name <i>nomevar</i>
</pre>
<p>Com mais segurança, para evitar a inserção do conteúdo da variável na linha de comando e ser solicitado, em vez disso, é possível usar:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ ansible-vault encrypt_string --vault-id <i>senhavault.txt</i> --stdin-name <i>nomevar</i></pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Reading plaintext input from stdin. (ctrl-d to end input)</pre>
<p>O comando retorna diretamente a variável protegida que pode ser inserida em um manual. Variáveis criptografadas e não criptografadas podem coexistir em um arquivo YAML, conforme ilustrado abaixo:
</p>
<pre><i>nãosecreto</i>: <i>meuvalor</i>

<i>meusegredo</i>: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          66386439653236336462626566653063336164663966303231363934653561363964363833313662
          6431626536303530376336343832656537303632313433360a626438346336353331386135323734
          62656361653630373231613662633962316233633936396165386439616533353965373339616234
          3430613539666330390a313736323265656432366236633330313963326365653937323833366536
          3462

<i>outronãosecreto</i>: <i>outrovalor</i></pre>
<h3><span class="mw-headline" id="Gerenciamento_de_pacotes">Gerenciamento de pacotes</span></h3>
<h4>
<span id="Reposit.C3.B3rios_oficiais"></span><span class="mw-headline" id="Repositórios_oficiais">Repositórios oficiais</span>
</h4>
<p>Ansible possui um <a rel="nofollow" class="external text" href="https://docs.ansible.com/ansible/latest/collections/community/general/pacman_module.html">módulo do pacman</a> para lidar com a instalação, remoção e atualização do sistema com o <a href="../pt/Pacman.html" title="Pacman (Português)">pacman</a>.
</p>
<h4><span class="mw-headline" id="AUR">AUR</span></h4>
<p>Para o <a href="../pt/Arch_User_Repository.html" title="Arch User Repository (Português)">Arch User Repository</a> <i>(AUR)</i>, é necessário usar o módulo externo <a rel="nofollow" class="external text" href="https://github.com/kewlfft/ansible-aur">ansible-aur</a>, o qual pode ser instalado com <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ansible-aur-git/">ansible-aur-git</a></span><sup><small>AUR</small></sup>.
</p>
<p>Enquanto o Ansible espera um acesso ssh como root, os auxiliares do AUR não permitem a execução de operações como root, mas todos falham com "você não pode executar esta operação como root". Para automação Ansible, é recomendável criar um usuário, por exemplo chamado <i>aur_builder</i>, que não precise de senha com pacman em <a href="../pt/Sudo.html#Configura%C3%A7%C3%A3o" class="mw-redirect" title="Sudoers (Português)">sudoers</a>. Isso pode ser feito no Ansible com as seguintes ações:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">task.yml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">- user: name=<i>aur_builder</i>

- lineinfile:
     path: /etc/sudoers.d/<i>aur_builder-allow-to-sudo-pacman</i>
     state: present
     line: "<i>aur_builder</i> ALL=(ALL) NOPASSWD: /usr/bin/pacman"
     validate: /usr/sbin/visudo -cf %s
     create: yes</pre>
<p>Em seguida, os auxiliares do AUR ou <a href="../pt/Makepkg.html" title="Makepkg (Português)">makepkg</a> podem ser usados associados aos parâmetros <code>become: yes</code> e <code>become_user: aur_builder</code> do Ansible.
</p>
<h2><span class="mw-headline" id="Dicas_e_truques">Dicas e truques</span></h2>
<h3>
<span id="Cria.C3.A7.C3.A3o_de_conta_de_usu.C3.A1rio"></span><span class="mw-headline" id="Criação_de_conta_de_usuário">Criação de conta de usuário</span>
</h3>
<p>O Ansible pode gerenciar contas de usuário e, em particular, é capaz de criar novas. Isso é obtido em playbooks com o <a rel="nofollow" class="external text" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/user_module.html">módulo de usuário</a>, que utiliza um argumento opcional <code>password</code> para definir a senha do usuário. É o valor <b>hash da senha</b> que precisa ser fornecido ao módulo.
</p>
<p>O hash pode simplesmente ser executado instantaneamente no Ansible usando um de seus filtros internos <a rel="nofollow" class="external text" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#hash-filters">hash-filter</a>:
</p>
<pre>- user:
  name: <i>nome_do_usuário</i>
  password: "{{ '<i>senha_do_usuário</i>' | password_hash('sha512', '<i>saltdasenha</i>') }}"
  shell: /usr/bin/nologin
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Dica:</strong> O salt deve ser corrigido e fornecido explicitamente como um segundo parâmetro da função hash para que a operação seja idempotente (pode ser repetida sem alterar o estado do sistema).</div>
<p>Com essa abordagem, é recomendável criptografar <i>senha_do_usuário</i> com vault para que não apareça em texto sem formatação, consulte <a href="#Vault">#Vault</a>. No entanto, uma variável criptografada não pode ser canalizada diretamente e precisará primeiro ser atribuída a outra que será passada com pipe.
</p>
<p>Como alternativa, o hash pode ser realizado fora do Ansible. Os comandos a seguir retornam respectivamente os valores <a href="https://en.wikipedia.org/wiki/pt:MD5" class="extiw" title="wikipedia:pt:MD5">MD5</a> e <a href="https://en.wikipedia.org/wiki/pt:SHA-2" class="extiw" title="wikipedia:pt:SHA-2">SHA512</a> com hash de <i>senha_do_usuário</i>:
</p>
<pre>$ openssl passwd -1 <i>senha_do_usuário</i>
</pre>
<pre>$ python -c 'import crypt; print(crypt.crypt("<i>senha_do_usuário</i>", crypt.mksalt(crypt.METHOD_SHA512)))'
</pre>
<h3>
<span id="Localiza.C3.A7.C3.A3o_do_bin.C3.A1rio_do_Python"></span><span class="mw-headline" id="Localização_do_binário_do_Python">Localização do binário do Python</span>
</h3>
<p>O Ansible requer <a href="../pt/Python.html" title="Python (Português)">Python</a> na máquina de destino. Por padrão, o Ansible supõe que ele pode encontrar um <code>/usr/bin/python</code> no sistema remoto que é uma versão 2.X ou 3.X, especificamente 2.6 ou superior.
</p>
<p>Se alguns de seus módulos exigirem especificamente o Python2, você precisará informar o Ansible sobre sua localização, configurando a variável <code>ansible_python_interpreter</code> no arquivo de inventário. Isso pode ser feito usando grupos de hosts no inventário:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ansible/hosts</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[archlinux]
servidor1
servidor2

[debian]
servidor3

[archlinux:vars]
ansible_python_interpreter=/usr/bin/python2</pre>
<p>Mais informações sobre o suporte à versão Python no Ansible estão disponíveis em <a rel="nofollow" class="external autonumber" href="https://docs.ansible.com/ansible/latest/reference_appendices/python_3_support.html">[1]</a>, <a rel="nofollow" class="external autonumber" href="https://docs.ansible.com/ansible/latest/reference_appendices/faq.html#how-do-i-handle-not-having-a-python-interpreter-at-usr-bin-python-on-a-remote-machine">[2]</a> e <a rel="nofollow" class="external autonumber" href="https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html#connecting-to-hosts-behavioral-inventory-parameters">[3]</a>.
</p>
<h2>
<span id="Solu.C3.A7.C3.A3o_de_problemas"></span><span class="mw-headline" id="Solução_de_problemas">Solução de problemas</span>
</h2>
<h3><span class="mw-headline" id="Unarchive">Unarchive</span></h3>
<p>O módulo <code>unarchive</code> descompacta um arquivo. No entanto, os arquivos <i>tar</i> não são bem suportados e vários problemas pendentes são relatados em <a rel="nofollow" class="external text" href="https://github.com/ansible/ansible/labels/m%3Aunarchive">GitHub - unarchive</a>. Em particular, quando o parâmetro <code>keep_newer</code> é definido como <code>yes</code>, a idempotência não é observada. Caso encontre um problema com o módulo, você pode usar o formato <i>zip</i>, que é melhor integrado ao Ansible.
</p>
<h2>
<span id="Veja_tamb.C3.A9m"></span><span class="mw-headline" id="Veja_também">Veja também</span>
</h2>
<ul>
<li>
<a rel="nofollow" class="external free" href="https://www.ansible.com/quick-start-video">https://www.ansible.com/quick-start-video</a> - Conceito do Ansible em 12 minutos</li>
<li>
<a rel="nofollow" class="external free" href="https://docs.ansible.com/ansible/latest/collections/community/general/pacman_module.html">https://docs.ansible.com/ansible/latest/collections/community/general/pacman_module.html</a> - Documentação oficial do módulo do pacman</li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../pt/Category:System_administration.html" title="Category:System administration (Português)">System administration (Português)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Ansible_(Portugu%C3%AAs)&amp;oldid=783952">https://wiki.archlinux.org/index.php?title=Ansible_(Português)&amp;oldid=783952</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 30 July 2023, at 08:02.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
