<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>syslog-ng - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.43.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Syslog-ng rootpage-Syslog-ng skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Overview" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Overview">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Overview</span>
			</div>
		</a>
		
		<ul id="toc-Overview-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Installation</span>
			</div>
		</a>
		
			<button aria-controls="toc-Installation-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Installation subsection</span>
			</button>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
			<li id="toc-systemd/journald_integration" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#systemd/journald_integration">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1</span>
					<span>systemd/journald integration</span>
				</div>
			</a>
			
			<ul id="toc-systemd/journald_integration-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Sources" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Sources">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Sources</span>
			</div>
		</a>
		
			<button aria-controls="toc-Sources-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Sources subsection</span>
			</button>
		
		<ul id="toc-Sources-sublist" class="vector-toc-list">
			<li id="toc-syslog-ng_and_systemd_journal" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#syslog-ng_and_systemd_journal">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1</span>
					<span>syslog-ng and systemd journal</span>
				</div>
			</a>
			
			<ul id="toc-syslog-ng_and_systemd_journal-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Destinations" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Destinations">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">4</span>
				<span>Destinations</span>
			</div>
		</a>
		
		<ul id="toc-Destinations-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Creating_filters_for_messages" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Creating_filters_for_messages">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">5</span>
				<span>Creating filters for messages</span>
			</div>
		</a>
		
		<ul id="toc-Creating_filters_for_messages-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Log_paths" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Log_paths">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">6</span>
				<span>Log paths</span>
			</div>
		</a>
		
		<ul id="toc-Log_paths-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Tips_and_tricks" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Tips_and_tricks">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">7</span>
				<span>Tips and tricks</span>
			</div>
		</a>
		
			<button aria-controls="toc-Tips_and_tricks-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Tips and tricks subsection</span>
			</button>
		
		<ul id="toc-Tips_and_tricks-sublist" class="vector-toc-list">
			<li id="toc-Have_syslog-ng_reload_the_configuration_file" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Have_syslog-ng_reload_the_configuration_file">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">7.1</span>
					<span>Have syslog-ng reload the configuration file</span>
				</div>
			</a>
			
			<ul id="toc-Have_syslog-ng_reload_the_configuration_file-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Failover_Logging_to_Remote_Host" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Failover_Logging_to_Remote_Host">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">7.2</span>
					<span>Failover Logging to Remote Host</span>
				</div>
			</a>
			
			<ul id="toc-Failover_Logging_to_Remote_Host-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Move_log_to_another_file" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Move_log_to_another_file">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">7.3</span>
					<span>Move log to another file</span>
				</div>
			</a>
			
			<ul id="toc-Move_log_to_another_file-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Configuring_as_a_loghost" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configuring_as_a_loghost">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">7.4</span>
					<span>Configuring as a loghost</span>
				</div>
			</a>
			
			<ul id="toc-Configuring_as_a_loghost-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Improve_performance" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Improve_performance">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">7.5</span>
					<span>Improve performance</span>
				</div>
			</a>
			
			<ul id="toc-Improve_performance-sublist" class="vector-toc-list">
				<li id="toc-Write_every_so_often" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Write_every_so_often">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">7.5.1</span>
					<span>Write every so often</span>
				</div>
			</a>
			
			<ul id="toc-Write_every_so_often-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Increase_source_batching_limits" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Increase_source_batching_limits">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">7.5.2</span>
					<span>Increase source batching limits</span>
				</div>
			</a>
			
			<ul id="toc-Increase_source_batching_limits-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Avoid_redundant_processing_and_disk_space" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Avoid_redundant_processing_and_disk_space">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">7.5.3</span>
					<span>Avoid redundant processing and disk space</span>
				</div>
			</a>
			
			<ul id="toc-Avoid_redundant_processing_and_disk_space-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-PostgreSQL_Destination" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#PostgreSQL_Destination">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">7.6</span>
					<span>PostgreSQL Destination</span>
				</div>
			</a>
			
			<ul id="toc-PostgreSQL_Destination-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-ISO_8601_timestamps" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#ISO_8601_timestamps">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">7.7</span>
					<span>ISO 8601 timestamps</span>
				</div>
			</a>
			
			<ul id="toc-ISO_8601_timestamps-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-RFC_3339_timestamps" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#RFC_3339_timestamps">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">7.8</span>
					<span>RFC 3339 timestamps</span>
				</div>
			</a>
			
			<ul id="toc-RFC_3339_timestamps-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Log_Levels" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Log_Levels">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">7.9</span>
					<span>Log Levels</span>
				</div>
			</a>
			
			<ul id="toc-Log_Levels-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Macros_and_Variables" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Macros_and_Variables">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">7.10</span>
					<span>Macros and Variables</span>
				</div>
			</a>
			
			<ul id="toc-Macros_and_Variables-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Receive_and_parse_common_syslog_messages" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Receive_and_parse_common_syslog_messages">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">7.11</span>
					<span>Receive and parse common syslog messages</span>
				</div>
			</a>
			
			<ul id="toc-Receive_and_parse_common_syslog_messages-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-See_Also" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#See_Also">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">7.12</span>
					<span>See Also</span>
				</div>
			</a>
			
			<ul id="toc-See_Also-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-External_Links" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#External_Links">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">8</span>
				<span>External Links</span>
			</div>
		</a>
		
		<ul id="toc-External_Links-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading">syslog-ng</h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 1 language">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-1" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">1 language</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Syslog-ng" title="Syslog-ng – 日本語" lang="ja" hreflang="ja" data-title="Syslog-ng" data-language-autonym="日本語" data-language-local-name="日本語" class="interlanguage-link-target"><span>日本語</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<p><span>
</span>
</p>
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/Rsyslog.html" title="Rsyslog">rsyslog</a></li>
</ul>
</div>
<p><a href="https://en.wikipedia.org/wiki/syslog-ng" class="extiw" title="wikipedia:syslog-ng">syslog-ng</a> is a <a href="https://en.wikipedia.org/wiki/syslog" class="extiw" title="wikipedia:syslog">syslog</a> implementation which can take log messages from sources and forward them to destinations, based on powerful filter directives. Although its origins are syslog, it is a pretty generic log management tool, being able to consume structured and unstructured log messages, parsing and transforming them if necessary.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> With <a href="../en/Systemd/Journal.html" title="Systemd/Journal">systemd's journal</a>, syslog-ng is not needed if all you need is local logs.</div>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Overview">Overview</span></h2>
<p>syslog-ng takes incoming log messages from defined '<a href="#Sources">sources</a>' and forwards them to the appropriate <a href="#Destinations">destinations</a>, based on powerful <a href="#Creating_filters_for_messages">filter</a> directives. In a typical simple set-up, syslog-ng will read messages from three sources:
</p>
<ol>
<li>the default <code>/dev/log</code> device, where most logs are sent</li>
<li>syslog-ng "internal" log messages</li>
<li>
<code>/proc/kmsg</code> kernel messages</li>
</ol>
<p>Sources are defined using the "source" directive. These incoming messages are then filtered according to defined filters ("filter" keyword), i.e. according to originating program or log level, and sent to the appropriate "destination". 
</p>
<p>Destinations include log files (e.g. <code>/var/log/messages.log</code>), printing messages on a console and remote servers. 
</p>
<p>The pivotal function is <a href="#Log_paths">log</a>. This function defines which filters should be applied to a certain source, and where the resulting messages should be sent to.
</p>
<p>Apart from local sources, as explained above, syslog-ng is also able to work with various sources over the network.  To work with these, you will have to create a <code>network()</code> or <code>udp()</code> or <code>tcp()</code> source as explained below.
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=syslog-ng">syslog-ng</a></span> package.
</p>
<p>To use syslog-ng, <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start">start</a>/<a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">enable</a> <code>syslog-ng@default.service</code>.
</p>
<h3>
<span id="systemd.2Fjournald_integration"></span><span class="mw-headline" id="systemd/journald_integration">systemd/journald integration</span>
</h3>
<p>syslog-ng pulls in the messages from the systemd journal by default. Keeping <code>ForwardToSyslog=no</code> in <code>/etc/systemd/journald.conf</code> is recommended in order to avoid the overhead associated with the socket and to avoid <a rel="nofollow" class="external text" href="https://github.com/syslog-ng/syslog-ng/issues/314">needless error messages in the log</a>. If on the other hand you do not want to store your logs twice and turn <i>journald'</i>s <code>Storage=none</code>, you <b>will</b> need <code>ForwardToSyslog=yes</code>, as <i>syslog-ng</i> tries to follow the 'journald' journal file.
</p>
<p>See <a href="#syslog-ng_and_systemd_journal">#syslog-ng and systemd journal</a> for more details.
</p>
<h2><span class="mw-headline" id="Sources">Sources</span></h2>
<p>syslog-ng receives log messages from a source. To define a source you should follow the following syntax:
</p>
<pre>source &lt;identifier&gt; { source-driver(params); source-driver(params); ... };
</pre>
<p>In the simplest case, you will just need a single <code>system()</code> driver.
</p>
<pre>source src { system(); };
</pre>
<p>This will automatically detect the best way to collect local logs and will make sure kernel, application and internal logs from syslog-ng are all collected.
</p>
<p>You can look at the identifiers and source-drivers in the <a rel="nofollow" class="external text" href="https://axoflow.com/docs/axosyslog-core/chapter-sources/">alternative syslog-ng manuals</a> (as the ones on syslog-ng.com were unreachable).
</p>
<p>The <code>system()</code> driver is actually a higher-level construct that expands to various sources as needed for the local system. But you can acquire more control by removing the <code>system()</code> source and use the lower level drivers directly.
</p>
<p>The <code>unix-stream()</code> source-driver opens the given AF_UNIX <a href="https://en.wikipedia.org/wiki/Berkeley_sockets" class="extiw" title="wikipedia:Berkeley sockets">socket</a> and starts listening on it for messages. 
</p>
<p>The <code>internal()</code> source-driver "receives" messages generated internally, by syslog-ng itself.
</p>
<p>Therefore, the following means: <code>src</code> gets messages from the <code>/dev/log</code> socket and syslog-ng.
</p>
<pre>source src { unix-stream("/dev/log"); internal(); };
</pre>
<p>The kernel sends log messages to <code>/proc/kmsg</code> and the <code>file()</code> driver reads log messages from files. Therefore, the following means kernsrc gets messages from file <code>/proc/kmsg</code>: 
</p>
<pre>source kernsrc { file("/proc/kmsg"); };
</pre>
<p>To open a port to read data from a remote server a source must be defined with this syntax:
</p>
<pre>source s_net { network(transport(tcp)); };
</pre>
<p>for UDP or
</p>
<pre>source s_net { network(transport(udp)); };
</pre>
<p>to receive log messages via TCP. Both listen on port 514, unless overridden with the <code>port()</code> parameter.
</p>
<h3><span class="mw-headline" id="syslog-ng_and_systemd_journal">syslog-ng and systemd journal</span></h3>
<p>Starting with syslog-ng version 3.6.1 the default <code>system()</code> source on Linux systems using systemd uses journald as its standard <code>system()</code> source.
</p>
<p>If you wish to use both the journald and syslog-ng, ensure the following settings are in effect. For systemd-journald, in the <code>/etc/systemd/journald.conf</code> file, <code>Storage=</code> either set to <code>auto</code> or unset (which defaults to auto) and <code>ForwardToSyslog=</code> set to <code>yes</code>. For <code>/etc/syslog-ng/syslog-ng.conf</code>, you need the following <code>source</code> stanza:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/syslog-ng/syslog-ng.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">source src {
  system();
};
</pre>
<p>If, on the other hand, you wish <i>not</i> to retain the journald logs, but only syslog-ng's text logs, set <code>Storage=volatile</code> in <code>/etc/systemd/journald.conf</code>. This will store journald in ram. As of syslog-ng 3.6.3, syslog-ng is using journald as the system(); source so if you set <code>Storage=none</code>, the systemd journal will drop all messages and <b>not</b> forward them to syslog-ng.
</p>
<p>After the change <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">restart</a> the <code>systemd-journald.service</code> and <code>syslog-ng@default.service</code> daemons.
</p>
<h2><span class="mw-headline" id="Destinations">Destinations</span></h2>
<p>In syslog-ng, log messages are sent to files. The syntax is very similar to sources:
</p>
<pre>destination &lt;identifier&gt; {destination-driver(params); destination-driver(params); ... };
</pre>
<p>You will be normally logging to a file, but you could log to a different destination-driver: pipe, Unix socket, TCP-UDP ports, terminals or to specific programs. Simply declaring a destination will not cause messages to be delivered to that destination: that will only happen as soon as you connect sources and destinations using log statements. Log statements can also include filters, thereby implementing a flexible log routing functionality.
</p>
<p>This declaration instructs syslog-ng to send messages to <code>/var/log/auth.log</code>:
</p>
<pre>destination authlog { file("/var/log/auth.log"); };
</pre>
<p>If the user is logged in, <code>usertty()</code> sends messages to the terminal of the specified user. If you want to send console messages to root's terminal if it is logged in:
</p>
<pre>destination console { usertty("root"); };
</pre>
<p>Messages can be sent to a pipe with <code>pipe()</code>. The following sends xconsole messages to the pipe <code>/dev/xconsole</code>.
This needs some more configuration, so you could look at the sub-section xconsole below.
</p>
<pre>destination xconsole { pipe("/dev/xconsole"); };
</pre>
<p>To send messages on the network, use <code>udp()</code>. The following will send your log data out to another server.
</p>
<pre>destination remote_server { udp("10.0.0.2" port(514)); };
</pre>
<p>You can also use the newer <code>network()</code> driver syntax for the same:
</p>
<pre>destination remote_server { network("10.0.0.2" port(514) transport(udp)); };
</pre>
<h2><span class="mw-headline" id="Creating_filters_for_messages">Creating filters for messages</span></h2>
<p>The syntax for the filter statement is:
</p>
<pre>filter &lt;identifier&gt; { expression; };
</pre>
<p>Functions can be used in the expression, such as the function <code>facility()</code> which selects messages based on the syslog facility codes (kern, mail, auth, etc). 
Apart from facility codes, each log message is associated with a severity value; where debug is the most verbose,
and panic only shows serious errors. You can find the facilities, log levels and priority names in <code>/usr/include/sys/syslog.h</code> or in <a href="https://tools.ietf.org/html/rfc3164" class="extiw" title="rfc:3164">RFC 3164</a>.
To filter those messages coming from authorization, like <code>su(pam_unix)[18569]: session opened for user root by (uid=1000)</code> use the following:
</p>
<pre>filter f_auth { facility(auth); };
</pre>
<p>The facility expression can use the boolean operators <code>and</code>, <code>or</code>, and <code>not</code>, so the following filter
selects those messages not coming from authorization, network news or mail:
</p>
<pre>filter f_debug { not facility(auth, authpriv, news, mail); };
</pre>
<p>The function <code>severity()</code> selects messages based on its severity level, so if you want to select informational levels:
</p>
<pre>filter f_info { severity(info); };
</pre>
<p>Functions and boolean operators can be combined in more complex expressions. The following line filters messages with a priority level from informational to warning not coming from auth, authpriv, mail and news facilities:
</p>
<pre>filter f_messages { severity(info..warn) and not facility(auth, authpriv, mail, news); };
</pre>
<p>Messages can also be selected by matching a regular expression in the message with the function <code>match("regex" value("&lt;macro&gt;"))</code>. For example this would match the main part of the message against the regexp "failed":
</p>
<pre>filter f_failed { match("failed" value("MESSAGE")); };
</pre>
<p>In filter expressions, you can use both pre-defined and user defined macros. These are also called <a rel="nofollow" class="external text" href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/customizing-message-format/macros-hard-vs-soft/">"hard" and "soft" macros respectively</a>.
</p>
<p>A list and documentation of all macros can be found in the <a rel="nofollow" class="external text" href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/customizing-message-format/reference-macros/">syslog-ng documentation</a>: 
</p>
<pre> "AMPM", "BSDTAG", "DATE, C_DATE, R_DATE, S_DATE", "DAY, C_DAY, R_DAY, S_DAY", "FACILITY", "FACILITY_NUM", "FULLDATE, C_FULLDATE, R_FULLDATE, S_FULLDATE", "FULLHOST", "FULLHOST_FROM", "HOUR, C_HOUR, R_HOUR, S_HOUR", "HOUR12, C_HOUR12, R_HOUR12, S_HOUR12", "HOST", "HOST_FROM", "ISODATE, C_ISODATE, R_ISODATE, S_ISODATE", "LEVEL_NUM", "LOGHOST", "MIN, C_MIN, R_MIN, S_MIN", "MONTH, C_MONTH, R_MONTH, S_MONTH", "MONTH_ABBREV, C_MONTH_ABBREV, R_MONTH_ABBREV, S_MONTH_ABBREV", "MONTH_NAME, C_MONTH_NAME, R_MONTH_NAME, S_MONTH_NAME", "MONTH_WEEK, C_MONTH_WEEK, R_MONTH_WEEK, S_MONTH_WEEK", "MSEC, C_MSEC, R_MSEC, S_MSEC", "MSG or MESSAGE", "MSGHDR", "MSGID", "MSGONLY", "PID", "PRI", "PRIORITY or LEVEL", "PROGRAM", "SDATA, .SDATA.SDID.SDNAME", "SEC, C_SEC, R_SEC, S_SEC", "SOURCEIP", "SEQNUM", "STAMP, R_STAMP, S_STAMP", "SYSUPTIME", "TAG", "TAGS", "TZ, C_TZ, R_TZ, S_TZ", "TZOFFSET, C_TZOFFSET, R_TZOFFSET, S_TZOFFSET", "UNIXTIME, C_UNIXTIME, R_UNIXTIME, S_UNIXTIME", "USEC, C_USEC, R_USEC, S_USEC", "YEAR, C_YEAR, R_YEAR, S_YEAR", "WEEK, C_WEEK, R_WEEK, S_WEEK", "WEEK_ABBREV, C_WEEK_ABBREV, R_WEEK_ABBREV, S_WEEK_ABBREV", "WEEK_DAY, C_WEEK_DAY, R_WEEK_DAY, S_WEEK_DAY", "WEEKDAY, C_WEEKDAY, R_WEEKDAY, S_WEEKDAY", "WEEK_DAY_NAME, C_WEEK_DAY_NAME, R_WEEK_DAY_NAME, S_WEEK_DAY_NAME".
</pre>
<p>To filter messages received from a particular remote host (as declared in the incoming message itself and not by its IP address), the <code>host()</code> function must be used:
</p>
<pre>filter f_host { host( "192.168.1.1" ); };
</pre>
<p>If you would rather filter on sending IP address, you can use the <code>netmask()</code> filter:
</p>
<pre>filter f_ipaddr { netmask( "192.168.1.1/32" ); };
</pre>
<h2><span class="mw-headline" id="Log_paths">Log paths</span></h2>
<p>syslog-ng connects sources, filters and destinations with log statements. The syntax is:
</p>
<pre>log {source(s1); source(s2); ...
filter(f1); filter(f2); ...
destination(d1); destination(d2); ...
flags(flag1[, flag2...]); };
</pre>
<p>The following for example sends messages from <code>src</code> source to <code>mailinfo</code> destination filtered by <code>f_info</code> filter: 
</p>
<pre>log { source(src); filter(f_mail); filter(f_info); destination(mailinfo); };
</pre>
<p>A log statement describes a pipeline: it tells syslog-ng to take messages from a source (or multiple sources) and deliver them to a destination (or multiple destinations) assuming the associated filters are matching.
</p>
<p>If you have multiple log statements that take messages from the same source, messages will be duplicated along with all of those pipelines. Of course, you can apply a different set of filters and therefore route messages selectively to multiple destinations.
</p>
<p>Apart from filtering, syslog-ng can apply parsing or rewriting of messages. Parsing means the extraction of information from the message text, whereas rewriting a message means that syslog-ng can change/reformat messages as needed.
</p>
<p>The <code>log</code> statement has a lot more to offer: 
</p>
<ol>
<li>You can stop processing subsequent log paths after the current one matches using flags(final).</li>
<li>You can tell a log statement to grab messages that none of the other log statements captured using flags(fallback)</li>
<li>You can create an arbitrary graph out of log pipelines by using embedded log statements and junctions, which help you to construct complex processing pipelines.</li>
</ol>
<p>You can read more about <code>log</code> statements in a chapter of the <a rel="nofollow" class="external text" href="https://axoflow.com/docs/axosyslog-core/chapter-routing-filters/logpath/">syslog-ng documentation</a>.
</p>
<h2><span class="mw-headline" id="Tips_and_tricks">Tips and tricks</span></h2>
<p>After understanding the logic behind syslog-ng, many possible and complex configuration are possible. Here there are some examples.
</p>
<h3><span class="mw-headline" id="Have_syslog-ng_reload_the_configuration_file">Have syslog-ng reload the configuration file</span></h3>
<p>You can make syslog-ng re-evaluate the configuration file. You can do so manually by sending a <code>SIGHUP</code> to the process, or <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Reload">reload</a> <code>syslog-ng@default.service</code>.
</p>
<h3><span class="mw-headline" id="Failover_Logging_to_Remote_Host">Failover Logging to Remote Host</span></h3>
<p>This setup shows how to send the default unencrypted syslog packets across both TCP and UDP protocols, using the standard port (514) and an alternate port. This is sending the same output to the same machine 4 different ways to try and make sure packets make it. Mostly useful if you are debugging a remote server that fails to reboot. The different ports and protocols are to make it past any firewall filters or other network problems. Also useful for port-forwarding and using tunnels. Something like this setup is ideal to tunnel across an ssh connection that the prone-to-failover host initiates through a reverse connection.
</p>
<pre>#sending to a remote syslog server on TCP and UDP ports (not encrypted)
destination askapache_failover_loghost {
    tcp("208.86.158.195" port(25214));
    udp("208.86.158.195" port(25214));
    udp("mysyslog1.dyndns.org" port(514));
};
log { 
    source(src); 
    destination(askapache_failover_loghost);
};
</pre>
<p>And then on the loghost receiving these logs:
</p>
<pre>#a USB redirected console for flexible viewing
destination debugging_console {
    file("/dev/ttyU1");
};

# listens on IP addresses and ports, sets the incoming settings
source prone_to_failover_host {
    tcp(ip(208.86.158.195),port(25214));
    udp(ip(208.86.158.195) port(25214));

    udp(default-facility(syslog) default-priority(emerg));
    tcp(default-facility(syslog) default-priority(emerg));
}

# log it
log {
    source(prone_to_failover_host); 
    destination(debugging_console);
};
</pre>
<h3><span class="mw-headline" id="Move_log_to_another_file">Move log to another file</span></h3>
<p>In order to move some log from <code>/var/log/messages</code> to another file.
</p>
<pre>#sshd configuration
destination ssh { file("/var/log/ssh.log"); };
filter f_ssh { program("sshd"); };
log { source(src); filter(f_ssh); destination(ssh); flags(final); };
</pre>
<p>Make sure you add this block above your usual log statements. Due to <code>flags(final)</code> in the log statement, anything that matches the "sshd" filter would only be sent to <code>ssh.log</code> and processing of the message would stop at that point.
</p>
<h3><span class="mw-headline" id="Configuring_as_a_loghost">Configuring as a loghost</span></h3>
<p>Configuring your system to be a loghost is quite simple. Drop the following into your configuration, and create the needed directory.
With this simple configuration, log filenames will be based on the <a href="https://en.wikipedia.org/wiki/FQDN" class="extiw" title="wikipedia:FQDN">FQDN</a> of the remote host,
and located in <code>/var/log/remote/</code>. After creating the remote directory, reload your syslog-ng configuration.
</p>
<pre>source net { udp(); };
destination remote { file("/var/log/remote/${FULLHOST}-log"); };
log { source(net); destination(remote); };
</pre>
<p>You could also consider the <code>default-network-drivers()</code> source that will open multiple ports, accepting messages over multiple different syslog protocols that are usually deployed in the field.
</p>
<h3><span class="mw-headline" id="Improve_performance">Improve performance</span></h3>
<p>syslog-ng's performance can be improved in different ways:
</p>
<h4><span class="mw-headline" id="Write_every_so_often">Write every so often</span></h4>
<p>It seems that the old <code>sync(X)</code> option is called <code>flush_lines(<i>X</i>)</code> now, where the writing to the file is buffered for <code><i>X</i></code> lines. Default is 100.
</p>
<h4><span class="mw-headline" id="Increase_source_batching_limits">Increase source batching limits</span></h4>
<p>syslog-ng is doing message processing in parallel, as streams of messages are received using the many different source mechanisms. To avoid starving one source connection over the other, syslog-ng both uses threading and imposes limits on how much messages would it process from a single source connection at a time. 
</p>
<p>This means that even though a source application might have sent 1000 messages in a tight loop, syslog-ng would process it 100 pieces at a time (the exact limit is specified by <code>log-fetch-limit()</code>) and after every 100, it would re-check if other connections are also in need of processing. This has some overhead, and syslog-ng performance can be increased significantly by increasing <code>log-fetch-limit()</code>
</p>
<p>The other mechanism that can use tuning based on a specific use-case is the window size setting used for backpressure propagation. This is the <code>log-iw-size()</code> parameter that controls how many messages can be in-flight before a destination acknowledges them. By increasing the <code>log-iw-size()</code> you can let it work on more messages before it would stop to allow destinations to consume messages.
</p>
<p>By increasing <code>log-iw-size()</code> your memory/disk buffer use will increase, as syslog-ng will have to put the messages somewhere.
</p>
<h4><span class="mw-headline" id="Avoid_redundant_processing_and_disk_space">Avoid redundant processing and disk space</span></h4>
<p>A single log message can be sent to different log files several times. For example, in the initial configuration file, we have the following definitions:
</p>
<pre>destination cron { file("/var/log/cron.log"); };
destination messages { file("/var/log/messages"); };
filter f_cron { facility(cron); };
filter f_messages { level(info..warn) 
       and not facility(auth, authpriv, mail, news); };
log { source(src); filter(f_cron); destination(cron); };
log { source(src); filter(f_messages); destination(messages); };
</pre>
<p>The same message from the <code>cron</code> facility will end up in both the <code>cron.log</code> and <code>messages</code> files. To change this behavior we can use the <code>final</code> flag, ending up further processing with the message. Therefore, in this example, if we want messages from the <code>cron</code> facility not ending up in the messages file, we should change the cron's log sentence by:
</p>
<pre>log { source(src); filter(f_cron); destination(cron); flags(final); };
</pre>
<p>another way is to exclude the <code>cron</code> facility from <code>f_messages</code> filter:
</p>
<pre>filter f_messages { level(info..warn) and not facility(cron, auth, authpriv, mail, news); };
</pre>
<h3><span class="mw-headline" id="PostgreSQL_Destination">PostgreSQL Destination</span></h3>
<p>This section will use two roles: <code>syslog</code> and <code>logwriter</code>. <code>syslog</code> will be the administrator of the database <code>syslog</code> and <code>logwriter</code> will only be able to add records to the <code>logs</code> table.
</p>
<p>No longer needed to create table for logs. syslog-ng will create automatically.
</p>
<pre>psql -U postgres
</pre>
<pre>postgres=# CREATE ROLE syslog WITH LOGIN;
postgres=# \password syslog    # Using the \password function is secure because
postgres=# CREATE ROLE logwriter WITH LOGIN;
postgres=# \password logwriter # the password is not saved in history.
postgres=# CREATE DATABASE syslog OWNER syslog;
postgres=# \q # You are done here for the moment
</pre>
<p>Edit <code>pg_hba.conf</code> to allow <code>syslog</code> and <code>logwriter</code> to establish a connection to PostgreSQL.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/var/lib/postgres/data/pg_hba.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># TYPE  DATABASE    USER        CIDR-ADDRESS          METHOD

host    syslog      logwriter   192.168.0.1/24        md5
host    syslog      syslog      192.168.0.10/32       md5
</pre>
<p>Then <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Reload">reload</a> <code>postgresql.service</code>. 
</p>
<p>Edit <code>/etc/syslog-ng/syslog-ng.conf</code> so that it knows where and how to write to PostgreSQL. syslog-ng will utilize the <code>logwriter</code> role.
</p>
<pre>...
#
# SQL logging support
#

destination d_pgsql {
  sql(type(pgsql)
  host("127.0.0.1") username("logwriter") password("password")
  database("syslog")
  table("logs_${HOST}_${R_YEAR}${R_MONTH}${R_DAY}") #or whatever you want, example ${HOST}" for hosts, ${LEVEL}" for levels.. etc
  columns("datetime timestamp with time zone", "host varchar(32)", "program varchar(16)", "pid varchar(16)", "message varchar(200)")
  values("$R_ISODATE", "$HOST", "$PROGRAM", "$PID", "$MSG")
  indexes("datetime", "host", "program", "pid", "message"));
};

log { source(src); destination(d_pgsql); };
</pre>
<p>Finally, <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">restart</a> <code>syslog-ng.service</code>.
</p>
<p>And check to see if things are being logged.
</p>
<pre>psql -U logwriter -d syslog
syslog=&gt; SELECT * FROM &lt;your table name&gt; ORDER BY datetime DESC LIMIT 10;
</pre>
<h3><span class="mw-headline" id="ISO_8601_timestamps">ISO 8601 timestamps</span></h3>
<p><b>Before</b> :
</p>
<pre>#logger These timestamps are not optimal.
#tail -n 1 /var/log/messages.log
Feb 18 14:25:01 hostname logger: These timestamps are not optimal.
#
</pre>
<p>Add <code>ts_format(iso);</code> to <code>/etc/syslog-ng/syslog-ng.conf</code> in the options section. Example:
</p>
<pre>options {
  stats_freq (0);
  flush_lines (0);
  time_reopen (10);
  log_fifo_size (1000);
  long_hostnames(off); 
  use_dns (no);
  use_fqdn (no);
  create_dirs (no);
  keep_hostname (yes);
  perm(0640);
  group("log");
  ts_format(iso);      #make ISO-8601 timestamps
  #frac-digits(3);     #optional time to nearest millisecond 
};
</pre>
<p>Then <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Reload">reload</a> <code>syslog-ng.service</code>. 
</p>
<p><b>After</b> :
</p>
<pre>#logger Now THAT is a timestamp!
#tail -n 2 /var/log/messages.log
Feb 18 14:25:01 hostname logger: These timestamps are not optimal.
2010-02-18T20:23:58-05:00 electron logger: Now THAT is a timestamp!
#
</pre>
<h3><span class="mw-headline" id="RFC_3339_timestamps">RFC 3339 timestamps</span></h3>
<p>Same as above, except use <code>rfc3339</code> instead of <code>iso</code> for <code>ts_format</code>
</p>
<h3><span class="mw-headline" id="Log_Levels">Log Levels</span></h3>
<p>Log levels are defined separately for each logged facility in syslog-ng config. Available log levels are listed in <code>/usr/include/sys/syslog.h</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/include/sys/syslog.h</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">define LOG_EMERG       0       /* system is unusable */
define LOG_ALERT       1       /* action must be taken immediately */
define LOG_CRIT        2       /* critical conditions */
define LOG_ERR         3       /* error conditions */
define LOG_WARNING     4       /* warning conditions */
define LOG_NOTICE      5       /* normal but significant condition */
define LOG_INFO        6       /* informational */
define LOG_DEBUG       7       /* debug-level messages */
</pre>
<h3><span class="mw-headline" id="Macros_and_Variables">Macros and Variables</span></h3>
<p>Macros can be used in both templates, and in destination file names.  <a rel="nofollow" class="external text" href="https://axoflow.com/docs/axosyslog-core/chapter-manipulating-messages/customizing-message-format/reference-macros/">Macros of syslog-ng OSE</a>.
</p>
<p>The following code will write the log lines to <code>/var/log/test.log</code> in the format of <code>macroname=value@</code>.  
</p>
<pre>template t_test { template("PROGRAM=$PROGRAM@PID=$PID@BSDTAG=$BSDTAG@TAG=$TAG@TAGS=$TAGS@FACILITY=$FACILITY@FACILITY_NUM=$FACILITY_NUM@LEVEL=$LEVEL@LEVEL_NUM=$LEVEL_NUM@PRI=$PRI@PRIORITY=$PRIORITY@FULLHOST=$FULLHOST@FULLHOST_FROM=$FULLHOST_FROM@HOST=$HOST@HOST_FROM=$HOST_FROM@LOGHOST=$LOGHOST@MSGHDR=$MSGHDR@MSGID=$MSGID@MSGONLY=$MSGONLY@MSG=$MSG@MESSAGE=$MESSAGE@SOURCE=$SOURCE@SOURCEIP=$SOURCEIP@SOURCE_IP=$SOURCE_IP@SEQNUM=$SEQNUM@UNIXTIME=$UNIXTIME@FULLDATE=$FULLDATE@ISODATE=$ISODATE@DATE=$DATE@STAMP=$STAMP@TZ=$TZ@TZOFFSET=$TZOFFSET@SEC=$SEC@MIN=$MIN@HOUR=$HOUR@HOUR12=$HOUR12@DAY=$DAY@WEEK=$WEEK@WEEK_DAY=$WEEK_DAY@WEEK_DAY_ABBREV=$WEEK_DAY_ABBREV@WEEK_DAY_NAME=$WEEK_DAY_NAME@MONTH=$MONTH@MONTH_ABBREV=$MONTH_ABBREV@MONTH_NAME=$MONTH_NAME@MONTH_WEEK=$MONTH_WEEK@YEAR=$YEAR@YEAR_DAY=$YEAR_DAY
\n"); template_escape(no); };

destination d_test { file("/var/log/test.log" template(t_test)); };

log { source(s_local); destination(d_test); flags(final); };
</pre>
<p>You can create your own value list as below once syslog-ng is restarted with:
<code>tail /var/log/test.log|tr "@" "\n"</code>
</p>
<pre>PROGRAM=kernel
PID=
BSDTAG=4A
TAG=04
TAGS=.source.s_local
FACILITY=kern
FACILITY_NUM=0
LEVEL=warning
LEVEL_NUM=4
PRI=4
PRIORITY=warning
FULLHOST=www.askapache.com
FULLHOST_FROM=www.askapache.com
HOST=www.askapache.com
HOST_FROM=www.askapache.com
LOGHOST=
MSGHDR=kernel: 
MSGID=
MSGONLY=Firewall: *INVALID* IN=eth0 OUT= MAC=00:00 SRC=x.x.x.x DST=198.101.159.98 LEN=40 TOS=0x00 PREC=0x00 TTL=113 ID=7730 DF PROTO=TCP SPT=52369 DPT=80 WINDOW=0 RES=0x00 ACK RST URGP=0 
MSG=Firewall: *INVALID* IN=eth0 OUT= MAC=00:00 SRC=x.x.x.x DST=198.101.159.98 LEN=40 TOS=0x00 PREC=0x00 TTL=113 ID=7730 DF PROTO=TCP SPT=52369 DPT=80 WINDOW=0 RES=0x00 ACK RST URGP=0 
MESSAGE=Firewall: *INVALID* IN=eth0 OUT= MAC=00:00 SRC=x.x.x.x DST=198.101.159.98 LEN=40 TOS=0x00 PREC=0x00 TTL=113 ID=7730 DF PROTO=TCP SPT=52369 DPT=80 WINDOW=0 RES=0x00 ACK RST URGP=0 
SOURCE=s_local
SOURCEIP=127.0.0.1
SOURCE_IP=
UNIXTIME=1369742458
FULLDATE=2013 May 28 08:00:58
ISODATE=2013-05-28T08:00:58-04:00
DATE=May 28 08:00:58
STAMP=2013-05-28T08:00:58-04:00
TZ=-04:00
TZOFFSET=-04:00
SEC=58
MIN=00
HOUR=08
HOUR12=
DAY=28
WEEK=21
WEEK_DAY=3
WEEK_DAY_ABBREV=Tue
WEEK_DAY_NAME=Tuesday
MONTH=05
MONTH_ABBREV=May
MONTH_NAME=May
MONTH_WEEK=4
YEAR=2013
YEAR_DAY=148
</pre>
<h3><span class="mw-headline" id="Receive_and_parse_common_syslog_messages">Receive and parse common syslog messages</span></h3>
<p>Starting from version 3.16 syslog-ng is capable to receive and parse messages on the most common ports with the most common parsers using the <a rel="nofollow" class="external text" href="https://axoflow.com/docs/axosyslog-core/chapter-sources/source-default-network-drivers/">default-network-drivers()</a> source driver.
</p>
<ul>
<li>Default listening ports:
<ul>
<li>514, both TCP and UDP, for RFC3164 (BSD-syslog) formatted traffic</li>
<li>601 TCP, for RFC5424 (IETF-syslog) formatted traffic</li>
<li>6514 TCP, for TLS-encrypted traffic</li>
</ul>
</li>
<li>Automatic parsers:
<ul>
<li>RFC3164 message parser</li>
<li>RFC5424 message parser</li>
<li><a rel="nofollow" class="external text" href="https://axoflow.com/docs/axosyslog-core/chapter-parsers/cisco-parser/">Cisco parser</a></li>
<li>Structured <a rel="nofollow" class="external text" href="https://axoflow.com/docs/axosyslog-core/chapter-concepts/concepts-message-structure/syslog-ng-message-format/">EWMM parser</a>
</li>
<li>Other application adapters (Splunk Common Information Model (CIM), iptables, or sudo)</li>
</ul>
</li>
</ul>
<h3><span class="mw-headline" id="See_Also">See Also</span></h3>
<ul><li>
<a href="../en/General_troubleshooting.html#netconsole" class="mw-redirect" title="Netconsole">Netconsole</a> A kernel module that sends all kernel log messages (i.e. <a href="../en/Core_utilities.html#Essentials" class="mw-redirect" title="Dmesg">dmesg</a>) over the network to another computer, without involving user space (e.g. syslogd).</li></ul>
<h2><span class="mw-headline" id="External_Links">External Links</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://github.com/syslog-ng/syslog-ng">syslog-ng Project Page on GitHub</a></li>
<li><a rel="nofollow" class="external text" href="https://www.syslog-ng.com/products/open-source-log-management/">syslog-ng OSE Main Page from syslog-ng.com</a></li>
<li><a rel="nofollow" class="external text" href="https://axoflow.com/docs/axosyslog-core/">syslog-ng Documentation</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/axoflow/axosyslog-core-docs">syslog-ng Documentation GitHub page</a></li>
<li><a rel="nofollow" class="external text" href="https://www.syslog-ng.com/community/">syslog-ng Blogs</a></li>
<li><a rel="nofollow" class="external text" href="https://axoflow.com/blog/">Axoflow Blogs about syslog-ng</a></li>
<li><a rel="nofollow" class="external text" href="https://freshmeat.sourceforge.net/projects/syslog-ng/">syslog-ng Project Page on Freecode</a></li>
<li><a href="https://wiki.gentoo.org/wiki/syslog-ng" class="extiw" title="gentoo:syslog-ng">Gentoo:syslog-ng</a></li>
<li><a href="https://wiki.gentoo.org/wiki/Security_Handbook/Logging" class="extiw" title="gentoo:Security Handbook/Logging">Gentoo:Security Handbook/Logging</a></li>
<li><a rel="nofollow" class="external text" href="https://www.pcwdld.com/what-is-syslog-including-servers-and-ports">What is Syslog? Logging with PostgreSQL HOWTO</a></li>
<li><a href="https://en.wikipedia.org/wiki/ISO_8601" class="extiw" title="wikipedia:ISO 8601">Wikipedia:ISO 8601</a></li>
<li>
<a href="https://tools.ietf.org/html/rfc3164" class="extiw" title="rfc:3164">RFC 3164</a> - The BSD syslog Protocol</li>
<li>
<a href="https://tools.ietf.org/html/rfc5424" class="extiw" title="rfc:5424">RFC 5424</a> - The Syslog Protocol
<ul>
<li>
<a href="https://tools.ietf.org/html/rfc5425" class="extiw" title="rfc:5425">RFC 5425</a> - Transport Layer Security (TLS) Transport Mapping for Syslog</li>
<li>
<a href="https://tools.ietf.org/html/rfc5426" class="extiw" title="rfc:5426">RFC 5426</a> - Transmission of Syslog Messages over UDP</li>
<li>
<a href="https://tools.ietf.org/html/rfc5427" class="extiw" title="rfc:5427">RFC 5427</a> - Textual Conventions for Syslog Management</li>
<li>
<a href="https://tools.ietf.org/html/rfc5428" class="extiw" title="rfc:5428">RFC 5428</a> - MIB for PacketCable and IPCablecom-Compliant Devices</li>
</ul>
</li>
<li>
<a href="https://tools.ietf.org/html/rfc3339" class="extiw" title="rfc:3339">RFC 3339</a> - Date and Time on the Internet: Timestamps</li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Logging.html" title="Category:Logging">Logging</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Syslog-ng&amp;oldid=803632">https://wiki.archlinux.org/index.php?title=Syslog-ng&amp;oldid=803632</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 16 March 2024, at 15:23.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki.svg" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul></ul>
</div>
</body>
</html>
