<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-os vector-sticky-header-enabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Ansible - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.44.2">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Ansible rootpage-Ansible skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Installation</span>
			</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Basic_usage" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Basic_usage">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Basic usage</span>
			</div>
		</a>
		
			<button aria-controls="toc-Basic_usage-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Basic usage subsection</span>
			</button>
		
		<ul id="toc-Basic_usage-sublist" class="vector-toc-list">
			<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configuration">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1</span>
					<span>Configuration</span>
				</div>
			</a>
			
			<ul id="toc-Configuration-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Inventory" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Inventory">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2</span>
					<span>Inventory</span>
				</div>
			</a>
			
			<ul id="toc-Inventory-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Ping" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Ping">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.3</span>
					<span>Ping</span>
				</div>
			</a>
			
			<ul id="toc-Ping-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Playbook" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Playbook">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.4</span>
					<span>Playbook</span>
				</div>
			</a>
			
			<ul id="toc-Playbook-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Vault" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Vault">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.5</span>
					<span>Vault</span>
				</div>
			</a>
			
			<ul id="toc-Vault-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Package_management" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Package_management">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.6</span>
					<span>Package management</span>
				</div>
			</a>
			
			<ul id="toc-Package_management-sublist" class="vector-toc-list">
				<li id="toc-Official_repositories" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Official_repositories">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.6.1</span>
					<span>Official repositories</span>
				</div>
			</a>
			
			<ul id="toc-Official_repositories-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-AUR" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#AUR">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.6.2</span>
					<span>AUR</span>
				</div>
			</a>
			
			<ul id="toc-AUR-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Tips_and_tricks" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Tips_and_tricks">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Tips and tricks</span>
			</div>
		</a>
		
			<button aria-controls="toc-Tips_and_tricks-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Tips and tricks subsection</span>
			</button>
		
		<ul id="toc-Tips_and_tricks-sublist" class="vector-toc-list">
			<li id="toc-User_account_creation" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#User_account_creation">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1</span>
					<span>User account creation</span>
				</div>
			</a>
			
			<ul id="toc-User_account_creation-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Python_binary_location" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Python_binary_location">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2</span>
					<span>Python binary location</span>
				</div>
			</a>
			
			<ul id="toc-Python_binary_location-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Troubleshooting">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">4</span>
				<span>Troubleshooting</span>
			</div>
		</a>
		
			<button aria-controls="toc-Troubleshooting-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Troubleshooting subsection</span>
			</button>
		
		<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
			<li id="toc-Unarchive" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Unarchive">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.1</span>
					<span>Unarchive</span>
				</div>
			</a>
			
			<ul id="toc-Unarchive-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">5</span>
				<span>See also</span>
			</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar vector-feature-custom-font-size-clientpref--excluded">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left" title="Table of Contents">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Ansible</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 2 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-2" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">2 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Ansible" title="Ansible – 日本語" lang="ja" hreflang="ja" data-title="Ansible" data-language-autonym="日本語" data-language-local-name="日本語" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-pt mw-list-item"><a href="../pt/Ansible.html" title="Ansible – português" lang="pt" hreflang="pt" data-title="Ansible" data-language-autonym="Português" data-language-local-name="português" class="interlanguage-link-target"><span>Português</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end vector-feature-custom-font-size-clientpref--excluded">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<p>From <a rel="nofollow" class="external text" href="https://www.ansible.com/overview/how-ansible-works">www.ansible.com</a>:
</p>
<dl><dd>Ansible is a radically simple IT automation engine that automates cloud provisioning, configuration management, application deployment, intra-service orchestration, and many other IT needs.</dd></dl>
<meta property="mw:PageProp/toc">
<div class="mw-heading mw-heading2"><h2 id="Installation">Installation</h2></div>
<p>On the control machine (master), <a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ansible-core">ansible-core</a></span> package. Additionally, you can install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ansible">ansible</a></span> package, which provides a range of community curated collections.
</p>
<p>On the managed machines (nodes),  where you want to automate deployment or configuration tasks, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=python">python</a></span> is required and it may be necessary to indicate the specific <a href="#Python_binary_location">#Python binary location</a> in some circumstances.  A way to communicate with the node is also necessary, this is usually <a href="../en/Secure_Shell.html" class="mw-redirect" title="SSH">SSH</a>. Note that a functioning <a href="../en/SSH_keys.html#Copying_the_public_key_to_the_remote_server" title="SSH keys">SSH key</a> setup eases the use of Ansible but is not required.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip</strong> You may want to install syntax highlighting of Ansible files (e.g. <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=vim-ansible">vim-ansible</a></span> for <a href="../en/Vim.html" title="Vim">vim</a>)</div>
<div class="mw-heading mw-heading2"><h2 id="Basic_usage">Basic usage</h2></div>
<div class="mw-heading mw-heading3"><h3 id="Configuration">Configuration</h3></div>
<p>Ansible parameters are set in the configuration file which can either be <code>ansible.cfg</code> in the current directory, <code>.ansible.cfg</code> in the home directory or <code>/etc/ansible/ansible.cfg</code>, whichever it finds first.
</p>
<p>A base config can be generated with: 
</p>
<pre>$ ansible-config init --disabled &gt; ansible.cfg
</pre>
<div class="mw-heading mw-heading3"><h3 id="Inventory">Inventory</h3></div>
<p>The infrastructure is listed in the Ansible inventory file, which defaults to being saved in the location <code>/etc/ansible/hosts</code> or one can specify a different inventory file using the <code>-i</code> command line switch. For instance, the following inventory defines a cluster with 7 nodes organized into two groups:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ansible/hosts</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[control]
192.168.12.1
foo-[a:c].example.org
localhost ansible_connection=local

[managed]
192.168.12.2
192.168.12.3</pre>
<p>One can assign specific attributes to every node in the infrastructure file at the corresponding line or in the <code>ansible.cfg</code> configuration file.
By default Ansible executes playbooks over SSH, the <code>ansible_connection</code> parameter extends the connection to:
</p>
<ul>
<li>
<code>local</code> to deploy the playbook to the control machine itself</li>
<li>
<code>docker</code> deploys the playbook directly into Docker containers</li>
</ul>
<p>Check <a rel="nofollow" class="external text" href="https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html">Ansible - intro inventory</a> for details.
</p>
<div class="mw-heading mw-heading3"><h3 id="Ping">Ping</h3></div>
<p>You may check if all the nodes listed in the inventory are alive by
</p>
<pre>$ ansible all -m ping
</pre>
<div class="mw-heading mw-heading3"><h3 id="Playbook">Playbook</h3></div>
<p>Playbooks are the main organizational unit to configure and deploy the whole infrastructure.  Check <a rel="nofollow" class="external text" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks.html">the official document</a> for more details.  Here is an extremely simple demonstration, where the administrator of the above inventory wants to perform a full system upgrade on a set of Arch Linux hosts. First, create a playbook file, with YAML formatting (<i>always</i> 2 spaces indentation):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">syu.yml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">---
- name: All hosts up-to-date
  hosts: control managed
  become: true

  tasks:
    - name: Full system upgrade
      community.general.pacman:
        update_cache: true
        upgrade: true
</pre>
<p>Then, run the playbook script:
</p>
<pre>$ ansible-playbook --ask-become-pass syu.yml
</pre>
<div class="mw-heading mw-heading3"><h3 id="Vault">Vault</h3></div>
<p>A <a rel="nofollow" class="external text" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html#vault">vault</a> can be used to keep sensitive data in an encrypted form in playbooks or roles, rather than in plaintext.  The vault password can be stored in plaintext in a file, for example <code><i>vault_pass.txt</i></code> containing <code><i>myvaultpassword</i></code>, to be used later on as a command parameter:
</p>
<pre>$ ansible-playbook <i>site.yml</i> --vault-id <i>vault_pass.txt</i>
</pre>
<p>In order to encrypt the content <code><i>the var content</i></code> of a variable named <code><i>varname</i></code> using the password stored in <code><i>vault_pass.txt</i></code>, the following command should be used:
</p>
<pre>$ ansible-vault encrypt_string --vault-id <i>vault_pass.txt</i> '<i>the var content</i>' --name <i>varname</i>
</pre>
<p>More securely, to avoid inputting the variable content in the command line and be prompted for it instead, one can use:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ ansible-vault encrypt_string --vault-id <i>vault_pass.txt</i> --stdin-name <i>varname</i></pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Reading plaintext input from stdin. (ctrl-d to end input)</pre>
<p>The command returns directly the protected variable that can be inserted into a playbook. Encrypted and non-encrypted variables can coexist in a YAML file as illustrated below:
</p>
<pre>notsecret: myvalue

mysecret: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          66386439653236336462626566653063336164663966303231363934653561363964363833313662
          6431626536303530376336343832656537303632313433360a626438346336353331386135323734
          62656361653630373231613662633962316233633936396165386439616533353965373339616234
          3430613539666330390a313736323265656432366236633330313963326365653937323833366536
          3462

other_not_secret: othervalue</pre>
<div class="mw-heading mw-heading3"><h3 id="Package_management">Package management</h3></div>
<div class="mw-heading mw-heading4"><h4 id="Official_repositories">Official repositories</h4></div>
<p>Ansible has a <a rel="nofollow" class="external text" href="https://docs.ansible.com/ansible/latest/collections/community/general/pacman_module.html">pacman module</a> (provided by the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ansible">ansible</a></span> package) to handle installation, removal and system upgrades with <a href="../en/Pacman.html" title="Pacman">pacman</a>.
</p>
<div class="mw-heading mw-heading4"><h4 id="AUR">AUR</h4></div>
<p>For the <a href="../en/Arch_User_Repository.html" title="Arch User Repository">Arch User Repository</a> <i>(AUR)</i>, it is required to use the external module <a rel="nofollow" class="external text" href="https://github.com/kewlfft/ansible-aur">ansible-aur</a>. See the README for use and installation instructions.
</p>
<p>While Ansible expects to ssh as root, AUR helpers do not allow executing operations as root, they all fail with "you cannot perform this operation as root". For Ansible automation, it is therefore recommended to create a user, for example named <i>aur_builder</i>, that has no need for password with pacman in <a href="../en/Sudo.html#Configuration" class="mw-redirect" title="Sudoers">sudoers</a>. This can be done in Ansible with the following actions:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">task.yml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">- user: name=<i>aur_builder</i>

- lineinfile:
     path: /etc/sudoers.d/<i>aur_builder-allow-to-sudo-pacman</i>
     state: present
     line: "<i>aur_builder</i> ALL=(ALL) NOPASSWD: /usr/bin/pacman"
     validate: /usr/sbin/visudo -cf %s
     create: yes</pre>
<p>Then, AUR helpers or <a href="../en/Makepkg.html" title="Makepkg">makepkg</a> can be used associated with the Ansible parameters <code>become: yes</code> and <code>become_user: aur_builder</code>
</p>
<div class="mw-heading mw-heading2"><h2 id="Tips_and_tricks">Tips and tricks</h2></div>
<div class="mw-heading mw-heading3"><h3 id="User_account_creation">User account creation</h3></div>
<p>Ansible can manage user accounts and in particular it is able to create new ones. This is achieved in playbooks with the <a rel="nofollow" class="external text" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/user_module.html">user module</a> which takes an optional <code>password</code> argument to set the user's password. It is the <b>hashed value of the password</b> that needs to be provided to the module.
</p>
<p>The hashing can simply be performed on the fly within Ansible using one of its internal <a rel="nofollow" class="external text" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_filters.html#hash-filters">hash-filters</a>:
</p>
<pre>- user:
  name: <i>user_name</i>
  password: "{{ '<i>user_password</i>' | password_hash('sha512', '<i>mypermsalt</i>') }}"
  shell: /usr/bin/nologin
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip</strong> The salt should be fixed and explicitly supplied as a second parameter of the hash function for the operation to be idempotent (can be repeated without changing the state of the system).</div>
<p>With this approach it is recommended to vault-encrypt <i>user_password</i> so that it does not appear in plain text, see <a href="#Vault">#Vault</a>. However, an encrypted variable cannot be piped directly and will first need to be assigned to another one that will be piped. 
</p>
<p>Alternatively, the hashing can be performed outside Ansible. The following commands return respectively the <a href="https://en.wikipedia.org/wiki/MD5" class="extiw" title="wikipedia:MD5">MD5</a> and the <a href="https://en.wikipedia.org/wiki/SHA-2" class="extiw" title="wikipedia:SHA-2">SHA512</a> hashed values of <i>user_password</i>:
</p>
<pre>$ openssl passwd -1 <i>user_password</i>
</pre>
<pre>$ python -c 'import crypt; print(crypt.crypt("<i>user_password</i>", crypt.mksalt(crypt.METHOD_SHA512)))'
</pre>
<div class="mw-heading mw-heading3"><h3 id="Python_binary_location">Python binary location</h3></div>
<p>Ansible requires <a href="../en/Python.html" title="Python">Python</a> on the target machine. By default Ansible assumes it can find a <code>/usr/bin/python</code> on the remote system that is a 2.X or 3.X version, specifically 2.6 or higher.
</p>
<p>If some of your modules specifically require Python2, you need to inform Ansible about its location by setting the <code>ansible_python_interpreter</code> variable in the inventory file. This can be done by using host groups in the inventory:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ansible/hosts</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[archlinux]
server1
server2

[debian]
server3

[archlinux:vars]
ansible_python_interpreter=/usr/bin/python2</pre>
<p>More information about Python version support in Ansible is available in <a rel="nofollow" class="external autonumber" href="https://docs.ansible.com/ansible/latest/reference_appendices/python_3_support.html">[1]</a>, <a rel="nofollow" class="external autonumber" href="https://docs.ansible.com/ansible/latest/reference_appendices/faq.html#how-do-i-handle-not-having-a-python-interpreter-at-usr-bin-python-on-a-remote-machine">[2]</a> and <a rel="nofollow" class="external autonumber" href="https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html#connecting-to-hosts-behavioral-inventory-parameters">[3]</a>.
</p>
<div class="mw-heading mw-heading2"><h2 id="Troubleshooting">Troubleshooting</h2></div>
<div class="mw-heading mw-heading3"><h3 id="Unarchive">Unarchive</h3></div>
<p>The <code>unarchive</code> module unpacks an archive. However <i>tar</i> files are not well supported and several outstanding issues are reported in <a rel="nofollow" class="external text" href="https://github.com/ansible/ansible/labels/m%3Aunarchive">GitHub - unarchive</a>. In particular when the parameter <code>keep_newer</code> is set to <code>yes</code>, idempotence is not observed. In case you face an issue with the module, you can use instead the <i>zip</i> format which is better integrated in Ansible.
</p>
<div class="mw-heading mw-heading2"><h2 id="See_also">See also</h2></div>
<ul>
<li>
<a rel="nofollow" class="external free" href="https://www.ansible.com/resources/videos/quick-start-video">https://www.ansible.com/resources/videos/quick-start-video</a> - Ansible concept in 12 minutes</li>
<li>
<a rel="nofollow" class="external free" href="https://docs.ansible.com/ansible/latest/collections/community/general/pacman_module.html">https://docs.ansible.com/ansible/latest/collections/community/general/pacman_module.html</a> - Official documentation of the pacman module</li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Configuration_management.html" title="Category:Configuration management">Configuration management</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Ansible&amp;oldid=795520">https://wiki.archlinux.org/index.php?title=Ansible&amp;oldid=795520</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 29 December 2023, at 07:42.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><picture><source media="(min-width: 500px)" srcset="/resources/assets/poweredby_mediawiki.svg" width="88" height="31"><img src="/resources/assets/mediawiki_compact.svg" width="25" height="25" loading="lazy"></picture></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-header-container vector-sticky-header-container">
	<div id="vector-sticky-header" class="vector-sticky-header">
		<div class="vector-sticky-header-start">
			<div class="vector-sticky-header-icon-start vector-button-flush-left vector-button-flush-right" aria-hidden="true">
				<button class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-sticky-header-search-toggle" tabindex="-1" data-event-name="ui.vector-sticky-search-form.icon"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
			</button>
		</div>
			
		<div role="search" class="vector-search-box-vue vector-search-box">
			<div class="vector-typeahead-search-container">
				<div class="cdx-typeahead-search">
					<form action="/index.php" id="vector-sticky-search-form" class="cdx-search-input cdx-search-input--has-end-button">
						<div class="cdx-search-input__input-wrapper" data-search-loc="header-moved">
							<div class="cdx-text-input cdx-text-input--has-start-icon">
								<input class="cdx-text-input__input" type="search" name="search" placeholder="Search ArchWiki">
								<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
							</div>
							<input type="hidden" name="title" value="Special:Search">
						</div>
						<button class="cdx-button cdx-search-input__end-button">Search</button>
					</form>
				</div>
			</div>
		</div>
		<div class="vector-sticky-header-context-bar">
				<nav aria-label="Contents" class="vector-toc-landmark">
						
					<div id="vector-sticky-header-toc" class="vector-dropdown mw-portlet mw-portlet-sticky-header-toc vector-sticky-header-toc vector-button-flush-left">
						<input type="checkbox" id="vector-sticky-header-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-sticky-header-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
						<label id="vector-sticky-header-toc-label" for="vector-sticky-header-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
						</label>
						<div class="vector-dropdown-content">
					
						<div id="vector-sticky-header-toc-unpinned-container" class="vector-unpinned-container">
						</div>
					
						</div>
					</div>
			</nav>
				<div class="vector-sticky-header-context-bar-primary" aria-hidden="true"><span class="mw-page-title-main">Ansible</span></div>
			</div>
		</div>
		<div class="vector-sticky-header-end" aria-hidden="true">
			<div class="vector-sticky-header-icons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-talk-sticky-header" tabindex="-1" data-event-name="talk-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbles mw-ui-icon-wikimedia-speechBubbles"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-subject-sticky-header" tabindex="-1" data-event-name="subject-sticky-header"><span class="vector-icon mw-ui-icon-article mw-ui-icon-wikimedia-article"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-history-sticky-header" tabindex="-1" data-event-name="history-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-history mw-ui-icon-wikimedia-wikimedia-history"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only mw-watchlink" id="ca-watchstar-sticky-header" tabindex="-1" data-event-name="watch-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-star mw-ui-icon-wikimedia-wikimedia-star"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-edit-sticky-header" tabindex="-1" data-event-name="wikitext-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-wikiText mw-ui-icon-wikimedia-wikimedia-wikiText"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-ve-edit-sticky-header" tabindex="-1" data-event-name="ve-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-edit mw-ui-icon-wikimedia-wikimedia-edit"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-viewsource-sticky-header" tabindex="-1" data-event-name="ve-edit-protected-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-editLock mw-ui-icon-wikimedia-wikimedia-editLock"></span>

<span></span>
			</a>
		</div>
			<div class="vector-sticky-header-buttons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive" id="ca-addsection-sticky-header" tabindex="-1" data-event-name="addsection-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbleAdd-progressive mw-ui-icon-wikimedia-speechBubbleAdd-progressive"></span>

<span>Add topic</span>
			</a>
		</div>
			<div class="vector-sticky-header-icon-end">
				<div class="vector-user-links">
				</div>
			</div>
		</div>
	</div>
</div>
<div class="mw-portlet mw-portlet-dock-bottom emptyPortlet" id="p-dock-bottom">
	<ul>
		
	</ul>
</div>
</body>
</html>
