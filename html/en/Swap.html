<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Swap - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Swap rootpage-Swap skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Swap_space" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Swap_space">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Swap space</div>
		</a>
		
		<ul id="toc-Swap_space-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Swap_partition" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Swap_partition">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Swap partition</div>
		</a>
		
			<button aria-controls="toc-Swap_partition-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Swap partition subsection</span>
			</button>
		
		<ul id="toc-Swap_partition-sublist" class="vector-toc-list">
			<li id="toc-Activation_by_systemd" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Activation_by_systemd">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Activation by systemd</div>
			</a>
			
			<ul id="toc-Activation_by_systemd-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Disabling_swap" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Disabling_swap">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>Disabling swap</div>
			</a>
			
			<ul id="toc-Disabling_swap-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Swap_file" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Swap_file">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Swap file</div>
		</a>
		
			<button aria-controls="toc-Swap_file-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Swap file subsection</span>
			</button>
		
		<ul id="toc-Swap_file-sublist" class="vector-toc-list">
			<li id="toc-Swap_file_creation" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Swap_file_creation">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>Swap file creation</div>
			</a>
			
			<ul id="toc-Swap_file_creation-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Swap_file_removal" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Swap_file_removal">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>Swap file removal</div>
			</a>
			
			<ul id="toc-Swap_file_removal-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Compressed_block_device_in_RAM" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Compressed_block_device_in_RAM">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Compressed block device in RAM</div>
		</a>
		
		<ul id="toc-Compressed_block_device_in_RAM-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Swap_encryption" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Swap_encryption">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Swap encryption</div>
		</a>
		
		<ul id="toc-Swap_encryption-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Performance" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Performance">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>Performance</div>
		</a>
		
			<button aria-controls="toc-Performance-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Performance subsection</span>
			</button>
		
		<ul id="toc-Performance-sublist" class="vector-toc-list">
			<li id="toc-Swappiness" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Swappiness">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.1</span>Swappiness</div>
			</a>
			
			<ul id="toc-Swappiness-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-VFS_cache_pressure" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#VFS_cache_pressure">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.2</span>VFS cache pressure</div>
			</a>
			
			<ul id="toc-VFS_cache_pressure-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Priority" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Priority">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.3</span>Priority</div>
			</a>
			
			<ul id="toc-Priority-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Striping" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Striping">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.4</span>Striping</div>
			</a>
			
			<ul id="toc-Striping-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">7</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Swap</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 8 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-8" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">8 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-de mw-list-item"><a href="https://wiki.archlinux.de/title/Swap" title="Swap – Deutsch" lang="de" hreflang="de" class="interlanguage-link-target"><span>Deutsch</span></a></li>
<li class="interlanguage-link interwiki-es mw-list-item"><a href="../es/Swap.html" title="Swap – español" lang="es" hreflang="es" class="interlanguage-link-target"><span>Español</span></a></li>
<li class="interlanguage-link interwiki-fr mw-list-item"><a href="../fr/Swap.html" title="Swap – français" lang="fr" hreflang="fr" class="interlanguage-link-target"><span>Français</span></a></li>
<li class="interlanguage-link interwiki-hu mw-list-item"><a href="../hu/Swap.html" title="Swap – magyar" lang="hu" hreflang="hu" class="interlanguage-link-target"><span>Magyar</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/%E3%82%B9%E3%83%AF%E3%83%83%E3%83%97" title="スワップ – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-pt mw-list-item"><a href="../pt/Swap.html" title="Swap – português" lang="pt" hreflang="pt" class="interlanguage-link-target"><span>Português</span></a></li>
<li class="interlanguage-link interwiki-ru mw-list-item"><a href="../ru/Swap.html" title="Swap – русский" lang="ru" hreflang="ru" class="interlanguage-link-target"><span>Русский</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/Swap" title="Swap – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/Fstab.html" title="Fstab">fstab</a></li>
<li><a href="../en/Power_management/Suspend_and_hibernate.html#Hibernation" class="mw-redirect" title="Hibernation">Hibernation</a></li>
<li><a href="../en/Zswap.html" title="Zswap">zswap</a></li>
<li><a href="../en/Zram.html" title="Zram">zram</a></li>
<li><a href="../en/Swap_on_video_RAM.html" class="mw-redirect" title="Swap on video ram">Swap on video ram</a></li>
<li><a href="../en/ZFS.html#Swap_volume" title="ZFS">ZFS#Swap volume</a></li>
<li><a href="../en/Dm-crypt/Swap_encryption.html" title="Dm-crypt/Swap encryption">dm-crypt/Swap encryption</a></li>
</ul>
</div>
<p>This page provides an introduction to <a href="https://en.wikipedia.org/wiki/Paging" class="extiw" title="wikipedia:Paging">swap space and paging</a> on GNU/Linux. It covers creation and activation of swap partitions and swap files.
</p>
<p>From <a rel="nofollow" class="external text" href="https://www.linux.com/news/all-about-linux-swap-space/">All about Linux swap space</a>:
</p>
<dl><dd>Linux divides its physical RAM (random access memory) into chunks of memory called pages. Swapping is the process whereby a page of memory is copied to the preconfigured space on the hard disk, called swap space, to free up that page of memory. The combined sizes of the physical memory and the swap space is the amount of virtual memory available.</dd></dl>
<p>Support for swap is provided by the Linux kernel and user-space utilities from the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=util-linux">util-linux</a></span> package.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Swap_space">Swap space</span></h2>
<p>Swap space can take the form of a disk partition or a file. Users may create a swap space during installation or at any later time as desired. Swap space can be used for two purposes, to extend the virtual memory beyond the installed physical memory (RAM), and also for <a href="../en/Power_management/Suspend_and_hibernate.html" title="Power management/Suspend and hibernate">suspend-to-disk</a> support.
</p>
<p>Whether or not it is beneficial to extend the virtual memory with swap depends on the amount of installed physical memory. If the amount of physical memory is less than the amount of memory required to run all the desired programs, then it <i>may be</i> beneficial to enable swap. This avoids <a href="https://en.wikipedia.org/wiki/Out_of_memory" class="extiw" title="wikipedia:Out of memory">out of memory conditions</a>, where the Linux kernel OOM killer mechanism will automatically attempt to free up memory by killing processes. To increase the amount of virtual memory to the required amount, add the necessary difference (or more) as swap space.
</p>
<p>The biggest drawback of using swap when running out of memory is its lower performance, see section <a href="#Performance">#Performance</a>. Hence, enabling swap is a matter of personal preference: some prefer programs to be killed over enabling swap and others prefer enabling swap and slower system when the physical memory is exhausted.
</p>
<p>To check swap status, use:
</p>
<pre>$ swapon --show
</pre>
<p>Or to show physical memory as well as swap usage:
</p>
<pre>$ free -h
</pre>
<h2><span class="mw-headline" id="Swap_partition">Swap partition</span></h2>
<p>A swap partition can be created with most GNU/Linux <a href="../en/Partitioning.html#Partitioning_tools" class="mw-redirect" title="Partitioning tools">partitioning tools</a>. Swap partitions are designated as type <code>82</code> on MBR and <code>0657FD6D-A4AB-43C4-84E5-0933C84B4F4F</code> on GPT. 
</p>
<p>To set up a partition as Linux swap area, the <span class="plainlinks archwiki-template-man" title="$ man 8 mkswap"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mkswap.8">mkswap(8)</a></span> command is used. For example:
</p>
<pre># mkswap /dev/sd<i>xy</i>
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> All data on the specified partition will be lost.</div>
<p>To enable the device for paging:
</p>
<pre># swapon /dev/sd<i>xy</i>
</pre>
<p>To enable this swap partition on boot, add an entry to <code>/etc/fstab</code>:
</p>
<pre>UUID=<i>device_UUID</i> none swap defaults 0 0
</pre>
<p>where the <code><i>device_UUID</i></code> is  the <a href="../en/Persistent_block_device_naming.html#by-uuid" class="mw-redirect" title="UUID">UUID</a> of the swap space.
</p>
<p>See <a href="../en/Fstab.html" title="Fstab">fstab</a> for the file syntax.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The fstab-entry is optional if the swap partition is located on a device using GPT. See <a href="#Activation_by_systemd">#Activation by systemd</a>.</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Enabling discard on RAID setups using mdadm will cause system lockup on boot and during runtime, if using swapon.</div>
<h3><span class="mw-headline" id="Activation_by_systemd">Activation by systemd</span></h3>
<p><a href="../en/Systemd.html" title="Systemd">systemd</a> activates swap partitions based on two different mechanisms. Both are executables in <code>/usr/lib/systemd/system-generators</code>. The generators are run on start-up and create native systemd units for mounts. The first, <code>systemd-fstab-generator</code>, reads the fstab to generate units, including a unit for swap. The second, <code>systemd-gpt-auto-generator</code> inspects the root disk to generate units. It operates on GPT disks only, and can identify swap partitions by their type GUID, see <a href="../en/Systemd.html#GPT_partition_automounting" title="Systemd">systemd#GPT partition automounting</a> for more information.
</p>
<h3><span class="mw-headline" id="Disabling_swap">Disabling swap</span></h3>
<p>To deactivate specific swap space:
</p>
<pre># swapoff /dev/sd<i>xy</i>
</pre>
<p>Alternatively use the <code>-a</code> switch to deactivate all swap space.
</p>
<p>Since swap is managed by systemd, it will be activated again on the next system startup. To disable the automatic activation of detected swap space permanently, run <code>systemctl --type swap</code> to find the responsible <i>.swap</i> unit and <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Mask">mask</a> it.
</p>
<h2><span class="mw-headline" id="Swap_file">Swap file</span></h2>
<p>As an alternative to creating an entire partition, a swap file offers the ability to vary its size on-the-fly, and is more easily removed altogether. This may be especially desirable if disk space is at a premium (e.g. a modestly-sized SSD).
</p>
<table class="wikitable sortable">
<tbody>
<tr>
<th>File system
</th>
<th>Supports swap files
</th>
</tr>
<tr>
<td>
<a href="../en/Bcachefs.html" title="Bcachefs">Bcachefs</a>
</td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">
<a rel="nofollow" class="external text" href="https://github.com/koverstreet/bcachefs/issues/368">No</a>
</td>
</tr>
<tr>
<td>
<a href="../en/Btrfs.html" title="Btrfs">Btrfs</a>
</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">
<a href="../en/Btrfs.html#Swap_file" title="Btrfs">Yes</a>
</td>
</tr>
<tr>
<td>
<a href="../en/F2FS.html" title="F2FS">F2FS</a>
</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td>
<a href="../en/Ext4.html" title="Ext4">ext4</a>
</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td>
<a href="../en/JFS.html" title="JFS">JFS</a>
</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td>
<a href="https://en.wikipedia.org/wiki/NILFS" class="extiw" title="wikipedia:NILFS">NILFS2</a>
</td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">No
</td>
</tr>
<tr>
<td>
<a href="../en/NTFS.html" class="mw-redirect" title="NTFS3">NTFS3</a>
</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td>
<a href="https://en.wikipedia.org/wiki/ReiserFS" class="extiw" title="wikipedia:ReiserFS">ReiserFS</a>
</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td>
<a href="../en/XFS.html" title="XFS">XFS</a>
</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td>
<a href="../en/ZFS.html" title="ZFS">ZFS</a>
</td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">No
</td>
</tr>
</tbody>
</table>
<h3><span class="mw-headline" id="Swap_file_creation">Swap file creation</span></h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> For <a href="../en/Btrfs.html" title="Btrfs">Btrfs</a>, follow the procedure described in <a href="../en/Btrfs.html#Swap_file" title="Btrfs">Btrfs#Swap file</a> instead of the steps below.</div>
<p>Use <span class="plainlinks archwiki-template-man" title="$ man 8 mkswap"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mkswap.8">mkswap(8)</a></span> to create a swap file the size of your choosing (see <a href="../en/Partitioning.html#Swap" title="Partitioning">Partitioning#Swap</a> for advice). For example, creating a 4 GiB swap file:
</p>
<pre># mkswap -U clear --size 4G --file /swapfile
</pre>
<p>Activate the swap file:
</p>
<pre># swapon /swapfile
</pre>
<p>Finally, edit the fstab configuration to add an entry for the swap file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/fstab</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/swapfile none swap defaults 0 0
</pre>
<p>For additional information, see <a href="../en/Fstab.html#Usage" title="Fstab">fstab#Usage</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The swap file must be specified by its location on the file system, not by its UUID or LABEL.
</div>
<h3><span class="mw-headline" id="Swap_file_removal">Swap file removal</span></h3>
<p>To remove a swap file, it must be turned off first and then can be removed:
</p>
<pre># swapoff /swapfile
# rm -f /swapfile
</pre>
<p>Finally, remove the relevant entry from <code>/etc/fstab</code>.
</p>
<h2><span class="mw-headline" id="Compressed_block_device_in_RAM">Compressed block device in RAM</span></h2>
<p><a href="../en/Zswap.html" title="Zswap">zswap</a> is available by default if you use a swap file or partition, but you can avoid swap files or partitions altogether by using a compressed block device in RAM, using <a href="../en/Zram.html" title="Zram">zram</a>. See <a href="../en/Improving_performance.html#zram_or_zswap" title="Improving performance">Improving performance#zram or zswap</a> for more information on the differences between using <a href="../en/Zram.html" title="Zram">zram</a> or <a href="../en/Zswap.html" title="Zswap">zswap</a>.
</p>
<h2><span class="mw-headline" id="Swap_encryption">Swap encryption</span></h2>
<p>See <a href="../en/Dm-crypt/Swap_encryption.html" title="Dm-crypt/Swap encryption">dm-crypt/Swap encryption</a>.
</p>
<h2><span class="mw-headline" id="Performance">Performance</span></h2>
<p>Swap operations are usually significantly slower than directly accessing data in RAM. However, disabling swap entirely to improve performance can sometimes lead to a degradation. If there is not enough physical memory available to hold everything, swapping out nothing leaves less memory available for file system caches, causing more frequent and costly disk usage.
</p>
<p>Swap values can be adjusted to help performance:
</p>
<h3><span class="mw-headline" id="Swappiness">Swappiness</span></h3>
<p>When memory usage reaches a certain threshold, the kernel starts looking at active memory and seeing what it can free up. File data can be written out to the file system (if changed), unloaded and re-loaded later; other data must be written to swap before it can be unloaded. 
</p>
<p>The <i>swappiness</i> <a href="../en/Sysctl.html" title="Sysctl">sysctl</a> parameter represents the kernel's preference for writing to swap instead of files. It can have a value between 0 and 200 (max 100 if Linux &lt; 5.8); the default value is 60. A low value causes the kernel to prefer freeing up open files, a high value causes the kernel to try to use swap space, and a value of 100 means IO cost is assumed to be equal.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> There is a common misconception that swappiness affects the memory threshold or prevents using swap space, but it only affects the preference for freeing up file pages over swap. See: <a rel="nofollow" class="external text" href="https://www.howtogeek.com/449691/what-is-swapiness-on-linux-and-how-to-change-it/">this article</a> for a more detailed explanation or the <a rel="nofollow" class="external text" href="https://github.com/torvalds/linux/blob/v6.2/mm/vmscan.c#L3000-L3014">kernel source code</a> where it is used.</div>
<p>To check the current swappiness value:
</p>
<pre>$ sysctl vm.swappiness
</pre>
<p>Alternatively, the file <code>/proc/sys/vm/swappiness</code> can be read in order to obtain the raw integer value.
</p>
<p>To temporarily set the swappiness value:
</p>
<pre># sysctl -w vm.swappiness=35
</pre>
<p>To set the swappiness value permanently, create a <span class="plainlinks archwiki-template-man" title="$ man 5 sysctl.d"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sysctl.d.5">sysctl.d(5)</a></span> configuration file. For example:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sysctl.d/99-swappiness.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">vm.swappiness = 35</pre>
<p>To have the <a href="../en/Arch_boot_process.html#Boot_loader" class="mw-redirect" title="Boot loader">boot loader</a> set swappiness when loading the kernel, add a <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a>, e.g. <code>sysctl.vm.swappiness=35</code>.
</p>
<p>To test and more on why this may work, take a look at <a rel="nofollow" class="external text" href="https://rudd-o.com/en/linux-and-free-software/tales-from-responsivenessland-why-linux-feels-slow-and-how-to-fix-that">this article</a>. For a more recent counter-argument, see <a rel="nofollow" class="external text" href="https://chrisdown.name/2018/01/02/in-defence-of-swap.html">this article</a>.
</p>
<h3><span class="mw-headline" id="VFS_cache_pressure">VFS cache pressure</span></h3>
<p>Another <i>sysctl</i> parameter that affects swap performance is <code>vm.vfs_cache_pressure</code>, which controls the tendency of the kernel to reclaim the memory which is used for caching of VFS caches, versus pagecache and swap. Increasing this value increases the rate at which VFS caches are reclaimed<a rel="nofollow" class="external autonumber" href="https://web.archive.org/web/20171004100853/http://doc.opensuse.org/documentation/leap/tuning/html/book.sle.tuning/cha.tuning.memory.html#cha.tuning.memory.vm.reclaim">[1]</a>. For more information, see the <a rel="nofollow" class="external text" href="https://docs.kernel.org/admin-guide/sysctl/vm.html">Linux kernel documentation</a>.
</p>
<h3><span class="mw-headline" id="Priority">Priority</span></h3>
<p>If you have more than one swap file or swap partition you should consider assigning a priority value (0 to 32767) for each swap area. The system will use swap areas of higher priority before using swap areas of lower priority. For example, if you have a faster disk (<code>/dev/sda</code>) and a slower disk (<code>/dev/sdb</code>), assign a higher priority to the swap area located on the fastest device. Priorities can be assigned in <a href="../en/Fstab.html" title="Fstab">fstab</a> via the <code>pri</code> parameter:
</p>
<pre>/dev/sda1 none swap defaults,pri=100 0 0
/dev/sdb2 none swap defaults,pri=10  0 0
</pre>
<p>Or via the <code>--priority</code> parameter of <i>swapon</i>:
</p>
<pre># swapon --priority 100 /dev/sda1
</pre>
<p>If two or more areas have the same priority, and it is the highest priority available, pages are allocated on a round-robin basis between them.
</p>
<h3><span class="mw-headline" id="Striping">Striping</span></h3>
<p>There is no necessity to use <a href="../en/RAID.html" title="RAID">RAID</a> for swap performance reasons. The kernel itself can stripe swapping on several devices, if you just give them the same priority in the <code>/etc/fstab</code> file. Refer to <a rel="nofollow" class="external text" href="https://unthought.net/Software-RAID.HOWTO/Software-RAID.HOWTO-2.html#ss2.3">The Software-RAID HOWTO</a> for details.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li><a rel="nofollow" class="external text" href="https://chrisdown.name/2018/01/02/in-defence-of-swap.html">In defence of swap: common misconceptions</a></li></ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:File_systems.html" title="Category:File systems">File systems</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Swap&amp;oldid=812724">https://wiki.archlinux.org/index.php?title=Swap&amp;oldid=812724</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 21 July 2024, at 07:57.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
