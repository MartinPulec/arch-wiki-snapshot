<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Chrome OS devices/Crostini - ArchWiki</title>
<link rel="stylesheet" href="../../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.43.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Chrome_OS_devices_Crostini rootpage-Chrome_OS_devices skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Introduction" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Introduction">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Introduction</span>
			</div>
		</a>
		
			<button aria-controls="toc-Introduction-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Introduction subsection</span>
			</button>
		
		<ul id="toc-Introduction-sublist" class="vector-toc-list">
			<li id="toc-Enabling_Linux_support" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Enabling_Linux_support">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.1</span>
					<span>Enabling Linux support</span>
				</div>
			</a>
			
			<ul id="toc-Enabling_Linux_support-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Replacing_the_default_Debian_Linux_container_with_Arch_Linux" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Replacing_the_default_Debian_Linux_container_with_Arch_Linux">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.2</span>
					<span>Replacing the default Debian Linux container with Arch Linux</span>
				</div>
			</a>
			
			<ul id="toc-Replacing_the_default_Debian_Linux_container_with_Arch_Linux-sublist" class="vector-toc-list">
				<li id="toc-Optional:_Delete_the_Debian_container" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Optional:_Delete_the_Debian_container">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.2.1</span>
					<span>Optional: Delete the Debian container</span>
				</div>
			</a>
			
			<ul id="toc-Optional:_Delete_the_Debian_container-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Create_the_container" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Create_the_container">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.2.2</span>
					<span>Create the container</span>
				</div>
			</a>
			
			<ul id="toc-Create_the_container-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Set_up_the_user" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Set_up_the_user">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.2.3</span>
					<span>Set up the user</span>
				</div>
			</a>
			
			<ul id="toc-Set_up_the_user-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Set_up_the_container_for_use_in_Chrome_OS" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Set_up_the_container_for_use_in_Chrome_OS">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.2.4</span>
					<span>Set up the container for use in Chrome OS</span>
				</div>
			</a>
			
			<ul id="toc-Set_up_the_container_for_use_in_Chrome_OS-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Replace_the_default_Debian_container_with_Arch_Linux" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Replace_the_default_Debian_container_with_Arch_Linux">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.2.5</span>
					<span>Replace the default Debian container with Arch Linux</span>
				</div>
			</a>
			
			<ul id="toc-Replace_the_default_Debian_container_with_Arch_Linux-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Troubleshooting">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Troubleshooting</span>
			</div>
		</a>
		
			<button aria-controls="toc-Troubleshooting-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Troubleshooting subsection</span>
			</button>
		
		<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
			<li id="toc-Arch_container_fails_to_start_after_update_to_Chrome_OS_81" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Arch_container_fails_to_start_after_update_to_Chrome_OS_81">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1</span>
					<span>Arch container fails to start after update to Chrome OS 81</span>
				</div>
			</a>
			
			<ul id="toc-Arch_container_fails_to_start_after_update_to_Chrome_OS_81-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-No_network_in_container" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#No_network_in_container">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2</span>
					<span>No network in container</span>
				</div>
			</a>
			
			<ul id="toc-No_network_in_container-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Permission_denied_with_ping" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Permission_denied_with_ping">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.3</span>
					<span>Permission denied with ping</span>
				</div>
			</a>
			
			<ul id="toc-Permission_denied_with_ping-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-App_not_opening_in_chrome_OS_(infinite_spinner)" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#App_not_opening_in_chrome_OS_(infinite_spinner)">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.4</span>
					<span>App not opening in chrome OS (infinite spinner)</span>
				</div>
			</a>
			
			<ul id="toc-App_not_opening_in_chrome_OS_(infinite_spinner)-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Audio_playback/input" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Audio_playback/input">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.5</span>
					<span>Audio playback/input</span>
				</div>
			</a>
			
			<ul id="toc-Audio_playback/input-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Video_playback" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Video_playback">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.6</span>
					<span>Video playback</span>
				</div>
			</a>
			
			<ul id="toc-Video_playback-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-GPU_acceleration" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#GPU_acceleration">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.7</span>
					<span>GPU acceleration</span>
				</div>
			</a>
			
			<ul id="toc-GPU_acceleration-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Unlock_the_keyring_when_starting_the_container" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Unlock_the_keyring_when_starting_the_container">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.8</span>
					<span>Unlock the keyring when starting the container</span>
				</div>
			</a>
			
			<ul id="toc-Unlock_the_keyring_when_starting_the_container-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Fullscreen_video,_games_and_mouse_capture" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Fullscreen_video,_games_and_mouse_capture">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.9</span>
					<span>Fullscreen video, games and mouse capture</span>
				</div>
			</a>
			
			<ul id="toc-Fullscreen_video,_games_and_mouse_capture-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id='toc-"Linux_Files"_is_empty_on_host' class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href='#"Linux_Files"_is_empty_on_host'>
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.10</span>
					<span>"Linux Files" is empty on host</span>
				</div>
			</a>
			
			<ul id='toc-"Linux_Files"_is_empty_on_host-sublist' class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Firefox_laggy_clicking,_scrolling_&amp;_videos" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Firefox_laggy_clicking,_scrolling_&amp;_videos">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.11</span>
					<span>Firefox laggy clicking, scrolling &amp; videos</span>
				</div>
			</a>
			
			<ul id="toc-Firefox_laggy_clicking,_scrolling_&amp;_videos-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>See also</span>
			</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Chrome OS devices/Crostini</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 2 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-2" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">2 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Crostini" title="Crostini – 日本語" lang="ja" hreflang="ja" data-title="Crostini" data-language-autonym="日本語" data-language-local-name="日本語" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/Chrome_OS_devices/Crostini" title="Chrome OS devices/Crostini – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" data-title="Chrome OS devices/Crostini" data-language-autonym="中文（简体）" data-language-local-name="中文（简体）" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"><div class="subpages">&lt; <bdi dir="ltr"><a href="../../en/Chrome_OS_devices.html" title="Chrome OS devices">Chrome OS devices</a></bdi>
</div></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<p><a rel="nofollow" class="external text" href="https://chromium.googlesource.com/chromiumos/docs/+/HEAD/containers_and_vms.md">Crostini</a> is Google's umbrella term for making Linux application support easy to use and integrating well with Chrome OS.
</p>
<p>This article describes how to install Arch Linux on a Chromebook in a container (via Crostini), without needing to enable developer mode, allowing apps to run alongside other Chrome/Android apps.
</p>
<p>Highlights:
</p>
<ul>
<li>Officially supported, do not need to enable developer mode - leaves Chrome OS secure, no need to flash a BIOS etc.</li>
<li>Better battery life - battery life of Chrome with the functionality of Linux.</li>
<li>Audio (in/out) &amp; OpenGL are supported, but USB devices are only partially supported and development is still in progress.</li>
</ul>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Introduction">Introduction</span></h2>
<h3><span class="mw-headline" id="Enabling_Linux_support">Enabling Linux support</span></h3>
<p>Look for Linux under Settings and enable it. This installs a Debian Linux container that we will then replace with an Arch Linux container.
</p>
<dl><dd><i>Settings &gt; Linux &gt; Enable</i></dd></dl>
<p>Crostini is still rolling out to Chromebooks. If you do not see an option to enable Linux, you may need to switch to the beta or developer channel, if it has not rolled out to the stable channel for your laptop yet. This can be done via <i>Settings &gt; About Chrome OS &gt; Channel &gt; Dev/Beta</i>.
</p>
<h3><span class="mw-headline" id="Replacing_the_default_Debian_Linux_container_with_Arch_Linux">Replacing the default Debian Linux container with Arch Linux</span></h3>
<p>The below instructions were initially based on <a rel="nofollow" class="external free" href="https://www.reddit.com/r/Crostini/wiki/howto/run-arch-linux?v=2d4c6b4c-bbb0-11e8-8f2f-0e740b2a8a8c">https://www.reddit.com/r/Crostini/wiki/howto/run-arch-linux?v=2d4c6b4c-bbb0-11e8-8f2f-0e740b2a8a8c</a>.
</p>
<h4><span class="mw-headline" id="Optional:_Delete_the_Debian_container">Optional: Delete the Debian container</span></h4>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> For the time being of Chrome 87, starting a vmc with a custom lxc image makes Termina think it is invalid and delete it. <code>lxc delete penguin</code> should not leave the space unusable. See <a rel="nofollow" class="external autonumber" href="https://bugs.chromium.org/p/chromium/issues/detail?id=1146390#c6">[1]</a>
</div>
<p>If you have no use for Debian anymore, you can save some storage space by destroying and recreating the Termina VM (this will let you skip renaming / deleting existing container later). Beware this will also delete any other containers you may have under Termina.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Destroying the existing termina may also disable android apps and the play store.</div>
<p>Open the crosh terminal in Chrome (<code>Ctrl+Alt+t</code>).
</p>
<pre>vmc destroy termina
vmc start termina
</pre>
<h4><span class="mw-headline" id="Create_the_container">Create the container</span></h4>
<p>Open a new crosh terminal in Chrome (<code>Ctrl+Alt+t</code>). Enter termina using:
</p>
<pre>vsh termina
</pre>
<p>Now you need to replace the default <code>images</code> remote:
</p>
<pre>lxc remote remove images
lxc remote add images <a rel="nofollow" class="external free" href="https://images.lxd.canonical.com/">https://images.lxd.canonical.com/</a> --protocol=simplestreams
</pre>
<p>Then create the Arch Linux container:
</p>
<pre>lxc launch images:archlinux arch --config security.privileged=true
</pre>
<p>Open a shell in Termina and check if the Arch Linux container is present (it may a few minutes to show on the list):
</p>
<pre>lxc list
</pre>
<p>If the container is not started, start it:
</p>
<pre>lxc start arch
</pre>
<p>Launch a bash shell in the container:
</p>
<pre>lxc exec arch -- bash
</pre>
<h4><span class="mw-headline" id="Set_up_the_user">Set up the user</span></h4>
<p>The container creates a default user on install based on the email used to sign in to Chrome OS. The username can be seen with the following command:
</p>
<pre>grep 1000:1000 /etc/passwd|cut -d':' -f1
</pre>
<p>Optionally you can rename user/group, by default named by your GMail id:
</p>
<pre># pkill -9 -u <i>old-username</i>
# groupmod -n <i>new-username</i> <i>old-username</i>
# usermod -d /home/<i>new-username</i> -l <i>new-username</i> -m -c <i>new-username</i> <i>old-username</i>
</pre>
<p><br>
A password needs setting for the user:
</p>
<pre># passwd <i>username</i>
</pre>
<p>You may additionally want to install <a href="../../en/Sudo.html" title="Sudo">sudo</a> and add the user to the wheel group. Use after installation:
</p>
<pre># visudo
</pre>
<p>Uncomment the following line to allow the wheel group to use sudo:
</p>
<pre># %wheel ALL=(ALL) ALL
</pre>
<p>Add your user to the wheel group:
</p>
<pre># usermod -aG wheel <i>username</i>
</pre>
<p>Leave the container:
</p>
<pre># exit
</pre>
<h4><span class="mw-headline" id="Set_up_the_container_for_use_in_Chrome_OS">Set up the container for use in Chrome OS</span></h4>
<p>Login to the container using regular user account you just configured:
</p>
<pre>lxc console arch
</pre>
<p>Verify networking in the container. The command 
</p>
<pre>$ ip -4 a show dev eth0
</pre>
<p>should return a non-empty output with the container's assigned IP address. If it is not empty, you can proceed, otherwise you are facing the issue described in <a href="#No_network_in_container">#No network in container</a> - follow the instructions listed there to address the issue.
</p>
<p>Install the Crostini container tools, Wayland for GUI application support and Xwayland for X11 application support:
</p>
<p><a href="../../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/cros-container-guest-tools-git/">cros-container-guest-tools-git</a></span><sup><small>AUR</small></sup> package. Additionally install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=wayland">wayland</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xorg-xwayland">xorg-xwayland</a></span> to be able to use GUI tools.
</p>
<p><a href="../../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start/enable">Start/enable</a> the following user units:
</p>
<table class="wikitable">
<tbody>
<tr>
<th>Template instance</th>
<th>Purpose
</th>
</tr>
<tr>
<td><code>sommelier@0.service</code></td>
<td>Wayland
</td>
</tr>
<tr>
<td><code>sommelier-x@0.service</code></td>
<td>X11
</td>
</tr>
<tr>
<td><code>sommelier@1.service</code></td>
<td>Wayland (low density)
</td>
</tr>
<tr>
<td><code>sommelier-x@1.service</code></td>
<td>X11 (low density)
</td>
</tr>
</tbody>
</table>
<p>Make sure these user services are running successfully by checking their <a href="../../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Unit status">unit statuses</a>. Now, when apps are installed in Arch Linux, they will automatically appear in the Chrome OS launcher. Exit from the container shell back to the Termina shell by pressing <code>Ctrl+a</code> <code>q</code>.
</p>
<h4><span class="mw-headline" id="Replace_the_default_Debian_container_with_Arch_Linux">Replace the default Debian container with Arch Linux</span></h4>
<p>The default Debian container is named penguin. Renaming the "arch" container created above to it will cause Chrome OS to launch Linux apps from the arch container. Stop the Arch Linux container:
</p>
<pre>lxc stop --force arch
</pre>
<p>Stop the Debian container and rename it to "debian" (this step can be skipped if you have already removed the Debian container):
</p>
<pre>lxc stop --force penguin
lxc rename penguin debian
</pre>
<p>Rename the Arch container to "penguin" and start it:
</p>
<pre>lxc rename arch penguin
lxc start penguin
</pre>
<p>Restart the Linux subsystem to apply the changes. After restart, verify that no <a href="../../en/Systemd.html#Using_units" title="Systemd">failed system or user units</a> are listed.
</p>
<p>The following command should report the IP address assigned for container:
</p>
<pre>ip -4 a show dev eth0
</pre>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> Check the Chromium OS Garcon Bridge (<code>journalctl --user -u cros-garcon</code>) for host integration issues, like "Linux files is empty in the Files app" or "Applications do not appear on Chrome OS".</div>
<h3><span class="mw-headline" id="Arch_container_fails_to_start_after_update_to_Chrome_OS_81">Arch container fails to start after update to Chrome OS 81</span></h3>
<p>Most of custom containers stopped working with Chrome OS 81 update. The root cause is a LXC version update, as a result, the container fails to start with following error:
</p>
<pre>lxc penguin 20200411193357.312 WARN     initutils - initutils.c:setproctitle:324 - Invalid argument - Failed to set cmdline
lxc penguin 20200411193357.395 WARN     conf - conf.c:lxc_map_ids:2919 - newuidmap is lacking necessary privileges
lxc penguin 20200411193357.395 WARN     conf - conf.c:lxc_map_ids:2925 - newgidmap is lacking necessary privileges
lxc penguin 20200411193357.400 WARN     conf - conf.c:lxc_map_ids:2919 - newuidmap is lacking necessary privileges
lxc penguin 20200411193357.400 WARN     conf - conf.c:lxc_map_ids:2925 - newgidmap is lacking necessary privileges
lxc penguin 20200411193357.477 ERROR    conf - conf.c:run_buffer:335 - Script exited with status 32
lxc penguin 20200411193357.477 ERROR    conf - conf.c:lxc_setup:3589 - Failed to run mount hooks
lxc penguin 20200411193357.477 ERROR    start - start.c:do_start:1263 - Failed to setup container "penguin"
lxc penguin 20200411193357.478 ERROR    sync - sync.c:__sync_wait:62 - An error occurred in another process (expected sequence number 5)
lxc penguin 20200411193357.478 WARN     network - network.c:lxc_delete_network_priv:2561 - Failed to rename interface with index 17 from "eth0" to its initial name "veth421fa9d1"
lxc penguin 20200411193357.478 ERROR    lxccontainer - lxccontainer.c:wait_on_daemonized_start:842 - Received container state "ABORTING" instead of "RUNNING"
lxc penguin 20200411193357.479 ERROR    start - start.c:__lxc_start:1939 - Failed to spawn container "penguin"
lxc penguin 20200411193357.701 WARN     conf - conf.c:lxc_map_ids:2919 - newuidmap is lacking necessary privileges
lxc penguin 20200411193357.701 WARN     conf - conf.c:lxc_map_ids:2925 - newgidmap is lacking necessary privileges
lxc 20200411193357.706 WARN             commands - commands.c:lxc_cmd_rsp_recv:132 - Connection reset by peer - Failed to receive response for command "get_state"
lxc 20200411193357.707 WARN             commands - commands.c:lxc_cmd_rsp_recv:132 - Connection reset by peer - Failed to receive response for command "get_state"
</pre>
<p><b>Solution</b>
</p>
<p>Navigate to crosh and execute the following commands:
</p>
<pre>vmc start termina
vsh termina
lxc file delete penguin/var/lib/lxc
lxc file delete penguin/var/lib/lxcfs
</pre>
<p>Restart Linux subsystem and container started should start normally.
</p>
<h3><span class="mw-headline" id="No_network_in_container">No network in container</span></h3>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../../File:Inaccurate.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>The factual accuracy of this article or section is disputed.</b></p>
<div>
<b>Reason:</b> In systemd v249, the problem seems to have disappeared, and everything works as it should. However, in systemd v250, the problem seems to appear again. The above claims regarding v249 and v250 need to be confirmed with more user reports. (Discuss in <a rel="nofollow" class="external text" href="../../en/Talk:Chrome_OS_devices/Crostini.html">Talk:Chrome OS devices/Crostini</a>)</div>
</div>
<p>As was reported by multiple sources, systemd-networkd and systemd-resolved services in systemd-244.1 are not working properly for unprivileged LXC containers, which ends up in missing network connectivity inside the Crostini container. Users may see only IPv6 address but no IPv4 address for the <code>arch</code> container (for example, using <code>ip a</code> command).
</p>
<p>One possible solution is stated here: <a href="../../en/LXD.html#No_IPv4_with_systemd-networkd" title="LXD">LXD#No IPv4 with systemd-networkd</a>.
</p>
<p>Alternatively, another solution is to completely disable systemd-networkd/systemd-resolved and perform network configuration by <a href="../../en/Network_configuration.html#Network_managers" class="mw-redirect" title="Dhclient">dhclient</a> service instead. First, install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dhclient">dhclient</a></span>, then, as the root user, run:
</p>
<pre>dhcpcd eth0
systemctl disable systemd-networkd
systemctl disable systemd-resolved
unlink /etc/resolv.conf
touch /etc/resolv.conf
systemctl enable dhclient@eth0
systemctl start dhclient@eth0
</pre>
<p><a href="../../en/NetworkManager.html" title="NetworkManager">NetworkManager</a> and <a href="../../en/Dhcpcd.html" title="Dhcpcd">dhcpcd</a> also can be used to address the issue if you prefer them over the <code>dhclient</code> solution.
</p>
<h3><span class="mw-headline" id="Permission_denied_with_ping">Permission denied with ping</span></h3>
<p>If you get
</p>
<pre>ping: socket: permission denied
</pre>
<p>when trying to ping from a user other than <code>root</code>, you need to set the <a href="../../en/Capabilities.html" title="Capabilities">capability</a> flag on the <code>/usr/bin/ping</code> file to fix it.
</p>
<pre># setcap cap_net_raw+ep /usr/bin/ping
</pre>
<p>This should solve the problem. See <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/63710">FS#63710</a>.
</p>
<h3>
<span id="App_not_opening_in_chrome_OS_.28infinite_spinner.29"></span><span class="mw-headline" id="App_not_opening_in_chrome_OS_(infinite_spinner)">App not opening in chrome OS (infinite spinner)</span>
</h3>
<p>I found that launching a console (lxc console penguin) session prevents apps from launching in Chrome OS. Launching results in an infinite spinner. In that case, I have to stop and start the container to get the Chrome OS launcher working
</p>
<pre>lxc stop penguin
lxc start penguin
</pre>
<p>Instead of using an lxc console session, I use a regular Linux terminal GUI launched from Chrome OS that prevents this issue.
</p>
<h3>
<span id="Audio_playback.2Finput"></span><span class="mw-headline" id="Audio_playback/input">Audio playback/input</span>
</h3>
<p>Crostini support audio playback starting Chrome OS 74. With <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/cros-container-guest-tools-git/">cros-container-guest-tools-git</a></span><sup><small>AUR</small></sup> installed both ALSA and PulseAudio playback should work after PulseAudio configuration. Audio input is  supported starting Chrome OS 79.
</p>
<p>Enter the following command in the container (in case you did not):
</p>
<pre>$ cp -rT /etc/skel/.config/pulse ~/.config/pulse
</pre>
<p>It is also possible to use <a href="../../en/PipeWire.html" title="PipeWire">PipeWire</a> instead of PulseAudio. Put the following file into <code>/etc/pipewire/pipewire.conf.d</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pipewire/pipewire.conf.d/crostini-audio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">context.objects = [
    { factory = adapter
        args = {
            factory.name           = api.alsa.pcm.sink
            node.name              = "Virtio Soundcard Sink"
            media.class            = "Audio/Sink"
            api.alsa.path          = "hw:0,0"
            audio.channels         = 2
            audio.position         = "FL,FR"
        }
    }
    { factory = adapter
        args = {
            factory.name           = api.alsa.pcm.source
            node.name              = "Virtio Soundcard Source"
            media.class            = "Audio/Source"
            api.alsa.path          = "hw:0,0"
            audio.channels         = 2
            audio.position         = "FL,FR"
        }
    }
]</pre>
<h3><span class="mw-headline" id="Video_playback">Video playback</span></h3>
<p><a href="../../en/Mpv.html" title="Mpv">mpv</a> can play videos using software rendering without any addition configuration, however this is CPU consuming and laggy experience for modern video codecs like H265. For hardware accelerated playback GPU acceleration is required. Take into account, that GPU acceleration for Crostini is based on <a rel="nofollow" class="external text" href="https://docs.mesa3d.org/drivers/virgl">VirGL</a>, so no real GPU device pass-though is performed and hardware-specific APIs like VA-API or VPDAU are not available. However OpenGL acceleration can be used, i.e. this is example of <code>mpv.conf</code> which enabled accelerated video and audio playback on Google Pixelbook starting Chrome OS 77:
</p>
<pre>vo=gpu
ao=alsa
</pre>
<h3><span class="mw-headline" id="GPU_acceleration">GPU acceleration</span></h3>
<p>On Google Pixelbook GPU acceleration works with Arch out-of-the-box starting Chrome OS 77. Also no flags need to be enabled on recent released of Chrome OS:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ glxinfo -B</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">name of display: :0
display: :0  screen: 0
direct rendering: Yes
Extended renderer info (GLX_MESA_query_renderer):
    Vendor: Red Hat (0x1af4)
    Device: virgl (0x1010)
    Version: 19.1.4
--&gt; Accelerated: yes &lt;--
    Video memory: 0MB
    Unified memory: no
    Preferred profile: core (0x1)
    Max core profile version: 4.3
    Max compat profile version: 3.1
    Max GLES1 profile version: 1.1
    Max GLES[23] profile version: 3.2
OpenGL vendor string: Red Hat
OpenGL renderer string: virgl
OpenGL core profile version string: 4.3 (Core Profile) Mesa 19.1.4
OpenGL core profile shading language version string: 4.30
OpenGL core profile context flags: (none)
OpenGL core profile profile mask: core profile

OpenGL version string: 3.1 Mesa 19.1.4
OpenGL shading language version string: 1.40
OpenGL context flags: (none)

OpenGL ES profile version string: OpenGL ES 3.2 Mesa 19.1.4
OpenGL ES profile shading language version string: OpenGL ES GLSL ES 3.20</pre>
<h3><span class="mw-headline" id="Unlock_the_keyring_when_starting_the_container">Unlock the keyring when starting the container</span></h3>
<p>If you have problems with programs that use <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gnome-keyring">gnome-keyring</a></span>-daemon, you need to write a user systemd daemon (see <a href="../../en/Systemd/User.html#Writing_user_units" title="Systemd/User">Systemd/User#Writing user units</a>) that will run the keyring daemon when the container starts.
</p>
<p>Create the following two files:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/user/gnome-keyring.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Keyring

[Service]
ExecStart=/usr/local/bin/export-keys
KillUserProcesses=no

[Install]
WantedBy=default.target</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Leaving the password in plain text is potentially dangerous. You can replace <code>echo random-password</code> with <code>cat ~/.password</code> by creating the appropriate file in your home folder.</div>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/local/bin/export-keys</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash
killall gnome-keyring-daemon
echo random-password | gnome-keyring-daemon --components=secrets,ssh,pkcs11 --unlock --foreground</pre>
<p>Give the file launch rights:
</p>
<pre># chmod a+x /usr/local/bin/export-keys
</pre>
<p>Then, <a href="../../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start/enable">start/enable</a> the <code>gnome-keyring.service</code> user unit and run
</p>
<pre>$ echo -n login &gt; ~/.local/share/keyrings/default
</pre>
<h3>
<span id="Fullscreen_video.2C_games_and_mouse_capture"></span><span class="mw-headline" id="Fullscreen_video,_games_and_mouse_capture">Fullscreen video, games and mouse capture</span>
</h3>
<p>Currently Crostini has limited support for mouse capture starting with Chrome OS 79. You must enable the flag chrome://flags/#exo-pointer-lock to get mouse capture. The closed issue relating to mouse capture is <a rel="nofollow" class="external free" href="https://bugs.chromium.org/p/chromium/issues/detail?id=927521">https://bugs.chromium.org/p/chromium/issues/detail?id=927521</a>.
</p>
<h3>
<span id=".22Linux_Files.22_is_empty_on_host"></span><span class="mw-headline" id='"Linux_Files"_is_empty_on_host'>"Linux Files" is empty on host</span>
</h3>
<p>If you find the "Linux Files" directory on host is always empty and see the following logs in the guest Arch Linux, then you might be affected.
</p>
<pre>Feb 24 21:18:23 penguin garcon[183]: [183]: sftp: accepted connection from vsock:2:3162708311
Feb 24 21:18:23 penguin garcon[183]: [183]: Failed to execute requested program in child process: No such file or directory
Feb 24 21:18:23 penguin garcon[183]: [183]: sftp: failed to spawn child process: No child processes (10)
</pre>
<p>Since <a rel="nofollow" class="external text" href="https://crrev.com/c/3702822">2022-06</a>, garcon launches the sftp server with <code>/usr/lib/openssh/sftp-server</code>, while the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=openssh">openssh</a></span> package installs the binary at <code>/usr/lib/ssh/sftp-server</code>. A workaround is linking the path expected by garcon to the installed one:
</p>
<pre># mkdir /usr/lib/openssh/
# ln -s /usr/lib/ssh/sftp-server /usr/lib/openssh/sftp-server
</pre>
<h3>
<span id="Firefox_laggy_clicking.2C_scrolling_.26_videos"></span><span class="mw-headline" id="Firefox_laggy_clicking,_scrolling_&amp;_videos">Firefox laggy clicking, scrolling &amp; videos</span>
</h3>
<p>If firefox is exhibiting extremely laggy behavior when clicking on the address bar, scrolling, selecting text etc, and or playing lagged or choppy videos, running firefox with MOZ_ENABLE_WAYLAND=1 may resolve this. Inside firefox, about:support should show "Window Protocol" as wayland after this.
</p>
<pre>MOZ_ENABLE_WAYLAND=1 firefox
</pre>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://chromium.googlesource.com/chromiumos/docs/+/HEAD/containers_and_vms.md">Running Custom Containers Under Chrome OS</a></li>
<li><a rel="nofollow" class="external text" href="https://www.reddit.com/r/Crostini/">/r/Crostini</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/wernight/powerline-web-fonts">Powerline Web Fonts for Chromebook</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../../en/Category:Chrome_OS_devices.html" title="Category:Chrome OS devices">Chrome OS devices</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../../en/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Chrome_OS_devices/Crostini&amp;oldid=817520">https://wiki.archlinux.org/index.php?title=Chrome_OS_devices/Crostini&amp;oldid=817520</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 30 September 2024, at 04:44.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki.svg" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul></ul>
</div>
</body>
</html>
