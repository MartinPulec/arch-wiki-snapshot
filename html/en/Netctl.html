<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>netctl - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Netctl rootpage-Netctl skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Installation</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Configuration</div>
		</a>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Usage" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Usage">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Usage</div>
		</a>
		
			<button aria-controls="toc-Usage-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Usage subsection</span>
			</button>
		
		<ul id="toc-Usage-sublist" class="vector-toc-list">
			<li id="toc-Starting_a_profile" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Starting_a_profile">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>Starting a profile</div>
			</a>
			
			<ul id="toc-Starting_a_profile-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Enabling_a_profile" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Enabling_a_profile">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>Enabling a profile</div>
			</a>
			
			<ul id="toc-Enabling_a_profile-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Special_systemd_units" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Special_systemd_units">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3</span>Special systemd units</div>
			</a>
			
			<ul id="toc-Special_systemd_units-sublist" class="vector-toc-list">
				<li id="toc-Wired" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Wired">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.1</span>Wired</div>
			</a>
			
			<ul id="toc-Wired-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Wireless" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Wireless">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.2</span>Wireless</div>
			</a>
			
			<ul id="toc-Wireless-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Tips_and_tricks" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Tips_and_tricks">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Tips and tricks</div>
		</a>
		
			<button aria-controls="toc-Tips_and_tricks-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Tips and tricks subsection</span>
			</button>
		
		<ul id="toc-Tips_and_tricks-sublist" class="vector-toc-list">
			<li id="toc-Example_profiles" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Example_profiles">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>Example profiles</div>
			</a>
			
			<ul id="toc-Example_profiles-sublist" class="vector-toc-list">
				<li id="toc-Wired_2" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Wired_2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1.1</span>Wired</div>
			</a>
			
			<ul id="toc-Wired_2-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Wireless_(WPA-PSK)" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Wireless_(WPA-PSK)">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1.2</span>Wireless (WPA-PSK)</div>
			</a>
			
			<ul id="toc-Wireless_(WPA-PSK)-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Obfuscate_wireless_passphrase" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Obfuscate_wireless_passphrase">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2</span>Obfuscate wireless passphrase</div>
			</a>
			
			<ul id="toc-Obfuscate_wireless_passphrase-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Using_an_experimental_GUI" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Using_an_experimental_GUI">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.3</span>Using an experimental GUI</div>
			</a>
			
			<ul id="toc-Using_an_experimental_GUI-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Bonding" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Bonding">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4</span>Bonding</div>
			</a>
			
			<ul id="toc-Bonding-sublist" class="vector-toc-list">
				<li id="toc-Load_balancing" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Load_balancing">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4.1</span>Load balancing</div>
			</a>
			
			<ul id="toc-Load_balancing-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Wired_to_wireless_failover" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Wired_to_wireless_failover">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4.2</span>Wired to wireless failover</div>
			</a>
			
			<ul id="toc-Wired_to_wireless_failover-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Using_any_interface" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Using_any_interface">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.5</span>Using any interface</div>
			</a>
			
			<ul id="toc-Using_any_interface-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Using_hooks" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Using_hooks">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.6</span>Using hooks</div>
			</a>
			
			<ul id="toc-Using_hooks-sublist" class="vector-toc-list">
				<li id="toc-Examples" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Examples">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.6.1</span>Examples</div>
			</a>
			
			<ul id="toc-Examples-sublist" class="vector-toc-list">
				<li id="toc-Execute_commands_on_established_connection" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Execute_commands_on_established_connection">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.6.1.1</span>Execute commands on established connection</div>
			</a>
			
			<ul id="toc-Execute_commands_on_established_connection-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Set_default_DHCP_client" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Set_default_DHCP_client">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.6.1.2</span>Set default DHCP client</div>
			</a>
			
			<ul id="toc-Set_default_DHCP_client-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Minimal_WPAConfigSection" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Minimal_WPAConfigSection">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.7</span>Minimal WPAConfigSection</div>
			</a>
			
			<ul id="toc-Minimal_WPAConfigSection-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-/etc/resolv.conf" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#/etc/resolv.conf">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.8</span>/etc/resolv.conf</div>
			</a>
			
			<ul id="toc-/etc/resolv.conf-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Troubleshooting">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Troubleshooting</div>
		</a>
		
			<button aria-controls="toc-Troubleshooting-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Troubleshooting subsection</span>
			</button>
		
		<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
			<li id="toc-Job_for_netctl@wlan(...).service_failed" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Job_for_netctl@wlan(...).service_failed">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1</span>Job for netctl@wlan(...).service failed</div>
			</a>
			
			<ul id="toc-Job_for_netctl@wlan(...).service_failed-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-dhcpcd:_ipv4_addroute:_File_exists" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#dhcpcd:_ipv4_addroute:_File_exists">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2</span>dhcpcd: ipv4_addroute: File exists</div>
			</a>
			
			<ul id="toc-dhcpcd:_ipv4_addroute:_File_exists-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-DHCP_timeout_issues" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#DHCP_timeout_issues">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.3</span>DHCP timeout issues</div>
			</a>
			
			<ul id="toc-DHCP_timeout_issues-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-dhcpcd_debugging" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#dhcpcd_debugging">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.4</span>dhcpcd debugging</div>
			</a>
			
			<ul id="toc-dhcpcd_debugging-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Connection_timeout_issues" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Connection_timeout_issues">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.5</span>Connection timeout issues</div>
			</a>
			
			<ul id="toc-Connection_timeout_issues-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Problems_with_netctl-auto_on_resume" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Problems_with_netctl-auto_on_resume">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.6</span>Problems with netctl-auto on resume</div>
			</a>
			
			<ul id="toc-Problems_with_netctl-auto_on_resume-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-netctl-auto_does_not_automatically_unblock_a_wireless_card_to_use_an_interface" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#netctl-auto_does_not_automatically_unblock_a_wireless_card_to_use_an_interface">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.7</span>netctl-auto does not automatically unblock a wireless card to use an interface</div>
			</a>
			
			<ul id="toc-netctl-auto_does_not_automatically_unblock_a_wireless_card_to_use_an_interface-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-RTNETLINK_answers:_File_exists_(with_multiple_NICs)" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#RTNETLINK_answers:_File_exists_(with_multiple_NICs)">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.8</span>RTNETLINK answers: File exists (with multiple NICs)</div>
			</a>
			
			<ul id="toc-RTNETLINK_answers:_File_exists_(with_multiple_NICs)-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Problems_with_eduroam_and_other_MSCHAPv2_connections" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Problems_with_eduroam_and_other_MSCHAPv2_connections">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.9</span>Problems with eduroam and other MSCHAPv2 connections</div>
			</a>
			
			<ul id="toc-Problems_with_eduroam_and_other_MSCHAPv2_connections-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Journal_warnings_for_profiles_using_.include_directives" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Journal_warnings_for_profiles_using_.include_directives">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.10</span>Journal warnings for profiles using .include directives</div>
			</a>
			
			<ul id="toc-Journal_warnings_for_profiles_using_.include_directives-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Hooks_do_not_work" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Hooks_do_not_work">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.11</span>Hooks do not work</div>
			</a>
			
			<ul id="toc-Hooks_do_not_work-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading">netctl</h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 4 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-4" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">4 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-de mw-list-item"><a href="https://wiki.archlinux.de/title/Netctl" title="Netctl – Deutsch" lang="de" hreflang="de" class="interlanguage-link-target"><span>Deutsch</span></a></li>
<li class="interlanguage-link interwiki-fr mw-list-item"><a href="../fr/Netctl.html" title="Netctl – français" lang="fr" hreflang="fr" class="interlanguage-link-target"><span>Français</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Netctl" title="Netctl – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/Netctl" title="Netctl – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<p><span>
</span>
</p>
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/Bridge_with_netctl.html" title="Bridge with netctl">Bridge with netctl</a></li>
<li><a href="../en/Network_configuration.html" title="Network configuration">Network configuration</a></li>
<li><a href="../en/Network_configuration/Wireless.html" class="mw-redirect" title="Wireless network configuration">Wireless network configuration</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://gitlab.archlinux.org/archlinux/netctl">netctl</a> is a CLI and profile-based network manager and an Arch project.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=netctl">netctl</a></span> package.
</p>
<p><i>netctl's</i> <a href="#Special_systemd_units">#Special systemd units</a> used in automating connections require some additional dependencies; see that section for more information.
</p>
<p>Other optional dependencies are shown in the table below.
</p>
<table class="wikitable">
<tbody>
<tr>
<th>Feature
</th>
<th>Dependency
</th>
</tr>
<tr>
<td>WPA</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=wpa_supplicant">wpa_supplicant</a></span>
</td>
</tr>
<tr>
<td>DHCP</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dhcpcd">dhcpcd</a></span> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dhclient">dhclient</a></span>
</td>
</tr>
<tr>
<td><i>wifi-menu</i></td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dialog">dialog</a></span>
</td>
</tr>
<tr>
<td>PPPoE</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ppp">ppp</a></span>
</td>
</tr>
</tbody>
</table>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Do not enable concurrent, conflicting network services. Use <code>systemctl --type=service</code> to ensure that no other network service is running before enabling a <i>netctl</i> profile/service.</div>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p><i>netctl</i> uses profiles to manage network connections and different modes of operation to start profiles automatically or manually on demand. 
</p>
<p>The <i>netctl</i> profile files are stored in <code>/etc/netctl/</code> and example configuration files are available in <code>/etc/netctl/examples/</code>. 
</p>
<p>To use an example profile, simply copy it from <code>/etc/netctl/examples/</code> to <code>/etc/netctl/</code> and configure it to your needs; see basic <a href="#Example_profiles">#Example profiles</a> below. The first parameter you need to create a profile is the network <code>Interface</code>, see <a href="../en/Network_configuration.html#Network_interfaces" title="Network configuration">Network configuration#Network interfaces</a> for details.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 
<ul>
<li>For wireless settings, you can use <code>wifi-menu</code> as root to generate the profile file in <code>/etc/netctl/</code>. The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dialog">dialog</a></span> package is required to use <i>wifi-menu</i>.</li>
<li>Use <code>SkipNoCarrier=yes</code> in your profile to enable a static IP profile on a wired interface no matter if the cable is connected or not.</li>
</ul>
</div>
<p>See <span class="plainlinks archwiki-template-man" title="$ man 5 netctl.profile"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/netctl.profile.5">netctl.profile(5)</a></span> for a complete list of profile options.
</p>
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
<p>See <span class="plainlinks archwiki-template-man" title="$ man 1 netctl"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/netctl.1">netctl(1)</a></span> for a complete list of <i>netctl</i> commands.
</p>
<h3><span class="mw-headline" id="Starting_a_profile">Starting a profile</span></h3>
<p>Once you have created your profile, attempt to establish a connection, where <i>profile</i> is only the profile name, not the full path:
</p>
<pre># netctl start <i>profile</i>
</pre>
<p>If the above command results in a failure, then run <code>journalctl -xn</code> as root and <code>netctl status <i>profile</i></code> to obtain a more in-depth explanation of the failure.
</p>
<h3><span class="mw-headline" id="Enabling_a_profile">Enabling a profile</span></h3>
<p>A profile can be enabled to start at boot by using:
</p>
<pre># netctl enable <i>profile</i>
</pre>
<p>This will create and enable a <a href="../en/Systemd.html" title="Systemd">systemd</a> service that will start when the computer boots. Changes to the profile file will not propagate to the service file automatically. After such changes, it is necessary to reenable the profile:
</p>
<pre># netctl reenable <i>profile</i>
</pre>
<p>After enabling a profile, it will be started at next boot. Obviously this can only be successful, if the network cable for a wired connection is plugged in, or the wireless access point used in a profile is in range respectively.
</p>
<p>If you need to switch multiple profiles frequently (i.e., traveling with a laptop), use <a href="#Special_systemd_units">#Special systemd units</a> instead of enabling a profile.
</p>
<h3><span class="mw-headline" id="Special_systemd_units">Special systemd units</span></h3>
<p><i>netctl</i> provides special <a href="../en/Systemd.html" title="Systemd">systemd</a> services for automatically switching of profiles for wired and wireless connections. See <span class="plainlinks archwiki-template-man" title="$ man 7 netctl.special"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/netctl.special.7">netctl.special(7)</a></span> for a complete list of special systemd units.
</p>
<h4><span class="mw-headline" id="Wired">Wired</span></h4>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ifplugd">ifplugd</a></span> package and <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start/enable">start/enable</a> the <code>netctl-ifplugd@<i>interface</i>.service</code> systemd unit. DHCP profiles will be started/stopped when the network cable is plugged in/unplugged.
</p>
<ul>
<li>The <code>netctl-ifplugd@<i>interface</i>.service</code> will prefer profiles that use <a href="https://en.wikipedia.org/wiki/DHCP" class="extiw" title="wikipedia:DHCP">DHCP</a>.</li>
<li>To automatically start a  static IP profile the option <code>ExcludeAuto=no</code> needs to be set in it.</li>
<li>To prioritize a profile with a static IP over DHCP profiles, you can set <code>Priority=2</code>, which is higher than the default priority given to DHCP profiles of <code>Priority=1</code>.</li>
</ul>
<h4><span class="mw-headline" id="Wireless">Wireless</span></h4>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start/enable">Start/enable</a> <code>netctl-auto@<i>interface</i>.service</code> systemd unit. <i>netctl</i> profiles will be started/stopped automatically as you move from the range of one network into the range of another network (roaming).
</p>
<ul>
<li>Profiles must use <code>Security=wpa-configsection</code> or <code>Security=wpa</code> to work with <i>netctl-auto</i> rather than <code>Security=wpa-config</code>.</li>
<li>If you want some wireless profile <b>not</b> to be started automatically by <code>netctl-auto@<i>interface</i>.service</code>, you have to explicitly add <code>ExcludeAuto=yes</code> to that profile.</li>
<li>You can use <code>priority=</code> in the <i>WPAConfigSection</i> (see <code>/etc/netctl/examples/wireless-wpa-configsection</code>) to set priority of a profile when multiple wireless access points are available. Larger numbers indicate a higher priority.</li>
</ul>
<p>Note that <i>interface</i> is not literal, but to be substituted by the name of your device's interface, e.g. <code>netctl-auto@wlp4s0.service</code>. See <span class="plainlinks archwiki-template-man" title="$ man 5 netctl.profile"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/netctl.profile.5">netctl.profile(5)</a></span> for details.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>If any of the profiles contain errors, such as an empty or misquoted <code>Key=</code> variable, the unit will fail to load with the message <code>"Failed to read or parse configuration '/run/network/wpa_supplicant_wlan0.conf'</code>, even when that profile is not being used.</li>
<li>If you have previously <a href="#Enabling_a_profile">enabled a profile</a> through <i>netctl</i>, run <code>netctl disable <i>profile</i></code> to prevent the profile from starting twice at boot.</li>
</ul>
</div>
<p>It is possible to manually control an interface otherwise managed by <i>netctl-auto</i> without having to stop <code>netctl-auto.service</code>. This is done using the <i>netctl-auto</i> command. For a complete list of available actions see <span class="plainlinks archwiki-template-man" title="$ man 1 netctl-auto"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/netctl-auto.1">netctl-auto(1)</a></span>.
</p>
<h2><span class="mw-headline" id="Tips_and_tricks">Tips and tricks</span></h2>
<h3><span class="mw-headline" id="Example_profiles">Example profiles</span></h3>
<h4><span class="mw-headline" id="Wired_2">Wired</span></h4>
<p>For a DHCP connection, only the <code>Interface</code> has to be configured after copying the <code>/etc/netctl/examples/ethernet-dhcp</code> example profile to <code>/etc/netctl</code>. 
</p>
<p>For example:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/netctl/<i>my_dhcp_profile</i></pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Interface=enp1s0
Connection=ethernet
IP=dhcp
</pre>
<p>For a static IP configuration copy the <code>/etc/netctl/examples/ethernet-static</code> example profile to <code>/etc/netctl</code> and modify <code>Interface</code>, <code>Address</code>, <code>Gateway</code> and <code>DNS</code>) as needed. 
</p>
<p>For example:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/netctl/<i>my_static_profile</i></pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Interface=enp1s0
Connection=ethernet
IP=static
Address=('10.1.10.2/24')
Gateway='10.1.10.1'
DNS=('10.1.10.1')
</pre>
<p>Take care to include the subnet notation of <code>/24</code>. It equates to a netmask of <code>255.255.255.0</code>) and without it the profile will fail to start. See also <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#CIDR_notation" class="extiw" title="wikipedia:Classless Inter-Domain Routing">CIDR notation</a>. To alias more than one IP address per a NIC set <code>Address=('10.1.10.2/24' '192.168.1.2/24')</code>. To alias more than one DNS server address set Eg. <code>DNS=('1.1.1.1' '1.0.0.1')</code>.
</p>
<h4>
<span id="Wireless_.28WPA-PSK.29"></span><span class="mw-headline" id="Wireless_(WPA-PSK)">Wireless (WPA-PSK)</span>
</h4>
<p>The following applies for the standard wireless connections using a pre-shared key (WPA-PSK).
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/netctl/wireless-wpa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Description='A simple WPA encrypted wireless connection using 256-bit PSK'
Interface=wlp2s2
Connection=wireless
Security=wpa
IP=dhcp
ESSID=<i>your_essid</i>
Key=\"64cf3ced850ecef39197bb7b7b301fc39437a6aa6c6a599d0534b16af578e04a</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>Make sure to use the <b>special quoting rules</b> for the <code>Key</code> variable as explained in <span class="plainlinks archwiki-template-man" title="$ man 5 netctl.profile"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/netctl.profile.5#SPECIAL_QUOTING_RULES">netctl.profile(5) § SPECIAL QUOTING RULES</a></span>.</li>
<li>If the passphrase fails, try removing the <code>\"</code> in the <code>Key</code> variable.</li>
<li>Although "encrypted", the key that you put in the profile configuration is enough to connect to a WPA-PSK network. Therefore this process is only useful for hiding the human-readable version of the passphrase. This will not prevent anyone with read access to this file from connecting to the network.</li>
</ul>
</div>
<h3><span class="mw-headline" id="Obfuscate_wireless_passphrase">Obfuscate wireless passphrase</span></h3>
<p>You can also follow the following step to obfuscate the wireless passphrase (<i>wifi-menu</i> does it automatically when using the <code>-o</code> flag): 
</p>
<p>Users <b>not</b> wishing to have the passphrase to their wireless network stored in <i>plain text</i> have the option of storing the corresponding 256-bit pre-shared key instead, which is calculated from the passphrase and the SSID using standard algorithms.
</p>
<p>Calculate your 256-bit PSK using <a href="../en/Wpa_supplicant.html#Connecting_with_wpa_passphrase" title="Wpa supplicant">wpa_passphrase</a>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ wpa_passphrase <i>your_essid</i></pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">network={
  ssid="<i>your_essid</i>"
  #psk="<i>passphrase</i>"
  psk=64cf3ced850ecef39197bb7b7b301fc39437a6aa6c6a599d0534b16af578e04a
}</pre>
<p>The <i>pre-shared key</i> (psk) now needs to replace the plain text passphrase of the <code>Key</code> variable in the profile.
</p>
<h3><span class="mw-headline" id="Using_an_experimental_GUI">Using an experimental GUI</span></h3>
<p>If you want a graphical user interface to manage <i>netctl</i> and your connections and you are not afraid of highly experimental unofficial packages, there are some options available. <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/netctl-gui/">netctl-gui</a></span><sup><small>AUR</small></sup> provides a Qt-based graphical interface, DBus daemon and KDE widget. <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/netmenu/">netmenu</a></span><sup><small>AUR</small></sup> uses <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dmenu">dmenu</a></span> as its graphical interface, and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/gnome-shell-extension-netctl-auto-gnome-git/">gnome-shell-extension-netctl-auto-gnome-git</a></span><sup><small>AUR</small></sup><sup>[<a href="../en/Help:Procedures.html#Fix_broken_package_links" title="Help:Procedures">broken link</a>: package not found]</sup> is a gnome shell extension.
</p>
<p>There is also an application that displays desktop notifications on profile changes and shows a tray icon: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/netctl-tray/">netctl-tray</a></span><sup><small>AUR</small></sup>.
</p>
<h3><span class="mw-headline" id="Bonding">Bonding</span></h3>
<p>From <a rel="nofollow" class="external text" href="https://docs.kernel.org/networking/bonding.html">kernel documentation</a>:
</p>
<dl><dd>The Linux bonding driver provides a method for aggregating multiple network interfaces into a single logical "bonded" interface. The behavior of the bonded interfaces depends on the mode. Generally speaking, modes provide either hot standby or load balancing services. Additionally, link integrity monitoring may be performed.</dd></dl>
<h4><span class="mw-headline" id="Load_balancing">Load balancing</span></h4>
<p>Copy <code>/etc/netctl/examples/bonding</code> to <code>/etc/netctl/bond0</code> and edit it, for example:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/netctl/bond0</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Description='Bond Interface'
Interface='bond0'
Connection=bond
BindsToInterfaces=('eth0' 'eth1')
IP=dhcp
IP6=stateless</pre>
<p>Now you can disable your old configuration and set <i>bond0</i> to be started automatically. Switch to the new profile, for example:
</p>
<pre># netctl switch-to bond0
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This uses the round-robin policy, which is the default for the <code>bonding</code> driver. See <a rel="nofollow" class="external text" href="https://docs.kernel.org/networking/bonding.html">official documentation</a> for details.  </div>
<p>Setting the MODE in the netctl configuration is not always successful and it may be necessary to pass options directly to the bonding module on load as noted <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=203255">here</a>.  This may be needed to use LACP / mode 4.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> To check the status and bonding mode: <pre>$ cat /proc/net/bonding/bond0</pre>
</div>
<h4><span class="mw-headline" id="Wired_to_wireless_failover">Wired to wireless failover</span></h4>
<p>This example describes how to use <i>bonding</i> to fallback to wireless when the wired Ethernet goes down. This is most useful when both the wired and wireless interface will be connected to the same network. Your wireless router/access point must be configured in <a href="../en/Network_bridge.html" class="mw-redirect" title="Bridge">bridge</a> mode.
</p>
<p>You will need an additional package: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=wpa_supplicant">wpa_supplicant</a></span>.
</p>
<p>First, <a href="../en/Kernel_module.html#Automatic_module_loading" class="mw-redirect" title="Load the module at boot">load the module at boot</a>: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modules-load.d/bonding.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">bonding</pre>
<p>Then, configure the options of the <code>bonding</code> driver to use <code>active-backup</code> and configure the <code>primary</code> parameter to the device you want to be the active one (normally the wired interface). Also, be sure to use the same device name as returned when running <code>ip link</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/bonding.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">options bonding mode=active-backup miimon=100 primary=eth0 max_bonds=0</pre>
<p>The <code>miimon</code> option is needed, for the link failure detection. The <code>max_bonds</code> option avoids the <code>Interface bond0 already exists</code> error. More information can be obtained on the <a rel="nofollow" class="external text" href="https://docs.kernel.org/networking/bonding.html">kernel documentation</a>.
</p>
<p>Next, configure a netctl profile to enslave the two hardware interfaces. Use the name of all the devices you want to enslave. If you have more than two wired or wireless interfaces, you can enslave all of them on a bond interface. But, for most cases you will have only two devices, a wired and a wireless one:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/netctl/failover</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Description='A wired connection with failover to wireless'
Interface='bond0'
Connection=bond
BindsToInterfaces=('eth0' 'wlan0')
IP='dhcp'</pre>
<p>Disable any other profiles (specially a wired or wireless) you had enabled before and then enable the failover profile on startup:
</p>
<pre># netctl enable failover
</pre>
<p>Now you need to configure <i>wpa_supplicant</i> to connect to any known network you wish. You should create a file for each interface and enable it on systemd. Create the following file with this content:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/wpa_supplicant/wpa_supplicant-wlan0.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">ctrl_interface=/run/wpa_supplicant
update_config=1</pre>
<p>And append to the end of this file any network you want to connect to: 
</p>
<pre>network={
    ssid="SSID"
    psk=PSK
}
</pre>
<p>To generate the obfuscated PSK you can run <i>wpa_passphrase</i> as on the <a href="../en/Wpa_supplicant.html#Connecting_with_wpa_passphrase" title="Wpa supplicant">wpa_supplicant#Connecting with wpa_passphrase</a> page.
</p>
<p>Now, <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">enable</a> the <code>wpa_supplicant@</code> template service on the network interface, for example <code>wpa_supplicant@wlan0</code>.
</p>
<p>You can try now to reboot your machine and see if your configuration worked.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you get this error on boot bonding:
<pre>wlan0 is up - this may be due to an out of date ifenslave
</pre>
<p>Then this is happening because the <i>wpa_supplicant</i> is being run before the <code>failover</code> netctl profile. This happens because <a href="../en/Systemd.html" title="Systemd">systemd</a> runs everything in parallel, unless told otherwise. <i>ifenslave</i> need all the interfaces to be down before bonding them to the <code>bond0</code> interface. And, since the <i>wpa_supplicant</i> need to put the interface up to be able to scan for networks, this might cause the interface to not be enslaved and your bonding to only have the wired interface.
</p>
<p>If this is your case, then you will need to setup a custom dependency on the <code>wpa_supplicant@wlan0</code> service in relation with the <code>netctl@failover</code> profile. More specifically, the <i>wpa_supplicant</i> must be started <b>after</b> the netctl profile. To accomplish this, create a custom dependency file based on the instructions provided here: <a href="../en/Systemd.html#Handling_dependencies" title="Systemd">systemd#Handling dependencies</a>
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/wpa_supplicant@wlan0.service.d/customdependency.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
After=netctl@failover.service</pre>
<p>After that you can try to reboot your system again and see if it works. You can check the status of your bonding by checking <a href="../en/Systemd/Journal.html" class="mw-redirect" title="Journalctl">journalctl</a> for the <code>netctl@failover.service</code> unit.
</p>
<p>And by checking:
</p>
<pre># ip link
</pre>
<p>You should see something like this:
</p>
<pre>1: eth0: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast master bond0 state UP mode DEFAULT group default qlen 1000
    link/ether xx:xx:xx:xx:xx:xx brd ff:ff:ff:ff:ff:ff
2: wlan0: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc mq master bond0 state UP mode DORMANT group default qlen 1000
    link/ether xx:xx:xx:xx:xx:xx brd ff:ff:ff:ff:ff:ff
3: bond0: &lt;BROADCAST,MULTICAST,MASTER,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP mode DEFAULT group default 
    link/ether xx:xx:xx:xx:xx:xx brd ff:ff:ff:ff:ff:ff
</pre>
</div>
<p>Now, you can test your failover setup, by initiating a big download. Unplug your wired interface. Your download should keep going over the wireless interface. Then, plug your wired interface again and it should keep working. You can debug by checking <a href="../en/Systemd/Journal.html" class="mw-redirect" title="Journalctl">journalctl</a> for the <code>netctl@failover.service</code> and <code>wpa_supplicant@wlan0.service</code> units.
</p>
<h3><span class="mw-headline" id="Using_any_interface">Using any interface</span></h3>
<p>In some cases it may be desirable to allow a profile to use any interface on the system. A common example use case is using a common disk image across many machines with differing hardware (this is especially useful if they are headless). If you use the kernel's naming scheme, and your machine has only one ethernet interface, you can probably guess that eth0 is the right interface. If you use udev's <a rel="nofollow" class="external text" href="https://systemd.io/PREDICTABLE_INTERFACE_NAMES/">Predictable Network Interface Names</a>, however, names will be assigned based on the specific hardware itself (e.g. enp1s0), rather than simply the order that the hardware was detected (e.g. eth0, eth1). This means that a netctl profile may work on one machine and not another, because they each have different interface names.
</p>
<p>A quick and dirty solution is to make use of the <code>/etc/netctl/interfaces/</code> directory. Choose a name for your interface alias (<code>en-any</code> in this example), and write the following to a file with that name (making sure it is <a href="../en/Help:Reading.html#Make_executable" class="mw-redirect" title="Executable">executable</a>).
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/netctl/interfaces/en-any</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh
for interface in /sys/class/net/en*; do
        break;
done
Interface=$(basename "$interface")
echo "en-any: using interface $Interface";</pre>
<p>Then create a profile that uses the interface. Pay special attention to the <code>Interface</code> directive. The rest are only provided as examples.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/netctl/wired</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Description='Wired'
Interface=en-any
Connection=ethernet
IP=static
Address=('192.168.1.15/24')
Gateway='192.168.1.1'
DNS=('192.168.1.1')
</pre>
<p>When the <code>wired</code> profile is started, any machine using the two files above will automatically bring up and configure the first ethernet interface found on the system, regardless of what name udev assigned to it. Note that this is not the most robust way to go about configuring interfaces. If you use multiple interfaces, netctl may try to assign the same interface to them, and will likely cause a disruption in connectivity. If you do not mind a more complicated solution, <code>netctl-auto</code> is likely to be more reliable.
</p>
<h3><span class="mw-headline" id="Using_hooks">Using hooks</span></h3>
<p>netctl supports hooks in <code>/etc/netctl/hooks/</code> and per interface hooks in <code>/etc/netctl/interfaces/</code>. You can set any option in a hook/interface that you can
in a profile. Most importantly this includes <code>ExecUpPost</code> and <code>ExecDownPre</code>. 
</p>
<p>When a profile is read, netctl sources <b>all executable</b> scripts in <code>hooks</code>, then it reads the profile file for the connection and finally it sources an executable script with the name of the interface used in the profile from the <code>interfaces</code> directory. Therefore, declarations in an interface script override declarations in the profile, which override declarations in hooks. 
</p>
<p>The variables <code>$INTERFACE</code> and <code>$ACTION</code> are available in hooks/interfaces <b>only</b> when using <code>netctl-auto</code>
</p>
<h4><span class="mw-headline" id="Examples">Examples</span></h4>
<h5><span class="mw-headline" id="Execute_commands_on_established_connection">Execute commands on established connection</span></h5>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/netctl/hooks/myservices</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh
ExecUpPost="systemctl start crashplan.service; systemctl start dropbox@&lt;username&gt;.service"
ExecDownPre="systemctl stop crashplan.service; systemctl stop dropbox@&lt;username&gt;.service"
</pre>
<h5><span class="mw-headline" id="Set_default_DHCP_client">Set default DHCP client</span></h5>
<p>To set or change the DHCP client used for all profiles: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/netctl/hooks/dhcp</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh
DHCPClient='dhclient'
</pre>
<p>Do not forget to make the file <a href="../en/Help:Reading.html#Make_executable" class="mw-redirect" title="Executable">executable</a>.
</p>
<p>Alternatively, it may also be specified for a specific network interface by creating an executable file <code>/etc/netctl/interfaces/&lt;interface&gt;</code> with the following line:
</p>
<pre>DHCPClient='dhclient'
</pre>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-view-fullscreen.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs expansion.</b></p>
<div>
<b>Reason:</b> It would be useful to replace the example with a general hook that executes different actions depending on <code>$ACTION</code> being CONNECT and DISCONNECT. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Netctl.html">Talk:Netctl</a>)</div>
</div>
<h3><span class="mw-headline" id="Minimal_WPAConfigSection">Minimal WPAConfigSection</span></h3>
<p>As stated in <span class="plainlinks archwiki-template-man" title="$ man 5 netctl.profile"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/netctl.profile.5#OPTIONS_FOR_%E2%80%98WIRELESS%E2%80%99_CONNECTIONS">netctl.profile(5) § OPTIONS FOR ‘WIRELESS’ CONNECTIONS</a></span>, the <code>WPAConfigSection</code> variable is an array of configuration lines passed to <a href="../en/Wpa_supplicant.html" title="Wpa supplicant">wpa_supplicant</a>. So, a minimal WPAConfigSection would contain:
</p>
<pre>Description='A wireless connection using a custom network block configuration'
Interface=wlan0
Connection=wireless
Security=wpa-configsection
IP=dhcp
WPAConfigSection=(
    'ssid="University"'
    'psk="very secret passphrase"'
)
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If trying to connect to an SSID with non-ASCII characters (unicode, emoji, etc), you can specify the SSID as hex instead of as a string, e.g. <code>ssid=F09F90BA</code> for "🐺". When unsure on the hex encoding, run <i>wifi-menu</i> (be sure to remove the \ and x characters).</div>
<h3>
<span id=".2Fetc.2Fresolv.conf"></span><span class="mw-headline" id="/etc/resolv.conf">/etc/resolv.conf</span>
</h3>
<p>If you use <code>DNS*</code> options in your profile, <i>netctl</i> calls <a href="../en/Openresolv.html" class="mw-redirect" title="Resolvconf">resolvconf</a> to overwrite <a href="../en/Domain_name_resolution.html" class="mw-redirect" title="Resolv.conf">resolv.conf</a>.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3>
<span id="Job_for_netctl.40wlan.28....29.service_failed"></span><span class="mw-headline" id="Job_for_netctl@wlan(...).service_failed">Job for netctl@wlan(...).service failed</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> This section assumes that there is no other network service running before starting a <i>netctl</i> profile/service. See <a href="#Installation">#Installation</a> for details.</div>
<p>Some people have an issue when they connect to a network with <i>netctl</i>, for example:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># netctl start wlan0-ssid</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Job for netctl@wlan0\x2ssid.service failed. See 'systemctl status netctl@wlan0\x2ssid.service' and 'journalctl -xn' for details.
</pre>
<p>When looking at the journal from running <code>journalctl -xn</code> as root, either of the following are shown:
</p>
<p>1. If your device (<code>wlan0</code> in this case) is up:
</p>
<pre>network[2322]: The interface of network profile 'wlan0-ssid' is already up
</pre>
<p>Setting the interface down should resolve the problem:
</p>
<pre># ip link set wlan0 down
</pre>
<p>Then retry:
</p>
<pre># netctl start wlan0-ssid
</pre>
<p>2. If the error continues, try again after adding the <code>ForceConnect</code> option:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/netctl/wlan0-ssid</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
ForceConnect=yes
</pre>
<p>Save it and try to connect with the profile:
</p>
<pre># netctl start wlan0-ssid
</pre>
<h3><span class="mw-headline" id="dhcpcd:_ipv4_addroute:_File_exists">dhcpcd: ipv4_addroute: File exists</span></h3>
<p>On some systems dhcpcd in combination with netctl causes timeout issues on resume, particularly when having switched networks in the meantime. netctl will report that you are successfully connected but you still receive timeout issues. In this case, the old default route still exists and is not being renewed. A workaround to avoid this misbehaviour is to switch to <a href="#Set_default_DHCP_client">dhclient</a> as the default dhcp client. More information on the issue can be found <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?pid=1399842#p1399842">here</a>.
</p>
<h3><span class="mw-headline" id="DHCP_timeout_issues">DHCP timeout issues</span></h3>
<p>If you are having timeout issues when requesting leases via DHCP you can set the timeout value higher than netctl's 30 seconds by default. Create a file in <code>/etc/netctl/hooks/</code> or <code>/etc/netctl/interfaces/</code>, add <code>TimeoutDHCP=40</code> to it for a timeout of 40 seconds and make the file executable.
</p>
<h3><span class="mw-headline" id="dhcpcd_debugging">dhcpcd debugging</span></h3>
<p>If dhcpcd fails to obtain an address, add the <code>-d</code> option to <code>/usr/lib/netctl/dhcp</code> and then run <code>journalctl -xe</code> as root to view the debugging messages which may indicate, for example, that the IP address offered by the server is rejected by the client after detecting that the IP address is already in use.
</p>
<h3><span class="mw-headline" id="Connection_timeout_issues">Connection timeout issues</span></h3>
<p>If you are having timeout issues that are unrelated to DHCP (on a static ethernet connection for example), and are experiencing errors similar to the following when starting your profile:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># journalctl _SYSTEMD_UNIT=netctl@<i>profile</i>.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Starting network profile '<i>profile</i>'...
No connection found on interface 'eth0' (timeout)
Failed to bring the network up for profile '<i>profile'</i></pre>
<p>Then you should increase carrier and up timeouts by adding <code>TimeoutUp=</code> and <code>TimeoutCarrier=</code> to your profile file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/netctl/<i>profile</i></pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
TimeoutUp=300
TimeoutCarrier=300
</pre>
<p>Do not forget to reenable your profile:
</p>
<pre># netctl reenable <i>profile</i>
</pre>
<h3><span class="mw-headline" id="Problems_with_netctl-auto_on_resume">Problems with netctl-auto on resume</span></h3>
<p>Sometimes <i>netctl-auto</i> fails to reconnect when the system resumes from suspend, hibernate or hybrid-sleep. An easy solution is to restart the service for <i>netctl-auto</i>. 
This can be automated with an additional service like the following (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/netctl-auto-resume/">netctl-auto-resume</a></span><sup><small>AUR</small></sup><sup>[<a href="../en/Help:Procedures.html#Fix_broken_package_links" title="Help:Procedures">broken link</a>: package not found]</sup>):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/netctl-auto-resume@.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=restart netctl-auto on resume.
Requisite=netctl-auto@%i.service
After=sleep.target

[Service]
Type=oneshot
ExecStart=/usr/bin/systemctl restart netctl-auto@%i.service

[Install]
WantedBy=sleep.target
</pre>
<p>To <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">enable</a> this service for your wireless card, for example, enable <code>netctl-auto-resume@wlan0.service</code> as root. Change <code>wlan0</code> to the required network interface.
</p>
<p>If the device is not yet running on resume when the unit is started, this will fail. It can be fixed by adding the following dependency in the <i>After</i> line:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/netctl-auto-resume@.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
After=sleep.target sys-subsystem-net-devices-%i.device
...
</pre>
<h3><span class="mw-headline" id="netctl-auto_does_not_automatically_unblock_a_wireless_card_to_use_an_interface">netctl-auto does not automatically unblock a wireless card to use an interface</span></h3>
<p>Many laptops have a hardware button (or switch) to turn off wireless card, however, the card can also be blocked by the kernel. This can be handled by <a href="../en/Network_configuration/Wireless.html#Rfkill_caveat" class="mw-redirect" title="Rfkill">rfkill</a>.
</p>
<p>If you want <i>netctl-auto</i> to automatically unblock your wireless card to connect to a particular network, set <code>RFKill=++auto++</code> option for the wireless connection of your choice, as specified in the <span class="plainlinks archwiki-template-man" title="$ man 5 netctl.profile"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/netctl.profile.5">netctl.profile(5)</a></span>.
</p>
<h3>
<span id="RTNETLINK_answers:_File_exists_.28with_multiple_NICs.29"></span><span class="mw-headline" id="RTNETLINK_answers:_File_exists_(with_multiple_NICs)">RTNETLINK answers: File exists (with multiple NICs)</span>
</h3>
<p>This is a very misleading response, it really means that you have assigned a default gateway in an earlier netctl control file. When netctl starts up the n-th NIC and goes to set its local route, it fails because there is already a default route from n-1.
</p>
<p>Remove it and everything works, except you no longer have a default route and so cannot access things such as the internet. <code>ExecUpPost</code> does not work as it gets executed for each network card.
</p>
<p>A possible solution is creating a new service.  Replace "FIRST_INTERFACE" and "SECOND_INTERFACE" with your interface names, and replace "192.168.xxx.yyy" with your default gateway.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/defaultrouter.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description="Configure default gateway"
Requires=netctl@FIRST_INTERFACE.service netctl@SECOND_INTERFACE.service
After=netctl@FIRST_INTERFACE.service netctl@SECOND_INTERFACE.service

[Service]
Type=oneshot
ExecStart=/usr/bin/ip route add default via 192.168.xxx.yyy

[Install]
WantedBy=network-online.target
</pre>
<h3><span class="mw-headline" id="Problems_with_eduroam_and_other_MSCHAPv2_connections">Problems with eduroam and other MSCHAPv2 connections</span></h3>
<p>See <a href="../en/Wpa_supplicant.html#Problems_with_eduroam_and_other_MSCHAPv2_connections" title="Wpa supplicant">wpa_supplicant#Problems with eduroam and other MSCHAPv2 connections</a>.
</p>
<h3><span class="mw-headline" id="Journal_warnings_for_profiles_using_.include_directives">Journal warnings for profiles using .include directives</span></h3>
<p>Profiles still using systemd's old <code>.include</code> directives will produce journal warnings, for example:
</p>
<pre>systemd[1]: /etc/systemd/system/netctl@&lt;profile&gt;.service:1: .include directives are deprecated, and support for them will be removed in a future version of systemd. Please use drop-in files instead.
</pre>
<p>See <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/59494">FS#59494</a> for details.
</p>
<p>Executing
</p>
<pre>netctl reenable <i>profile</i>
</pre>
<p>will update the profile to the new <a href="../en/Systemd.html#Drop-in_files" class="mw-redirect" title="Drop-in unit file">drop-in unit file</a> format.
</p>
<h3><span class="mw-headline" id="Hooks_do_not_work">Hooks do not work</span></h3>
<p>If you have multiple hooks in <code>/etc/netctl/hooks/</code>, variables like <code>ExecUpPost</code> and <code>ExecDownPre</code> will be executed only from one file. To fix this, define the variables like this:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/netctl/hooks/test</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">ExecUpPost="some command ; "$ExecUpPost
ExecDownPre="some command ; "$ExecDownPre
</pre>
<p>This will append your commands to be executed with already defined ones.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://lists.archlinux.org/archives/list/arch-projects@lists.archlinux.org/message/KLCFCAMJQSJBC2UFRXAQZ2YW2JUSHN7O/">Initial mailing list announcement</a></li>
<li><a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=157670">Official announcement thread</a></li>
<li><a rel="nofollow" class="external text" href="https://archlinux.org/news/netctl-is-now-in-core/">Official news announcement</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Network_managers.html" title="Category:Network managers">Network managers</a></li>
<li><a href="../en/Category:Arch_projects.html" title="Category:Arch projects">Arch projects</a></li>
<li><a href="../en/Category:Commands.html" title="Category:Commands">Commands</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_with_broken_package_links.html" title="Category:Pages with broken package links">Pages with broken package links</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Netctl&amp;oldid=801616">https://wiki.archlinux.org/index.php?title=Netctl&amp;oldid=801616</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 28 February 2024, at 21:35.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
