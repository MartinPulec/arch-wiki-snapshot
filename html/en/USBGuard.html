<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-os vector-sticky-header-enabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>USBGuard - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.45.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-USBGuard rootpage-USBGuard skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Installation</span>
			</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Configuration</span>
			</div>
		</a>
		
			<button aria-controls="toc-Configuration-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configuration subsection</span>
			</button>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
			<li id="toc-Rules" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Rules">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1</span>
					<span>Rules</span>
				</div>
			</a>
			
			<ul id="toc-Rules-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Usage" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Usage">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Usage</span>
			</div>
		</a>
		
			<button aria-controls="toc-Usage-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Usage subsection</span>
			</button>
		
		<ul id="toc-Usage-sublist" class="vector-toc-list">
			<li id="toc-CLI" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#CLI">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1</span>
					<span>CLI</span>
				</div>
			</a>
			
			<ul id="toc-CLI-sublist" class="vector-toc-list">
				<li id="toc-Allow_Bluetooth_controllers" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Allow_Bluetooth_controllers">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1.1</span>
					<span>Allow Bluetooth controllers</span>
				</div>
			</a>
			
			<ul id="toc-Allow_Bluetooth_controllers-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-GNOME_integration" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#GNOME_integration">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2</span>
					<span>GNOME integration</span>
				</div>
			</a>
			
			<ul id="toc-GNOME_integration-sublist" class="vector-toc-list">
				<li id="toc-Grant_GNOME_access_to_the_USBGuard_daemon" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Grant_GNOME_access_to_the_USBGuard_daemon">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.1</span>
					<span>Grant GNOME access to the USBGuard daemon</span>
				</div>
			</a>
			
			<ul id="toc-Grant_GNOME_access_to_the_USBGuard_daemon-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Turn_GNOME_USB_Protection_on" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Turn_GNOME_USB_Protection_on">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.2</span>
					<span>Turn GNOME USB Protection on</span>
				</div>
			</a>
			
			<ul id="toc-Turn_GNOME_USB_Protection_on-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Block_all_USB_devices_by_default" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Block_all_USB_devices_by_default">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.3</span>
					<span>Block all USB devices by default</span>
				</div>
			</a>
			
			<ul id="toc-Block_all_USB_devices_by_default-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Related_projects" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Related_projects">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">4</span>
				<span>Related projects</span>
			</div>
		</a>
		
		<ul id="toc-Related_projects-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">5</span>
				<span>See also</span>
			</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar no-font-mode-scale">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left" title="Table of Contents">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">USBGuard</span></h1>
							
</header>
				<div class="vector-column-end no-font-mode-scale">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<p><a rel="nofollow" class="external text" href="https://github.com/dkopecek/usbguard">USBGuard</a> offers a white/black-listing mechanism for USB-devices. Inspiration for this is drawn from exploits like BadUSB.
It makes use of a device blocking infrastructure included in the Linux kernel and consists of a daemon and some front-ends.
</p>
<meta property="mw:PageProp/toc">
<div class="mw-heading mw-heading2"><h2 id="Installation">Installation</h2></div>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=usbguard">usbguard</a></span> package.
</p>
<p>The official <a href="../en/Qt.html" title="Qt">Qt</a> applet was <a rel="nofollow" class="external text" href="https://github.com/USBGuard/usbguard/releases/tag/usbguard-0.7.5">removed</a> from USBGuard and <a rel="nofollow" class="external text" href="https://usbguard.github.io/blog/2019/usbguard-0.7.6">substituted</a> with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/usbguard-notifier/">usbguard-notifier</a></span><sup><small>AUR</small></sup>. An unofficial, forked version of the Qt applet is available as <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/usbguard-qt/">usbguard-qt</a></span><sup><small>AUR</small></sup>.
</p>
<div class="mw-heading mw-heading2"><h2 id="Configuration">Configuration</h2></div>
<p>The main configuration file is found in <code>/etc/usbguard/usbguard-daemon.conf</code>.
</p>
<p>If you want to control the daemon via IPC, be sure to add your username to <code>IPCAllowedUsers</code> or your group to <code>IPCAllowedGroups</code> to make rules persistent. In most cases, you want this.
</p>
<p>By default, the <code>PresentDevicePolicy</code> is set to <code>apply-policy</code> so that USBGuard evaluates the ruleset for every connected device. This is the most secure setting, which ensures security even when the daemon hits a restart. Alternatively, the key may be set to <code>allow</code> in order to block all newly connected devices but leave devices connected before daemon as is. To temporary allow new devices use <code>usbguard set-parameter ImplicitPolicyTarget allow</code>.
</p>
<p>With the key <code>ImplicitPolicyTarget</code> you can configure the default treatment of devices, if no rules match. The most secure option here is <code>block</code>.
</p>
<p>For an in-depth documentation of configuration see the very well commented configuration file.
</p>
<div class="mw-heading mw-heading3"><h3 id="Rules">Rules</h3></div>
<p>To configure USBGuard to your needs, you can edit <code>/etc/usbguard/rules.conf</code>. However manual editing of the rules is normally not necessary. You can generate a ruleset based on your currently attached USB devices by executing <code>usbguard generate-policy &gt; /etc/usbguard/rules.conf</code> as root.
</p>
<p>The rules syntax is formally explained <a rel="nofollow" class="external text" href="https://github.com/USBGuard/usbguard/blob/master/doc/man/usbguard-rules.conf.5.adoc">here</a>.
An example for a hp printer connected via USB can look like this:
</p>
<pre>allow id 03f0:0c17 serial "00CNFD234631" name "hp LaserJet 2020" hash "a0ef07fceb6fb77698f79a44a450121m" parent-hash "69d19c1a5733a31e7e6d9530e6k434a6" with-interface { 07:01:03 07:01:02 07:01:01 }
</pre>
<p>A rule begins with a policy. <code>allow</code> whitelists a device, <code>block</code> stops the device from being processed now and <code>reject</code> removes the device from the system.
Then follows a set of attributes with their options, as detailed below.
</p>
<table class="wikitable">
<tbody>
<tr>
<th>Attribute</th>
<th>Description
</th>
</tr>
<tr>
<td>id usb-device-id</td>
<td>Match a USB device ID.
</td>
</tr>
<tr>
<td>id [operator] { usb-device-id ... }</td>
<td>Match a set of USB device IDs.
</td>
</tr>
<tr>
<td>hash "value"</td>
<td>Match a hash computed from the device attribute values and the USB descriptor data. The hash is computed for every device by USBGuard.
</td>
</tr>
<tr>
<td>hash [operator] { "value" ... }</td>
<td>Match a set of device hashes.
</td>
</tr>
<tr>
<td>parent-hash "value"</td>
<td>Match a hash of the parent device.
</td>
</tr>
<tr>
<td>parent-hash [operator] { "value" ... }</td>
<td>Match a set of parent device hashes.
</td>
</tr>
<tr>
<td>name "device-name"</td>
<td>Match the USB device name attribute.
</td>
</tr>
<tr>
<td>name [operator] { "device-name" ... }</td>
<td>Match a set of USB device names.
</td>
</tr>
<tr>
<td>serial "serial-number"</td>
<td>Match the USB iSerial device attribute.
</td>
</tr>
<tr>
<td>serial [operator] { "serial-number" ... }</td>
<td>Match a set of USB iSerial device attributes.
</td>
</tr>
<tr>
<td>via-port "port-id"</td>
<td>Match the USB port through which the device is connected. Note that some systems have unstable port numbering which change after the system reboots or certain kernel modules are reloaded (and maybe in other cases). Use the parent-hash attribute if you want to ensure that a device is connected via a specific parent device.
</td>
</tr>
<tr>
<td>via-port [operator] { "port-id" ... }</td>
<td>Match a set of USB ports.
</td>
</tr>
<tr>
<td>with-interface interface-type</td>
<td>Match an interface type that the USB device provides.
</td>
</tr>
<tr>
<td>with-interface [operator] { interface-type interface-type ... }</td>
<td>Match a set of interface types against the set of interfaces that the USB device provides.
</td>
</tr>
</tbody>
</table>
<div class="mw-heading mw-heading2"><h2 id="Usage">Usage</h2></div>
<p>USBGuard has a core daemon, a CLI, a DBUS interface and an API via libusbguard.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning</strong> Make sure to actually configure the daemon before starting/enabling it or all USB devices, including keyboard and mouse, will immediately be blocked!</div>
<p>If you want to use the Qt GUI or another program communicating via DBUS (which includes the GNOME integration), <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">enable</a> and <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start">start</a> <code>usbguard-dbus.service</code>.
</p>
<p>If you only want to communicate via API (with the CLI tool or another software using libusbguard) <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">enable</a> and <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start">start</a> <code>usbguard.service</code>.
</p>
<div class="mw-heading mw-heading3"><h3 id="CLI">CLI</h3></div>
<p>The CLI is available via <code>usbguard</code>.
</p>
<p>See the according man pages for more info.
</p>
<div class="mw-heading mw-heading4"><h4 id="Allow_Bluetooth_controllers">Allow Bluetooth controllers</h4></div>
<p>If USBGuard is set to block all USB devices by default, it will also block <code>btusb</code> controllers by default since they communicate using a USB bus. Since many motherboards' Bluetooth cards are <code>btusb</code> controllers, it may not be obvious that Bluetooth is blocked by USBGuard. For Bluetooth to work, you need to set USBGuard to allow these <code>btusb</code> controllers.
</p>
<p>Find and display information about the USB buses in
the system using <code>lsusb</code> (part of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=usbutils">usbutils</a></span>). This should display something like
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"> $ lsusb</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Bus 001 Device 001: ID 0000:0001 Linux Foundation 2.0 root hub
Bus 001 Device 002: ID 0000:0002 Intel Corp. Bluetooth 9460/9560 Jefferson Peak (JfP)
Bus 002 Device 001: ID 0000:0003 Linux Foundation 3.0 root hub
</pre>
<p>We are interested in the Bluetooth device. Note its ID (in this case, <code>0000:0002</code>, but this may vary)
and set USBGuard to allow this ID:
</p>
<pre># usbguard allow-device -p 0000:0002
</pre>
<div class="mw-heading mw-heading3"><h3 id="GNOME_integration">GNOME integration</h3></div>
<p><a href="../en/GNOME.html" title="GNOME">GNOME</a> has had USBGuard support baked in <a rel="nofollow" class="external text" href="https://www.phoronix.com/scan.php?page=news_item&amp;px=GNOME-3.35.91-Released">since 3.36</a>. It requires <a href="../en/Polkit.html" title="Polkit">polkit</a> rule configuration to grant GNOME access, and <a href="../en/GNOME.html#Configuration" class="mw-redirect" title="Dconf">dconf</a> modification to always block devices as the default is set to allow and only block on lockscreen.
</p>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Inaccurate.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>The factual accuracy of this article or section is disputed.</b></p>
<div>
<b>Reason:</b> Is the warning still correct, or did GNOME change to default allow HID devices?<a rel="nofollow" class="external autonumber" href="https://pulsesecurity.co.nz/advisories/usbguard-bypass#Real-World%20Impact%20(Gnome%20Desktop)">[1]</a> (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:USBGuard.html">Talk:USBGuard</a>)</div>
</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning</strong> Make sure to actually generate a policy first (see <a href="#Usage">#Usage</a> and <a href="#Rules">#Rules</a>) or all USB devices will immediately be blocked, including keyboard and mouse input!</div>
<div class="mw-heading mw-heading4"><h4 id="Grant_GNOME_access_to_the_USBGuard_daemon">Grant GNOME access to the USBGuard daemon</h4></div>
<p>Authorize GNOME Shell running under users with the <code>wheel</code> group assigned access to USBGuard, by creating the following file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/polkit-1/rules.d/70-allow-usbguard.rules</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">// Allow users in wheel group to communicate with USBGuard
polkit.addRule(function(action, subject) {
    if ((action.id == "org.usbguard.Policy1.listRules" ||
         action.id == "org.usbguard.Policy1.appendRule" ||
         action.id == "org.usbguard.Policy1.removeRule" ||
         action.id == "org.usbguard.Devices1.applyDevicePolicy" ||
         action.id == "org.usbguard.Devices1.listDevices" ||
         action.id == "org.usbguard1.getParameter" ||
         action.id == "org.usbguard1.setParameter") &amp;&amp;
        subject.active == true &amp;&amp; subject.local == true &amp;&amp;
        subject.isInGroup("wheel")) {
            return polkit.Result.YES;
    }
});</pre>
<p>Changes to polkit rules are picked up automatically by the polkit daemon itself.
</p>
<div class="mw-heading mw-heading4"><h4 id="Turn_GNOME_USB_Protection_on">Turn GNOME USB Protection on</h4></div>
<p>If the USBGuard service is present and this setting is enabled, USB devices will be protected as configured in the usb-protection-level setting. Enable it by running the command below:
</p>
<pre>$ gsettings set org.gnome.desktop.privacy usb-protection true</pre>
<div class="mw-heading mw-heading4"><h4 id="Block_all_USB_devices_by_default">Block all USB devices by default</h4></div>
<p>If set to <code>lockscreen</code>, only when the lock screen is present new USB devices will be rejected; if set to <code>always</code>, all new USB devices will always be rejected. Reject all new USB devices by running the command below:
</p>
<pre>$ gsettings set org.gnome.desktop.privacy usb-protection-level always</pre>
<div class="mw-heading mw-heading2"><h2 id="Related_projects">Related projects</h2></div>
<ul>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/usbkill-git/">usbkill-git</a></span><sup><small>AUR</small></sup> (an anti-forensic kill-switch that waits for a change on your USB ports and then immediately shuts down your computer)</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/silk-guardian-dkms/">silk-guardian-dkms</a></span><sup><small>AUR</small></sup> (kill switch for unknown usb devices (DKMS))</li>
</ul>
<div class="mw-heading mw-heading2"><h2 id="See_also">See also</h2></div>
<ul>
<li><a rel="nofollow" class="external text" href="https://github.com/dkopecek/usbguard/">USBGuard repository</a></li>
<li><a rel="nofollow" class="external text" href="https://raw.githubusercontent.com/USBGuard/usbguard/8b76c935f019facd362e2f12a4db5e24f6e58e62/doc/usbguard-component-diagram.png">USBGuard component diagram</a></li>
<li>
<a rel="nofollow" class="external text" href="https://srlabs.de/bites/usb-peripherals-turn/">BadUSB background info</a><sup>[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2025-11-17—HTTP 404]</sup>
</li>
<li><a rel="nofollow" class="external text" href="https://docs.kernel.org/usb/authorization.html">Kernel interface for USB device control</a></li>
<li><a rel="nofollow" class="external text" href="https://wiki.gnome.org/Internships(2f)2018(2f)Projects(2f)USB(2d)Protection.html">GNOME USB Protection background info</a></li>
<li><a rel="nofollow" class="external text" href="https://gitlab.gnome.org/GNOME/gnome-settings-daemon/-/tree/master/plugins/usb-protection">gnome-settings-daemon usb-protection plugin source</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Hardware_detection_and_troubleshooting.html" title="Category:Hardware detection and troubleshooting">Hardware detection and troubleshooting</a></li>
<li><a href="../en/Category:Security.html" title="Category:Security">Security</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li>
<li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=USBGuard&amp;oldid=853317">https://wiki.archlinux.org/index.php?title=USBGuard&amp;oldid=853317</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 17 November 2025, at 20:35.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><picture><source media="(min-width: 500px)" srcset="/resources/assets/poweredby_mediawiki.svg" width="88" height="31"><img src="/resources/assets/mediawiki_compact.svg" width="25" height="25" loading="lazy"></picture></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-header-container vector-sticky-header-container no-font-mode-scale">
	<div id="vector-sticky-header" class="vector-sticky-header">
		<div class="vector-sticky-header-start">
			<div class="vector-sticky-header-icon-start vector-button-flush-left vector-button-flush-right" aria-hidden="true">
				<button class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-sticky-header-search-toggle" tabindex="-1" data-event-name="ui.vector-sticky-search-form.icon"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
			</button>
		</div>
			
		<div role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box">
			<div class="vector-typeahead-search-container">
				<div class="cdx-typeahead-search cdx-typeahead-search--show-thumbnail">
					<form action="/index.php" id="vector-sticky-search-form" class="cdx-search-input cdx-search-input--has-end-button">
						<div class="cdx-search-input__input-wrapper" data-search-loc="header-moved">
							<div class="cdx-text-input cdx-text-input--has-start-icon">
								<input class="cdx-text-input__input mw-searchInput" autocomplete="off" type="search" name="search" placeholder="Search ArchWiki">
								<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
							</div>
							<input type="hidden" name="title" value="Special:Search">
						</div>
						<button class="cdx-button cdx-search-input__end-button">Search</button>
					</form>
				</div>
			</div>
		</div>
		<div class="vector-sticky-header-context-bar">
				<nav aria-label="Contents" class="vector-toc-landmark">
						
					<div id="vector-sticky-header-toc" class="vector-dropdown mw-portlet mw-portlet-sticky-header-toc vector-sticky-header-toc vector-button-flush-left">
						<input type="checkbox" id="vector-sticky-header-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-sticky-header-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
						<label id="vector-sticky-header-toc-label" for="vector-sticky-header-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
						</label>
						<div class="vector-dropdown-content">
					
						<div id="vector-sticky-header-toc-unpinned-container" class="vector-unpinned-container">
						</div>
					
						</div>
					</div>
			</nav>
				<div class="vector-sticky-header-context-bar-primary" aria-hidden="true"><span class="mw-page-title-main">USBGuard</span></div>
			</div>
		</div>
		<div class="vector-sticky-header-end" aria-hidden="true">
			<div class="vector-sticky-header-icons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-talk-sticky-header" tabindex="-1" data-event-name="talk-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbles mw-ui-icon-wikimedia-speechBubbles"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-subject-sticky-header" tabindex="-1" data-event-name="subject-sticky-header"><span class="vector-icon mw-ui-icon-article mw-ui-icon-wikimedia-article"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-history-sticky-header" tabindex="-1" data-event-name="history-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-history mw-ui-icon-wikimedia-wikimedia-history"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only mw-watchlink" id="ca-watchstar-sticky-header" tabindex="-1" data-event-name="watch-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-star mw-ui-icon-wikimedia-wikimedia-star"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only reading-lists-bookmark" id="ca-bookmark-sticky-header" tabindex="-1" data-event-name="watch-sticky-bookmark"><span class="vector-icon mw-ui-icon-wikimedia-bookmarkOutline mw-ui-icon-wikimedia-wikimedia-bookmarkOutline"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-edit-sticky-header" tabindex="-1" data-event-name="wikitext-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-wikiText mw-ui-icon-wikimedia-wikimedia-wikiText"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-ve-edit-sticky-header" tabindex="-1" data-event-name="ve-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-edit mw-ui-icon-wikimedia-wikimedia-edit"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-viewsource-sticky-header" tabindex="-1" data-event-name="ve-edit-protected-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-editLock mw-ui-icon-wikimedia-wikimedia-editLock"></span>

<span></span>
			</a>
		</div>
			<div class="vector-sticky-header-buttons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive" id="ca-addsection-sticky-header" tabindex="-1" data-event-name="addsection-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbleAdd-progressive mw-ui-icon-wikimedia-speechBubbleAdd-progressive"></span>

<span>Add topic</span>
			</a>
		</div>
			<div class="vector-sticky-header-icon-end">
				<div class="vector-user-links">
				</div>
			</div>
		</div>
	</div>
</div>
<div class="mw-portlet mw-portlet-dock-bottom emptyPortlet" id="p-dock-bottom">
	<ul>
		
	</ul>
</div>
</body>
</html>
