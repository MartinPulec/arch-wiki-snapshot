<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-zebra-design-disabled vector-feature-custom-font-size-clientpref-disabled vector-feature-client-preferences-disabled vector-feature-typography-survey-disabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>EncFS - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.41.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-EncFS rootpage-EncFS skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-main-menu-container">
		</div>
	<input type="checkbox" id="vector-toc-collapsed-checkbox" class="vector-menu-checkbox">
			<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark vector-sticky-pinned-container">
				<div id="vector-toc-pinned-container" class="vector-pinned-container">
				<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Comparison_to_eCryptFS" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Comparison_to_eCryptFS">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Comparison to eCryptFS</div>
		</a>
		
		<ul id="toc-Comparison_to_eCryptFS-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Installation</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Usage" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Usage">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Usage</div>
		</a>
		
			<button aria-controls="toc-Usage-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Usage subsection</span>
			</button>
		
		<ul id="toc-Usage-sublist" class="vector-toc-list">
			<li id="toc-Changing_the_password" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Changing_the_password">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>Changing the password</div>
			</a>
			
			<ul id="toc-Changing_the_password-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-User_friendly_mounting" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#User_friendly_mounting">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>User friendly mounting</div>
		</a>
		
			<button aria-controls="toc-User_friendly_mounting-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle User friendly mounting subsection</span>
			</button>
		
		<ul id="toc-User_friendly_mounting-sublist" class="vector-toc-list">
			<li id="toc-Gnome_Encfs_Manager" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Gnome_Encfs_Manager">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>Gnome Encfs Manager</div>
			</a>
			
			<ul id="toc-Gnome_Encfs_Manager-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Mount_using_encfsui" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Mount_using_encfsui">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2</span>Mount using encfsui</div>
			</a>
			
			<ul id="toc-Mount_using_encfsui-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Mount_via_fstab" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Mount_via_fstab">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.3</span>Mount via fstab</div>
			</a>
			
			<ul id="toc-Mount_via_fstab-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Mount_at_login_using_pam_encfs" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Mount_at_login_using_pam_encfs">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4</span>Mount at login using pam_encfs</div>
			</a>
			
			<ul id="toc-Mount_at_login_using_pam_encfs-sublist" class="vector-toc-list">
				<li id="toc-Single_password" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Single_password">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4.1</span>Single password</div>
			</a>
			
			<ul id="toc-Single_password-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-/etc/pam.d/" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#/etc/pam.d/">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4.2</span>/etc/pam.d/</div>
			</a>
			
			<ul id="toc-/etc/pam.d/-sublist" class="vector-toc-list">
				<li id="toc-setup_pam_encfs_for_all_login_methods" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#setup_pam_encfs_for_all_login_methods">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4.2.1</span>setup pam_encfs for all login methods</div>
			</a>
			
			<ul id="toc-setup_pam_encfs_for_all_login_methods-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-login" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#login">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4.2.2</span>login</div>
			</a>
			
			<ul id="toc-login-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-gdm" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#gdm">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4.2.3</span>gdm</div>
			</a>
			
			<ul id="toc-gdm-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Configuration">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4.2.4</span>Configuration</div>
			</a>
			
			<ul id="toc-Configuration-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Mount_at_login_using_pam_mount" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Mount_at_login_using_pam_mount">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.5</span>Mount at login using pam_mount</div>
			</a>
			
			<ul id="toc-Mount_at_login_using_pam_mount-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Encrypted_backup" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Encrypted_backup">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Encrypted backup</div>
		</a>
		
			<button aria-controls="toc-Encrypted_backup-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Encrypted backup subsection</span>
			</button>
		
		<ul id="toc-Encrypted_backup-sublist" class="vector-toc-list">
			<li id="toc-Backup_encrypted_directory" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Backup_encrypted_directory">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1</span>Backup encrypted directory</div>
			</a>
			
			<ul id="toc-Backup_encrypted_directory-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Backup_plaintext_directory" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Backup_plaintext_directory">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2</span>Backup plaintext directory</div>
			</a>
			
			<ul id="toc-Backup_plaintext_directory-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

				</div>
	</nav>
		
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<label id="vector-toc-collapsed-button" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet vector-button-flush-left cdx-button--icon-only" for="vector-toc-collapsed-checkbox" role="button" aria-controls="vector-toc" tabindex="0" title="Table of Contents">
						<span class="vector-icon mw-ui-icon-wikimedia-listBullet"></span>
						<span>Toggle the table of contents</span>
					</label>
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">EncFS</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 2 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-2" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">2 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-es mw-list-item"><a href="../es/EncFS.html" title="EncFS – español" lang="es" hreflang="es" class="interlanguage-link-target"><span>Español</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/EncFS" title="EncFS – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<nav class="vector-page-tools-landmark vector-sticky-pinned-container" aria-label="Page tools">
						<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
			
						</div>
	</nav>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr">
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/Gocryptfs.html" title="Gocryptfs">gocryptfs</a></li>
<li><a href="../en/ECryptfs.html" title="ECryptfs">eCryptfs</a></li>
<li><a href="../en/Data-at-rest_encryption.html" title="Data-at-rest encryption">Data-at-rest encryption</a></li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> A <a rel="nofollow" class="external text" href="https://defuse.ca/audits/encfs.htm">security review</a> (February 2014) of <i>encfs</i> discovered a number of security issues (in the stable release 1.7.4 of 2014). Please consider the report and the references in it for updated information before using the release, since <a rel="nofollow" class="external text" href="https://github.com/vgough/encfs/issues/604#issuecomment-1006599361">the development has halted</a> and <a rel="nofollow" class="external text" href="https://github.com/vgough/encfs/issues/314#issuecomment-288206275">not all issues are fixed</a>.</div>
<p><a href="https://en.wikipedia.org/wiki/EncFS" class="extiw" title="wikipedia:EncFS">EncFS</a> is a userspace stackable cryptographic file-system similar to <a href="../en/ECryptfs.html" title="ECryptfs">eCryptfs</a>, and aims to secure data with the minimum hassle. It uses <a href="https://en.wikipedia.org/wiki/Filesystem_in_Userspace" class="extiw" title="wikipedia:Filesystem in Userspace">FUSE</a> to mount an encrypted directory onto another directory specified by the user. It does not use a loopback system like some other comparable systems such as <a href="../en/VeraCrypt.html" class="mw-redirect" title="TrueCrypt">TrueCrypt</a> and <a href="../en/Dm-crypt.html" title="Dm-crypt">dm-crypt</a>.
</p>
<p>EncFS is definitely the simplest software if you want to try disk encryption on Linux.
</p>
<p>Advantages of EncFS: Firstly, it does not require any root privileges to implement; any user can create a repository of encrypted files. Secondly, one does not need to create a single file and create a file-system within that; it works on existing file-system without modifications.
</p>
<p>Disadvantages: The encrypted files are not stored in their own file, someone who obtains access to the system can still see the underlying directory structure, the number of files, their sizes and when they were modified. They cannot see the contents, however.
</p>
<p>This particular method of securing data is obviously not perfect, but there are situations in which it is useful.
</p>
<p>For more details on how EncFS compares to other disk encryption solution, see <a href="../en/Data-at-rest_encryption.html#Comparison_table" title="Data-at-rest encryption">Data-at-rest encryption#Comparison table</a>.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Comparison_to_eCryptFS">Comparison to eCryptFS</span></h2>
<p><a href="../en/ECryptfs.html" class="mw-redirect" title="System Encryption with eCryptfs">eCryptFS</a> is implemented in kernelspace and therefore a little bit harder to configure. You have to remember various encryption options (used cyphers, key type, etc...). With EncFS this is not the case, because it stores the encryption metadata information in a per-directory configuration file (<code>.encfs6.xml</code>). So you do not have to remember anything (except the passphrase). 
</p>
<p>The performance of both depends on the type of disk activity. While eCryptFS can perform faster in some cases because there is less overhead by context switching (between kernel and userspace), EncFS has advantages in other cases because the encryption metadata is centralized and not stored in the individual files' headers. For more information <a rel="nofollow" class="external text" href="https://github.com/vgough/encfs/blob/master/PERFORMANCE.md">benchmark examples</a> are provided by the EncFS project.
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=encfs">encfs</a></span> package.
</p>
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
<p>To create a secured repository, type:
</p>
<pre>$ encfs ~/.<i>encrypted</i> ~/<i>origin</i>
</pre>
<p>Note that absolute paths must be used. This will be followed by a prompt about whether you want to go with the default options, expert configuration or a paranoid preset. The first is a fairly secure default setup. The second allows specifying algorithms and other options. After entering a key for the encryption, the encoded file-system will be created and mounted. The encoded files are stored, in this example, at <code>~/.<i>encrypted</i></code>, and their unencrypted versions in <code>~/<i>origin</i></code>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> Using EncFS on a FUSE <a href="../en/File_systems.html" class="mw-redirect" title="File system">file system</a>, e.g. <a href="../en/NTFS-3G.html" title="NTFS-3G">NTFS-3G</a>, might end up with slow performance. Consider changing the file system if possible.</div> 
<p>To unmount the file-system, type:
</p>
<pre>$ fusermount -u ~/<i>name</i>
</pre>
<p>To remount the file-system, issue the first command, and enter the key used to encode it. Once this has been entered, the file-system will be mounted again.
</p>
<h3><span class="mw-headline" id="Changing_the_password">Changing the password</span></h3>
<p>To change the password of a directory encrypted by EncFS, the following command can be used:
</p>
<pre>$ encfsctl passwd ~/.<i>name</i>
</pre>
<p>In this example, <code>~/.<i>name</i></code> is the path to the directory which contains the encoded files. The tool will ask for your current password and afterwards, you will be able to set a new one.
</p>
<h2><span class="mw-headline" id="User_friendly_mounting">User friendly mounting</span></h2>
<h3><span class="mw-headline" id="Gnome_Encfs_Manager">Gnome Encfs Manager</span></h3>
<p>The <a rel="nofollow" class="external text" href="http://libertyzero.com/GEncfsM/">Gnome Encfs Manager</a> is an easy to use manager and mounter for encfs stashes featuring per-stash configuration, Gnome Keyring support, a tray menu inspired by Cryptkeeper but using the AppIndicator API and lots of unique features. 
</p>
<p>Both <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/gnome-encfs-manager-bin/">gnome-encfs-manager-bin</a></span><sup><small>AUR</small></sup> and a slightly more up to date <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/gnome-encfs-manager-bzr/">gnome-encfs-manager-bzr</a></span><sup><small>AUR</small></sup> are available.
</p>
<h3><span class="mw-headline" id="Mount_using_encfsui">Mount using encfsui</span></h3>
<p>A bash script <a rel="nofollow" class="external text" href="https://github.com/bulletmark/encfsui">encfsui</a> provides a simple <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=zenity">zenity</a></span> gui around the EncFS command line utility to mount and unmount an encrypted directory. It includes a desktop launcher. Install it from <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/encfsui/">encfsui</a></span><sup><small>AUR</small></sup>.
</p>
<h3><span class="mw-headline" id="Mount_via_fstab">Mount via fstab</span></h3>
<p>Adding an entry in <code>/etc/fstab</code> will allow you to mount the encfs volume with a simple <code>mount /target/path</code> and you will be prompted for your password.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/fstab</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">encfs#/path/to/encfs/data  /mnt/decrypted  fuse  noauto,user  0  0
</pre>
<p>The <code>noauto</code> option prevents an attempt to mount the volume at boot, which could delay the boot process while it waits for a password to be entered.  <code>user</code> can be omitted if only the <code>root</code> user should be able to mount the volume.
</p>
<h3><span class="mw-headline" id="Mount_at_login_using_pam_encfs">Mount at login using pam_encfs</span></h3>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:View-refresh-red.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section is out of date.</b></p>
<div>
<b>Reason:</b> The instructions are based on a very old version of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pambase">pambase</a></span> and confusing for that reason, they need to be reviewed/shortened to the <code>/etc/pam.d/</code> changes required to add the module. The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pam_encfs/">pam_encfs</a></span><sup><small>AUR</small></sup> package was updated 2010 last, the template may alternatively also be changed to <a href="../en/Template:Remove.html" title="Template:Remove">Template:Remove</a>, since <a href="#Mount_at_login_using_pam_mount">#Mount at login using pam mount</a> is an available alternative. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:EncFS.html">Talk:EncFS</a>)</div>
</div>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pam_encfs/">pam_encfs</a></span><sup><small>AUR</small></sup>. See also:
</p>
<ul>
<li><a rel="nofollow" class="external free" href="https://web.archive.org/web/20160505055352/http://pam-encfs.googlecode.com/svn/trunk/README">https://web.archive.org/web/20160505055352/http://pam-encfs.googlecode.com/svn/trunk/README</a></li>
<li><a rel="nofollow" class="external free" href="https://web.archive.org/web/20160428084352/http://pam-encfs.googlecode.com/svn/trunk/pam_encfs.conf">https://web.archive.org/web/20160428084352/http://pam-encfs.googlecode.com/svn/trunk/pam_encfs.conf</a></li>
<li><a rel="nofollow" class="external free" href="https://wiki.edubuntu.org/EncryptedHomeFolder">https://wiki.edubuntu.org/EncryptedHomeFolder</a></li>
<li><a rel="nofollow" class="external free" href="https://code.google.com/archive/p/pam-encfs/">https://code.google.com/archive/p/pam-encfs/</a></li>
</ul>
<h4><span class="mw-headline" id="Single_password">Single password</span></h4>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Note that if you will use same password (eg.: using try_first_pass or use_first_pass) for login and encfs (so encfs will mount during your login) then you should use <a href="../en/SHA_hashes.html#SHA_password_hashes" class="mw-redirect" title="SHA password hashes">SHA password hashes</a> (Preferably SHA512 with some huge number of rounds) and (which is most important) <b>secure password</b>, because hash of your password is probably stored in unencrypted form in <code>/etc/shadow</code> and it can be cracked in order to get your encfs password (because it is same as your regular unix login password).</div>
<h4>
<span id=".2Fetc.2Fpam.d.2F"></span><span class="mw-headline" id="/etc/pam.d/">/etc/pam.d/</span>
</h4>
<p>Note that when you are using <i>try_first_pass</i> parameter to <i>pam_unix.so</i> then you will have to set EncFS to use same password as you are using to login (or vice-versa) and you will be entering just single password. Without this parameter you will need to enter two passwords.
</p>
<h5><span class="mw-headline" id="setup_pam_encfs_for_all_login_methods">setup pam_encfs for all login methods</span></h5>
<p>Put encfs line to /etc/pam.d/system-login as follows:
</p>
<pre>...
auth       sufficient pam_encfs.so
...
</pre>
<h5><span class="mw-headline" id="login">login</span></h5>
<p>This section tells how to make encfs automount when you are logging in by virtual terminal.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you only want to use it through GDM, you may pass this and go right to the <a href="#gdm">GDM section</a> below.</div>
<p>Edit the file <code>/etc/pam.d/login</code>:
</p>
<pre>#%PAM-1.0

auth		required	pam_securetty.so
auth		requisite	pam_nologin.so
auth		sufficient	pam_encfs.so
auth		required	pam_unix.so nullok try_first_pass
#auth		required	pam_unix.so nullok
auth		required	pam_tally.so onerr=succeed file=/var/log/faillog
# use this to lockout accounts for 10 minutes after 3 failed attempts
#auth		required	pam_tally.so deny=2 unlock_time=600 onerr=succeed file=/var/log/faillog
account		required	pam_access.so
account		required	pam_time.so
account		required	pam_unix.so
#password	required	pam_cracklib.so difok=2 minlen=8 dcredit=2 ocredit=2 retry=3
#password	required	pam_unix.so md5 shadow use_authtok
session		required	pam_unix.so
session		required	pam_env.so
session		required	pam_motd.so
session		required	pam_limits.so
session		optional	pam_mail.so dir=/var/spool/mail standard
session		optional	pam_lastlog.so
session		optional	pam_loginuid.so
-session	optional	pam_ck_connector.so nox11
#Automatic unmount (optional):
#session	required	pam_encfs.so
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Note that automatic unmount will process even when there is another session. eg.: logout on VC can unmount encfs mounted by GDM session that is still active.</div>
<h5><span class="mw-headline" id="gdm">gdm</span></h5>
<p>This section explains how to make encfs automount when you are logging in by GDM.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> For debug purposes you may try automount on virtual console login first. <a href="#login">This article has a section about automount on virtual console login</a>.</div>
<p>Edit the file <code>/etc/pam.d/gdm-password</code>.
</p>
<p>Insert (do not overwrite) the following into the bottom of gdm-password:
</p>
<pre>#%PAM-1.0
auth            requisite       pam_nologin.so
auth            required        pam_env.so
auth            sufficient      pam_encfs.so
auth            required        pam_unix.so try_first_pass
auth            optional        pam_gnome_keyring.so
account         required        pam_unix.so
session         required        pam_limits.so
session         required        pam_unix.so
session         optional        pam_gnome_keyring.so auto_start
password        required        pam_unix.so
session         required        pam_encfs.so
</pre>
<p>Save and exit.
</p>
<h5><span class="mw-headline" id="Configuration">Configuration</span></h5>
<p>Edit <code>/etc/security/pam_encfs.conf</code> :
</p>
<p>Recommended: comment out the line
</p>
<pre>encfs_default --idle=1
</pre>
<p>This flag will unmount your encrypted folder after 1 minute of inactivity.  If you are automounting this on login, you probably would like to keep this mounted for as long as you are logged in.
</p>
<p>At the bottom, comment any existing demo entries and add:
</p>
<pre>#USERNAME       SOURCE                                  TARGET PATH                 ENCFS Options           FUSE Options
foo             /home/foo/EncryptedFolder             /home/foo/DecryptedFolder       -v                    allow_other
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> It is not possible to mount multiple EncFS folders at login using <code>pam_encfs</code>. If multiple entries are specified in <code>/etc/security/pam_encfs.conf</code>, only the first one will be mounted, and the rest will be ignored. To mount multiple EncFS folders at login it is necessary to use <a href="../en/Pam_mount.html" title="Pam mount">pam_mount</a>. See <a href="#Mount_at_login_using_pam_mount">#Mount at login using pam_mount</a> for details.</div>
<p>Also, if you see the following line, remove <code>allow_root</code> from the options. Otherwise, it will be in conflict with <code>allow_other</code> defined above.
</p>
<pre>fuse_default allow_root,nonempty
</pre>
<p>Next, edit <code>/etc/fuse.conf</code>:
Uncomment:
</p>
<pre>user_allow_other

</pre>
<p>To test your config, open a new virtual terminal (e.g. <code>Ctrl+Alt+F4</code>) and login.  You should see pam successfuly mount your EncFS folder.
</p>
<h3><span class="mw-headline" id="Mount_at_login_using_pam_mount">Mount at login using pam_mount</span></h3>
<p>Install and configure <a href="../en/Pam_mount.html" title="Pam mount">pam_mount</a> as explained on its wiki page. EncFS mounts can be specified in pam_mount's configuration file as follows:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/security/pam_mount.conf.xml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">&lt;volume fstype="fuse" path="encfs#<i>/path/to/encfs/encrypted/data</i>" mountpoint="<i>/path/to/decrypted/data/mountpoint</i>" options="nonempty" /&gt;</pre>
<p>The EncFS mounts need to have the same password than your user account. The <code>nonempty</code> option makes it possible to mount the encrypted file system even when the mount point is non-empty. You may remove this option if this is not the desired behaviour.
</p>
<p>It is possible to mount multiple EncFS folders at login specifying multiple consecutive <code>&lt;volume&gt;</code> entries in the configuration file.
</p>
<h2><span class="mw-headline" id="Encrypted_backup">Encrypted backup</span></h2>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> If you follow below examples to separate the encryption options file from the data, you - of course - need to ensure you have a separate backup of the options file in plaintext as well. If your disk crashes and you have not backed it up in plaintext, the backup alone will help nothing because the file contains cryptographic metadata! The good point is that the file is static, you do not need to back it up repetitively over time unless you change the password.</div>
<h3><span class="mw-headline" id="Backup_encrypted_directory">Backup encrypted directory</span></h3>
<p>An encrypted directory may be backed up and restored to another location like it is. This is possible, because the configuration file for the encryption options/metadata is actually stored in the directory itself in plaintext in the hidden <code>.encfs6.xml</code> file. This poses no direct problem, because the password is not in it. 
</p>
<p>However, if you - for example - store the backup on a remote location (e.g. in the cloud) or a portable device, you might feel uncomfortable about it. In this case it also is no problem to manually move the file out of the directory before creating the backup. You can even move it permanently and still mount and access the files, if you pass its location to <i>encfs</i> via the <code>ENCFS6_CONFIG</code> environment variable. For the <a href="#Usage">#Usage</a> example above:  
</p>
<pre>$ mv ~/.name/.encfs6.xml ~/.
$ ENCFS6_CONFIG=~/.encfs6.xml encfs ~/.name ~/name
</pre>
<h3><span class="mw-headline" id="Backup_plaintext_directory">Backup plaintext directory</span></h3>
<p>The following example assumes you want to create an encrypted  backup of an existing plaintext directory <code>~/mythesis</code> which contains the file <code>thesis.txt</code>. 
</p>
<p>First, we create the encrypted backup of the existing plaintext directory: 
</p>
<pre>$ encfs --reverse ~/mythesis /tmp/thesisbackup 
</pre>
<p>Note the directory order is reversed to normal usage in this case. Using the <code>--reverse</code> option has two effects: Firstly, the configuration file is now stored in the plaintext directory and <code>/tmp/thesisbackup</code> only contains it in encrypted form. Secondly, the files in <code>/tmp/thesisbackup</code> are not persistent. They will vanish once it is unmounted (no, this is not due to usage of the <code>/tmp</code> mountpoint). 
</p>
<p>For the second reason, now is the time to copy the encrypted files to the desired backup location, <i>before</i> unmounting the temporary <i>encfs</i> directory again: 
</p>
<pre>$ cp -R /tmp/thesisbackup/* /mnt/usbstick/
$ fusermount -u /tmp/thesisbackup 
</pre>
<p>and done. 
</p>
<p>To restore (or view) the backup, we need access to the encryption options in plaintext, which has to be passed to <i>encfs</i> with the environment variable <code>ENCFS6_CONFIG</code> (we use a different directory in order not to mess up the existing <code>~/mythesis</code>): 
</p>
<pre>$ ENCFS6_CONFIG=~/mythesis/.encfs6.xml encfs ~/mnt/usbstick/thesisbackup ~/restoremythesis 
</pre>
<p>If you now list the restore location, it will contain two files: 
</p>
<pre>$ ls -la ~/restoremythesis
... 
-rw-r--r--  1 student student    1078  3. Jan 12:33 .encfs6.xml
-rw-r--r--  1 student student      42  3. Jan 12:33 thesis.txt
...
</pre>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://vgough.github.io/encfs/">EncFS</a> - project homepage</li>
<li>
<a rel="nofollow" class="external text" href="https://defuse.ca/audits/encfs.htm">Security audit</a> of EncFS by Taylor Hornby (January 14, 2014).</li>
<li>
<a rel="nofollow" class="external text" href="https://antofthy.gitlab.io/info/crypto/encfs.txt">EncFS micro-how-to</a> by Anthony Thyssen.</li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Data-at-rest_encryption.html" title="Category:Data-at-rest encryption">Data-at-rest encryption</a></li>
<li><a href="../en/Category:FUSE.html" title="Category:FUSE">FUSE</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=EncFS&amp;oldid=780691">https://wiki.archlinux.org/index.php?title=EncFS&amp;oldid=780691</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 9 June 2023, at 03:11.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
