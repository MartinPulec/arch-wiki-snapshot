<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Sharing PPP Connection - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.3">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Sharing_PPP_Connection rootpage-Sharing_PPP_Connection skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Requirements" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Requirements">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Requirements</div>
		</a>
		
		<ul id="toc-Requirements-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Installing" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installing">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Installing</div>
		</a>
		
		<ul id="toc-Installing-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Sharing_via_wired_ethernet" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Sharing_via_wired_ethernet">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Sharing via wired ethernet</div>
		</a>
		
			<button aria-controls="toc-Sharing_via_wired_ethernet-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Sharing via wired ethernet subsection</span>
			</button>
		
		<ul id="toc-Sharing_via_wired_ethernet-sublist" class="vector-toc-list">
			<li id="toc-Network_bridge" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Network_bridge">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>Network bridge</div>
			</a>
			
			<ul id="toc-Network_bridge-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Sharing_via_WLAN" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Sharing_via_WLAN">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Sharing via WLAN</div>
		</a>
		
		<ul id="toc-Sharing_via_WLAN-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Sharing_script" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Sharing_script">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Sharing script</div>
		</a>
		
		<ul id="toc-Sharing_script-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Sharing PPP Connection</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 1 language">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-1" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">1 language</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/PPP_%E6%8E%A5%E7%B6%9A%E3%81%AE%E5%85%B1%E6%9C%89" title="PPP 接続の共有 – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Merge-arrows-2.svg" decoding="async" width="36" height="40" class="mw-file-element"></span></span><b>This article or section is a candidate for merging with <a href="../en/Internet_sharing.html" class="mw-redirect" title="Internet Sharing">Internet Sharing</a>.</b></p>
<div>
<b>Notes:</b> Just a specific case of the topic described there. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Sharing_PPP_Connection.html">Talk:Sharing PPP Connection</a>)</div>
</div>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Requirements">Requirements</span></h2>
<p>Before proceeding, you must make sure:
</p>
<ol>
<li>You must have a working PPP connection.</li>
<li>You must have an extra Ethernet interface card in your computer with which to share your connection.</li>
</ol>
<h2><span class="mw-headline" id="Installing">Installing</span></h2>
<p>The following packages must be <a href="../en/Pacman.html" title="Pacman">installed</a> for both Wired and Wireless sharing:
</p>
<ul>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=iptables">iptables</a></span>: for controlling packets in your network.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dnsmasq">dnsmasq</a></span>: for acting as a DHCP and DNS caching server.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bridge-utils">bridge-utils</a></span>: for setting up a network bridge.</li>
</ul>
<p>Depending on whether you want to share a wireless or wired connection, you also have to install:
</p>
<ul>
<li>
<b>wired</b>: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=iproute2">iproute2</a></span> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=net-tools">net-tools</a></span> (this article uses <code>iproute2</code> since <code>net-tools</code> is deprecated).</li>
<li>
<b>wireless</b>: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=iw">iw</a></span> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=wireless_tools">wireless_tools</a></span> (this article uses <code>iw</code> since <code>wireless_tools</code> is deprecated).</li>
</ul>
<h2><span class="mw-headline" id="Sharing_via_wired_ethernet">Sharing via wired ethernet</span></h2>
<ul><li>Set the PPP connection up.</li></ul>
<dl><dd>You can assign an IP address to the interface as usual, by running (as root):</dd></dl>
<pre># ip addr add 192.168.0.254 dev eth0
</pre>
<ul><li>Set the kernel to router mode. This is done by running:</li></ul>
<pre># sysctl net.ipv4.ip_forward=1
</pre>
<ul><li>Configure <a href="../en/Dnsmasq.html" title="Dnsmasq">dnsmasq</a>. Make the following changes to <code>/etc/dnsmasq.conf</code> (uncomment if necessary):</li></ul>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/dnsmasq.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">domain-needed
bogus-priv
interface=eth0 # change to your chosen interface
dhcp-range=192.168.0.1,192.168.0.100,12h
</pre>
<ul>
<li>
<a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start">Start</a> the <b>dnsmasq</b> daemon.</li>
<li>Finally, set firewall to forward connections to and from the Internet for clients connecting to your WLAN. This is done by issuing:</li>
</ul>
<pre># iptables -t nat -A POSTROUTING -o ppp0 -j MASQUERADE
</pre>
<dl><dd>In the above the <b>ppp0</b> interface is the used PPP interface, you can substitute it for yours if needed.</dd></dl>
<ul><li>You are done! Happy surfing!</li></ul>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> The previous configuration has no security options enabled. If you are using a firewall, you should adapt this documentation to suit your needs. Same applies also to setting up keys for WLAN interface.</div>
<h3><span class="mw-headline" id="Network_bridge">Network bridge</span></h3>
<p>Let us assume your PPP connection is on <b>eth0</b>, and you want to share the connection on <b>eth1</b> and <b>eth2</b>.
</p>
<pre># ip addr add 0.0.0.0 dev eth1  # remove IP from eth0
# ip link set eth1 up           # ensure the interface is up
</pre>
<pre># ip addr add 0.0.0.0 dev eth2  # remove IP from eth1
# ip link set eth2 up           # ensure the interface is up
</pre>
<pre># brctl addbr br0               # create br0 node
# brctl addif br0 eth1          # add eth0 to bridge br0
# brctl addif br0 eth2          # add eth1 to bridge br0
</pre>
<pre># ip addr add 192.168.0.254 dev br0
</pre>
<p>change your interface in <code>dnsmasq.conf</code> to <b>br0</b>:
</p>
<pre>interface=br0 
</pre>
<p>and <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">restart</a> the <b>dnsmasq</b> daemon.
</p>
<p>Now you should be able to connect to the internet using <b>eth1</b> or <b>eth2</b>.
</p>
<h2><span class="mw-headline" id="Sharing_via_WLAN">Sharing via WLAN</span></h2>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> These instructions create <b>unencrypted</b> ad-hoc network. See <a href="../en/Ad-hoc_networking.html#wpa_supplicant" title="Ad-hoc networking">Ad-hoc networking#wpa_supplicant</a> for method using WPA1 encryption. For better security, create an <a href="../en/Software_access_point.html" class="mw-redirect" title="Access point">access point</a> secured by WPA2.</div>
<ul>
<li>Set up the PPP connection.</li>
<li>Set up the WLAN connection: choose an SSID and select Ad-hoc as network type. In the following it is assumed that you are using the <b>wlan0</b> interface.</li>
</ul>
<dl><dd>Set the <b>wlan0</b> interface up address for example 192.168.0.254. Setting up the interface is usually done by running:</dd></dl>
<pre># iw wlan0 set type ibss
# iw wlan0 ibss join MyFreeWlan
</pre>
<dl><dd>After that you can assign an IP address to the interface as usual, by running:</dd></dl>
<pre># ip addr add 192.168.0.254 dev wlan0
</pre>
<dl><dd>Please note that different wlan cards may be configured differently and one should adapt this documentation accordingly.</dd></dl>
<ul><li>Set the kernel to router mode. This is done by running:</li></ul>
<pre># echo 1 &gt; /proc/sys/net/ipv4/ip_forward
</pre>
<ul><li>Configure <b>dnsmasq</b>. Make the following changes to <code>/etc/dnsmasq.conf</code> (uncomment if necessary):</li></ul>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">etc/dnsmasq.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">domain-needed
bogus-priv
interface=wlan0    # change to your interface
dhcp-range=192.168.0.1,192.168.0.100,12h
</pre>
<ul>
<li>
<a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start">Start</a> the <b>dnsmasq</b> daemon.</li>
<li>Finally, set firewall to forward connections to and from the Internet for clients connecting to your WLAN. This is done by issuing:</li>
</ul>
<pre># iptables -t nat -A POSTROUTING -o ppp0 -j MASQUERADE
</pre>
<dl><dd>In the above the <b>ppp0</b> interface is assumed to be the used PPP interface, you can substitute it for yours if needed.</dd></dl>
<ul><li>You are done! Happy surfing!</li></ul>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> The previous configuration has no security options enabled! If you are using firewall, you should adapt this documentation to suit your needs. Same applies also to setting up keys for wlan interface.</div>
<h2><span class="mw-headline" id="Sharing_script">Sharing script</span></h2>
<p>A quick script for sharing <b>eth0</b> over <b>wlan0</b> on an ad-hoc network.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">ethoverwlan.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash

iw wlan0 set type ibss
iw wlan0 ibss join proxywlan
ip addr add 192.168.0.254 dev wlan0
ip link set wlan0 up
iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
echo 1 &gt; /proc/sys/net/ipv4/ip_forward
</pre>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a href="../en/Simple_stateful_firewall.html" title="Simple stateful firewall">Simple stateful firewall</a></li>
<li><a href="../en/Router.html" title="Router">Router</a></li>
<li><a href="../en/Network_configuration/Wireless.html" class="mw-redirect" title="Wireless network configuration">Wireless network configuration</a></li>
<li><a href="../en/Mobile_broadband_modem.html" class="mw-redirect" title="USB 3G Modem">USB 3G Modem</a></li>
<li><a rel="nofollow" class="external text" href="https://web.archive.org/web/20200225211430/http://go2linux.garron.me/linux/2011/03/share-your-3g-internet-connection-over-wifi-linux-ipod-touch-925/">Share your 3G Internet connection over wifi</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Network_sharing.html" title="Category:Network sharing">Network sharing</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Merge.html" title="Category:Pages or sections flagged with Template:Merge">Pages or sections flagged with Template:Merge</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Sharing_PPP_Connection&amp;oldid=748767">https://wiki.archlinux.org/index.php?title=Sharing_PPP_Connection&amp;oldid=748767</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 27 September 2022, at 13:49.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
