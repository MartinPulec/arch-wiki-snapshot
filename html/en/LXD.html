<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>LXD - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-LXD rootpage-LXD skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Installation</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Configuration</div>
		</a>
		
			<button aria-controls="toc-Configuration-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configuration subsection</span>
			</button>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
			<li id="toc-Unprivileged_containers" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Unprivileged_containers">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Unprivileged containers</div>
			</a>
			
			<ul id="toc-Unprivileged_containers-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Configure_LXD" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configure_LXD">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>Configure LXD</div>
			</a>
			
			<ul id="toc-Configure_LXD-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Accessing_LXD_as_an_unprivileged_user" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Accessing_LXD_as_an_unprivileged_user">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3</span>Accessing LXD as an unprivileged user</div>
			</a>
			
			<ul id="toc-Accessing_LXD_as_an_unprivileged_user-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Usage" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Usage">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Usage</div>
		</a>
		
			<button aria-controls="toc-Usage-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Usage subsection</span>
			</button>
		
		<ul id="toc-Usage-sublist" class="vector-toc-list">
			<li id="toc-Overview_of_commands" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Overview_of_commands">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>Overview of commands</div>
			</a>
			
			<ul id="toc-Overview_of_commands-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Create_a_container" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Create_a_container">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>Create a container</div>
			</a>
			
			<ul id="toc-Create_a_container-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Create_a_virtual_machine" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Create_a_virtual_machine">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3</span>Create a virtual machine</div>
			</a>
			
			<ul id="toc-Create_a_virtual_machine-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Use_and_manage_a_container_or_VM" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Use_and_manage_a_container_or_VM">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.4</span>Use and manage a container or VM</div>
			</a>
			
			<ul id="toc-Use_and_manage_a_container_or_VM-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Container/VM_configuration" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Container/VM_configuration">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.5</span>Container/VM configuration</div>
			</a>
			
			<ul id="toc-Container/VM_configuration-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Tips_and_tricks" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Tips_and_tricks">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Tips and tricks</div>
		</a>
		
			<button aria-controls="toc-Tips_and_tricks-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Tips and tricks subsection</span>
			</button>
		
		<ul id="toc-Tips_and_tricks-sublist" class="vector-toc-list">
			<li id="toc-Access_the_containers_by_name_on_the_host" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Access_the_containers_by_name_on_the_host">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>Access the containers by name on the host</div>
			</a>
			
			<ul id="toc-Access_the_containers_by_name_on_the_host-sublist" class="vector-toc-list">
				<li id="toc-Other_solution" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Other_solution">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1.1</span>Other solution</div>
			</a>
			
			<ul id="toc-Other_solution-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Use_Wayland_and_Xorg_applications" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Use_Wayland_and_Xorg_applications">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2</span>Use Wayland and Xorg applications</div>
			</a>
			
			<ul id="toc-Use_Wayland_and_Xorg_applications-sublist" class="vector-toc-list">
				<li id="toc-Add_the_following_devices_to_a_containers_profile" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Add_the_following_devices_to_a_containers_profile">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2.1</span>Add the following devices to a containers profile</div>
			</a>
			
			<ul id="toc-Add_the_following_devices_to_a_containers_profile-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Link_the_sockets_to_the_right_location_inside_the_container" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Link_the_sockets_to_the_right_location_inside_the_container">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2.2</span>Link the sockets to the right location inside the container</div>
			</a>
			
			<ul id="toc-Link_the_sockets_to_the_right_location_inside_the_container-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Add_environment_variables_to_the_users_config_inside_the_container" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Add_environment_variables_to_the_users_config_inside_the_container">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2.3</span>Add environment variables to the users config inside the container</div>
			</a>
			
			<ul id="toc-Add_environment_variables_to_the_users_config_inside_the_container-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Install_necessary_software_in_the_container" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Install_necessary_software_in_the_container">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2.4</span>Install necessary software in the container</div>
			</a>
			
			<ul id="toc-Install_necessary_software_in_the_container-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Start_GUI_applications" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Start_GUI_applications">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2.5</span>Start GUI applications</div>
			</a>
			
			<ul id="toc-Start_GUI_applications-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Privileged_containers" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Privileged_containers">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.3</span>Privileged containers</div>
			</a>
			
			<ul id="toc-Privileged_containers-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Add_a_disk_device" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Add_a_disk_device">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4</span>Add a disk device</div>
			</a>
			
			<ul id="toc-Add_a_disk_device-sublist" class="vector-toc-list">
				<li id="toc-Read-Only" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Read-Only">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4.1</span>Read-Only</div>
			</a>
			
			<ul id="toc-Read-Only-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Read-Write_(unprivileged_container)" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Read-Write_(unprivileged_container)">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4.2</span>Read-Write (unprivileged container)</div>
			</a>
			
			<ul id="toc-Read-Write_(unprivileged_container)-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Bash_completion_doesn't_work" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Bash_completion_doesn't_work">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.5</span>Bash completion doesn't work</div>
			</a>
			
			<ul id="toc-Bash_completion_doesn't_work-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Troubleshooting">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Troubleshooting</div>
		</a>
		
			<button aria-controls="toc-Troubleshooting-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Troubleshooting subsection</span>
			</button>
		
		<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
			<li id="toc-lxd-agent_inside_a_virtual_machine" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#lxd-agent_inside_a_virtual_machine">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1</span>lxd-agent inside a virtual machine</div>
			</a>
			
			<ul id="toc-lxd-agent_inside_a_virtual_machine-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Check_kernel_config" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Check_kernel_config">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2</span>Check kernel config</div>
			</a>
			
			<ul id="toc-Check_kernel_config-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Resource_limits_are_not_applied_when_viewed_from_inside_a_container" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Resource_limits_are_not_applied_when_viewed_from_inside_a_container">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.3</span>Resource limits are not applied when viewed from inside a container</div>
			</a>
			
			<ul id="toc-Resource_limits_are_not_applied_when_viewed_from_inside_a_container-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Starting_a_virtual_machine_fails" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Starting_a_virtual_machine_fails">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.4</span>Starting a virtual machine fails</div>
			</a>
			
			<ul id="toc-Starting_a_virtual_machine_fails-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-No_IPv4_with_systemd-networkd" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#No_IPv4_with_systemd-networkd">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.5</span>No IPv4 with systemd-networkd</div>
			</a>
			
			<ul id="toc-No_IPv4_with_systemd-networkd-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-No_networking_with_ufw" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#No_networking_with_ufw">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.6</span>No networking with ufw</div>
			</a>
			
			<ul id="toc-No_networking_with_ufw-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-No_networking_with_Docker_installed" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#No_networking_with_Docker_installed">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.7</span>No networking with Docker installed</div>
			</a>
			
			<ul id="toc-No_networking_with_Docker_installed-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Building_a_snap_with_snapcraft:_craft-providers_error:_LXD_requires_additional_permissions." class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Building_a_snap_with_snapcraft:_craft-providers_error:_LXD_requires_additional_permissions.">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.8</span>Building a snap with snapcraft: craft-providers error: LXD requires additional permissions.</div>
			</a>
			
			<ul id="toc-Building_a_snap_with_snapcraft:_craft-providers_error:_LXD_requires_additional_permissions.-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Uninstall" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Uninstall">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>Uninstall</div>
		</a>
		
		<ul id="toc-Uninstall-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">7</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">LXD</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 2 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-2" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">2 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-es mw-list-item"><a href="../es/LXD.html" title="LXD – español" lang="es" hreflang="es" class="interlanguage-link-target"><span>Español</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/LXD" title="LXD – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/Linux_Containers.html" title="Linux Containers">Linux Containers</a></li>
<li><a href="../en/Incus.html" title="Incus">Incus</a></li>
</ul>
</div>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-view-fullscreen.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs expansion.</b></p>
<div>
<b>Reason:</b> Possibility to improve introduction by quoting upstream? (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:LXD.html">Talk:LXD</a>)</div>
</div>
<p><a rel="nofollow" class="external text" href="https://ubuntu.com/lxd">LXD</a> is a manager/hypervisor by Canonical for containers (via <a href="../en/Linux_Containers.html" class="mw-redirect" title="LXC">LXC</a>) and virtual-machines (via <a href="../en/QEMU.html" title="QEMU">QEMU</a>).
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>Install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lxd">lxd</a></span> package, then <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">enable</a> the <code>lxd.socket</code>.
</p>
<p>Alternatively, you can <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable/start">enable/start</a> the <code>lxd.service</code> directly, in case you want instances to autostart for example.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<h3><span class="mw-headline" id="Unprivileged_containers">Unprivileged containers</span></h3>
<p>It is recommended to use unprivileged containers (See <a href="../en/Linux_Containers.html#Privileged_or_unprivileged_containers" title="Linux Containers">Linux Containers#Privileged or unprivileged containers</a> for an explanation of the difference).
</p>
<p>For this, modify both <code>/etc/subuid</code> and <code>/etc/subgid</code> (if these files are not present, create them) to contain the mapping to the containerized uid/gid pairs for each user who shall be able to run the containers. The example below is simply for the root user (and systemd system unit):
</p>
<p>You can either use <code>usermod</code> as follows:
</p>
<p><code>usermod -v 1000000-1000999999 -w 1000000-1000999999 root</code>
</p>
<p>Or modify the above mentioned files directly as follows:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/subuid</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">root:1000000:1000000000
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/subgid</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">root:1000000:1000000000
</pre>
<p>Now, every container will be started <code>unprivileged</code> by default.
</p>
<p>For the alternative, see <a href="#Privileged_containers">#Privileged containers</a>.
</p>
<h3><span class="mw-headline" id="Configure_LXD">Configure LXD</span></h3>
<p>On the first start, LXD needs to be configured.
</p>
<p>Run as root:
</p>
<pre># lxd init
</pre>
<p>This will start an interactive configuration guide in the terminal, that covers different topics like storages, networks etc.
</p>
<p>You can find an overview in the official <a rel="nofollow" class="external text" href="https://documentation.ubuntu.com/lxd/en/latest/getting_started/">Getting Started Guide</a>.
</p>
<h3><span class="mw-headline" id="Accessing_LXD_as_an_unprivileged_user">Accessing LXD as an unprivileged user</span></h3>
<p>By default, the LXD daemon allows users in the <code>lxd</code> group access, so <a href="../en/Users_and_groups.html#Group_management" title="Users and groups">add your user</a> to this group.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Anyone added to the <code>lxd</code> group is root equivalent. For more information, see <a rel="nofollow" class="external autonumber" href="https://github.com/canonical/lxd#security">[1]</a> and <a rel="nofollow" class="external autonumber" href="https://bugs.launchpad.net/ubuntu/+source/lxd/+bug/1829071">[2]</a>.</div>
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
<p>LXD consists of two parts:
</p>
<ul>
<li>the daemon (the <i>lxd</i> binary)</li>
<li>the client (the <i>lxc</i> binary)</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> LXD is not LXC; the naming is a bit confusing, you can read the <a rel="nofollow" class="external text" href="https://discuss.linuxcontainers.org/t/comparing-lxd-vs-lxc/24">forum post on comparing LXD vs LXC</a> regarding the difference.</div>
<p>The client is used to control one or multiple daemon(s).
</p>
<p>The client can also be used to control remote LXD servers.
</p>
<h3><span class="mw-headline" id="Overview_of_commands">Overview of commands</span></h3>
<p>You can get an overview of all available commands by typing:
</p>
<pre>$ lxc
</pre>
<h3><span class="mw-headline" id="Create_a_container">Create a container</span></h3>
<p>You can create a container with <code>lxc launch</code>, for example:
</p>
<pre>$ lxc launch ubuntu:20.04
</pre>
<p>Container are based on images, that are downloaded from image servers or remote LXD servers.
</p>
<p>You can see the list of already added servers with:
</p>
<pre>$ lxc remote list
</pre>
<p>You can list all images on a server with <code>lxc image list</code>, for example:
</p>
<pre>$ lxc image list images:
</pre>
<p>This will show you all images on one of the default servers: <a rel="nofollow" class="external text" href="https://images.linuxcontainers.org">images.linuxcontainers.org</a>
</p>
<p>You can also search for images by adding terms like the distribution name:
</p>
<pre>$ lxc image list images:debian
</pre>
<p>Launch a container with an image from a specific server with:
</p>
<pre>$ lxc launch servername:imagename
</pre>
<p>For example:
</p>
<pre>$ lxc launch images:centos/8/amd64 centos
</pre>
<p>To create an amd64 Arch container:
</p>
<pre>$ lxc launch images:archlinux/current/amd64 arch
</pre>
<h3><span class="mw-headline" id="Create_a_virtual_machine">Create a virtual machine</span></h3>
<p>Just add the flag <code>--vm</code> to <code>lxc launch</code>:
</p>
<pre>$ lxc launch ubuntu:20.04 --vm
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>For now, virtual machines support less features than containers (see <a rel="nofollow" class="external text" href="https://linuxcontainers.org/lxd/getting-started-cli/#virtual-machines">Details on virtual machines</a> for example).</li>
<li>Only <code>cloud</code> variants of the official images enable the lxd-agent out-of-the-box (which is needed for the usual lxc commands like <code>lxc exec</code>). <br> You can search for cloud images with <code>lxc image list images: cloud</code> or <code>lxc image list images: distribution-name cloud</code>. <br> If you use other images or encounter problems, take a look at <a href="#lxd-agent_inside_a_virtual_machine">#lxd-agent inside a virtual machine</a>.</li>
</ul>
</div>
<h3><span class="mw-headline" id="Use_and_manage_a_container_or_VM">Use and manage a container or VM</span></h3>
<p>See <a rel="nofollow" class="external text" href="https://linuxcontainers.org/lxd/getting-started-cli/#manage-instances">"Manage instances" in the official Getting Started Guide of LXD</a>.
</p>
<h3>
<span id="Container.2FVM_configuration"></span><span class="mw-headline" id="Container/VM_configuration">Container/VM configuration</span>
</h3>
<p>You can add various options to instances (containers and VMs).
</p>
<p>See <a rel="nofollow" class="external text" href="https://linuxcontainers.org/lxd/advanced-guide/#configuration-of-instances">Configuration of instances in the official Advanced Guide of LXD</a> for details.
</p>
<h2><span class="mw-headline" id="Tips_and_tricks">Tips and tricks</span></h2>
<h3><span class="mw-headline" id="Access_the_containers_by_name_on_the_host">Access the containers by name on the host</span></h3>
<p>This assumes that you are using the default bridge that it is named <code>lxdbr0</code> and that you are using <a href="../en/Systemd-resolved.html" title="Systemd-resolved">systemd-resolved</a>.
</p>
<pre># systemd-resolve --interface lxdbr0 --set-domain '~lxd' --set-dns $(lxc network get lxdbr0 ipv4.address | cut -d / -f 1)
</pre>
<p>You can now access the containers by name:
</p>
<pre>$ ping <i>containername</i>.lxd
</pre>
<h4><span class="mw-headline" id="Other_solution">Other solution</span></h4>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Inaccurate.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>The factual accuracy of this article or section is disputed.</b></p>
<div>
<b>Reason:</b> When does <i>systemd-resolve</i> stop working? Is there a bug report or some other reference? (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:LXD.html">Talk:LXD</a>)</div>
</div>
<p>It seems that the <i>systemd-resolve</i> solution stops working after some time.
</p>
<p>Another solution is to use <a href="../en/Systemd-networkd.html" title="Systemd-networkd">systemd-networkd</a> with the following <code>lxd.network</code> (replace <code><i>x</i></code> and <code><i>y</i></code> to match your bridge IP):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/network/lxd.network</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Match]
Name=lxdbr0

[Network]
DNS=<i>10.x.y.1</i>
Domains=~lxd
IgnoreCarrierLoss=yes

[Address]
Address=<i>10.x.y.1</i>/24
Gateway=<i>10.x.y.1</i></pre>
<h3><span class="mw-headline" id="Use_Wayland_and_Xorg_applications">Use Wayland and Xorg applications</span></h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Always consider security implications, as some of the described methods may weaken the seperation between container and host.</div>
<p>There are multiple methods to use GUI applications inside containers, you can find an overview in the <a rel="nofollow" class="external text" href="https://discuss.linuxcontainers.org/t/overview-gui-inside-containers/8767">official LXD forum</a>.
</p>
<p>The following method grants containers access to the host's sockets of Wayland (+Xwayland) or Xorg.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Using Xorg might weaken the seperation between container and host, because Xorg allows applications to access other applications windows. So container applications might have access to host applications windows. Use Wayland instead (but be aware that Xorg downsides also apply to Xwayland).</div>
<h4><span class="mw-headline" id="Add_the_following_devices_to_a_containers_profile">Add the following devices to a containers profile</span></h4>
<p>See also <a rel="nofollow" class="external text" href="https://linuxcontainers.org/lxd/docs/master/instances#device-types">LXD documentation regarding devices</a>.
</p>
<p>General device for the GPU:
</p>
<pre>mygpu:
   type: gpu
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The path under "listen" is different, because <code>/run</code> and <code>/tmp</code> directories might be overridden, see <a rel="nofollow" class="external free" href="https://github.com/canonical/lxd/issues/4540">https://github.com/canonical/lxd/issues/4540</a>.</div>
<p>Device for the Wayland socket:
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>Adjust the Display (wayland-0) accordingly.</li>
<li>Add the directories in <code>/mnt</code> and <code>/tmp</code> inside the container, if they do not already exist.</li>
</ul>
</div>
<pre>Waylandsocket:
    bind: container
    connect: unix:/run/user/1000/wayland-0
    listen: unix:/mnt/wayland1/wayland-0
    uid: "1000"
    gid: "1000"
    security.gid: "1000"
    security.uid: "1000"
    mode: "0777"
    type: proxy
</pre>
<p>Device for the Xorg (or Xwayland) Socket:
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Adjust the Display Number accordingly (for example X1 instead of X0).</div>
<pre>Xsocket:
    bind: container
    connect: unix:/tmp/.X11-unix/X0
    listen: unix:/mnt/xorg1/X0
    uid: "1000"
    gid: "1000"
    security.gid: "1000"
    security.uid: "1000"
    mode: "0777"
    type: proxy
</pre>
<h4><span class="mw-headline" id="Link_the_sockets_to_the_right_location_inside_the_container">Link the sockets to the right location inside the container</span></h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> These scripts need to be run after each start of the container; you can automate this with systemd for example.</div>
<p>Shell script to link the Wayland socket:
</p>
<pre>#!/bin/sh
mkdir /run/user/1000
ln -s /mnt/wayland1/wayland-0 /run/user/1000/wayland-0
</pre>
<p>Link the Xorg (or Xwayland) socket:
</p>
<pre>#!/bin/sh
ln -s /mnt/xorg1/X0 /tmp/.X11-unix/X0
</pre>
<h4><span class="mw-headline" id="Add_environment_variables_to_the_users_config_inside_the_container">Add environment variables to the users config inside the container</span></h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Adjust the Display Numbers and/or the filename (.profile) accordingly.</div>
<p>For Wayland:
</p>
<pre>$ echo "export XDG_RUNTIME_DIR=/run/user/1000" &gt;&gt; ~/.profile
$ echo "export WAYLAND_DISPLAY=wayland-0" &gt;&gt; ~/.profile
$ echo "export QT_QPA_PLATFORM=wayland" &gt;&gt; ~/.profile
</pre>
<p>For Xorg (or Xwayland):
</p>
<pre>$ echo "export DISPLAY=:0" &gt;&gt; ~/.profile
</pre>
<p>Reload the <code>~/.profile</code>:
</p>
<pre>$ source ~/.profile
</pre>
<h4><span class="mw-headline" id="Install_necessary_software_in_the_container">Install necessary software in the container</span></h4>
<p>Necessary software needs to be added. For now, you can install an example GUI application; this will probably install all necessary packages as well.
</p>
<h4><span class="mw-headline" id="Start_GUI_applications">Start GUI applications</span></h4>
<p>Now, you should be able to start GUI applications inside the container (via terminal for example) and make them appear as a window on your hosts display.
</p>
<p>You can try out <i>glxgears</i> for example.
</p>
<h3><span class="mw-headline" id="Privileged_containers">Privileged containers</span></h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>Privileged containers are not isolated from the host!</li>
<li>The root user in the container is the root user on the host.</li>
<li>Use unprivileged containers instead whenever possible.</li>
</ul>
</div>
<p>If you want to set up a privileged container, you must provide the config key <code>security.privileged=true</code>.
</p>
<p>Either during container creation:
</p>
<pre>$ lxc launch ubuntu:20.04 ubuntu -c security.privileged=true
</pre>
<p>Or for an already existing container, you may edit the configuration:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ lxc config edit ubuntu</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">name: ubuntu
profiles:
- default
config:
  ...
  security.privileged: "true"
  ...
</pre>
<h3><span class="mw-headline" id="Add_a_disk_device">Add a disk device</span></h3>
<h4><span class="mw-headline" id="Read-Only">Read-Only</span></h4>
<p>If you want to share a disk device from the host to a container, all you need to do is add a <code>disk</code> device to your container. The virtual <code>disk</code> device needs a name (only used internally in the LXC configuration file), a path on the host's filesystem pointing to the disk you want to mount, as well as a desired mountpoint on the container's filesystem.
</p>
<pre>$ lxc config device add <i>containername</i> <i>virtualdiskname</i> disk source=<i>/path/to/host/disk/</i> path=<i>/path/to/mountpoint/on/container</i>
</pre>
<h4>
<span id="Read-Write_.28unprivileged_container.29"></span><span class="mw-headline" id="Read-Write_(unprivileged_container)">Read-Write (unprivileged container)</span>
</h4>
<p>The preferred method for read/write access is to use the "shift" method included in LXD.
</p>
<p>shift is based on Linux kernel functionality and available in two different versions:
</p>
<ul>
<li>the most recent version is called "idmapped mounts" and is included in all upstream kernels &gt;5.12 by default. So it is also included in the regular Arch Linux kernel (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span>).</li>
<li>the old version is called "shiftfs" and needs to be added manually to most kernels as a kernel module. It is available as a legacy version to support older kernels. You can take a look at this GitHub repo that uses the shiftfs kernel module from Ubuntu kernels: <a rel="nofollow" class="external free" href="https://github.com/toby63/shiftfs-dkms">https://github.com/toby63/shiftfs-dkms</a>
</li>
</ul>
<p>Shift should be available and activated by default on Arch with the regular Arch Linux kernel (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span>) and the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lxd">lxd</a></span> package.
</p>
<p><b>1. To check whether shift is available on your system</b>, run <code>lxc info</code>
</p>
<p>The first part of the output shows you:
</p>
<pre> kernel_features:
    idmapped_mounts: "true"
    shiftfs: "false"
</pre>
<p>If either idmapped_mounts or shiftfs is true, then your kernel includes it already and you can use shift.
If it is not true, you should check your kernel version and might try the "shiftfs" legacy version mentioned above.
</p>
<p>The second part of the output shows you either:
</p>
<pre>  lxc_features:
    idmapped_mounts_v2: "true"
</pre>
<p>or:
</p>
<pre>  lxc_features:
    shiftfs: "true"
</pre>
<p>If either idmapped_mounts or shiftfs is true, then LXD has already enabled it.
If it is not enabled, you must enable it first.
</p>
<p><b>2. Usage</b>
</p>
<p>Then you can simply set the "shift" config key to "true" in the disk device options.
See: <a rel="nofollow" class="external text" href="https://documentation.ubuntu.com/lxd/en/latest/reference/devices_disk/">LXD Documentation on disk devices</a>
</p>
<p>See also: <a rel="nofollow" class="external text" href="https://discuss.linuxcontainers.org/t/share-folders-and-volumes-between-host-and-containers/7735">tutorial in the LXD forums</a>
</p>
<h3>
<span id="Bash_completion_doesn.27t_work"></span><span class="mw-headline" id="Bash_completion_doesn't_work">Bash completion doesn't work</span>
</h3>
<p>This workaround may fix the issue:
</p>
<pre># ln -s /usr/share/bash-completion/completions/lxd /usr/share/bash-completion/completions/lxc
</pre>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="lxd-agent_inside_a_virtual_machine">lxd-agent inside a virtual machine</span></h3>
<p>Inside some virtual machine images, the <code>lxd-agent</code> is not enabled by default.
</p>
<p>In this case, you have to enable it manually, for example by mounting a <code>9p</code> network share. This requires console access with a valid user.
</p>
<p>1. Login with <code>lxc console</code> and replace <code>virtualmachine-name</code> accordingly.
</p>
<pre>$ lxc console virtualmachine-name
</pre>
<p>Login as root:
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> On some systems, you have to setup a root password first to be able to login as root, you can use <a rel="nofollow" class="external text" href="https://linuxcontainers.org/lxd/advanced-guide/#cloud-init">cloud-init</a> for this for example.</div>
<pre>$ su root
</pre>
<p>Mount the network share:
</p>
<pre>$ mount -t 9p config /mnt/
</pre>
<p>Go into the folder and run the install script (this will enable the lxd-agent inside the VM):
</p>
<pre>$ cd /mnt/
$ ./install.sh
</pre>
<p>After a successful install, reboot with:
</p>
<pre>$ reboot
</pre>
<p>Afterwards, the <code>lxd-agent</code> is available and <code>lxc exec</code> should work.
</p>
<h3><span class="mw-headline" id="Check_kernel_config">Check kernel config</span></h3>
<p>By default, the Arch Linux kernel is compiled correctly for Linux Containers and its frontend LXD. However, if you are using a custom kernel or changed the kernel options, the kernel might be configured incorrectly. Verify that your kernel is properly configured:
</p>
<pre>$ lxc-checkconfig
</pre>
<h3><span class="mw-headline" id="Resource_limits_are_not_applied_when_viewed_from_inside_a_container">Resource limits are not applied when viewed from inside a container</span></h3>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lxcfs">lxcfs</a></span> and <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start">start</a> <code>lxcfs.service</code>.
</p>
<p>lxd will need to be restarted. <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">Enable</a> <code>lxcfs.service</code> for the service to be started at boot time.
</p>
<h3><span class="mw-headline" id="Starting_a_virtual_machine_fails">Starting a virtual machine fails</span></h3>
<p>If you see the error:
</p>
<pre>Error: Couldn't find one of the required UEFI firmware files: [{code:OVMF_CODE.4MB.fd vars:OVMF_VARS.4MB.ms.fd} {code:OVMF_CODE.2MB.fd vars:OVMF_VARS.2MB.ms.fd} {code:OVMF_CODE.fd vars:OVMF_VARS.ms.fd} {code:OVMF_CODE.fd vars:qemu.nvram}]
</pre>
<p>It's because Arch Linux does not distribute secure boot signed ovmf firmware. To boot virtual machines you need to disable secure boot for the time being:
</p>
<pre>$ lxc launch ubuntu:18.04 test-vm --vm -c security.secureboot=false
</pre>
<p>This can also be added to the default profile by doing:
</p>
<pre>$ lxc profile set default security.secureboot=false
</pre>
<h3><span class="mw-headline" id="No_IPv4_with_systemd-networkd">No IPv4 with systemd-networkd</span></h3>
<p>Starting with version version 244.1, systemd detects if <code>/sys</code> is writable by containers. If it is, udev is automatically started and breaks IPv4 in unprivileged containers. See <a rel="nofollow" class="external text" href="https://github.com/systemd/systemd-stable/commit/96d7083c5499b264ecebd6a30a92e0e8fda14cd5">commit bf331d8</a> and <a rel="nofollow" class="external text" href="https://discuss.linuxcontainers.org/t/no-ipv4-on-arch-linux-containers/6395">discussion on linuxcontainers</a>.
</p>
<p>On containers created past 2020, there should already be a <code>systemd.networkd.service</code> override to work around this issue, create it if it is not:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/systemd-networkd.service.d/lxc.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Service]
BindReadOnlyPaths=/sys</pre>
<p>You could also work around this issue by setting <code>raw.lxc: lxc.mount.auto = proc:rw sys:ro</code> in the profile of the container to ensure <code>/sys</code> is read-only for the entire container, although this may be problematic, as per the linked discussion above.
</p>
<h3><span class="mw-headline" id="No_networking_with_ufw">No networking with ufw</span></h3>
<p>When running LXD on a system with <a href="../en/Uncomplicated_Firewall.html" class="mw-redirect" title="Ufw">ufw</a>, the output of <code>lxc ls</code> will contain an empty IPv4 field, outbound requests will not be forwarded out of the container, and inbound requests will not be forwarded into the container. As seen in <a rel="nofollow" class="external text" href="https://discuss.linuxcontainers.org/t/lxc-containers-ufw-firewall-on-the-lxd-host/11087/2">a thread on LXC's Discourse instance</a>, ufw will block traffic from LXD bridges by default. The solution is to configure two new ufw rules for each bridge:
</p>
<pre># ufw route allow in on lxdbr0
# ufw allow in on lxdbr0
</pre>
<p>For more information on these two commands, check out <a rel="nofollow" class="external text" href="https://discuss.linuxcontainers.org/t/lxd-bridge-doesnt-work-with-ipv4-and-ufw-with-nftables/10034/17">this thread</a> which describes these commands and their limitations in more detail.
</p>
<h3><span class="mw-headline" id="No_networking_with_Docker_installed">No networking with Docker installed</span></h3>
<p>You have Docker installed on the host, and you're not able to access LAN or internet from within a lxc container.
</p>
<pre># iptables -I DOCKER-USER -i lxdbr0 -o <i>interface</i> -j ACCEPT
# iptables -I DOCKER-USER -o lxdbr0 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
</pre>
<p>On the first line, replace <code><i>interface</i></code> with the external network interface (what connects the host to LAN/internet, e.g. <code>enp6so</code>, <code>wlp5s0</code>, ...). Also replace <code>lxdbr0</code> if needed.
</p>
<p>For more details, see <a rel="nofollow" class="external text" href="https://documentation.ubuntu.com/lxd/en/latest/howto/network_bridge_firewalld/#prevent-connectivity-issues-with-lxd-and-docker">this note in the LXD documentation</a>.
</p>
<h3><span class="mw-headline" id="Building_a_snap_with_snapcraft:_craft-providers_error:_LXD_requires_additional_permissions.">Building a snap with snapcraft: craft-providers error: LXD requires additional permissions.</span></h3>
<p>If you get the following error:
</p>
<pre>craft-providers error: LXD requires additional permissions.
Ensure that the user is in the 'lxd' group.
Visit <a rel="nofollow" class="external free" href="https://documentation.ubuntu.com/lxd/en/latest/getting_started/">https://documentation.ubuntu.com/lxd/en/latest/getting_started/</a> for instructions on installing and configuring LXD for your operating system.
Full execution log: '/home/your_user/.local/state/snapcraft/log/snapcraft-20231129-221308.209638.log'
</pre>
<p>This might occur if you try to build a snap with the <code>snapcraft</code> command. If the error is still there even after you added yourself to the lxd group and rebooted, try installing lxd via snap instead of as an Arch package (don't install both), that might solve this problem.
</p>
<h2><span class="mw-headline" id="Uninstall">Uninstall</span></h2>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Stop">Stop</a> and disable <code>lxd.service</code> and <code>lxd.socket</code>. Then <a href="../en/Pacman.html#Removing_packages" class="mw-redirect" title="Uninstall">uninstall</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lxd">lxd</a></span> package.
</p>
<p>If you uninstalled the package without disabling the service, you might have a lingering broken symlink at <code>/etc/systemd/system/multi-user.wants/lxd.service</code>.
</p>
<p>If you want to remove all data:
</p>
<pre># rm -r /var/lib/lxd
</pre>
<p>If you used any of the example networking configuration, you should remove those as well.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://linuxcontainers.org/lxd/">The official LXD homepage</a></li>
<li><a rel="nofollow" class="external text" href="https://linuxcontainers.org/lxd/docs/master/">Official documentation</a></li>
<li><a rel="nofollow" class="external text" href="https://linuxcontainers.org/lxd/getting-started-cli/">Getting Started Guide</a></li>
<li><a rel="nofollow" class="external text" href="https://linuxcontainers.org/lxd/advanced-guide/">Advanced Guide</a></li>
<li><a rel="nofollow" class="external text" href="https://discuss.linuxcontainers.org/">Official Forum</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/canonical/lxd">The LXD GitHub page</a></li>
<li><a rel="nofollow" class="external text" href="https://discuss.linuxcontainers.org/c/tutorials/16">Tutorials in LXD Forum</a></li>
<li><a rel="nofollow" class="external text" href="https://discuss.linuxcontainers.org/tag/release">Release Notes in LXD Forum</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Virtualization.html" title="Category:Virtualization">Virtualization</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=LXD&amp;oldid=810653">https://wiki.archlinux.org/index.php?title=LXD&amp;oldid=810653</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 16 June 2024, at 08:17.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
