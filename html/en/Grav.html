<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Grav - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.43.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Grav rootpage-Grav skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Prerequisites" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Prerequisites">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Prerequisites</span>
			</div>
		</a>
		
		<ul id="toc-Prerequisites-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Installation</span>
			</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Application_server" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Application_server">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Application server</span>
			</div>
		</a>
		
			<button aria-controls="toc-Application_server-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Application server subsection</span>
			</button>
		
		<ul id="toc-Application_server-sublist" class="vector-toc-list">
			<li id="toc-uWSGI" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#uWSGI">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1</span>
					<span>uWSGI</span>
				</div>
			</a>
			
			<ul id="toc-uWSGI-sublist" class="vector-toc-list">
				<li id="toc-grav.ini" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#grav.ini">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1.1</span>
					<span>grav.ini</span>
				</div>
			</a>
			
			<ul id="toc-grav.ini-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Systemd_service" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Systemd_service">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1.2</span>
					<span>Systemd service</span>
				</div>
			</a>
			
			<ul id="toc-Systemd_service-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-FPM" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#FPM">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2</span>
					<span>FPM</span>
				</div>
			</a>
			
			<ul id="toc-FPM-sublist" class="vector-toc-list">
				<li id="toc-php-fpm.ini" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#php-fpm.ini">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.1</span>
					<span>php-fpm.ini</span>
				</div>
			</a>
			
			<ul id="toc-php-fpm.ini-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-grav.conf" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#grav.conf">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.2</span>
					<span>grav.conf</span>
				</div>
			</a>
			
			<ul id="toc-grav.conf-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Systemd_service_2" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Systemd_service_2">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.3</span>
					<span>Systemd service</span>
				</div>
			</a>
			
			<ul id="toc-Systemd_service_2-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Web_server" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Web_server">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">4</span>
				<span>Web server</span>
			</div>
		</a>
		
			<button aria-controls="toc-Web_server-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Web server subsection</span>
			</button>
		
		<ul id="toc-Web_server-sublist" class="vector-toc-list">
			<li id="toc-nginx" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#nginx">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.1</span>
					<span>nginx</span>
				</div>
			</a>
			
			<ul id="toc-nginx-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Apache_HTTP_Server" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Apache_HTTP_Server">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.2</span>
					<span>Apache HTTP Server</span>
				</div>
			</a>
			
			<ul id="toc-Apache_HTTP_Server-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Plugins" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Plugins">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">5</span>
				<span>Plugins</span>
			</div>
		</a>
		
		<ul id="toc-Plugins-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Content" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Content">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">6</span>
				<span>Content</span>
			</div>
		</a>
		
			<button aria-controls="toc-Content-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Content subsection</span>
			</button>
		
		<ul id="toc-Content-sublist" class="vector-toc-list">
			<li id="toc-Skeletons" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Skeletons">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">6.1</span>
					<span>Skeletons</span>
				</div>
			</a>
			
			<ul id="toc-Skeletons-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Migrating_from_v1.6_to_v1.7" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Migrating_from_v1.6_to_v1.7">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">7</span>
				<span>Migrating from v1.6 to v1.7</span>
			</div>
		</a>
		
		<ul id="toc-Migrating_from_v1.6_to_v1.7-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Upgrade" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Upgrade">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">8</span>
				<span>Upgrade</span>
			</div>
		</a>
		
		<ul id="toc-Upgrade-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Grav</span></h1>
				</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/PHP.html" title="PHP">PHP</a></li>
<li><a href="../en/Nginx.html" title="Nginx">Nginx</a></li>
<li><a href="../en/UWSGI.html" title="UWSGI">UWSGI</a></li>
<li><a href="../en/Apache_HTTP_Server.html" title="Apache HTTP Server">Apache HTTP Server</a></li>
</ul>
</div>
<p>From <a href="https://en.wikipedia.org/wiki/Grav_(CMS)" class="extiw" title="wikipedia:Grav (CMS)">Wikipedia</a>:
</p>
<dl><dd>Grav is a free software, self-hosted content management system (CMS) written in the PHP programming language and based on the Symfony web application framework. It uses a flat file database for both backend and frontend.</dd></dl>
<dl><dd>Grav is designed to have a shallow learning curve, and to be easy to set up. The focus of Grav is speed and simplicity, rather than an abundance of built-in features that come at the expense of complexity.</dd></dl>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Prerequisites">Prerequisites</span></h2>
<p>Grav comes with surprisingly few prerequisites by itself. Of course as a web application written in PHP it needs <a href="../en/PHP.html" title="PHP">PHP</a>. The only required PHP module is <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-gd">php-gd</a></span>. A <a rel="nofollow" class="external text" href="https://learn.getgrav.org/17/basics/requirements#php-requirements">few others</a> are also required but already part of the bare PHP installation. The following PHP modules are optional but highly recommended for better performance:
</p>
<ul>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-apcu">php-apcu</a></span> for increased cache performance</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/php-yaml/">php-yaml</a></span><sup><small>AUR</small></sup> for native YAML processing dramatically increasing performance</li>
</ul>
<p>Although Grav can serve the content <a rel="nofollow" class="external text" href="https://getgrav.org/blog/using-builtin-webserver">on its own</a> this article describes a setup with a full blown web server in front. So you need:
</p>
<ul>
<li>A web server: <a href="../en/Apache_HTTP_Server.html" title="Apache HTTP Server">Apache HTTP Server</a> or <a href="../en/Nginx.html" title="Nginx">nginx</a> or others</li>
<li>An application server: <a href="../en/UWSGI.html" title="UWSGI">uWSGI</a> (together with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=uwsgi-plugin-php">uwsgi-plugin-php</a></span>) or <a rel="nofollow" class="external text" href="https://cwiki.apache.org/confluence/display/HTTPD/PHP-FPM">FPM</a>
</li>
</ul>
<p>The following combinations will be covered:
</p>
<ul>
<li>nginx → uWSGI (plus uwsgi-plugin-php)</li>
<li>nginx → FPM,</li>
<li>Apache (using mod_proxy_uwsgi) → uWSGI (plus uwsgi-plugin-php)</li>
<li>Apache (using mod_proxy_fcgi) → FPM</li>
</ul>
<p>The installation of Grav complies with Arch Linux' <a href="../en/Web_application_package_guidelines.html" title="Web application package guidelines">web application package guidelines</a>. This means among other details that Grav must be run with its own system user (<i>grav</i>). So it is not possible anymore to execute the PHP code directly in the Apache process by means of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-apache">php-apache</a></span>.
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/grav/">grav</a></span><sup><small>AUR</small></sup> package. This automatically takes care of installing the two requires dependencies <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php">php</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-gd">php-gd</a></span>. Also install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-apcu">php-apcu</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/php-yaml/">php-yaml</a></span><sup><small>AUR</small></sup> - preferrably as a dependency (<code>--asdeps</code>). Comment the only line in <code>/etc/php/conf.d/yaml.ini</code>. Do not modify <code>/etc/php/conf.d/apcu.ini</code>, i.e. leave the only line commented. Activating these two extensions for Grav will be taken care of in other places (see below).
</p>
<h2><span class="mw-headline" id="Application_server">Application server</span></h2>
<p>There are two prevalent application servers that can be used to process PHP code: <a href="../en/UWSGI.html" title="UWSGI">uWSGI</a> or <a rel="nofollow" class="external text" href="https://cwiki.apache.org/confluence/display/HTTPD/PHP-FPM">FPM</a>. <i>FPM</i> as the name suggests is specialized on PHP. The protocol used between the web server and <i>FPM</i> is <i>fastcgi</i>. The tool is has been <a rel="nofollow" class="external text" href="https://www.php.net/manual/en/install.fpm.php">part of the PHP distribution</a> since many years and is actively maintained. The downside being that the <a rel="nofollow" class="external text" href="https://www.php.net/manual/en/install.fpm.configuration.php">official documentation</a> leaves much room for improvement. <i>uWSGI</i> on the other hand can serve code written in a <a rel="nofollow" class="external text" href="https://uwsgi-docs.readthedocs.io/en/latest/LanguagesAndPlatforms.html">handful of languages</a> by means of language specific plugins. The protocol used is <i>uwsgi</i> (lowercase). The tool is <a rel="nofollow" class="external text" href="https://uwsgi-docs.readthedocs.io/en/latest/index.html">extensively documented</a> - albeit the sheer amount of documentation can become confusing and unwieldy. Maintainance has <a rel="nofollow" class="external text" href="https://github.com/unbit/uwsgi/commits/master">slowed down</a> significantly - this applies especially for the <a rel="nofollow" class="external text" href="https://github.com/unbit/uwsgi/commits/master/plugins/php">PHP plugin</a>.
</p>
<h3><span class="mw-headline" id="uWSGI">uWSGI</span></h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> As of 2022-01-04 when PHP 8.1 became available in Arch Linux' Extra repository the PHP plugin of uWSGI was broken. (See <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/73470">FS#73470</a>) As of release 2.0.20-5 of this plugin it is working for now but note there are <a rel="nofollow" class="external text" href="https://github.com/unbit/uwsgi/issues/2287">concerns</a> about the long-term viability of the project.</div>
<p>uWSGI has its own <a href="../en/UWSGI.html" title="UWSGI">article</a>. A lot of useful information can be found there. Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=uwsgi">uwsgi</a></span> and the plugin <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=uwsgi-plugin-php">uwsgi-plugin-php</a></span> - preferrably as dependencies, i.e. with <code>--asdeps</code>. Setup of your Grav application requires only copying one file and defining one systemd service.
</p>
<h4><span class="mw-headline" id="grav.ini">grav.ini</span></h4>
<p>Copy the Grav specific uWSGI setup file to the appropriate location.
</p>
<pre># cp /usr/share/webapps/grav/webserver-configs/uwsgi-grav.ini /etc/uwsgi/grav.ini
</pre>
<p>Make sure <code>grav.ini</code> is owned and only writeable by root, i.e. <code>-rw-r--r-- 1 root root ... grav.ini</code>. This configuration is functional but feel free to adapt it to your liking. E.g. you might like to change <code>php-set = date.timezone=</code> to your preferred timezone.
</p>
<h4><span class="mw-headline" id="Systemd_service">Systemd service</span></h4>
<p>The package <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=uwsgi">uwsgi</a></span> provides a template unit file (<code>uwsgi@.service</code>). The instance ID (here <i>grav</i>) is used to pick up the right configuration file. So we <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start/enable">start/enable</a> <code>uwsgi@grav.service</code>. 
</p>
<p>In case you have more than a few (e.g. 2) services started like this and get the impression this is a waste of resource you might consider using <a rel="nofollow" class="external text" href="https://uwsgi-docs.readthedocs.io/en/latest/Emperor.html">emperor mode</a>.
</p>
<h3><span class="mw-headline" id="FPM">FPM</span></h3>
<p>In case you opt to use <i>FPM</i> as your application server install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-fpm">php-fpm</a></span> - preferrably as a dependent package (<code>--asdeps</code>).
</p>
<p>You have to tweak its configuration a little bit.
</p>
<h4><span class="mw-headline" id="php-fpm.ini">php-fpm.ini</span></h4>
<p>It is a good practice to run <i>FPM</i> with its own version of <code>php.ini</code>. You thus avoid cluttering the standard INI file (<code>/etc/php/php.ini</code>) with stuff only needed by <i>FPM</i>. There is a copy of a functional INI file in <code>/usr/share/webapps/grav/webserver-configs</code>. Copy it to <code>/etc/php</code>.
</p>
<pre># cp /usr/share/webapps/grav/webserver-configs/php-fpm.ini /etc/php
</pre>
<p>Make sure it is owned and only writeable by root. Something along <code>-rw-r--r-- 1 root root ... php-fpm.ini</code>. Feel free to customize the configuration as you see fit.
</p>
<h4><span class="mw-headline" id="grav.conf">grav.conf</span></h4>
<p>You have to create a so called <i>pool file</i> for <i>FPM</i>. It is responsible for spawning a dedicated <i>FPM</i> process for the Grav application. Copy the version provided by the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/grav/">grav</a></span><sup><small>AUR</small></sup> package.
</p>
<pre># cp /usr/share/webapps/grav/webserver-configs/php-fpm.d/grav.conf /etc/php/php-fpm.d
</pre>
<p>Again make sure this pool file is owned and only writeable by root (i.e. <code>-rw-r--r-- 1 root root ... grav.conf</code>). You may tweak some settings (especially <code>pm...</code> and <code>php_admin_value[date.timezone]</code> to your liking.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> The package <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-fpm">php-fpm</a></span> comes with its own pool file <code>www.conf</code> that is of little use here. A good approach to get rid of it is to rename it to <code>www.conf.package</code> and create a file <code>www.conf</code> with only comment lines (lines starting with a semicolon). This way <code>www.conf</code> becomes a no-op. It is also not overwritten during installation of a new version of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-fpm">php-fpm</a></span>. Instead a file <code>www.conf.pacnew</code> is created. You can compare this against <code>www.conf.package</code> to see if anything significant has changed in the pool file that you may have to reproduce in <code>grav.conf</code>. Do not forget to rename <code>www.conf.pacnew</code> to <code>www.conf.package</code> at the end of this procedure.</div>
<h4><span class="mw-headline" id="Systemd_service_2">Systemd service</span></h4>
<p><i>FPM</i> is run as a systemd service. You have to modify the service configuration to be able to run Grav. This is best achieved by means of a <a href="../en/Systemd.html#Drop-in_files" class="mw-redirect" title="Drop-in file">drop-in file</a>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/php-fpm.service.d/override.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Service]
ExecStart=
ExecStart=/usr/bin/php-fpm --nodaemonize --fpm-config /etc/php/php-fpm.conf --php-ini /etc/php/php-fpm.ini
ReadWritePaths=/etc/webapps/grav/config
PrivateTmp=false</pre>
<p>The drop-in file has three purposes.
</p>
<ul>
<li>It replaces the <code>ExecStart</code> line by a start command that uses the <code>php-fpm.ini</code> covered in the previous section.</li>
<li>It explicitly enables read/write access on <code>/etc/webapps/grav/config</code> that would otherwise be inhibited by <code>ProtectSystem=full</code> in <code>/usr/lib/systemd/system/php-fpm.service</code>.</li>
<li>It disables the <code>PrivateTmp</code> option set in <code>/usr/lib/systemd/system/php-fpm.service</code> as this doesn't work together with <code>php_admin_value[open_basedir] =  …:/var/tmp/$pool:…</code> in <code>/etc/php/php-fpm.d/grav.conf</code>.</li>
</ul>
<p>Do not forget to <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start/enable">start/enable</a> <code>php-fpm.service</code>.
</p>
<h2><span class="mw-headline" id="Web_server">Web server</span></h2>
<p>There is an abundance of web servers you can choose from. Whatever option you finally choose you have to keep in mind that the Grav application needs to be run with its own system user <i>grav</i>. So you probably need to forward your requests to one of the above mentioned application servers.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Some of the web server specific sample files provided in <code>/usr/share/webapps/grav/webserver-configs</code> (except <code>nginx.conf</code>) might be outdated.</div>
<h3><span class="mw-headline" id="nginx">nginx</span></h3>
<p>Configuration of <i>nginx</i> is way beyond the scope of this article. See the relevant <a href="../en/Nginx.html" title="Nginx">article</a> for further information. The package <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/grav/">grav</a></span><sup><small>AUR</small></sup> comes with a sample configuration file <code>/usr/share/webapps/grav/webserver-configs/nginx.conf</code>. This file is not functional as is. Use it as a starting point for your own configuration. Most likely you will have to copy it into <code>/etc/nginx/sites-available</code> with an appropriate name and create the corresponding symbolic link in <code>/etc/nginx/sites-enabled</code>.
</p>
<p>The sample file assumes you are using SSL/TLS and some ACME client (e.g. <a href="../en/Certbot.html" title="Certbot">Certbot</a>) to get your certificates. <a href="https://en.wikipedia.org/wiki/OCSP_stapling" class="extiw" title="wikipedia:OCSP stapling">OCSP stapling</a> is not configured.
</p>
<p>Things you might have to adapt (not exhaustive):
</p>
<ul>
<li>Your server name (<code>server_name</code> clauses 2x), i.e. the server part of the URL your Grav installation will be reachable with.</li>
<li>The name of the certificate and key you use for SSL / TLS.</li>
<li>If and where you want an access log written to.</li>
<li>The location where <a href="../en/Certbot.html" title="Certbot">Certbot</a> (or any other ACME client) will put the domain verification challenges.</li>
<li>The path under which your Grav installation will be reachable. (The part right to the server name &amp; port section in the URL.)</li>
<li>What application server (uWSGI or FPM) you are using, i.e. how and where nginx will pass requests that need to trigger some PHP code.</li>
</ul>
<p>There is no need to install any additional modules since nginx natively supports both protocols FastCGI and uwsgi.
</p>
<p>Grav's <a rel="nofollow" class="external text" href="https://learn.getgrav.org/17/webservers-hosting/servers/nginx">documentation</a> also covers setting up Grav with nginx. But be aware that the instructions are Ubuntu / Debian centric and do not mention uWSGI.
</p>
<h3><span class="mw-headline" id="Apache_HTTP_Server">Apache HTTP Server</span></h3>
<p>Unfortunately upstream Grav does not provide a sample configuration file for <a href="../en/Apache_HTTP_Server.html" title="Apache HTTP Server">Apache HTTP Server</a>. At least there is a <a href="../en/Apache_HTTP_Server.html#Using_php-fpm_and_mod_proxy_fcgi" title="Apache HTTP Server">section</a> in this wiki about how to integrate Apache with PHP by means of FPM and mod_proxy_fcgi. uWSGI's <a rel="nofollow" class="external text" href="https://uwsgi-docs.readthedocs.io/en/latest/Apache.html">documentation</a> has some information about how to integrate Apache with PHP by means of uWSGI and mod_proxy_uwsgi. Mind that the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=apache">apache</a></span> package comes with both modules mod_proxy_fcgi and mod_proxy_uwsgi. They need to be loaded as required.
</p>
<h2><span class="mw-headline" id="Plugins">Plugins</span></h2>
<p>A lot of Grav's power comes from the large <a rel="nofollow" class="external text" href="https://getgrav.org/downloads/plugins">set of plugins</a> that can be installed. Just follow the <a rel="nofollow" class="external text" href="https://learn.getgrav.org/17/plugins/plugin-install">instructions</a> on Grav's documentation how to install plugins.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> When installing plugins from the command line make sure to perform these commands as user <i>grav</i>. E.g. <pre># runuser -u grav -- bin/gpm install admin</pre> Otherwise you will sooner or later run into permission issues.</div>
<p>Currently there are no <i>grav-plugin-...</i> packages that allow installing plugins via <code>pacman</code> (or some AUR wrapper). This will probably not change in the foreseeable future.
</p>
<h2><span class="mw-headline" id="Content">Content</span></h2>
<p>See the extensive <a rel="nofollow" class="external text" href="https://learn.getgrav.org/17/content">documentation</a> on Grav's website on how to create content with this CMS.
</p>
<h3><span class="mw-headline" id="Skeletons">Skeletons</span></h3>
<p>Chances are the big empty board named Grav appears too intimidating to you. In this case you may want to use one of the many <a rel="nofollow" class="external text" href="https://getgrav.org/downloads/skeletons">skeletons</a> as a starting point. Skeletons are prefabricated bundles of Grav itself, some plugins, a theme and some sample content that give you some bits and pieces to play around with. Skeletons are supposed to be installed instead of a bare Grav installation. Unfortunately this makes it impossible to use a skeleton together with the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/grav/">grav</a></span><sup><small>AUR</small></sup> package.
</p>
<p>With a bit of fiddling you can import the content of an arbitrary skeleton into your existing Grav installation.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> The following procedure will overwrite your current content. If you want to step back make backups of the directories <code>/var/lib/grav/user</code> and <code>/etc/webapps/grav/config</code>.</div>
<ol>
<li>Download the desired skeleton.</li>
<li>Extract the <code>user</code> directory: <pre># bsdtar -xf grav-skeleton-blahblah.zip user</pre>
</li>
<li>Replace the directories <code>pages</code>, <code>plugins</code> and <code>themes</code> in <code>/var/lib/grav/user</code> with the corresponding directories from the extracted <code>user</code> directory.</li>
<li>Fix ownership and permissions <pre># chown -R grav:http /var/lib/grav/user/{pages,plugins,themes}<br># chmod -R 640 /var/lib/grav/user/{pages,plugins,themes}<br># find /var/lib/grav/user/{pages,plugins,themes} -type d -exec chmod 750 {} \;</pre>
</li>
<li>Replace the configuration files <code>site.yaml</code> <code>system.yaml</code> in <code>/etc/webapps/grav/config</code> with the corresponding files from the extracted <code>user/config</code>.</li>
<li>Fix ownership and permissions <pre># chown grav:grav /etc/webapps/grav/config/{site,system}.yaml<br># chmod 644 /etc/webapps/grav/config/{site,system}.yaml</pre>
</li>
</ol>
<h2><span class="mw-headline" id="Migrating_from_v1.6_to_v1.7">Migrating from v1.6 to v1.7</span></h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Migrating from earlier versions (&lt; 1.7) of the package has been poorly tested (due to technical reasons). Please help to improve this section.</div>
<p>Migrating from earlier package versions (&lt; 1.7) will most likely require manual intervention. Errors may happen. So <b>backup your data</b> before trying an upgrade from earlier version! This comprises at least the <code>/usr/share/webapps/grav/user</code> directory.
</p>
<p>The upgrade will probably fail right away with lots of error messages complaining about files already existing under <code>/usr/share/webapps/grav/vendor</code>. Just delete this directory.
</p>
<p>Since the last package of version 1.6 (v1.6.28, 2020-11-18) <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php">php</a></span> has been upgraded from version 7 to 8. This may render some of your plugins non-functional.
</p>
<p>Grav v1.7 has become stricter in many ways. See Grav's <a rel="nofollow" class="external text" href="https://learn.getgrav.org/17/advanced/grav-development/grav-17-upgrade-guide">migration guide</a> about details.
</p>
<p>Do not try to tweak your setup to use system user <i>http</i> as used to be. For good reasons Arch Linux' <a href="../en/Web_application_package_guidelines.html" title="Web application package guidelines">web application package guidelines</a> dictates to use a dedicated system user (here <i>grav</i>) to run the application.
</p>
<p>Probably the best migration strategy is to backup the <code>/usr/share/webapps/grav/user</code> directory, uninstall Grav and all <a href="../en/Pacman/Tips_and_tricks.html#Removing_unused_packages_(orphans)" title="Pacman/Tips and tricks">dependent packages</a>, remove all remnants of the Grav installation (including all Grav specific configurations with your web server and application server), update your system (including PHP) and then install Grav from scratch. When everything is set up and your server successfully presents Grav's default page you can start to restore your previous content.
</p>
<h2><span class="mw-headline" id="Upgrade">Upgrade</span></h2>
<p>Upgrading Grav itself must exclusively be done by <a href="../en/Pacman.html" title="Pacman">pacman</a> (or some AUR wrapper)!
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Do not try to upgrade Grav itself with <code>gpm</code> as described in Grav's <a rel="nofollow" class="external text" href="https://learn.getgrav.org/17/basics/updates">update documentation</a> or via the admin plugin. At best this will simply not work, at worst it will ruin your installation.</div>
<p>Unlike upgrading Grav itself, upgrading plugins and themes must be done with <code>gpm update</code> or via the admin plugin.
</p>
<p>Also not recommended is to download Grav releases as ZIP archives directly from Grav's GitHub project site and copy around stuff in the filesystem. Only do so when you know exactly what you are doing.
</p>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Content_management_systems.html" title="Category:Content management systems">Content management systems</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Grav&amp;oldid=765401">https://wiki.archlinux.org/index.php?title=Grav&amp;oldid=765401</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 27 January 2023, at 21:35.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki.svg" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul></ul>
</div>
</body>
</html>
