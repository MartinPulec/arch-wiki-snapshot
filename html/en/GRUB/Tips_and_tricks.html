<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>GRUB/Tips and tricks - ArchWiki</title>
<link rel="stylesheet" href="../../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-GRUB_Tips_and_tricks rootpage-GRUB skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Alternative_installation_methods" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Alternative_installation_methods">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Alternative installation methods</div>
		</a>
		
			<button aria-controls="toc-Alternative_installation_methods-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Alternative installation methods subsection</span>
			</button>
		
		<ul id="toc-Alternative_installation_methods-sublist" class="vector-toc-list">
			<li id="toc-Install_to_external_USB_stick" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Install_to_external_USB_stick">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1</span>Install to external USB stick</div>
			</a>
			
			<ul id="toc-Install_to_external_USB_stick-sublist" class="vector-toc-list">
				<li id="toc-BIOS" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#BIOS">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1.1</span>BIOS</div>
			</a>
			
			<ul id="toc-BIOS-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-EFI" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#EFI">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1.2</span>EFI</div>
			</a>
			
			<ul id="toc-EFI-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Install_to_partition_or_partitionless_disk" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Install_to_partition_or_partitionless_disk">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.2</span>Install to partition or partitionless disk</div>
			</a>
			
			<ul id="toc-Install_to_partition_or_partitionless_disk-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Generate_core.img_alone" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Generate_core.img_alone">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.3</span>Generate core.img alone</div>
			</a>
			
			<ul id="toc-Generate_core.img_alone-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-GUI_configuration_tools" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#GUI_configuration_tools">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>GUI configuration tools</div>
		</a>
		
		<ul id="toc-GUI_configuration_tools-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-drop-in_configuration" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#drop-in_configuration">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>drop-in configuration</div>
		</a>
		
		<ul id="toc-drop-in_configuration-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Visual_configuration" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Visual_configuration">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Visual configuration</div>
		</a>
		
			<button aria-controls="toc-Visual_configuration-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Visual configuration subsection</span>
			</button>
		
		<ul id="toc-Visual_configuration-sublist" class="vector-toc-list">
			<li id="toc-Setting_the_framebuffer_resolution" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Setting_the_framebuffer_resolution">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>Setting the framebuffer resolution</div>
			</a>
			
			<ul id="toc-Setting_the_framebuffer_resolution-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Background_image_and_bitmap_fonts" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Background_image_and_bitmap_fonts">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2</span>Background image and bitmap fonts</div>
			</a>
			
			<ul id="toc-Background_image_and_bitmap_fonts-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Theme" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Theme">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.3</span>Theme</div>
			</a>
			
			<ul id="toc-Theme-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Menu_colors" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Menu_colors">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4</span>Menu colors</div>
			</a>
			
			<ul id="toc-Menu_colors-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Hidden_menu" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Hidden_menu">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.5</span>Hidden menu</div>
			</a>
			
			<ul id="toc-Hidden_menu-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Disable_framebuffer" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Disable_framebuffer">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.6</span>Disable framebuffer</div>
			</a>
			
			<ul id="toc-Disable_framebuffer-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Booting_ISO9660_image_file_directly_via_GRUB" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Booting_ISO9660_image_file_directly_via_GRUB">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Booting ISO9660 image file directly via GRUB</div>
		</a>
		
		<ul id="toc-Booting_ISO9660_image_file_directly_via_GRUB-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Password_protection_of_GRUB_menu" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Password_protection_of_GRUB_menu">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>Password protection of GRUB menu</div>
		</a>
		
			<button aria-controls="toc-Password_protection_of_GRUB_menu-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Password protection of GRUB menu subsection</span>
			</button>
		
		<ul id="toc-Password_protection_of_GRUB_menu-sublist" class="vector-toc-list">
			<li id="toc-Password_protection_of_GRUB_edit_and_console_options_only" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Password_protection_of_GRUB_edit_and_console_options_only">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.1</span>Password protection of GRUB edit and console options only</div>
			</a>
			
			<ul id="toc-Password_protection_of_GRUB_edit_and_console_options_only-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Hide_GRUB_unless_the_Shift_key_is_held_down" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Hide_GRUB_unless_the_Shift_key_is_held_down">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">7</span>Hide GRUB unless the Shift key is held down</div>
		</a>
		
		<ul id="toc-Hide_GRUB_unless_the_Shift_key_is_held_down-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Combining_the_use_of_UUIDs_and_basic_scripting" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Combining_the_use_of_UUIDs_and_basic_scripting">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">8</span>Combining the use of UUIDs and basic scripting</div>
		</a>
		
		<ul id="toc-Combining_the_use_of_UUIDs_and_basic_scripting-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Multiple_entries" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Multiple_entries">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">9</span>Multiple entries</div>
		</a>
		
			<button aria-controls="toc-Multiple_entries-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Multiple entries subsection</span>
			</button>
		
		<ul id="toc-Multiple_entries-sublist" class="vector-toc-list">
			<li id="toc-Disable_submenu" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Disable_submenu">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">9.1</span>Disable submenu</div>
			</a>
			
			<ul id="toc-Disable_submenu-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Recall_previous_entry" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Recall_previous_entry">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">9.2</span>Recall previous entry</div>
			</a>
			
			<ul id="toc-Recall_previous_entry-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Changing_the_default_menu_entry" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Changing_the_default_menu_entry">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">9.3</span>Changing the default menu entry</div>
			</a>
			
			<ul id="toc-Changing_the_default_menu_entry-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Boot_non-default_entry_only_once" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Boot_non-default_entry_only_once">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">9.4</span>Boot non-default entry only once</div>
			</a>
			
			<ul id="toc-Boot_non-default_entry_only_once-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Play_a_tune" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Play_a_tune">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">10</span>Play a tune</div>
		</a>
		
		<ul id="toc-Play_a_tune-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Manual_configuration_of_core_image_for_early_boot" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Manual_configuration_of_core_image_for_early_boot">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">11</span>Manual configuration of core image for early boot</div>
		</a>
		
		<ul id="toc-Manual_configuration_of_core_image_for_early_boot-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-UEFI_further_reading" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#UEFI_further_reading">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">12</span>UEFI further reading</div>
		</a>
		
			<button aria-controls="toc-UEFI_further_reading-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle UEFI further reading subsection</span>
			</button>
		
		<ul id="toc-UEFI_further_reading-sublist" class="vector-toc-list">
			<li id="toc-Alternative_install_method" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Alternative_install_method">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">12.1</span>Alternative install method</div>
			</a>
			
			<ul id="toc-Alternative_install_method-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-UEFI_firmware_workaround" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#UEFI_firmware_workaround">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">12.2</span>UEFI firmware workaround</div>
			</a>
			
			<ul id="toc-UEFI_firmware_workaround-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-GRUB_standalone" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#GRUB_standalone">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">12.3</span>GRUB standalone</div>
			</a>
			
			<ul id="toc-GRUB_standalone-sublist" class="vector-toc-list">
				<li id="toc-Technical_information" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Technical_information">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">12.3.1</span>Technical information</div>
			</a>
			
			<ul id="toc-Technical_information-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-UEFI_and_BIOS_installation" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#UEFI_and_BIOS_installation">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">12.4</span>UEFI and BIOS installation</div>
			</a>
			
			<ul id="toc-UEFI_and_BIOS_installation-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Speeding_up_LUKS_decryption_in_GRUB" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Speeding_up_LUKS_decryption_in_GRUB">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">13</span>Speeding up LUKS decryption in GRUB</div>
		</a>
		
		<ul id="toc-Speeding_up_LUKS_decryption_in_GRUB-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">14</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">GRUB/Tips and tricks</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 3 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-3" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">3 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-es mw-list-item"><a href="../../es/GRUB/Tips_and_tricks.html" title="GRUB (Español)/Tips and tricks – español" lang="es" hreflang="es" class="interlanguage-link-target"><span>Español</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/GRUB/%E3%83%92%E3%83%B3%E3%83%88%E3%81%A8%E3%83%86%E3%82%AF%E3%83%8B%E3%83%83%E3%82%AF" title="GRUB/ヒントとテクニック – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/GRUB/Tips_and_tricks" title="GRUB/Tips and tricks – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"><div class="subpages">&lt; <a href="../../en/GRUB.html" title="GRUB">GRUB</a>
</div></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Alternative_installation_methods">Alternative installation methods</span></h2>
<h3><span class="mw-headline" id="Install_to_external_USB_stick">Install to external USB stick</span></h3>
<h4><span class="mw-headline" id="BIOS">BIOS</span></h4>
<p>Assume your USB stick's first partition is FAT32 and its partition is /dev/sdy1
</p>
<pre># mount --mkdir /dev/sdy1 /mnt/usb
# grub-install --target=i386-pc --debug --boot-directory=/mnt/usb/boot /dev/sdy
# grub-mkconfig -o /mnt/usb/boot/grub/grub.cfg
</pre>
<p>Optionally backup configuration files of <code>grub.cfg</code>:
</p>
<pre># mkdir -p /mnt/usb/etc/default
# cp /etc/default/grub /mnt/usb/etc/default
# cp -a /etc/grub.d /mnt/usb/etc
</pre>
<pre># sync; umount /mnt/usb
</pre>
<h4><span class="mw-headline" id="EFI">EFI</span></h4>
<p>To have grub write its EFI image to <code><i>esp</i>/EFI/BOOT/BOOTX64.efi</code>, which the boot firmware will be able to find without any UEFI boot entry, use <code>--removable</code> when you run <code>grub-install</code>.
</p>
<h3><span class="mw-headline" id="Install_to_partition_or_partitionless_disk">Install to partition or partitionless disk</span></h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> GRUB <b>strongly discourages</b> installation to a partition boot sector or a partitionless disk as GRUB Legacy or Syslinux does. This setup is prone to breakage, especially during updates, and is <b>not supported</b> by the Arch developers.</div>
<p>To set up grub to a partition boot sector, to a partitionless disk (also called superfloppy) or to a floppy disk, run (using for example <code>/dev/sdaX</code> as the <code>/boot</code> partition):
</p>
<pre># chattr -i /boot/grub/i386-pc/core.img
# grub-install --target=i386-pc --debug --force /dev/sdaX
# chattr +i /boot/grub/i386-pc/core.img
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>
<code>/dev/sdaX</code> used for example only.</li>
<li>
<code>--target=i386-pc</code> instructs <code>grub-install</code> to install for BIOS systems only. It is recommended to always use this option to remove ambiguity in <i>grub-install</i>.</li>
</ul>
</div>
<p>You need to use the <code>--force</code> option to allow usage of blocklists and should not use <code>--grub-setup=/bin/true</code> (which is similar to simply generating <code>core.img</code>).
</p>
<p><code>grub-install</code> will give out warnings like which should give you the idea of what might go wrong with this approach:
</p>
<pre>/sbin/grub-setup: warn: Attempting to install GRUB to a partitionless disk or to a partition. This is a BAD idea.
/sbin/grub-setup: warn: Embedding is not possible. GRUB can only be installed in this setup by using blocklists.
                        However, blocklists are UNRELIABLE and their use is discouraged.
</pre>
<p>Without <code>--force</code> you may get the below error and <code>grub-setup</code> will not setup its boot code in the partition boot sector:
</p>
<pre>/sbin/grub-setup: error: will not proceed with blocklists
</pre>
<p>With <code>--force</code> you should get:
</p>
<pre>Installation finished. No error reported.
</pre>
<p>The reason why <code>grub-setup</code> does not by default allow this is because in case of partition or a partitionless disk is that GRUB relies on embedded blocklists in the partition bootsector to locate the <code>/boot/grub/i386-pc/core.img</code> file and the prefix directory <code>/boot/grub</code>. The sector locations of <code>core.img</code> may change whenever the file system in the partition is being altered (files copied, deleted etc.). For more info, see <a rel="nofollow" class="external free" href="https://bugzilla.redhat.com/show_bug.cgi?id=728742">https://bugzilla.redhat.com/show_bug.cgi?id=728742</a> and <a rel="nofollow" class="external free" href="https://bugzilla.redhat.com/show_bug.cgi?id=730915">https://bugzilla.redhat.com/show_bug.cgi?id=730915</a>.
</p>
<p>The workaround for this is to set the immutable flag on <code>/boot/grub/i386-pc/core.img</code> (using <code>chattr</code> command as mentioned above) so that the sector locations of the <code>core.img</code> file in the disk is not altered. The immutable flag on <code>/boot/grub/i386-pc/core.img</code> needs to be set only if GRUB is installed to a partition boot sector or a partitionless disk, not in case of installation to MBR or simple generation of <code>core.img</code> without embedding any bootsector (mentioned above).
</p>
<p>Unfortunately, the <code>grub.cfg</code> file that is created will not contain the proper UUID in order to boot, even if it reports no errors. see <a rel="nofollow" class="external free" href="https://bbs.archlinux.org/viewtopic.php?pid=1294604#p1294604">https://bbs.archlinux.org/viewtopic.php?pid=1294604#p1294604</a>.
In order to fix this issue the following commands:
</p>
<pre># mount /dev/sdxY /mnt        #Your root partition.
# mount /dev/sdxZ /mnt/boot   #Your boot partition (if you have one).
# arch-chroot /mnt
</pre>
<p>Now, install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span>, then:
</p>
<pre># grub-mkconfig -o /boot/grub/grub.cfg
</pre>
<h3><span class="mw-headline" id="Generate_core.img_alone">Generate core.img alone</span></h3>
<p>To populate the <code>/boot/grub</code> directory and generate a <code>/boot/grub/i386-pc/core.img</code> file <b>without</b> embedding any GRUB bootsector code in the MBR, post-MBR region, or the partition bootsector, add <code>--grub-setup=/bin/true</code> to <code>grub-install</code>:
</p>
<pre># grub-install --target=i386-pc --grub-setup=/bin/true --debug /dev/sda
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>
<code>/dev/sda</code> used for example only.</li>
<li>
<code>--target=i386-pc</code> instructs <code>grub-install</code> to install for BIOS systems only. It is recommended to always use this option to remove ambiguity in grub-install.</li>
</ul>
</div>
<p>You can then chainload GRUB's <code>core.img</code> from GRUB Legacy or syslinux as a Linux kernel or as a multiboot kernel (see also <a href="../../en/Syslinux.html#Chainloading" title="Syslinux">Syslinux#Chainloading</a>).
</p>
<h2><span class="mw-headline" id="GUI_configuration_tools">GUI configuration tools</span></h2>
<ul><li>
<b>grub-customizer</b> — GTK customizer for GRUB or BURG</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://launchpad.net/grub-customizer">https://launchpad.net/grub-customizer</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=grub-customizer">grub-customizer</a></span>
</dd></dl>
<h2><span class="mw-headline" id="drop-in_configuration">drop-in configuration</span></h2>
<p>Instead of editing <code>/boot/grub/grub.cfg</code> configuration file, it's possible to use your custom settings as drop-in file like <code>/etc/default/grub.d/00-custom.cfg</code>. Note that you have to create <code>/etc/default/grub.d/</code> drop-in directory manually. Do not confuse this directory with <code>/etc/grub.d/</code>.
</p>
<h2><span class="mw-headline" id="Visual_configuration">Visual configuration</span></h2>
<p>In GRUB it is possible, by default, to change the look of the menu. Make sure to initialize the GRUB graphical terminal, gfxterm, in <code>/etc/default/grub</code>:
</p>
<pre>GRUB_TERMINAL_OUTPUT="gfxterm"
</pre>
<h3><span class="mw-headline" id="Setting_the_framebuffer_resolution">Setting the framebuffer resolution</span></h3>
<p>GRUB can set the framebuffer for both GRUB itself (<code>GFXMODE</code>) and the kernel (<code>GFXPAYLOAD</code>). The old <code>vga=</code> way is deprecated. The preferred method is editing <code>/etc/default/grub</code> to set width (pixels) x height (pixels) x <a href="https://en.wikipedia.org/wiki/color_depth" class="extiw" title="wikipedia:color depth">color depth</a>:
</p>
<pre>GRUB_GFXMODE=1024x768x32
GRUB_GFXPAYLOAD_LINUX=keep
</pre>
<p>Multiple resolutions can be specified, including the default <code>auto</code>, so it is recommended that you edit the line to resemble <code>GRUB_GFXMODE=<i>desired_resolution</i>,<i>fallback_such_as_1024x768</i>,auto</code>. For more information, refer to <a rel="nofollow" class="external text" href="https://www.gnu.org/software/grub/manual/grub/html_node/gfxmode.html">the GRUB gfxmode documentation</a>. The <a rel="nofollow" class="external text" href="https://www.gnu.org/software/grub/manual/html_node/gfxpayload.html#gfxpayload">gfxpayload</a> property will make sure the kernel keeps the resolution.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>Only the modes supported by the graphics card via <a href="https://en.wikipedia.org/wiki/VESA_BIOS_Extensions" class="extiw" title="wikipedia:VESA BIOS Extensions">VESA BIOS Extensions</a> can be used. To view the list of supported modes, install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=hwinfo">hwinfo</a></span> and run <code>hwinfo --framebuffer</code> as root. Alternatively, enter the GRUB command line and run the command <code>videoinfo</code>.</li>
<li>Earlier versions of the <a href="../../en/NVIDIA.html" title="NVIDIA">NVIDIA</a> proprietary driver (tested with GeForce GTX 970, driver: nvidia 370) accepts <code>GRUB_GFXMODE</code> in format <code><i>width</i>x<i>height</i>-<i>depth</i></code> (e.g. <code>1920x1200-24</code>, but not <code>1920x1200x24</code>). This does not appear to apply to newer cards and drivers. Pascal cards with more recent drivers (tested with GeForce GTX 1060 and nvidia 381.22) will not work with the suggested format and attempting to use it results in serious issues, including but not limited to system crashes and hard locks. The current driver and cards are best configured with <code>GRUB_GFXMODE</code> in the standard <code><i>width</i>x<i>height</i>x<i>depth</i></code> format.</li>
<li>Make sure to run <code>grub-mkconfig -o /boot/grub/grub.cfg</code> after making changes.</li>
</ul>
</div>
<p>If this method does not work for you, the deprecated <code>vga=</code> method will still work. Just add it next to the <code>"GRUB_CMDLINE_LINUX_DEFAULT="</code> line in <code>/etc/default/grub</code> for example: <code>"GRUB_CMDLINE_LINUX_DEFAULT="quiet splash vga=792"</code> will give you a <code>1024x768</code> resolution.
</p>
<h3><span class="mw-headline" id="Background_image_and_bitmap_fonts">Background image and bitmap fonts</span></h3>
<p>GRUB comes with support for background images and bitmap fonts in <code>pf2</code> format. The unifont font is included in the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=grub">grub</a></span> package under the filename <code>unicode.pf2</code>, or, as only ASCII characters under the name <code>ascii.pf2</code>. Run <code>pacman -Ql grub | grep pf2</code> to get the file paths.
</p>
<p>Image formats supported include tga, png and jpeg, providing the correct modules are loaded. The maximum supported resolution depends on your hardware.
</p>
<p>Make sure you have set up the proper <a href="#Setting_the_framebuffer_resolution">framebuffer resolution</a>.
</p>
<p>Edit <code>/etc/default/grub</code> like this:
</p>
<pre>GRUB_BACKGROUND="/boot/grub/myimage"
#GRUB_THEME="/path/to/gfxtheme"
GRUB_FONT="/path/to/font.pf2"
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you have installed GRUB on a separate partition, <code>/boot/grub/myimage</code> automatically becomes <code>/grub/myimage</code> in <code>grub.cfg</code>.</div>
<p><a href="../../en/GRUB.html#Generate_the_main_configuration_file" title="GRUB">Re-generate</a> <code>grub.cfg</code> to apply the changes. If adding the splash image was successful, the user will see <code>"Found background image..."</code> in the terminal as the command is executed. If this phrase is not seen, the image information was probably not incorporated into the <code>grub.cfg</code> file.
</p>
<p>If the image is not displayed, check:
</p>
<ul>
<li>The path and the filename in <code>/etc/default/grub</code> are correct</li>
<li>The image is of the proper size and format (tga, png, 8-bit jpg)</li>
<li>The image was saved in the RGB mode, and is not indexed</li>
<li>The console mode is not enabled in <code>/etc/default/grub</code>
</li>
<li>The command <code>grub-mkconfig</code> must be executed to place the background image information into the <code>/boot/grub/grub.cfg</code> file</li>
<li>The <code>grub-mkconfig</code> scripts will not quote the file name in <code>grub.cfg</code> so make sure it does not contain spaces</li>
</ul>
<h3><span class="mw-headline" id="Theme">Theme</span></h3>
<p>Here is an example for configuring Starfield theme which was included in GRUB package.
</p>
<p>Edit <code>/etc/default/grub</code>:
</p>
<pre>GRUB_THEME="/usr/share/grub/themes/starfield/theme.txt"
</pre>
<p><a href="../../en/GRUB.html#Generate_the_main_configuration_file" title="GRUB">Re-generate</a> <code>grub.cfg</code> to apply the changes. If configuring the theme was successful, you will see <code>Found theme: /usr/share/grub/themes/starfield/theme.txt</code> in the terminal.
</p>
<p>Your splash image will usually not be displayed when using a theme.
</p>
<h3><span class="mw-headline" id="Menu_colors">Menu colors</span></h3>
<p>You can set the menu colors in GRUB. The available colors for GRUB can be found in <a rel="nofollow" class="external text" href="https://www.gnu.org/software/grub/manual/html_node/Theme-file-format.html">the GRUB Manual</a>.
Here is an example:
</p>
<p>Edit <code>/etc/default/grub</code>:
</p>
<pre>GRUB_COLOR_NORMAL="light-blue/black"
GRUB_COLOR_HIGHLIGHT="light-cyan/blue"
</pre>
<h3><span class="mw-headline" id="Hidden_menu">Hidden menu</span></h3>
<p>One of the unique features of GRUB is hiding/skipping the menu and showing it by holding <code>Esc</code> when needed. You can also adjust whether you want to see the timeout counter.
</p>
<p>Edit <code>/etc/default/grub</code> as you wish. Here are the lines you need to add to enable this feature, the timeout has been set to five seconds and to be shown to the user:
</p>
<pre>GRUB_TIMEOUT=5
GRUB_TIMEOUT_STYLE='countdown'
</pre>
<p><code>GRUB_TIMEOUT</code> is how many seconds before displaying menu.
</p>
<h3><span class="mw-headline" id="Disable_framebuffer">Disable framebuffer</span></h3>
<p>Users who use NVIDIA proprietary driver might wish to disable GRUB's framebuffer as it can cause problems with the binary driver.
</p>
<p>To disable framebuffer, edit <code>/etc/default/grub</code> and uncomment the following line:
</p>
<pre>GRUB_TERMINAL_OUTPUT=console
</pre>
<p>Another option if you want to keep the framebuffer in GRUB is to revert to text mode just before starting the kernel. To do that modify the variable in <code>/etc/default/grub</code>:
</p>
<pre>GRUB_GFXPAYLOAD_LINUX=text
</pre>
<h2><span class="mw-headline" id="Booting_ISO9660_image_file_directly_via_GRUB">Booting ISO9660 image file directly via GRUB</span></h2>
<p>GRUB supports booting from ISO images directly via loopback devices, see <a href="../../en/Multiboot_USB_drive.html#Using_GRUB_and_loopback_devices" title="Multiboot USB drive">Multiboot USB drive#Using GRUB and loopback devices</a> for examples.
</p>
<h2><span class="mw-headline" id="Password_protection_of_GRUB_menu">Password protection of GRUB menu</span></h2>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> If someone has physical access to your machine and is able to boot a live USB/disk (<i>i.e.</i>, BIOS allows booting from an external disk), it is fairly trivial for one to modify GRUB configuration files to bypass this if <code>/boot</code> resides on an unencrypted partition. See <a href="../../en/GRUB.html#Encrypted_/boot" title="GRUB">GRUB#Encrypted /boot</a> and <a href="../../en/Security.html#Data-at-rest_encryption" title="Security">Security#Data-at-rest encryption</a>.</div>
<p>If you want to secure GRUB so it is not possible for anyone to change boot parameters or use the command line, you can add an username and password to GRUB's configuration files. To do this, run the command <code>grub-mkpasswd-pbkdf2</code>, then enter a password and confirm it:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ grub-mkpasswd-pbkdf2</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[...]
PBKDF2 hash of your password is grub.pbkdf2.sha512.10000.C8ABD3E93C4DFC83138B0C7A3D719BC650E6234310DA069E6FDB0DD4156313DA3D0D9BFFC2846C21D5A2DDA515114CF6378F8A064C94198D0618E70D23717E82.509BFA8A4217EAD0B33C87432524C0B6B64B34FBAD22D3E6E6874D9B101996C5F98AB1746FE7C7199147ECF4ABD8661C222EEEDB7D14A843261FFF2C07B1269A
</pre>
<p>Then, adjust permissions on <code>/etc/grub.d/40_custom</code> such that only root can read it by running <code>chmod o-r /etc/grub.d/40_custom</code>. Then modify the file as following:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/grub.d/40_custom</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">set superusers="<b>username</b>"
password_pbkdf2 <b>username <i>password-hash</i></b></pre>
<p>where <code><i>password-hash</i></code> is the string starting with <i>grub.pbkdf2</i> generated by <code>grub-mkpasswd_pbkdf2</code>.
</p>
<p>Regenerate your configuration file with <code>grub-mkconfig</code>. Accessing the GRUB command line, <i>boot parameters</i> and also <b>booting an entry</b> now require the specified username and password. Note, that the latter can prevent by following the next topic.
</p>
<p>This can be relaxed and further customized with more users as described in the "Security" part of <a rel="nofollow" class="external text" href="https://www.gnu.org/software/grub/manual/grub.html#Security">the GRUB manual</a>.
</p>
<h3><span class="mw-headline" id="Password_protection_of_GRUB_edit_and_console_options_only">Password protection of GRUB edit and console options only</span></h3>
<p>Adding <code>--unrestricted</code> to a menu entry will allow any user to boot the OS while preventing the user from editing the entry and preventing access to the grub command console.
Only a superuser or users specified with the <code>--user</code> switch will be able to edit the menu entry.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/boot/grub/grub.cfg</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">menuentry 'Arch Linux' --unrestricted --class arch --class gnu-linux --class os ...</pre>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../../File:Inaccurate.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>The factual accuracy of this article or section is disputed.</b></p>
<div>
<b>Reason:</b> <code>/etc/grub.d/10_linux</code> should not be edited, it will be overwritten when <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=grub">grub</a></span> is updated. (Discuss in <a rel="nofollow" class="external text" href="../../en/Talk:GRUB/Tips_and_tricks.html">Talk:GRUB/Tips and tricks</a>)</div>
</div>
<p>In order to make Linux entries <code>--unrestricted</code>, the <code>CLASS</code> variable in the beginning of <code>/etc/grub.d/10_linux</code> can be modified.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/grub.d/10_linux</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">CLASS="--class gnu-linux --class gnu --class os --unrestricted"</pre>
<h2><span class="mw-headline" id="Hide_GRUB_unless_the_Shift_key_is_held_down">Hide GRUB unless the Shift key is held down</span></h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This does not work on <a rel="nofollow" class="external text" href="https://bugs.launchpad.net/ubuntu/+source/grub2/+bug/425979">UEFI systems</a>, because the firmware does not provide a way to detect the state of the modifier key.</div>
<p>In order to achieve the fastest possible boot, instead of having GRUB wait for a timeout, it is possible for GRUB to hide the menu, unless the <code>Shift</code> key is held down during GRUB's start-up.
</p>
<p>In order to achieve this, you should add the following line to <code>/etc/default/grub</code>:
</p>
<pre>GRUB_FORCE_HIDDEN_MENU="true"
</pre>
<p>Then create the file <code>/etc/grub.d/31_hold_shift</code> containing  <a rel="nofollow" class="external autonumber" href="https://gist.githubusercontent.com/anonymous/8eb2019db2e278ba99be/raw/257f15100fd46aeeb8e33a7629b209d0a14b9975/gistfile1.sh">[1]</a>, make it <a href="../../en/Help:Reading.html#Make_executable" class="mw-redirect" title="Executable">executable</a>, and regenerate the grub configuration:
</p>
<pre># grub-mkconfig -o /boot/grub/grub.cfg
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This setup uses keystatus to detect keypress event so it may not work on some machines.</div>
<h2><span class="mw-headline" id="Combining_the_use_of_UUIDs_and_basic_scripting">Combining the use of UUIDs and basic scripting</span></h2>
<p>If you like the idea of using UUIDs to avoid unreliable BIOS mappings or are struggling with GRUB's syntax, here is an example boot menu item that uses UUIDs and a small script to direct GRUB to the proper disk partitions for your system. All you need to do is replace the UUIDs in the sample with the correct UUIDs for your system. The example applies to a system with a boot and root partition. You will obviously need to modify the GRUB configuration if you have additional partitions:
</p>
<pre>menuentry "Arch Linux 64" {
    # Set the UUIDs for your boot and root partition respectively
    set the_boot_uuid=ece0448f-bb08-486d-9864-ac3271bd8d07
    set the_root_uuid=c55da16f-e2af-4603-9e0b-03f5f565ec4a

    # (Note: This may be the same as your boot partition)

    # Get the boot/root devices and set them in the root and grub_boot variables
    search --fs-uuid $the_root_uuid --set=root
    search --fs-uuid $the_boot_uuid --set=grub_boot

    # Check to see if boot and root are equal.
    # If they are, then append /boot to $grub_boot (Since $grub_boot is actually the root partition)
    if [ $the_boot_uuid == $the_root_uuid ] ; then
        set grub_boot=($grub_boot)/boot
    else
        set grub_boot=($grub_boot)
    fi

    # $grub_boot now points to the correct location, so the following will properly find the kernel and initrd
    linux $grub_boot/vmlinuz-linux root=/dev/disk/by-uuid/$the_root_uuid ro
    initrd $grub_boot/initramfs-linux.img
}
</pre>
<h2><span class="mw-headline" id="Multiple_entries">Multiple entries</span></h2>
<h3><span class="mw-headline" id="Disable_submenu">Disable submenu</span></h3>
<p>If you have multiple kernels installed, say linux and linux-lts, by default <code>grub-mkconfig</code> groups them in a submenu. If you do not like this behaviour you can go back to one single menu by adding the following line to <code>/etc/default/grub</code>:
</p>
<pre>GRUB_DISABLE_SUBMENU=y
</pre>
<h3><span class="mw-headline" id="Recall_previous_entry">Recall previous entry</span></h3>
<p>GRUB can remember the last entry you booted from and use this as the default entry to boot from next time. This is useful if you have multiple kernels (i.e., the current Arch one and the LTS kernel as a fallback option) or operating systems. To do this, edit <code>/etc/default/grub</code> and change the value of <code>GRUB_DEFAULT</code>:
</p>
<pre>GRUB_DEFAULT=saved
</pre>
<p>This ensures that GRUB will default to the saved entry. To enable saving the selected entry, add the following line to <code>/etc/default/grub</code>:
</p>
<pre>GRUB_SAVEDEFAULT=true
</pre>
<p>This will only work if /boot is not a btrfs, because grub cannot write to btrfs.  But it will generate a misleading error message: "sparse file not allowed. Press any key to continue.". 
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Manually added menu items, e.g. Windows in <code>/etc/grub.d/40_custom</code> or <code>/boot/grub/custom.cfg</code>, will need <code>savedefault</code> added.</div>
<h3><span class="mw-headline" id="Changing_the_default_menu_entry">Changing the default menu entry</span></h3>
<p>To change the default selected entry, edit <code>/etc/default/grub</code> and change the value of <code>GRUB_DEFAULT</code>:
</p>
<p>Using menu titles:
</p>
<pre>GRUB_DEFAULT='Advanced options for Arch Linux&gt;Arch Linux, with Linux linux'
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you are using a non-English locale, the generated menu title may be different from the example above. It might be a good idea to add <code>LANG=C</code> above the <code>GRUB_DEFAULT</code> line, or set <code>GRUB_DEFAULT</code> according to the correct title in your locale.</div>
<p>Using numbers:
</p>
<pre>GRUB_DEFAULT="1&gt;2"
</pre>
<p>Grub identifies entries in the <a href="../../en/GRUB.html#Generated_grub.cfg" title="GRUB">generated menu</a> (i.e. <code>/boot/grub/grub.cfg</code>) counted from zero. That means <code>0</code> for the first entry which is the default value, <code>1</code> for the second and so on. Main and submenu entries are separated
by a <code>&gt;</code>.
</p>
<p>The example above boots the third entry from the main menu 'Advanced options for Arch Linux'.
</p>
<h3><span class="mw-headline" id="Boot_non-default_entry_only_once">Boot non-default entry only once</span></h3>
<p>The command <code>grub-reboot</code> is very helpful to boot another entry than the default only once. GRUB loads the entry passed in the first command line argument, when the system is rebooted the next time. Most importantly GRUB returns to loading the default entry for all future booting. Changing the configuration file or selecting an entry in the GRUB menu is not necessary.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This requires <code>GRUB_DEFAULT=saved</code> in <code>/etc/default/grub</code> (and then regenerating <code>grub.cfg</code>) or, in case of hand-made <code>grub.cfg</code>, the line <code>set default="${saved_entry}"</code>.</div>
<h2><span class="mw-headline" id="Play_a_tune">Play a tune</span></h2>
<p>You can play a tune through the PC-speaker while booting (right before the menu appears) by modifying the variable <code>GRUB_INIT_TUNE</code>: 
</p>
<pre>GRUB_INIT_TUNE="<i>tempo</i> [<i>note_pitch note_duration</i>] [<i>second_note_pitch second_note_duration</i>] ..."
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The boot menu <b>will not be displayed</b> until the music is finished playing.</div>
<p>You can add <a rel="nofollow" class="external text" href="https://gist.github.com/erus/d7f9f6f43744f94f0bd5b8487e057269">a menu entry</a> to play each of these common <code>GRUB_INIT_TUNE</code> samples by creating the linked <code>/etc/grub.d/91_tune_demo</code> and then re-running <code>grub-mkconfig</code>.
</p>
<p>For information on this, you can look at <code>info grub -n play</code>, while some <a rel="nofollow" class="external text" href="https://gist.github.com/ArtBIT/cfb030c0791b42330381acce33f82ca0">collections</a> exist.
</p>
<h2><span class="mw-headline" id="Manual_configuration_of_core_image_for_early_boot">Manual configuration of core image for early boot</span></h2>
<p>If you require a special keymap or other complex steps that GRUB is not able to configure automatically in order to make <code>/boot</code> available to the GRUB environment, you can generate a core image yourself. On UEFI systems, the core image is the <code>grubx64.efi</code> file that is loaded by the firmware on boot. Building your own core image will allow you to embed any modules required for very early boot, as well as a configuration script to bootstrap GRUB.
</p>
<p>Firstly, taking as an example a requirement for the <code>dvorak</code> keymap embedded in early-boot in order to enter a password for an encrypted <code>/boot</code> on a UEFI system:
</p>
<p>Determine from the generated <code>/boot/grub/grub.cfg</code> file what modules are required in order to mount the crypted <code>/boot</code>. For instance, under your <code>menuentry</code> you should see lines similar to:
</p>
<pre>insmod diskfilter cryptodisk luks gcry_rijndael gcry_rijndael gcry_sha256
insmod ext2
cryptomount -u 1234abcdef1234abcdef1234abcdef
set root='cryptouuid/1234abcdef1234abcdef1234abcdef'</pre>
<p>Take note of all of those modules: they will need to be included in the core image. Now, create a tarball containing your keymap. This will be bundled in the core image as a memdisk:
</p>
<pre># grub-kbdcomp -o dvorak.gkb dvorak
# tar cf memdisk.tar dvorak.gkb
</pre>
<p>Now create a configuration file to be used in the GRUB core image. This is in the same format as your regular grub config, but need contain only a few lines to find and load the main configuration file on the <code>/boot</code> partition:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">early-grub.cfg</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">set root=(memdisk)
set prefix=($root)/

terminal_input at_keyboard
keymap /dvorak.gkb

cryptomount -u 1234abcdef1234abcdef1234abcdef
set root='cryptouuid/1234abcdef1234abcdef1234abcdef'
set prefix=($root)/grub

configfile grub.cfg</pre>
<p>Finally, generate the core image, listing all of the modules determined to be required in the generated <code>grub.cfg</code>, along with any modules used in the <code>early-grub.cfg</code> script. The example above needs <code>memdisk</code>, <code>tar</code>, <code>at_keyboard</code>, <code>keylayouts</code> and <code>configfile</code>.
</p>
<pre># grub-mkimage -c early-grub.cfg -o grubx64.efi -O x86_64-efi -m memdisk.tar diskfilter cryptodisk luks gcry_rijndael gcry_sha256 ext2 memdisk tar at_keyboard keylayouts configfile
</pre>
<p>The generated EFI core image can now be used in the same way as the image that is generated automatically by <code>grub-install</code>: place it in your <a href="../../en/EFI_system_partition.html" title="EFI system partition">EFI system partition</a> and enable it with <code>efibootmgr</code>, or configure as appropriate for your system firmware.
</p>
<p>See also <a rel="nofollow" class="external text" href="https://cryptsetup-team.pages.debian.net/cryptsetup/encrypted-boot.html#using-a-custom-keyboard-layout">Debian cryptsetup docs</a>.
</p>
<h2><span class="mw-headline" id="UEFI_further_reading">UEFI further reading</span></h2>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../../File:Tango-edit-clear.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs language, wiki syntax or style improvements. See <a href="../../en/Help:Style.html" title="Help:Style">Help:Style</a> for reference.</b></p>
<div>
<b>Reason:</b> This could be made more concise, better organized. (Discuss in <a rel="nofollow" class="external text" href="../../en/Talk:GRUB/Tips_and_tricks.html">Talk:GRUB/Tips and tricks</a>)</div>
</div>
<p>Below is other relevant information regarding installing Arch via UEFI.
</p>
<h3><span class="mw-headline" id="Alternative_install_method">Alternative install method</span></h3>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../../File:Tango-view-fullscreen.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs expansion.</b></p>
<div>
<b>Reason:</b> What would be the reason to place all of GRUB's files in the ESP? (Discuss in <a href="../../en/Talk:GRUB/Tips_and_tricks.html#UEFI_further_reading/Alternative_install_method" title="Talk:GRUB/Tips and tricks">Talk:GRUB/Tips and tricks#UEFI further reading/Alternative install method</a>)</div>
</div>
<p>Usually, GRUB keeps all files, including configuration files, in <code>/boot</code>, regardless of where the EFI system partition is mounted.
</p>
<p>If you want to keep these files inside the EFI system partition itself, add <code>--boot-directory=<i>esp</i></code> to the grub-install command:
</p>
<pre># grub-install --target=x86_64-efi --efi-directory=<i>esp</i> --bootloader-id=grub --boot-directory=<i>esp</i> --debug
</pre>
<p>This puts all GRUB files in <code><i>esp</i>/grub</code>, instead of in <code>/boot/grub</code>. When using this method, make sure you have <i>grub-mkconfig</i> put the configuration file in the same place:
</p>
<pre># grub-mkconfig -o <i>esp</i>/grub/grub.cfg
</pre>
<p>Configuration is otherwise the same.
</p>
<h3><span class="mw-headline" id="UEFI_firmware_workaround">UEFI firmware workaround</span></h3>
<p>See <a href="../../en/GRUB.html#Default/fallback_boot_path" title="GRUB">GRUB#Default/fallback boot path</a>.
</p>
<h3><span class="mw-headline" id="GRUB_standalone">GRUB standalone</span></h3>
<p>This section assumes you are creating a standalone GRUB for x86_64 systems (x86_64-efi). For 32-bit (IA32) EFI systems, replace <code>x86_64-efi</code> with <code>i386-efi</code> where appropriate.
</p>
<p>It is possible to create a <code>grubx64_standalone.efi</code> application which has all the modules embedded in a tar archive within the UEFI application, thus removing the need to have a separate directory populated with all of the GRUB UEFI modules and other related files. This is done using the <code>grub-mkstandalone</code> command (included in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=grub">grub</a></span>) as follows:
</p>
<pre># echo 'configfile ${cmdpath}/grub.cfg' &gt; /tmp/grub.cfg
# grub-mkstandalone -d /usr/lib/grub/x86_64-efi/ -O x86_64-efi --modules="part_gpt part_msdos" --locales="en@quot" --themes="" -o "<i>esp</i>/EFI/grub/grubx64_standalone.efi" "boot/grub/grub.cfg=/tmp/grub.cfg" -v
</pre>
<p>Then copy the GRUB configuration file to <code><i>esp</i>/EFI/grub/grub.cfg</code> and create a UEFI Boot Manager entry for <code><i>esp</i>/EFI/grub/grubx64_standalone.efi</code> using <a href="../../en/Unified_Extensible_Firmware_Interface.html#efibootmgr" class="mw-redirect" title="UEFI">efibootmgr</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The option <code>--modules="part_gpt part_msdos"</code> (with the quotes) is necessary for the <code>${cmdpath} </code> feature to work properly.</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> 
<ul>
<li>You may find that the <code>grub.cfg</code> file is not loaded due to <code>${cmdpath} </code> missing a slash (i.e. <code>(hd1,msdos2)EFI/Boot</code> instead of <code>(hd1,msdos2)/EFI/Boot</code>) and so you are dropped into a GRUB shell. If this happens determine what <code>${cmdpath} </code> is set to (<code>echo ${cmdpath} </code>) and then load the configuration file manually (e.g. <code>configfile (hd1,msdos2)/EFI/Boot/grub.cfg</code>).</li>
<li>If Secure Boot with shim is used, remember to add the SBAT section using <code>--sbat /usr/share/grub/sbat.csv</code>.</li>
</ul>
</div>
<h4><span class="mw-headline" id="Technical_information">Technical information</span></h4>
<p>The GRUB EFI file always expects its configuration file to be at <code>${prefix}/grub.cfg</code>. However in the standalone GRUB EFI file, the <code>${prefix} </code> is located inside a tar archive and embedded inside the standalone GRUB EFI file itself (inside the GRUB environment, it is denoted by <code>"(memdisk)"</code>, without quotes). This tar archive contains all the files that would be stored normally at <code>/boot/grub</code> in case of a normal GRUB EFI install.
</p>
<p>Due to this embedding of <code>/boot/grub</code> contents inside the standalone image itself, it does not rely on actual (external) <code>/boot/grub</code> for anything. Thus in case of standalone GRUB EFI file <code>${prefix}==(memdisk)/boot/grub</code> and the standalone GRUB EFI file reads expects the configuration file to be at <code>${prefix}/grub.cfg==(memdisk)/boot/grub/grub.cfg</code>.
</p>
<p>Hence to make sure the standalone GRUB EFI file reads the external <code>grub.cfg</code> located in the same directory as the EFI file (inside the GRUB environment, it is denoted by <code>${cmdpath} </code>), we create a simple <code>/tmp/grub.cfg</code> which instructs GRUB to use <code>${cmdpath}/grub.cfg</code> as its configuration (<code>configfile ${cmdpath}/grub.cfg</code> command in <code>(memdisk)/boot/grub/grub.cfg</code>). We then instruct grub-mkstandalone to copy this <code>/tmp/grub.cfg</code> file to <code>${prefix}/grub.cfg</code> (which is actually <code>(memdisk)/boot/grub/grub.cfg</code>) using the option <code>"boot/grub/grub.cfg=/tmp/grub.cfg"</code>.
</p>
<p>This way, the standalone GRUB EFI file and actual <code>grub.cfg</code> can be stored in any directory inside the EFI system partition (as long as they are in the same directory), thus making them portable.
</p>
<h3><span class="mw-headline" id="UEFI_and_BIOS_installation">UEFI and BIOS installation</span></h3>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../../File:Tango-view-fullscreen.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs expansion.</b></p>
<div>
<b>Reason:</b> Is this the same as <a href="../../en/Multiboot_USB_drive.html#Hybrid_UEFI_GPT_+_BIOS_GPT/MBR_boot" title="Multiboot USB drive">Multiboot USB drive#Hybrid UEFI GPT + BIOS GPT/MBR boot</a>? Does it work without hybrid MBR? (Discuss in <a rel="nofollow" class="external text" href="../../en/Talk:GRUB/Tips_and_tricks.html">Talk:GRUB/Tips and tricks</a>)</div>
</div>
<p>If your arch installation should be bootable on both UEFI and BIOS systems, install <a href="../../en/GRUB.html" title="GRUB">GRUB</a> using both methods. Partition the disk as GPT, create an <a href="../../en/EFI_system_partition.html" title="EFI system partition">EFI system partition</a> and a BIOS boot partition as well, mount the ESP at <code>/efi</code> and run the GRUB install commands for both ways.
</p>
<pre># grub-install --target=i386-pc --recheck /dev/sdx
# grub-install --target=x86_64-efi --efi-directory=/efi --bootloader-id=GRUB --recheck
</pre>
<p>In a BIOS system the EFI variables are not present, thus the UEFI NVRAM boot entries cannot be set and the 2nd command will report an error. By using the <code>--no-nvram</code> and <code>--removable</code> option the system will have a good chance to be bootable in UEFI mode too:
</p>
<pre># grub-install --target=i386-pc --recheck /dev/sdx
# grub-install --target=x86_64-efi --efi-directory=/efi --recheck --removable --no-nvram
</pre>
<p>For some BIOS implementations it may be necessary to set the PMBR’s boot flag, e.g. with parted
</p>
<pre>(parted) disk_set pmbr_boot on
</pre>
<h2><span class="mw-headline" id="Speeding_up_LUKS_decryption_in_GRUB">Speeding up LUKS decryption in GRUB</span></h2>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Before following this section, make sure you understand the importance of high entropy passwords. Information on how to generate secure passwords can be found at <a href="https://en.wikipedia.org/wiki/Password_strength" class="extiw" title="wikipedia:Password strength">Wikipedia:Password strength</a>. Also make sure you do understand the basics of cryptography in use. Using parameters unsuitable for the given feature may render your system unusable.</div>
<p>Upon boot <a href="../../en/GRUB.html" title="GRUB">GRUB</a> may in some cases take a long time to verify the password. This can be due to a high cost parameters of the <a href="https://en.wikipedia.org/wiki/Key_derivation_function" class="extiw" title="wikipedia:Key derivation function">key derivation function</a>, which you can check as follows:
</p>
<pre># cryptsetup luksDump /dev/sda3
</pre>
<p>The problem is that the cost parameters for a given keyslot are generated when the key is added to ensure a balance between being high enough to protect against brute force attacks and low enough to allow for fast key derivation by estimating the capabilities of your computer. However, when <a href="../../en/GRUB.html" title="GRUB">GRUB</a> is started, it might not have the same computational resources at hand, thus being vastly slower.
</p>
<p>If your password provides enough entropy to counter common attacks by itself, you can lower the parameters. For example to lower the iteration count of <a href="https://en.wikipedia.org/wiki/PBKDF2" class="extiw" title="wikipedia:PBKDF2">PBKDF2</a>, use:
</p>
<pre># cryptsetup luksChangeKey --pbkdf-force-iterations 1000 /dev/sda3
</pre>
<p>A minimum of 1000 iterations is recommended as per <a href="https://tools.ietf.org/html/rfc2898" class="extiw" title="rfc:2898">RFC 2898</a>, but you should aim for higher values if you can (The cost for an attacker as well as the time for key derivation scale linearly).
</p>
<p>Recommended parameters for <a href="https://en.wikipedia.org/wiki/Argon2" class="extiw" title="wikipedia:Argon2">Argon2</a> are discussed in <a href="https://tools.ietf.org/html/rfc9106" class="extiw" title="rfc:9106">RFC 9106</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> <a href="../../en/GRUB.html" title="GRUB">GRUB</a> tries enabled key slots sequentially. When adding keys, the <code>--key-slot</code> option can be used to specify a key slot explicitly.</div>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li><a rel="nofollow" class="external text" href="http://wiki.rosalab.ru/en/index.php/Grub2_theme_tutorial">GRUB 2 theme tutorial</a></li></ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../../en/Category:Boot_loaders.html" title="Category:Boot loaders">Boot loaders</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../../en/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li>
<li><a href="../../en/Category:Pages_or_sections_flagged_with_Template:Style.html" title="Category:Pages or sections flagged with Template:Style">Pages or sections flagged with Template:Style</a></li>
<li><a href="../../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=GRUB/Tips_and_tricks&amp;oldid=807277">https://wiki.archlinux.org/index.php?title=GRUB/Tips_and_tricks&amp;oldid=807277</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 2 May 2024, at 07:10.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
