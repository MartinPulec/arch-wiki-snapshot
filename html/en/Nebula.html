<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Nebula - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.43.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Nebula rootpage-Nebula skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Installation</span>
			</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Basic_concepts_and_terminology" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Basic_concepts_and_terminology">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Basic concepts and terminology</span>
			</div>
		</a>
		
		<ul id="toc-Basic_concepts_and_terminology-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Example:_Simple_mesh_VPN" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Example:_Simple_mesh_VPN">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Example: Simple mesh VPN</span>
			</div>
		</a>
		
			<button aria-controls="toc-Example:_Simple_mesh_VPN-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Example: Simple mesh VPN subsection</span>
			</button>
		
		<ul id="toc-Example:_Simple_mesh_VPN-sublist" class="vector-toc-list">
			<li id="toc-Network_setup" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Network_setup">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1</span>
					<span>Network setup</span>
				</div>
			</a>
			
			<ul id="toc-Network_setup-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Certificate_and_key_generation" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Certificate_and_key_generation">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2</span>
					<span>Certificate and key generation</span>
				</div>
			</a>
			
			<ul id="toc-Certificate_and_key_generation-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configuration">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.3</span>
					<span>Configuration</span>
				</div>
			</a>
			
			<ul id="toc-Configuration-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Distribute_certificates_and_private_keys" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Distribute_certificates_and_private_keys">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.4</span>
					<span>Distribute certificates and private keys</span>
				</div>
			</a>
			
			<ul id="toc-Distribute_certificates_and_private_keys-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Start_the_nebula_daemon" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Start_the_nebula_daemon">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.5</span>
					<span>Start the nebula daemon</span>
				</div>
			</a>
			
			<ul id="toc-Start_the_nebula_daemon-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Test_for_mesh_functionality" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Test_for_mesh_functionality">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.6</span>
					<span>Test for mesh functionality</span>
				</div>
			</a>
			
			<ul id="toc-Test_for_mesh_functionality-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Configuration_options" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configuration_options">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">4</span>
				<span>Configuration options</span>
			</div>
		</a>
		
		<ul id="toc-Configuration_options-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Troubleshooting">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">5</span>
				<span>Troubleshooting</span>
			</div>
		</a>
		
			<button aria-controls="toc-Troubleshooting-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Troubleshooting subsection</span>
			</button>
		
		<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
			<li id="toc-My_lighthouse_node_takes_forever_to_handshake" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#My_lighthouse_node_takes_forever_to_handshake">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.1</span>
					<span>My lighthouse node takes forever to handshake</span>
				</div>
			</a>
			
			<ul id="toc-My_lighthouse_node_takes_forever_to_handshake-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">6</span>
				<span>See also</span>
			</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Nebula</span></h1>
				</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<p><a rel="nofollow" class="external text" href="https://nebula.defined.net/">Nebula</a> is a user-space mesh virtual private network (VPN) daemon that uses tunneling and encryption to create a secure private mesh network between participating hosts.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nebula">nebula</a></span> package.
</p>
<h2><span class="mw-headline" id="Basic_concepts_and_terminology">Basic concepts and terminology</span></h2>
<p>Nebula is a mesh VPN technology, inspired by <a href="../en/Tinc.html" title="Tinc">tinc</a>. In a mesh VPN, individual nodes form direct tunnels between each other. This allows for high speed direct communication between nodes, without the need to go through a central node. Nodes are authenticated using certificates signed by a certificate authority.
</p>
<p>This is in contrast to <a href="../en/WireGuard.html" title="WireGuard">WireGuard</a>, which is a peer-to-peer VPN technology (although there exist mesh network managers for WireGuard, e.g. <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=innernet">innernet</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/wesher/">wesher</a></span><sup><small>AUR</small></sup>).
</p>
<p>This is also different from <a href="../en/OpenVPN.html" title="OpenVPN">OpenVPN</a>, which uses a star topology (also called hub and spoke).
</p>
<dl>
<dt>Certificate authority</dt>
<dd>The certificate authority creates host certificates by signing it.</dd>
<dt>Lighthouse</dt>
<dd>In a Nebula network, there is typically at least one lighthouse node that serves as an information hub for other nodes. Lighthouse nodes help other nodes find each other and form a network mesh.</dd>
<dt>Node</dt>
<dd>A node in the Nebula network.</dd>
<dt>Nebula IP</dt>
<dd>IP address of a node within the Nebula network. Also known as VPN IP.</dd>
<dt>Routable IP</dt>
<dd>The "normal" or "native" IP address of a node. This can be a public IP address or a private IP address, depending on where the node is located and how its network is configured. A node can have multiple routable IP addresses.</dd>
</dl>
<h2><span class="mw-headline" id="Example:_Simple_mesh_VPN">Example: Simple mesh VPN</span></h2>
<h3><span class="mw-headline" id="Network_setup">Network setup</span></h3>
<p>In this example, we have 3 nodes:
</p>
<ul>
<li>lighthouse
<ul>
<li>Nebula IP: 192.168.100.1</li>
<li>Routable IP: 12.34.56.78</li>
</ul>
</li>
<li>hostA
<ul>
<li>Nebula IP: 192.168.100.101</li>
<li>Routable IP: 10.0.0.22</li>
</ul>
</li>
<li>hostB
<ul>
<li>Nebula IP: 192.168.100.102</li>
<li>Routable IP: 23.45.67.89</li>
</ul>
</li>
</ul>
<p>The lighthouse has a public static IP address and is reachable by hostA and hostB. hostA lives behind a NAT. hostB has a public IP address.
</p>
<p>In our case, we will use a /24 subnet for the VPN network. We will call this network "My Nebula Network".
</p>
<h3><span class="mw-headline" id="Certificate_and_key_generation">Certificate and key generation</span></h3>
<p>First, generate the CA certificate and private key with <code>nebula-cert ca -name "My Nebula Network"</code>. This will create two files:
</p>
<ul>
<li>
<code>ca.crt</code>: The CA certificate file</li>
<li>
<code>ca.key</code>: the CA private key</li>
</ul>
<p>Subsequently, generate the certificate and private key files for the nodes in the network:
</p>
<pre>$ nebula-cert sign -name lighthouse -ip 192.168.100.1/24
$ nebula-cert sign -name hostA -ip 192.168.100.101/24
$ nebula-cert sign -name hostB -ip 192.168.100.102/24
</pre>
<p>Notice that we did not specify <code>ca.crt</code> and <code>ca.key</code>. By default, <code>nebula-cert</code> looks for those files in the current directory.
</p>
<p>After this step, we will have these files:
</p>
<ul>
<li>
<code>lighthouse.crt</code>, <code>lighthouse.key</code>
</li>
<li>
<code>hostA.crt</code>, <code>hostA.key</code>
</li>
<li>
<code>hostB.crt</code>, <code>hostB.key</code>
</li>
</ul>
<h3><span class="mw-headline" id="Configuration">Configuration</span></h3>
<p>Create this configuration file on the lighthouse node:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/nebula/config.yml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">pki:
  ca: /etc/nebula/ca.crt
  cert: /etc/nebula/lighthouse.crt
  key: /etc/nebula/lighthouse.key

lighthouse:
  am_lighthouse: true
  
listen:
  port: 4242

firewall:
  outbound:
    - port: any
      proto: any
      host: any
  inbound:
    - port: any
      proto: any
      host: any</pre>
<p>Create this configuration file on hostA:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/nebula/config.yml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">pki:
  ca: /etc/nebula/ca.crt
  cert: /etc/nebula/hostA.crt
  key: /etc/nebula/hostA.key

static_host_map:
  "192.168.100.1": ["12.34.56.78:4242"]

lighthouse:
  hosts:
    - "192.168.100.1"

punchy:
  punch: true

firewall:
  outbound:
    - port: any
      proto: any
      host: any
  inbound:
    - port: any
      proto: any
      host: any</pre>
<p>Finally, use this configuration file for hostB:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/nebula/config.yml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">pki:
  ca: /etc/nebula/ca.crt
  cert: /etc/nebula/hostB.crt
  key: /etc/nebula/hostB.key

static_host_map:
  "192.168.100.1": ["12.34.56.78:4242"]

lighthouse:
  hosts:
    - "192.168.100.1"

firewall:
  outbound:
    - port: any
      proto: any
      host: any
  inbound:
    - port: any
      proto: any
      host: any</pre>
<h3><span class="mw-headline" id="Distribute_certificates_and_private_keys">Distribute certificates and private keys</span></h3>
<p>Because the certificates and private keys were generated by the certificate authority, they need to be distributed to each node. <a href="../en/SCP_and_SFTP.html" title="SCP and SFTP">SCP and SFTP</a> are suitable for this purpose.
</p>
<p>Specifically:
</p>
<ul>
<li>
<code>ca.crt</code> should be copied to all 3 nodes: lighthouse, hostA, and hostB</li>
<li>
<code>lighthouse.crt</code> and <code>lighthouse.key</code> should be copied to the lighthouse node</li>
<li>
<code>hostA.crt</code> and <code>hostA.key</code> should be copied to hostA</li>
<li>
<code>hostB.crt</code> and <code>hostB.key</code> should be copied to hostB</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The <code>ca.key</code> file does not have to be copied over to any node. Keep it safe (do not lose it) and secure (do not leak it).</div>
<h3><span class="mw-headline" id="Start_the_nebula_daemon">Start the nebula daemon</span></h3>
<p>On each node, <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start">start</a> <code>nebula.service</code>. Optionally, <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">enable</a> it so that it will be started on boot.
</p>
<p>Note that it does not matter which node starts the nebula daemon. The lighthouse node can even be started last. Each individual node always tries to connect to the list of known lighthouse nodes, so any network interruption can be rectified quickly.
</p>
<h3><span class="mw-headline" id="Test_for_mesh_functionality">Test for mesh functionality</span></h3>
<p>With a mesh network, every node is directly connected to every other node. So, even if the connection between lighthouse and both hostA and hostB is slow, traffic between hostA and hostB can be fast, as long as there is a direct link between those two.
</p>
<p>This can be demonstrated by a simple ping test on hostA:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ ping -c 5 12.34.56.78</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">PING 12.34.56.78 (12.34.56.78) 56(84) bytes of data.
64 bytes from 12.34.56.78: icmp_seq=1 ttl=56 time=457 ms
64 bytes from 12.34.56.78: icmp_seq=2 ttl=56 time=480 ms
64 bytes from 12.34.56.78: icmp_seq=3 ttl=56 time=262 ms
64 bytes from 12.34.56.78: icmp_seq=4 ttl=56 time=199 ms
64 bytes from 12.34.56.78: icmp_seq=5 ttl=56 time=344 ms

--- 12.34.56.78 ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4004ms
rtt min/avg/max/mdev = 199.141/348.555/480.349/108.654 ms</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ ping -c 5 192.168.100.1</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">PING 192.168.100.1 (192.168.100.1) 56(84) bytes of data.
64 bytes from 192.168.100.1: icmp_seq=1 ttl=64 time=218 ms
64 bytes from 192.168.100.1: icmp_seq=2 ttl=64 time=241 ms
64 bytes from 192.168.100.1: icmp_seq=3 ttl=64 time=264 ms
64 bytes from 192.168.100.1: icmp_seq=4 ttl=64 time=288 ms
64 bytes from 192.168.100.1: icmp_seq=5 ttl=64 time=163 ms

--- 192.168.100.1 ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4004ms
rtt min/avg/max/mdev = 162.776/234.874/288.073/42.902 ms</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ ping -c 5 192.168.100.102</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">PING 192.168.100.102 (192.168.100.102) 56(84) bytes of data.
64 bytes from 192.168.100.102: icmp_seq=1 ttl=64 time=106 ms
64 bytes from 192.168.100.102: icmp_seq=2 ttl=64 time=2.14 ms
64 bytes from 192.168.100.102: icmp_seq=3 ttl=64 time=4.53 ms
64 bytes from 192.168.100.102: icmp_seq=4 ttl=64 time=4.29 ms
64 bytes from 192.168.100.102: icmp_seq=5 ttl=64 time=5.39 ms

--- 192.168.100.102 ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4006ms
rtt min/avg/max/mdev = 2.136/24.535/106.344/40.918 ms</pre>
<p>Notice that the connection between hostA and lighthouse is slow, but the connection between hostA and hostB is very fast. Also notice that the first packet between hostA and hostB is delayed a bit, but subsequent packets take almost no time at all.
</p>
<h2><span class="mw-headline" id="Configuration_options">Configuration options</span></h2>
<dl>
<dt><code>listen.port</code></dt>
<dd>This is the listening port for the nebula daemon, which by default is 4242. On a lighthouse node, or a node with a static IP address, set this to any other number in order to personalize your setup and reduce the chances of unwanted service discovery and DDoS attacks on that port. Then update <code>static_host_map</code> to reflect the change.</dd>
<dd>On a node with a dynamic IP address, it is recommended to set this to 0, such the nebula daemon will use a random port for communication.</dd>
<dt><code>logging.level</code></dt>
<dd>By default, the nebula daemon logs INFO-level messages. Thus handshakes are printed, and this can generate a lot of log messages. Set it to <code>warning</code> in order to reduce the amount of messages logged.</dd>
<dt><code>relay</code></dt>
<dd>This option can be used if a node cannot be reached directly from another node. Relay nodes help forward the communication between such nodes.</dd>
<dt><code>firewall</code></dt>
<dd>This option can be used to allow only certain traffic to and from a node.</dd>
</dl>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="My_lighthouse_node_takes_forever_to_handshake">My lighthouse node takes forever to handshake</span></h3>
<p>If your lighthouse node needs a long time to handshake, and it prints multiple handshake messages all at once when handshake is completed, maybe it does not support <code>recvmmsg()</code>. To get around this issue, add this configuration option:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/nebula/config.yml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">listen:
  batch: 1</pre>
<p>This problem usually happens if your Linux kernel is too old (&lt;2.6.34). The proper solution is to upgrade it.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://github.com/slackhq/nebula">Nebula Project</a></li>
<li><a rel="nofollow" class="external text" href="https://theorangeone.net/posts/nebula-intro/">Blog post explaining Nebula VPN</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Virtual_Private_Network.html" title="Category:Virtual Private Network">Virtual Private Network</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Nebula&amp;oldid=811935">https://wiki.archlinux.org/index.php?title=Nebula&amp;oldid=811935</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 5 July 2024, at 05:55.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki.svg" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul></ul>
</div>
</body>
</html>
