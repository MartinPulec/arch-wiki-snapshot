<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Autofs - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Autofs rootpage-Autofs skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Installation</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Configuration</div>
		</a>
		
			<button aria-controls="toc-Configuration-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configuration subsection</span>
			</button>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
			<li id="toc-Removable_media" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Removable_media">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Removable media</div>
			</a>
			
			<ul id="toc-Removable_media-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-NFS_network_mounts" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#NFS_network_mounts">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>NFS network mounts</div>
			</a>
			
			<ul id="toc-NFS_network_mounts-sublist" class="vector-toc-list">
				<li id="toc-Manual_NFS_configuration" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Manual_NFS_configuration">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2.1</span>Manual NFS configuration</div>
			</a>
			
			<ul id="toc-Manual_NFS_configuration-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Samba" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Samba">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3</span>Samba</div>
			</a>
			
			<ul id="toc-Samba-sublist" class="vector-toc-list">
				<li id="toc-Single_shares" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Single_shares">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.1</span>Single shares</div>
			</a>
			
			<ul id="toc-Single_shares-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Multiple_shares" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Multiple_shares">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.2</span>Multiple shares</div>
			</a>
			
			<ul id="toc-Multiple_shares-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Auto_discovery" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Auto_discovery">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.3</span>Auto discovery</div>
			</a>
			
			<ul id="toc-Auto_discovery-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-FTP_and_SSH_(with_FUSE)" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#FTP_and_SSH_(with_FUSE)">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4</span>FTP and SSH (with FUSE)</div>
			</a>
			
			<ul id="toc-FTP_and_SSH_(with_FUSE)-sublist" class="vector-toc-list">
				<li id="toc-Remote_FTP" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Remote_FTP">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4.1</span>Remote FTP</div>
			</a>
			
			<ul id="toc-Remote_FTP-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Remote_SSH" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Remote_SSH">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4.2</span>Remote SSH</div>
			</a>
			
			<ul id="toc-Remote_SSH-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-MTP" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#MTP">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>MTP</div>
		</a>
		
		<ul id="toc-MTP-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Troubleshooting_and_tweaks" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Troubleshooting_and_tweaks">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Troubleshooting and tweaks</div>
		</a>
		
			<button aria-controls="toc-Troubleshooting_and_tweaks-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Troubleshooting and tweaks subsection</span>
			</button>
		
		<ul id="toc-Troubleshooting_and_tweaks-sublist" class="vector-toc-list">
			<li id="toc-Using_NIS" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Using_NIS">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>Using NIS</div>
			</a>
			
			<ul id="toc-Using_NIS-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Optional_parameters" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Optional_parameters">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2</span>Optional parameters</div>
			</a>
			
			<ul id="toc-Optional_parameters-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Identify_multiple_devices" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Identify_multiple_devices">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.3</span>Identify multiple devices</div>
			</a>
			
			<ul id="toc-Identify_multiple_devices-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-AutoFS_permissions" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#AutoFS_permissions">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4</span>AutoFS permissions</div>
			</a>
			
			<ul id="toc-AutoFS_permissions-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-fusermount_problems" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#fusermount_problems">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.5</span>fusermount problems</div>
			</a>
			
			<ul id="toc-fusermount_problems-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Debugging_auto_mount_issues" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Debugging_auto_mount_issues">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.6</span>Debugging auto mount issues</div>
			</a>
			
			<ul id="toc-Debugging_auto_mount_issues-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Alternatives_to_AutoFS" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Alternatives_to_AutoFS">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Alternatives to AutoFS</div>
		</a>
		
		<ul id="toc-Alternatives_to_AutoFS-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Autofs</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 3 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-3" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">3 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-es mw-list-item"><a href="../es/Autofs.html" title="Autofs – español" lang="es" hreflang="es" class="interlanguage-link-target"><span>Español</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Autofs" title="Autofs – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-ru mw-list-item"><a href="../ru/Autofs.html" title="Autofs – русский" lang="ru" hreflang="ru" class="interlanguage-link-target"><span>Русский</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<p>AutoFS provides automounting of removable media or network shares when they are inserted or accessed.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/autofs/">autofs</a></span><sup><small>AUR</small></sup> package.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You no longer need to load <code>autofs4</code> module.</div>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-view-fullscreen.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs expansion.</b></p>
<div>
<b>Reason:</b> Mention <code>auto.master.d</code> to avoid direct edits to <code>/etc/auto.master</code>. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Autofs.html">Talk:Autofs</a>)</div>
</div>
<p>AutoFS uses template files for configuration which are located in <code>/etc/autofs</code> The main template is called <code>auto.master</code>, which can point to one or more other templates for specific media types.
</p>
<p>Open the file <code>/etc/autofs/auto.master</code> with your favorite editor, you will see something similar to this:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/autofs/auto.master</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#/media /etc/autofs/auto.media</pre>
<p>The first value on each line determines the base directory under which all the media in a template are mounted, the second value is which template to use. The default base path is <code>/media</code>, but you can change this to any other location you prefer. For instance:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/autofs/auto.master</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/media/misc     /etc/autofs/auto.misc     --timeout=5
/media/net      /etc/autofs/auto.net      --timeout=60</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Make sure the template files ends with a newline (press <code>ENTER</code> after last word). If there is no correct EOF (end of file) line, the AutoFS daemon will not properly load.</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> The optional parameter <code>timeout</code> sets the amount of seconds after which to unmount directories. Setting this value to <code>0</code> will disable the timeout.</div>
<p>The base directory will be created if it does not exist on your system. The base directory will be mounted on to load the dynamically loaded media, which means any content in the base directory will not be accessible while autofs is on. This procedure is however non-destructive, so if you accidentally automount into a live directory you can just change the location in <code>auto.master</code> and restart AutoFS to regain the original contents.
</p>
<p>If you still want to automount to a target non-empty directory and want to have the original files available even after the dynamically loaded directories are mounted, you can use autofs to mount them to another directory (e.g. <code>/var/autofs/net</code>) and create soft links.
</p>
<pre># ln -s /var/autofs/net/share_name /media/share_name
</pre>
<p>Alternatively, you can have autofs mount your media to a specific folder, rather than inside a common folder.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/autofs/auto.master</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/-     /etc/autofs/auto.template</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/autofs/auto.template</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/path/to/folder     -options :/device/path
/home/user/usbstick  -fstype=auto,async,nodev,nosuid,umask=000  :/dev/sdb1</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This can cause problems with resources getting locked if the connection to the share is lost. When trying to access the folder, programs will get locked into waiting for a response, and either the connection has to be restored or the process has to be forcibly killed before unmounting is possible. To mitigate this, only use if you will always be connected to the share, and do not use your home folder or other commonly used folders lest your file browser reads ahead into the disconnected folder</div>
<p>Open the file <code>/etc/nsswitch.conf</code> and add an entry for automount:
</p>
<pre>automount: files
</pre>
<p>When you are done configuring your templates (see below), launch the AutoFS daemon as root by <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enabling">enabling</a> and starting the <code>autofs.service</code>.
</p>
<p>Devices are now automatically mounted when they are accessed, they will remain mounted as long as you access them.
</p>
<h3><span class="mw-headline" id="Removable_media">Removable media</span></h3>
<p>Removable devices are assigned block device locations according to the next available spot, e.g. if <code>/dev/sd{a,b,c} </code> are already occupied, the next removable media will be given block <code>/dev/sdd</code>.  Instead of assigning a mount point based on an unreliable block device path, a more robust approach is to use the <a href="../en/Persistent_block_device_naming.html#by-uuid" class="mw-redirect" title="UUID">UUID</a> or <a href="../en/Persistent_block_device_naming.html#by-partuuid" class="mw-redirect" title="PARTUUID">PARTUUID</a> of the removable media as the location in the map file.
</p>
<p>For example, to mount a specific USB drive to the path <code>/mnt/black</code>, configure the template file and map file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/autofs/auto.master</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># master template file
/mnt     /etc/autofs/auto.mnt   # [options here]</pre>
<p>Use <code>blkid</code> to find the UUID of the partition to mount, then generate the map file:
</p>
<pre># _ID=$( blkid --output value --match-tag PARTUUID /dev/sd<i>XY</i> )
# printf "%s %s\n" "black -fstype=auto :PARTUUID=" "${_ID}" &gt;/etc/autofs/auto.mnt
</pre>
<h3><span class="mw-headline" id="NFS_network_mounts">NFS network mounts</span></h3>
<p>AutoFS provides automatically discovering and mounting <a href="../en/NFS.html" title="NFS">NFS</a>-shares on remote servers (the AutoFS network template in <code>/etc/autofs/auto.net</code> has been removed in autofs5). To enable automatic discovery and mounting of network shares from all accessible servers without any further configuration, you will need to add the following to the <code>/etc/autofs/auto.master</code> file:
</p>
<pre>/net -hosts --timeout=60
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Each host name needs to be resolveable, e.g. the name and IP address in <code>/etc/hosts</code> or via <a href="https://en.wikipedia.org/wiki/Domain_Name_System" class="extiw" title="wikipedia:Domain Name System">DNS</a> and make sure you have <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nfs-utils">nfs-utils</a></span> installed and configured. You also have to <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">enable</a> <code>rpcbind</code> to browse shared directories.</div>
<p>For instance, if you have a remote server <i>fileserver</i> (the name of the directory is the hostname of the server) with an NFS share named <code>/home/share</code>, you can just access the share by typing:
</p>
<pre># cd /net/fileserver/home/share
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Please note that <i>ghosting</i> (i.e. automatically creating directory placeholders before mounting shares) is enabled by default; although, AutoFS installation notes claim to remove that option from <code>/etc/conf.d/autofs</code> in order to start the AutoFS daemon.</div>
<p>The <code>-hosts</code> option uses a similar mechanism as the <code>showmount</code> command to detect remote shares. You can see the exported shares by typing:
</p>
<pre># showmount <i>servername</i> -e
</pre>
<h4><span class="mw-headline" id="Manual_NFS_configuration">Manual NFS configuration</span></h4>
<p>To mount a NFS share for <i>file_server</i> on <code>/srv/shared_dir</code> at location <code>/mnt/foo</code>, <a href="../en/Help:Reading.html#Append,_add,_create,_edit" class="mw-redirect" title="Add">add</a> a new configuration, e.g. <code>file_server.autofs</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/autofs/auto.master.d/file_server.autofs</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/mnt   /etc/autofs/auto.file_server --timeout 60</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/autofs/auto.file_server</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">foo  -rw,soft,rsize=8192,wsize=8192 file_server:/srv/shared_dir</pre>
<h3><span class="mw-headline" id="Samba">Samba</span></h3>
<h4><span class="mw-headline" id="Single_shares">Single shares</span></h4>
<p>Add the following to <code>/etc/autofs/auto.master</code>:
</p>
<pre>/media/[my_server] /etc/autofs/auto.[my_server] --timeout 60 --browse
</pre>
<p>where <code>--timeout</code> defines how many seconds to wait before the file system is unmounted. The <code>--browse</code> option creates empty folders for each mount-point in the file in order to prevent timeouts, if a network share cannot be contacted.
</p>
<p>Next create a file <code>/etc/autofs/auto.[my_server]</code>
</p>
<pre>[any_name] -fstype=cifs,[other_options] ://[remote_server]/[remote_share_name]
</pre>
<p>You can specify a user name and password to use with the share in the <code>other_options</code> section:
</p>
<pre>[any_name] -fstype=cifs,username=[username],password=[password],[other_options] ://[remote_server]/[remote_share_name]
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Escape <code>$</code>, and other characters, with a backslash when necessary.</div>
<h4><span class="mw-headline" id="Multiple_shares">Multiple shares</span></h4>
<p>You may be specify multiple shares in the <code>/etc/autofs/auto.[my_server]</code>, for instance:
</p>
<pre>[any_name] -fstype=cifs,[other_options] /photos ://[remote_server]/photos /music ://[remote_server]/music /video ://[remote_server]/video
</pre>
<h4><span class="mw-headline" id="Auto_discovery">Auto discovery</span></h4>
<p>See the comments in <code>/etc/autofs/auto.smb</code>.
</p>
<h3>
<span id="FTP_and_SSH_.28with_FUSE.29"></span><span class="mw-headline" id="FTP_and_SSH_(with_FUSE)">FTP and SSH (with FUSE)</span>
</h3>
<p>Remote FTP and <a href="../en/Secure_Shell.html" class="mw-redirect" title="SSH">SSH</a> servers can be accessed seamlessly with AutoFS using <a href="https://en.wikipedia.org/wiki/Filesystem_in_Userspace" class="extiw" title="wikipedia:Filesystem in Userspace">FUSE</a>, a virtual file system layer.
</p>
<h4><span class="mw-headline" id="Remote_FTP">Remote FTP</span></h4>
<p>First, install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=curlftpfs">curlftpfs</a></span> package.
</p>
<p>Load the <b>fuse</b> module:
</p>
<pre># modprobe fuse
</pre>
<p>Create a <code>/etc/modules-load.d/fuse.conf</code> file containg <code>fuse</code> to load it on each system boot.
</p>
<p>Next, add a new entry for FTP servers in <code>/etc/autofs/auto.master</code>:
</p>
<pre>/media/ftp        /etc/autofs/auto.ftp    --timeout=60
</pre>
<p>Create the file <code>/etc/autofs/auto.ftp</code> and add a server using the <code>ftp://myuser:mypassword@host:port/path</code> format:
</p>
<pre>servername -fstype=curl,rw,allow_other,nodev,nonempty,noatime    :ftp\://myuser\:mypassword\@remoteserver
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong>  Your passwords are plainly visible for anyone that can run <code>df</code> (only for mounted servers) or view the file <code>/etc/autofs/auto.ftp</code>.</div>
<p>If you want slightly more security you can create the file <code>~root/.netrc</code> and add the passwords there.
Passwords are still plain text, but you can have mode 600, and <code>df</code> command will not show them (mounted or not).
This method is also less sensitive to special characters (that else must be escaped) in the passwords. The format is:
</p>
<pre>machine remoteserver
login myuser
password mypassword
</pre>
<p>The line in <code>/etc/autofs/auto.ftp</code> looks like this without user and password:
</p>
<pre>servername -fstype=curl,allow_other    :ftp\://remoteserver
</pre>
<p>Create the file <code>/sbin/mount.curl</code> with this code:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/sbin/mount.curl</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh
curlftpfs $1 $2 -o $4,disable_eprt
</pre>
<p>Create the file <code>/sbin/umount.curl</code> with this code:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/sbin/umount.curl</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh
fusermount -u $1
</pre>
<p>Set the permissions for both files:
</p>
<pre># chmod 755 /sbin/mount.curl
# chmod 755 /sbin/umount.curl
</pre>
<p>After a restart your new FTP server should be accessible through <code>/media/ftp/servername</code>.
</p>
<h4><span class="mw-headline" id="Remote_SSH">Remote SSH</span></h4>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Inaccurate.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>The factual accuracy of this article or section is disputed.</b></p>
<div>
<b>Reason:</b> All the <i>ssh*</i> commands should be executed as the same user, as before <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Autofs&amp;diff=prev&amp;oldid=318335">this edit</a>. It should not matter if it is root or unprivileged. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Autofs.html">Talk:Autofs</a>)</div>
</div>
<p>These are basic instructions to access a remote filesystem over <a href="../en/Secure_Shell.html" class="mw-redirect" title="SSH">SSH</a> with AutoFS.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Password-less authentication may be convenient but also has security implications. See <a href="../en/SSH_keys.html" class="mw-redirect" title="Using SSH Keys">SSH keypair</a> for more details</div>
<p>Install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=sshfs">sshfs</a></span> package.
</p>
<p>Load the <code>fuse</code> module:
</p>
<pre># modprobe fuse
</pre>
<p>Create a <code>/etc/modules-load.d/fuse.conf</code> file containing <code>fuse</code> to load it on each system boot if you have not one yet.
</p>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=openssh">openssh</a></span>.
</p>
<p>Generate an <a href="../en/SSH_keys.html" class="mw-redirect" title="Using SSH Keys">SSH keypair</a>:
</p>
<pre>$ ssh-keygen
</pre>
<p>When the generator ask for a passphrase, just press <code>ENTER</code>. Using SSH keys without a passphrase is less secure, yet running AutoFS together with passphrases poses some additional difficulties which are not (yet) covered in this article.
</p>
<p>Next, copy the public key to the remote SSH server:
</p>
<pre>$ ssh-copy-id username@remotehost
</pre>
<p><b>As root</b>, see that you can login to the remote server:
</p>
<pre># ssh username@remotehost
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This will add the remote server to root's list of <code>known_hosts</code>. Hosts can be also be manually added to <code>/etc/ssh/ssh_known_hosts</code>.</div>
<p>Create a new entry for SSH servers in <code>/etc/autofs/auto.master</code>:
</p>
<pre>/media/ssh		/etc/autofs/auto.ssh	--timeout=60
</pre>
<p>Create the file <code>/etc/autofs/auto.ssh</code> and add an SSH server:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/autofs/auto.ssh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">servername     -fstype=fuse,rw,allow_other,IdentityFile=/home/username/.ssh/id_rsa :sshfs\#username@host\:/</pre>
<p>After a restart your SSH server should be accessible through <code>/media/ssh/servername</code>.
</p>
<h2><span class="mw-headline" id="MTP">MTP</span></h2>
<p>Media Transfer Protocol (<a href="../en/Media_Transfer_Protocol.html" class="mw-redirect" title="MTP">MTP</a>) is used in some Android devices.
</p>
<p>Install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mtpfs">mtpfs</a></span> package.
</p>
<p>Create a new entry for MTP Device in <code>/etc/autofs/auto.misc</code>:
</p>
<pre>android -fstype=fuse,allow_other,umask=000     :mtpfs
</pre>
<h2><span class="mw-headline" id="Troubleshooting_and_tweaks">Troubleshooting and tweaks</span></h2>
<p>This section contains a few solutions for common issues with AutoFS.
</p>
<h3><span class="mw-headline" id="Using_NIS">Using NIS</span></h3>
<p>Version 5.0.5 of AutoFS has more advanced support for <a href="../en/NIS.html" title="NIS">NIS</a>. To use AutoFS together with NIS, add <code>yp:</code> in front of the template names in <code>/etc/autofs/auto.master</code>:
</p>
<pre>/home   yp:auto_home    --timeout=60
/sbtn   yp:auto_sbtn    --timeout=60
+auto.master
</pre>
<p>On earlier versions of NIS (before 5.0.4), you should add <code>nis</code> to <code>/etc/nsswitch.conf</code>:
</p>
<pre>automount: files nis
</pre>
<h3><span class="mw-headline" id="Optional_parameters">Optional parameters</span></h3>
<p>You can set parameters like <code>timeout</code> systemwide for all AutoFS media in <code>/etc/default/autofs</code>:
</p>
<ul>
<li>Open the <code>/etc/default/autofs</code> file and edit the <code>OPTIONS</code> line:<pre>OPTIONS='--timeout=5'</pre>
</li>
<li>To enable logging (default is no logging at all), uncomment and add <code>--verbose</code> to the <code>OPTIONS</code> line in <code>/etc/default/autofs</code> e.g.:<pre>OPTIONS='--verbose --timeout=5'</pre>
</li>
</ul>
<p>After restarting the <code>autofs</code> daemon, verbose output is visible in the <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Unit status">unit status</a> or in the <a href="../en/Systemd/Journal.html" class="mw-redirect" title="Journal">journal</a>.
</p>
<h3><span class="mw-headline" id="Identify_multiple_devices">Identify multiple devices</span></h3>
<p>If you use multiple USB drives/sticks and want to easily tell them apart, you can use AutoFS to set up the mount points and <a href="../en/Udev.html" title="Udev">Udev</a> to create distinct names for your USB drives. See <a href="../en/Udev.html#Setting_static_device_names" title="Udev">udev#Setting static device names</a> for instructions on setting up Udev rules.
</p>
<h3><span class="mw-headline" id="AutoFS_permissions">AutoFS permissions</span></h3>
<p>If AutoFS is not working for you, make sure that the permissions of the templates files are correct, otherwise AutoFS will not start. This may happen if you backed up your configuration files in a manner which did not preserve file modes. Here are what the modes should be on the configuration files:
</p>
<ul>
<li>
<code>0644</code> — <code>/etc/autofs/auto.master</code>
</li>
<li>
<code>0644</code> — <code>/etc/autofs/auto.media</code>
</li>
<li>
<code>0644</code> — <code>/etc/autofs/auto.misc</code>
</li>
<li>
<code>0644</code> — <code>/etc/conf.d/autofs</code>
</li>
</ul>
<p>In general, scripts (like previous <code>auto.net</code>) should have <a href="../en/Help:Reading.html#Make_executable" class="mw-redirect" title="Executable">executable</a> bits set and lists of mounts should not.
</p>
<p>If you are getting errors in <code>/var/log/daemon.log</code> similar to this, you have a permissions problem:
</p>
<pre>May  7 19:44:16 peterix automount[15218]: lookup(program): lookup for petr failed
May  7 19:44:16 peterix automount[15218]: failed to mount /media/cifs/petr
</pre>
<h3><span class="mw-headline" id="fusermount_problems">fusermount problems</span></h3>
<p>With certain versions of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=util-linux">util-linux</a></span>, you may not be able to unmount a fuse file system drive mounted by autofs, even if you use the <code>user=</code> option. See the <a rel="nofollow" class="external text" href="https://sourceforge.net/p/fuse/mailman/fuse-devel/thread/k3a8pi%2457r%241%40ger.gmane.org/">discussion on the mailing list</a>.
</p>
<h3><span class="mw-headline" id="Debugging_auto_mount_issues">Debugging auto mount issues</span></h3>
<p>For better debugging, try running automount in the foreground.
</p>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Stop">Stop</a> <code>autofs.service</code>, then run:
</p>
<pre># automount -f -v
</pre>
<p>Or if you want more debug info then try:
</p>
<pre># automount -f --debug
</pre>
<h2><span class="mw-headline" id="Alternatives_to_AutoFS">Alternatives to AutoFS</span></h2>
<ul>
<li>
<a href="../en/Systemd.html" title="Systemd">Systemd</a> can automount filesystems upon demand; see <a href="../en/Fstab.html#Automount_with_systemd" title="Fstab">here</a> for the description and the article on <a href="../en/SSHFS.html#On_demand" title="SSHFS">sshfs</a> for an example.</li>
<li>
<a href="../en/Thunar.html#Thunar_Volume_Manager" class="mw-redirect" title="Thunar Volume Manager">Thunar Volume Manager</a> is an automount system for users of the <a href="../en/Thunar.html" title="Thunar">Thunar</a> file manager.</li>
<li>
<a href="../en/PCManFM.html" title="PCManFM">PCManFM</a> is a lightweight file manager with built-in support for accessing remote shares</li>
<li>
<a href="../en/Udisks.html" title="Udisks">Udisks</a> is a minimalistic automatic disk mounting service</li>
</ul>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li>FTP and SFTP usage with AutoFS is based on this Gentoo Wiki article: <a rel="nofollow" class="external free" href="https://web.archive.org/web/20130414074212/http://en.gentoo-wiki.com/wiki/Mounting_SFTP_and_FTP_shares">https://web.archive.org/web/20130414074212/http://en.gentoo-wiki.com/wiki/Mounting_SFTP_and_FTP_shares</a>
</li>
<li>More information on SSH can be found on the <a href="../en/Secure_Shell.html" class="mw-redirect" title="SSH">SSH</a> and <a href="../en/SSH_keys.html" class="mw-redirect" title="Using SSH Keys">Using SSH Keys</a> pages of this wiki.</li>
<li>Ubuntu's Autofs help wiki is at <a rel="nofollow" class="external free" href="https://help.ubuntu.com/community/Autofs">https://help.ubuntu.com/community/Autofs</a>
</li>
<li>For filesystem specific mount options see <span class="plainlinks archwiki-template-man" title="$ man 8 mount"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mount.8#FILESYSTEM-SPECIFIC_MOUNT_OPTIONS">mount(8) § FILESYSTEM-SPECIFIC MOUNT OPTIONS</a></span>
</li>
<li>For fuse specific mount options see <span class="plainlinks archwiki-template-man" title="$ man 8 mount.fuse"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mount.fuse.8">mount.fuse(8)</a></span>
</li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:File_systems.html" title="Category:File systems">File systems</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Autofs&amp;oldid=749068">https://wiki.archlinux.org/index.php?title=Autofs&amp;oldid=749068</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 28 September 2022, at 09:54.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
