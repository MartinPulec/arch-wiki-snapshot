<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-zebra-design-disabled vector-feature-custom-font-size-clientpref-disabled vector-feature-client-preferences-disabled vector-feature-typography-survey-disabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Asterisk - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.41.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Asterisk rootpage-Asterisk skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-main-menu-container">
		</div>
	<input type="checkbox" id="vector-toc-collapsed-checkbox" class="vector-menu-checkbox">
			<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark vector-sticky-pinned-container">
				<div id="vector-toc-pinned-container" class="vector-pinned-container">
				<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Installation</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Configuration</div>
		</a>
		
			<button aria-controls="toc-Configuration-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configuration subsection</span>
			</button>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
			<li id="toc-PJSIP" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#PJSIP">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>PJSIP</div>
			</a>
			
			<ul id="toc-PJSIP-sublist" class="vector-toc-list">
				<li id="toc-modules.conf" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#modules.conf">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.1</span>modules.conf</div>
			</a>
			
			<ul id="toc-modules.conf-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-pjsip.conf" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#pjsip.conf">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.2</span>pjsip.conf</div>
			</a>
			
			<ul id="toc-pjsip.conf-sublist" class="vector-toc-list">
				<li id="toc-transport_section" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#transport_section">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.2.1</span>transport section</div>
			</a>
			
			<ul id="toc-transport_section-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-registration_section" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#registration_section">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.2.2</span>registration section</div>
			</a>
			
			<ul id="toc-registration_section-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-authentication_section" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#authentication_section">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.2.3</span>authentication section</div>
			</a>
			
			<ul id="toc-authentication_section-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-endpoint_section" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#endpoint_section">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.2.4</span>endpoint section</div>
			</a>
			
			<ul id="toc-endpoint_section-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-identify_section" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#identify_section">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.2.5</span>identify section</div>
			</a>
			
			<ul id="toc-identify_section-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-aor_(Address_Of_Record)_section" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#aor_(Address_Of_Record)_section">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.2.6</span>aor (Address Of Record) section</div>
			</a>
			
			<ul id="toc-aor_(Address_Of_Record)_section-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-phone_sections" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#phone_sections">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.2.7</span>phone sections</div>
			</a>
			
			<ul id="toc-phone_sections-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Managing_PJSIP" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Managing_PJSIP">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.3</span>Managing PJSIP</div>
			</a>
			
			<ul id="toc-Managing_PJSIP-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-chan_sip" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#chan_sip">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>chan_sip</div>
			</a>
			
			<ul id="toc-chan_sip-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Music_on_hold" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Music_on_hold">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3</span>Music on hold</div>
			</a>
			
			<ul id="toc-Music_on_hold-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Voicemail" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Voicemail">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4</span>Voicemail</div>
			</a>
			
			<ul id="toc-Voicemail-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Connecting_to_the_PSTN" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Connecting_to_the_PSTN">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.5</span>Connecting to the PSTN</div>
			</a>
			
			<ul id="toc-Connecting_to_the_PSTN-sublist" class="vector-toc-list">
				<li id="toc-General_set-up" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#General_set-up">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.5.1</span>General set-up</div>
			</a>
			
			<ul id="toc-General_set-up-sublist" class="vector-toc-list">
				<li id="toc-sip.conf" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#sip.conf">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.5.1.1</span>sip.conf</div>
			</a>
			
			<ul id="toc-sip.conf-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-extensions.conf" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#extensions.conf">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.5.1.2</span>extensions.conf</div>
			</a>
			
			<ul id="toc-extensions.conf-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-iax.conf" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#iax.conf">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.5.1.3</span>iax.conf</div>
			</a>
			
			<ul id="toc-iax.conf-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-extensions.conf_2" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#extensions.conf_2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.5.1.4</span>extensions.conf</div>
			</a>
			
			<ul id="toc-extensions.conf_2-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Sounds" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Sounds">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.6</span>Sounds</div>
			</a>
			
			<ul id="toc-Sounds-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-MeetMe" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#MeetMe">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.7</span>MeetMe</div>
			</a>
			
			<ul id="toc-MeetMe-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Asterisk_console_and_softphones" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Asterisk_console_and_softphones">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Asterisk console and softphones</div>
		</a>
		
		<ul id="toc-Asterisk_console_and_softphones-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Troubleshooting">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Troubleshooting</div>
		</a>
		
		<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

				</div>
	</nav>
		
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<label id="vector-toc-collapsed-button" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet vector-button-flush-left cdx-button--icon-only" for="vector-toc-collapsed-checkbox" role="button" aria-controls="vector-toc" tabindex="0" title="Table of Contents">
						<span class="vector-icon mw-ui-icon-wikimedia-listBullet"></span>
						<span>Toggle the table of contents</span>
					</label>
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Asterisk</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 1 language">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-1" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">1 language</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Asterisk" title="Asterisk – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<nav class="vector-page-tools-landmark vector-sticky-pinned-container" aria-label="Page tools">
						<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
			
						</div>
	</nav>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr">
<div class="mw-parser-output">
<p><a rel="nofollow" class="external text" href="https://www.asterisk.org">Asterisk</a> is a complete PBX (private branch exchange) in software. It runs on Linux, BSD, Windows and macOS and provides all of the features you would expect from a PBX and more. Asterisk does voice over IP in four protocols, and can interoperate with almost all standards-based telephony equipment using relatively inexpensive hardware.
</p>
<p>Asterisk provides voice-mail services with directory, call conferencing, interactive voice response and call queuing. It has support for three-way calling, caller ID services, ADSI, IAX, SIP, H.323 (as both client and gateway), MGCP (call manager only) and SCCP/Skinny. 
</p>
<p>This article will show you how to configure a simple in house network enabling us to use a SIP <a href="../en/List_of_applications/Internet.html#SIP_clients" class="mw-redirect" title="Softphone">softphone</a> to talk to another SIP softphone on your LAN.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:View-refresh-red.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section is out of date.</b></p>
<div>
<b>Reason:</b> This recommendation for <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/asterisk-cisco/">asterisk-cisco</a></span><sup><small>AUR</small></sup> may be obsolete, this was written quite a while ago, and modern versions may already include this patch. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Asterisk.html">Talk:Asterisk</a>)</div>
</div>
<p>Install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/asterisk/">asterisk</a></span><sup><small>AUR</small></sup> package. If you are using Cisco-based phones it is recommended to use the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/asterisk-cisco/">asterisk-cisco</a></span><sup><small>AUR</small></sup> package instead as this is pre-patched with the presence patch. (See <a rel="nofollow" class="external text" href="https://issues.asterisk.org/jira/browse/ASTERISK-13145">Issue 13145</a>).
</p>
<p>Alternatively, you can install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/asterisk-lts-18/">asterisk-lts-18</a></span><sup><small>AUR</small></sup> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/asterisk-lts-20/">asterisk-lts-20</a></span><sup><small>AUR</small></sup> package to have a long-term support release (current latest LTS major version is Asterisk 20). Asterisk LTS releases tend to have fewer features, but will be maintained for much longer. See the <a rel="nofollow" class="external text" href="https://wiki.asterisk.org/wiki/display/AST/Asterisk+Versions">Asterisk Versions</a> page for complete details about the release cycle for all Asterisk versions.
</p>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable/start">Enable/start</a> <code>asterisk.service</code>.
</p>
<p>You will also need a SIP <a href="../en/List_of_applications/Internet.html#SIP_clients" class="mw-redirect" title="Softphone">softphone</a> and at least two machines. Recommendations for SIP phones are <a rel="nofollow" class="external text" href="https://icanblink.com/">Blink</a> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/blink/">blink</a></span><sup><small>AUR</small></sup>), <a rel="nofollow" class="external text" href="https://www.linphone.org/">Linphone</a> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/liblinphone-git/">liblinphone-git</a></span><sup><small>AUR</small></sup>) or <a rel="nofollow" class="external text" href="https://www.counterpath.com/x-lite/">X-Lite</a> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/xlite-bin/">xlite-bin</a></span><sup><small>AUR</small></sup>).
</p>
<p>To enable ilbc codec support add the following to the very beginning of the <code>build</code> section of the PKGBUILD:
</p>
<pre>cd ${srcdir}/${pkgname}-${pkgver}/contrib/scripts
echo | ./get_ilbc_source.sh
</pre>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>As of Asterisk 20, the legacy <code>chan_sip</code> module is no longer compiled by default. If you would rather use <code>chan_sip</code> than <code>res_pjsip</code>, please install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/asterisk-lts-18/">asterisk-lts-18</a></span><sup><small>AUR</small></sup>, which was the last LTS release to build <code>chan_sip</code>.
</p>
<p><code>res_pjsip</code> is the newer, more performant Asterisk channel module that supports the standard SIP (Session Initiation Protocol) protocol, the primary VoIP (Voice over Internet Protocol) protocol in use by many carriers, telcos, Internet telephony service providers (ITSPs), and enterprises. However, <code>res_pjsip</code> is considerably more complicated to set up than the older <code>chan_sip</code>. 
</p>
<p>The prevailing wisdom of the wider Asterisk community suggests to only use <code>chan_sip</code> if you already have an existing configuration for it, while also planning the upgrade to <code>res_pjsip</code>. For any new installations, <code>res_pjsip</code> is recommended. As mentioned above, <code>chan_sip</code> is no longer maintained, not even for security fixes (except in older LTS releases), so new Asterisk PBX administrators should go with a supported SIP channel driver (i.e., <code>res_pjsip</code>).
</p>
<p>If you have an existing <code>chan_sip</code> configuration, to build it in Asterisk 20 LTS, you can do the following:  Edit the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/asterisk-lts-20/">asterisk-lts-20</a></span><sup><small>AUR</small></sup> PKGBUILD, in the <code>build()</code> function. Modify the following line:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">PKGBUILD</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">make MENUSELECT_CFLAGS= OPTIMIZE= DEBUG= ASTVARRUNDIR="/run/$pkgname" NOISY_BUILD=1</pre>
<p>Prefix it with a call to build the menuselect tool, and enable <code>chan_sip</code>:  
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">PKGBUILD</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">make menuselect.makeoptions &amp;&amp; \
menuselect/menuselect --enable chan_sip &amp;&amp; \
make MENUSELECT_CFLAGS= OPTIMIZE= DEBUG= ASTVARRUNDIR="/run/$pkgname" NOISY_BUILD=1</pre>
<p>Note that this will need to be done with every update of the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/asterisk-lts-20/">asterisk-lts-20</a></span><sup><small>AUR</small></sup> package.
</p>
<h3><span class="mw-headline" id="PJSIP">PJSIP</span></h3>
<p>Once installed, Asterisk has the <code>res_pjsip</code> configuration in <code>/etc/asterisk/pjsip.conf</code>. The sample file included with Asterisk gives several basic examples, but is not exhaustive for all pjsip options. Readers are encouraged to read the <a rel="nofollow" class="external text" href="https://wiki.asterisk.org/wiki/x/EwFB">Asterisk Wiki Security best practices article</a> <sup>[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2024-03-17]</sup>, and <a rel="nofollow" class="external text" href="https://docs.asterisk.org/Configuration/Channel-Drivers/SIP/Configuring-res_pjsip/">Configuring res_pjsip</a> before continuing. 
</p>
<p>This article contains a basic single SIP phone, multiple SIP trunk example, using <a rel="nofollow" class="external text" href="https://store.sipstation.com/ss_index/">SIP Station SIP trunks, from Sangoma</a>. Two SIP trunks with SIP Station are configured for redundancy, as recommended by SIP Station. The following example was tested using a Sangoma/Digium D60 hardware phone, but any SIP 2.0 compliant hard- or softphone should suffice.
</p>
<p>This example assumes the Asterisk PBX server and SIP phone are on a private IPv4 LAN, with a NAT router between the server/phone and the WAN/Internet. If you would like to use IPv6, please read the <a rel="nofollow" class="external text" href="https://docs.asterisk.org/Configuration/Channel-Drivers/SIP/Configuring-res_pjsip/Configuring-res_pjsip-for-IPv6/">Configuring res_pjsip for IPv6</a> article.
</p>
<h4><span class="mw-headline" id="modules.conf">modules.conf</span></h4>
<p>First, ensure <code>res_pjsip.so</code> is not prefixed with <code>noload =</code>. In this example, the <code>require =</code> prefix makes Asterisk fail to load if <code>chan_pjsip.so</code> fails to load. This is not absolutely necessary, but unless you are using other VoIP protocols it may not make sense for Asterisk to load if <code>res_pjsip</code> does not load.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/asterisk/modules.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">;...
require = chan_pjsip.so
;...
</pre>
<h4><span class="mw-headline" id="pjsip.conf">pjsip.conf</span></h4>
<p>Before diving into configuring <code>pjsip.conf</code>, review the <a rel="nofollow" class="external text" href="https://docs.asterisk.org/Configuration/Channel-Drivers/SIP/Configuring-res_pjsip/PJSIP-Configuration-Wizard/">PJSIP Configuration Wizard</a>. It is useful for the simple use case of only one SIP provider/ITSP, and handles many of the pjsip objects for this automatically.
</p>
<p>The file <code>pjsip.conf</code> is an ini-style configuration file, with <code>[section-headers-in-square-brackets]</code>, and either a hash (<code>#</code>) or a semicolon (<code>;</code>) as the comment character. Each line under a section header is a <code>key=value</code> pair, with section-specific keys set to the specified values. Note that section headers can have <code>(!)</code> appended after the closing square bracket, which indicates the section is a template, for later use within <code>pjsip.conf</code>. To instantiate a section using a previously defined template, suffix the section header with the <code>(template-name)</code>.
</p>
<h5><span class="mw-headline" id="transport_section">transport section</span></h5>
<p>In order to define a SIP trunk for use with Asterisk, PJSIP has the concept of a network <code>transport</code>. From the Asterisk Wiki, the transport section configures how <code>res_pjsip</code> will operate at the transport layer. For example, it supports configuration options for protocols such as TCP, UDP, or WebSockets and encryption methods like TLS/SSL.
</p>
<p>Transport sections can be named arbitrarily, but it is recommended to name the section that makes it easy to remember what it signifies. The following example names it <code>[transport-udp-nat]</code> for identifying that this transport is using UDP for SIP, and is expected to traverse a NAT device.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/asterisk/pjsip.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[transport-udp-nat]
type=transport  ; signifies this is a transport definition
protocol=udp  ; specifies this uses the UDP transport protocol
; this transport binds to all configured network interfaces, 
; replace with the IP address of the desired interface. 0.0.0.0 means all interfaces
bind=0.0.0.0
; =====  NOTE, the following directives are OPTIONAL
local_net=10.20.30.0/24  ; specify the networks that this Asterisk server should consider as local/LAN networks. Change this to the local LAN subnet (in CIDR notation)
local_net=127.0.0.0/8  ; specify the networks that this Asterisk server should consider as local/LAN networks (this one sets it to the IPv4 loopback network)
external_media_address=96.69.199.60  ; specify the external/WAN IP address for RDP media (audio)
external_signaling_address=96.69.199.60  ; specify the external/WAN IP address for SIP (signaling)</pre>
<p>Note that only one transport is allowed for each IP address/port or IP address/protocol mapping. If you would like to configure multiple transport protocols (e.g. both TCP and UDP), you will need to bind each protocol to a different IP address. Likewise if you want to define multiple transports using the same protocol, the ports used need to be different for each transport definition.
</p>
<h5><span class="mw-headline" id="registration_section">registration section</span></h5>
<p>Next, define the registrations the SIP trunks will use. Note that the SIP Station registrations are first defined via a template (with <code>(!)</code> appended to the section name). Each template defines the settings that are common for each section using the template;  the sections themselves only contain the options that need to be set for that section.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/asterisk/pjsip.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[sipstation-reg](!)
type=registration
transport=transport-udp-nat
contact_user=15055551234
retry_interval=60

; ==== ... several other templates and sections will appear here
; ====     including the authentication sections, etc., which are also used by the registration
; ==== ....

[siptsation-reg1](sipstation-reg)
outbound_auth=sipstation-auth1 
server_uri=sip:trunk1.freepbx.com  ; trunk1 provided by SIP Station
client_uri=sip:my_username@trunk1.freepbx.com

[siptsation-reg2](sipstation-reg)
outbound_auth=sipstation-auth2 
server_uri=sip:trunk2.freepbx.com  ;  trunk2 provided by SIP Station
client_uri=sip:my_username@trunk2.freepbx.com</pre>
<h5><span class="mw-headline" id="authentication_section">authentication section</span></h5>
<p>Here, define the authentication template, and the specific authentication sections for use with the SIP Station trunks.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/asterisk/pjsip.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[sipstation-auth](!)
type=auth
password=Super*Secret@Password!
username=my_username

; ==== ... more templates may appear here

[sipstation-auth1](sipstation-auth)
realm=trunk1.freepbx.com

[sipstation-auth2](sipstation-auth)
realm=trunk2.freepbx.com</pre>
<h5><span class="mw-headline" id="endpoint_section">endpoint section</span></h5>
<p>An endpoint is essentially a profile for the configuration of a SIP device such as a phone or remote server. This defines the transport, the Asterisk Dialplan context where calls originating from the endpoint gets handled, and the audio codecs allowed for the endpoint. For the SIP station trunks, define the following:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/asterisk/pjsip.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[sipstation-endpoint](!)
type=endpoint
transport=transport-udp-nat
context=from-external  ; Dialplan context, defined in extensions.conf or related file
disallow=all   ; disallows all codecs, including default ones, unless explicitly allowed below
allow=ulaw     ; standard G.711, uncompressed PCM codec. Uses the most bandwidth
allow=gsm      ; another standard, compressed codec. Uses less bandwidth than ulaw
; other codecs are available, and have different attributes. Some require paid licenses to use.
aors=sipstation-aors  ; AOR - Address of Record, to be defined later
;direct_media=no  ; setting this may not allow audio to pass through NAT
direct_media=yes
rtp_symmetric=yes

; ==== ... more template definitions

[sipstation-endpoint1](sipstation-endpoint)
outbound_auth=sipstation-auth1
from_domain=trunk1.freepbx.com

[sipstation-endpoint2](sipstation-endpoint)
outbound_auth=sipstation-auth2
from_domain=trunk2.freepbx.com</pre>
<h5><span class="mw-headline" id="identify_section">identify section</span></h5>
<p>Controls how the res_pjsip_endpoint_identifier_ip module determines what endpoint an incoming packet is from. For the SIP Station trunks, the following is defined:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/asterisk/pjsip.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[sipstation-identify](!)
type=identify
; this is the LAN IP address of the NAT router, which calls from the SIP Station
; trunks may appear to come from (because of NAT).
match=10.20.30.254/32

[sipstation-id1](sipstation-identify)
endpoint=sipstation-endpoint1
match=192.159.66.3   ;  IP address of trunk1.freepbx.com

[sipstation-id2](sipstation-identify)
endpoint=sipstation-endpoint2
match=162.253.134.142    ;  IP address of trunk2.freepbx.com</pre>
<h5>
<span id="aor_.28Address_Of_Record.29_section"></span><span class="mw-headline" id="aor_(Address_Of_Record)_section">aor (Address Of Record) section</span>
</h5>
<p>A primary feature of AOR objects (Address of Record) is to tell Asterisk where an endpoint can be contacted. Without an associated AOR section, an endpoint cannot be contacted. For the SIP Station trunks, define this:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/asterisk/pjsip.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[sipstation-aors]
type=aor
contact=sip:trunk1.freepbx.com
contact=sip:trunk2.freepbx.com</pre>
<h5><span class="mw-headline" id="phone_sections">phone sections</span></h5>
<p>Finally, define the necessary sections for the SIP phone that will register to Asterisk. It has several similar sections as with the SIP Station trunks. Expand these with templates if multiple local SIP phones are intended to register to your Asterisk PBX. Remote phones (from the WAN/Internet) can also be configured, but that iss outside the scope of this example.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/asterisk/pjsip.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[home-phone]
type=endpoint
transport=transport-udp-nat
context=from-internal  ;  Dialplan context that gets executed when a user dials from this phone
disallow=all
allow=ulaw
allow=gsm
auth=home-phone-auth
aors=home-phone

[home-phone-auth]
type=auth
auth_type=userpass
password=MyPhonePa$$word0
username=home-phone

[home-phone]
type=aor
max_contacts=1</pre>
<h4><span class="mw-headline" id="Managing_PJSIP">Managing PJSIP</span></h4>
<p>There are several commands regarding <code>res_pjsip</code> available in the Asterisk CLI, all prefixed with the <code>pjsip</code> command. To get to the Asterisk CLI, enter the following command, as the <code>asterisk</code> user:
</p>
<pre>$ asterisk -rvvv
</pre>
<p>This assumes Asterisk is already running (e.g., via the systemd service unit). Once in the Asterisk CLI, you will see the prompt <code>hostname*CLI&gt; </code>. To see a list of available PJSIP commands, type <code>help pjsip</code>.
</p>
<p>To see a list of PJSIP registrations, type the following:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">hostname*CLI&gt; pjsip show registrations</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">

 &lt;Registration/ServerURI..............................&gt;  &lt;Auth....................&gt;  &lt;Status.......&gt;
---------------------------------------------------------------------------------------------

 siptsation-reg1/sip:trunk1.freepbx.com                  sipstation-auth1            Registered        (exp. 2062s)
 siptsation-reg2/sip:trunk2.freepbx.com                  sipstation-auth2            Registered        (exp. 2069s)

Objects found: 2
</pre>
<p>To see a list of PJSIP endpoints, type the following:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">hostname*CLI&gt; pjsip show endpoints</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">                                                                                                 
 Endpoint:  &lt;Endpoint/CID.....................................&gt;  &lt;State.....&gt;  &lt;Channels.&gt;
    I/OAuth:  &lt;AuthId/UserName...........................................................&gt;
        Aor:  &lt;Aor............................................&gt;  &lt;MaxContact&gt;
      Contact:  &lt;Aor/ContactUri..........................&gt; &lt;Hash....&gt; &lt;Status&gt; &lt;RTT(ms)..&gt;
  Transport:  &lt;TransportId........&gt;  &lt;Type&gt;  &lt;cos&gt;  &lt;tos&gt;  &lt;BindAddress..................&gt;
   Identify:  &lt;Identify/Endpoint.........................................................&gt;
        Match:  &lt;criteria.........................&gt;
    Channel:  &lt;ChannelId......................................&gt;  &lt;State.....&gt;  &lt;Time.....&gt;
        Exten: &lt;DialedExten...........&gt;  CLCID: &lt;ConnectedLineCID.......&gt;
 ----------------------------------------------------------------------------------------------

 Endpoint:  home-phone                                           Not in use    0 of inf
     InAuth:  home-phone-auth/home-phone
        Aor:  home-phone                                         1
      Contact:  home-phone/sip:home-phone@10.20.30.229:506 f91928f561 NonQual         nan
  Transport:  transport-udp-nat         udp      0      0  0.0.0.0:5060

 Endpoint:  sipstation-endpoint1                                 Not in use    0 of inf
    OutAuth:  sipstation-auth1/mw3FSBsPPjQ7
        Aor:  sipstation-aors                                    0
      Contact:  sipstation-aors/sip:trunk1.freepbx.com     256c242e36 NonQual         nan
      Contact:  sipstation-aors/sip:trunk2.freepbx.com     c07c6c7180 NonQual         nan
  Transport:  transport-udp-nat         udp      0      0  0.0.0.0:5060
   Identify:  sipstation-id1/sipstation-endpoint1
        Match: 10.20.30.254/32
        Match: 192.159.66.3/32

 Endpoint:  sipstation-endpoint2                                 Not in use    0 of inf
    OutAuth:  sipstation-auth2/mw3FSBsPPjQ7
        Aor:  sipstation-aors                                    0
      Contact:  sipstation-aors/sip:trunk1.freepbx.com     256c242e36 NonQual         nan
      Contact:  sipstation-aors/sip:trunk2.freepbx.com     c07c6c7180 NonQual         nan
  Transport:  transport-udp-nat         udp      0      0  0.0.0.0:5060
   Identify:  sipstation-id2/sipstation-endpoint2
        Match: 10.20.30.254/32
        Match: 162.253.134.142/32

Objects found: 3
</pre>
<h3><span class="mw-headline" id="chan_sip">chan_sip</span></h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> chan_sip has been completely removed from Asterisk 21 (as available in the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/asterisk/">asterisk</a></span><sup><small>AUR</small></sup>) and the wider Asterisk community is opposed to using it instead of the replacement chan_pjsip.</div>
<p>Note that the following instructions assume that you want to use already obsoleted <code>chan_sip</code> module. The <code>chan_sip</code> module is no longer maintained, but is easier to configure then the newer <code>res_pjsip</code> module. There is a summary of configuration changes between two modules, as well as instructions on how to migrate to the newer module, on the  <a rel="nofollow" class="external text" href="https://docs.asterisk.org/Configuration/Channel-Drivers/SIP/Configuring-res_pjsip/Migrating-from-chan_sip-to-res_pjsip/">Asterisk documentation</a>. 
</p>
<p>In order to use <code>chan_sip</code>, you need to explicitly load the older module, and ensure that the newer <code>chan_pjsip.so</code> module is unloaded. In <code>/etc/asterisk/modules.conf</code> adjust the following:
</p>
<pre>noload =&gt; chan_pjsip.so
noload =&gt; res_pjsip.so
<b>;</b> noload =&gt; chan_sip.so</pre>
<p>Add this to the following file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/asterisk/sip.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
[me1]
type=friend
username=me1
secret=PASSWORD
host=dynamic
context=house

[me2]
type=friend
username=me2
secret=PASSWORD
host=dynamic
context=house</pre>
<p>This creates our two SIP users <code>me1</code> and <code>me2</code> with a password of <code>PASSWORD</code> in the <code>house</code> context. The context will be defined next.
</p>
<p>Add this to the following file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/asterisk/extensions.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[house]
exten =&gt; 100,1,Dial(SIP/me1)
exten =&gt; 101,1,Dial(SIP/me2)</pre>
<p>This creates the context <code>house</code> and assigns extension 100 to the SIP user <code>me1</code>, and extension 101 to the SIP user <code>me2</code>.
</p>
<p>Now all that is left is to see if it works.
</p>
<h3><span class="mw-headline" id="Music_on_hold">Music on hold</span></h3>
<p>Music on hold is a really sweet feature. And once again easy to install and configure.
Edit <code>/etc/asterisk/musiconhold.conf</code> and add, or make sure it is uncommented:
</p>
<pre>[default]
mode=files
directory=mohmp3</pre>
<p>And that is all there is to it. Just copy your favorite legally obtained MP3 to <code>/var/lib/asterisk/mohmp3</code>.
</p>
<h3><span class="mw-headline" id="Voicemail">Voicemail</span></h3>
<p>Voicemail is another feature of asterisk. There are many ways to configure it, however this article only covers a simple approach.
</p>
<p>Create/edit your <code>voicemail.conf</code>:
</p>
<pre>[general]
format=gsm|wav49|wav
serveremail=asterisk
attach=no
mailcmd=/usr/sbin/sendmail -t
maxmessage=180
maxgreet=60

[default]
100 =&gt; 1234,Me,me@mydomain.com
</pre>
<p>What does this mean? Most of the <code>[general]</code> is pretty self-explanatory. However, do note that if you have postfix set up right the PBX will send an email notifying the user of a new voice-mail and if <code>attach=yes</code> is defined it will attach the file.
</p>
<p>Now for the actual mailbox. The format is:
</p>
<pre>mailbox =&gt; password,user,email
</pre>
<p>In this case, we gave 'Me' (email me@mydomain.com) mailbox 100, with a password of 1234.
</p>
<p>Now we have to have a way to leave messages to this voice-mail, and a way to access it. 
For this, we go back to the <code>extensions.conf</code> and modify your existing entry as follows:
</p>
<pre>exten =&gt; 100,1,Dial(SIP/me1,20)
exten =&gt; 100,n,Voicemail(u100@default)
</pre>
<p>The 20 on the end of the first 'exten' tells 'Dial()' to call for 20 seconds. If no one answers it heads to voice-mail box 100 in the default context.
</p>
<p>Next is actually accessing your voicemail. For this we add:
</p>
<pre>exten =&gt; 600,1,VoiceMailMain,s100@default
</pre>
<p>So when we call 600, the application 'VoiceMailMain' goes to 100 in the default context. The <code>s</code> allows for automatic login. 
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The 'VoiceMail' applications have a significant amount of options, so it is suggested reading over some additional documentation. This is just for a basic, home use setup. Also note that it is generally a good idea to use extensions higher then your users extensions for accessing 'VoiceMail'. This way someone dialing 208 does not hit someone's voice-mail at 205.</div>
<h3><span class="mw-headline" id="Connecting_to_the_PSTN">Connecting to the PSTN</span></h3>
<p>Now that you have the previous setup, it is time to actually connect to the outside world. To do this, you will need a provider such as <a rel="nofollow" class="external text" href="https://www.onsip.com/">OnSIP</a>. Your provider should have instructions on connecting to asterisk, so this section is very general.
</p>
<h4><span class="mw-headline" id="General_set-up">General set-up</span></h4>
<h5><span class="mw-headline" id="sip.conf">sip.conf</span></h5>
<pre>[general]
register =&gt; username:password@sip.specific.com

[whatever]                   
fromdomain=specific.com     
host=sip.specific.com
insecure=very    ; check with provider
username=usernameduh
secret=passwordduh
type=peer</pre>
<h5><span class="mw-headline" id="extensions.conf">extensions.conf</span></h5>
<pre>[outboundwithCID]  ; this can be whatever
exten =&gt; _1NXXNXXXXXX,1,SetCIDNum(15555551234)
exten =&gt; _1NXXNXXXXXX,2,Dial(SIP/${EXTEN}@whatever)
exten =&gt; _1NXXNXXXXXX,3,Congestion()
exten =&gt; _1NXXNXXXXXX,103,Busy()

[default]  ; This should be set in your sip.conf for incoming calls

;These should to be changed to your actual number
; ie     15555555555
exten =&gt; 1NXXNXXXXXX,1,Answer()
exten =&gt; 1NXXNXXXXXX,2,Playback(ttt-weasels)
exten =&gt; 1NXXNXXXXXX,3,HangUp()</pre>
<ul>
<li>In the outbound context, any number dialed will be sent out to your service provider. The 'whatever' in the 2 priority should match what you have in your <code>sip.conf</code>.</li>
<li>Of course, the inbound dial-plan can be modified to do what you want. For instance, you can have <code>Dial(SIP/me1)</code> so when someone calls your number they are routed to your SIP phone on your computer. Then add in voice-mail and so on.</li>
</ul>
<h5><span class="mw-headline" id="iax.conf">iax.conf</span></h5>
<p>The first step is to log into FWD and enable their side of IAX. It is under extra features, and keep in mind that the authors claim it takes a little while to activate. 
</p>
<p>Now edit your <code>iax.conf</code> with the following in the 'general' section:
</p>
<pre>register =&gt; FWDNUMBER:PASSWORD@iax2.fwdnet.net 
disallow = all
allow = ulaw</pre>
<p>And at the bottom add:
</p>
<pre>[iaxfwd]
type=user
context=fromiaxfwd
auth=rsa
inkeys=freeworlddialup</pre>
<p>This allows calls from FWD.
</p>
<h5><span class="mw-headline" id="extensions.conf_2">extensions.conf</span></h5>
<p>Place this at the top under '[globals]':
</p>
<pre>FWDNUMBER=MYFWDNUMBER ; your calling number
FWDCIDNAME="MyName"; your caller id
FWDPASSWORD=MYFWDPASSWORD ; your password
FWDRINGS=sip/office ; the phone to ring
FWDVMBOX=1000 ; the VM box for this user</pre>
<p>Next, add this to a context for outgoing:
</p>
<pre>exten =&gt; _393.,1,SetCallerId,${FWDCIDNAME}
exten =&gt; _393.,2,Dial(IAX2/${FWDNUMBER}:${FWDPASSWORD}@iax2.fwdnet.net/${EXTEN:3},60,r)
exten =&gt; _393.,3,Congestion</pre>
<p>You can change the '393' to whatever you want. This is what you will dial before dialing a 'fwd' number. For instance, to dial '744561' you would dial '393744561'.
</p>
<p>And lastly, the incoming calls:
</p>
<pre>[fromiaxfwd]
exten =&gt; ${FWDNUMBER},1,Dial(${FWDRINGS},20,r)
exten =&gt; ${FWDNUMBER},2,Voicemail,u${FWDVMBOX}
exten =&gt; ${FWDNUMBER},102,Voicemail,b${FWDVMBOX}</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you have problems try removing the variables from <code>extensions.conf</code>. These instructions are from FWD's site and I have not been tested by this article's author.</div>
<p>Extensions to try calling are 55555 (a volunteer maned test line) and 514 (conference).
</p>
<h3><span class="mw-headline" id="Sounds">Sounds</span></h3>
<p>Sounds are stored in the folder <code>/var/lib/asterisk/xx</code>, <code>xx</code> stands for the code of the language for example "en" for English. To add new sounds copy them to the folder. Preserve the following folder structure:
</p>
<pre>/var/lib/asterisk/sounds/xx
/var/lib/asterisk/sounds/xx/digits
/var/lib/asterisk/sounds/xx/letters
/var/lib/asterisk/sounds/xx/phonetic
</pre>
<p>Edit the language parameter in the <code>sip.conf</code>
</p>
<pre>[general]
...
language=en
...</pre>
<p>Possible sources for sounds are:
</p>
<ul>
<li><a rel="nofollow" class="external free" href="https://downloads.asterisk.org/pub/telephony/sounds/">https://downloads.asterisk.org/pub/telephony/sounds/</a></li>
<li>
<a rel="nofollow" class="external free" href="https://packages.debian.org/wheezy/all/asterisk-prompt-xx">https://packages.debian.org/wheezy/all/asterisk-prompt-xx</a>
<ul>
<li><a rel="nofollow" class="external text" href="https://packages.debian.org/wheezy/all/asterisk-prompt-fr">fr</a></li>
<li><a rel="nofollow" class="external text" href="https://packages.debian.org/wheezy/all/asterisk-prompt-de">de</a></li>
<li>...</li>
</ul>
</li>
<li><a rel="nofollow" class="external text" href="https://www.voip-info.org/asterisk-sound-files-international/">voip-info.org</a></li>
</ul>
<h3><span class="mw-headline" id="MeetMe">MeetMe</span></h3>
<p>MeetMe is the application that allows you to do conference calling. Same as everything, basic setup is easy.
</p>
<p>Edit <code>meetme.conf</code>:
</p>
<pre>conf =&gt; 1000
</pre>
<p>Next is <code>extensions.conf</code>:
</p>
<pre>exten =&gt; 999,1,MeetMe(1000|M)
</pre>
<p>Now dial 999 to get into conference 1000. The <code></code> enables music on hold if no one is in there. It will automatically go away when someone joins the conference.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You <i>must</i> have the zaptel package in order for MeetMe to work. Install it and run <code>modprobe ztdummy</code> before running asterisk. This provides digium timing for us without cards so we can utilize TDM.</div>
<h2><span class="mw-headline" id="Asterisk_console_and_softphones">Asterisk console and softphones</span></h2>
<p>Now lets get Asterisk going: 
</p>
<pre># asterisk -vvvvvvc
</pre>
<p>This will give us the Asterisk CLI with verbose output. If Asterisk is already running you will need to use:
</p>
<pre># asterisk -r
</pre>
<p>Now fire up your SIP clients and set them up with the information in the sip.conf. Switch back to your Asterisk CLI and you should see: 
</p>
<pre>Registered SIP 'me1' at 192.168.0.142 port 5061 expires 60
</pre>
<p>Now you should be able to dial <code>101</code> from <code>me1</code> and talk to <code>me2</code>.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<p>If you receive a 404 Not Found error check your <code>extensions.conf</code> and the number you dialed.
</p>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Telephony.html" title="Category:Telephony">Telephony</a></li>
<li><a href="../en/Category:Voice_over_IP.html" title="Category:Voice over IP">Voice over IP</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li>
<li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Asterisk&amp;oldid=803805">https://wiki.archlinux.org/index.php?title=Asterisk&amp;oldid=803805</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 17 March 2024, at 21:55.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
