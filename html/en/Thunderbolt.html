<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Thunderbolt - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Thunderbolt rootpage-Thunderbolt skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Obtain_firmware_updates" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Obtain_firmware_updates">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Obtain firmware updates</div>
		</a>
		
		<ul id="toc-Obtain_firmware_updates-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-User_device_authorization" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#User_device_authorization">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>User device authorization</div>
		</a>
		
			<button aria-controls="toc-User_device_authorization-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle User device authorization subsection</span>
			</button>
		
		<ul id="toc-User_device_authorization-sublist" class="vector-toc-list">
			<li id="toc-Graphical_front-ends" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Graphical_front-ends">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Graphical front-ends</div>
			</a>
			
			<ul id="toc-Graphical_front-ends-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Automatically_connect_any_device" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Automatically_connect_any_device">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>Automatically connect any device</div>
			</a>
			
			<ul id="toc-Automatically_connect_any_device-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Forcing_power" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Forcing_power">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3</span>Forcing power</div>
			</a>
			
			<ul id="toc-Forcing_power-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Troubleshooting">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Troubleshooting</div>
		</a>
		
			<button aria-controls="toc-Troubleshooting-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Troubleshooting subsection</span>
			</button>
		
		<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
			<li id="toc-PCI_buses_are_not_registered" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#PCI_buses_are_not_registered">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>PCI buses are not registered</div>
			</a>
			
			<ul id="toc-PCI_buses_are_not_registered-sublist" class="vector-toc-list">
				<li id="toc-Automatic_PCI_bus_rescan" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Automatic_PCI_bus_rescan">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.1</span>Automatic PCI bus rescan</div>
			</a>
			
			<ul id="toc-Automatic_PCI_bus_rescan-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Increasing_hot-plug_bus_size_and_memory" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Increasing_hot-plug_bus_size_and_memory">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>Increasing hot-plug bus size and memory</div>
			</a>
			
			<ul id="toc-Increasing_hot-plug_bus_size_and_memory-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Thunderbolt</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 2 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-2" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">2 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Thunderbolt" title="Thunderbolt – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-pl mw-list-item"><a href="../pl/Thunderbolt.html" title="Thunderbolt – polski" lang="pl" hreflang="pl" class="interlanguage-link-target"><span>Polski</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/External_GPU.html" title="External GPU">External GPU</a></li>
</ul>
</div>
<p>Thunderbolt 3 works out of the box with recent Linux kernel versions <a rel="nofollow" class="external autonumber" href="https://docs.kernel.org/admin-guide/thunderbolt.html">[1]</a>. The Linux kernel, starting with version 4.13, supports Thunderbolt Security as well.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Obtain_firmware_updates">Obtain firmware updates</span></h2>
<p>Manufacturers often release firmware updates for Thunderbolt ports and devices to function properly, visit <a rel="nofollow" class="external free" href="https://thunderbolttechnology.net/updates">https://thunderbolttechnology.net/updates</a> for more details how to obtain upgrades for certain vendors.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Some vendors use <a href="../en/Fwupd.html" title="Fwupd">fwupd</a> to push firmware updates on Linux.</div>
<h2><span class="mw-headline" id="User_device_authorization">User device authorization</span></h2>
<p>Modern Thunderbolt devices implement security modes that require user authorization when connecting devices - this is to protect from malicious devices performing <a href="https://en.wikipedia.org/wiki/DMA_attack" class="extiw" title="wikipedia:DMA attack">DMA attacks</a> or otherwise interfering with the hardware (see <a rel="nofollow" class="external text" href="https://trmm.net/Thunderstrike_2">Thunderstrike 2</a>).
</p>
<p>The modes currently supported on Linux are:
</p>
<ul>
<li>
<code>none</code> - No security, all devices are connected and initialized by default. In BIOS settings this is typically called <i>Legacy mode</i>.</li>
<li>
<code>user</code> - User authorization is required every time a device is connected. In BIOS settings this is typically called <i>Unique ID</i>.</li>
<li>
<code>secure</code> - User authorization is required, but the device is then remembered and does not require re-authorization. In BIOS settings this is typically called <i>One time saved key</i>.</li>
<li>
<code>dponly</code> - DisplayPort functionality only, no other devices are allowed. In BIOS settings this is typically called <i>Display Port Only</i>.</li>
</ul>
<p>The security level is normally configured at firmware level; it is recommended to set it to at least <code>secure</code>. The state of this setting can be queried with:
</p>
<pre>$ cat /sys/bus/thunderbolt/devices/domain0/security
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> User-space solutions are available such as <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bolt">bolt</a></span> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/tbt/">tbt</a></span><sup><small>AUR</small></sup> to authorize devices.</div>
<h3><span class="mw-headline" id="Graphical_front-ends">Graphical front-ends</span></h3>
<ul>
<li>
<a href="../en/GNOME.html" title="GNOME">GNOME</a> has native support for authorizing devices from the UI since version 3.30</li>
<li>
<a href="../en/KDE.html#Plasma" class="mw-redirect" title="Plasma">Plasma</a> integration is available from this <a rel="nofollow" class="external text" href="https://invent.kde.org/plasma/plasma-thunderbolt">git repository</a> and from <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=plasma-thunderbolt">plasma-thunderbolt</a></span> package</li>
</ul>
<h3><span class="mw-headline" id="Automatically_connect_any_device">Automatically connect any device</span></h3>
<p>Users who just want to connect any device without any sort of manual work can create a <a href="../en/Udev.html#About_udev_rules" class="mw-redirect" title="Udev rule">udev rule</a> as in <code>99-removable.rules</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/udev/rules.d/99-removable.rules</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">ACTION=="add", SUBSYSTEM=="thunderbolt", ATTR{authorized}=="0", ATTR{authorized}="1"</pre>
<h3><span class="mw-headline" id="Forcing_power">Forcing power</span></h3>
<p>Many OEMs include a method that can be used to force the power of a Thunderbolt controller to an <i>On</i> state. If supported by the machine this will be exposed by the WMI bus with a sysfs attribute called <i>force_power</i> <a rel="nofollow" class="external autonumber" href="https://docs.kernel.org/admin-guide/thunderbolt.html#forcing-power">[2]</a>.
</p>
<p>Forcing power may especially be useful when a connected device loses connection or the controller that switches itself off.
</p>
<p>To force the power to be on/off, write 1 or 0 to this attribute, e.g. to force power:
</p>
<pre># echo 1 &gt; /sys/bus/wmi/devices/86CCFD48-205E-4A77-9C48-2021CBEDE341/force_power
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> It is not possible to query the current <code>force_power</code> state.</div>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="PCI_buses_are_not_registered">PCI buses are not registered</span></h3>
<p>Sometimes when connecting a Thunderbolt device PCI buses might not be registered. This is apparent by having screens working while USB devices fail to register on your computer. This can be solved by issuing a PCI rescan:
</p>
<pre># echo 1 &gt; /sys/bus/pci/rescan
</pre>
<h4><span class="mw-headline" id="Automatic_PCI_bus_rescan">Automatic PCI bus rescan</span></h4>
<p>For persistent issues with PCI buses not being registered, an automatic rescan can be configured using udev rules. This will trigger a rescan whenever a Thunderbolt device is connected.
</p>
<p>Create the PCI rescan bash script: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/local/bin/thunderbolt-rescan.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash
echo 1 &gt; /sys/bus/pci/rescan</pre>
<p>Make it executable:
</p>
<pre># chmod +x /usr/local/bin/thunderbolt-rescan.sh
</pre>
<p>Following up with a <a href="../en/Udev.html#About_udev_rules" class="mw-redirect" title="Udev rule">udev rule</a> that triggers on thunderbolt connection:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/udev/rules.d/98-thunderbolt-rescan.rules</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">ACTION=="add", SUBSYSTEM=="thunderbolt", RUN+="/usr/local/bin/thunderbolt-rescan.sh"</pre>
<h3><span class="mw-headline" id="Increasing_hot-plug_bus_size_and_memory">Increasing hot-plug bus size and memory</span></h3>
<p>Some motherboards' firmware does not report enough bus and memory sizes to the kernel, causing drivers loading to fail. Add the following to kernel command line to manually set the size.
</p>
<pre>pci=hpbussize=0x33,hpmemsize=256M
</pre>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://docs.kernel.org/admin-guide/thunderbolt.html">Linux kernel user's and administrator's guide on Thunderbolt</a></li>
<li><a rel="nofollow" class="external text" href="https://gitlab.freedesktop.org/bolt/bolt">bolt repository</a></li>
<li><a rel="nofollow" class="external text" href="https://christian.kellner.me/2017/12/14/introducing-bolt-thunderbolt-3-security-levels-for-gnulinux/">Introducing bolt: Thunderbolt 3 security levels for GNU/Linux</a></li>
<li><a rel="nofollow" class="external text" href="https://christian.kellner.me/2018/04/23/the-state-of-thunderbolt-3-in-fedora-28/">Thunderbolt Support in GNOME</a></li>
<li><a rel="nofollow" class="external text" href="https://daenney.github.io/2017/11/16/linux-thunberbolt-security">tbtadm</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Hardware.html" title="Category:Hardware">Hardware</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Thunderbolt&amp;oldid=822766">https://wiki.archlinux.org/index.php?title=Thunderbolt&amp;oldid=822766</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 11 December 2024, at 18:43.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
