<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Vault - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.43.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Vault rootpage-Vault skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Installation</span>
			</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Configuration</span>
			</div>
		</a>
		
			<button aria-controls="toc-Configuration-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configuration subsection</span>
			</button>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
			<li id="toc-Development_mode" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Development_mode">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1</span>
					<span>Development mode</span>
				</div>
			</a>
			
			<ul id="toc-Development_mode-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Production_configuration" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Production_configuration">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2</span>
					<span>Production configuration</span>
				</div>
			</a>
			
			<ul id="toc-Production_configuration-sublist" class="vector-toc-list">
				<li id="toc-Storage_configuration" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Storage_configuration">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2.1</span>
					<span>Storage configuration</span>
				</div>
			</a>
			
			<ul id="toc-Storage_configuration-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Listener_configuration" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Listener_configuration">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2.2</span>
					<span>Listener configuration</span>
				</div>
			</a>
			
			<ul id="toc-Listener_configuration-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-UI_configuration" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#UI_configuration">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2.3</span>
					<span>UI configuration</span>
				</div>
			</a>
			
			<ul id="toc-UI_configuration-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-API_and_cluster_addresses" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#API_and_cluster_addresses">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2.4</span>
					<span>API and cluster addresses</span>
				</div>
			</a>
			
			<ul id="toc-API_and_cluster_addresses-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Security_considerations" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Security_considerations">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2.5</span>
					<span>Security considerations</span>
				</div>
			</a>
			
			<ul id="toc-Security_considerations-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Audit_logging_configuration" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Audit_logging_configuration">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2.6</span>
					<span>Audit logging configuration</span>
				</div>
			</a>
			
			<ul id="toc-Audit_logging_configuration-sublist" class="vector-toc-list">
				<li id="toc-Configuring_a_file-based_audit_log" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Configuring_a_file-based_audit_log">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2.6.1</span>
					<span>Configuring a file-based audit log</span>
				</div>
			</a>
			
			<ul id="toc-Configuring_a_file-based_audit_log-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Other_audit_devices" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Other_audit_devices">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2.6.2</span>
					<span>Other audit devices</span>
				</div>
			</a>
			
			<ul id="toc-Other_audit_devices-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Logging_configuration" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Logging_configuration">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2.7</span>
					<span>Logging configuration</span>
				</div>
			</a>
			
			<ul id="toc-Logging_configuration-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Example_configuration" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Example_configuration">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2.8</span>
					<span>Example configuration</span>
				</div>
			</a>
			
			<ul id="toc-Example_configuration-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Creating_the_storage_directory" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Creating_the_storage_directory">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.3</span>
					<span>Creating the storage directory</span>
				</div>
			</a>
			
			<ul id="toc-Creating_the_storage_directory-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Running_Vault_as_a_systemd_service" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Running_Vault_as_a_systemd_service">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.4</span>
					<span>Running Vault as a systemd service</span>
				</div>
			</a>
			
			<ul id="toc-Running_Vault_as_a_systemd_service-sublist" class="vector-toc-list">
				<li id="toc-Creating_the_systemd_service_file" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Creating_the_systemd_service_file">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.4.1</span>
					<span>Creating the systemd service file</span>
				</div>
			</a>
			
			<ul id="toc-Creating_the_systemd_service_file-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Usage" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Usage">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Usage</span>
			</div>
		</a>
		
			<button aria-controls="toc-Usage-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Usage subsection</span>
			</button>
		
		<ul id="toc-Usage-sublist" class="vector-toc-list">
			<li id="toc-Setting_environment_variables" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Setting_environment_variables">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1</span>
					<span>Setting environment variables</span>
				</div>
			</a>
			
			<ul id="toc-Setting_environment_variables-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Initializing_vault" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Initializing_vault">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2</span>
					<span>Initializing vault</span>
				</div>
			</a>
			
			<ul id="toc-Initializing_vault-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Unseal_the_vault_and_login" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Unseal_the_vault_and_login">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.3</span>
					<span>Unseal the vault and login</span>
				</div>
			</a>
			
			<ul id="toc-Unseal_the_vault_and_login-sublist" class="vector-toc-list">
				<li id="toc-Automatic_unsealing" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Automatic_unsealing">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.3.1</span>
					<span>Automatic unsealing</span>
				</div>
			</a>
			
			<ul id="toc-Automatic_unsealing-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Manual_unsealing" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Manual_unsealing">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.3.2</span>
					<span>Manual unsealing</span>
				</div>
			</a>
			
			<ul id="toc-Manual_unsealing-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Login_to_the_vault" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Login_to_the_vault">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.3.3</span>
					<span>Login to the vault</span>
				</div>
			</a>
			
			<ul id="toc-Login_to_the_vault-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Accessing_the_UI" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Accessing_the_UI">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.4</span>
					<span>Accessing the UI</span>
				</div>
			</a>
			
			<ul id="toc-Accessing_the_UI-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Vault</span></h1>
				</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<p><br>
<a rel="nofollow" class="external text" href="https://www.vaultproject.io/">Vault</a> is an open-source tool from <a rel="nofollow" class="external text" href="https://www.hashicorp.com/">HashiCorp</a> for securely managing secrets and protecting sensitive data. It provides encryption as a service, access control, and detailed audit logging.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=vault">vault</a></span> package.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>Vault can be run in <a rel="nofollow" class="external text" href="https://developer.hashicorp.com/vault/docs/concepts/dev-server">development mode</a> for testing or configured as a production server with enhanced security settings.
The configuration is defined in a file using the <a rel="nofollow" class="external text" href="https://github.com/hashicorp/hcl/blob/main/guide/language_design.rst">"Hashicorp Command Language" (HCL)</a> format.
</p>
<h3><span class="mw-headline" id="Development_mode">Development mode</span></h3>
<p>For testing, Vault can be run in <a rel="nofollow" class="external text" href="https://developer.hashicorp.com/vault/docs/concepts/dev-server">development mode</a>, which starts with an in-memory storage backend and automatically unseals itself.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Development mode stores all data in memory and does not persist it to disk. All secrets and configurations will be lost upon restart.</div>
<p>To start Vault in development mode, run the following command:
</p>
<pre>$ vault server -dev
</pre>
<h3><span class="mw-headline" id="Production_configuration">Production configuration</span></h3>
<p>To set up a production-ready Vault server, create a configuration file:
</p>
<pre># mkdir /etc/vault
# touch /etc/vault/config.hcl
</pre>
<p>Then, add your desired configuration settings to <code>/etc/vault/config.hcl</code>.
</p>
<h4><span class="mw-headline" id="Storage_configuration">Storage configuration</span></h4>
<p>Vault supports multiple storage backends. For a simple file-based backend, use:
</p>
<pre>storage "file" {
    path = "/opt/vault/data"
}</pre>
<p>For high-availability or heavy usage environments, consider using <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=consul">consul</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/dynamodb/">dynamodb</a></span><sup><small>AUR</small></sup>, or other supported storage solutions that offer scalability and reliability.
</p>
<h4><span class="mw-headline" id="Listener_configuration">Listener configuration</span></h4>
<p>Vault listens on a TCP port for API requests. For basic configurations without TLS, use:
</p>
<pre>listener "tcp" {
    address     = "127.0.0.1:8200"
    tls_disable = "true"
}</pre>
<p>If TLS is required for secure communication, configure it as follows:
</p>
<pre>listener "tcp" {
    address     = "127.0.0.1:8200"
    tls_disable = "false"
    tls_cert_file = "/etc/vault/vault-cert.pem"
    tls_key_file  = "/etc/vault/vault-key.pem"
}</pre>
<h4><span class="mw-headline" id="UI_configuration">UI configuration</span></h4>
<p>To enable the Vault web interface, add:
</p>
<pre>ui = true
</pre>
<h4><span class="mw-headline" id="API_and_cluster_addresses">API and cluster addresses</span></h4>
<p>Set the API and cluster addresses for proper networking:
</p>
<pre>api_addr = "http://127.0.0.1:8200"
cluster_addr = "http://127.0.0.1:8201"}}
</pre>
<p>If using TLS:
</p>
<pre>api_addr = "https://127.0.0.1:8200"
cluster_addr = "https://127.0.0.1:8201"
</pre>
<h4><span class="mw-headline" id="Security_considerations">Security considerations</span></h4>
<p>By default, Vault locks memory to prevent sensitive data from being swapped to disk. This enhances security by ensuring that secrets do not end up in the swap space, where they could be accessed by unauthorized users or forensic tools.
</p>
<p>However, using <i>mlock</i> requires ensuring that the system has sufficient memory and allows unlimited memory locking. If the system lacks adequate RAM or has restrictive memory limits, enabling mlock could cause Vault to fail unexpectedly. To safely use mlock, ensure:
</p>
<ul>
<li>The system has enough free RAM to accommodate Vaultâ€™s memory usage.</li>
<li>The systemd service is configured with:</li>
</ul>
<pre>AmbientCapabilities=CAP_IPC_LOCK
LimitMEMLOCK=infinity
</pre>
<p>If your system does not meet these requirements, you may need to disable <code>mlock</code>. To do so (not recommended for production environments):
</p>
<pre>disable_mlock = true
</pre>
<h4><span class="mw-headline" id="Audit_logging_configuration">Audit logging configuration</span></h4>
<p>Vault uses audit devices to log client requests and responses for security and troubleshooting purposes. The audit logs help track access patterns, detect anomalies, and ensure compliance.
</p>
<h5><span class="mw-headline" id="Configuring_a_file-based_audit_log">Configuring a file-based audit log</span></h5>
<p>To enable a file-based audit log, configure an audit device in Vault:
</p>
<pre>audit_device "file" {
    path   = "/var/log/vault-audit.log"
    format = "json"
}</pre>
<p>This will log audit events to <code>/var/log/vault-audit.log</code> in JSON format, making it easier to parse and analyze.
</p>
<p>To ensure Vault can write to the audit log securely, set the correct permissions:
</p>
<pre># touch /var/log/vault-audit.log
# chown vault:vault /var/log/vault-audit.log
# chmod 640 /var/log/vault-audit.log
</pre>
<h5><span class="mw-headline" id="Other_audit_devices">Other audit devices</span></h5>
<p>Vault supports multiple audit logging backends besides files, For a full list of supported audit devices and advanced configuration options, refer to the <a rel="nofollow" class="external text" href="https://developer.hashicorp.com/vault/docs/audit">official documentation</a>.
</p>
<h4><span class="mw-headline" id="Logging_configuration">Logging configuration</span></h4>
<p>Vault provides logging capabilities to help monitor its operations, troubleshoot issues, and analyze system behavior. By default, logs are sent to stdout, but they can also be written to a file.
</p>
<p>To configure Vault to log to a file, specify the log file path and log level in the configuration:
</p>
<pre>log_file = "/var/log/vault.log"
log_level = "info"
</pre>
<p>To ensure Vault can write logs properly, adjust file permissions:
</p>
<pre># touch /var/log/vault.log
# chown vault:vault /var/log/vault.log
# chmod 640 /var/log/vault.log
</pre>
<h4><span class="mw-headline" id="Example_configuration">Example configuration</span></h4>
<p>Below is a complete example combining the above settings:
</p>
<pre>storage "file" {
    path = "/opt/vault/data"
}

listener "tcp" {
    address     = "127.0.0.1:8200"
    tls_disable = "true"
}

ui = true

api_addr = "http://127.0.0.1:8200"
cluster_addr = "http://127.0.0.1:8201"

disable_mlock = true

audit_device "file" {
    path   = "/var/log/vault-audit.log"
    format = "json"
}

log_file = "/var/log/vault.log"
log_level = "info"</pre>
<p>If using TLS:
</p>
<pre>storage "file" {
    path = "/opt/vault/data"
}

listener "tcp" {
    address     = "127.0.0.1:8200"
    tls_disable = "false"
    tls_cert_file = "/etc/vault/vault-cert.pem"
    tls_key_file  = "/etc/vault/vault-key.pem"
}

ui = true

api_addr = "https://127.0.0.1:8200"
cluster_addr = "https://127.0.0.1:8201"

disable_mlock = true

audit_device "file" {
    path   = "/var/log/vault-audit.log"
    format = "json"
}

log_file = "/var/log/vault.log"
log_level = "info"</pre>
<h3><span class="mw-headline" id="Creating_the_storage_directory">Creating the storage directory</span></h3>
<pre># mkdir -p /opt/vault/data
# chown -R vault:vault /opt/vault
</pre>
<h3><span class="mw-headline" id="Running_Vault_as_a_systemd_service">Running Vault as a systemd service</span></h3>
<p>Optionally, Vault can be run as a <a href="../en/Systemd.html" title="Systemd">systemd</a> service to ensure it starts automatically at boot, restarts upon failure, and integrates well with process management on Linux. This approach is particularly useful in production environments where Vault needs to remain available without manual intervention.
</p>
<h4><span class="mw-headline" id="Creating_the_systemd_service_file">Creating the systemd service file</span></h4>
<p>Create a unit file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/vault.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=HashiCorp Vault - A secrets management solution
After=network.target

[Service]
User=vault
Group=vault
ProtectSystem=full
ProtectHome=true
PrivateTmp=true
PrivateDevices=true
SecureBits=keep-caps
AmbientCapabilities=CAP_IPC_LOCK
LimitMEMLOCK=infinity
NoNewPrivileges=yes
ExecStart=/usr/bin/vault server -config=/etc/vault/config.hcl
ExecReload=/bin/kill -HUP $MAINPID
KillMode=process
KillSignal=SIGINT
Restart=on-failure
RestartSec=5
TimeoutStopSec=30
ProtectKernelModules=yes
ProtectControlGroups=yes
ReadOnlyPaths=/etc/vault
SystemCallFilter=@system-service
SystemCallFilter=~@privileged

[Install]
WantedBy=multi-user.target</pre>
<p><br>
Next, <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable/start">enable/start</a> the <code>vault.service</code>.
</p>
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
<h3><span class="mw-headline" id="Setting_environment_variables">Setting environment variables</span></h3>
<p>Set the environment variable to specify the Vault address. This ensures that Vault commands interact with the correct server instance without requiring the address to be manually specified each time.
</p>
<pre>$ export VAULT_ADDR='http://127.0.0.1:8200'
</pre>
<p>To make this persistent across reboots:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/environment</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">VAULT_ADDR='http://127.0.0.1:8200'</pre>
<h3><span class="mw-headline" id="Initializing_vault">Initializing vault</span></h3>
<p>Vault encrypts and protects secrets, requiring an "unsealing" process to decrypt and access them after a restart. When initialized, Vault generates multiple unseal keys, and a minimum threshold of these keys is needed to unseal the Vault. This ensures that no single person has full access, adding an extra layer of security.
</p>
<p>To initialize Vault, run:
</p>
<pre>$ vault operator init
</pre>
<p>This will output 5 unseal keys and an initial root token. Save these securely!
</p>
<h3><span class="mw-headline" id="Unseal_the_vault_and_login">Unseal the vault and login</span></h3>
<h4><span class="mw-headline" id="Automatic_unsealing">Automatic unsealing</span></h4>
<p>Vault can be configured to auto-unseal using cloud-based KMS services (such as AWS KMS, GCP KMS) or hardware security modules (HSMs). This eliminates the need for manual key entry upon startup. For more info refer to the <a rel="nofollow" class="external text" href="https://www.vaultproject.io/docs/concepts/seal#auto-unseal">official Vault auto-unseal documentation</a>.
</p>
<h4><span class="mw-headline" id="Manual_unsealing">Manual unsealing</span></h4>
<p>For manual unsealing, Vault must be unsealed with at least three different keys:
</p>
<pre>$ vault operator unseal &lt;unseal-key-1&gt;
$ vault operator unseal &lt;unseal-key-2&gt;
$ vault operator unseal &lt;unseal-key-3&gt;
</pre>
<h4><span class="mw-headline" id="Login_to_the_vault">Login to the vault</span></h4>
<pre>$ vault login &lt;root-token&gt;
</pre>
<h3><span class="mw-headline" id="Accessing_the_UI">Accessing the UI</span></h3>
<p>Open http://127.0.0.1:8200 in your browser.
</p>
<p>You will see a login screen where you can use your root token to access the Vault UI.
</p>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Encryption.html" title="Category:Encryption">Encryption</a></li>
<li><a href="../en/Category:Networking.html" title="Category:Networking">Networking</a></li>
</ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Vault&amp;oldid=833201">https://wiki.archlinux.org/index.php?title=Vault&amp;oldid=833201</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 2 May 2025, at 15:40.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki.svg" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul></ul>
</div>
</body>
</html>
