<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>MEncoder - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.43.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-MEncoder rootpage-MEncoder skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Basics" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Basics">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Basics</span>
			</div>
		</a>
		
		<ul id="toc-Basics-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Example" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Example">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Example</span>
			</div>
		</a>
		
			<button aria-controls="toc-Example-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Example subsection</span>
			</button>
		
		<ul id="toc-Example-sublist" class="vector-toc-list">
			<li id="toc-Ripping_and_encoding_the_video" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Ripping_and_encoding_the_video">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1</span>
					<span>Ripping and encoding the video</span>
				</div>
			</a>
			
			<ul id="toc-Ripping_and_encoding_the_video-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Ripping_and_encoding_the_audio" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Ripping_and_encoding_the_audio">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2</span>
					<span>Ripping and encoding the audio</span>
				</div>
			</a>
			
			<ul id="toc-Ripping_and_encoding_the_audio-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Making_the_final_.mkv_file" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Making_the_final_.mkv_file">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.3</span>
					<span>Making the final .mkv file</span>
				</div>
			</a>
			
			<ul id="toc-Making_the_final_.mkv_file-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Encoding_video_mp4_for_Nokia_5800_XM_and_Nokia_N97" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Encoding_video_mp4_for_Nokia_5800_XM_and_Nokia_N97">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.4</span>
					<span>Encoding video mp4 for Nokia 5800 XM and Nokia N97</span>
				</div>
			</a>
			
			<ul id="toc-Encoding_video_mp4_for_Nokia_5800_XM_and_Nokia_N97-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Encoding_a_multi_audio_/_multi_language_MKV_video_to_an_MP4_with_different_audio_streams" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Encoding_a_multi_audio_/_multi_language_MKV_video_to_an_MP4_with_different_audio_streams">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.5</span>
					<span>Encoding a multi audio / multi language MKV video to an MP4 with different audio streams</span>
				</div>
			</a>
			
			<ul id="toc-Encoding_a_multi_audio_/_multi_language_MKV_video_to_an_MP4_with_different_audio_streams-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Adding_SubRip_subtitles_to_a_file" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Adding_SubRip_subtitles_to_a_file">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.6</span>
					<span>Adding SubRip subtitles to a file</span>
				</div>
			</a>
			
			<ul id="toc-Adding_SubRip_subtitles_to_a_file-sublist" class="vector-toc-list">
				<li id="toc-Two-pass_x264_(very_high-quality)" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Two-pass_x264_(very_high-quality)">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.6.1</span>
					<span>Two-pass x264 (very high-quality)</span>
				</div>
			</a>
			
			<ul id="toc-Two-pass_x264_(very_high-quality)-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Single-pass_x264_(very_high-quality)" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Single-pass_x264_(very_high-quality)">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.6.2</span>
					<span>Single-pass x264 (very high-quality)</span>
				</div>
			</a>
			
			<ul id="toc-Single-pass_x264_(very_high-quality)-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Two-pass_xvid_(very_high-quality)" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Two-pass_xvid_(very_high-quality)">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.6.3</span>
					<span>Two-pass xvid (very high-quality)</span>
				</div>
			</a>
			
			<ul id="toc-Two-pass_xvid_(very_high-quality)-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Three-pass_lavc_(very_high-quality_mpeg4)" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Three-pass_lavc_(very_high-quality_mpeg4)">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.6.4</span>
					<span>Three-pass lavc (very high-quality mpeg4)</span>
				</div>
			</a>
			
			<ul id="toc-Three-pass_lavc_(very_high-quality_mpeg4)-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Single-pass_lavc_(very_high-quality_mpeg-2)" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Single-pass_lavc_(very_high-quality_mpeg-2)">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.6.5</span>
					<span>Single-pass lavc (very high-quality mpeg-2)</span>
				</div>
			</a>
			
			<ul id="toc-Single-pass_lavc_(very_high-quality_mpeg-2)-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Adding_VOBsub_subtitles_to_a_file" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Adding_VOBsub_subtitles_to_a_file">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.7</span>
					<span>Adding VOBsub subtitles to a file</span>
				</div>
			</a>
			
			<ul id="toc-Adding_VOBsub_subtitles_to_a_file-sublist" class="vector-toc-list">
				<li id="toc-Two-pass_x264_(very_high-quality)_2" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Two-pass_x264_(very_high-quality)_2">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.7.1</span>
					<span>Two-pass x264 (very high-quality)</span>
				</div>
			</a>
			
			<ul id="toc-Two-pass_x264_(very_high-quality)_2-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Testing_subtitle_muxing_results" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Testing_subtitle_muxing_results">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.7.2</span>
					<span>Testing subtitle muxing results</span>
				</div>
			</a>
			
			<ul id="toc-Testing_subtitle_muxing_results-sublist" class="vector-toc-list">
				<li id="toc-Single-pass_x264_(low_quality)" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Single-pass_x264_(low_quality)">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.7.2.1</span>
					<span>Single-pass x264 (low quality)</span>
				</div>
			</a>
			
			<ul id="toc-Single-pass_x264_(low_quality)-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
		</li>
		<li id="toc-mp2_vs._mp3lame_vs._aac" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#mp2_vs._mp3lame_vs._aac">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.8</span>
					<span>mp2 vs. mp3lame vs. aac</span>
				</div>
			</a>
			
			<ul id="toc-mp2_vs._mp3lame_vs._aac-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Encoding_AVI_videos_in_Windows_and_Mac_readable_formats" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Encoding_AVI_videos_in_Windows_and_Mac_readable_formats">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.9</span>
					<span>Encoding AVI videos in Windows and Mac readable formats</span>
				</div>
			</a>
			
			<ul id="toc-Encoding_AVI_videos_in_Windows_and_Mac_readable_formats-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-GUI_frontends" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#GUI_frontends">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>GUI frontends</span>
			</div>
		</a>
		
		<ul id="toc-GUI_frontends-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">MEncoder</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 1 language">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-1" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">1 language</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/MEncoder" title="MEncoder – 日本語" lang="ja" hreflang="ja" data-title="MEncoder" data-language-autonym="日本語" data-language-local-name="日本語" class="interlanguage-link-target"><span>日本語</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/Optical_disc_drive.html#DVD-Video" class="mw-redirect" title="DVD Ripping">DVD Ripping</a></li>
<li><a href="../en/MPlayer.html" title="MPlayer">MPlayer</a></li>
<li><a href="../en/Convert_any_Movie_to_DVD_Video.html#Video2dvdiso" class="mw-redirect" title="Video2dvdiso">Video2dvdiso</a></li>
</ul>
</div>
<p>An overview of <a href="https://en.wikipedia.org/wiki/MEncoder" class="extiw" title="wikipedia:MEncoder">MEncoder</a>, the video encoding/decoding tool provided by <a href="../en/MPlayer.html" title="MPlayer">MPlayer</a> as part of the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mencoder">mencoder</a></span> package.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Basics">Basics</span></h2>
<p>The basic syntax for a conversion is
</p>
<pre>mencoder original_video.mpg -o new_video.avi -ovc output_video_codec -oac output_audio_codec</pre>
<p>So to convert movie.mpg to movie.avi with MPEG-4 Part 2 video and MP2 audio, the command is
</p>
<pre>mencoder movie.mpg -o movie.avi -ovc lavc -oac lavc</pre>
<p>The default output formats without any options are MPEG-4 for video and MP2 for audio.
</p>
<p>This is basically how one converts a video. However, there are MANY more options available.
</p>
<p>For input formats, MEncoder can use any format that MPlayer can play, so to verify whether it will work with your video, just try playing it in MPlayer.
</p>
<p>To list <u>o</u>utput <u>v</u>ideo <u>c</u>odecs, run
</p>
<pre>$ mencoder -ovc help
</pre>
<p>Similarly, to list <u>o</u>utput <u>a</u>udio <u>c</u>odecs, run
</p>
<pre>$ mencoder -oac help
</pre>
<p>This information can also be found <a rel="nofollow" class="external text" href="http://www.mplayerhq.hu/DOCS/HTML/en/menc-feat-selecting-codec.html">here</a> where it better explained, although non-specific.
</p>
<h2><span class="mw-headline" id="Example">Example</span></h2>
<p>This approach allows one to make a .mkv file with an <a href="https://en.wikipedia.org/wiki/H.264/MPEG-4_AVC" class="extiw" title="wikipedia:H.264/MPEG-4 AVC">H.264</a>-encoded video and any number of Vorbis-encoded audio tracks.
</p>
<p>We will use <b>mencoder</b> (part of <b>mplayer</b> package) for ripping and encoding and <b>mkvmerge</b> (part of <b>mkvtoolnix</b> package) for making the .mkv file itself.
</p>
<h3><span class="mw-headline" id="Ripping_and_encoding_the_video">Ripping and encoding the video</span></h3>
<p>The H.264 encoder is usually used in two passes: the first reads information about the movie, the second uses that information to encode. We will not extract any audio for now.
</p>
<p>Commands follow; remember to replace the variables with the proper values:
</p>
<pre># First pass: we are just collecting information, so the normal output is thrown away.
mencoder -dvd-device "$ISO" dvd://"$TITLE" -chapter "$CHAPTER" -o /dev/null -nosound -ovc x264 \
-x264encopts direct=auto:pass=1:turbo:bitrate=900:bframes=1:\
me=umh:partitions=all:trellis=1:qp_step=4:qcomp=0.7:direct_pred=auto:keyint=300 \
-vf scale=-1:-10,harddup
</pre>
<pre># Second pass: here we compress the video track using the information from the first step.
mencoder -dvd-device "$ISO" dvd://"$TITLE" -chapter "$CHAPTER" -nosound -ovc x264 \
-x264encopts direct=auto:pass=2:bitrate=900:frameref=5:bframes=1:\
me=umh:partitions=all:trellis=1:qp_step=4:qcomp=0.7:direct_pred=auto:keyint=300 \
-vf scale=-1:-10,harddup -o video.avi
</pre>
<p>This will create a <b>video.avi</b> file containing the video. You can play with the <b>-x264encopts</b> options and the <b>-vf</b> filters to improve the quality or reduce the file size. For example, a movie with a black border should be cropped with <b>-vf crop=$X:$Y,scale=-1:-10,harddup</b> with the proper values instead of <b>$X</b> and <b>$Y</b> (see <b>cropdetect</b> in the MEncoder manual). You may want to scale down the movie with <b>-vf scale=$WIDTH:-10,harddup</b> the width of the movie will become <b>$WIDTH</b> (keep <b>$WIDTH</b> a multiple of 16: 640, 480, or 320 are usually fine), the height will be correctly calculated in order to keep the aspect ratio.
</p>
<p>You can also use any other of the filters MEncoder has to offer, like <b>pullup,softskip</b> or you can change the frame rate using <b>-ofps</b>. (If you do so, remember to use the same frame rate everywhere including in the commands to rip audio.)
</p>
<p>It is important that you use <b>harddup</b> as the last filter: it will force MEncoder to write every frame (even duplicate ones) in the output. Also, it is necessary to use <b>scale=$WIDTH,-10</b> with <b>$WIDTH</b> as <b>-1</b> to keep the original width or a new, usually smaller, width: it is necessary since the H.264 codec uses square pixels and DVDs instead use rectangular pixels.
</p>
<h3><span class="mw-headline" id="Ripping_and_encoding_the_audio">Ripping and encoding the audio</span></h3>
<p>You can extract audio tracks as needed. Here we compress with the Vorbis algorithm, but you may want to check the MEncoder manual
in order to see alternatives.
</p>
<p>The command follows (replace the variables with desired values):
</p>
<pre># Here we rip and compress the audio.
mencoder -dvd-device "$ISO" dvd://"$TITLE" -alang "$AUDIOLANG" -chapter "$CHAPTER" -ovc frameno \
-oac lavc -lavcopts acodec=vorbis:abitrate=224 -channels 2 -srate 48000 -o "$AUDIOLANG".avi
</pre>
<p>You should repeat the command for every audio track you want, so we will have .avi files with the audio track.
</p>
<p>You may also want to use <b>-channels 6</b> to exact all the channels of a 5.1 DVD or changing the bit rate. As with the video, you can use audio filters via <b>-af</b> but it is not necessary.
</p>
<h3><span class="mw-headline" id="Making_the_final_.mkv_file">Making the final .mkv file</span></h3>
<p>Putting it all together in a single file is simple. Add other audio tracks if needed:
</p>
<pre>mkvmerge -D audio.avi -A video.avi -o mymovie.mkv
</pre>
<p>The <b>.mkv</b> file will contain everything, so you can store your movie keeping all the audio track you want. Even if you are not interested in keeping multiple sound tracks, the H.264/Vorbis format pair should ensure great quality.
</p>
<h3><span class="mw-headline" id="Encoding_video_mp4_for_Nokia_5800_XM_and_Nokia_N97">Encoding video mp4 for Nokia 5800 XM and Nokia N97</span></h3>
<p>In <b>2 pass</b>es with small bitrates (640kbps video vbitrate and 96kbps audio abitrate) yields pretty watchable video mp4 for nokia 5800 xm and Nokia N97 phones' default video player. Let us assume that we have a video.avi file (replace video.avi with your video file)
</p>
<p><b>mkv to mp4 (nokia 97, 5800 compatible)</b>
</p>
<pre><b># step 1:</b> convert the mkv to mpg ; many mkv files do not directly get converted to mp4
mencoder "$1" -ovc lavc -lavcopts vcodec=mpeg1video -aid 0 -oac pcm -o delete_me.mpg
<b># step 2:</b> convert the mpg file to mp4
mencoder -of lavf -lavfopts format=mp4 -oac lavc -ovc lavc -lavcopts \
aglobal=1:vglobal=1:acodec=libfaac:vcodec=mpeg4:abitrate=128:vbitrate=640:keyint=250:mbd=1:vqmax=10:lmax=10:turbo  -af lavcresample=44100 \
-vf harddup,scale=640:-3 "delete_me.mpg" -o "$1.mp4"
<b># step 3:</b> delete the temporary huge sized mpg file 
rm "delete_me.mpg"
</pre>
<p>replace "$1" with the .mkv video filename. e.g., sample.mkv; here -aid 0 = first audio track in mkv; 
</p>
<p><b>Converting an avi to mp4 (nokia 97, 5800 compatible) using multipass (2 passes)</b>
</p>
<pre># First pass:
mencoder -of lavf -lavfopts <b>format=mp4</b> -oac lavc -ovc lavc -lavcopts \
aglobal=1:vglobal=1:<b>acodec=libfaac:vcodec=mpeg4:abitrate=96:vbitrate=640</b>:keyint=250:mbd=1:vqmax=10:lmax=10:vpass=1:turbo  -af lavcresample=44100 \
-vf harddup,<b>scale=640:-3</b> "video.avi" -o "video.mp4"
</pre>
<pre># Second pass:
mencoder -of lavf -lavfopts <b>format=mp4</b> -oac lavc -ovc lavc -lavcopts \
aglobal=1:vglobal=1:<b>acodec=libfaac:vcodec=mpeg4:abitrate=96:vbitrate=640</b>:keyint=250:mbd=1:vqmax=10:lmax=10:vpass=2 -af lavcresample=44100 \
-vf harddup,scale=640:-3 "video.avi" -o "video.mp4"
</pre>
<p>After the 2nd pass is done, copy the video.mp4 to nokia 5800 xm or n97's memory card and open the file using file manager of nokia after removing the device from the computer.
</p>
<p>we need to run the above two commands in the folder where video.avi is present. play around with abitrate, vbitrate, and scale values to get video quality and size of your liking. alternate <b>formatfactory</b> is a mencoder gpl application for windows which <b>runs in wine</b>, can also <b>convert all-to-mp4</b>.
</p>
<p><b>scale=640:-3</b> will try to keep the video width to 640 and resize the video height accordingly. Do use the "original" aspect in nokia's mp4 player "option-&gt;aspect" for 16:9 and 4:3 aspect ratio videos.
</p>
<h3>
<span id="Encoding_a_multi_audio_.2F_multi_language_MKV_video_to_an_MP4_with_different_audio_streams"></span><span class="mw-headline" id="Encoding_a_multi_audio_/_multi_language_MKV_video_to_an_MP4_with_different_audio_streams">Encoding a multi audio / multi language MKV video to an MP4 with different audio streams</span>
</h3>
<p>to encode multi-audio file to mp4 we need to use the "-aid &lt;audio stream number&gt;" like -map 0:1 in ffmpeg) 
</p>
<p>1. To extract video+audio stream1 (usually english) of mkv file:
</p>
<pre>mencoder -oac copy -ovc copy <b>-aid 0</b> sample.mkv -o sample.mp4 
</pre>
<p>2. To extract video+audio stream2 (usually non-english, like Hindi, French, etc.) of mkv file:
</p>
<pre>mencoder -oac copy -ovc copy <b>-aid 1</b> sample.mkv -o sample.mp4
</pre>
<h3><span class="mw-headline" id="Adding_SubRip_subtitles_to_a_file">Adding SubRip subtitles to a file</span></h3>
<p>The following output video codec (-ovc) options are suggested as very high-quality settings and should suffice for most transcodings, including the additon of subtitles to a stream.
</p>
<h4>
<span id="Two-pass_x264_.28very_high-quality.29"></span><span class="mw-headline" id="Two-pass_x264_(very_high-quality)">Two-pass <a rel="nofollow" class="external text" href="https://www.videolan.org/developers/x264.html">x264</a> (<a rel="nofollow" class="external text" href="http://www.mplayerhq.hu/DOCS/HTML/en/menc-feat-x264.html">very high-quality</a>)</span>
</h4>
<pre>mencoder original_video.avi -oac copy -ovc x264 -x264encopts pass=1:preset=veryslow:fast_pskip=0:tune=film:frameref=15:bitrate=3000:threads=auto -sub original_video.srt -subfont-text-scale 3 -o /dev/null
mencoder original_video.avi -oac copy -ovc x264 -x264encopts pass=2:preset=veryslow:fast_pskip=0:tune=film:frameref=15:bitrate=3000:threads=auto -sub original_video.srt -subfont-text-scale 3 -o output_video.avi</pre>
<ul>
<li>
<code>fast_pskip</code>=<code>0</code> is a maximum quality <code>placebo</code> preset option.</li>
<li>
<code>frameref</code> is the only other major option undefined by <code>preset</code> settings.</li>
<li>
<code>bitrate</code> values can be modified to suit desired file size and quality needs.</li>
<li>
<code>tune</code> should be set to match the type and content of the of media being encoded.</li>
</ul>
<h4>
<span id="Single-pass_x264_.28very_high-quality.29"></span><span class="mw-headline" id="Single-pass_x264_(very_high-quality)">Single-pass x264 (very high-quality)</span>
</h4>
<pre>mencoder original_video.avi -oac copy -ovc x264 -x264encopts preset=veryslow:tune=film:crf=15:frameref=15:fast_pskip=0:threads=auto -sub original_video.srt -subfont-text-scale 3 -o output_video.avi</pre>
<ul><li>The following example uses the option <code>-of lavf</code> to mux the output into a <a href="https://en.wikipedia.org/wiki/Matroska" class="extiw" title="wikipedia:Matroska">Matroska</a> container which is autodetected from the output file extension <code>.mkv</code>
</li></ul>
<pre>mencoder original_video.avi -oac copy -of lavf -ovc x264 -x264encopts preset=veryslow:tune=film:crf=15:frameref=15:fast_pskip=0:global_header:threads=auto -sub original_video.srt -subfont-text-scale 3 -o output_video.mkv</pre>
<ul><li>
<code>global_header</code> writes global video headers to extradata, or in front of keyframes and is typically required for .mp4 and .mkv containers.</li></ul>
<h4>
<span id="Two-pass_xvid_.28very_high-quality.29"></span><span class="mw-headline" id="Two-pass_xvid_(very_high-quality)">Two-pass <a rel="nofollow" class="external text" href="http://www.xvid.org/">xvid</a> (<a rel="nofollow" class="external text" href="http://www.mplayerhq.hu/DOCS/HTML/en/menc-feat-xvid.html">very high-quality</a>)</span>
</h4>
<pre>mencoder original_video.avi -oac copy -ovc xvid -xvidencopts pass=1:chroma_opt:vhq=4:max_bframes=1:quant_type=mpeg:threads=6 -sub original_video.srt -subfont-text-scale 3 -o /dev/null
mencoder original_video.avi -oac copy -ovc xvid -xvidencopts pass=2:chroma_opt:vhq=4:max_bframes=1:quant_type=mpeg:bitrate=3000:threads=6 -sub original_video.srt -subfont-text-scale 3 -o output_video.avi</pre>
<ul>
<li>
<code>threads</code>=<code>n</code> where n = physical, or CPU cores.</li>
<li>Recent versions of mencoder enable <code>bvhq</code>=<code>1</code> as a default setting.</li>
<li>Xvid does not accept <code>bitrate</code> settings on the first of multiple-pass encodings.</li>
<li>
<code>subfont-text-scale 2-3</code> helps with proper sizing with 16:9 format screens.</li>
<li>
<code>max_bframes</code>=<code>0</code> can be set so long as the bitrate is high enough.</li>
</ul>
<h4>
<span id="Three-pass_lavc_.28very_high-quality_mpeg4.29"></span><span class="mw-headline" id="Three-pass_lavc_(very_high-quality_mpeg4)">Three-pass <a href="https://en.wikipedia.org/wiki/Libavcodec" class="extiw" title="wikipedia:Libavcodec">lavc</a> (<a rel="nofollow" class="external text" href="http://www.mplayerhq.hu/DOCS/HTML/en/menc-feat-enc-libavcodec.html">very high-quality mpeg4</a>)</span>
</h4>
<pre>mencoder original_video.avi -oac copy -ffourcc DX50 -ovc lavc -lavcopts vpass=1:mbd=2:mv0:trell:v4mv:cbp:predia=6:dia=6:precmp=6:cmp=6:subcmp=6:preme=2:qns=2:vbitrate=3000 -sub original_video.srt -subfont-text-scale 3 -o output_video.avi
mencoder original_video.avi -oac copy -ffourcc DX50 -ovc lavc -lavcopts vpass=3:mbd=2:mv0:trell:v4mv:cbp:predia=6:dia=6:precmp=6:cmp=6:subcmp=6:preme=2:qns=2:vbitrate=3000 -sub original_video.srt -subfont-text-scale 3 -o output_video.avi
mencoder original_video.avi -oac copy -ffourcc DX50 -ovc lavc -lavcopts vpass=3:mbd=2:mv0:trell:v4mv:cbp:predia=6:dia=6:precmp=6:cmp=6:subcmp=6:preme=2:qns=2:vbitrate=3000 -sub original_video.srt -subfont-text-scale 3 -o output_video.avi</pre>
<ul>
<li>Introducing <code>threads</code>=<code>n</code>&gt;<code>1</code> for <code>-vcodec mpeg4</code> may skew the effects of <a href="https://en.wikipedia.org/wiki/Motion_estimation" class="extiw" title="wikipedia:Motion estimation">motion estimation</a> and lead to <a rel="nofollow" class="external text" href="https://ffmpeg.org/faq.html#SEC16">reduced video quality</a> and compression efficiency.</li>
<li>
<code>predia</code>=<code>6</code>:<code>dia</code>=<code>6</code>:<code>precmp</code>=<code>6</code>:<code>cmp</code>=<code>6</code>:<code>subcmp</code>=<code>6</code> to <code>predia</code>=<code>3</code>:<code>dia</code>=<code>3</code>:<code>precmp</code>=<code>3</code>:<code>cmp</code>=<code>3</code>:<code>subcmp</code>=<code>3</code> can reduce encoding times without incurring much loss in quality.</li>
<li>
<code>vmax_b_frames</code> not included as referenced in the official mencoder documentation as the current default setting is to not to use <a href="https://en.wikipedia.org/wiki/Video_compression_picture_types" class="extiw" title="wikipedia:Video compression picture types">B-frames</a> at all.</li>
<li>
<code>vb_strategy</code> not included as referenced in the official mencoder documentation for the same reason as above. Else <code>vb_strategy</code>=<code>2</code>.</li>
</ul>
<h4>
<span id="Single-pass_lavc_.28very_high-quality_mpeg-2.29"></span><span class="mw-headline" id="Single-pass_lavc_(very_high-quality_mpeg-2)">Single-pass <a href="https://en.wikipedia.org/wiki/Libavcodec" class="extiw" title="wikipedia:Libavcodec">lavc</a> (<a rel="nofollow" class="external text" href="http://www.mplayerhq.hu/DOCS/HTML/en/menc-feat-vcd-dvd.html">very high-quality mpeg-2</a>)</span>
</h4>
<pre>mencoder -mc 0 -noskip -oac lavc -ovc lavc -of mpeg -mpegopts format=dvd:tsaf  -vf scale=720:576,harddup -srate 48000 -af lavcresample=48000   -lavcopts vcodec=mpeg2video:vrc_buf_size=1835:vrc_maxrate=9800:vbitrate=5000:keyint=15:vstrict=0:acodec=mp2:abitrate=192:aspect=16/9  -sub-bg-alpha 100 -subpos 95 -subfont-text-scale 2.5 -subcp cp1250 -sub subFile.srt  -o outFile.mpg inFile.mkv</pre>
<ul>
<li>
<b>-mc 0 -noskip</b> to ensure A/V sync</li>
<li>
<b>aspect</b> - setting video aspect manually</li>
<li>subtitle background, subtitle encoding and subtitle scaling</li>
</ul>
<p>There are as always many options that can be set, this combination ensures that picture looks almost the same as original with slightly smaller file size
</p>
<p>(great for converting FULL HD videos so that they are playable on older devices)
</p>
<h3><span class="mw-headline" id="Adding_VOBsub_subtitles_to_a_file">Adding VOBsub subtitles to a file</span></h3>
<h4>
<span id="Two-pass_x264_.28very_high-quality.29_2"></span><span class="mw-headline" id="Two-pass_x264_(very_high-quality)_2">Two-pass x264 (very high-quality)</span>
</h4>
<ul>
<li>Direct <code>-vobsub</code> to the <code>subtitle_file</code> using the full pathname of the file without extensions (<code>.idx</code>/<code>.sub</code>).</li>
<li>Select the second subtitle ID language (<code>-vobsubid 2</code>) contained within the VOBsub files (<code>.idx</code>/<code>.sub</code>).</li>
</ul>
<pre>mencoder original_video.avi -oac copy -ovc x264 -x264encopts pass=1:preset=veryslow:fast_pskip=0:tune=film:frameref=15:bitrate=3000:threads=auto -vobsub subtitle_file -vobsubid 2 -o /dev/null
mencoder original_video.avi -oac copy -ovc x264 -x264encopts pass=2:preset=veryslow:fast_pskip=0:tune=film:frameref=15:bitrate=3000:threads=auto -vobsub subtitle_file -vobsubid 2 -o output_video.avi</pre>
<h4><span class="mw-headline" id="Testing_subtitle_muxing_results">Testing subtitle muxing results</span></h4>
<p>Avoid passing resource intensive encoding options in order to verify desired results sooner rather than later.
</p>
<h5>
<span id="Single-pass_x264_.28low_quality.29"></span><span class="mw-headline" id="Single-pass_x264_(low_quality)">Single-pass x264 (low quality)</span>
</h5>
<pre>mencoder original_video.avi -oac copy -ovc x264 -x264encopts preset=ultrafast:threads=auto -sub original_video.srt -subfont-text-scale 3 -o output_video.avi</pre>
<pre>mencoder original_video.avi -oac copy -ovc x264 -x264encopts pass=2:preset=ultrafast:threads=auto -vobsub subtitle_file -vobsubid 2 -o output_video.avi</pre>
<h3><span class="mw-headline" id="mp2_vs._mp3lame_vs._aac">mp2 vs. mp3lame vs. aac</span></h3>
<ul>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=toolame">toolame</a></span> is recommended over <a rel="nofollow" class="external text" href="https://www.ffmpeg.org/">FFmpeg</a> lavc (libavcodec) for mp2 encoding.</li>
<li>
<a rel="nofollow" class="external text" href="https://lame.sourceforge.net/">mp3lame</a> is recommended over <a rel="nofollow" class="external text" href="https://faac.sourceforge.net/">FAAC</a> (not fully developed) encoding at all bitrates.</li>
</ul>
<h3><span class="mw-headline" id="Encoding_AVI_videos_in_Windows_and_Mac_readable_formats">Encoding AVI videos in Windows and Mac readable formats</span></h3>
<p>Use these commands:
</p>
<pre>opt="vbitrate=2160000:mbd=2:keyint=132:vqblur=1.0:cmp=2:subcmp=2:dia=2:mv0:last_pred=3"

mencoder -ovc lavc -lavcopts vcodec=msmpeg4v2:vpass=1:$opt -oac mp3lame -o /dev/null input.avi
mencoder -ovc lavc -lavcopts vcodec=msmpeg4v2:vpass=2:$opt -oac mp3lame -o output.avi input.avi
</pre>
<p><code>input.avi</code> is the AVI you made using Linux utilities, and "output.avi" is the AVI you want to make which will be readable by Windows and Mac users.
</p>
<h2><span class="mw-headline" id="GUI_frontends">GUI frontends</span></h2>
<p>The official MPlayer homepage has a comprehensive list of available front-ends <a rel="nofollow" class="external text" href="http://www.mplayerhq.hu/design7/projects.html#mencoder_frontends">here</a>.
</p>
<ul><li>
<b>OGMRip</b> — An application and a set of libraries for ripping and encoding DVD into AVI, OGM, MP4, or Matroska files using a wide variety of codecs. It relies on mplayer, mencoder, ogmtools, mkvtoolnix, mp4box, oggenc, lame, and faac to perform its tasks.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://ogmrip.sourceforge.net/">https://ogmrip.sourceforge.net/</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ogmrip/">ogmrip</a></span><sup><small>AUR</small></sup>
</dd></dl>
<ul><li>
<b>Hybrid</b> — A multi platform (Linux/macOS/Windows) Qt based frontend for a bunch of other tools which can convert nearly every input to x264/Xvid/VP8 + ac3/ogg/mp3/aac/flac inside an avi/mp4/m2ts/mkv/webm container, a BluRay or an AVCHD structure.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://www.selur.de/">https://www.selur.de/</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/hybrid-encoder/">hybrid-encoder</a></span><sup><small>AUR</small></sup>
</dd></dl>
<ul><li>
<b>Hyper Video Converter</b> — A frontend for various cli videoencoder tools I have made because I wanted something, that lets me quickly convert videos from konqueror without typing 3-line-commands in the console.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://hypervideoconve.sourceforge.net/">https://hypervideoconve.sourceforge.net/</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/hypervc-qt4/">hypervc-qt4</a></span><sup><small>AUR</small></sup>
</dd></dl>
<ul><li>
<b>jmencode</b> — A simple java front-end for the free and very useful MPlayer software, for the purpose of encoding video. Initially the focus is on converting DVD into MPEG-4.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://jmencode.sourceforge.net/">https://jmencode.sourceforge.net/</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/jmencode/">jmencode</a></span><sup><small>AUR</small></sup>
</dd></dl>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Multimedia.html" title="Category:Multimedia">Multimedia</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=MEncoder&amp;oldid=813107">https://wiki.archlinux.org/index.php?title=MEncoder&amp;oldid=813107</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 29 July 2024, at 06:27.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki.svg" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul></ul>
</div>
</body>
</html>
