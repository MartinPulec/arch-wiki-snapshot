<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-os vector-sticky-header-enabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Google Authenticator - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.45.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Google_Authenticator rootpage-Google_Authenticator skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Installation</span>
			</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Configuration</span>
			</div>
		</a>
		
			<button aria-controls="toc-Configuration-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configuration subsection</span>
			</button>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
			<li id="toc-SSH" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#SSH">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1</span>
					<span>SSH</span>
				</div>
			</a>
			
			<ul id="toc-SSH-sublist" class="vector-toc-list">
				<li id="toc-Request_OTP_only_when_connecting_from_outside_your_local_network" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Request_OTP_only_when_connecting_from_outside_your_local_network">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1.1</span>
					<span>Request OTP only when connecting from outside your local network</span>
				</div>
			</a>
			
			<ul id="toc-Request_OTP_only_when_connecting_from_outside_your_local_network-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Desktop_logins" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Desktop_logins">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2</span>
					<span>Desktop logins</span>
				</div>
			</a>
			
			<ul id="toc-Desktop_logins-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Usage" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Usage">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Usage</span>
			</div>
		</a>
		
			<button aria-controls="toc-Usage-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Usage subsection</span>
			</button>
		
		<ul id="toc-Usage-sublist" class="vector-toc-list">
			<li id="toc-Generating_a_secret_key_file" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Generating_a_secret_key_file">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1</span>
					<span>Generating a secret key file</span>
				</div>
			</a>
			
			<ul id="toc-Generating_a_secret_key_file-sublist" class="vector-toc-list">
				<li id="toc-Storage_location" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Storage_location">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1.1</span>
					<span>Storage location</span>
				</div>
			</a>
			
			<ul id="toc-Storage_location-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Code_generation" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Code_generation">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2</span>
					<span>Code generation</span>
				</div>
			</a>
			
			<ul id="toc-Code_generation-sublist" class="vector-toc-list">
				<li id="toc-Mobile_phone_generators" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Mobile_phone_generators">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.1</span>
					<span>Mobile phone generators</span>
				</div>
			</a>
			
			<ul id="toc-Mobile_phone_generators-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Code_managers" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Code_managers">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.2</span>
					<span>Code managers</span>
				</div>
			</a>
			
			<ul id="toc-Code_managers-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-KeePassXC" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#KeePassXC">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.3</span>
					<span>KeePassXC</span>
				</div>
			</a>
			
			<ul id="toc-KeePassXC-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Command_line" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Command_line">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.4</span>
					<span>Command line</span>
				</div>
			</a>
			
			<ul id="toc-Command_line-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Testing" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Testing">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.3</span>
					<span>Testing</span>
				</div>
			</a>
			
			<ul id="toc-Testing-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar no-font-mode-scale">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left" title="Table of Contents">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Google Authenticator</span></h1>
							
</header>
				<div class="vector-column-end no-font-mode-scale">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/Initiative_for_Open_Authentication.html" class="mw-redirect" title="OATH">OATH</a></li>
<li><a href="../en/Pam_oath.html" title="Pam oath">pam_oath</a></li>
<li><a href="../en/Identity_management.html" title="Identity management">Identity management</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://github.com/google/google-authenticator">Google Authenticator</a> provides a two-step authentication procedure using one-time passcodes (<a href="https://en.wikipedia.org/wiki/One-time_password" class="extiw" title="wikipedia:One-time password">OTP</a>), initially standardized by the <a href="../en/Initiative_for_Open_Authentication.html" title="Initiative for Open Authentication">Initiative for Open Authentication (OATH)</a>. The authentication mechanism integrates into the Linux <a href="../en/PAM.html" title="PAM">PAM</a> system. This guide shows the installation and configuration of this mechanism.
</p>
<p>For the reverse operation (generating codes compatible with Google Authenticator under Linux) see <a href="#Code_generation">#Code generation</a> below.
</p>
<meta property="mw:PageProp/toc">
<div class="mw-heading mw-heading2"><h2 id="Installation">Installation</h2></div>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libpam-google-authenticator">libpam-google-authenticator</a></span> package, which provides the client program <span class="plainlinks archwiki-template-man" title="$ man 1 google-authenticator"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/google-authenticator.1">google-authenticator(1)</a></span> and the PAM module <code>pam_google_authenticator.so</code>. The development version is available with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/google-authenticator-libpam-git/">google-authenticator-libpam-git</a></span><sup><small>AUR</small></sup>.
</p>
<div class="mw-heading mw-heading2"><h2 id="Configuration">Configuration</h2></div>
<p>This section covers configuring the system's <a href="../en/PAM.html" title="PAM">PAM</a> to require Google Authenticator OTP authentication for SSH and, optionally, <a href="#Desktop_logins">desktop login</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> It is required to generate a <a href="#Usage">secret key file</a> for the complete configuration. Consider generating it before editing (and therefore applying) the PAM configuration.</div>
<div class="mw-heading mw-heading3"><h3 id="SSH">SSH</h3></div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning</strong> If you do all configuration via <a href="../en/Secure_Shell.html" class="mw-redirect" title="SSH">SSH</a> do not close the session before you tested that everything is working, else you may lock yourself out.</div>
<p>Usually one demands two-pass authentication only for remote login. The corresponding PAM configuration file is <code>/etc/pam.d/sshd</code>. In case you want to use Google Authenticator globally you would need to change <code>/etc/pam.d/system-auth</code>, however, in this case proceed with extreme caution to not lock yourself out.
In this guide we proceed with editing <code>/etc/pam.d/sshd</code> which is most safely (but not necessarily) done in a local session.
</p>
<p>To enter both, your unix password and your OTP, add <code>pam_google_authenticator.so</code> above the system-remote-login lines to <code>/etc/pam.d/sshd</code>:
</p>
<pre><b>auth            required        pam_google_authenticator.so</b>
auth            include         system-remote-login
account         include         system-remote-login
password        include         system-remote-login
session         include         system-remote-login
</pre>
<p>This will ask for the OTP before prompting for your Unix password. Changing the order of the two modules will reverse this order.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning</strong> Only users that have generated a secret key file (see below) will be allowed to log in using SSH.</div>
<p>To allow login with either the OTP or your Unix password use:
</p>
<pre>auth            <b>sufficient</b>      pam_google_authenticator.so
</pre>
<p>Enable keyboard interactive authentication in <code>/etc/ssh/sshd_config.d/<b>99-archlinux.conf</b></code>:
</p>
<pre>KbdInteractiveAuthentication yes
</pre>
<p>Finally, <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Reload">reload</a> <code>sshd.service</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning</strong> OpenSSH will ignore all of this if you are authenticating with a SSH-key pair and have <a href="../en/OpenSSH.html#Force_public_key_authentication" title="OpenSSH">disabled password logins</a>. However, as of OpenSSH 6.2, you can add <code>AuthenticationMethods</code> to allow both: two-factor and key-based authentication. See <a href="../en/OpenSSH.html#Two-factor_authentication_and_public_keys" title="OpenSSH">OpenSSH#Two-factor authentication and public keys</a>.</div>
<div class="mw-heading mw-heading4"><h4 id="Request_OTP_only_when_connecting_from_outside_your_local_network">Request OTP only when connecting from outside your local network</h4></div>
<p>Sometimes, we just want to enable the 2FA capability just when we connect from outside our local network.
To achieve this, create a file (e.g. <code>/etc/security/access-local.conf</code>) and add the networks where you want to be able to bypass the 2FA from:
</p>
<pre># only allow from local IP range
+ : ALL : 192.168.20.0/24
# Additional network: VPN tunnel ip range (in case you have one)
+ : ALL : 10.8.0.0/24
+ : ALL : LOCAL
- : ALL : ALL
</pre>
<p>Then edit your <code>/etc/pam.d/sshd</code> and add the line:
</p>
<pre>#%PAM-1.0
<b>auth [success=1 default=ignore] pam_access.so accessfile=/etc/security/access-local.conf</b>
auth      required  pam_google_authenticator.so
auth      include   system-remote-login
account   include   system-remote-login
password  include   system-remote-login
session   include   system-remote-login
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning</strong> success=1 only works if at least one other auth line exists after pam_google_authenticator line. If this is not the case, success must be set to done.</div>
<div class="mw-heading mw-heading3"><h3 id="Desktop_logins">Desktop logins</h3></div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning</strong> Do not log out of the session before testing the result on another console.</div>
<p>The Google Authenticator PAM plugin can also be used for console logins and with GDM. Just add the following to <code>/etc/pam.d/login</code> or the <code>/etc/pam.d/gdm-password</code> file:
</p>
<pre>auth required pam_google_authenticator.so
</pre>
<div class="mw-heading mw-heading2"><h2 id="Usage">Usage</h2></div>
<p>Every user who wants to use two-pass authentication needs to
</p>
<ul>
<li>generate a secret key file in their home folder, and</li>
<li>setup their OTP generators accordingly</li>
</ul>
<div class="mw-heading mw-heading3"><h3 id="Generating_a_secret_key_file">Generating a secret key file</h3></div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip</strong> <a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=qrencode">qrencode</a></span> to generate a scannable QR. Scan the QR with the authenticator app to automatically configure the key.</div>
<p>The <i>google-authenticator</i> generates a TOTP secret key file as follows:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ google-authenticator</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Do you want authentication tokens to be time-based (y/n) y
<i>generated_QR_code_here</i>
Your new secret key is: ZVZG5UZU4D7MY4DH
Your verification code is 269371
Your emergency scratch codes are:
  70058954
  97277505
  99684896
  56514332
  82717798

Do you want me to update your "/home/<i>username</i>/.google_authenticator" file (y/n) y

Do you want to disallow multiple uses of the same authentication
token? This restricts you to one login about every 30s, but it increases
your chances to notice or even prevent man-in-the-middle attacks (y/n) y

By default, tokens are good for 30 seconds and in order to compensate for
possible time-skew between the client and the server, we allow an extra
token before and after the current time. If you experience problems with poor
time synchronization, you can increase the window from its default
size of 1:30min to about 4min. Do you want to do so (y/n) n

If the computer that you are logging into is not hardened against brute-force
login attempts, you can enable rate-limiting for the authentication module.
By default, this limits attackers to no more than 3 login attempts every 30s.
Do you want to enable rate-limiting (y/n) y
</pre>
<p>It is recommended to <b>store the emergency scratch codes safely</b> (print them out and keep them in a safe location) as they are your only way to log in (via SSH) when you lost your mobile phone (i.e. your OTP-generator). They are also stored in <code>~/.google_authenticator</code>, so you can look them up any time as long as you are logged in.
</p>
<div class="mw-heading mw-heading4"><h4 id="Storage_location">Storage location</h4></div>
<p>If you want to change the secret key files' storage path, you can use the flag <code>--secret</code>:
</p>
<pre>$ google-authenticator --secret="/<i>path_folder</i>/<i>username</i>"
</pre>
<p>Then, do not forget to change the location path for PAM, in <code>/etc/pam.d/sshd</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pam.d/sshd</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">auth required pam_google_authenticator.so user=root secret=/<i>path_folder</i>/${USER}</pre>
<p><code>user=root</code> is used to force PAM to search the file using root user.
</p>
<p>Also, take care with the permissions of the secret key file. Indeed, the file <b>must</b> be only-readable by the owner (chmod: <code>400</code>). Here, the owner is root.
</p>
<pre>$ chown root:root /<i>path_file</i>/<i>secret_key_files</i>
$ chmod 400 /<i>path_file</i>/<i>secret_key_files</i>
</pre>
<div class="mw-heading mw-heading3"><h3 id="Code_generation">Code generation</h3></div>
<p>In the final setup step, each user has to associate the secret key file generated in their home directory with their choice of OTP-generators to serve the authentication codes. A user may set up generators on different devices for redundancy, for example  in an OTP application on a mobile phone and a separate password manager, or decide to rely on the emergency scratch codes generated earlier as backup.
</p>
<div class="mw-heading mw-heading4"><h4 id="Mobile_phone_generators">Mobile phone generators</h4></div>
<p>Install a generator application on your mobile phone (e.g.):
</p>
<ul>
<li>
<a href="https://en.wikipedia.org/wiki/FreeOTP" class="extiw" title="wikipedia:FreeOTP">FreeOTP</a> for Android (<a rel="nofollow" class="external text" href="https://f-droid.org/packages/org.fedorahosted.freeotp/">F-Droid</a>, <a rel="nofollow" class="external text" href="https://play.google.com/store/apps/details?id=org.fedorahosted.freeotp">Google Play</a>) or iOS (<a rel="nofollow" class="external text" href="https://itunes.apple.com/app/freeotp-authenticator/id872559395">App Store</a>).</li>
<li>
<b>FreeOTP+</b> for Android (<a rel="nofollow" class="external text" href="https://f-droid.org/packages/org.liberty.android.freeotpplus/">F-Droid</a>, <a rel="nofollow" class="external text" href="https://play.google.com/store/apps/details?id=org.liberty.android.freeotpplus">Google Play</a>).</li>
<li>
<b>Aegis</b> for Android (<a rel="nofollow" class="external text" href="https://f-droid.org/packages/com.beemdevelopment.aegis/">F-Droid</a>, <a rel="nofollow" class="external text" href="https://play.google.com/store/apps/details?id=com.beemdevelopment.aegis">Google Play</a>).</li>
<li>
<a href="https://en.wikipedia.org/wiki/Bitwarden" class="extiw" title="wikipedia:Bitwarden">Bitwarden</a> for Android (<a rel="nofollow" class="external text" href="https://mobileapp.bitwarden.com">F-Droid</a>, <a rel="nofollow" class="external text" href="https://play.google.com/store/apps/details?id=com.x8bit.bitwarden">Google Play</a>) or iOS (<a rel="nofollow" class="external text" href="https://apps.apple.com/app/bitwarden-password-manager/id1137397744">App Store</a>).</li>
<li>
<a href="https://en.wikipedia.org/wiki/Google_Authenticator" class="extiw" title="wikipedia:Google Authenticator">Google Authenticator</a> for Android (<a rel="nofollow" class="external text" href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2">Google Play</a>) or iOS (<a rel="nofollow" class="external text" href="https://itunes.apple.com/app/google-authenticator/id388497605">App Store</a>).</li>
</ul>
<p>In the mobile application, create a new account and either scan the QR code from the URL you were told when generating the secret key file, or enter the secret key (in the example above 'ZVZG5UZU4D7MY4DH') manually.
</p>
<p>Now you should see a new passcode token being generated every 30 seconds on your phone.
</p>
<p>If you have Google Authenticator configured with other systems, then losing your device can prevent you from being able to log in to those systems. Having additional ways to generate the codes can be helpful.
</p>
<div class="mw-heading mw-heading4"><h4 id="Code_managers">Code managers</h4></div>
<p>A script that enables the display, generation, storage and management of Google Authenticator codes is provided by <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/gashell/">gashell</a></span><sup><small>AUR</small></sup>. An alternative option is <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/auther-git/">auther-git</a></span><sup><small>AUR</small></sup>.
</p>
<div class="mw-heading mw-heading4"><h4 id="KeePassXC">KeePassXC</h4></div>
<p>GUI password manager <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=keepassxc">keepassxc</a></span> allows associating Google Authenticator codes to its entries, and then it can generate OTP codes and export its keys via QR code.
</p>
<div class="mw-heading mw-heading4"><h4 id="Command_line">Command line</h4></div>
<p>The easiest way to generate codes is with <span class="plainlinks archwiki-template-man" title="$ man 1 oathtool"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/oathtool.1">oathtool(1)</a></span>. It is available in the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=oath-toolkit">oath-toolkit</a></span> package, and can be used as follows:
</p>
<pre>$ oathtool --totp --base32 <i>secret_key</i>
</pre>
<p>On most Android systems with sufficient user access, the Google Authenticator database can be copied off the device and accessed directly, as it is an <a href="../en/SQLite.html" class="mw-redirect" title="Sqlite3">sqlite3</a> database. However, <a rel="nofollow" class="external text" href="https://gist.github.com/jbinto/8876658">at some point in July 2022</a>, the secret column on the accounts table started using encryption. If your database backup does not use this encryption, this shell script will read a Google Authenticator database and generate live codes for each key found:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">google-authenticator.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh

# This is the path to the Google Authenticator app file.  It is typically
# located in /data under Android.  Copy it to your PC in a safe location and
# specify the path to it here.
DB="/path/to/com.google.android.apps.authenticator/databases/databases"

sqlite3 "$DB" 'SELECT email,secret FROM accounts;' | while read A
do
        NAME=`echo "$A" | cut -d '|' -f 1`
        KEY=`echo "$A" | cut -d '|' -f 2`
        CODE=`oathtool --totp -b "$KEY"`
        echo -e "\e[1;32m$CODE\e[0m - \e[1;33m$NAME\e[0m"
done</pre>
<div class="mw-heading mw-heading3"><h3 id="Testing">Testing</h3></div>
<p>SSH to your host from another machine and/or from another terminal window:
</p>
<pre>$ ssh <i>hostname</i>
login as: <i>username</i>
Verification code: <i>generated/backup_code</i>
Password: <i>password</i>
$
</pre>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Authentication.html" title="Category:Authentication">Authentication</a></li>
<li><a href="../en/Category:Google.html" title="Category:Google">Google</a></li>
</ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Google_Authenticator&amp;oldid=843755">https://wiki.archlinux.org/index.php?title=Google_Authenticator&amp;oldid=843755</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 14 August 2025, at 10:45.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><picture><source media="(min-width: 500px)" srcset="/resources/assets/poweredby_mediawiki.svg" width="88" height="31"><img src="/resources/assets/mediawiki_compact.svg" width="25" height="25" loading="lazy"></picture></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-header-container vector-sticky-header-container no-font-mode-scale">
	<div id="vector-sticky-header" class="vector-sticky-header">
		<div class="vector-sticky-header-start">
			<div class="vector-sticky-header-icon-start vector-button-flush-left vector-button-flush-right" aria-hidden="true">
				<button class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-sticky-header-search-toggle" tabindex="-1" data-event-name="ui.vector-sticky-search-form.icon"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
			</button>
		</div>
			
		<div role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box">
			<div class="vector-typeahead-search-container">
				<div class="cdx-typeahead-search cdx-typeahead-search--show-thumbnail">
					<form action="/index.php" id="vector-sticky-search-form" class="cdx-search-input cdx-search-input--has-end-button">
						<div class="cdx-search-input__input-wrapper" data-search-loc="header-moved">
							<div class="cdx-text-input cdx-text-input--has-start-icon">
								<input class="cdx-text-input__input mw-searchInput" autocomplete="off" type="search" name="search" placeholder="Search ArchWiki">
								<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
							</div>
							<input type="hidden" name="title" value="Special:Search">
						</div>
						<button class="cdx-button cdx-search-input__end-button">Search</button>
					</form>
				</div>
			</div>
		</div>
		<div class="vector-sticky-header-context-bar">
				<nav aria-label="Contents" class="vector-toc-landmark">
						
					<div id="vector-sticky-header-toc" class="vector-dropdown mw-portlet mw-portlet-sticky-header-toc vector-sticky-header-toc vector-button-flush-left">
						<input type="checkbox" id="vector-sticky-header-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-sticky-header-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
						<label id="vector-sticky-header-toc-label" for="vector-sticky-header-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
						</label>
						<div class="vector-dropdown-content">
					
						<div id="vector-sticky-header-toc-unpinned-container" class="vector-unpinned-container">
						</div>
					
						</div>
					</div>
			</nav>
				<div class="vector-sticky-header-context-bar-primary" aria-hidden="true"><span class="mw-page-title-main">Google Authenticator</span></div>
			</div>
		</div>
		<div class="vector-sticky-header-end" aria-hidden="true">
			<div class="vector-sticky-header-icons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-talk-sticky-header" tabindex="-1" data-event-name="talk-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbles mw-ui-icon-wikimedia-speechBubbles"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-subject-sticky-header" tabindex="-1" data-event-name="subject-sticky-header"><span class="vector-icon mw-ui-icon-article mw-ui-icon-wikimedia-article"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-history-sticky-header" tabindex="-1" data-event-name="history-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-history mw-ui-icon-wikimedia-wikimedia-history"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only mw-watchlink" id="ca-watchstar-sticky-header" tabindex="-1" data-event-name="watch-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-star mw-ui-icon-wikimedia-wikimedia-star"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only reading-lists-bookmark" id="ca-bookmark-sticky-header" tabindex="-1" data-event-name="watch-sticky-bookmark"><span class="vector-icon mw-ui-icon-wikimedia-bookmarkOutline mw-ui-icon-wikimedia-wikimedia-bookmarkOutline"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-edit-sticky-header" tabindex="-1" data-event-name="wikitext-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-wikiText mw-ui-icon-wikimedia-wikimedia-wikiText"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-ve-edit-sticky-header" tabindex="-1" data-event-name="ve-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-edit mw-ui-icon-wikimedia-wikimedia-edit"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-viewsource-sticky-header" tabindex="-1" data-event-name="ve-edit-protected-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-editLock mw-ui-icon-wikimedia-wikimedia-editLock"></span>

<span></span>
			</a>
		</div>
			<div class="vector-sticky-header-buttons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive" id="ca-addsection-sticky-header" tabindex="-1" data-event-name="addsection-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbleAdd-progressive mw-ui-icon-wikimedia-speechBubbleAdd-progressive"></span>

<span>Add topic</span>
			</a>
		</div>
			<div class="vector-sticky-header-icon-end">
				<div class="vector-user-links">
				</div>
			</div>
		</div>
	</div>
</div>
<div class="mw-portlet mw-portlet-dock-bottom emptyPortlet" id="p-dock-bottom">
	<ul>
		
	</ul>
</div>
</body>
</html>
