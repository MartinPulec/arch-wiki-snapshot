<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Dual boot with Windows - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Dual_boot_with_Windows rootpage-Dual_boot_with_Windows skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Important_information" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Important_information">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Important information</div>
		</a>
		
			<button aria-controls="toc-Important_information-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Important information subsection</span>
			</button>
		
		<ul id="toc-Important_information-sublist" class="vector-toc-list">
			<li id="toc-Windows_UEFI_vs_BIOS_limitations" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Windows_UEFI_vs_BIOS_limitations">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1</span>Windows UEFI vs BIOS limitations</div>
			</a>
			
			<ul id="toc-Windows_UEFI_vs_BIOS_limitations-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Bootloader_UEFI_vs_BIOS_limitations" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Bootloader_UEFI_vs_BIOS_limitations">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.2</span>Bootloader UEFI vs BIOS limitations</div>
			</a>
			
			<ul id="toc-Bootloader_UEFI_vs_BIOS_limitations-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-UEFI_Secure_Boot" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#UEFI_Secure_Boot">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.3</span>UEFI Secure Boot</div>
			</a>
			
			<ul id="toc-UEFI_Secure_Boot-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Fast_Startup_and_hibernation" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Fast_Startup_and_hibernation">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.4</span>Fast Startup and hibernation</div>
			</a>
			
			<ul id="toc-Fast_Startup_and_hibernation-sublist" class="vector-toc-list">
				<li id="toc-Windows_settings" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Windows_settings">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.4.1</span>Windows settings</div>
			</a>
			
			<ul id="toc-Windows_settings-sublist" class="vector-toc-list">
				<li id="toc-Disable_Fast_Startup_and_disable_hibernation" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Disable_Fast_Startup_and_disable_hibernation">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.4.1.1</span>Disable Fast Startup and disable hibernation</div>
			</a>
			
			<ul id="toc-Disable_Fast_Startup_and_disable_hibernation-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Disable_Fast_Startup_and_enable_hibernation" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Disable_Fast_Startup_and_enable_hibernation">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.4.1.2</span>Disable Fast Startup and enable hibernation</div>
			</a>
			
			<ul id="toc-Disable_Fast_Startup_and_enable_hibernation-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Enable_Fast_Startup_and_enable_hibernation" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Enable_Fast_Startup_and_enable_hibernation">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.4.1.3</span>Enable Fast Startup and enable hibernation</div>
			</a>
			
			<ul id="toc-Enable_Fast_Startup_and_enable_hibernation-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Windows_filenames_limitations" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Windows_filenames_limitations">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.5</span>Windows filenames limitations</div>
			</a>
			
			<ul id="toc-Windows_filenames_limitations-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Installation</div>
		</a>
		
			<button aria-controls="toc-Installation-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Installation subsection</span>
			</button>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
			<li id="toc-Windows_before_Linux" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Windows_before_Linux">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Windows before Linux</div>
			</a>
			
			<ul id="toc-Windows_before_Linux-sublist" class="vector-toc-list">
				<li id="toc-BIOS_systems" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#BIOS_systems">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.1</span>BIOS systems</div>
			</a>
			
			<ul id="toc-BIOS_systems-sublist" class="vector-toc-list">
				<li id="toc-Using_a_Linux_boot_loader" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Using_a_Linux_boot_loader">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.1.1</span>Using a Linux boot loader</div>
			</a>
			
			<ul id="toc-Using_a_Linux_boot_loader-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Using_the_Windows_Vista/7/8/8.1_boot_loader" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Using_the_Windows_Vista/7/8/8.1_boot_loader">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.1.2</span>Using the Windows Vista/7/8/8.1 boot loader</div>
			</a>
			
			<ul id="toc-Using_the_Windows_Vista/7/8/8.1_boot_loader-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-UEFI_systems" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#UEFI_systems">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.2</span>UEFI systems</div>
			</a>
			
			<ul id="toc-UEFI_systems-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Linux_before_Windows" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Linux_before_Windows">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>Linux before Windows</div>
			</a>
			
			<ul id="toc-Linux_before_Windows-sublist" class="vector-toc-list">
				<li id="toc-UEFI_firmware" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#UEFI_firmware">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2.1</span>UEFI firmware</div>
			</a>
			
			<ul id="toc-UEFI_firmware-sublist" class="vector-toc-list">
				<li id="toc-Windows_10_with_GRUB" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Windows_10_with_GRUB">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2.1.1</span>Windows 10 with GRUB</div>
			</a>
			
			<ul id="toc-Windows_10_with_GRUB-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Troubleshooting">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3</span>Troubleshooting</div>
			</a>
			
			<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
				<li id="toc-Couldn't_create_a_new_partition_or_locate_an_existing_one" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Couldn't_create_a_new_partition_or_locate_an_existing_one">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.1</span>Couldn't create a new partition or locate an existing one</div>
			</a>
			
			<ul id="toc-Couldn't_create_a_new_partition_or_locate_an_existing_one-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Cannot_boot_Linux_after_installing_Windows" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Cannot_boot_Linux_after_installing_Windows">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.2</span>Cannot boot Linux after installing Windows</div>
			</a>
			
			<ul id="toc-Cannot_boot_Linux_after_installing_Windows-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Restoring_a_Windows_boot_record" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Restoring_a_Windows_boot_record">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.3</span>Restoring a Windows boot record</div>
			</a>
			
			<ul id="toc-Restoring_a_Windows_boot_record-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Restoring_an_accidentally_deleted_EFI_system_partition" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Restoring_an_accidentally_deleted_EFI_system_partition">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.4</span>Restoring an accidentally deleted EFI system partition</div>
			</a>
			
			<ul id="toc-Restoring_an_accidentally_deleted_EFI_system_partition-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-The_EFI_system_partition_created_by_Windows_Setup_is_too_small" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#The_EFI_system_partition_created_by_Windows_Setup_is_too_small">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.5</span>The EFI system partition created by Windows Setup is too small</div>
			</a>
			
			<ul id="toc-The_EFI_system_partition_created_by_Windows_Setup_is_too_small-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Unable_to_install_Windows_Cumulative_Update_on_BIOS_system" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Unable_to_install_Windows_Cumulative_Update_on_BIOS_system">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.6</span>Unable to install Windows Cumulative Update on BIOS system</div>
			</a>
			
			<ul id="toc-Unable_to_install_Windows_Cumulative_Update_on_BIOS_system-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Time_standard" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Time_standard">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Time standard</div>
		</a>
		
		<ul id="toc-Time_standard-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Bluetooth_pairing" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Bluetooth_pairing">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Bluetooth pairing</div>
		</a>
		
		<ul id="toc-Bluetooth_pairing-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Dual boot with Windows</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 4 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-4" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">4 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-fr mw-list-item"><a href="../fr/Dual_boot_with_Windows.html" title="Dual boot with Windows – français" lang="fr" hreflang="fr" class="interlanguage-link-target"><span>Français</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Windows_%E3%81%A8%E3%81%AE%E3%83%87%E3%83%A5%E3%82%A2%E3%83%AB%E3%83%96%E3%83%BC%E3%83%88" title="Windows とのデュアルブート – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-pt mw-list-item"><a href="../pt/Dual_boot_with_Windows.html" title="Dual boot with Windows – português" lang="pt" hreflang="pt" class="interlanguage-link-target"><span>Português</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/Dual_boot_with_Windows" title="Dual boot with Windows – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<p>This is an article detailing different methods of Arch/Windows coexistence.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Important_information">Important information</span></h2>
<h3><span class="mw-headline" id="Windows_UEFI_vs_BIOS_limitations">Windows UEFI vs BIOS limitations</span></h3>
<p>Microsoft imposes limitations on which firmware boot mode and partitioning style can be supported based on the version of Windows used:
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The following points only list configurations supported by the <a href="https://en.wikipedia.org/wiki/Windows_Setup" class="extiw" title="wikipedia:Windows Setup">Windows Setup</a> even though Windows itself may still work on these unsupported configurations. A good example of this is Windows 11 which still works on a BIOS/MBR configuration once the Windows Setup check is bypassed.</div>
<ul>
<li>
<b>Windows 8/8.1</b> and <b>10</b> <b>x86 32-bit</b> support booting in IA32 UEFI mode from GPT disk only, OR in BIOS mode from MBR disk only. They do not support x86_64 UEFI boot from GPT/MBR disk, x86_64 UEFI boot from MBR disk, or BIOS boot from GPT disk. On market, the only systems known to ship with IA32 (U)EFI are some old Intel Macs (pre-2010 models?) and Intel Atom System-on-Chip (Clover trail and Bay Trail) Windows Tablets, which boot ONLY in IA32 UEFI mode and ONLY from GPT disk.</li>
<li>
<b>Windows 8/8.1</b> and <b>10</b> <b>x86_64</b> versions support booting in x86_64 UEFI mode from GPT disk only, OR in BIOS mode from MBR disk only. They do not support IA32  UEFI boot, x86_64 UEFI boot from MBR disk, or BIOS boot from GPT disk.</li>
<li>
<b>Windows 11</b> only supports <b>x86_64</b> and a boot in UEFI mode from GPT disk.</li>
</ul>
<p>In case of pre-installed Systems:
</p>
<ul>
<li>All systems pre-installed with Windows XP, Vista or 7 32-bit, irrespective of Service Pack level, bitness, edition (SKU) or presence of UEFI support in firmware, boot in BIOS/MBR mode by default.</li>
<li>MOST of the systems pre-installed with Windows 7 x86_64, irrespective of Service Pack level, bitness or edition (SKU), boot in BIOS/MBR mode by default. Very few late systems pre-installed with Windows 7 are known to boot in x86_64 UEFI/GPT mode by default.</li>
<li>ALL systems pre-installed with Windows 8/8.1, 10 and 11 boot in UEFI/GPT mode. Up to Windows 10, the firmware bitness matches the bitness of Windows, ie. x86_64 Windows boot in x86_64 UEFI mode and 32-bit Windows boot in IA32 UEFI mode.</li>
</ul>
<p>An easy way to detect the boot mode of Windows is to do the following<a rel="nofollow" class="external autonumber" href="https://www.eightforums.com/tutorials/29504-bios-mode-see-if-windows-boot-uefi-legacy-mode.html">[1]</a>:
</p>
<ul>
<li>Boot into Windows</li>
<li>Press <code>Win+R</code> keys to start the Run dialog</li>
<li>In the Run dialog type <code>msinfo32</code> and press Enter</li>
<li>In the <b>System Information</b> windows, select <i>System Summary</i> on the left and check the value of <b>BIOS mode</b> item on the right</li>
<li>If the value is <code>UEFI</code>, Windows boots in UEFI/GPT mode. If the value is <code>Legacy</code>, Windows boots in BIOS/MBR mode.</li>
</ul>
<p>In general, Windows forces type of partitioning depending on the firmware mode used, i.e. if Windows is booted in UEFI mode, it can be installed only to a GPT disk. If Windows is booted in Legacy BIOS mode, it can be installed only to an MBR disk. This is a limitation enforced by Windows Setup, and as of April 2014 there is no officially (Microsoft) supported way of installing Windows in UEFI/MBR or BIOS/GPT configuration. Thus Windows only supports either UEFI/GPT boot or BIOS/MBR configuration.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> Windows 10 version 1703 and newer supports converting from BIOS/MBR to UEFI/GPT using <a rel="nofollow" class="external text" href="https://docs.microsoft.com/en-us/windows/deployment/mbr-to-gpt">MBR2GPT.EXE</a>.</div>
<p>Such a limitation is not enforced by the Linux kernel, but can depend on which <a href="../en/Arch_boot_process.html#Boot_loader" class="mw-redirect" title="Boot loader">boot loader</a> is used and/or how the boot loader is configured. The Windows limitation should be considered if the user wishes to boot Windows and Linux from the same disk, since installation procedure of boot loader depends on the firmware type and disk <a href="../en/Partitioning.html" title="Partitioning">partitioning</a> configuration. In case where Windows and Linux dual boot from the same disk, it is advisable to follow the method used by Windows, ie. either go for UEFI/GPT boot or BIOS/MBR boot. See <a rel="nofollow" class="external free" href="https://support.microsoft.com/kb/2581408">https://support.microsoft.com/kb/2581408</a> for more information.
</p>
<h3><span class="mw-headline" id="Bootloader_UEFI_vs_BIOS_limitations">Bootloader UEFI vs BIOS limitations</span></h3>
<p>Most of the linux bootloaders installed for one firmware type cannot launch or chainload bootloaders of the other firmware type. That is, if Arch is installed in UEFI/GPT or UEFI/MBR mode in one disk and Windows is installed in BIOS/MBR mode in another disk, the UEFI bootloader used by Arch cannot chainload the BIOS installed Windows in the other disk. Similarly if Arch is installed in BIOS/MBR or BIOS/GPT mode in one disk and Windows is installed in UEFI/GPT in another disk , the BIOS bootloader used by Arch cannot chainload UEFI installed Windows in the other disk.
</p>
<p>The only exceptions to this are <a href="../en/GRUB.html" title="GRUB">GRUB</a> in Apple Macs in which GRUB in UEFI mode can boot BIOS installed OS via <code>appleloader</code> command (does not work in non-Apple systems), and <a href="../en/REFInd.html" title="REFInd">rEFInd</a> which technically supports booting legacy BIOS OS from UEFI systems, but <a rel="nofollow" class="external text" href="https://rodsbooks.com/refind/using.html#legacy">does not always work in non-Apple UEFI systems</a> as per its author Rod Smith.
</p>
<p>However if Arch is installed in BIOS/GPT in one disk and Windows is installed in BIOS/MBR mode in another disk, then the BIOS boot loader used by Arch CAN boot the Windows in the other disk, if the boot loader itself has the ability to chainload from another disk.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> To dual-boot with Windows on same disk, Arch should follow the same firmware boot mode and partitioning combination used by the Windows installation.</div>
<p><a href="https://en.wikipedia.org/wiki/Windows_Setup" class="extiw" title="wikipedia:Windows Setup">Windows Setup</a> creates a 100 MiB <a href="../en/EFI_system_partition.html" title="EFI system partition">EFI system partition</a> (except for <a href="../en/Advanced_Format.html" title="Advanced Format">Advanced Format</a> 4K native drives where it creates a 300 MiB ESP), so multiple <a href="../en/Kernel.html" title="Kernel">kernel</a> usage is limited. Workarounds include:
</p>
<ul>
<li>Mount ESP to <code>/efi</code> and use a <a href="../en/Arch_boot_process.html#Boot_loader" class="mw-redirect" title="Boot loader">boot loader</a> that has file system drivers and is capable of launching kernels that reside on other partitions.</li>
<li>Reduce the size of the Windows partition and <a href="../en/EFI_system_partition.html#Replace_the_partition_with_a_larger_one" title="EFI system partition">replace the existing ESP with a new, larger one</a>.</li>
<li>Backup and delete unneeded fonts in <code><i>esp</i>/EFI/Microsoft/Boot/Fonts/</code> <a rel="nofollow" class="external autonumber" href="https://support.microsoft.com/en-us/help/3086249/we-couldn-t-update-system-reserved-partition-error-installing-windows">[2]</a>.</li>
<li>Backup and delete unneeded language directories in <code><i>esp</i>/EFI/Microsoft/Boot/</code> (e.g. to only keep <code>en-US</code>).</li>
<li>Use a higher, but slower, <a href="../en/Mkinitcpio.html#COMPRESSION" title="Mkinitcpio">compression for the initramfs images</a> making sure to decompress the loadable kernel modules and firmware. E.g.</li>
</ul>
<pre>COMPRESSION="xz"
COMPRESSION_OPTIONS=(-9e)
MODULES_DECOMPRESS="yes"
</pre>
<h3><span class="mw-headline" id="UEFI_Secure_Boot">UEFI Secure Boot</span></h3>
<p>All pre-installed Windows 8/8.1, 10 and 11 systems by default boot in UEFI/GPT mode and have UEFI Secure Boot enabled by default. This is mandated by Microsoft for all OEM pre-installed systems.
</p>
<p>Arch Linux install media does not support Secure Boot yet. See <a href="../en/Unified_Extensible_Firmware_Interface/Secure_Boot.html#Booting_an_installation_medium" class="mw-redirect" title="Secure Boot">Secure Boot#Booting an installation medium</a>.
</p>
<p>It is advisable to disable UEFI Secure Boot in the firmware setup manually before attempting to boot Arch Linux. Windows 8/8.1, 10 and 11 SHOULD continue to boot fine even if Secure boot is disabled. The only issue with regards to disabling UEFI Secure Boot support is that it requires physical access to the system to disable secure boot option in the firmware setup, as Microsoft has explicitly forbidden presence of any method to remotely or programmatically (from within OS) disable secure boot in all Windows 8/8.1 and above pre-installed systems
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>If Windows used BitLocker and stored the key in the TPM for automatic unlock on boot, it fails to boot when Secure Boot is disabled, instead showing a BitLocker recovery screen. This is not permanent however, and you can easily boot Windows again by simply re-enabling Secure Boot.</li>
<li>On Windows 11, disabling Secure Boot after install will not cause problems as long as TPM is working normally.</li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> 
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Inaccurate.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>The factual accuracy of this article or section is disputed.</b></p>
<div>
<b>Reason:</b> 
<p>Secure Boot changes should not affect BitLocker: the issue might be self-signing the windows bootloader and chain-loading it from a boot loader: as long as the Windows bootloader stays signed with MS keys, and the Microsoft certs enrolled it should be fine.
Is the issue disabling it and booting Windows or disabling, reenabling it and then booting Windows?
The first one would be understandable, the second one is something to warn about.
</p>
 (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Dual_boot_with_Windows.html">Talk:Dual boot with Windows</a>)</div>
</div>
<p>If you intend to use Secure Boot for Linux as well, you may need to perform changes to the Secure Boot settings. Those changes prevent unlocking the BitLocker disk without the recovery key, leading to <b>permanent data loss</b>. Before proceeding, check if this is the case and <a rel="nofollow" class="external text" href="https://support.microsoft.com/en-us/windows/back-up-your-bitlocker-recovery-key-e63607b4-77fb-4ad3-8022-d6dc428fbd0d">save your BitLocker recovery key</a> if not already done. This is especially important if Windows was preinstalled by the vendor.
</p>
</div>
<h3><span class="mw-headline" id="Fast_Startup_and_hibernation">Fast Startup and hibernation</span></h3>
<p>There are two OSs that can be hibernated, you can hibernate Windows and boot Linux (or another OS), or you can hibernate Linux and boot Windows, or hibernate both OSs.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Data loss can occur if Windows hibernates and you dual boot into another OS and make changes to files on a filesystem (such as NTFS) that can be read and written to by Windows and Linux, and that has been mounted by Windows <a rel="nofollow" class="external autonumber" href="https://superuser.com/questions/39532/hibernating-and-booting-into-another-os-will-my-filesystems-be-corrupted/136814#136814">[3]</a>. Similarly, data loss can occur if Linux hibernates, and you dual boot into another OS etc. Windows may hibernate even when you press shutdown, see section <a href="#Windows_settings">#Windows settings</a>.</div>
<p>For the same reason, if you share one EFI system partition between Windows and Linux, then the EFI system partition may be damaged if you hibernate (or shutdown with Fast Startup enabled) Windows and then start Linux, or hibernate Linux and then start Windows.
</p>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ntfs-3g">ntfs-3g</a></span> added a <a rel="nofollow" class="external text" href="https://sourceforge.net/p/ntfs-3g/ntfs-3g/ci/559270a8f67c77a7ce51246c23d2b2837bcff0c9/">safe-guard</a> to prevent read-write mounting of hibernated NTFS filesystems, but the NTFS driver within the Linux kernel has no such safeguard.
</p>
<p>Windows cannot read filesystems such as ext4 by default that are commonly used for Linux. These filesystems do not have to be considered, unless you install a Windows driver for them.
</p>
<h4><span class="mw-headline" id="Windows_settings">Windows settings</span></h4>
<p>Fast Startup is a feature in Windows 8 and above that hibernates the computer rather than actually shutting it down to speed up boot times.
</p>
<p>There are multiple options regarding the Windows settings for Fast Startup and hibernation that are covered in the next sections.
</p>
<ul>
<li>disable Fast Startup and disable hibernation</li>
<li>disable Fast Startup and enable hibernation</li>
<li>enable Fast Startup and enable hibernation</li>
</ul>
<p>The procedure of disabling Fast Startup is described in the tutorials for <a rel="nofollow" class="external text" href="https://www.eightforums.com/tutorials/6320-fast-startup-turn-off-windows-8-a.html">Windows 8</a>, <a rel="nofollow" class="external text" href="https://www.tenforums.com/tutorials/4189-turn-off-fast-startup-windows-10-a.html">Windows 10</a> and <a rel="nofollow" class="external text" href="https://www.elevenforum.com/t/turn-on-or-off-fast-startup-in-windows-11.1212/">Windows 11</a>. In any case if you disable a setting, make sure to disable the setting and then shut down Windows, before installing Linux; note that rebooting is not sufficient.
</p>
<h5><span class="mw-headline" id="Disable_Fast_Startup_and_disable_hibernation">Disable Fast Startup and disable hibernation</span></h5>
<p>This is the safest option, and recommended if you are unsure about the issue, as it requires the least amount of user awareness when rebooting from one OS into the other. You may share the same EFI system partition between Windows and Linux.
</p>
<p>In a Windows command-line shell with administrator privileges:
</p>
<pre>&gt; powercfg /H off
</pre>
<h5><span class="mw-headline" id="Disable_Fast_Startup_and_enable_hibernation">Disable Fast Startup and enable hibernation</span></h5>
<p>This option requires user awareness when rebooting from one OS into the other.
If you want to start Linux while Windows is hibernated, which is a common use case, then
</p>
<ul>
<li>you must use a separate EFI system partition (ESP) for Windows and Linux, and ensure that Windows does not mount the ESP used for Linux. As <b>there can only be one ESP per drive</b>, the ESP used for Linux must be located on a separate drive than the ESP used for Windows. In this case Windows and Linux can still be installed on the same drive in different partitions, if you place the ESP used by linux on another drive than the Linux root partition.</li>
<li>you can not read-write mount any filesystem in Linux, that is mounted by Windows while Windows is hibernated. You should be extremely careful about this, and also consider <a href="../en/Udisks.html" class="mw-redirect" title="Automount">Automount</a> behaviour.</li>
<li>If you shut down Windows fully, rather than hibernating, then you can read-write mount the filesystem.</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You can avoid this issue for a drive by mounting a drive as an external drive in Windows and ejecting the drive in Windows before hibernating.</div>
<h5><span class="mw-headline" id="Enable_Fast_Startup_and_enable_hibernation">Enable Fast Startup and enable hibernation</span></h5>
<p>The same considerations apply as in case "Disable Fast Startup and enable hibernation", but since Windows can not be shut down fully, only hibernated, you can never read-write mount any filesystem that was mounted by Windows while Windows is hibernated.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Windows updates may re-enable Fast Startup, as reported in <a rel="nofollow" class="external autonumber" href="https://tedstechshack.com/2017/07/03/warning-multi-booting-uefi-system-windows-10-fast-startup-doubt-reboot/">[4]</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2024-07-30 ⓘ]</sup>.</div>
<h3><span class="mw-headline" id="Windows_filenames_limitations">Windows filenames limitations</span></h3>
<p>Windows is limited to filepaths being shorter than <a rel="nofollow" class="external text" href="https://docs.microsoft.com/en-us/windows/win32/fileio/naming-a-file#maximum-path-length-limitation">260 characters</a>.
</p>
<p>Windows also puts <a rel="nofollow" class="external text" href="https://msdn.microsoft.com/en-us/library/aa365247(VS.85).aspx#naming_conventions">certain characters off limits</a> in filenames for reasons that run all the way back to DOS:
</p>
<ul>
<li>
<code>&lt;</code> (less than)</li>
<li>
<code>&gt;</code> (greater than)</li>
<li>
<code>:</code> (colon)</li>
<li>
<code>"</code> (double quote)</li>
<li>
<code>/</code> (forward slash)</li>
<li>
<code>\</code> (backslash)</li>
<li>
<code>|</code> (vertical bar or pipe)</li>
<li>
<code>?</code> (question mark)</li>
<li>
<code>*</code> (asterisk)</li>
</ul>
<p>These are limitations of Windows and not NTFS: any other OS using the NTFS partition will be fine. Windows will fail to detect these files and running <code>chkdsk</code> will most likely cause them to be deleted. This can lead to potential data-loss.
</p>
<p><a href="../en/NTFS-3G.html" title="NTFS-3G">NTFS-3G</a> applies Windows restrictions to new file names through the <code>windows_names</code> option: <span class="plainlinks archwiki-template-man" title="$ man 8 ntfs-3g"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ntfs-3g.8#Windows_Filename_Compatibility">ntfs-3g(8) § Windows_Filename_Compatibility</a></span> (see <a href="../en/Fstab.html" title="Fstab">fstab</a>).
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>The recommended way to setup a Linux/Windows dual booting system is to first install Windows, only using part of the disk for its partitions. When you have finished the Windows setup, boot into the Linux install environment where you can create and resize partitions for Linux while leaving the existing Windows partitions untouched. The Windows installation will create the <a href="../en/EFI_system_partition.html" title="EFI system partition">EFI system partition</a> which can be used by your Linux <a href="../en/Arch_boot_process.html#Boot_loader" class="mw-redirect" title="Boot loader">boot loader</a>. If you are installing Windows from scratch, do note that the EFI System partition created by Windows Setup will be too small for most use cases. See <a href="#The_EFI_system_partition_created_by_Windows_Setup_is_too_small">#The EFI system partition created by Windows Setup is too small</a>.
</p>
<h3><span class="mw-headline" id="Windows_before_Linux">Windows before Linux</span></h3>
<h4><span class="mw-headline" id="BIOS_systems">BIOS systems</span></h4>
<h5><span class="mw-headline" id="Using_a_Linux_boot_loader">Using a Linux boot loader</span></h5>
<p>You may use any multi-boot supporting BIOS <a href="../en/Arch_boot_process.html#Boot_loader" class="mw-redirect" title="Boot loader">boot loader</a>.
</p>
<h5>
<span id="Using_the_Windows_Vista.2F7.2F8.2F8.1_boot_loader"></span><span class="mw-headline" id="Using_the_Windows_Vista/7/8/8.1_boot_loader">Using the Windows Vista/7/8/8.1 boot loader</span>
</h5>
<p>This section explains how to : install a linux bootloader on a partition instead of the MBR ; copy this bootloader to a partition readable by the windows bootloader ; use the windows bootloader to start said copy of the linux bootloader.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Some documents state that the partition being loaded by the Windows boot loader must be a primary partition but usage of an extended partition has been documented as working.</div>
<ul><li>When installing the boot loader, install it on your <code>/boot</code> partition rather than the MBR. For details on doing this with GRUB, see <a href="../en/GRUB/Tips_and_tricks.html#Install_to_partition_or_partitionless_disk" title="GRUB/Tips and tricks">GRUB/Tips and tricks#Install to partition or partitionless disk</a>, for Syslinux, see the note at <a href="../en/Syslinux.html#Manually" title="Syslinux">Syslinux#Manually</a>, for LILO see <a href="../en/LILO.html#Install_to_partition_or_partitionless_disk" title="LILO">LILO#Install to partition or partitionless disk</a>.</li></ul>
<ul><li>Make a copy of the VBR: <pre>dd if=/dev/<i>disk</i> of=<i>/path/to/</i>linux.bin bs=512 count=1</pre> where <code>/dev/<i>disk</i></code> is the path of the partition on which your bootloader is installed and <code>/path/to/</code> is the mounted filesystem on which you want the copy to be readable by the Windows bootloader.</li></ul>
<ul><li>On Windows, the linux.bin file should now be accessible. Run <b>cmd</b> with administrator privileges (navigate to <i>Start &gt; All Programs &gt; Accessories</i>, right-click on <i>Command Prompt</i> and select <i>Run as administrator</i>): <pre>bcdedit /create /d "Linux" /application BOOTSECTOR</pre> BCDEdit will return a <a href="https://en.wikipedia.org/wiki/Universally_unique_identifier" class="extiw" title="wikipedia:Universally unique identifier">UUID</a> for this entry. This will be refered to as <code><i>UUID</i></code> in the remaining steps. <pre>bcdedit /set <i>UUID</i> device partition=c: (or the drive letter on which linux.bin is kept)
bcdedit /set <i>UUID</i> path <i>\path\to\</i>linux.bin
bcdedit /displayorder <i>UUID</i> /addlast
bcdedit /timeout 30</pre>
</li></ul>
<p>On reboot, both Windows and Linux should now show up in the Windows bootloader.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> On some hardware, the Windows boot loader is used to start another OS with a second power button (e.g. Dell Precision M4500).</div>
<p>For more details, see <a rel="nofollow" class="external free" href="https://www.iceflatline.com/2009/09/how-to-dual-boot-windows-7-and-linux-using-bcdedit/">https://www.iceflatline.com/2009/09/how-to-dual-boot-windows-7-and-linux-using-bcdedit/</a>
</p>
<h4><span class="mw-headline" id="UEFI_systems">UEFI systems</span></h4>
<p>If you already have Windows installed, it will already have created some partitions on a <a href="../en/Partitioning.html#GUID_Partition_Table" class="mw-redirect" title="GPT">GPT</a>-formatted disk:
</p>
<ul>
<li>a <a href="https://en.wikipedia.org/wiki/Windows_Recovery_Environment" class="extiw" title="wikipedia:Windows Recovery Environment">Windows Recovery Environment</a> partition, generally of size 499 MiB, containing the files required to boot Windows (i.e. the equivalent of Linux's <code>/boot</code>),</li>
<li>an <a href="../en/EFI_system_partition.html" title="EFI system partition">EFI system partition</a> with a <a href="../en/FAT.html" class="mw-redirect" title="FAT32">FAT32</a> filesystem,</li>
<li>a <a href="https://en.wikipedia.org/wiki/Microsoft_Reserved_Partition" class="extiw" title="wikipedia:Microsoft Reserved Partition">Microsoft Reserved Partition</a>, generally of size 128 MiB,</li>
<li>a Microsoft basic data partition with a NTFS filesystem, which corresponds to <code>C:</code>,</li>
<li>potentially system recovery and backup partitions and/or secondary data partitions (corresponding often to <code>D:</code> and above).</li>
</ul>
<p>Using the Disk Management utility in Windows, check how the partitions are labelled and which type gets reported. This will help you understand which partitions are essential to Windows, and which others you might repurpose. The Windows Disk Management utility can also be used to shrink Windows (NTFS) partitions to free up disk space for additional partitions for Linux.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> The first 4 partitions in the above list are essential, do not delete them.</div>
<p>You can then proceed with <a href="../en/Partitioning.html" title="Partitioning">partitioning</a>, depending on your needs. The boot loader needs to support chainloading other EFI applications to dual boot Windows and Linux. An additional EFI system partition should not be created, as it may <a rel="nofollow" class="external text" href="https://support.microsoft.com/en-us/help/2879602/unable-to-boot-if-more-than-one-efi-system-partition-is-present">prevent Windows from booting</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> It only appears when Linux is installed on the second hard disk and a new EFI system partition is created on the second hard disk.</div>
<p>Simply <a href="../en/EFI_system_partition.html#Mount_the_partition" title="EFI system partition">mount the existing partition</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 
<ul>
<li>
<a href="../en/REFInd.html" title="REFInd">rEFInd</a> and <a href="../en/Systemd-boot.html" title="Systemd-boot">systemd-boot</a> will autodetect <i>Windows Boot Manager</i> (<code>\EFI\Microsoft\Boot\bootmgfw.efi</code>) and show it in their boot menu automatically. For <a href="../en/GRUB.html" title="GRUB">GRUB</a> follow either <a href="../en/GRUB.html#Windows_installed_in_UEFI/GPT_mode" title="GRUB">GRUB#Windows installed in UEFI/GPT mode</a> to add boot menu entry manually or <a href="../en/GRUB.html#Detecting_other_operating_systems" title="GRUB">GRUB#Detecting other operating systems</a> for a generated configuration file.</li>
<li>To save space on the EFI system partition, especially for multiple kernels, <a href="../en/Mkinitcpio.html#COMPRESSION" title="Mkinitcpio">increase the initramfs compression</a>.</li>
</ul>
</div>
<p>Computers that come with newer versions of Windows often have <a href="../en/Unified_Extensible_Firmware_Interface/Secure_Boot.html" class="mw-redirect" title="Secure Boot">Secure Boot</a> enabled. You will need to take extra steps to either disable Secure Boot or to make your installation media compatible with secure boot (see above and in the linked page).
</p>
<h3><span class="mw-headline" id="Linux_before_Windows">Linux before Windows</span></h3>
<p>Even though the recommended way to setup a Linux/Windows dual booting system is to first install Windows, it can be done the other way around. In contrast to installing Windows before Linux, you will have to set aside a partition for Windows, say 40GB or larger, in advance. Or have some unpartitioned disk space, or create and resize partitions for Windows from within the Linux installation, before launching the Windows installation.
</p>
<h4><span class="mw-headline" id="UEFI_firmware">UEFI firmware</span></h4>
<p>Windows will use the already existing <a href="../en/EFI_system_partition.html" title="EFI system partition">EFI system partition</a>.
Follows an outline, assuming <a href="../en/Unified_Extensible_Firmware_Interface/Secure_Boot.html" class="mw-redirect" title="Secure Boot">Secure Boot</a> is disabled in the firmware.
</p>
<ol>
<li>Boot into windows installation. Watch to let it use only the intended partition, but otherwise let it do its work as if there is no Linux installation.</li>
<li>Follow the <a href="#Fast_Startup_and_hibernation">#Fast Startup and hibernation</a> section.</li>
<li>Fix the ability to load Linux at start up, perhaps by following <a href="#Cannot_boot_Linux_after_installing_Windows">#Cannot boot Linux after installing Windows</a>. It was already mentioned in <a href="#UEFI_systems">#UEFI systems</a> that some Linux boot managers will autodetect <i>Windows Boot Manager</i>. Even though newer Windows installations have an advanced restart option, from which you can boot into Linux, it is advised to have other means to boot into Linux, such as an arch installation media or a live CD.</li>
</ol>
<h5><span class="mw-headline" id="Windows_10_with_GRUB">Windows 10 with GRUB</span></h5>
<p>The following assumes <a href="../en/GRUB.html" title="GRUB">GRUB</a> is used as a boot loader (although the process is likely similar for other boot loaders) and that Windows 10 will be installed on a GPT block device with an existing EFI system partition (see the "System partition" section in the <a rel="nofollow" class="external text" href="https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/configure-uefigpt-based-hard-drive-partitions">Microsoft documentation</a> for more information).
</p>
<p>Create with program <code>gdisk</code> on the block device the following three new partitions. See <a rel="nofollow" class="external autonumber" href="https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/configure-uefigpt-based-hard-drive-partitions">[5]</a> for more precise partition sizes.
</p>
<table class="wikitable">
<tbody>
<tr>
<th>Min size</th>
<th>Code</th>
<th>Name</th>
<th>File system
</th>
</tr>
<tr>
<td>16 MB</td>
<td>0C01</td>
<td>Microsoft reserved</td>
<td>N/A
</td>
</tr>
<tr>
<td>~40 GB</td>
<td>0700</td>
<td>Microsoft basic data</td>
<td>NTFS
</td>
</tr>
<tr>
<td>300 MB</td>
<td>2700</td>
<td>Windows RE</td>
<td>NTFS
</td>
</tr>
</tbody>
</table>
<p>Create NTFS file systems on the new Microsoft basic data and Windows RE (recovery) partitions using the <i>mkntfs</i> program from package <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ntfs-3g">ntfs-3g</a></span>.
</p>
<p>Reboot the system into a Windows 10 installation media. When prompted to install select the custom install option and install Windows on the Microsoft basic data partition created earlier. This should also install Microsoft EFI files in the <a href="../en/EFI_system_partition.html" title="EFI system partition">EFI system partition</a>.
</p>
<p>After installation (set up of and logging into Windows not required), reboot into Linux and <a href="../en/GRUB.html#Generate_the_main_configuration_file" title="GRUB">generate a GRUB configuration</a> for the Windows boot manager to be available in the GRUB menu on next boot.
</p>
<h3><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h3>
<h4>
<span id="Couldn.27t_create_a_new_partition_or_locate_an_existing_one"></span><span class="mw-headline" id="Couldn't_create_a_new_partition_or_locate_an_existing_one">Couldn't create a new partition or locate an existing one</span>
</h4>
<p>See <a href="#Windows_UEFI_vs_BIOS_limitations">#Windows UEFI vs BIOS limitations</a>.
</p>
<h4><span class="mw-headline" id="Cannot_boot_Linux_after_installing_Windows">Cannot boot Linux after installing Windows</span></h4>
<p>See <a href="../en/Unified_Extensible_Firmware_Interface.html#Windows_changes_boot_order" title="Unified Extensible Firmware Interface">Unified Extensible Firmware Interface#Windows changes boot order</a>.
</p>
<h4><span class="mw-headline" id="Restoring_a_Windows_boot_record">Restoring a Windows boot record</span></h4>
<p>By convention (and for ease of installation), Windows is usually installed on the first partition and installs its partition table and reference to its bootloader to the first sector of that partition.  If you accidentally install a bootloader like GRUB to the Windows partition or damage the boot record in some other way, you will need to use a utility to repair it.  Microsoft includes a boot sector fix utility <code>FIXBOOT</code> and an MBR fix utility called <code>FIXMBR</code> on their recovery discs, or sometimes on their install discs.  Using this method, you can fix the reference on the boot sector of the first partition to the bootloader file and fix the reference on the MBR to the first partition, respectively.  After doing this you will have to <a href="../en/GRUB.html#Installation" title="GRUB">reinstall GRUB</a> to the MBR as was originally intended (that is, the GRUB bootloader can be assigned to chainload the Windows bootloader).
</p>
<p>If you wish to revert back to using Windows, you can use the <code>FIXBOOT</code> command which chains from the MBR to the boot sector of the first partition to restore normal, automatic loading of the Windows operating system.
</p>
<p>Of note, there is a Linux utility called <code>ms-sys</code> (package <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ms-sys/">ms-sys</a></span><sup><small>AUR</small></sup> in AUR) that can install MBR's.  However, this utility is only currently capable of writing new MBRs (all OS's and file systems supported) and boot sectors (a.k.a. boot record; equivalent to using <code>FIXBOOT</code>) for FAT file systems.  Most LiveCDs do not have this utility by default, so it will need to be installed first, or you can look at a rescue CD that does have it, such as <a rel="nofollow" class="external text" href="https://partedmagic.com/">Parted Magic</a>.
</p>
<p>First, write the partition info (table) again by:
</p>
<pre># ms-sys --partition /dev/sda1
</pre>
<p>Next, write a Windows 2000/XP/2003 MBR:
</p>
<pre># ms-sys --mbr /dev/sda  # Read options for different versions
</pre>
<p>Then, write the new boot sector (boot record):
</p>
<pre># ms-sys -(1-6)          # Read options to discover the correct FAT record type
</pre>
<p><code>ms-sys</code> can also write Windows 98, ME, Vista, and 7 MBRs as well, see <code>ms-sys -h</code>.
</p>
<h4><span class="mw-headline" id="Restoring_an_accidentally_deleted_EFI_system_partition">Restoring an accidentally deleted EFI system partition</span></h4>
<p>If you have a GPT-partitioned disk and erased (e.g. with <code>mkfs.fat -F32 /dev/sd<i>x</i></code>) the <a href="../en/EFI_system_partition.html" title="EFI system partition">EFI system partition</a>, you will notice that <i>Windows Boot Manager</i> will either disappear from your boot options, or selecting it will send you back to the UEFI.
</p>
<p>To remedy it, boot with a Windows installation media, press <code>Shift+F10</code> to open the console (or click <i>NEXT &gt; Repair Computer &gt; Troubleshoot... &gt; Advanced &gt; Command Prompt</i>), then start the diskpart utility:
</p>
<pre>X:\Sources&gt; diskpart
DISKPART&gt; list disk
</pre>
<p>Select the appropriate hard drive by typing:
</p>
<pre>DISKPART&gt; select disk <i>number</i>
</pre>
<p>Make sure that there is a partition of type system (the EFI system partition):
</p>
<pre>DISKPART&gt; list partition
</pre>
<p>Select this partition:
</p>
<pre>DISKPART&gt; select partition <i>number</i>
</pre>
<p>and assign a temporary drive letter to it:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">DISKPART&gt; assign letter=<i>G</i>:</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">DiskPart successfully assigned the drive letter or mount point.</pre>
<p>To make sure that drive letter is correctly assigned:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">DISKPART&gt; list vol</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"> Volume ###  Ltr  Label        Fs     Type        Size     Status     Info
 ----------  ---  -----------  -----  ----------  -------  ---------  --------
 Volume 0     E                       DVD-ROM         0 B  No Media
 Volume 1     C                NTFS   Partition    195 GB  Healthy    Boot
 Volume 2         WINRE        NTFS   Partition    400 MB  Healthy    Hidden
 Volume 3     <b>G</b>                <b>FAT32</b>  Partition    <b>499 MB</b>  Healthy    System
</pre>
<p>Close diskpart:
</p>
<pre>DISKPART&gt; exit
</pre>
<p>Navigate to <code>C:\</code> (or what your system drive letter is):
</p>
<pre>X:\Sources&gt; cd /d <i>C</i>:\
</pre>
<p>Next is the "magic" command, which recreate the BCD store (with <code>/s</code> for the mount point, <code>/f</code> for firmware type, optionally add <code>/v</code> for verbose):
</p>
<pre>C:\&gt; bcdboot C:\Windows /s <i>G</i>: /f UEFI
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> If it hangs up after a minute, hit <code>Ctrl+c</code>. This happens sometimes, but you will get a message like <code>boot files successfully created</code> and it will have worked just fine.</div>
<p>You should now have <i>Windows Boot Manager</i> working as a boot option, and thus have access to Windows. Just make sure to never format your EFI system partition again!
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Remove the drive letter G assigned to the EFI system partition to keep it from showing up in <i>My Computer</i>.</div>
<p>See <a rel="nofollow" class="external autonumber" href="https://www.reddit.com/r/archlinux/comments/yprrhr/guide_what_to_do_if_you_accidentally_format_your/">[6]</a>, <a rel="nofollow" class="external autonumber" href="https://superuser.com/a/1111656">[7]</a> and <a rel="nofollow" class="external autonumber" href="https://superuser.com/a/1507645">[8]</a>.
</p>
<h4><span class="mw-headline" id="The_EFI_system_partition_created_by_Windows_Setup_is_too_small">The EFI system partition created by Windows Setup is too small</span></h4>
<p>By default, <a href="https://en.wikipedia.org/wiki/Windows_Setup" class="extiw" title="wikipedia:Windows Setup">Windows Setup</a> creates a 100 MiB <a href="../en/EFI_system_partition.html" title="EFI system partition">EFI system partition</a> (except for <a href="../en/Advanced_Format.html" title="Advanced Format">Advanced Format</a> 4K native drives where it creates a 300 MiB ESP). This is generally too small to fit everything you need. You can <a href="../en/EFI_system_partition.html#Replace_the_partition_with_a_larger_one" title="EFI system partition">replace the existing EFI system partition with a new, larger one</a>.
</p>
<p>If you are installing Windows from scratch, you can dictate the size of the EFI system partition during installation<a rel="nofollow" class="external autonumber" href="https://www.ctrl.blog/entry/how-to-esp-windows-setup.html">[9]</a>:
</p>
<ol>
<li>Select your installation target and make sure it has no partitions.</li>
<li>Click <i>New</i> and then the <i>Apply</i> buttons.  The Windows installer will then generate the expected partitions (allocating nearly everything to its primary partition) and just 100MB to the EFI.</li>
<li>Use the UI to delete the <code>System</code>, <code>MSR</code>, and <code>Primary</code> partitions. Leave the <code>Recovery</code> partition (if present) alone.</li>
<li>Press <code>Shift+F10</code> to open the Command Prompt.</li>
<li>Type <code>diskpart.exe</code> and press <code>Enter</code> to open the disk partitioning tool.</li>
<li>Type <code>list disk</code> and press <code>Enter</code> to list your disks.  Find the one you intend to modify and note its disk number.</li>
<li>Type <code>select disk <i>disk_number</i></code> with the disk number to modify.</li>
<li>Type <code>create partition efi size=<i>size</i></code> with the desired size of the ESP in Mebibytes (MiB), and press <code>Enter</code>. See the note at <a href="../en/EFI_system_partition.html#Create_the_partition" title="EFI system partition">EFI system partition#Create the partition</a> for the recommended sizes.</li>
<li>Type <code>format quick fs=fat32 label=System</code> and press <code>Enter</code> to format the ESP</li>
<li>Type <code>exit</code> and press <code>Enter</code> to exit the disk partitioning tool and <code>exit</code> followed by <code>Enter</code> again.</li>
</ol>
<p>Once Windows is installed, you can resize the primary partition down within Windows and then reboot and go about your usual Arch install, filling the space you just created.
</p>
<p>Alternatively, you can use the Arch install media to create a single <a href="../en/EFI_system_partition.html" title="EFI system partition">EFI system partition</a> of your preferred size <b>before</b> you install Windows on the drive. Windows Setup will use the EFI system partition you made instead of creating its own.
</p>
<h4><span class="mw-headline" id="Unable_to_install_Windows_Cumulative_Update_on_BIOS_system">Unable to install Windows Cumulative Update on BIOS system</span></h4>
<p>On BIOS systems, Windows cumulative updates may fail with the error <i>We couldn’t complete the updates. Undoing changes. Don’t turn off your computer.</i> In such case, while in Windows, you need to set the <a rel="nofollow" class="external text" href="https://superuser.com/a/1405702">Windows partition as active</a>.
</p>
<pre>C:\&gt; diskpart
DISKPART&gt; list disk
DISKPART&gt; select disk <i>number</i>
DISKPART&gt; list partition
DISKPART&gt; select partition <i>number</i>
DISKPART&gt; active
DISKPART&gt; exit
</pre>
<p>After successfully installing the Windows update, mark back your Linux partition as active, using commands above.
</p>
<h2><span class="mw-headline" id="Time_standard">Time standard</span></h2>
<ul>
<li>Recommended: Set both Arch Linux and Windows to use UTC, following <a href="../en/System_time.html#UTC_in_Microsoft_Windows" title="System time">System time#UTC in Microsoft Windows</a>. Some versions of Windows revert the hardware clock back to <i>localtime</i> if they are set to synchronize the time online. This issue appears to be fixed in Windows 10.</li>
<li>Not recommended: Set Arch Linux to <i>localtime</i> and disable all <a href="../en/System_time.html#Time_synchronization" title="System time">time synchronization daemons</a>. This will let Windows take care of hardware clock corrections and you will need to remember to boot into Windows at least two times a year (in Spring and Autumn) when <a href="https://en.wikipedia.org/wiki/Daylight_saving_time" class="extiw" title="wikipedia:Daylight saving time">DST</a> kicks in. So please do not ask on the forums why the clock is one hour behind or ahead if you usually go for days or weeks without booting into Windows.</li>
</ul>
<h2><span class="mw-headline" id="Bluetooth_pairing">Bluetooth pairing</span></h2>
<p>When it comes to pairing Bluetooth devices with both the Linux and Windows installation, both systems have the same MAC address, but will use different link keys generated during the pairing process. This results in the device being unable to connect to one installation, after it has been paired with the other. To allow a device to connect to either installation without re-pairing, follow <a href="../en/Bluetooth.html#Dual_boot_pairing" title="Bluetooth">Bluetooth#Dual boot pairing</a>.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=140049">Booting Windows from a desktop shortcut</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/kaipee/grub-reboot2win">One-time boot into Windows partition from desktop shortcut</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/ValdikSS/windows2usb">Windows 7/8/8.1/10 ISO to Flash Drive burning utility for Linux (MBR/GPT, BIOS/UEFI, FAT32/NTFS)</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Boot_process.html" title="Category:Boot process">Boot process</a></li>
<li><a href="../en/Category:Installation_process.html" title="Category:Installation process">Installation process</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li>
<li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Dual_boot_with_Windows&amp;oldid=813312">https://wiki.archlinux.org/index.php?title=Dual_boot_with_Windows&amp;oldid=813312</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 30 July 2024, at 11:47.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
