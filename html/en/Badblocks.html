<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-os vector-sticky-header-enabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>badblocks - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.44.2">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Badblocks rootpage-Badblocks skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Installation</span>
			</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Storage_device_fidelity" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Storage_device_fidelity">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Storage device fidelity</span>
			</div>
		</a>
		
		<ul id="toc-Storage_device_fidelity-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Comparisons_with_other_programs" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Comparisons_with_other_programs">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Comparisons with other programs</span>
			</div>
		</a>
		
		<ul id="toc-Comparisons_with_other_programs-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Testing" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Testing">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">4</span>
				<span>Testing</span>
			</div>
		</a>
		
			<button aria-controls="toc-Testing-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Testing subsection</span>
			</button>
		
		<ul id="toc-Testing-sublist" class="vector-toc-list">
			<li id="toc-Read-only_test" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Read-only_test">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.1</span>
					<span>Read-only test</span>
				</div>
			</a>
			
			<ul id="toc-Read-only_test-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Write-mode_test" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Write-mode_test">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.2</span>
					<span>Write-mode test</span>
				</div>
			</a>
			
			<ul id="toc-Write-mode_test-sublist" class="vector-toc-list">
				<li id="toc-Define_specific_test_pattern" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Define_specific_test_pattern">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.2.1</span>
					<span>Define specific test pattern</span>
				</div>
			</a>
			
			<ul id="toc-Define_specific_test_pattern-sublist" class="vector-toc-list">
				<li id="toc-Random_pattern" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Random_pattern">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.2.1.1</span>
					<span>Random pattern</span>
				</div>
			</a>
			
			<ul id="toc-Random_pattern-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Read-write_test_(non-destructive)" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Read-write_test_(non-destructive)">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.3</span>
					<span>Read-write test (non-destructive)</span>
				</div>
			</a>
			
			<ul id="toc-Read-write_test_(non-destructive)-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Have_filesystem_incorporate_bad_sectors" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Have_filesystem_incorporate_bad_sectors">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">5</span>
				<span>Have filesystem incorporate bad sectors</span>
			</div>
		</a>
		
			<button aria-controls="toc-Have_filesystem_incorporate_bad_sectors-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Have filesystem incorporate bad sectors subsection</span>
			</button>
		
		<ul id="toc-Have_filesystem_incorporate_bad_sectors-sublist" class="vector-toc-list">
			<li id="toc-During_filesystem_check" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#During_filesystem_check">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.1</span>
					<span>During filesystem check</span>
				</div>
			</a>
			
			<ul id="toc-During_filesystem_check-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Before_filesystem_creation" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Before_filesystem_creation">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.2</span>
					<span>Before filesystem creation</span>
				</div>
			</a>
			
			<ul id="toc-Before_filesystem_creation-sublist" class="vector-toc-list">
				<li id="toc-Ext4" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Ext4">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.2.1</span>
					<span>Ext4</span>
				</div>
			</a>
			
			<ul id="toc-Ext4-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Block_size" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Block_size">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.2.2</span>
					<span>Block size</span>
				</div>
			</a>
			
			<ul id="toc-Block_size-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Finding_bad_sectors" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Finding_bad_sectors">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">6</span>
				<span>Finding bad sectors</span>
			</div>
		</a>
		
		<ul id="toc-Finding_bad_sectors-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Interaction_with_remapping" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Interaction_with_remapping">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">7</span>
				<span>Interaction with remapping</span>
			</div>
		</a>
		
		<ul id="toc-Interaction_with_remapping-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Alternatives" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Alternatives">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">8</span>
				<span>Alternatives</span>
			</div>
		</a>
		
		<ul id="toc-Alternatives-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar vector-feature-custom-font-size-clientpref--excluded">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left" title="Table of Contents">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading">badblocks</h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 3 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-3" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">3 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-es mw-list-item"><a href="../es/Badblocks.html" title="Badblocks – español" lang="es" hreflang="es" data-title="Badblocks" data-language-autonym="Español" data-language-local-name="español" class="interlanguage-link-target"><span>Español</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Badblocks" title="Badblocks – 日本語" lang="ja" hreflang="ja" data-title="Badblocks" data-language-autonym="日本語" data-language-local-name="日本語" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-pt mw-list-item"><a href="../pt/Badblocks.html" title="Badblocks – português" lang="pt" hreflang="pt" data-title="Badblocks" data-language-autonym="Português" data-language-local-name="português" class="interlanguage-link-target"><span>Português</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end vector-feature-custom-font-size-clientpref--excluded">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<p><span>
</span>
</p>
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/Identify_damaged_files.html" title="Identify damaged files">Identify damaged files</a></li>
</ul>
</div>
<p><i>badblocks</i> is a program to test storage devices for bad blocks.
</p>
<p>Modern HDDs and SSDs include firmware that will automatically detect, attempt to correct, and report errors. However, firmware becomes aware of a corrupted sector only upon an attempt to read or write to it. <i>Badblocks</i> may be used to test the entire device at once. It operates by sequentially attempting to read and optionally write to and read back every sector on a drive, and report errors. Consequently, the firmware will react to any detected failures in this process. 
</p>
<meta property="mw:PageProp/toc">
<div class="mw-heading mw-heading2"><h2 id="Installation">Installation</h2></div>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=e2fsprogs">e2fsprogs</a></span> package.
</p>
<p>See <span class="plainlinks archwiki-template-man" title="$ man 8 badblocks"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/badblocks.8">badblocks(8)</a></span> for the usage.
</p>
<div class="mw-heading mw-heading2"><h2 id="Storage_device_fidelity">Storage device fidelity</h2></div>
<p>Due to natural manufacturing defects, every new drive generally has some bad sectors. However as part of manufacturing these sectors are scanned for, detected, and reported to the firmware of the drive. Sectors such as this will not be visible to end users, a new drive should always report zero bad sectors. As part of normal usage, drives will degrade over time developing more bad sectors. Drive firmware automatically monitors and attempts to correct for this and a small number of bad blocks on older drives is expected. An increasing number of bad blocks generally indicates a failing drive, and more than a few on a drive still within warranty generally indicates a defective drive, both of which should be replaced.
</p>
<div class="mw-heading mw-heading2"><h2 id="Comparisons_with_other_programs">Comparisons with other programs</h2></div>
<p>Many storage device manufacturers have their own test programs for drives. Their standards as well as firmware specific quirks are normally built in to the program, and can be more accurate for drive health than <i>badblocks</i>. Furthermore, they can take much less time to scan drive than <i>badblocks</i>. However, some tools do not always report full tests results and simply report a pass or failure, making them less useful for precise information.
</p>
<div class="mw-heading mw-heading2"><h2 id="Testing">Testing</h2></div>
<div class="mw-heading mw-heading3"><h3 id="Read-only_test">Read-only test</h3></div>
<p>Read-only tests attempt to read every single sector on the specified drive. The operation is non-destructive and may be safely executed on live systems. It is similar to an <a href="../en/S.M.A.R.T..html#Run_a_test" class="mw-redirect" title="Smartctl">extended S.M.A.R.T. self-test</a>, however unlike the self-test <i>badblocks</i> will proceed even after encountering an error, identifying all errors on the device.
</p>
<div class="mw-heading mw-heading3"><h3 id="Write-mode_test">Write-mode test</h3></div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning</strong> Write-mode bad blocks tests are destructive to <i>all</i> data on the drive upon which they are executed, and data cannot be recovered. The test will begin as soon as the command is executed, there is no backout period or confirmation. Double check what drive you are targeting before executing any write-mode command.</div>
<p>Write tests are a more intensive but fully destructive test, in which a pattern is written to the entire disk and then read back after a pass. As the pattern is written to every accessible block, contents of the device are lost. The default is an extensive test with four passes using four different patterns: 0xaa (10101010), 0x55 (01010101), 0xff (11111111) and 0x00 (00000000). For some devices this will take a couple of days to complete.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># badblocks -wsv /dev/<i>device</i></pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Checking for bad blocks in read-write mode
From block 0 to 488386583
Testing with pattern <b>0xaa</b>: done
Reading and comparing: done
Testing with pattern <b>0x55</b>: done
Reading and comparing: done
Testing with pattern <b>0xff</b>: 22.93% done, 4:09:55 elapsed. (0/0/0 errors)
[...]
Testing with pattern <b>0x00</b>: done
Reading and comparing: done
Pass completed, 0 bad blocks found. (0/0/0 errors)</pre>
<p>Options:
</p>
<dl>
<dd>
<code>-w</code>: do a destructive write test</dd>
<dd>
<code>-s</code>: show progress</dd>
<dd>
<code>-v</code>: be "verbose" and output bad sectors detected to stdout</dd>
</dl>
<p>Additional options you might consider:
</p>
<dl>
<dd>
<code>-b <i>number</i></code>: specify the block size of the hard disk which can significantly improve testing time. (<code>tune2fs -l <i>partition</i> | grep 'Block size'</code> as the root user). For drives larger than two terabytes, <code>-b 4096</code> is required for the test to proceed properly</dd>
<dd>
<code>-p <i>number</i></code>: run through the extensive four pass test <i>number</i> of sequent iterations</dd>
<dd>
<code>-o <i>/path/to/output-file</i></code>: print bad sectors to <i>output-file</i> instead of stdout</dd>
<dd>
<code>-t <i>test_pattern</i></code>: Specify a pattern. See below.</dd>
</dl>
<div class="mw-heading mw-heading4"><h4 id="Define_specific_test_pattern">Define specific test pattern</h4></div>
<p><b>From the manpage:</b> "The <i>test_pattern</i> may either be a numeric value between 0 and  ULONG_MAX-1  inclusive [...]."
</p>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-view-fullscreen.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs expansion.</b></p>
<div>
<b>Reason:</b> <span style="color:red;">please use the first argument of the template to provide a brief explanation.</span> (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Badblocks.html">Talk:Badblocks</a>)</div>
</div>
<div class="mw-heading mw-heading5"><h5 id="Random_pattern">Random pattern</h5></div>
<p><i>Badblocks</i> can be made to repeatedly write a single "random pattern" with the <code>-t random</code> option.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># badblocks -wsv -t random /dev/<i>device</i></pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Checking for bad blocks in read-write mode
From block 0 to 488386583
Testing with <b>random pattern</b>: done                                                 
Reading and comparing: done                                                 
Pass completed, 0 bad blocks found. (0/0/0 errors)</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> The random generator is not suitable for cryptographic purposes. <i>Badblocks</i> should not be used e.g. for <a href="../en/Securely_wipe_disk.html#Preparations_for_block_device_encryption" title="Securely wipe disk">block device encryption</a>.</div>
<div class="mw-heading mw-heading3"><h3 id="Read-write_test_(non-destructive)">
<span id="Read-write_test_.28non-destructive.29"></span>Read-write test (non-destructive)</h3></div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning</strong> This test should not be performed on mounted file systems or if anything else may be writing to the tested area while badblocks is running. This may lead to data loss.</div>
<p>This test is designed for devices with data already on them. A non-destructive read-write test makes a backup of the original content of a sector before testing with a single random pattern and then restoring the content from the backup. This is a single pass test and is useful as a general maintenance test.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># badblocks -nsv /dev/<i>device</i></pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Checking for bad blocks in non-destructive read-write mode
From block 0 to 488386583
Checking for bad blocks (non-destructive read-write test)
Testing with <b>random pattern</b>: done                                                 
Pass completed, 0 bad blocks found. (0/0/0 errors)</pre>
<p>The <code>-n</code> option signifies a non-destructive read-write test.
</p>
<div class="mw-heading mw-heading2"><h2 id="Have_filesystem_incorporate_bad_sectors">Have filesystem incorporate bad sectors</h2></div>
<p>To not use bad sectors, they have to be known by the filesystem.
</p>
<div class="mw-heading mw-heading3"><h3 id="During_filesystem_check">During filesystem check</h3></div>
<p>Incorporating bad sectors can be done using the filesystem check utility (<i>fsck</i>). <i>fsck</i> can be told to use <i>badblocks</i> during a check.  To do a <b>read-write</b> (non-destructive) test and have the bad sectors made known to the filesystem, run:
</p>
<pre># fsck -vcck /dev/<i>device-PARTITION</i>
</pre>
<p>The <code>-cc</code> option tells run <code>fsck</code> in <b>non-destructive</b> test mode, the <code>-v</code> tells <code>fsck</code> to show its output, and the <code>-k</code> option preserves old bad sectors that were detected.
</p>
<p>To do a <b>read-only</b> test (not recommended):
</p>
<pre># fsck -vck /dev/<i>device-PARTITION</i>
</pre>
<div class="mw-heading mw-heading3"><h3 id="Before_filesystem_creation">Before filesystem creation</h3></div>
<p>Alternately, this can be done before filesystem creation.
</p>
<p>If <i>badblocks</i> is run without the <code>-o</code> option, bad sectors will only be printed to stdout.
</p>
<p>Example output for read errors in the beginning of the disk:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># badblocks -wsv /dev/<i>drive</i></pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[...]
Testing with pattern <b>0xff</b>: done                                                 
Reading and comparing:
[...]
37584
37585 0.84% done, 7:31:08 elapsed. (0/0/527405 errors)
37586
[...]
done
Testing with pattern <b>0x00</b>:
Reading and comparing:
[...]
37584
37585
[...]
done
Pass completed, 527405 bad blocks found. (0/0/527405 errors)</pre>
<p>For comfortably passing <i>badblocks</i> error output to the filesystem, it has to be written to a file.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># badblocks -wsv <b>-o</b> /root/<i>badblocks.txt</i> /dev/<i>device</i></pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Checking for bad blocks in read-write mode
From block 0 to 488386583
Testing with pattern <b>0xaa</b>: done
Reading and comparing:   6.36% done, 0:51 elapsed. (0/0/14713 errors)
[...]
Testing with pattern <b>0x00</b>: done
Reading and comparing: done
Pass completed, 527405 bad blocks found. (0/0/527405 errors)</pre>
<p>Then (re-)create the file system with the information:
</p>
<pre># mke2fs -t <i>filesystem-type</i> <b>-l</b> /root/<i>badblocks.txt</i> /dev/<i>device</i>
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> The meaning of <code>0/0/527405</code> errors is <i>number_of_read_errors</i> / <i>number_of_write_errors</i> / <i>number_of_corruption_errors</i>.</div>
<div class="mw-heading mw-heading4"><h4 id="Ext4">Ext4</h4></div>
<p>From the <span class="plainlinks archwiki-template-man" title="$ man 8 mke2fs"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mke2fs.8">mke2fs(8)</a></span> manual page:
</p>
<dl><dd>Note that the block numbers in the bad block list must be generated using the same block size as used by <i>mke2fs</i>. As a result, the <code>-c</code> option to <i>mke2fs</i> is a much simpler and less error-prone method of checking a disk for bad blocks before formatting it.</dd></dl>
<p>So the recommended method is to use:
</p>
<pre># mkfs.ext4 -c /dev/<i>device</i>
</pre>
<p>Use <code>-cc</code> to do a read-write bad block test.
</p>
<div class="mw-heading mw-heading4"><h4 id="Block_size">Block size</h4></div>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Merge-arrows-2.svg" decoding="async" width="36" height="40" class="mw-file-element"></span></span><b>This article or section is a candidate for merging with <a href="../en/Securely_wipe_disk.html#Block_size" title="Securely wipe disk">Securely wipe disk#Block size</a>.</b></p>
<div>
<b>Notes:</b> Block size alignment is not specific to this tiny section. Other Arch Wiki Articles already do cover this up. Search for it and cover everything up on a <a href="/index.php?title=Block_size&amp;action=edit&amp;redlink=1" class="new" title="Block size (page does not exist)">Block size</a> page. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Badblocks.html">Talk:Badblocks</a>)</div>
</div>
<p>First, find the file systems' <b>block size</b>.  For example for ext# filesystems:
</p>
<pre># dumpe2fs /dev/<i>device-PARTITION</i> | grep 'Block size'
</pre>
<p>Feed this to <i>badblocks</i>:
</p>
<pre># badblocks -b <i>block size</i>
</pre>
<div class="mw-heading mw-heading2"><h2 id="Finding_bad_sectors">Finding bad sectors</h2></div>
<p>You can use badblock to find bad sectors. Note that <i>badblocks</i> calls sectors "blocks". It supports a few scan modes. There is read-only mode (default) which is the least accurate. There is the destructive write-mode (<code>-w</code> option) which is the most accurate but takes longer and will (obviously) destroy all data on the drive, thus making it quite useless for matching sectors up to files. There is finally the non-destructive read-write mode which is probably as accurate as the destructive mode, with the only real downside that it is probably the slowest. However, if a drive is known to be failing, then read-only mode is probably still the safest.
</p>
<p>To do a verbose (<code>-v</code> option), read-only scan, run one of these commands (with <code>x</code> being the drive letter and <code>y</code> being partition number you want to scan):
</p>
<p>Whole disk scan:
</p>
<pre># badblocks -v /dev/sdx
</pre>
<p>Single partition scan:
</p>
<pre># badblocks -v /dev/sdxy
</pre>
<p>The downside to scanning the drive as a whole is that each filesystem is going to start its block count relative to the partition it is on. This means that if you have a bad block that happens to be on, let us say, the second partition, and that partition starts on block 1000, then you will have to subtract 1000 from your block number in order to get the number you want. So if a scan from the beginning of the disk results in block number 1005 being bad, then block 5 of the second partition is what you will actually be using.
</p>
<p>Otherwise, if you have found bad blocks after doing a full scan, you can simply figure out which partitions they are on, and rescan those in order to get the block number, rather than do any block math.
</p>
<p>Another thing to note is that <i>badblocks</i> defaults to 1024 byte blocks, so you will either have to change the default size with the <code>-b</code> option in order to match your filesystem or manually convert the block number(s) later.
</p>
<p>If you need to figure out where your partitions start and end, run <a href="../en/Fdisk.html" title="Fdisk">fdisk</a>. Make sure to note the block size <a href="../en/Fdisk.html" title="Fdisk">fdisk</a> is using so that you can convert the block counts to match your scan.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># fdisk -l /dev/sdx</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Disk /dev/sdx: 149.05 GiB, 160041885696 bytes, 312581808 sectors
<b>Units = sectors of 1 * 512 = 512 bytes</b>
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes</pre>
<p>After all this, you should have the block number(s) of your bad block(s), relative to the partition they exist on.
</p>
<div class="mw-heading mw-heading2"><h2 id="Interaction_with_remapping">Interaction with remapping</h2></div>
<p>HDD controllers with SMART are generally able to remap a bad sector. They still waste time retrying reads at a bad sector, but on a write they either manage to fix it (when the error is "soft", i.e. ECC failure) or remap it to a spare sector, as long as the spare is not depleted.
</p>
<ul>
<li>In non-destructive RW mode, badblocks first attempt a read of a sector. As a result, both "soft" and "hard" bad sectors are considered bad and not further tested. You should see the pending count unchanged or go up in SMART.</li>
<li>In destructive RW mode, badblocks does the writing first. As a result, a remap should be triggered and the sector should be "fixed" in terms of being accessible. You should see the pending sector count go down in SMART, while the reallocated count stays unchanged (if "soft") or goes up (if "hard"). badblocks will go on to test whether the sector faithfully retains the data, as it is originally designed to.</li>
</ul>
<p>It is possible to force a write using the badblocks list from non-destructive testing. One would need to calculate the LBA ranges, use <code>hdparm --read-sector</code> to narrow it down to single sectors, and finally use <code>hdparm --write-sector</code> <a rel="nofollow" class="external autonumber" href="https://serverfault.com/a/641135/">[1]</a> to trigger the write. You would be giving up on any possible future retries at this sector, but at least no more read hangs would occur.
</p>
<div class="mw-heading mw-heading2"><h2 id="Alternatives">Alternatives</h2></div>
<p>Since <i>badblocks</i> was originally written to verify floppy disks, its design is not construed for modern HDDs. With sizes such as 18 TB drives, even the regular tip to use <code>-b 4096</code> <a rel="nofollow" class="external text" href="https://www.reddit.com/r/DataHoarder/comments/fbst8m/alternative_to_badblocks/">will not help anymore</a>. Encrypting a bunch of zeroes is a great alternative:
</p>
<ol>
<li>Span a crypto layer above the device: <code>cryptsetup open /dev/<i>device</i> <i>name</i> --type plain --cipher aes-xts-plain64</code>
</li>
<li>Fill the now opened decrypted layer with zeroes, which get written as encrypted data: <code>shred -v -n 0 -z /dev/mapper/<i>name</i></code>
</li>
<li>Compare fresh zeroes with the decrypted layer: <code>cmp -b /dev/zero /dev/mapper/<i>name</i></code> If it just stops with a message about end of file, the drive is fine. This method is also way faster than <i>badblocks</i> even with a single pass. As the command does a full write, any bad sectors (as known to the disk controller) should also be eliminated.</li>
</ol>
<p>On btrfs and ZFS, the designers have decided that a floppy-era bad block list is not needed any more. They are usually right as long as you write over the defects (see above). Reading will still hang from retrying. If you want to "isolate" the bad blocks like in the old days, use a lower-level solution by partitioning or LVM.
</p>
<p>On modern spinning drives, <code>smartctl -t long /dev/<i>device</i></code> (see <a href="../en/S.M.A.R.T..html" title="S.M.A.R.T.">S.M.A.R.T.</a>) performs a full read-only test. It will halt as soon as a failure is found and record it as a "LBA_of_first_error" data entry, which you can then overwrite with hdparm (see above). You can skip the failure with a follow up selective test.
</p>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Hardware_detection_and_troubleshooting.html" title="Category:Hardware detection and troubleshooting">Hardware detection and troubleshooting</a></li>
<li><a href="../en/Category:Commands.html" title="Category:Commands">Commands</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Merge.html" title="Category:Pages or sections flagged with Template:Merge">Pages or sections flagged with Template:Merge</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Badblocks&amp;oldid=851485">https://wiki.archlinux.org/index.php?title=Badblocks&amp;oldid=851485</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 2 November 2025, at 05:16.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><picture><source media="(min-width: 500px)" srcset="/resources/assets/poweredby_mediawiki.svg" width="88" height="31"><img src="/resources/assets/mediawiki_compact.svg" width="25" height="25" loading="lazy"></picture></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-header-container vector-sticky-header-container">
	<div id="vector-sticky-header" class="vector-sticky-header">
		<div class="vector-sticky-header-start">
			<div class="vector-sticky-header-icon-start vector-button-flush-left vector-button-flush-right" aria-hidden="true">
				<button class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-sticky-header-search-toggle" tabindex="-1" data-event-name="ui.vector-sticky-search-form.icon"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
			</button>
		</div>
			
		<div role="search" class="vector-search-box-vue vector-search-box">
			<div class="vector-typeahead-search-container">
				<div class="cdx-typeahead-search">
					<form action="/index.php" id="vector-sticky-search-form" class="cdx-search-input cdx-search-input--has-end-button">
						<div class="cdx-search-input__input-wrapper" data-search-loc="header-moved">
							<div class="cdx-text-input cdx-text-input--has-start-icon">
								<input class="cdx-text-input__input" type="search" name="search" placeholder="Search ArchWiki">
								<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
							</div>
							<input type="hidden" name="title" value="Special:Search">
						</div>
						<button class="cdx-button cdx-search-input__end-button">Search</button>
					</form>
				</div>
			</div>
		</div>
		<div class="vector-sticky-header-context-bar">
				<nav aria-label="Contents" class="vector-toc-landmark">
						
					<div id="vector-sticky-header-toc" class="vector-dropdown mw-portlet mw-portlet-sticky-header-toc vector-sticky-header-toc vector-button-flush-left">
						<input type="checkbox" id="vector-sticky-header-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-sticky-header-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
						<label id="vector-sticky-header-toc-label" for="vector-sticky-header-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
						</label>
						<div class="vector-dropdown-content">
					
						<div id="vector-sticky-header-toc-unpinned-container" class="vector-unpinned-container">
						</div>
					
						</div>
					</div>
			</nav>
				<div class="vector-sticky-header-context-bar-primary" aria-hidden="true">badblocks</div>
			</div>
		</div>
		<div class="vector-sticky-header-end" aria-hidden="true">
			<div class="vector-sticky-header-icons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-talk-sticky-header" tabindex="-1" data-event-name="talk-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbles mw-ui-icon-wikimedia-speechBubbles"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-subject-sticky-header" tabindex="-1" data-event-name="subject-sticky-header"><span class="vector-icon mw-ui-icon-article mw-ui-icon-wikimedia-article"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-history-sticky-header" tabindex="-1" data-event-name="history-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-history mw-ui-icon-wikimedia-wikimedia-history"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only mw-watchlink" id="ca-watchstar-sticky-header" tabindex="-1" data-event-name="watch-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-star mw-ui-icon-wikimedia-wikimedia-star"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-edit-sticky-header" tabindex="-1" data-event-name="wikitext-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-wikiText mw-ui-icon-wikimedia-wikimedia-wikiText"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-ve-edit-sticky-header" tabindex="-1" data-event-name="ve-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-edit mw-ui-icon-wikimedia-wikimedia-edit"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-viewsource-sticky-header" tabindex="-1" data-event-name="ve-edit-protected-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-editLock mw-ui-icon-wikimedia-wikimedia-editLock"></span>

<span></span>
			</a>
		</div>
			<div class="vector-sticky-header-buttons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive" id="ca-addsection-sticky-header" tabindex="-1" data-event-name="addsection-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbleAdd-progressive mw-ui-icon-wikimedia-speechBubbleAdd-progressive"></span>

<span>Add topic</span>
			</a>
		</div>
			<div class="vector-sticky-header-icon-end">
				<div class="vector-user-links">
				</div>
			</div>
		</div>
	</div>
</div>
<div class="mw-portlet mw-portlet-dock-bottom emptyPortlet" id="p-dock-bottom">
	<ul>
		
	</ul>
</div>
</body>
</html>
