<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Ente server - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Ente_server rootpage-Ente_server skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Installation</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Configuration</div>
		</a>
		
			<button aria-controls="toc-Configuration-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configuration subsection</span>
			</button>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
			<li id="toc-MinIO_setup" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#MinIO_setup">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>MinIO setup</div>
			</a>
			
			<ul id="toc-MinIO_setup-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-PostgreSQL_setup" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#PostgreSQL_setup">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>PostgreSQL setup</div>
			</a>
			
			<ul id="toc-PostgreSQL_setup-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Running_ente-server" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Running_ente-server">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3</span>Running ente-server</div>
			</a>
			
			<ul id="toc-Running_ente-server-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Configuring_Nginx_proxy" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configuring_Nginx_proxy">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4</span>Configuring Nginx proxy</div>
			</a>
			
			<ul id="toc-Configuring_Nginx_proxy-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Configuring_ente-server_and_ente-cli" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configuring_ente-server_and_ente-cli">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.5</span>Configuring ente-server and ente-cli</div>
			</a>
			
			<ul id="toc-Configuring_ente-server_and_ente-cli-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Increasing_user_storage_and_account_expiry_limit" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Increasing_user_storage_and_account_expiry_limit">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.6</span>Increasing user storage and account expiry limit</div>
			</a>
			
			<ul id="toc-Increasing_user_storage_and_account_expiry_limit-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-(Optional)_Copy_and_apply_AppArmor_profile" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#(Optional)_Copy_and_apply_AppArmor_profile">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.7</span>(Optional) Copy and apply AppArmor profile</div>
			</a>
			
			<ul id="toc-(Optional)_Copy_and_apply_AppArmor_profile-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-(Optional)_Configure_Firewall" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#(Optional)_Configure_Firewall">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.8</span>(Optional) Configure Firewall</div>
			</a>
			
			<ul id="toc-(Optional)_Configure_Firewall-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Files" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Files">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Files</div>
		</a>
		
		<ul id="toc-Files-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Ente server</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 1 language">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-1" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">1 language</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Ente_%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC" title="Ente サーバー – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/AppArmor.html" title="AppArmor">AppArmor</a></li>
<li><a href="../en/Certbot.html" title="Certbot">Certbot</a></li>
<li><a href="../en/MinIO.html" title="MinIO">MinIO</a></li>
<li><a href="../en/Nginx.html" title="Nginx">Nginx</a></li>
<li><a href="../en/PostgreSQL.html" title="PostgreSQL">PostgreSQL</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://ente.io">Ente server</a> is the server part that stores and serves encrypted blobs of data to ente (mobile) clients. The clients send/receive encrypted data, which then arrives at the Ente server and is stored/read via the local <a href="../en/MinIO.html" title="MinIO">MinIO</a> object storage service.
</p>
<p>For example when the <b>Ente</b> photos client is used, the client encrypts the photos, which are then stored on this server. Later on the client can then lookup the encrypted photos, and decrypt them locally (<b>end-to-end encryption</b>). Since only the client, or anyone the client shares the photos with, have the encryption key, only they can decrypt the data and actually see the photos, the server will never be able to do this due to the lack of that key material.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ente-server-git/">ente-server-git</a></span><sup><small>AUR</small></sup> package is meant for self hosting in contrary to the by default provided dockerized <b>Ente</b> server. If a dockerized or hosted solution is required, see <a rel="nofollow" class="external text" href="https://ente.io/">ente.io</a>.
</p>
<p>Start by <a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">installing</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ente-server-git/">ente-server-git</a></span><sup><small>AUR</small></sup> package.
</p>
<p>Note that since self hosted server space is often available in limited quantity, the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ente-server-git/">ente-server-git</a></span><sup><small>AUR</small></sup> package added the ability to change the cleanup delay cleanup before old unlinked ente-server <a href="../en/MinIO.html" title="MinIO">MinIO</a> objects will be actually deleted. This can be configured via the <code>internal:delete-object-delay</code> <i>ente-server</i> configuration parameter. The default upstream Ente server cleans these objects every <code>45 days</code> by default, but when replication is not required, this setting can be set to cleanup every <code>5 minutes</code> for example. 
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This setting is <b>NOT</b> supported by the <b>Ente</b> developers, due to the possible risk of breaking <i>ente-server</i>. The full warning has been described in the <i>ente-server</i> configuration file.</div>
<p>To get the <b>Ente</b> server running a working <a href="../en/PostgreSQL.html" title="PostgreSQL">PostgreSQL</a> database (to store Ente object meta data and user data) and <a href="../en/MinIO.html" title="MinIO">MinIO</a> bucket (to store encrypted object data) is required. Furthermore, a HTTPS proxy like <a href="../en/Nginx.html" title="Nginx">Nginx</a> is recommended to be used to access the <b>Ente</b> server. Lastly, the <i>ente-cli</i> tool can be used to easily upgrade ente-server account size limit and account expiry.
</p>
<p>These required components are listed as optional dependencies and should preferably be installed as dependencies: <a href="../en/Pacman.html#Installation_reason" title="Pacman">Pacman#Installation_reason</a>
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<h3><span class="mw-headline" id="MinIO_setup">MinIO setup</span></h3>
<p><a href="../en/Help:Reading.html#Append,_add,_create,_edit" class="mw-redirect" title="Textedit">Edit</a> the configuration file as follows: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/minio/minio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">MINIO_VOLUMES="/srv/minio/data"
MINIO_ROOT_USER=minio
MINIO_ROOT_PASSWORD='<i>YOUR-STRONG-MINIO-ROOT-PASSWORD</i>'
MINIO_OPTS="--address 127.0.0.1:43200 --console-address 127.0.0.1:43201"</pre>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable/start">Enable/start</a> <code>minio.service</code>.
</p>
<p>Create <a href="../en/MinIO.html" title="MinIO">MinIO</a> ente-server bucket with the <i>mcli</i> command (as the minio user):
</p>
<pre># cd /srv/minio/data
[minio]$ mcli mb -p ente-server
</pre>
<h3><span class="mw-headline" id="PostgreSQL_setup">PostgreSQL setup</span></h3>
<p>Initialize the database as the postgres user:
</p>
<pre>[postgres]$ initdb --locale en_US.UTF-8 -D '/var/lib/postgres/data' --data-checksums --auth=scram-sha-256 --pwprompt -c listen_addresses=''
</pre>
<p><a href="../en/PostgreSQL.html#Configure_PostgreSQL_to_be_accessible_exclusively_through_UNIX_Sockets" title="PostgreSQL">PostgreSQL#Configure PostgreSQL to be accessible exclusively through UNIX Sockets</a>, in case of an existing PostgreSQL setup:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/var/lib/postgres/data/postgresql.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">listen_addresses = '' # AF_UNIX Socket only</pre>
<p>Restrict socket access to <a href="../en/PostgreSQL.html" title="PostgreSQL">PostgreSQL</a> user or group by <a href="../en/Systemd.html#Editing_provided_units" class="mw-redirect" title="Edit">editing</a> <code>postgresql.service</code>: 
</p>
<pre>[Service]
RuntimeDirectoryMode=750</pre>
<p>Add <code>ente</code> to the <code>postgres</code> <a href="../en/Users_and_groups.html#Group_management" class="mw-redirect" title="User group">user group</a>, then <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start/enable">start/enable</a><code>postgresql.service</code>.
</p>
<p>Create <a href="../en/PostgreSQL.html" title="PostgreSQL">PostgreSQL</a> database user and a database owned by this user (specify new password twice, then specify postgres password to store new account):
</p>
<pre>[postgres]$ createuser -P ente
</pre>
<p>Then specify postgres password to create new database:
</p>
<pre>[postgres]$ createdb -T template0 -O ente -E unicode ente-server
</pre>
<h3><span class="mw-headline" id="Running_ente-server">Running ente-server</span></h3>
<p>Add <a href="../en/MinIO.html" title="MinIO">MinIO</a> bucket details:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ente-server/local.yaml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">b2-eu-cen:
    key: minio
    secret: "<i>YOUR-STRONG-MINIO-ROOT-PASSWORD</i>"
    endpoint: https://<i>your_public_domain.tld</i>:3200
    region: eu-central-2
    bucket: ente-server
</pre>
<p>Add <a href="../en/PostgreSQL.html" title="PostgreSQL">PostgreSQL</a> details:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ente-server/local.yaml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">db:
    host: /run/postgresql
    port: 5432
    name: ente-server
    user: ente
    password: "<i>YOUR-STRONG-ENTE-DATABASE-USER-PASSWORD</i>"
</pre>
<p>Generate new secret key values using the <i>ente-server-gen-random-keys</i> command and use these values as a replacement of the default values in the <code>/etc/ente-server/local.yaml</code> configuration file.
</p>
<p><a href="../en/Systemd.html#Editing_provided_units" class="mw-redirect" title="Edit">Edit</a> <code>ente-server.service</code> to allow it to access to the IP address of <i>your_public_domain.tld</i> (by default the service only allows access from and to localhost):
</p>
<pre>[Service]
IPAddressAllow=<i>IP_address_of_your_public_domain.tld</i>
</pre>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable/start">Enable/start</a> <code>ente-server.service</code>.
</p>
<h3><span class="mw-headline" id="Configuring_Nginx_proxy">Configuring Nginx proxy</span></h3>
<p>Copy the example <a href="../en/MinIO.html" title="MinIO">MinIO</a> and <b>Ente</b> server <a href="../en/Nginx.html" title="Nginx">Nginx</a> config and the accompanying  HTTP(S) security header config files to the <a href="../en/Nginx.html" title="Nginx">Nginx</a> configuration directory:
</p>
<pre># cp -v /usr/lib/ente-server/ente-server-nginx.conf /etc/nginx/
# cp -v /usr/lib/ente-server/http*security_headers.conf /etc/nginx/
# cp -v /usr/lib/ente-server/minio-server-nginx.conf /etc/nginx/
</pre>
<p>Edit this example config, and replace <i>your_public_domain.tld</i> with your actual public domain name
</p>
<p>Request a letsencrypt ceritifacte (or a SSL certificate from another provider) if not already done so:
</p>
<pre># certbot certonly --email <i>your_email</i> --agree-tos --preferred-challenge http --webroot -w /var/lib/letsencrypt -d <i>your_public_domain.tld</i>
</pre>
<p>Append an <code>include</code> statement to the <a href="../en/Nginx.html" title="Nginx">Nginx</a> <code>http</code> config to include the <i>ente-server</i> config:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/nginx/nginx.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">http {
    include /etc/nginx/ente-server-nginx.conf
}
</pre>
<p>Fix permissions:
</p>
<pre># chmod 644 /etc/nginx/ente-server-nginx.conf
# chmod 644 /etc/nginx/http*security_headers.conf
</pre>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">Restart</a> <code>nginx.service</code> to apply the changes.
</p>
<h3><span class="mw-headline" id="Configuring_ente-server_and_ente-cli">Configuring ente-server and ente-cli</span></h3>
<p>Install <code>ente-cli</code> on the client with the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ente-cli-bin/">ente-cli-bin</a></span><sup><small>AUR</small></sup> package. 
</p>
<p><br>
Add the <code>ente-cli</code> configuration on the client:
</p>
<pre>$ mkdir -p ~/.ente/export </pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.ente/config.yaml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">endpoint:
  api: "<i>https://your_public_domain.tld</i>" &gt;
</pre> 
<p><br>
Add a user account via the <b>Ente</b> photos mobile, desktop or web app on the client, using a custom endpoint.
</p>
<p>In the photos mobile app, click 7 times on the main screen to enable developers mode, then define your custom <b>Ente</b> server API endpoint: 
</p>
<pre>URL: <i>https://your_public_domain.tld</i>
</pre>
<p>In the web app on the client:
</p>
<pre>$ git clone <a rel="nofollow" class="external free" href="https://github.com/ente-io/ente.git">https://github.com/ente-io/ente.git</a>
$ cd ente/web
$ git submodule update --init --recursive
$ yarn install
$ NEXT_PUBLIC_ENTE_ENDPOINT=<i>https://your_public_domain.tld</i> yarn dev:photos</pre>
<p>When using the desktop app using the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ente-desktop-git/">ente-desktop-git</a></span><sup><small>AUR</small></sup> package, make sure you export the <code>NEXT_PUBLIC_ENTE_ENDPOINT</code> environment variable before building.
</p>
<p>Follow the photos mobile, desktop or web app (<i><a rel="nofollow" class="external free" href="http://localhost:3000">http://localhost:3000</a></i>) instructions to create a new user.
</p>
<p>Obtain the OTP code:
</p>
<ul>
<li>Via email:
<ul>
<li>Configure the <code>smtp</code> section in <code>/etc/ente-server/local.yaml</code>
</li>
<li>Make sure the configured <span class="plainlinks archwiki-template-man" title="$ man 1 smtp"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/smtp.1">smtp(1)</a></span> server is working</li>
<li>Wait for the mail to arrive and copy the OTP code</li>
</ul>
</li>
<li>Via the ente-server log:</li>
</ul>
<dl><dd><pre># journalctl -au ente-server | grep SendEmailOTT | tail -n 1</pre></dd></dl>
<p>Obtain the new users account ID: 
</p>
<pre># psql -U ente ente-server -c 'select user_id from users order by user_id desc limit 1;'
</pre>
<p>Configure this user as the admin:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ente-server/local.yaml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">internal:
     admin: [<i>ADD_USER_ID_HERE</i>]
</pre>
<p><br>
<a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">Restart</a> <code>ente-server.service</code> to activate the new admin privileges. 
</p>
<p>Configure this admin within <code>ente-cli</code> on the client:
</p>
<pre>$ ente account add
photos
~/.ente/export
<i>email_address_of_admin_account</i>
<i>password_of_admin_account</i>
</pre>
<h3><span class="mw-headline" id="Increasing_user_storage_and_account_expiry_limit">Increasing user storage and account expiry limit</span></h3>
<p>Use <i>ente-cli</i> to increase storage limit with 100 TB and expiry with 100 years:
</p>
<pre>$ ente admin update-subscription -u "<i>user@domain.tld</i>"
</pre>
<h3>
<span id=".28Optional.29_Copy_and_apply_AppArmor_profile"></span><span class="mw-headline" id="(Optional)_Copy_and_apply_AppArmor_profile">(Optional) Copy and apply AppArmor profile</span>
</h3>
<p>An <a href="../en/AppArmor.html" title="AppArmor">AppArmor</a> profile has been provided for those that wish to limit the access the <b>ente-server</b> binary has using <a href="../en/AppArmor.html" title="AppArmor">AppArmor</a>. Copy and apply this profile as follows (assuming that <a href="../en/AppArmor.html" title="AppArmor">AppArmor</a> has already been installed and enabled):
</p>
<pre> # install -Dvm600 -o root -g root /usr/lib/ente-server/usr.bin.ente-server -t /etc/apparmor.d/
 # aa-enforce /usr/bin/ente-server</pre>
<h3>
<span id=".28Optional.29_Configure_Firewall"></span><span class="mw-headline" id="(Optional)_Configure_Firewall">(Optional) Configure Firewall</span>
</h3>
<p>If a host firewall like iptables or nftables has been enabled and configured, make sure the following is allowed:
</p>
<ul>
<li>Traffic on <code>localhost</code>
</li>
<li>Traffic from your <b>Ente</b> (mobile) client to TCP port <code>443</code> to reach the <b>Ente</b> server via <a href="../en/Nginx.html" title="Nginx">Nginx</a>
</li>
<li>Traffic from your <b>Ente</b> (mobile) client to TCP port <code>3200</code> to reach the <a href="../en/MinIO.html" title="MinIO">MinIO</a> server via <a href="../en/Nginx.html" title="Nginx">Nginx</a>
</li>
</ul>
<h2><span class="mw-headline" id="Files">Files</span></h2>
<p>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ente-server-git/">ente-server-git</a></span><sup><small>AUR</small></sup> package contains the <span class="plainlinks archwiki-template-man" title="$ man 1 ente-server">ente-server(1)</span> <a href="../en/Man_page.html" title="Man page">man page</a> that lists and explains all files that are installed by this package.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li>Upstream Repository: <a rel="nofollow" class="external text" href="https://github.com/ente-io/ente/tree/main/server">ente.io Ente Server Repository</a>
</li></ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:File_sharing.html" title="Category:File sharing">File sharing</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Ente_server&amp;oldid=809494">https://wiki.archlinux.org/index.php?title=Ente_server&amp;oldid=809494</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 27 May 2024, at 20:00.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
