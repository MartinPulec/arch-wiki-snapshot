<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Icinga - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Icinga rootpage-Icinga skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Installation</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Icinga_Web_2" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Icinga_Web_2">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Icinga Web 2</div>
		</a>
		
			<button aria-controls="toc-Icinga_Web_2-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Icinga Web 2 subsection</span>
			</button>
		
		<ul id="toc-Icinga_Web_2-sublist" class="vector-toc-list">
			<li id="toc-Configure_web_server" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configure_web_server">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Configure web server</div>
			</a>
			
			<ul id="toc-Configure_web_server-sublist" class="vector-toc-list">
				<li id="toc-nginx" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#nginx">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.1</span>nginx</div>
			</a>
			
			<ul id="toc-nginx-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Apache" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Apache">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.2</span>Apache</div>
			</a>
			
			<ul id="toc-Apache-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Configure_PHP" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configure_PHP">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>Configure PHP</div>
			</a>
			
			<ul id="toc-Configure_PHP-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Configure_Icinga" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configure_Icinga">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Configure Icinga</div>
		</a>
		
			<button aria-controls="toc-Configure_Icinga-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configure Icinga subsection</span>
			</button>
		
		<ul id="toc-Configure_Icinga-sublist" class="vector-toc-list">
			<li id="toc-Automatically" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Automatically">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>Automatically</div>
			</a>
			
			<ul id="toc-Automatically-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Manually" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Manually">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>Manually</div>
			</a>
			
			<ul id="toc-Manually-sublist" class="vector-toc-list">
				<li id="toc-MariaDB" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#MariaDB">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.1</span>MariaDB</div>
			</a>
			
			<ul id="toc-MariaDB-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-PostgreSQL" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#PostgreSQL">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.2</span>PostgreSQL</div>
			</a>
			
			<ul id="toc-PostgreSQL-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Finally" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Finally">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.3</span>Finally</div>
			</a>
			
			<ul id="toc-Finally-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Upgrade_database" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Upgrade_database">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Upgrade database</div>
		</a>
		
		<ul id="toc-Upgrade_database-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Icinga</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 2 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-2" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">2 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-de mw-list-item"><a href="https://wiki.archlinux.de/title/Icinga" title="Icinga – Deutsch" lang="de" hreflang="de" class="interlanguage-link-target"><span>Deutsch</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Icinga" title="Icinga – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<p><a rel="nofollow" class="external text" href="https://icinga.com">Icinga</a> is an open source host, service and network monitoring program. It monitors specified hosts and services, alerting you to any developing issues, errors or improvements. This article describes the installation and configuration of Icinga.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/icinga2/">icinga2</a></span><sup><small>AUR</small></sup>.
</p>
<p>You may also want to install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=monitoring-plugins">monitoring-plugins</a></span>.
</p>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start/enable">Start/enable</a> the <code>icinga2.service</code>.
</p>
<h2><span class="mw-headline" id="Icinga_Web_2">Icinga Web 2</span></h2>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/icingaweb2/">icingaweb2</a></span><sup><small>AUR</small></sup> and optionally <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/icingaweb2-module-director/">icingaweb2-module-director</a></span><sup><small>AUR</small></sup>.
</p>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">Enable</a> the <code>icinga-director.service</code> if you installed the director module.
</p>
<h3><span class="mw-headline" id="Configure_web_server">Configure web server</span></h3>
<p>If you use php-fpm, you will have to <a href="../en/Systemd.html#Replacement_unit_files" class="mw-redirect" title="Override the unit">override the unit</a> - make sure to replace <code>php-fpm.service.d</code> with <code>php-fpm-legacy.service.d</code> if you use that:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/php-fpm.service.d/override_icingaweb2.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Service]
ReadWritePaths = /etc/icingaweb2</pre>
<p>You will also have to add your webserver to the group <code>icingaweb2</code> to be able to create and change configuration files from the web app directly, assuming <code>http</code> is the webserver user:
</p>
<pre># usermod -a -G icingaweb2 http
</pre>
<h4><span class="mw-headline" id="nginx">nginx</span></h4>
<p>Example server block, with php-legacy, the sock path in the example becomes <code>/run/php-fpm-legacy/php-fpm.sock</code> instead:
</p>
<pre>server {
	listen 80;
	listen [::]:80;
	server_name localhost;
	root /usr/share/webapps/icingaweb2/public;
	location ~ ^/icingaweb2/index\.php(.*)$ {
		fastcgi_pass unix:/run/php-fpm/php-fpm.sock;
		fastcgi_index index.php;
		include fastcgi_params;
		fastcgi_param SCRIPT_FILENAME /usr/share/webapps/icingaweb2/public/index.php;
		fastcgi_param ICINGAWEB_CONFIGDIR /etc/icingaweb2;
		fastcgi_param REMOTE_USER $remote_user;
	}
	location ~ ^/icingaweb2(.+)? {
		alias /usr/share/webapps/icingaweb2/public;
		index index.php;
		try_files $1 $uri $uri/ /icingaweb2/index.php$is_args$args;
	}
}
</pre>
<h4><span class="mw-headline" id="Apache">Apache</span></h4>
<p>If you get HTTP/503 errors, check in the configuration file to see if you are allowed to access the page:
</p>
<pre> Order allow,deny
 Allow from all
</pre>
<p>This has to be located in the <code>&lt;Directory "/usr/local/icinga-web/lib/ext3/"&gt;</code> and <code>&lt;Directory "/usr/local/icinga-web/pub/"&gt;</code> sections.
</p>
<h3><span class="mw-headline" id="Configure_PHP">Configure PHP</span></h3>
<p>Uncomment the following extensions: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/php/php.ini</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">curl
gettext
pdo_mysql - MariaDB setups
pdo_pgsql - PostgreSQL setups
pgsql - PostgreSQL setups
intl - Icinga Web 2
sockets - Director
</pre>
<p>If <code>open_basedir</code> is set in <code>php.ini</code>, you need to authorize <code>/usr/share/icinga-php</code> and you need to create <code>ICINGAWEB_LOCALEDIR</code> <a href="../en/Environment_variables.html" class="mw-redirect" title="Environment variable">environment variable</a> to <code>/usr/share/icinga-php/icinga-L10n/locale</code> to avoid an <code>open_basedir</code> error on <code>/usr/share/webapps/icingaweb2/library/Icinga/Application/ApplicationBootstrap.php</code> at line 740.
</p>
<h2><span class="mw-headline" id="Configure_Icinga">Configure Icinga</span></h2>
<p>You can choose either PostgreSQL or MariaDB to use as a backend for Icinga.
</p>
<p>By default Icinga uses the following files and directories:
</p>
<ul>
<li>
<code>/etc/icinga2</code> — Contains Icinga 2 configuration files.</li>
<li>
<code>/usr/sbin/icinga2*</code> — The Icinga 2 binary.</li>
<li>
<code>/usr/share/doc/icinga2</code> — Documentation files that come with Icinga 2.</li>
<li>
<code>/usr/share/icinga2/include</code> — The Icinga Template Library and plugin command configuration.</li>
<li>
<code>/var/run/icinga2</code> — PID file.</li>
<li>
<code>/var/run/icinga2/cmd</code> — Command pipe and Livestatus socket.</li>
<li>
<code>/var/cache/icinga2</code> — <code>status.dat</code>/<code>objects.cache</code>, <code>icinga2.debug</code> files</li>
<li>
<code>/var/spool/icinga2</code> — Used for performance data spool files.</li>
<li>
<code>/var/lib/icinga2</code> — Icinga 2 state file, cluster log, local CA and configuration files.</li>
<li>
<code>/var/log/icinga2</code> —	Log file location and compat/ directory for the CompatLogger feature.</li>
</ul>
<h3><span class="mw-headline" id="Automatically">Automatically</span></h3>
<p>Generate a setup token and let Icinga Web 2 handle it by using the setup page:
</p>
<pre># icingacli setup config directory --group icingaweb2;
# icingacli setup token create;
</pre>
<p><a rel="nofollow" class="external free" href="http://localhost/icingaweb2/setup">http://localhost/icingaweb2/setup</a>
</p>
<h3><span class="mw-headline" id="Manually">Manually</span></h3>
<p>In case you do not want to use Icinga Web 2 to configure everything for you.
</p>
<h4><span class="mw-headline" id="MariaDB">MariaDB</span></h4>
<p><a rel="nofollow" class="external free" href="https://icinga.com/docs/icinga-2/latest/doc/02-installation/">https://icinga.com/docs/icinga-2/latest/doc/02-installation/</a>
</p>
<p><a rel="nofollow" class="external free" href="https://icinga.com/docs/icinga-web/latest/doc/02-Installation/">https://icinga.com/docs/icinga-web/latest/doc/02-Installation/</a>
</p>
<p>Create icinga user and db:
</p>
<pre># mysql -u root -p
&gt; CREATE DATABASE icinga;
&gt; GRANT SELECT, INSERT, UPDATE, DELETE, DROP, CREATE VIEW, INDEX, EXECUTE ON icinga.* TO 'icinga'@'localhost' IDENTIFIED BY 'supersecretpassword';
&gt; quit
</pre>
<p>Create icingaweb2 user and db:
</p>
<pre># mysql -u root -p
&gt; CREATE DATABASE icingaweb2;
&gt; GRANT ALL ON icingaweb2.* TO 'icingaweb2'@'localhost' IDENTIFIED BY 'anothersecurepassword';
&gt; quit
</pre>
<p>Import the icinga schema:
</p>
<pre># mysql -u root -p icinga &lt; /usr/share/icinga2-ido-mysql/schema/mysql.sql
</pre>
<p>Import the icingaweb2 schema:
</p>
<pre># mysql -p icingaweb2 &lt; /usr/share/webapps/icingaweb2/etc/schema/mysql.schema.sql
</pre>
<p>Create director database and user:
</p>
<pre># mysql -u root -p
&gt; CREATE DATABASE director CHARACTER SET 'utf8';
&gt; CREATE USER director@localhost IDENTIFIED BY 'directorpassword';
&gt; GRANT ALL ON director.* TO director@localhost;
</pre>
<p>Create a user to login to Icinga Web 2:
</p>
<pre>$ php -r 'echo password_hash("yourwebpassword", PASSWORD_DEFAULT);'
</pre>
<p>Use the hash you got from the previous command, replacing the hash in this example to insert a new user into the database:
</p>
<pre># mysql -u root -p
&gt; USE icingaweb2;
&gt; INSERT INTO icingaweb_user (name, active, password_hash) VALUES ('icingaadmin', 1, '$2y$10$G.qLnALysvw3yr5wP70sF.KtlwB/xDYypRU3x2WZd6x3N0oBAXuIi');
</pre>
<p>Edit <code>/etc/icinga2/features-available/ido-mysql.conf</code> with your SQL details.
</p>
<p>Enable ido-mysql:
</p>
<pre># icinga2 feature enable ido-mysql
</pre>
<h4><span class="mw-headline" id="PostgreSQL">PostgreSQL</span></h4>
<p><a rel="nofollow" class="external free" href="https://icinga.com/docs/icinga2/latest/doc/02-installation/#installing-postgresql-database-server">https://icinga.com/docs/icinga2/latest/doc/02-installation/#installing-postgresql-database-server</a>
</p>
<p>As the postgres user, create icinga user and db:
</p>
<pre>[postgres]$ psql -c "CREATE ROLE icinga WITH LOGIN PASSWORD 'supersecretpassword'"
[postgres]$ createdb -O icinga -E UTF8 icinga
</pre>
<p>Create icingaweb2 user and db:
</p>
<pre>[postgres]$ psql -c "CREATE ROLE icingaweb2 WITH LOGIN PASSWORD 'anothersecurepassword'"
[postgres]$ createdb -O icingaweb2 -E UTF8 icingaweb2
</pre>
<p>Import the icinga schema:
</p>
<pre># psql -U icinga -d icinga &lt; /usr/share/icinga2-ido-pgsql/schema/pgsql.sql
</pre>
<p>Import the icingaweb2 schema:
</p>
<pre># psql -U icingaweb2 -d icingaweb2 &lt; /usr/share/webapps/icingaweb2/etc/schema/pgsql.schema.sql
</pre>
<p>Create director database and user:
</p>
<pre>[postgres]$ psql -q -c "CREATE DATABASE director WITH ENCODING 'UTF8';"
[postgres]$ psql director -q -c "CREATE USER director WITH PASSWORD 'directorpassword'; GRANT ALL PRIVILEGES ON DATABASE director TO director; CREATE EXTENSION pgcrypto;"
</pre>
<p>Create a user to login to Icinga Web 2:
</p>
<pre>$ php -r 'echo password_hash("yourwebpassword", PASSWORD_DEFAULT);'
</pre>
<p>Use the hash you got from the previous command, replacing the hash in this example to insert a new user into the database:
</p>
<pre>[postgres]$ psql -d icingaweb2
icingaweb2=# INSERT INTO icingaweb_user (name, active, password_hash) VALUES ('icingaadmin', 1, '$2y$10$G.qLnALysvw3yr5wP70sF.KtlwB/xDYypRU3x2WZd6x3N0oBAXuIi');
</pre>
<p>Edit <code>/etc/icinga2/features-available/ido-pgsql.conf</code> with your SQL details.
</p>
<p>Enable ido-pgsql:
</p>
<pre># icinga2 feature enable ido-pgsql
</pre>
<h4><span class="mw-headline" id="Finally">Finally</span></h4>
<p>Enable Icinga api:
</p>
<pre># icinga2 api setup
</pre>
<p>Enable director module and its dependencies:
</p>
<pre># icingacli module enable incubator
# icingacli module enable director
</pre>
<p>Create Director database schema:
</p>
<pre># icingacli director migration run --verbose
</pre>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">Restart</a> <code>icinga2.service</code> for the changes to apply.
</p>
<p>If you chose to use Icinga Web 2, create appropriate <i>.ini</i> files (Use <code>mysql</code> and <code>3306</code> for db and port if you use MariaDB):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/icingaweb2/authentication.ini</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[icingaweb2]
backend  = db
resource = icingaweb2</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/icingaweb2/resources.ini</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[icingaweb2]
type                = "db"
db                  = "pgsql"
host                = "localhost"
port                = "5432"
dbname              = "icingaweb2"
username            = "icingaweb2"
password            = "anothersecurepassword"

[icinga2]
type                = "db"
db                  = "pgsql"
host                = "localhost"
port                = "5432"
dbname              = "icinga"
username            = "icinga"
password            = "supersecretpassword"

[director]
type                = "db"
db                  = "pgsql"
host                = "localhost"
port                = "5432"
dbname              = "director"
username            = "director"
password            = "directorpassword"
charset             = "utf8"</pre>
<p>The following is the currently default config, the important non-default part is <code>config_resource</code>.
</p>
<p>One can instead generate this file through <a rel="nofollow" class="external free" href="http://localhost/icingaweb2/config/general">http://localhost/icingaweb2/config/general</a> instead.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/icingaweb2/config.ini</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[global]
show_stacktraces = "1"
show_application_state_messages = "1"
module_path = "/usr/share/webapps/icingaweb2/modules"
config_resource = "icingaweb2"

[security]
use_strict_csp = "0"

[logging]
log = "syslog"
level = "ERROR"
application = "icingaweb2"
facility = "user"</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/icingaweb2/roles.ini</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[admins]
users               = "icingaadmin"
permissions         = "*"</pre>
<p><br>
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/icingaweb2/modules/director/config.ini</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[db]
resource = "director"</pre>
<p>Go to <a rel="nofollow" class="external free" href="http://localhost/icingaweb2/">http://localhost/icingaweb2/</a> and try to login as 'icingaadmin' and your chosen password - if all works, you are done with the basic setup!
</p>
<h2><span class="mw-headline" id="Upgrade_database">Upgrade database</span></h2>
<p>New versions usually require an upgrade of the database. You can find the SQL upgrade scripts in the following folders:
</p>
<pre>/usr/share/icinga2-ido-mysql/schema/upgrade
/usr/share/icinga2-ido-pgsql/schema/upgrade
/usr/share/webapps/icingaweb2/schema/mysql-upgrades
/usr/share/webapps/icingaweb2/schema/pgsql-upgrades
</pre>
<p>To do the upgrade, <code>cd</code> into the appropriate folder as written above and import the schema, examples:
</p>
<pre># mysql -u root -p icinga &lt; ./2.8.1.sql
# mysql -u root -p icingaweb2 &lt; ./2.12.0.sql
# psql -U icinga -d icinga &lt; ./2.8.1.sql
# psql -U icingaweb2 -d icingaweb2 &lt; ./2.12.0.sql
</pre>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">Restart</a> <code>icinga2.service</code> for the changes to apply.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://icinga.com/docs/icinga2/latest/">Documentation</a> - Official documentation</li>
<li>
<a rel="nofollow" class="external text" href="https://www.monitoring-plugins.org/">monitoring-plugins</a> - Default plugins for Icinga and other monitoring applications</li>
<li>
<a rel="nofollow" class="external text" href="https://nagios-plugins.org/">Nagios Plugins</a> - The home of the legacy plugins</li>
<li><a href="https://en.wikipedia.org/wiki/Icinga" class="extiw" title="w:Icinga">Wikipedia article</a></li>
<li>
<a rel="nofollow" class="external text" href="https://exchange.nagios.org/">NagiosExchange</a> - Overview of plugins, addons, mailing lists for Icinga</li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Network_monitoring.html" title="Category:Network monitoring">Network monitoring</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Icinga&amp;oldid=797969">https://wiki.archlinux.org/index.php?title=Icinga&amp;oldid=797969</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 23 January 2024, at 09:37.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
