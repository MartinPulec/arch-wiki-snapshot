<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Swap on video RAM - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Swap_on_video_RAM rootpage-Swap_on_video_RAM skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-MTD_Kernel_Subsystem" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#MTD_Kernel_Subsystem">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>MTD Kernel Subsystem</div>
		</a>
		
			<button aria-controls="toc-MTD_Kernel_Subsystem-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle MTD Kernel Subsystem subsection</span>
			</button>
		
		<ul id="toc-MTD_Kernel_Subsystem-sublist" class="vector-toc-list">
			<li id="toc-Potential_benefits" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Potential_benefits">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1</span>Potential benefits</div>
			</a>
			
			<ul id="toc-Potential_benefits-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Pre-setup" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Pre-setup">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.2</span>Pre-setup</div>
			</a>
			
			<ul id="toc-Pre-setup-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Setup" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Setup">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.3</span>Setup</div>
			</a>
			
			<ul id="toc-Setup-sublist" class="vector-toc-list">
				<li id="toc-Xorg_driver_config" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Xorg_driver_config">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.3.1</span>Xorg driver config</div>
			</a>
			
			<ul id="toc-Xorg_driver_config-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Troubleshooting">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.4</span>Troubleshooting</div>
			</a>
			
			<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#See_also">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.5</span>See also</div>
			</a>
			
			<ul id="toc-See_also-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-FUSE_filesystem" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#FUSE_filesystem">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>FUSE filesystem</div>
		</a>
		
			<button aria-controls="toc-FUSE_filesystem-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle FUSE filesystem subsection</span>
			</button>
		
		<ul id="toc-FUSE_filesystem-sublist" class="vector-toc-list">
			<li id="toc-Setup_2" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Setup_2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Setup</div>
			</a>
			
			<ul id="toc-Setup_2-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Setting_swappiness" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Setting_swappiness">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>Setting swappiness</div>
			</a>
			
			<ul id="toc-Setting_swappiness-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Troubleshooting_2" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Troubleshooting_2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3</span>Troubleshooting</div>
			</a>
			
			<ul id="toc-Troubleshooting_2-sublist" class="vector-toc-list">
				<li id="toc-swapon:_/tmp/vram/swapfile:_skipping_-_it_appears_to_have_holes." class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#swapon:_/tmp/vram/swapfile:_skipping_-_it_appears_to_have_holes.">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.1</span>swapon: /tmp/vram/swapfile: skipping - it appears to have holes.</div>
			</a>
			
			<ul id="toc-swapon:_/tmp/vram/swapfile:_skipping_-_it_appears_to_have_holes.-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Complete_system_freeze_under_high_memory_pressure" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Complete_system_freeze_under_high_memory_pressure">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.2</span>Complete system freeze under high memory pressure</div>
			</a>
			
			<ul id="toc-Complete_system_freeze_under_high_memory_pressure-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-See_also_2" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#See_also_2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4</span>See also</div>
			</a>
			
			<ul id="toc-See_also_2-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Swap on video RAM</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 1 language">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-1" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">1 language</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/%E3%83%93%E3%83%87%E3%82%AA%E3%83%A1%E3%83%A2%E3%83%AA%E3%81%AB%E3%82%B9%E3%83%AF%E3%83%83%E3%83%97" title="ビデオメモリにスワップ – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/Swap.html" title="Swap">Swap</a></li>
<li><a href="../en/Improving_performance.html" title="Improving performance">Improving performance</a></li>
</ul>
</div>
<p>In the unlikely case that you have very little RAM and a surplus of video RAM, you can use the latter as swap.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="MTD_Kernel_Subsystem">MTD Kernel Subsystem</span></h2>
<h3><span class="mw-headline" id="Potential_benefits">Potential benefits</span></h3>
<p>A graphics card with GDDR<i>X</i> SDRAM or DDR SDRAM may be used as swap by using the MTD subsystem of the kernel. Systems with dedicated graphics memory of 256 MB or greater which also have limited amounts of system memory (DDR<i>X</i> SDRAM) may benefit the most from this type of setup.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> 
<ul>
<li>This will not work with binary drivers.</li>
<li>Unless your graphics driver can be made to use less ram than is detected, Xorg may crash when you try to use the same section of RAM to store textures as swap. Using a video driver that allows you to override videoram should increase stability.</li>
</ul>
</div>
<h3><span class="mw-headline" id="Pre-setup">Pre-setup</span></h3>
<p>You have to load the modules specifying the PCI address ranges that correspond to the RAM on your video card.
</p>
<p>To find the available memory ranges run the following command and look for the VGA compatible controller section (see the example below).
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ lspci -vvv</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">01:00.0 VGA compatible controller: NVIDIA Corporation GK104 [GeForce GTX 670] (rev a1) (prog-if 00 [VGA controller])
	Subsystem: ASUSTeK Computer Inc. Device 8405
	Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR- FastB2B- DisINTx-
	Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-
	Latency: 0
	Interrupt: pin A routed to IRQ 57
	Region 0: Memory at f5000000 (32-bit, non-prefetchable) [size=16M]
	Region 1: Memory at e8000000 (64-bit, prefetchable) [size=128M]
	Region 3: Memory at f0000000 (64-bit, prefetchable) [size=32M]
	Region 5: I/O ports at e000 [size=128]
	[virtual] Expansion ROM at f6000000 [disabled] [size=512K]
	Capabilities: &lt;access denied&gt;
	Kernel driver in use: nvidia
	Kernel modules: nouveau, nvidia</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Systems with multiple GPUs will likely have multiple entries here.</div>
<p>Of most potential benefit is a region that is prefetchable, 64-bit, and the largest in size.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The graphics card used above has 2 GB of GDDR5 SDRAM, though as indicated above the full amount is not exposed or listed by the command provided above.</div>
<p>A video card needs some of its memory to function, as such some calculations are needed. The offsets are easy to calculate as powers of 2. The card should use the beginning of the address range as a framebuffer for textures and such. However, if limited or as indicated in the beginning of this article, if two programs try to write to the same sectors, stability issues are likely to occur.
</p>
<p>As an example: For a total of 256 MB of graphics memory, the formula is 2^28 (two to the twenty-eighth power). Approximately 64 MB could be left for graphics memory and as such the start range for the swap usage of graphics memory would be calculated with the formula 2^26. 
</p>
<p>Using the numbers above, you can take the difference and determine a reasonable range for usage as swap memory.
leaving 2^24 (32M) for the normal function (less will work fine)
</p>
<h3><span class="mw-headline" id="Setup">Setup</span></h3>
<p>Configure the phram module (3.x kernels used the slram module):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/modprobe.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">options phram phram=VRAM,0xStartRange,0xUsedAmount</pre>
<p>Load the modules on boot:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modules-load.d/vramswap.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">phram
mtdblock
</pre> 
<p>Create a systemd service:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/lib/systemd/system/vramswap.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Swap on Video RAM

[Service]
Type=oneshot
ExecStart=/usr/bin/mkswap /dev/mtdblock0
ExecStart=/usr/bin/swapon /dev/mtdblock0 -p 10
ExecStop=/usr/bin/swapoff /dev/mtdblock0
RemainAfterExit=yes

[Install]
WantedBy=multi-user.target
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> If your computer has multiple <code>mtdblock</code> devices, use <code>cat /proc/mtd</code> to find the <code>mtdblock</code> with name VRAM.</div>
<h4><span class="mw-headline" id="Xorg_driver_config">Xorg driver config</span></h4>
<p>To keep X stable, your video driver needs to be told to use less than the detected videoram.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xorg.conf.d/vramswap.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "Device"
    Driver "radeon" # or whichever other driver you use
    VideoRam 32768
	#other stuff
EndSection</pre>
<p>The above example specifies that you use 32 MB of graphics memory.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Some drivers might take the number for videoram as being in MiB. See relevant manpages.</div>
<h3><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h3>
<p>The following command may help you getting the used swap in the different spaces like disk partitions, flash disks and possibly this example of the swap on video ram
</p>
<pre>swapon -s</pre>
<h3><span class="mw-headline" id="See_also">See also</span></h3>
<ul><li><a rel="nofollow" class="external text" href="http://www.linux-mtd.infradead.org">MTD website</a></li></ul>
<h2><span class="mw-headline" id="FUSE_filesystem">FUSE filesystem</span></h2>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Multiple users have reported this to cause system <a rel="nofollow" class="external text" href="https://github.com/Overv/vramfs/issues/3">freezes</a>, even with the fix in <a href="#Complete_system_freeze_under_high_memory_pressure">#Complete system freeze under high memory pressure</a>. Other GPU management processes or libraries may be swapped out, leading to nonrecoverable page faults.</div> 
<p>This method works on hardware with OpenCL support using a <a href="../en/FUSE.html" title="FUSE">FUSE</a> filesystem backing a swapfile. See <a href="../en/GPGPU.html" title="GPGPU">GPGPU</a> for more information.
</p>
<h3><span class="mw-headline" id="Setup_2">Setup</span></h3>
<p>First, install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/vramfs-git/">vramfs-git</a></span><sup><small>AUR</small></sup>.  
Then, create an empty directory as mount point (e.g <code>/tmp/vram</code>).  
</p>
<p>Now run the following commands to set up the <i>vramfs</i> and a swapfile.  
</p>
<pre># vramfs /tmp/vram 256MB -f # Substitute 256M with your target vramfs size
# mkswap -U clear --size 200M --file /tmp/vram/swapfile # Substitute 200 with your target swapspace size in MiB
</pre>
<p>Your <a href="../en/Swap.html" title="Swap">Swap</a> should now be ready. Run <code>swapon</code> to check.
</p>
<p>See <a href="../en/Swap.html#Swap_file" title="Swap">Swap#Swap file</a> for more information.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong>  This is not persistent and will be gone after a system reboot.</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong>  You can also use <code>/tmp/vram</code> as temporary storage, much like a <a href="../en/Tmpfs.html" title="Tmpfs">Tmpfs</a>.</div>
<h3><span class="mw-headline" id="Setting_swappiness">Setting swappiness</span></h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The following advice may not apply to your use case. You should always do the required due diligence and check how it applies to your particular configuration.</div>
<p>In the case of swap on VRAM, increasing swappiness <i>may</i> be a good idea. This is especially true when random I/O for the VRAM swapfile is significantly faster than random disk I/O, as the benefit of caching disk reads will outweigh the cost of swapping. For example, if your random disk I/O speed is the same as VRAM swap I/O, you should set swappiness to 100. If VRAM swap I/O is 2x faster than disk I/O, you should set swappiness to 133. See <a rel="nofollow" class="external text" href="https://docs.kernel.org/admin-guide/sysctl/vm.html?highlight=swappiness#swappiness">the kernel documentation</a> for how to calculate the swappiness value correctly.
</p>
<h3><span class="mw-headline" id="Troubleshooting_2">Troubleshooting</span></h3>
<h4>
<span id="swapon:_.2Ftmp.2Fvram.2Fswapfile:_skipping_-_it_appears_to_have_holes."></span><span class="mw-headline" id="swapon:_/tmp/vram/swapfile:_skipping_-_it_appears_to_have_holes.">swapon: /tmp/vram/swapfile: skipping - it appears to have holes.</span>
</h4>
<p>The swapfile created is not contiguous. A loop device can be set up to work around this issue.  
</p>
<pre># cd /tmp/vram
# LOOPDEV=$(losetup -f)
# truncate -s 4G swapfile # replace 4G with target swapspace size, has to be smaller than the allocated vramfs
# losetup $LOOPDEV swapfile
# mkswap $LOOPDEV
# swapon $LOOPDEV
</pre>
<h4><span class="mw-headline" id="Complete_system_freeze_under_high_memory_pressure">Complete system freeze under high memory pressure</span></h4>
<p>Sometimes, under very high memory pressure, the <code>vramfs</code> process itself may get swapped to the VRAM swap space. This causes a complete deadlock. A fix is to make the process unswappable via cgroups by launching it via a systemd file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/vramswap.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Set up swap in VRAM
After=default.target

[Service]
Type=oneshot
RemainAfterExit=yes
# Change /root/vramswap.sh to a path to a script that performs all the necessary setup
ExecStart=/root/vramswap.sh
TimeoutStartSec=0
# Prevent swapping
MemorySwapMax=0

[Install]
WantedBy=default.target
</pre>
<h3><span class="mw-headline" id="See_also_2">See also</span></h3>
<ul><li><a rel="nofollow" class="external text" href="https://github.com/Overv/vramfs"><i>vramfs</i> Github Repository</a></li></ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Graphics.html" title="Category:Graphics">Graphics</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Swap_on_video_RAM&amp;oldid=805162">https://wiki.archlinux.org/index.php?title=Swap_on_video_RAM&amp;oldid=805162</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 2 April 2024, at 12:18.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
