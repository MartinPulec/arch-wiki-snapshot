<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>systemd - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Systemd rootpage-Systemd skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Basic_systemctl_usage" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Basic_systemctl_usage">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Basic systemctl usage</div>
		</a>
		
			<button aria-controls="toc-Basic_systemctl_usage-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Basic systemctl usage subsection</span>
			</button>
		
		<ul id="toc-Basic_systemctl_usage-sublist" class="vector-toc-list">
			<li id="toc-Using_units" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Using_units">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1</span>Using units</div>
			</a>
			
			<ul id="toc-Using_units-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Power_management" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Power_management">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.2</span>Power management</div>
			</a>
			
			<ul id="toc-Power_management-sublist" class="vector-toc-list">
				<li id="toc-Soft_reboot" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Soft_reboot">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.2.1</span>Soft reboot</div>
			</a>
			
			<ul id="toc-Soft_reboot-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Writing_unit_files" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Writing_unit_files">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Writing unit files</div>
		</a>
		
			<button aria-controls="toc-Writing_unit_files-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Writing unit files subsection</span>
			</button>
		
		<ul id="toc-Writing_unit_files-sublist" class="vector-toc-list">
			<li id="toc-Handling_dependencies" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Handling_dependencies">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Handling dependencies</div>
			</a>
			
			<ul id="toc-Handling_dependencies-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Service_types" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Service_types">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>Service types</div>
			</a>
			
			<ul id="toc-Service_types-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Editing_provided_units" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Editing_provided_units">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3</span>Editing provided units</div>
			</a>
			
			<ul id="toc-Editing_provided_units-sublist" class="vector-toc-list">
				<li id="toc-Replacement_unit_files" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Replacement_unit_files">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.1</span>Replacement unit files</div>
			</a>
			
			<ul id="toc-Replacement_unit_files-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Drop-in_files" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Drop-in_files">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.2</span>Drop-in files</div>
			</a>
			
			<ul id="toc-Drop-in_files-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Revert_to_vendor_version" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Revert_to_vendor_version">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.3</span>Revert to vendor version</div>
			</a>
			
			<ul id="toc-Revert_to_vendor_version-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Examples" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Examples">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.4</span>Examples</div>
			</a>
			
			<ul id="toc-Examples-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Targets" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Targets">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Targets</div>
		</a>
		
			<button aria-controls="toc-Targets-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Targets subsection</span>
			</button>
		
		<ul id="toc-Targets-sublist" class="vector-toc-list">
			<li id="toc-Get_current_targets" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Get_current_targets">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>Get current targets</div>
			</a>
			
			<ul id="toc-Get_current_targets-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Create_custom_target" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Create_custom_target">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>Create custom target</div>
			</a>
			
			<ul id="toc-Create_custom_target-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Mapping_between_SysV_runlevels_and_systemd_targets" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Mapping_between_SysV_runlevels_and_systemd_targets">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3</span>Mapping between SysV runlevels and systemd targets</div>
			</a>
			
			<ul id="toc-Mapping_between_SysV_runlevels_and_systemd_targets-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Change_current_target" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Change_current_target">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.4</span>Change current target</div>
			</a>
			
			<ul id="toc-Change_current_target-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Change_default_target_to_boot_into" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Change_default_target_to_boot_into">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.5</span>Change default target to boot into</div>
			</a>
			
			<ul id="toc-Change_default_target_to_boot_into-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Default_target_order" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Default_target_order">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.6</span>Default target order</div>
			</a>
			
			<ul id="toc-Default_target_order-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-systemd_components" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#systemd_components">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>systemd components</div>
		</a>
		
			<button aria-controls="toc-systemd_components-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle systemd components subsection</span>
			</button>
		
		<ul id="toc-systemd_components-sublist" class="vector-toc-list">
			<li id="toc-systemd.mount_-_mounting" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#systemd.mount_-_mounting">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>systemd.mount - mounting</div>
			</a>
			
			<ul id="toc-systemd.mount_-_mounting-sublist" class="vector-toc-list">
				<li id="toc-GPT_partition_automounting" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#GPT_partition_automounting">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1.1</span>GPT partition automounting</div>
			</a>
			
			<ul id="toc-GPT_partition_automounting-sublist" class="vector-toc-list">
				<li id="toc-/var" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#/var">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1.1.1</span>/var</div>
			</a>
			
			<ul id="toc-/var-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
		</li>
		<li id="toc-systemd-sysvcompat" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#systemd-sysvcompat">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2</span>systemd-sysvcompat</div>
			</a>
			
			<ul id="toc-systemd-sysvcompat-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-systemd-tmpfiles_-_temporary_files" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#systemd-tmpfiles_-_temporary_files">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.3</span>systemd-tmpfiles - temporary files</div>
			</a>
			
			<ul id="toc-systemd-tmpfiles_-_temporary_files-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Drop-in_configuration_files" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Drop-in_configuration_files">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4</span>Drop-in configuration files</div>
			</a>
			
			<ul id="toc-Drop-in_configuration_files-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Tips_and_tricks" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Tips_and_tricks">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Tips and tricks</div>
		</a>
		
			<button aria-controls="toc-Tips_and_tricks-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Tips and tricks subsection</span>
			</button>
		
		<ul id="toc-Tips_and_tricks-sublist" class="vector-toc-list">
			<li id="toc-Socket_activation" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Socket_activation">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1</span>Socket activation</div>
			</a>
			
			<ul id="toc-Socket_activation-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-GUI_configuration_tools" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#GUI_configuration_tools">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2</span>GUI configuration tools</div>
			</a>
			
			<ul id="toc-GUI_configuration_tools-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Running_services_after_the_network_is_up" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Running_services_after_the_network_is_up">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.3</span>Running services after the network is up</div>
			</a>
			
			<ul id="toc-Running_services_after_the_network_is_up-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Enable_installed_units_by_default" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Enable_installed_units_by_default">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.4</span>Enable installed units by default</div>
			</a>
			
			<ul id="toc-Enable_installed_units_by_default-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Sandboxing_application_environments" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Sandboxing_application_environments">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.5</span>Sandboxing application environments</div>
			</a>
			
			<ul id="toc-Sandboxing_application_environments-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Notifying_about_failed_services" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Notifying_about_failed_services">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.6</span>Notifying about failed services</div>
			</a>
			
			<ul id="toc-Notifying_about_failed_services-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Automatically_turn_off_an_external_HDD_at_shutdown" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Automatically_turn_off_an_external_HDD_at_shutdown">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.7</span>Automatically turn off an external HDD at shutdown</div>
			</a>
			
			<ul id="toc-Automatically_turn_off_an_external_HDD_at_shutdown-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Troubleshooting">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>Troubleshooting</div>
		</a>
		
			<button aria-controls="toc-Troubleshooting-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Troubleshooting subsection</span>
			</button>
		
		<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
			<li id="toc-Investigating_failed_services" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Investigating_failed_services">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.1</span>Investigating failed services</div>
			</a>
			
			<ul id="toc-Investigating_failed_services-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Diagnosing_boot_problems" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Diagnosing_boot_problems">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.2</span>Diagnosing boot problems</div>
			</a>
			
			<ul id="toc-Diagnosing_boot_problems-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Diagnosing_a_service" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Diagnosing_a_service">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.3</span>Diagnosing a service</div>
			</a>
			
			<ul id="toc-Diagnosing_a_service-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Shutdown/reboot_takes_terribly_long" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Shutdown/reboot_takes_terribly_long">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.4</span>Shutdown/reboot takes terribly long</div>
			</a>
			
			<ul id="toc-Shutdown/reboot_takes_terribly_long-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Short_lived_processes_do_not_seem_to_log_any_output" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Short_lived_processes_do_not_seem_to_log_any_output">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.5</span>Short lived processes do not seem to log any output</div>
			</a>
			
			<ul id="toc-Short_lived_processes_do_not_seem_to_log_any_output-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Boot_time_increasing_over_time" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Boot_time_increasing_over_time">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.6</span>Boot time increasing over time</div>
			</a>
			
			<ul id="toc-Boot_time_increasing_over_time-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-systemd-tmpfiles-setup.service_fails_to_start_at_boot" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#systemd-tmpfiles-setup.service_fails_to_start_at_boot">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.7</span>systemd-tmpfiles-setup.service fails to start at boot</div>
			</a>
			
			<ul id="toc-systemd-tmpfiles-setup.service_fails_to_start_at_boot-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Disable_emergency_mode_on_remote_machine" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Disable_emergency_mode_on_remote_machine">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.8</span>Disable emergency mode on remote machine</div>
			</a>
			
			<ul id="toc-Disable_emergency_mode_on_remote_machine-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">7</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading">systemd</h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 9 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-9" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">9 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-de mw-list-item"><a href="https://wiki.archlinux.de/title/Systemd" title="Systemd – Deutsch" lang="de" hreflang="de" class="interlanguage-link-target"><span>Deutsch</span></a></li>
<li class="interlanguage-link interwiki-es mw-list-item"><a href="../es/Systemd.html" title="Systemd – español" lang="es" hreflang="es" class="interlanguage-link-target"><span>Español</span></a></li>
<li class="interlanguage-link interwiki-fi mw-list-item"><a href="../fi/Systemd.html" title="Systemd – suomi" lang="fi" hreflang="fi" class="interlanguage-link-target"><span>Suomi</span></a></li>
<li class="interlanguage-link interwiki-fr mw-list-item"><a href="../fr/Systemd.html" title="Systemd – français" lang="fr" hreflang="fr" class="interlanguage-link-target"><span>Français</span></a></li>
<li class="interlanguage-link interwiki-it mw-list-item"><a href="../it/Systemd.html" title="Systemd – italiano" lang="it" hreflang="it" class="interlanguage-link-target"><span>Italiano</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Systemd" title="Systemd – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-pt mw-list-item"><a href="../pt/Systemd.html" title="Systemd – português" lang="pt" hreflang="pt" class="interlanguage-link-target"><span>Português</span></a></li>
<li class="interlanguage-link interwiki-ru mw-list-item"><a href="../ru/Systemd.html" title="Systemd – русский" lang="ru" hreflang="ru" class="interlanguage-link-target"><span>Русский</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/Systemd" title="Systemd – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<p><span>
</span>
</p>
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/Systemd/User.html" title="Systemd/User">systemd/User</a></li>
<li><a href="../en/Systemd/Timers.html" title="Systemd/Timers">systemd/Timers</a></li>
<li><a href="../en/Systemd/Journal.html" title="Systemd/Journal">systemd/Journal</a></li>
<li><a href="../en/Systemd/FAQ.html" title="Systemd/FAQ">systemd/FAQ</a></li>
<li><a href="../en/Init.html" title="Init">init</a></li>
<li><a href="../en/Udev.html" title="Udev">udev</a></li>
<li><a href="../en/Improving_performance/Boot_process.html" title="Improving performance/Boot process">Improving performance/Boot process</a></li>
<li><a href="../en/Power_management.html#Allow_users_to_shutdown" class="mw-redirect" title="Allow users to shutdown">Allow users to shutdown</a></li>
</ul>
</div>
<p>From the <a rel="nofollow" class="external text" href="https://systemd.io/">project web page</a>:
</p>
<dl><dd>
<i>systemd</i> is a suite of basic building blocks for a Linux system. It provides a system and service manager that runs as PID 1 and starts the rest of the system. <i>systemd</i> provides aggressive parallelization capabilities, uses socket and <a href="../en/D-Bus.html" title="D-Bus">D-Bus</a> activation for starting services, offers on-demand starting of daemons, keeps track of processes using Linux <a href="../en/Cgroups.html" class="mw-redirect" title="Control groups">control groups</a>, maintains mount and automount points, and implements an elaborate transactional dependency-based service control logic. <i>systemd</i> supports SysV and LSB init scripts and works as a replacement for sysvinit. Other parts include a logging daemon, utilities to control basic system configuration like the hostname, date, locale, maintain a list of logged-in users and running containers and virtual machines, system accounts, runtime directories and settings, and daemons to manage simple network configuration, network time synchronization, log forwarding, and name resolution.</dd></dl>
<p>Historically, what systemd calls "service" was named <a href="https://en.wikipedia.org/wiki/Daemon_(computing)" class="extiw" title="wikipedia:Daemon (computing)">daemon</a>: any program that runs as a "background" process (without a terminal or user interface), commonly waiting for events to occur and offering services. A good example is a web server that waits for a request to deliver a page, or an ssh server waiting for someone trying to log in. While these are full featured applications, there are daemons whose work is not that visible. Daemons are for tasks like writing messages into a log file (e.g. <code>syslog</code>, <code>metalog</code>) or keeping your system time accurate (e.g. <a href="../en/Network_Time_Protocol_daemon.html" class="mw-redirect" title="Ntpd">ntpd</a>). For more information see <span class="plainlinks archwiki-template-man" title="$ man 7 daemon"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/daemon.7">daemon(7)</a></span>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> For a detailed explanation of why Arch moved to <i>systemd</i>, see <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?pid=1149530#p1149530">this forum post</a>.</div>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Basic_systemctl_usage">Basic systemctl usage</span></h2>
<p>The main command used to introspect and control <i>systemd</i> is <i>systemctl</i>. Some of its uses are examining the system state and managing the system and services. See <span class="plainlinks archwiki-template-man" title="$ man 1 systemctl"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemctl.1">systemctl(1)</a></span> for more details.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 
<ul>
<li>You can use all of the following <i>systemctl</i> commands with the <code>-H <i>user</i>@<i>host</i></code> switch to control a <i>systemd</i> instance on a remote machine. This will use <a href="../en/Secure_Shell.html" class="mw-redirect" title="SSH">SSH</a> to connect to the remote <i>systemd</i> instance.</li>
<li>
<a href="../en/KDE.html#Plasma" class="mw-redirect" title="Plasma">Plasma</a> users can install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=systemdgenie">systemdgenie</a></span> as a graphical frontend for <i>systemctl</i>. After installing, the module will be added under <i>System</i>.</li>
</ul>
</div>
<h3><span class="mw-headline" id="Using_units">Using units</span></h3>
<p>Units commonly include, but are not limited to, services (<i>.service</i>), mount points (<i>.mount</i>), devices (<i>.device</i>) and sockets (<i>.socket</i>).
</p>
<p>When using <i>systemctl</i>, you generally have to specify the complete name of the unit file, including its suffix, for example <code>sshd.socket</code>. There are however a few short forms when specifying the unit in the following <i>systemctl</i> commands:
</p>
<ul>
<li>If you do not specify the suffix, systemctl will assume <i>.service</i>. For example, <code>netctl</code> and <code>netctl.service</code> are equivalent.</li>
<li>Mount points will automatically be translated into the appropriate <i>.mount</i> unit. For example, specifying <code>/home</code> is equivalent to <code>home.mount</code>.</li>
<li>Similar to mount points, devices are automatically translated into the appropriate <i>.device</i> unit, therefore specifying <code>/dev/sda2</code> is equivalent to <code>dev-sda2.device</code>.</li>
</ul>
<p>See <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.unit"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.unit.5">systemd.unit(5)</a></span> for details.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Some unit names contain an <code>@</code> sign (e.g. <code>name@<i>string</i>.service</code>): this means that they are <a rel="nofollow" class="external text" href="https://0pointer.net/blog/projects/instances.html">instances</a> of a <i>template</i> unit, whose actual file name does not contain the <code><i>string</i></code> part (e.g. <code>name@.service</code>). <code><i>string</i></code> is called the <i>instance identifier</i>, and is similar to an argument that is passed to the template unit when called with the <i>systemctl</i> command: in the unit file it will substitute the <code>%i</code> specifier. To be more accurate, <i>before</i> trying to instantiate the <code>name@.<i>suffix</i></code> template unit, <i>systemd</i> will actually look for a unit with the exact <code>name@<i>string</i>.<i>suffix</i></code> file name, although by convention such a "clash" happens rarely, i.e. most unit files containing an <code>@</code> sign are meant to be templates. Also, if a template unit is called without an instance identifier, it will generally fail (except with certain <i>systemctl</i> commands, like <code>cat</code>).</div>
<p>The commands in the below table operate on <b>system units</b> since <code>--system</code> is the implied default for <i>systemctl</i>. To instead operate on <b>user units</b> (for the <i>calling user</i>), use <a href="../en/Systemd/User.html#How_it_works" class="mw-redirect" title="Systemctl --user">systemctl --user</a> without root privileges. See also <a href="../en/Systemd/User.html#Basic_setup" title="Systemd/User">systemd/User#Basic setup</a> to enable/disable user units for <i>all users</i>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 
<ul>
<li>Most commands also work if multiple units are specified, see <span class="plainlinks archwiki-template-man" title="$ man 1 systemctl"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemctl.1">systemctl(1)</a></span> for more information.</li>
<li>The <code>--now</code> switch can be used in conjunction with <code>enable</code>, <code>disable</code>, and <code>mask</code> to respectively start, stop, or mask the unit <i>immediately</i> rather than after rebooting.</li>
<li>A package may offer units for different purposes. If you just installed a package, <code>pacman -Qql <i>package</i> | grep -Fe .service -e .socket</code> can be used to check and find them.</li>
</ul>
</div>
<table class="wikitable">
<tbody>
<tr>
<th>Action</th>
<th>Command</th>
<th>Note
</th>
</tr>
<tr>
<th colspan="3">Analyzing the system state
</th>
</tr>
<tr>
<td><b>Show system status</b></td>
<td><code>systemctl status</code></td>
<td>
</td>
</tr>
<tr>
<td>
<b>List running</b> units</td>
<td>
<code>systemctl</code> or<br><code>systemctl list-units</code>
</td>
<td>
</td>
</tr>
<tr>
<td>
<b>List failed</b> units</td>
<td><code>systemctl --failed</code></td>
<td>
</td>
</tr>
<tr>
<td>
<b>List installed</b> unit files<sup>1</sup>
</td>
<td><code>systemctl list-unit-files</code></td>
<td>
</td>
</tr>
<tr>
<td>
<b>Show process status</b> for a PID</td>
<td><code>systemctl status <i>pid</i></code></td>
<td>
<a href="../en/Cgroups.html" title="Cgroups">cgroup slice</a>, memory and parent
</td>
</tr>
<tr>
<th colspan="3">Checking the unit status
</th>
</tr>
<tr>
<td>
<b>Show a manual page</b> associated with a unit</td>
<td><code>systemctl help <i>unit</i></code></td>
<td>as supported by the unit
</td>
</tr>
<tr>
<td>
<b>Status</b> of a unit</td>
<td><code>systemctl status <i>unit</i></code></td>
<td>including whether it is running or not
</td>
</tr>
<tr>
<td>
<b>Check</b> whether a unit is enabled</td>
<td><code>systemctl is-enabled <i>unit</i></code></td>
<td>
</td>
</tr>
<tr>
<th colspan="3">Starting, restarting, reloading a unit
</th>
</tr>
<tr>
<td>
<b>Start</b> a unit immediately</td>
<td>
<code>systemctl start <i>unit</i></code> as root</td>
<td>
</td>
</tr>
<tr>
<td>
<b>Stop</b> a unit immediately</td>
<td>
<code>systemctl stop <i>unit</i></code> as root</td>
<td>
</td>
</tr>
<tr>
<td>
<b>Restart</b> a unit</td>
<td>
<code>systemctl restart <i>unit</i></code> as root</td>
<td>
</td>
</tr>
<tr>
<td>
<b>Reload</b> a unit and its configuration</td>
<td>
<code>systemctl reload <i>unit</i></code> as root</td>
<td>
</td>
</tr>
<tr>
<td>
<b>Reload systemd manager</b> configuration<sup>2</sup>
</td>
<td>
<code>systemctl daemon-reload</code> as root</td>
<td>scan for new or changed units
</td>
</tr>
<tr>
<th colspan="3">Enabling a unit
</th>
</tr>
<tr>
<td>
<b>Enable</b> a unit to start automatically at boot</td>
<td>
<code>systemctl enable <i>unit</i></code> as root</td>
<td>
</td>
</tr>
<tr>
<td>
<b>Enable</b> a unit to start automatically at boot and <b>start</b> it immediately</td>
<td>
<code>systemctl enable --now <i>unit</i></code> as root</td>
<td>
</td>
</tr>
<tr>
<td>
<b>Disable</b> a unit to no longer start at boot</td>
<td>
<code>systemctl disable <i>unit</i></code> as root</td>
<td>
</td>
</tr>
<tr>
<td>
<b>Reenable</b> a unit<sup>3</sup>
</td>
<td>
<code>systemctl reenable <i>unit</i></code> as root</td>
<td>i.e. disable and enable anew
</td>
</tr>
<tr>
<th colspan="3">Masking a unit
</th>
</tr>
<tr>
<td>
<b>Mask</b> a unit to make it impossible to start<sup>4</sup>
</td>
<td>
<code>systemctl mask <i>unit</i></code> as root</td>
<td>
</td>
</tr>
<tr>
<td>
<b>Unmask</b> a unit</td>
<td>
<code>systemctl unmask <i>unit</i></code> as root</td>
<td>
</td>
</tr>
</tbody>
</table>
<ol>
<li>See <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.unit"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.unit.5#UNIT_FILE_LOAD_PATH">systemd.unit(5) § UNIT FILE LOAD PATH</a></span> for the directories where available unit files can be found.</li>
<li>This does not ask the changed units to reload their own configurations (see the <b>Reload</b> action).</li>
<li>For example, in case its <code>[Install]</code> section has changed since last enabling it.</li>
<li>Both manually and as a dependency, which makes masking dangerous. Check for existing masked units with: <pre>$ systemctl list-unit-files --state=masked</pre>
</li>
</ol>
<h3><span class="mw-headline" id="Power_management">Power management</span></h3>
<p><a href="../en/Polkit.html" title="Polkit">polkit</a> is necessary for power management as an unprivileged user. If you are in a local <i>systemd-logind</i> user session and no other session is active, the following commands will work without root privileges. If not (for example, because another user is logged into a tty), <i>systemd</i> will automatically ask you for the root password.
</p>
<table class="wikitable">
<tbody>
<tr>
<th>Action</th>
<th>Command
</th>
</tr>
<tr>
<td>Shut down and reboot the system</td>
<td>
<code>systemctl reboot</code>
</td>
</tr>
<tr>
<td>Shut down and power-off the system</td>
<td>
<code>systemctl poweroff</code>
</td>
</tr>
<tr>
<td>Suspend the system</td>
<td>
<code>systemctl suspend</code>
</td>
</tr>
<tr>
<td>Put the system into hibernation (write RAM to disk)</td>
<td>
<code>systemctl hibernate</code>
</td>
</tr>
<tr>
<td>Put the system into hybrid-sleep state (also called suspend-to-both, it saves RAM to disk and then suspends)</td>
<td>
<code>systemctl hybrid-sleep</code>
</td>
</tr>
<tr>
<td>First suspend the system, then wake up after a configured time in order to just hibernate the system</td>
<td>
<code>systemctl suspend-then-hibernate</code>
</td>
</tr>
<tr>
<td>Perform a reboot of the userspace-only with a <a href="#Soft_reboot">#Soft reboot</a>.</td>
<td>
<code>systemctl soft-reboot</code>
</td>
</tr>
</tbody>
</table>
<h4><span class="mw-headline" id="Soft_reboot">Soft reboot</span></h4>
<p>Soft reboot is a special kind of a userspace-only reboot operation that does not involve the kernel. It is implemented by <span class="plainlinks archwiki-template-man" title="$ man 8 systemd-soft-reboot.service"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-soft-reboot.service.8">systemd-soft-reboot.service(8)</a></span> and can be invoked through <code>systemctl soft-reboot</code>. As with <a href="../en/Kexec.html" title="Kexec">kexec</a>, it skips firmware re-initialization, but additionally the system does not go through kernel initialization and <a href="../en/Arch_boot_process.html#initramfs" class="mw-redirect" title="Initramfs">initramfs</a>, and unlocked <a href="../en/Dm-crypt.html" title="Dm-crypt">dm-crypt</a> devices remain attached.
</p>
<p>When <code>/run/nextroot/</code> contains a valid root file system hierarchy (e.g. is the root mount of another distribution or another snapshot), <i>soft-reboot</i> would switch the system root into it, allowing for switching to another installation without losing states managed by kernel, e.g. <a href="../en/Network_configuration.html" class="mw-redirect" title="Networking">networking</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> <code>/run/nextroot/</code> is not necessarily a mount point or backed by physical device. For example, it can reside in the <code>/run/</code> tmpfs. <i>systemd</i> will turn <code>/run/nextroot/</code> automatically into a mount point on <i>soft-reboot</i>.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Do not invoke <code>systemctl soft-reboot</code> after package updates that involved the kernel and initramfs.</div>
<h2><span class="mw-headline" id="Writing_unit_files">Writing unit files</span></h2>
<p>The syntax of <i>systemd'</i>s unit files (<span class="plainlinks archwiki-template-man" title="$ man 5 systemd.unit"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.unit.5">systemd.unit(5)</a></span>) is inspired by <a href="../en/Desktop_entries.html" title="Desktop entries">XDG Desktop Entry Specification .desktop files</a>, which are in turn inspired by <a href="https://en.wikipedia.org/wiki/INI_file" class="extiw" title="wikipedia:INI file">Microsoft Windows .ini files</a>. Unit files are loaded from multiple locations (to see the full list, run <code>systemctl show --property=UnitPath</code>), but the main ones are (listed from lowest to highest precedence):
</p>
<ul>
<li>
<code>/usr/lib/systemd/system/</code>: units provided by installed packages</li>
<li>
<code>/etc/systemd/system/</code>: units installed by the system administrator</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>The load paths are completely different when running <i>systemd</i> in <a href="../en/Systemd/User.html#How_it_works" title="Systemd/User">user mode</a>.</li>
<li>
<i>systemd</i> unit names may only contain ASCII alphanumeric characters, underscores and periods. All other characters must be replaced by C-style "\x2d" escapes, or employ their predefined semantics ('@', '-'). See <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.unit"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.unit.5">systemd.unit(5)</a></span> and <span class="plainlinks archwiki-template-man" title="$ man 1 systemd-escape"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-escape.1">systemd-escape(1)</a></span> for more information.</li>
</ul>
</div>
<p>Look at the units installed by your packages for examples, as well as <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.service"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.service.5#EXAMPLES">systemd.service(5) § EXAMPLES</a></span>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> Comments prepended with <code>#</code> may be used in unit-files as well, but only in new lines. Do not use end-line comments after <i>systemd</i> parameters or the unit will fail to activate.</div>
<p><span class="plainlinks archwiki-template-man" title="$ man 1 systemd-analyze"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-analyze.1">systemd-analyze(1)</a></span> can help verifying the work. See the <code>systemd-analyze verify FILE...</code> section of that page.
</p>
<h3><span class="mw-headline" id="Handling_dependencies">Handling dependencies</span></h3>
<p>With <i>systemd</i>, dependencies can be resolved by designing the unit files correctly. The most typical case is when unit <i>A</i> requires unit <i>B</i> to be running before <i>A</i> is started. In that case add <code>Requires=<i>B</i></code> and <code>After=<i>B</i></code> to the <code>[Unit]</code> section of <i>A</i>. If the dependency is optional, add <code>Wants=<i>B</i></code> and <code>After=<i>B</i></code> instead. Note that <code>Wants=</code> and <code>Requires=</code> do not imply <code>After=</code>, meaning that if <code>After=</code> is not specified, the two units will be started in parallel.
</p>
<p>Dependencies are typically placed on services and not on <a href="#Targets">#Targets</a>. For example, <code>network.target</code> is pulled in by whatever service configures your network interfaces, therefore ordering your custom unit after it is sufficient since <code>network.target</code> is started anyway.
</p>
<h3><span class="mw-headline" id="Service_types">Service types</span></h3>
<p>There are several different start-up types to consider when writing a custom service file. This is set with the <code>Type=</code> parameter in the <code>[Service]</code> section:
</p>
<ul>
<li>
<code>Type=simple</code> (default): <i>systemd</i> considers the service to be started up immediately. The process must not fork. Do not use this type if other services need to be ordered on this service, unless it is socket activated.</li>
<li>
<code>Type=forking</code>: <i>systemd</i> considers the service started up once the process forks and the parent has exited. For classic daemons, use this type unless you know that it is not necessary. You should specify <code>PIDFile=</code> as well so <i>systemd</i> can keep track of the main process.</li>
<li>
<code>Type=oneshot</code>: this is useful for scripts that do a single job and then exit. You may want to set <code>RemainAfterExit=yes</code> as well so that <i>systemd</i> still considers the service as active after the process has exited. Setting <code>RemainAfterExit=yes</code> is appropriate for the units which change the system state (e.g., mount some partition). See also <a rel="nofollow" class="external autonumber" href="https://trstringer.com/simple-vs-oneshot-systemd-service/">[1]</a> for the differences of simple and oneshot.</li>
<li>
<code>Type=notify</code>: identical to <code>Type=simple</code>, but with the stipulation that the daemon will send a signal to <i>systemd</i> when it is ready. The reference implementation for this notification is provided by <i>libsystemd-daemon.so</i>.</li>
<li>
<code>Type=dbus</code>: the service is considered ready when the specified <code>BusName</code> appears on DBus's system bus.</li>
<li>
<code>Type=idle</code>: <i>systemd</i> will delay execution of the service binary until all jobs are dispatched. Other than that behavior is very similar to <code>Type=simple</code>.</li>
</ul>
<p>See the <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.service"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.service.5#OPTIONS">systemd.service(5) § OPTIONS</a></span> man page for a more detailed explanation of the <code>Type</code> values.
</p>
<h3><span class="mw-headline" id="Editing_provided_units">Editing provided units</span></h3>
<p>To avoid conflicts with pacman, unit files provided by packages should not be directly edited. There are two safe ways to modify a unit without touching the original file: create a new unit file which <a href="#Replacement_unit_files">overrides the original unit</a> or create <a href="#Drop-in_files">drop-in snippets</a> which are applied on top of the original unit. For both methods, you must reload the unit afterwards to apply your changes. This can be done either by editing the unit with <code>systemctl edit</code> (which reloads the unit automatically) or by reloading all units with:
</p>
<pre># systemctl daemon-reload
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 
<ul>
<li>You can use <i>systemd-delta</i> to see which unit files have been overridden or extended and what exactly has been changed.</li>
<li>Use <code>systemctl cat <i>unit</i></code> to view the content of a unit file and all associated drop-in snippets.</li>
</ul>
</div>
<h4><span class="mw-headline" id="Replacement_unit_files">Replacement unit files</span></h4>
<p>To replace the unit file <code>/usr/lib/systemd/system/<i>unit</i></code>, create the file <code>/etc/systemd/system/<i>unit</i></code> and <a href="#Using_units">reenable</a> the unit to update the symlinks.
</p>
<p>Alternatively, run:
</p>
<pre># systemctl edit --full <i>unit</i>
</pre>
<p>This opens <code>/etc/systemd/system/<i>unit</i></code> in your editor (copying the installed version if it does not exist yet) and automatically reloads it when you finish editing.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The replacement units will keep on being used even if Pacman updates the original units in the future. This method makes system maintenance more difficult and therefore the next approach is preferred.</div>
<h4><span class="mw-headline" id="Drop-in_files">Drop-in files</span></h4>
<p>To create drop-in files for the unit file <code>/usr/lib/systemd/system/<i>unit</i></code>, create the directory <code>/etc/systemd/system/<i>unit</i>.d/</code> and place <i>.conf</i> files there to override or add new options. <i>systemd</i> will parse and apply these files on top of the original unit.
</p>
<p>The easiest way to do this is to run:
</p>
<pre># systemctl edit <i>unit</i> --drop-in=<i>drop_in_name</i>
</pre>
<p>This opens the file <code>/etc/systemd/system/<i>unit</i>.d/<i>drop_in_name</i>.conf</code> in your text editor (creating it if necessary) and automatically reloads the unit when you are done editing. Omitting <code>--drop-in=</code> option will result in systemd using the default file name <code>override.conf</code> .
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>The key must be still placed in the appropriate section in the override file.</li>
<li>Not all keys can be overridden with drop-in files. For example, for changing <code>Conflicts=</code> a replacement file <a rel="nofollow" class="external text" href="https://lists.freedesktop.org/archives/systemd-devel/2017-June/038976.html">is necessary</a>.</li>
</ul>
</div>
<h4><span class="mw-headline" id="Revert_to_vendor_version">Revert to vendor version</span></h4>
<p>To revert any changes to a unit made using <code>systemctl edit</code> do:
</p>
<pre># systemctl revert <i>unit</i>
</pre>
<h4><span class="mw-headline" id="Examples">Examples</span></h4>
<p>For example, if you simply want to add an additional dependency to a unit, you may create the following file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/<i>unit</i>.d/customdependency.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Requires=<i>new dependency</i>
After=<i>new dependency</i></pre>
<p>As another example, in order to replace the <code>ExecStart</code> directive, create the following file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/<i>unit</i>.d/customexec.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Service]
ExecStart=
ExecStart=<i>new command</i></pre>
<p>Note how <code>ExecStart</code> must be cleared before being re-assigned <a rel="nofollow" class="external autonumber" href="https://bugzilla.redhat.com/show_bug.cgi?id=756787#c9">[2]</a>. The same holds for every item that can be specified multiple times, e.g. <code>OnCalendar</code> for timers.
</p>
<p>One more example to automatically restart a service:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/<i>unit</i>.d/restart.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Service]
Restart=always
RestartSec=30</pre>
<h2><span class="mw-headline" id="Targets">Targets</span></h2>
<p><i>systemd</i> uses <i>targets</i> to group units together via dependencies and as standardized synchronization points. They serve a similar purpose as <a href="https://en.wikipedia.org/wiki/Runlevel" class="extiw" title="wikipedia:Runlevel">runlevels</a> but act a little differently. Each <i>target</i> is named instead of numbered and is intended to serve a specific purpose with the possibility of having multiple ones active at the same time. Some <i>target</i>s are implemented by inheriting all of the services of another <i>target</i> and adding additional services to it. There are <i>systemd</i> <i>target</i>s that mimic the common SystemVinit runlevels so you can still switch <i>target</i>s using the familiar <code>telinit RUNLEVEL</code> command.
</p>
<h3><span class="mw-headline" id="Get_current_targets">Get current targets</span></h3>
<p>The following should be used under <i>systemd</i> instead of running <code>runlevel</code>:
</p>
<pre>$ systemctl list-units --type=target
</pre>
<h3><span class="mw-headline" id="Create_custom_target">Create custom target</span></h3>
<p>The runlevels that held a defined meaning under sysvinit (i.e., 0, 1, 3, 5, and 6); have a 1:1 mapping with a specific <i>systemd</i> <i>target</i>. Unfortunately, there is no good way to do the same for the user-defined runlevels like 2 and 4. If you make use of those it is suggested that you make a new named <i>systemd</i> <i>target</i> as <code>/etc/systemd/system/<i>your target</i></code> that takes one of the existing runlevels as a base (you can look at <code>/usr/lib/systemd/system/graphical.target</code> as an example), make a directory <code>/etc/systemd/system/<i>your target</i>.wants</code>, and then symlink the additional services from <code>/usr/lib/systemd/system/</code> that you wish to enable.
</p>
<h3><span class="mw-headline" id="Mapping_between_SysV_runlevels_and_systemd_targets">Mapping between SysV runlevels and systemd targets</span></h3>
<table class="wikitable">
<tbody>
<tr>
<th>SysV Runlevel</th>
<th>systemd Target</th>
<th>Notes
</th>
</tr>
<tr>
<td>0</td>
<td>runlevel0.target, poweroff.target</td>
<td>Halt the system.
</td>
</tr>
<tr>
<td>1, s, single</td>
<td>runlevel1.target, rescue.target</td>
<td>Single user mode.
</td>
</tr>
<tr>
<td>2, 4</td>
<td>runlevel2.target, runlevel4.target, multi-user.target</td>
<td>User-defined/Site-specific runlevels. By default, identical to 3.
</td>
</tr>
<tr>
<td>3</td>
<td>runlevel3.target, multi-user.target</td>
<td>Multi-user, non-graphical. Users can usually login via multiple consoles or via the network.
</td>
</tr>
<tr>
<td>5</td>
<td>runlevel5.target, graphical.target</td>
<td>Multi-user, graphical. Usually has all the services of runlevel 3 plus a graphical login.
</td>
</tr>
<tr>
<td>6</td>
<td>runlevel6.target, reboot.target</td>
<td>Reboot
</td>
</tr>
<tr>
<td>emergency</td>
<td>emergency.target</td>
<td>Emergency shell
</td>
</tr>
</tbody>
</table>
<h3><span class="mw-headline" id="Change_current_target">Change current target</span></h3>
<p>In <i>systemd</i>, targets are exposed via <i>target units</i>. You can change them like this:
</p>
<pre># systemctl isolate graphical.target
</pre>
<p>This will only change the current target, and has no effect on the next boot. This is equivalent to commands such as <code>telinit 3</code> or <code>telinit 5</code> in Sysvinit.
</p>
<h3><span class="mw-headline" id="Change_default_target_to_boot_into">Change default target to boot into</span></h3>
<p>The standard target is <code>default.target</code>, which is a symlink to <code>graphical.target</code>. This roughly corresponds to the old runlevel 5.
</p>
<p>To verify the current target with <i>systemctl</i>:
</p>
<pre>$ systemctl get-default
</pre>
<p>To change the default target to boot into, change the <code>default.target</code> symlink. With <i>systemctl</i>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># systemctl set-default multi-user.target</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Removed /etc/systemd/system/default.target.
Created symlink /etc/systemd/system/default.target -&gt; /usr/lib/systemd/system/multi-user.target.</pre>
<p>Alternatively, append one of the following <a href="../en/Kernel_parameters.html" title="Kernel parameters">kernel parameters</a> to your boot loader:
</p>
<ul>
<li>
<code>systemd.unit=multi-user.target</code> (which roughly corresponds to the old runlevel 3),</li>
<li>
<code>systemd.unit=rescue.target</code> (which roughly corresponds to the old runlevel 1).</li>
</ul>
<h3><span class="mw-headline" id="Default_target_order">Default target order</span></h3>
<p><i>systemd</i> chooses the <code>default.target</code> according to the following order:
</p>
<ol>
<li>Kernel parameter shown above</li>
<li>Symlink of <code>/etc/systemd/system/default.target</code>
</li>
<li>Symlink of <code>/usr/lib/systemd/system/default.target</code>
</li>
</ol>
<h2><span class="mw-headline" id="systemd_components">systemd components</span></h2>
<p>Some (not exhaustive) components of <i>systemd</i> are:
</p>
<ul>
<li>
<a href="../en/Kernel-install.html" title="Kernel-install">kernel-install</a> — to automatically move <a href="../en/Kernel.html" title="Kernel">kernels</a> and their respective <a href="../en/Arch_boot_process.html#initramfs" class="mw-redirect" title="Initramfs">initramfs</a> images to the boot partition;</li>
<li>
<span class="plainlinks archwiki-template-man" title="$ man 1 systemd-analyze"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-analyze.1">systemd-analyze(1)</a></span> — may be used to determine boot-up performance,  statistics and retrieve other state and tracing information, and to verify the correctness of unit files. It is also used to access special functions useful for advanced debugging.</li>
<li>
<a href="../en/Systemd-boot.html" title="Systemd-boot">systemd-boot</a> — simple UEFI <a href="../en/Arch_boot_process.html#Boot_loader" class="mw-redirect" title="Boot manager">boot manager</a>;</li>
<li>
<a href="../en/Systemd-creds.html" title="Systemd-creds">systemd-creds</a> — to securely store and retrieve credentials used by systemd units;</li>
<li>
<a href="../en/Systemd-cryptenroll.html" title="Systemd-cryptenroll">systemd-cryptenroll</a> — Enroll PKCS#11, FIDO2, TPM2 token/devices to LUKS2 encrypted volumes;</li>
<li>
<a href="../en/Systemd-firstboot.html" title="Systemd-firstboot">systemd-firstboot</a> — basic system setting initialization before first boot;</li>
<li>
<a href="../en/Systemd-homed.html" title="Systemd-homed">systemd-homed</a> — portable human-user <a href="../en/Users_and_groups.html" title="Users and groups">accounts</a>;</li>
<li>
<span class="plainlinks archwiki-template-man" title="$ man 8 systemd-logind"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-logind.8">systemd-logind(8)</a></span> — <a rel="nofollow" class="external text" href="https://dvdhrm.wordpress.com/2013/08/24/session-management-on-linux/">session management</a>;</li>
<li>
<a href="../en/Systemd-networkd.html" title="Systemd-networkd">systemd-networkd</a> — <a href="../en/Network_configuration.html" title="Network configuration">network configuration</a> management;</li>
<li>
<a href="../en/Systemd-nspawn.html" title="Systemd-nspawn">systemd-nspawn</a> — light-weight namespace container;</li>
<li>
<a href="../en/Systemd-resolved.html" title="Systemd-resolved">systemd-resolved</a> — network <a href="../en/Domain_name_resolution.html" title="Domain name resolution">name resolution</a>;</li>
<li>
<span class="plainlinks archwiki-template-man" title="$ man 1 systemd-run"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-run.1">systemd-run(1)</a></span> / <span class="plainlinks archwiki-template-man" title="$ man 1 run0"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/run0.1">run0(1)</a></span> — Temporarily and interactively acquire elevated or different privileges.</li>
<li>
<span class="plainlinks archwiki-template-man" title="$ man 7 systemd-stub"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-stub.7">systemd-stub(7)</a></span> — a UEFI boot stub used for creating <a href="../en/Unified_kernel_image.html" title="Unified kernel image">unified kernel images</a>;</li>
<li>
<span class="plainlinks archwiki-template-man" title="$ man 8 systemd-sysusers"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-sysusers.8">systemd-sysusers(8)</a></span> — creates system users and groups and adds users to groups at package installation or boot time;</li>
<li>
<a href="../en/Systemd-timesyncd.html" title="Systemd-timesyncd">systemd-timesyncd</a> — <a href="../en/System_time.html" title="System time">system time</a> synchronization across the network;</li>
<li>
<a href="../en/Systemd/Journal.html" title="Systemd/Journal">systemd/Journal</a> — system logging;</li>
<li>
<a href="../en/Systemd/Timers.html" title="Systemd/Timers">systemd/Timers</a> — monotonic or realtime timers for controlling <i>.service</i> files or events, reasonable alternative to <a href="../en/Cron.html" title="Cron">cron</a>.</li>
</ul>
<h3><span class="mw-headline" id="systemd.mount_-_mounting">systemd.mount - mounting</span></h3>
<p><i>systemd</i> is in charge of mounting the partitions and filesystems specified in <code>/etc/fstab</code>. The <span class="plainlinks archwiki-template-man" title="$ man 8 systemd-fstab-generator"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-fstab-generator.8">systemd-fstab-generator(8)</a></span> translates all the entries in <code>/etc/fstab</code> into <i>systemd</i> units; this is performed at boot time and whenever the configuration of the system manager is reloaded.
</p>
<p><i>systemd</i> extends the usual <a href="../en/Fstab.html" title="Fstab">fstab</a> capabilities and offers additional mount options. These affect the dependencies of the mount unit. They can, for example, ensure that a mount is performed only once the network is up or only once another partition is mounted. The full list of specific <i>systemd</i> mount options, typically prefixed with <code>x-systemd.</code>, is detailed in <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.mount"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.mount.5#FSTAB">systemd.mount(5) § FSTAB</a></span>.
</p>
<p>An example of these mount options is <i>automounting</i>, which means mounting only when the resource is required rather than automatically at boot time. This is provided in <a href="../en/Fstab.html#Automount_with_systemd" title="Fstab">fstab#Automount with systemd</a>.
</p>
<h4><span class="mw-headline" id="GPT_partition_automounting">GPT partition automounting</span></h4>
<p>On UEFI-booted systems, if specific conditions are met, <span class="plainlinks archwiki-template-man" title="$ man 8 systemd-gpt-auto-generator"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-gpt-auto-generator.8">systemd-gpt-auto-generator(8)</a></span> will automount GPT partitions following the <a rel="nofollow" class="external text" href="https://uapi-group.org/specifications/specs/discoverable_partitions_specification/">Discoverable Partitions Specification</a>. Automounted partitions can thus be omitted from <a href="../en/Fstab.html" title="Fstab">fstab</a>, and if the root partition is automounted, then <code>root=</code> can be omitted from the kernel command line.
</p>
<p>The prerequisites are:
</p>
<ul>
<li>The boot loader must set the <a rel="nofollow" class="external text" href="https://systemd.io/BOOT_LOADER_INTERFACE/">LoaderDevicePartUUID</a> EFI variable, so that the used EFI system partition can be identified. This is supported by <a href="../en/Systemd-boot.html" title="Systemd-boot">systemd-boot</a>, <span class="plainlinks archwiki-template-man" title="$ man 7 systemd-stub"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-stub.7">systemd-stub(7)</a></span>, <a href="../en/GRUB.html" title="GRUB">GRUB</a> (with <i>grub-mkconfig</i> generated <code>grub.cfg</code>; custom <code>grub.cfg</code> requires <a href="../en/GRUB.html#LoaderDevicePartUUID" title="GRUB">loading the bli module</a>) and <a href="../en/REFInd.html#LoaderDevicePartUUID" title="REFInd">rEFInd (not enabled by default)</a>. This can be verified by running <code>bootctl</code> and checking the status of <code>Boot loader sets ESP information</code> or the status of <code>Stub sets ESP information</code> when booting via <a href="../en/Unified_kernel_image.html" title="Unified kernel image">Unified kernel images</a>.</li>
<li>The root partition must be on the same physical disk as the used EFI system partition. Other partitions that will be automounted must be on the same physical disk as the root partition. This basically means that all automounted partitions must share the same physical disk with the ESP.</li>
<li>The <code>/efi</code> mount point must be manually created (if desired), otherwise <code>systemd-gpt-auto-generator</code> will use <code>/boot</code>.</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Be very careful when creating <code>/efi</code> on an existing system when using GPT automounting. <code>/efi</code> will be used as the default mount point on the next boot, which might leave your system in an inconsistent state with an empty <code>/boot</code> directory. You will most likely need to reinstall your kernel(s) and/or microcode,  regenerate your initramfs, etc..</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> The automounting of a partition can be disabled by changing the partition's <a href="https://en.wikipedia.org/wiki/GUID_Partition_Table#Partition_type_GUIDs" class="extiw" title="wikipedia:GUID Partition Table">type GUID</a> or setting the partition attribute bit 63 "do not automount", see <a href="../en/GPT_fdisk.html#Prevent_GPT_partition_automounting" class="mw-redirect" title="Gdisk">gdisk#Prevent GPT partition automounting</a>.</div>
<h5>
<span id=".2Fvar"></span><span class="mw-headline" id="/var">/var</span>
</h5>
<p>For <code>/var</code> automounting to work, the PARTUUID must match the SHA256 HMAC hash of the partition type UUID (<code>4d21b016-b534-45c2-a9fb-5c16e091fd2d</code>) keyed by the machine ID. The required PARTUUID can be obtained using: 
</p>
<pre>$ systemd-id128 -u --app-specific=4d21b016-b534-45c2-a9fb-5c16e091fd2d machine-id
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> <span class="plainlinks archwiki-template-man" title="$ man 1 systemd-id128"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-id128.1">systemd-id128(1)</a></span> reads the machine ID from <code>/etc/machine-id</code>, this makes it impossible to know the needed PARTUUID before the system is installed.</div>
<h3><span class="mw-headline" id="systemd-sysvcompat">systemd-sysvcompat</span></h3>
<p>The primary role of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=systemd-sysvcompat">systemd-sysvcompat</a></span> (required by <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=base">base</a></span>) is to provide the traditional linux <a href="../en/Init.html" title="Init">init</a> binary. For <i>systemd</i>-controlled systems, <code>init</code> is just a symbolic link to its <code>systemd</code> executable.
</p>
<p>In addition, it provides four convenience shortcuts that <a href="../en/SysVinit.html" title="SysVinit">SysVinit</a> users might be used to. The convenience shortcuts are <span class="plainlinks archwiki-template-man" title="$ man 8 halt"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/halt.8">halt(8)</a></span>, <span class="plainlinks archwiki-template-man" title="$ man 8 poweroff"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/poweroff.8">poweroff(8)</a></span>, <span class="plainlinks archwiki-template-man" title="$ man 8 reboot"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/reboot.8">reboot(8)</a></span> and <span class="plainlinks archwiki-template-man" title="$ man 8 shutdown"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/shutdown.8">shutdown(8)</a></span>. Each one of those four commands is a symbolic link to <code>systemctl</code>, and is governed by <i>systemd</i> behavior. Therefore, the discussion at <a href="#Power_management">#Power management</a> applies.
</p>
<p><i>systemd</i>-based systems can give up those System V compatibility methods by using the <code>init=</code> <a href="../en/Kernel_parameters.html#Parameter_list" title="Kernel parameters">boot parameter</a> (see, for example, <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=233387">/bin/init is in systemd-sysvcompat ?</a>) and <i>systemd</i> native <code>systemctl</code> command arguments.
</p>
<h3><span class="mw-headline" id="systemd-tmpfiles_-_temporary_files">systemd-tmpfiles - temporary files</span></h3>
<p><i>systemd-tmpfiles</i> creates, deletes and cleans up volatile and temporary files and directories. It reads configuration files in <code>/etc/tmpfiles.d/</code> and <code>/usr/lib/tmpfiles.d/</code> to discover which actions to perform. Configuration files in the former directory take precedence over those in the latter directory.
</p>
<p>Configuration files are usually provided together with service files, and they are named in the style of <code>/usr/lib/tmpfiles.d/<i>program</i>.conf</code>. For example, the <a href="../en/Samba.html" title="Samba">Samba</a> daemon expects the directory <code>/run/samba</code> to exist and to have the correct permissions. Therefore, the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=samba">samba</a></span> package ships with this configuration:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/lib/tmpfiles.d/samba.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">D /run/samba 0755 root root
</pre>
<p>Configuration files may also be used to write values into certain files on boot. For example, if you used <code>/etc/rc.local</code> to disable wakeup from USB devices with <code>echo USBE &gt; /proc/acpi/wakeup</code>, you may use the following tmpfile instead:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/tmpfiles.d/disable-usb-wake.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#    Path                  Mode UID  GID  Age Argument
w    /proc/acpi/wakeup     -    -    -    -   USBE
</pre>
<p>It is possible to write multiple lines to the same file, either with <code>\n</code> in the argument or using the <code>w+</code> type on multiple lines (including the first one) for <i>appending</i>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/tmpfiles.d/disable-usb-wake.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#    Path                  Mode UID  GID  Age Argument
w+   /proc/acpi/wakeup     -    -    -    -   USBE
w+   /proc/acpi/wakeup     -    -    -    -   LID0
</pre>
<p>See the <span class="plainlinks archwiki-template-man" title="$ man 8 systemd-tmpfiles"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-tmpfiles.8">systemd-tmpfiles(8)</a></span> and <span class="plainlinks archwiki-template-man" title="$ man 5 tmpfiles.d"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/tmpfiles.d.5">tmpfiles.d(5)</a></span> man pages for details.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This method may not work to set options in <code>/sys</code> since the <i>systemd-tmpfiles-setup</i> service may run before the appropriate device modules are loaded. In this case, you could check whether the module has a parameter for the option you want to set with <code>modinfo <i>module</i></code> and set this option with a <a href="../en/Kernel_module.html#Setting_module_options" class="mw-redirect" title="Kernel modules">config file in /etc/modprobe.d</a>. Otherwise, you will have to write a <a href="../en/Udev.html#About_udev_rules" class="mw-redirect" title="Udev rule">udev rule</a> to set the appropriate attribute as soon as the device appears.</div>
<p><br>
</p>
<h3><span class="mw-headline" id="Drop-in_configuration_files">Drop-in configuration files</span></h3>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Inaccurate.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>The factual accuracy of this article or section is disputed.</b></p>
<div>
<b>Reason:</b> This page is about PID 1 (init), and unit drop-ins are already mentioned. Drop-in is a generic concept, plus other systemd components have their dedicated wiki pages. Therefore this section doesn't seem to belong here. (Discuss in <a href="../en/Talk:Systemd.html#YHNdnzj_:_Configuration_files_in_conf.d_/_drop-in_snippets:_misplaced?" title="Talk:Systemd">Talk:Systemd#YHNdnzj : Configuration files in conf.d / drop-in snippets: misplaced?</a>)</div>
</div>
<p>Configuration files provided by packages should not be directly edited to avoid conflicts with pacman updates. For this many (but not all) systemd packages provides a way to modify the configuration, but without touching the original file by creation of drop-in snippets, Check the package manual if drop-in configuration files are supported.
</p>
<p>To create drop-in configuration file for the unit file <code>/etc/systemd/<i>unit</i>.conf</code>, create the directory <code>/etc/systemd/<i>unit</i>.conf.d/</code> and place <i>.conf</i> files there to override or add new options. <i>systemd</i> will parse and apply these files on top of the original unit.
</p>
<p>Check the overall configuration:
</p>
<pre>$ systemd-analyze cat-config systemd/<i>unit</i>.conf
</pre>
<p>The applied drop-in snippets file(s) and content will be listed at the end. <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">Restart</a> the service for the changes to take effect.
</p>
<h2><span class="mw-headline" id="Tips_and_tricks">Tips and tricks</span></h2>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-view-fullscreen.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs expansion.</b></p>
<div>
<b>Reason:</b> We should document explicitly somewhere the benefits of socket activation over dumb service starting. This is mentioned briefly at the beginning of the page and in related pages like <a href="../en/Avahi.html" title="Avahi">Avahi</a>. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Systemd.html">Talk:Systemd</a>)</div>
</div>
<h3><span class="mw-headline" id="Socket_activation">Socket activation</span></h3>
<p>Some package provide a <i>.socket</i> unit. For example, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=cups">cups</a></span> provides a <code>cups.socket</code> unit<a rel="nofollow" class="external autonumber" href="https://0pointer.de/blog/projects/socket-activation2.html">[3]</a>. If <code>cups.socket</code> is <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">enabled</a> (and <code>cups.service</code> is left disabled), <i>systemd</i> will not start CUPS immediately; it will just listen to the appropriate sockets. Then, whenever a program attempts to connect to one of these CUPS sockets, <i>systemd</i> will start <code>cups.service</code> and transparently hand over control of these ports to the CUPS process.
</p>
<h3><span class="mw-headline" id="GUI_configuration_tools">GUI configuration tools</span></h3>
<ul><li>
<b>systemadm</b> — Graphical browser for <i>systemd</i> units. It can show the list of units, possibly filtered by type.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://cgit.freedesktop.org/systemd/systemd-ui/">https://cgit.freedesktop.org/systemd/systemd-ui/</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=systemd-ui">systemd-ui</a></span>
</dd></dl>
<ul><li>
<b>SystemdGenie</b> — <i>systemd</i> management utility based on KDE technologies.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://invent.kde.org/system/systemdgenie">https://invent.kde.org/system/systemdgenie</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=systemdgenie">systemdgenie</a></span>
</dd></dl>
<h3><span class="mw-headline" id="Running_services_after_the_network_is_up">Running services after the network is up</span></h3>
<p>To delay a service until after the network is up, include the following dependencies in the <i>.service</i> file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/<i>foo</i>.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
...
Wants=network-online.target
After=network-online.target
...</pre>
<p>The network wait service of the <a href="../en/Network_configuration.html#Network_managers" class="mw-redirect" title="Network manager">network manager</a> in use must also be enabled so that <code>network-online.target</code> properly reflects the network status.
</p>
<ul>
<li>If using <a href="../en/NetworkManager.html" title="NetworkManager">NetworkManager</a>, <code>NetworkManager-wait-online.service</code> should be enabled together with <code>NetworkManager.service</code>. Check if this is the case with <code>systemctl is-enabled NetworkManager-wait-online.service</code>. If it is not enabled, then <a href="#Using_units">reenable</a> <code>NetworkManager.service</code>.</li>
<li>In the case of <a href="../en/Netctl.html" title="Netctl">netctl</a>, <a href="#Using_units">enable</a> the <code>netctl-wait-online.service</code> (unless you are using <i>netctl-auto</i>; see <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/75836">FS#75836</a>).</li>
<li>If using <a href="../en/Systemd-networkd.html" title="Systemd-networkd">systemd-networkd</a>, <code>systemd-networkd-wait-online.service</code> should be enabled together with <code>systemd-networkd.service</code>. Check if this is the case with <code>systemctl is-enabled systemd-networkd-wait-online.service</code>. If it is not enabled, then <a href="#Using_units">reenable</a> <code>systemd-networkd.service</code>.</li>
</ul>
<p>For more detailed explanations, see the discussion in the <a rel="nofollow" class="external text" href="https://systemd.io/NETWORK_ONLINE/#discussion">Network configuration synchronization points</a>.
</p>
<p>If a service needs to perform DNS queries, it should additionally be ordered after <code>nss-lookup.target</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/<i>foo</i>.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
...
Wants=network-online.target
After=network-online.target nss-lookup.target
...</pre>
<p>See <span class="plainlinks archwiki-template-man" title="$ man 7 systemd.special"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.special.7#Special_Passive_System_Units">systemd.special(7) § Special Passive System Units</a></span>.
</p>
<p>For <code>nss-lookup.target</code> to have any effect it needs a service that pulls it in via <code>Wants=nss-lookup.target</code> and orders itself before it with <code>Before=nss-lookup.target</code>. Typically this is done by local <a href="../en/Domain_name_resolution.html#DNS_servers" class="mw-redirect" title="DNS resolver">DNS resolvers</a>.
</p>
<p>Check which active service, if any, is pulling in <code>nss-lookup.target</code> with:
</p>
<pre>$ systemctl list-dependencies --reverse nss-lookup.target
</pre>
<h3><span class="mw-headline" id="Enable_installed_units_by_default">Enable installed units by default</span></h3>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-view-fullscreen.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs expansion.</b></p>
<div>
<b>Reason:</b> How does it work with instantiated units? (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Systemd.html">Talk:Systemd</a>)</div>
</div>
<p>Arch Linux ships with <code>/usr/lib/systemd/system-preset/99-default.preset</code> containing <code>disable *</code>. This causes <i>systemctl preset</i> to disable all units by default, such that when a new package is installed, the user must manually enable the unit.
</p>
<p>If this behavior is not desired, simply create a symlink from <code>/etc/systemd/system-preset/99-default.preset</code> to <code>/dev/null</code> in order to override the configuration file. This will cause <i>systemctl preset</i> to enable all units that get installed—regardless of unit type—unless specified in another file in one <i>systemctl preset'</i>s configuration directories. User units are not affected. See <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.preset"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.preset.5">systemd.preset(5)</a></span> for more information.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Enabling all units by default may cause problems with packages that contain two or more mutually exclusive units. <i>systemctl preset</i> is designed to be used by distributions and spins or system administrators. In the case where two conflicting units would be enabled, you should explicitly specify which one is to be disabled in a preset configuration file as specified in the <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.preset"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.preset.5">systemd.preset(5)</a></span> man page.</div>
<h3><span class="mw-headline" id="Sandboxing_application_environments">Sandboxing application environments</span></h3>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-go-next.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section is a candidate for moving to <a href="/index.php?title=Systemd/Sandboxing&amp;action=edit&amp;redlink=1" class="new" title="Systemd/Sandboxing (page does not exist)">systemd/Sandboxing</a>.</b></p>
<div>
<b>Notes:</b> The topic is broad enough for a dedicated page. See <a href="../User:NetSysFire/systemd_sandboxing.html" title="User:NetSysFire/systemd sandboxing">User:NetSysFire/systemd sandboxing</a> for a proposed draft. (Discuss in <a href="../en/Talk:Security.html#systemd_unit_hardening_and_system.conf_tweaks" title="Talk:Security">Talk:Security#systemd unit hardening and system.conf tweaks</a>)</div>
</div>
<p>A unit file can be created as a sandbox to isolate applications and their processes within a hardened virtual environment. <i>systemd</i> leverages <a href="https://en.wikipedia.org/wiki/Linux_namespaces" class="extiw" title="wikipedia:Linux namespaces">namespaces</a>, a list of allowed/denied <a href="../en/Capabilities.html" title="Capabilities">capabilities</a>, and <a href="../en/Cgroups.html" class="mw-redirect" title="Control groups">control groups</a> to container processes through an extensive execution environment configuration—<span class="plainlinks archwiki-template-man" title="$ man 5 systemd.exec"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.exec.5">systemd.exec(5)</a></span>.
</p>
<p>The enhancement of an existing <i>systemd</i> unit file with application sandboxing typically requires trial-and-error tests accompanied by the generous use of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=strace">strace</a></span>, <a href="https://en.wikipedia.org/wiki/Standard_streams#Standard_error_.28stderr.29" class="extiw" title="wikipedia:Standard streams">stderr</a> and <span class="plainlinks archwiki-template-man" title="$ man 1 journalctl"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/journalctl.1">journalctl(1)</a></span> error logging and output facilities. You may want to first search upstream documentation for already done tests to base trials on. To get a starting point for possible hardening options, run 
</p>
<pre>$ systemd-analyze security <i>unit</i>
</pre>
<p>Some examples of how sandboxing with <i>systemd</i> can be deployed:
</p>
<ul><li>
<code>CapabilityBoundingSet</code> defines a list of <span class="plainlinks archwiki-template-man" title="$ man 7 capabilities"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/capabilities.7">capabilities(7)</a></span> that are allowed or denied for a unit. See <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.exec"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.exec.5#CAPABILITIES">systemd.exec(5) § CAPABILITIES</a></span>.
<ul><li>The <code>CAP_SYS_ADM</code> capability, for example, which should be one of the <a rel="nofollow" class="external text" href="https://lwn.net/Articles/486306/">goals of a secure sandbox</a>: <code>CapabilityBoundingSet=~ CAP_SYS_ADM</code>
</li></ul>
</li></ul>
<h3><span class="mw-headline" id="Notifying_about_failed_services">Notifying about failed services</span></h3>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Merge-arrows-2.svg" decoding="async" width="36" height="40" class="mw-file-element"></span></span><b>This article or section is a candidate for merging with <a href="../en/Systemd/Timers.html#MAILTO" title="Systemd/Timers">systemd/Timers#MAILTO</a>.</b></p>
<div>
<b>Notes:</b> Same topic, different solution. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Systemd.html">Talk:Systemd</a>)</div>
</div>
<p>In order to notify about service failures, a <code>OnFailure=</code> directive needs to be added to the according service file, for example by using a <a href="#Drop-in_files">drop-in configuration file</a>. Adding this directive to every service unit can be achieved with a top-level drop-in configuration file. For details about top-level drop-ins, see <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.unit"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.unit.5">systemd.unit(5)</a></span>.
</p>
<p>Create a top-level drop-in for services:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/service.d/toplevel-override.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
OnFailure=failure-notification@%n</pre>
<p>This adds <code>OnFailure=failure-notification@%n</code> to every service file. If <i>some_service_unit</i> fails, <code>failure-notification@<i>some_service_unit</i></code> will be started to handle the notification delivery (or whatever task it is configured to perform).
</p>
<p>Create the <code>failure-notification@</code> template unit:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/failure-notification@.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Send a notification about a failed systemd unit
After=network.target

[Service]
Type=simple
ExecStart=/<i>path</i>/<i>to</i>/failure-notification.sh %i</pre>
<p>You can create the <code>failure-notification.sh</code> script and define what to do or how to notify (mail, gotify, xmpp, etc.). The <code>%i</code> will be the name of the failed service unit and will be passed as argument to the script.
</p>
<p>In order to prevent a recursion for starting instances of <code>failure-notification@.service</code> again and again if the start fails, create an empty drop-in configuration file with the same name as the top-level drop-in (the empty service-level drop-in configuration file takes precedence over the top-level drop-in and overrides the latter one):
</p>
<pre># mkdir -p /etc/systemd/system/failure-notification@.service.d
# touch /etc/systemd/system/failure-notification@.service.d/toplevel-override.conf
</pre>
<h3><span class="mw-headline" id="Automatically_turn_off_an_external_HDD_at_shutdown">Automatically turn off an external HDD at shutdown</span></h3>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Merge-arrows-2.svg" decoding="async" width="36" height="40" class="mw-file-element"></span></span><b>This article or section is a candidate for merging with <a href="../en/Udisks.html#Troubleshooting" title="Udisks">Udisks#Troubleshooting</a>.</b></p>
<div>
<b>Notes:</b> This is mainly centered around <a href="../en/Udisks.html" title="Udisks">udisks</a> usage, it is probably a better fit for this content instead of shoving it inside the systemd page. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Systemd.html">Talk:Systemd</a>)</div>
</div>
<p>If an external HDD is not powered off properly at system shutdown, it may be desirable to fix the issue. The most convenient way to do this is using <a href="../en/Udisks.html" title="Udisks">udisks</a>.
</p>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">Enable</a> <code>udisks2.service</code>.
</p>
<p>A service to invoke our script might look like so:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/handle_external_hdds.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Requires=udisks2.service
Requires=graphical.target
After=graphical.target
[Service]
Type=oneshot
RemainAfterExit=yes
ExecStop=/usr/local/bin/handle_external_hdds.sh
[Install]
WantedBy=graphical.target</pre>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">Enable</a> <code>handle_external_hdds.service</code>
</p>
<p>Do a systemd <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Daemon-reload">daemon-reload</a> to apply the new setting. 
</p>
<p>Reboot or restart <code>graphical.target</code> to check if works.
</p>
<p>An example script to handle an arbitrary amount of partitions on a single disk looks like so:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/local/bin/handle_external_hdds.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash -u

declare -a uuids=(<i>uuid_list</i>)

# Only proceed if the drive is present.
if [[ ! -L "/dev/disk/by-uuid/${uuids[0]}" ]]; then
  exit 0
fi

for uuid in "${uuids[@]}"; do
  if findmnt "/dev/disk/by-uuid/$uuid"; then
    umount "/dev/disk/by-uuid/$uuid"
  fi
done

# udisksctl powers off proper drive even if its partition is supplied
udisksctl power-off -b "/dev/disk/by-uuid/${uuids[0]}"</pre>
<p><i>uuid_list</i> is a list of space delimited UUIDs corresponding to partitions of the device to check, e.g. <code>"<i>uuid_1</i>" "<i>uuid_2</i>"</code>.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="Investigating_failed_services">Investigating failed services</span></h3>
<p>To find the <i>systemd</i> services which failed to start:
</p>
<pre>$ systemctl --state=failed
</pre>
<p>To find out why they failed, examine their log output. See <a href="../en/Systemd/Journal.html#Filtering_output" title="Systemd/Journal">systemd/Journal#Filtering output</a> for details.
</p>
<h3><span class="mw-headline" id="Diagnosing_boot_problems">Diagnosing boot problems</span></h3>
<p><i>systemd</i> has several options for diagnosing problems with the boot process. See <a href="../en/General_troubleshooting.html#Boot_problems" class="mw-redirect" title="Boot debugging">boot debugging</a> for more general instructions and options to capture boot messages before <i>systemd</i> takes over the <a href="../en/Arch_boot_process.html" class="mw-redirect" title="Boot process">boot process</a>. Also see <a rel="nofollow" class="external text" href="https://systemd.io/DEBUGGING/">systemd debugging documentation</a>.
</p>
<h3><span class="mw-headline" id="Diagnosing_a_service">Diagnosing a service</span></h3>
<p>If some <i>systemd</i> service misbehaves or you want to get more information about what is happening, set the <code>SYSTEMD_LOG_LEVEL</code> <a href="../en/Environment_variables.html" class="mw-redirect" title="Environment variable">environment variable</a> to <code>debug</code>. For example, to run the <i>systemd-networkd</i> daemon in debug mode:
</p>
<p>Add a <a href="#Drop-in_files">drop-in file</a> for the service adding the two lines:
</p>
<pre>[Service]
Environment=SYSTEMD_LOG_LEVEL=debug
</pre>
<p>Or equivalently, set the environment variable manually:
</p>
<pre># SYSTEMD_LOG_LEVEL=debug /lib/systemd/systemd-networkd
</pre>
<p>then <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">restart</a> <i>systemd-networkd</i> and watch the journal for the service with the <code>-f</code>/<code>--follow</code> option.
</p>
<h3>
<span id="Shutdown.2Freboot_takes_terribly_long"></span><span class="mw-headline" id="Shutdown/reboot_takes_terribly_long">Shutdown/reboot takes terribly long</span>
</h3>
<p>If the shutdown process takes a very long time (or seems to freeze), most likely a service not exiting is to blame. <i>systemd</i> waits some time for each service to exit before trying to kill it. To find out whether you are affected, see <a rel="nofollow" class="external text" href="https://systemd.io/DEBUGGING/#shutdown-completes-eventually">Shutdown completes eventually</a> in the <i>systemd</i> documentation.
</p>
<p>A common problem is a stalled shutdown or suspend process. To verify whether that is the case, you could run either of these commands and check the outputs
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># systemctl poweroff
</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Failed to power off system via logind: There's already a shutdown or sleep operation in progress
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># systemctl list-jobs
</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">  JOB UNIT                    TYPE  STATE  
...
21593 systemd-suspend.service start running
21592 suspend.target          start waiting
..
</pre>
<p>The <a rel="nofollow" class="external text" href="https://unix.stackexchange.com/a/579531">solution</a> to this would be to cancel these jobs by running
</p>
<pre># systemctl cancel
# systemctl stop systemd-suspend.service
</pre>
<p>and then trying shutdown or reboot again.
</p>
<h3><span class="mw-headline" id="Short_lived_processes_do_not_seem_to_log_any_output">Short lived processes do not seem to log any output</span></h3>
<p>If running <code>journalctl -u foounit</code> as root does not show any output for a short lived service, look at the PID instead. For example, if <code>systemd-modules-load.service</code> fails, and <code>systemctl status systemd-modules-load</code> shows that it ran as PID 123, then you might be able to see output in the journal for that PID, i.e. by running <code>journalctl -b _PID=123</code> as root. Metadata fields for the journal such as <code>_SYSTEMD_UNIT</code> and <code>_COMM</code> are collected asynchronously and rely on the <code>/proc</code> directory for the process existing. Fixing this requires fixing the kernel to provide this data via a socket connection, similar to <code>SCM_CREDENTIALS</code>. In short, it is a <a rel="nofollow" class="external text" href="https://github.com/systemd/systemd/issues/2913">bug</a>. Keep in mind that immediately failed services might not print anything to the journal as per design of <i>systemd</i>.
</p>
<h3><span class="mw-headline" id="Boot_time_increasing_over_time">Boot time increasing over time</span></h3>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Inaccurate.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>The factual accuracy of this article or section is disputed.</b></p>
<div>
<b>Reason:</b> NetworkManager issues are not <i>systemd</i>'s fault, the alleged reports are missing. Slow <code>systemctl status</code> or <code>journalctl</code> do not affect boot time. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Systemd.html">Talk:Systemd</a>)</div>
</div>
<p>After using <code>systemd-analyze</code> a number of users have noticed that their boot time has increased significantly in comparison with what it used to be. After using <code>systemd-analyze blame</code> <a href="../en/NetworkManager.html" title="NetworkManager">NetworkManager</a> is being reported as taking an unusually large amount of time to start. 
</p>
<p>The problem for some users has been due to <code>/var/log/journal</code> becoming too large. This may have other impacts on performance, such as for <code>systemctl status</code> or <code>journalctl</code>. As such the solution is to remove every file within the folder (ideally making a backup of it somewhere, at least temporarily) and then setting a journal file size limit as described in <a href="../en/Systemd/Journal.html#Journal_size_limit" title="Systemd/Journal">Systemd/Journal#Journal size limit</a>.
</p>
<h3><span class="mw-headline" id="systemd-tmpfiles-setup.service_fails_to_start_at_boot">systemd-tmpfiles-setup.service fails to start at boot</span></h3>
<p>Starting with <i>systemd</i> 219, <code>/usr/lib/tmpfiles.d/systemd.conf</code> specifies ACL attributes for directories under <code>/var/log/journal</code> and, therefore, requires ACL support to be enabled for the filesystem the journal resides on.
</p>
<p>See <a href="../en/Access_Control_Lists.html#Enable_ACL" title="Access Control Lists">Access Control Lists#Enable ACL</a> for instructions on how to enable ACL on the filesystem that houses <code>/var/log/journal</code>.
</p>
<h3><span class="mw-headline" id="Disable_emergency_mode_on_remote_machine">Disable emergency mode on remote machine</span></h3>
<p>You may want to disable emergency mode on a remote machine, for example, a virtual machine hosted at Azure or Google Cloud. It is because if emergency mode is triggered, the machine will be blocked from connecting to network.
</p>
<p>To disable it, <a href="#Using_units">mask</a> <code>emergency.service</code> and <code>emergency.target</code>.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/systemd" class="extiw" title="wikipedia:systemd">Wikipedia:systemd</a></li>
<li>
<a rel="nofollow" class="external text" href="https://systemd.io/">Official web site</a>
<ul>
<li><a rel="nofollow" class="external text" href="https://systemd.io/OPTIMIZATIONS/">systemd optimizations</a></li>
<li><a rel="nofollow" class="external text" href="https://systemd.io/FAQ/">systemd FAQ</a></li>
<li><a rel="nofollow" class="external text" href="https://systemd.io/TIPS_AND_TRICKS/">systemd Tips and tricks</a></li>
</ul>
</li>
<li><span class="plainlinks archwiki-template-man" title="$ man 1 systemd"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.1">systemd(1)</a></span></li>
<li>Other distributions
<ul>
<li><a href="https://wiki.gentoo.org/wiki/Systemd" class="extiw" title="gentoo:Systemd">Gentoo:Systemd</a></li>
<li><a href="https://fedoraproject.org/wiki/Systemd" class="extiw" title="fedora:Systemd">Fedora:Systemd</a></li>
<li><a href="https://fedoraproject.org/wiki/How_to_debug_Systemd_problems" class="extiw" title="fedora:How to debug Systemd problems">Fedora:How to debug Systemd problems</a></li>
<li><a href="https://fedoraproject.org/wiki/SysVinit_to_Systemd_Cheatsheet" class="extiw" title="fedora:SysVinit to Systemd Cheatsheet">Fedora:SysVinit to Systemd Cheatsheet</a></li>
<li><a href="https://wiki.debian.org/systemd" class="extiw" title="debian:systemd">Debian:systemd</a></li>
</ul>
</li>
<li>
<a rel="nofollow" class="external text" href="http://0pointer.de/blog/projects/systemd.html">Lennart's blog story</a>, <a rel="nofollow" class="external text" href="http://0pointer.de/blog/projects/systemd-update.html">update 1</a>, <a rel="nofollow" class="external text" href="http://0pointer.de/blog/projects/systemd-update-2.html">update 2</a>, <a rel="nofollow" class="external text" href="http://0pointer.de/blog/projects/systemd-update-3.html">update 3</a>, <a rel="nofollow" class="external text" href="http://0pointer.de/blog/projects/why.html">summary</a>
</li>
<li><a rel="nofollow" class="external text" href="https://containersolutions.github.io/runbooks/posts/linux/debug-systemd-service-units">Debug Systemd Services</a></li>
<li><a rel="nofollow" class="external text" href="http://0pointer.de/public/systemd-ebook-psankar.pdf">systemd for Administrators (PDF)</a></li>
<li><a rel="nofollow" class="external text" href="https://www.digitalocean.com/community/tutorials/how-to-use-systemctl-to-manage-systemd-services-and-units">How To Use Systemctl to Manage Systemd Services and Units </a></li>
<li><a rel="nofollow" class="external text" href="https://dvdhrm.wordpress.com/2013/08/24/session-management-on-linux/">Session management with systemd-logind</a></li>
<li><a href="../en/Emacs.html#Syntax_highlighting_for_systemd_Files" title="Emacs">Emacs Syntax highlighting for Systemd files</a></li>
<li>
<a rel="nofollow" class="external text" href="http://www.h-online.com/open/features/Control-Centre-The-systemd-Linux-init-system-1565543.html">Two</a> <a rel="nofollow" class="external text" href="http://www.h-online.com/open/features/Booting-up-Tools-and-tips-for-systemd-1570630.html">part</a> introductory article in <i>The H Open</i> magazine.</li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Init.html" title="Category:Init">Init</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Move.html" title="Category:Pages or sections flagged with Template:Move">Pages or sections flagged with Template:Move</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Merge.html" title="Category:Pages or sections flagged with Template:Merge">Pages or sections flagged with Template:Merge</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Systemd&amp;oldid=812629">https://wiki.archlinux.org/index.php?title=Systemd&amp;oldid=812629</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 19 July 2024, at 06:32.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
