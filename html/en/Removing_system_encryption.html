<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-os vector-sticky-header-enabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Removing system encryption - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.45.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Removing_system_encryption rootpage-Removing_system_encryption skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Removing_LUKS_Encryption_in-place" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Removing_LUKS_Encryption_in-place">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Removing LUKS Encryption in-place</span>
			</div>
		</a>
		
			<button aria-controls="toc-Removing_LUKS_Encryption_in-place-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Removing LUKS Encryption in-place subsection</span>
			</button>
		
		<ul id="toc-Removing_LUKS_Encryption_in-place-sublist" class="vector-toc-list">
			<li id="toc-Overview" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Overview">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.1</span>
					<span>Overview</span>
				</div>
			</a>
			
			<ul id="toc-Overview-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Decrypting_LUKS1_devices_in-place" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Decrypting_LUKS1_devices_in-place">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.2</span>
					<span>Decrypting LUKS1 devices in-place</span>
				</div>
			</a>
			
			<ul id="toc-Decrypting_LUKS1_devices_in-place-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Decrypting_LUKS2_devices_in-place" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Decrypting_LUKS2_devices_in-place">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.3</span>
					<span>Decrypting LUKS2 devices in-place</span>
				</div>
			</a>
			
			<ul id="toc-Decrypting_LUKS2_devices_in-place-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Cleaning_up_system_files" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Cleaning_up_system_files">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.4</span>
					<span>Cleaning up system files</span>
				</div>
			</a>
			
			<ul id="toc-Cleaning_up_system_files-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Removing_LUKS_via_Backup-Format-Restore" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Removing_LUKS_via_Backup-Format-Restore">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Removing LUKS via Backup-Format-Restore</span>
			</div>
		</a>
		
			<button aria-controls="toc-Removing_LUKS_via_Backup-Format-Restore-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Removing LUKS via Backup-Format-Restore subsection</span>
			</button>
		
		<ul id="toc-Removing_LUKS_via_Backup-Format-Restore-sublist" class="vector-toc-list">
			<li id="toc-Prerequisites" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Prerequisites">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1</span>
					<span>Prerequisites</span>
				</div>
			</a>
			
			<ul id="toc-Prerequisites-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Boot_into_a_live_environment" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Boot_into_a_live_environment">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2</span>
					<span>Boot into a live environment</span>
				</div>
			</a>
			
			<ul id="toc-Boot_into_a_live_environment-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Activate_partitions" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Activate_partitions">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.3</span>
					<span>Activate partitions</span>
				</div>
			</a>
			
			<ul id="toc-Activate_partitions-sublist" class="vector-toc-list">
				<li id="toc-Note_about_different_setups" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Note_about_different_setups">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.3.1</span>
					<span>Note about different setups</span>
				</div>
			</a>
			
			<ul id="toc-Note_about_different_setups-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Once_partitions_are_located" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Once_partitions_are_located">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.3.2</span>
					<span>Once partitions are located</span>
				</div>
			</a>
			
			<ul id="toc-Once_partitions_are_located-sublist" class="vector-toc-list">
				<li id="toc-Mounting_backup_space" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Mounting_backup_space">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.3.2.1</span>
					<span>Mounting backup space</span>
				</div>
			</a>
			
			<ul id="toc-Mounting_backup_space-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Backup_data" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Backup_data">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.4</span>
					<span>Backup data</span>
				</div>
			</a>
			
			<ul id="toc-Backup_data-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Undo_encryption" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Undo_encryption">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.5</span>
					<span>Undo encryption</span>
				</div>
			</a>
			
			<ul id="toc-Undo_encryption-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Restore_data" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Restore_data">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.6</span>
					<span>Restore data</span>
				</div>
			</a>
			
			<ul id="toc-Restore_data-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Adjust_configurations" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Adjust_configurations">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.7</span>
					<span>Adjust configurations</span>
				</div>
			</a>
			
			<ul id="toc-Adjust_configurations-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar no-font-mode-scale">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left" title="Table of Contents">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Removing system encryption</span></h1>
							
</header>
				<div class="vector-column-end no-font-mode-scale">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-edit-clear.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs language, wiki syntax or style improvements. See <a href="../en/Help:Style.html" title="Help:Style">Help:Style</a> for reference.</b></p>
<div>
<b>Reason:</b> written in first person, other style issues. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Removing_system_encryption.html">Talk:Removing system encryption</a>)</div>
</div>
<p>Removing system encryption with <a href="../en/Dm-crypt.html" title="Dm-crypt">dm-crypt and LUKS</a>.
</p>
<meta property="mw:PageProp/toc">
<div class="mw-heading mw-heading2"><h2 id="Removing_LUKS_Encryption_in-place">Removing LUKS Encryption in-place</h2></div>
<div class="mw-heading mw-heading3"><h3 id="Overview">Overview</h3></div>
<p>Although not as safe as backing up your data and restoring it on to a reformatted device,
cryptsetup does allow the user to permanently remove the LUKS encryption from a device in-place. For example, if you have an ext4 filesystem living inside a LUKS-encrypted partition,
performing in-place decryption will remove the LUKS signature, and place the ext4 filesystem
directly on the partition, so that you can mount it directly. Unless something goes wrong,
the files in the filesystem will remain intact. The terms used by cryptsetup's documentation for this is "decryption."
</p>
<p>See the <span class="plainlinks archwiki-template-man" title="$ man 8 cryptsetup-reencrypt"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/cryptsetup-reencrypt.8">cryptsetup-reencrypt(8)</a></span> manual for the <code>--decrypt</code> option.
</p>
<p>Support for non-destructive offline decryption of LUKS1 devices has been available starting with <code>cryptsetup</code> version 1.5.0, which was released in 2012. LUKS1 decryption is only supported for offline mode decryption.
</p>
<p>For LUKS2 devices, both offline and online (i.e. unmount not required) decryption are supported. 
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning</strong> The procedures which follow are inherently risky and may cause catastrophic data loss. You should always backup your drive and LUKS header before proceeding, to protect your data from accidents during decryption.</div>
<div class="mw-heading mw-heading3"><h3 id="Decrypting_LUKS1_devices_in-place">Decrypting LUKS1 devices in-place</h3></div>
<p>The decryption of a LUKS1 device is done in offline mode, i.e. it must not opened and mounted. If you want to decrypt the system drive, reboot into a <a href="../en/USB_flash_installation_medium.html" title="USB flash installation medium">USB live environment</a>. Otherwise, use <code>unmount</code> followed by <code>cryptsetup close <i>dm-name</i></code>.
</p>
<p>To start, identify the <i>device_path</i> using <code>blkid</code> or <code>lsblk</code>.
</p>
<p>Next, the following command performs the decryption:
</p>
<pre># cryptsetup reencrypt --decrypt <i>device_path</i>
Enter any existing passphrase: 
Finished, time 02m05s,   19 GiB written, speed 162,6 MiB/s</pre>
<p>It will automatically identify the LUKS1 header version and not proceed for an opened device. The process might take a while, but give a progress meter. If no problems occur, the filesystem on the device can immediately be mounted directly.
</p>
<div class="mw-heading mw-heading3"><h3 id="Decrypting_LUKS2_devices_in-place">Decrypting LUKS2 devices in-place</h3></div>
<p>Decryption can be done in either offline or online mode, using the <code>cryptsetup</code> command. Since <code>cryptsetup</code> version 2.5.0 (2022) LUKS2 supports decryption by migrating LUKS2 header in a separate file.
</p>
<p>The <code><i>new_file</i></code> to which the LUKS2 header will be migrated must not exist in the initialization phase of the decryption.
</p>
<pre># cryptsetup reencrypt --decrypt --header <i>new_file</i> <i>device_path</i></pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning</strong> The exported header must be placed outside the filesystem hosted on the device that will be in-place decrypted. Otherwise deadlock can occur or in case the decryption process is interrupted it will not be possible to resume it.</div>
<p>To resume interrupted LUKS2 in-place decryption just issue following command:
</p>
<pre># cryptsetup reencrypt --decrypt --resume-only --header <i>migrated_header_file</i> <i>device_path</i>
</pre>
<p>If the decryption was successfully finished on active device (online decryption), the mapped device will be lazy deactivated so that linear mapping is automatically removed when no longer used. Later the original <code><i>device_path</i></code> can be used without device mapper mapping.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> Device with interrupted LUKS2 decryption using migrated header to a file can not be resumed with cryptsetup version &lt; 2.5.0</div>
<div class="mw-heading mw-heading3"><h3 id="Cleaning_up_system_files">Cleaning up system files</h3></div>
<p>Device names and UUIDs may change due to decryption, and you will likely need to update relevant configuration files. The files most likely to need updating are  <code>/etc/crypttab</code>, <code>/etc/fstab</code> and—if your recently decrypted device appeared on the kernel command line—your <a href="../en/Boot_loader.html" class="mw-redirect" title="Boot loader">boot loader</a> configuration, e.g. <code>/etc/default/grub</code>. If you edit the latter, remember to regenerate the grub configuration as described in <a href="../en/GRUB.html" title="GRUB">GRUB</a>.
</p>
<div class="mw-heading mw-heading2"><h2 id="Removing_LUKS_via_Backup-Format-Restore">Removing LUKS via Backup-Format-Restore</h2></div>
<div class="mw-heading mw-heading3"><h3 id="Prerequisites">Prerequisites</h3></div>
<ul>
<li>An encrypted root filesystem you wish to decrypt.</li>
<li>Enough drive space to store a backup.</li>
<li>An Arch Linux (or other) live CD/USB.</li>
<li>A few hours.</li>
</ul>
<div class="mw-heading mw-heading3"><h3 id="Boot_into_a_live_environment">Boot into a live environment</h3></div>
<p>Download and burn the latest Arch ISO to a CD or USB, reboot the system, and boot to cd.
</p>
<div class="mw-heading mw-heading3"><h3 id="Activate_partitions">Activate partitions</h3></div>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-edit-clear.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs language, wiki syntax or style improvements. See <a href="../en/Help:Style.html" title="Help:Style">Help:Style</a> for reference.</b></p>
<div>
<b>Reason:</b> Hard to read, written like a blog post, misses some prompts. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Removing_system_encryption.html">Talk:Removing system encryption</a>)</div>
</div>
<div class="mw-heading mw-heading4"><h4 id="Note_about_different_setups">Note about different setups</h4></div>
<p>An example setup is shown here:
</p>
<table class="wikitable">
<caption>Disk
</caption>
<tbody>
<tr>
<td class="archwiki-table-cell archwiki-template-grey">NTFS
</td>
<td colspan="2" class="archwiki-table-cell">myvg(lvm)
</td>
<td class="archwiki-table-cell archwiki-template-y" data-sort-value="3">NTFS
</td>
</tr>
<tr>
<td rowspan="3" class="archwiki-table-cell archwiki-template-grey">Other OS
</td>
<td class="archwiki-table-cell">cryptswap(lv)
</td>
<td class="archwiki-table-cell archwiki-template-g" data-sort-value="5">cryptroot(lv)
</td>
<td rowspan="3" class="archwiki-table-cell archwiki-template-y" data-sort-value="3">Shared
</td>
</tr>
<tr>
<td class="archwiki-table-cell">luks
</td>
<td class="archwiki-table-cell archwiki-template-g" data-sort-value="5">luks
</td>
</tr>
<tr>
<td class="archwiki-table-cell">swap
</td>
<td class="archwiki-table-cell archwiki-template-g" data-sort-value="5">root(xfs)
</td>
</tr>
</tbody>
</table>
<p>The grey partition is a frame of reference and can be ignored.
The yellow partition will be used as storage space and may be changed at will.
The green partitions will be modified. Bold text must match your system's setup.
</p>
<p>In the example system:
<b>myvg</b> contains lvs called <b>cryptroot</b> and <b>cryptswap</b>. They are located at <code>/dev/myvg/cryptroot</code> and <code>/dev/myvg/cryptswap</code>. Upon boot, LUKS is used along with a few crypttab entries to create <code>/dev/mapper/root</code> and <code>/dev/mapper/swap</code>. 
</p>
<p>Swap will not be unencrypted as part of this guide, as undoing the swap encryption does not require any complex backup or restoration.
</p>
<p>The example system is not indicative of all systems. Different filesystems require different tools to effectively backup and restore their data. LVM can be ignored if not used.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> XFS requires <i>xfs_copy</i> to ensure an effective backup and restore, <i>dd</i> is insufficient. <i>dd</i> may be used with ext2, 3 and 4.</div>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-view-fullscreen.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs expansion.</b></p>
<div>
<b>Reason:</b> What of jfs? (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Removing_system_encryption.html">Talk:Removing system encryption</a>)</div>
</div>
<div class="mw-heading mw-heading4"><h4 id="Once_partitions_are_located">Once partitions are located</h4></div>
<p>Load necessary modules. For device mapper/LVM: 
</p>
<pre># modprobe dm-mod 
</pre>
<p>For LUKS: 
</p>
<pre># modprobe dm-crypt
</pre>
<p>Scan for physical, volume and logical volumes:
</p>
<pre># pvscan; vgscan; lvscan
</pre>
<p>Activate the LVM volume group:
</p>
<pre># lvchange -ay <b>myvg/cryptroot</b>
</pre>
<p>Open the encrypted filesystem with LUKS so that it can be read:
</p>
<pre># cryptsetup luksOpen <b>/dev/myvg/cryptroot</b> root
</pre>
<p>Enter password.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> The only partition that will be operated on that should be mounted at this point is the backup partition. If a partition other than the backup partition is already mounted, it can be safely umounted it now.</div>
<div class="mw-heading mw-heading5"><h5 id="Mounting_backup_space">Mounting backup space</h5></div>
<p>Only if using NTFS to store the backup, install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ntfs-3g">ntfs-3g</a></span>.
</p>
<p>The next step is important for backup storage.
</p>
<pre># mount -t ntfs-3g -o rw /dev/sd<i>XY</i> <i>/mount/point/</i>
</pre>
<p>or use netcat to store the backup on a remote system.
</p>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-view-fullscreen.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs expansion.</b></p>
<div>
<b>Reason:</b> Add netcat instructions. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Removing_system_encryption.html">Talk:Removing system encryption</a>)</div>
</div>
<div class="mw-heading mw-heading3"><h3 id="Backup_data">Backup data</h3></div>
<p>Using <i>xfs_copy</i>:
</p>
<pre># xfs_copy -db <b>/dev/mapper/root</b> <i>/mount/point/backup_root.img</i>
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> The <code>-d</code> flag preserves UUIDs and <code>-b</code> ensures direct IO is not attempted to any of the target files.</div>
<p>Using <i>dd</i>:
</p>
<pre># dd if=<b>/dev/mapper/root</b> of=<i>/mount/point/backup_root.img</i>
</pre>
<div class="mw-heading mw-heading3"><h3 id="Undo_encryption">Undo encryption</h3></div>
<p>This is the point of no return. Make sure that you are ready for this step. If you plan to undo this later, you will have to start almost from scratch.
</p>
<pre># cryptsetup luksClose root
# lvm lvremove <b>myvg/cryptroot</b>
</pre>
<div class="mw-heading mw-heading3"><h3 id="Restore_data">Restore data</h3></div>
<p>We have to create a new logical volume to house our root filesystem, then we restore our filesystem.
</p>
<pre># lvm lvcreate <b>-l 100%FREE -n root myvg</b>
# xfs_copy -db <i>/mount/point/backup_root.img</i> <b>/dev/myvg/root</b>
</pre>
<p>The second drive name is changed now.
</p>
<div class="mw-heading mw-heading3"><h3 id="Adjust_configurations">Adjust configurations</h3></div>
<p>You need to boot into your system and edit <code>/etc/crypttab</code>, <code>/etc/mkinitcpio.conf</code>, <code>/etc/fstab</code>, and possibly <code>/boot/grub/menu.lst</code>.
</p>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Data-at-rest_encryption.html" title="Category:Data-at-rest encryption">Data-at-rest encryption</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Style.html" title="Category:Pages or sections flagged with Template:Style">Pages or sections flagged with Template:Style</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Removing_system_encryption&amp;oldid=837180">https://wiki.archlinux.org/index.php?title=Removing_system_encryption&amp;oldid=837180</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 15 June 2025, at 23:15.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><picture><source media="(min-width: 500px)" srcset="/resources/assets/poweredby_mediawiki.svg" width="88" height="31"><img src="/resources/assets/mediawiki_compact.svg" width="25" height="25" loading="lazy"></picture></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-header-container vector-sticky-header-container no-font-mode-scale">
	<div id="vector-sticky-header" class="vector-sticky-header">
		<div class="vector-sticky-header-start">
			<div class="vector-sticky-header-icon-start vector-button-flush-left vector-button-flush-right" aria-hidden="true">
				<button class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-sticky-header-search-toggle" tabindex="-1" data-event-name="ui.vector-sticky-search-form.icon"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
			</button>
		</div>
			
		<div role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box">
			<div class="vector-typeahead-search-container">
				<div class="cdx-typeahead-search cdx-typeahead-search--show-thumbnail">
					<form action="/index.php" id="vector-sticky-search-form" class="cdx-search-input cdx-search-input--has-end-button">
						<div class="cdx-search-input__input-wrapper" data-search-loc="header-moved">
							<div class="cdx-text-input cdx-text-input--has-start-icon">
								<input class="cdx-text-input__input mw-searchInput" autocomplete="off" type="search" name="search" placeholder="Search ArchWiki">
								<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
							</div>
							<input type="hidden" name="title" value="Special:Search">
						</div>
						<button class="cdx-button cdx-search-input__end-button">Search</button>
					</form>
				</div>
			</div>
		</div>
		<div class="vector-sticky-header-context-bar">
				<nav aria-label="Contents" class="vector-toc-landmark">
						
					<div id="vector-sticky-header-toc" class="vector-dropdown mw-portlet mw-portlet-sticky-header-toc vector-sticky-header-toc vector-button-flush-left">
						<input type="checkbox" id="vector-sticky-header-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-sticky-header-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
						<label id="vector-sticky-header-toc-label" for="vector-sticky-header-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
						</label>
						<div class="vector-dropdown-content">
					
						<div id="vector-sticky-header-toc-unpinned-container" class="vector-unpinned-container">
						</div>
					
						</div>
					</div>
			</nav>
				<div class="vector-sticky-header-context-bar-primary" aria-hidden="true"><span class="mw-page-title-main">Removing system encryption</span></div>
			</div>
		</div>
		<div class="vector-sticky-header-end" aria-hidden="true">
			<div class="vector-sticky-header-icons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-talk-sticky-header" tabindex="-1" data-event-name="talk-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbles mw-ui-icon-wikimedia-speechBubbles"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-subject-sticky-header" tabindex="-1" data-event-name="subject-sticky-header"><span class="vector-icon mw-ui-icon-article mw-ui-icon-wikimedia-article"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-history-sticky-header" tabindex="-1" data-event-name="history-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-history mw-ui-icon-wikimedia-wikimedia-history"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only mw-watchlink" id="ca-watchstar-sticky-header" tabindex="-1" data-event-name="watch-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-star mw-ui-icon-wikimedia-wikimedia-star"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only reading-lists-bookmark" id="ca-bookmark-sticky-header" tabindex="-1" data-event-name="watch-sticky-bookmark"><span class="vector-icon mw-ui-icon-wikimedia-bookmarkOutline mw-ui-icon-wikimedia-wikimedia-bookmarkOutline"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-edit-sticky-header" tabindex="-1" data-event-name="wikitext-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-wikiText mw-ui-icon-wikimedia-wikimedia-wikiText"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-ve-edit-sticky-header" tabindex="-1" data-event-name="ve-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-edit mw-ui-icon-wikimedia-wikimedia-edit"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-viewsource-sticky-header" tabindex="-1" data-event-name="ve-edit-protected-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-editLock mw-ui-icon-wikimedia-wikimedia-editLock"></span>

<span></span>
			</a>
		</div>
			<div class="vector-sticky-header-buttons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive" id="ca-addsection-sticky-header" tabindex="-1" data-event-name="addsection-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbleAdd-progressive mw-ui-icon-wikimedia-speechBubbleAdd-progressive"></span>

<span>Add topic</span>
			</a>
		</div>
			<div class="vector-sticky-header-icon-end">
				<div class="vector-user-links">
				</div>
			</div>
		</div>
	</div>
</div>
<div class="mw-portlet mw-portlet-dock-bottom emptyPortlet" id="p-dock-bottom">
	<ul>
		
	</ul>
</div>
</body>
</html>
