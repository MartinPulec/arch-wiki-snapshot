<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Kubernetes - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.3">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Kubernetes rootpage-Kubernetes skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Installation</div>
		</a>
		
			<button aria-controls="toc-Installation-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Installation subsection</span>
			</button>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
			<li id="toc-Deployment_tools" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Deployment_tools">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1</span>Deployment tools</div>
			</a>
			
			<ul id="toc-Deployment_tools-sublist" class="vector-toc-list">
				<li id="toc-kubeadm" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#kubeadm">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1.1</span>kubeadm</div>
			</a>
			
			<ul id="toc-kubeadm-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Manual_installation" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Manual_installation">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1.2</span>Manual installation</div>
			</a>
			
			<ul id="toc-Manual_installation-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Cluster_management" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Cluster_management">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1.3</span>Cluster management</div>
			</a>
			
			<ul id="toc-Cluster_management-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Container_runtime" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Container_runtime">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.2</span>Container runtime</div>
			</a>
			
			<ul id="toc-Container_runtime-sublist" class="vector-toc-list">
				<li id="toc-Prerequisites" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Prerequisites">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.2.1</span>Prerequisites</div>
			</a>
			
			<ul id="toc-Prerequisites-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-containerd_runtime" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#containerd_runtime">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.2.2</span>containerd runtime</div>
			</a>
			
			<ul id="toc-containerd_runtime-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-(Optional)_Package_manager" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#(Optional)_Package_manager">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.3</span>(Optional) Package manager</div>
			</a>
			
			<ul id="toc-(Optional)_Package_manager-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Configuration</div>
		</a>
		
			<button aria-controls="toc-Configuration-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configuration subsection</span>
			</button>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
			<li id="toc-Disable_swap" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Disable_swap">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Disable swap</div>
			</a>
			
			<ul id="toc-Disable_swap-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Choose_cgroup_driver_for_containerd" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Choose_cgroup_driver_for_containerd">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>Choose cgroup driver for containerd</div>
			</a>
			
			<ul id="toc-Choose_cgroup_driver_for_containerd-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Choose_container_runtime_interface_(CRI)" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Choose_container_runtime_interface_(CRI)">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3</span>Choose container runtime interface (CRI)</div>
			</a>
			
			<ul id="toc-Choose_container_runtime_interface_(CRI)-sublist" class="vector-toc-list">
				<li id="toc-Containerd" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Containerd">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.1</span>Containerd</div>
			</a>
			
			<ul id="toc-Containerd-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-CRI-O" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#CRI-O">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.2</span>CRI-O</div>
			</a>
			
			<ul id="toc-CRI-O-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Choose_cluster_network_parameter" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Choose_cluster_network_parameter">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4</span>Choose cluster network parameter</div>
			</a>
			
			<ul id="toc-Choose_cluster_network_parameter-sublist" class="vector-toc-list">
				<li id="toc-Choose_a_pod_CIDR_range" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Choose_a_pod_CIDR_range">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4.1</span>Choose a pod CIDR range</div>
			</a>
			
			<ul id="toc-Choose_a_pod_CIDR_range-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-(Optional)_Choose_API_server_advertising_address" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#(Optional)_Choose_API_server_advertising_address">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4.2</span>(Optional) Choose API server advertising address</div>
			</a>
			
			<ul id="toc-(Optional)_Choose_API_server_advertising_address-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-(Optional)_Choose_alternative_node_network_proxy_provider" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#(Optional)_Choose_alternative_node_network_proxy_provider">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4.3</span>(Optional) Choose alternative node network proxy provider</div>
			</a>
			
			<ul id="toc-(Optional)_Choose_alternative_node_network_proxy_provider-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Create_cluster" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Create_cluster">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Create cluster</div>
		</a>
		
			<button aria-controls="toc-Create_cluster-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Create cluster subsection</span>
			</button>
		
		<ul id="toc-Create_cluster-sublist" class="vector-toc-list">
			<li id="toc-kubeadm_without_config" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#kubeadm_without_config">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>kubeadm without config</div>
			</a>
			
			<ul id="toc-kubeadm_without_config-sublist" class="vector-toc-list">
				<li id="toc-Initialize_control-plane" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Initialize_control-plane">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.1</span>Initialize control-plane</div>
			</a>
			
			<ul id="toc-Initialize_control-plane-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Installing_CNI_plugins_(pod_network_addon)" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Installing_CNI_plugins_(pod_network_addon)">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.2</span>Installing CNI plugins (pod network addon)</div>
			</a>
			
			<ul id="toc-Installing_CNI_plugins_(pod_network_addon)-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-kubeadm_with_config" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#kubeadm_with_config">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>kubeadm with config</div>
			</a>
			
			<ul id="toc-kubeadm_with_config-sublist" class="vector-toc-list">
				<li id="toc-Create_the_init_config" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Create_the_init_config">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.1</span>Create the init config</div>
			</a>
			
			<ul id="toc-Create_the_init_config-sublist" class="vector-toc-list">
				<li id="toc-Bootstrap_token" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Bootstrap_token">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.1.1</span>Bootstrap token</div>
			</a>
			
			<ul id="toc-Bootstrap_token-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Advertise_address" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Advertise_address">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.1.2</span>Advertise address</div>
			</a>
			
			<ul id="toc-Advertise_address-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Node_name" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Node_name">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.1.3</span>Node name</div>
			</a>
			
			<ul id="toc-Node_name-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Init_the_cluster" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Init_the_cluster">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.2</span>Init the cluster</div>
			</a>
			
			<ul id="toc-Init_the_cluster-sublist" class="vector-toc-list">
				<li id="toc-Use_calico_for_CNI_config" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Use_calico_for_CNI_config">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.2.1</span>Use calico for CNI config</div>
			</a>
			
			<ul id="toc-Use_calico_for_CNI_config-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Create_the_reset_config" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Create_the_reset_config">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.3</span>Create the reset config</div>
			</a>
			
			<ul id="toc-Create_the_reset_config-sublist" class="vector-toc-list">
				<li id="toc-Reset_a_cluster" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Reset_a_cluster">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.3.1</span>Reset a cluster</div>
			</a>
			
			<ul id="toc-Reset_a_cluster-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Create_the_join_config" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Create_the_join_config">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.4</span>Create the join config</div>
			</a>
			
			<ul id="toc-Create_the_join_config-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Join_cluster" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Join_cluster">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Join cluster</div>
		</a>
		
		<ul id="toc-Join_cluster-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Tips_and_tricks" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Tips_and_tricks">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Tips and tricks</div>
		</a>
		
			<button aria-controls="toc-Tips_and_tricks-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Tips and tricks subsection</span>
			</button>
		
		<ul id="toc-Tips_and_tricks-sublist" class="vector-toc-list">
			<li id="toc-Tear_down_a_cluster" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Tear_down_a_cluster">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1</span>Tear down a cluster</div>
			</a>
			
			<ul id="toc-Tear_down_a_cluster-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Operating_from_behind_a_proxy" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Operating_from_behind_a_proxy">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2</span>Operating from behind a proxy</div>
			</a>
			
			<ul id="toc-Operating_from_behind_a_proxy-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Troubleshooting">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>Troubleshooting</div>
		</a>
		
			<button aria-controls="toc-Troubleshooting-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Troubleshooting subsection</span>
			</button>
		
		<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
			<li id="toc-Failed_to_get_container_stats" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Failed_to_get_container_stats">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.1</span>Failed to get container stats</div>
			</a>
			
			<ul id="toc-Failed_to_get_container_stats-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Pods_cannot_communicate_when_using_Flannel_CNI_and_systemd-networkd" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Pods_cannot_communicate_when_using_Flannel_CNI_and_systemd-networkd">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.2</span>Pods cannot communicate when using Flannel CNI and systemd-networkd</div>
			</a>
			
			<ul id="toc-Pods_cannot_communicate_when_using_Flannel_CNI_and_systemd-networkd-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id='toc-CoreDNS_Pod_pending_forever,_the_control_plane_node_remains_"NotReady"' class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href='#CoreDNS_Pod_pending_forever,_the_control_plane_node_remains_"NotReady"'>
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.3</span>CoreDNS Pod pending forever, the control plane node remains "NotReady"</div>
			</a>
			
			<ul id='toc-CoreDNS_Pod_pending_forever,_the_control_plane_node_remains_"NotReady"-sublist' class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-[kubelet-finalize]_malformed_header:_missing_HTTP_content-type" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#[kubelet-finalize]_malformed_header:_missing_HTTP_content-type">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.4</span>[kubelet-finalize] malformed header: missing HTTP content-type</div>
			</a>
			
			<ul id="toc-[kubelet-finalize]_malformed_header:_missing_HTTP_content-type-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-CoreDNS_Pod_does_not_start_due_to_loops" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#CoreDNS_Pod_does_not_start_due_to_loops">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.5</span>CoreDNS Pod does not start due to loops</div>
			</a>
			
			<ul id="toc-CoreDNS_Pod_does_not_start_due_to_loops-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">7</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Kubernetes</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 1 language">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-1" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">1 language</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Kubernetes" title="Kubernetes – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-edit-clear.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs language, wiki syntax or style improvements. See <a href="../en/Help:Style.html" title="Help:Style">Help:Style</a> for reference.</b></p>
<div>
<b>Reason:</b> Many missing prompts. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Kubernetes.html">Talk:Kubernetes</a>)</div>
</div>
<p><a rel="nofollow" class="external text" href="https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/">Kubernetes</a> (aka. k8s) is an open-source system for automating the deployment, scaling, and management of containerized applications.
</p>
<p>A k8s cluster consists of its <a rel="nofollow" class="external text" href="https://kubernetes.io/docs/concepts/overview/components/#control-plane-components">control-plane components</a> and <a rel="nofollow" class="external text" href="https://kubernetes.io/docs/concepts/overview/components/#node-components">node components</a> (each representing one or more host machines running a container runtime and <code>kubelet.service</code>). There are two options to install kubernetes, "the real one", described here, and a local install with <a rel="nofollow" class="external text" href="https://k3s.io/">k3s</a>, <a rel="nofollow" class="external text" href="https://kind.sigs.k8s.io/">kind</a>, or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=minikube">minikube</a></span>.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>There are many methods to setup a kubernetes cluster. This article will focus on bootstrapping with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kubeadm">kubeadm</a></span>.
</p>
<h3><span class="mw-headline" id="Deployment_tools">Deployment tools</span></h3>
<h4><span class="mw-headline" id="kubeadm">kubeadm</span></h4>
<p>When bootstrapping a Kubernetes cluster with <i>kubeadm</i>, <a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">install</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kubeadm">kubeadm</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kubelet">kubelet</a></span> on each node.
</p>
<h4><span class="mw-headline" id="Manual_installation">Manual installation</span></h4>
<p>When manually creating a Kubernetes cluster <a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">install</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/etcd/">etcd</a></span><sup><small>AUR</small></sup> and the <a href="../en/Meta_package_and_package_group.html" class="mw-redirect" title="Package group">package group</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/groups/x86_64/kubernetes-control-plane/">kubernetes-control-plane</a></span> (for a control-plane node) and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/groups/x86_64/kubernetes-node/">kubernetes-node</a></span> (for a worker node).
</p>
<h4><span class="mw-headline" id="Cluster_management">Cluster management</span></h4>
<p>To control a kubernetes cluster, install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kubectl">kubectl</a></span> on the control-plane hosts and any external host that is supposed to be able to interact with the cluster.
</p>
<h3><span class="mw-headline" id="Container_runtime">Container runtime</span></h3>
<p>Both control-plane and regular worker nodes require a container runtime for their <code>kubelet</code> instances which is used for hosting containers.
<a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> either <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=containerd">containerd</a></span> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=cri-o">cri-o</a></span> to meet this dependency.
</p>
<h4><span class="mw-headline" id="Prerequisites">Prerequisites</span></h4>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-edit-cut.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section is being considered for removal.</b></p>
<div>
<b>Reason:</b> The <a href="../en/Overlay_filesystem.html" title="Overlay filesystem">overlay</a> module is auto-loaded, <code>br_netfilter</code> is loaded via <code>/usr/lib/modules-load.d/kubelet.conf</code> and <code>/usr/lib/modules-load.d/cri-o.conf</code>. IP forwarding is enabled via <code>/etc/sysctl.d/50-kubelet.conf</code> and <code>/usr/lib/sysctl.d/90-cri-o.conf</code>. The <code>net.bridge.bridge-nf-call-iptables</code> and <code>net.bridge.bridge-nf-call-ip6tables</code> parameters <a rel="nofollow" class="external text" href="https://unix.stackexchange.com/q/719112">default to 1</a>. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Kubernetes.html">Talk:Kubernetes</a>)</div>
</div>
<p>To setup <i>forwarding IPv4 and letting iptables see bridged traffic</i>, begin by <a href="../en/Kernel_module.html#Manual_module_handling" title="Kernel module">loading the kernel modules</a> <code>overlay</code> and <code>br_netfilter</code> manually. 
</p>
<p>To perform this step on subsequent boots, create: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modules-load.d/k8s.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">overlay
br_netfilter
</pre>
<p>Some module parameters are required: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sysctl.d/k8s.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">net.bridge.bridge-nf-call-iptables  = 1
net.bridge.bridge-nf-call-ip6tables = 1
net.ipv4.ip_forward                 = 1</pre>
<p>Apply them without rebooting with: 
</p>
<pre># sysctl --system
</pre>
<p>(Optionally) verify that the <code>br_netfilter</code>, <code>overlay</code> modules are loaded by running the following commands:
</p>
<pre>lsmod | grep br_netfilter
lsmod | grep overlay
</pre>
<p>(Optionally) verify that the <code>net.bridge.bridge-nf-call-iptables</code>, <code>net.bridge.bridge-nf-call-ip6tables</code>, and <code>net.ipv4.ip_forward</code> system variables are set to 1 in your <code>sysctl</code> config by running the following command:
</p>
<pre>sysctl net.bridge.bridge-nf-call-iptables net.bridge.bridge-nf-call-ip6tables net.ipv4.ip_forward
</pre>
<p>Refer to official document<a rel="nofollow" class="external autonumber" href="https://kubernetes.io/docs/setup/production-environment/container-runtimes/#install-and-configure-prerequisites">[1]</a> for more details.
</p>
<h4><span class="mw-headline" id="containerd_runtime">containerd runtime</span></h4>
<p>There are two methods available to install <i>containerd</i>:
</p>
<ol>
<li>
<a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=containerd">containerd</a></span> package.</li>
<li>To install a rootless <i>containerd</i>, use <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/nerdctl-full-bin/">nerdctl-full-bin</a></span><sup><small>AUR</small></sup>, which is a full nerdctl package, bundled with containerd, CNI plugin, and RootlessKit. Rootless containerd can be launched with <code>containerd-rootless-setuptool.sh install</code>.</li>
</ol>
<p>Remember that Arch Linux uses <a href="../en/Systemd.html" title="Systemd">systemd</a> as its init system, so you need to <a href="#Choose_cgroup_driver_for_containerd">choose systemd cgroup driver</a> before deploying the control plane(s).
</p>
<h3>
<span id=".28Optional.29_Package_manager"></span><span class="mw-headline" id="(Optional)_Package_manager">(Optional) Package manager</span>
</h3>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=helm">helm</a></span> is a tool for managing pre-configured Kubernetes resources which may be helpful for getting started.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>All nodes in a cluster (control-plane and worker) require a running instance of <code>kubelet.service</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> Read the following subsections closely before starting <code>kubelet.service</code> or using <code>kubeadm</code>.</div>
<p>All provided systemd services accept CLI overrides in environment files:
</p>
<ul>
<li>
<code>kubelet.service</code>: <code>/etc/kubernetes/kubelet.env</code>
</li>
<li>
<code>kube-apiserver.service</code>: <code>/etc/kubernetes/kube-apiserver.env</code>
</li>
<li>
<code>kube-controller-manager.service</code>: <code>/etc/kubernetes/kube-controller-manager.env</code>
</li>
<li>
<code>kube-proxy.service</code>: <code>/etc/kubernetes/kube-proxy.env</code>
</li>
<li>
<code>kube-scheduler.service</code>: <code>/etc/kubernetes/kube-scheduler.env</code>
</li>
</ul>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-view-fullscreen.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs expansion.</b></p>
<div>
<b>Reason:</b> 
<ul>
<li>Example for setup without <code>kubeadm</code>, using <code>kube-apiserver.service</code>, <code>kube-controller-manager.service</code>, <code>kube-proxy.service</code> and <code>kube-scheduler.service</code>.</li>
<li>Example for setup with <code>kubeadm</code> using <a rel="nofollow" class="external text" href="https://kubernetes.io/docs/reference/setup-tools/kubeadm/kubeadm-init/#config-file">configuration files</a>.</li>
</ul>
 (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Kubernetes.html">Talk:Kubernetes</a>)</div>
</div>
<h3><span class="mw-headline" id="Disable_swap">Disable swap</span></h3>
<p>Kubernetes currently does not support having swap enabled on the system. See <a rel="nofollow" class="external text" href="https://github.com/kubernetes/enhancements/tree/master/keps/sig-node/2400-node-swap">KEP-2400: Node system swap support</a> for details.
</p>
<p>See <a href="../en/Swap.html#Disabling_swap" title="Swap">Swap#Disabling swap</a> for instructions on how to disable swap.
</p>
<h3><span class="mw-headline" id="Choose_cgroup_driver_for_containerd">Choose cgroup driver for containerd</span></h3>
<p>To use the <code>systemd</code> cgroup driver in <code>/etc/containerd/config.toml</code> with <code>runc</code>, set
</p>
<pre>[plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
  ...
  [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc.options]
    SystemdCgroup = true
</pre>
<p>If <code>/etc/containerd/config.toml</code> does not exist, the default configuration can be generated with <a rel="nofollow" class="external autonumber" href="https://github.com/containerd/containerd/blob/main/docs/getting-started.md#customizing-containerd">[2]</a>
</p>
<pre># mkdir -p /etc/containerd/
# containerd config default &gt; /etc/containerd/config.toml
</pre>
<p>Remember to <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">restart</a> <code>containerd.service</code> to make the change take effect.
</p>
<p>See the <a rel="nofollow" class="external text" href="https://kubernetes.io/docs/setup/production-environment/container-runtimes/#cgroup-drivers">official documentation</a> for a deeper discussion on whether to keep <code>cgroupfs</code> driver or use <code>systemd</code> cgroup driver.
</p>
<h3>
<span id="Choose_container_runtime_interface_.28CRI.29"></span><span class="mw-headline" id="Choose_container_runtime_interface_(CRI)">Choose container runtime interface (CRI)</span>
</h3>
<p>A <a rel="nofollow" class="external text" href="https://kubernetes.io/docs/setup/production-environment/container-runtimes/">container runtime</a> has to be configured and started, before <code>kubelet.service</code> can make use of it.
</p>
<p>You will pass flag <code>--cri-socket</code> with the container runtime interface endpoint to <code>kubeadm init</code> or <code>kubeadm join</code> in order to create or join a cluster.
</p>
<p>For example, if you choose <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=containerd">containerd</a></span> as CRI runtime, the flag <code>--cri-socket</code> will be:
</p>
<pre>kubeadm init --cri-socket /run/containerd/containerd.sock
</pre>
<h4><span class="mw-headline" id="Containerd">Containerd</span></h4>
<p>Before Kubernetes version 1.27.4, when using <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=containerd">containerd</a></span> as container runtime, it is required to  provide <code>kubeadm init</code> or <code>kubeadm join</code> with its CRI endpoint. To do so, specify their flag <code>--cri-socket</code> to  <code>/run/containerd/containerd.sock</code><a rel="nofollow" class="external autonumber" href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/#installing-runtime">[3]</a>.
</p>
<pre>kubeadm join --cri-socket=/run/containerd/containerd.sock
</pre>
<p><br>
After Kubernetes version 1.27.4, kubeadm will auto detect this CRI for you, flag <code>--cri-socket</code> is only needed when you installed multiple CRI.
</p>
<h4><span class="mw-headline" id="CRI-O">CRI-O</span></h4>
<p>When using <a href="../en/CRI-O.html" title="CRI-O">CRI-O</a> as container runtime, it is required to  provide <code>kubeadm init</code> or <code>kubeadm join</code> with its CRI endpoint: <code>--cri-socket='unix:///run/crio/crio.sock'</code>
</p>
<h3><span class="mw-headline" id="Choose_cluster_network_parameter">Choose cluster network parameter</span></h3>
<h4><span class="mw-headline" id="Choose_a_pod_CIDR_range">Choose a pod CIDR range</span></h4>
<p>The networking setup for the cluster has to be configured for the respective container runtime. This can be done using <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=cni-plugins">cni-plugins</a></span>.
</p>
<p>The <b>pod CIDR addresses</b> refer to the IP address range that is assigned to pods within a Kubernetes cluster. When pods are scheduled to run on nodes in the cluster, they are assigned IP addresses from this CIDR range.
</p>
<p>The <b>pod CIDR range</b> is specified when deploying a Kubernetes cluster and is confined within the cluster network. It should not overlap with other IP ranges used within the cluster, such as the <i>service CIDR range</i>.
</p>
<p>You will pass flag <code>--pod-network-cidr</code> with value of the virtual network's <a href="https://en.wikipedia.org/wiki/CIDR" class="extiw" title="wikipedia:CIDR">CIDR</a> to <code>kubeadm init</code> or <code>kubeadm join</code> in order to create or join a cluster.
</p>
<p>For example:
</p>
<pre>kubeadm init --pod-network-cidr='10.85.0.0/16'
</pre>
<p>will set your kubernetes' pod CIDR range to <code>10.85.0.0/16</code>.
</p>
<h4>
<span id=".28Optional.29_Choose_API_server_advertising_address"></span><span class="mw-headline" id="(Optional)_Choose_API_server_advertising_address">(Optional) Choose API server advertising address</span>
</h4>
<p>If your node for control plane is in multiple subnets (for example you may have installed a tailscale tailnet), 
when initializing the Kubernetes master with kubeadm init, you can specify the IP address that the API server will advertise with the <code>--apiserver-advertise-address</code> flag. This IP address should be accessible to all nodes in your cluster.
</p>
<h4>
<span id=".28Optional.29_Choose_alternative_node_network_proxy_provider"></span><span class="mw-headline" id="(Optional)_Choose_alternative_node_network_proxy_provider">(Optional) Choose alternative node network proxy provider</span>
</h4>
<p>Node proxy provider like <code>kube-proxy</code> is a network proxy that runs on each node in your cluster, maintaining network rules on nodes to allow network communication to your Pods from network sessions inside or outside of your cluster.
</p>
<p>By default <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kubeadm">kubeadm</a></span> choose <code>kube-proxy</code> as the node proxy that runs on each node in your cluster.
</p>
<p>Container Network Interface (CNI) plugins like cilium offer a complete replacement for kube-proxy.
</p>
<p>If you want to use cilium's implementation of node network proxy to fully leverage cilium's network policy feature, you should pass flag <code>--skip-phases=addon/kube-proxy</code> to <code>kubeadm init</code> to skip the install of kube-proxy. 
</p>
<p>Cilium will install a full replacement during its installation. See this<a rel="nofollow" class="external autonumber" href="https://docs.cilium.io/en/latest/network/kubernetes/kubeproxy-free/">[4]</a> for details.
</p>
<h2><span class="mw-headline" id="Create_cluster">Create cluster</span></h2>
<p>Before <a rel="nofollow" class="external text" href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/">creating a new kubernetes cluster</a> with <code>kubeadm</code> <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start">start</a> and <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">enable</a> <code>kubelet.service</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> <code>kubelet.service</code> will fail (but restart) until configuration for it is present.</div>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-view-fullscreen.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs expansion.</b></p>
<div>
<b>Reason:</b> 
<ul>
<li>Example for setup without <code>kubeadm</code>, using <code>kube-apiserver.service</code>, <code>kube-controller-manager.service</code>, <code>kube-proxy.service</code> and <code>kube-scheduler.service</code>.</li>
<li>Example for setup with <code>kubeadm</code> using <a rel="nofollow" class="external text" href="https://kubernetes.io/docs/reference/setup-tools/kubeadm/kubeadm-init/#config-file">configuration files</a>.</li>
</ul>
 (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Kubernetes.html">Talk:Kubernetes</a>)</div>
</div>
<h3><span class="mw-headline" id="kubeadm_without_config">kubeadm without config</span></h3>
<p>When <a rel="nofollow" class="external text" href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/">creating a new kubernetes cluster</a> with <code>kubeadm</code> a control-plane has to be created before further worker nodes can join it.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 
<ul>
<li>If the cluster is supposed to be turned into a <a href="https://en.wikipedia.org/wiki/High_availability" class="extiw" title="wikipedia:High availability">high availability</a> cluster (a <a rel="nofollow" class="external text" href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/ha-topology/#stacked-etcd-topology">stacked etcd topology</a>) later on <code>kubeadm init</code> needs to be provided with <code>--control-plane-endpoint=<i>&lt;IP or domain&gt;</i></code> (it is not possible to do this retroactively!).</li>
<li>It is possible to use a <a rel="nofollow" class="external text" href="https://kubernetes.io/docs/reference/setup-tools/kubeadm/kubeadm-init/#config-file">config file</a> for <code>kubeadm init</code> instead of a set of parameters.</li>
</ul>
</div>
<h4><span class="mw-headline" id="Initialize_control-plane">Initialize control-plane</span></h4>
<p>To initialize control-plane, you need pass the following necessary flags to <code>kubeadm init</code>
</p>
<p>If run successfully, <code>kubeadm init</code> will have generated configurations for the <code>kubelet</code> and various control-plane components below <code>/etc/kubernetes/</code> and <code>/var/lib/kubelet/</code>.
</p>
<p>Finally, it will output commands ready to be copied and pasted to setup <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kubectl">kubectl</a></span> and make a worker node join the cluster (based on a token, valid for 24 hours).
</p>
<p>To use <code>kubectl</code> with the freshly created control-plane node, setup the configuration (either as root or as a normal user):
</p>
<pre>$ mkdir -p $HOME/.kube
# cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
# chown $(id -u):$(id -g) $HOME/.kube/config
</pre>
<h4>
<span id="Installing_CNI_plugins_.28pod_network_addon.29"></span><span class="mw-headline" id="Installing_CNI_plugins_(pod_network_addon)">Installing CNI plugins (pod network addon)</span>
</h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You must deploy a <b>Container Network Interface (CNI)</b> based Pod network add-on so that your Pods can communicate with each other. <b>Cluster DNS (CoreDNS)</b> will not start up before a network is installed.</div>
<p><a rel="nofollow" class="external text" href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/#pod-network">Pod network add-ons</a> (CNI plugins) implement the Kubernetes <a rel="nofollow" class="external text" href="https://kubernetes.io/docs/concepts/services-networking/">network model</a> differently from simple solutions like <a rel="nofollow" class="external text" href="https://github.com/flannel-io/flannel">flannel</a> to more complicated solutions like <a rel="nofollow" class="external text" href="https://www.tigera.io/project-calico/">calico</a>. See <a rel="nofollow" class="external text" href="https://kubernetes.io/docs/concepts/cluster-administration/addons/#networking-and-network-policy">this list</a> for more options.
</p>
<p>An increasingly adopted advanced CNI plugin is <a rel="nofollow" class="external text" href="https://cilium.io/">cilium</a>, which achieves <a rel="nofollow" class="external text" href="https://cilium.io/blog/2021/05/11/cni-benchmark/">impressive performance with eBPF</a>. To install <code>cilium</code> as CNI plugin, use <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=cilium-cli">cilium-cli</a></span>:
</p>
<pre># cilium-cli install
</pre>
<p>This will create the <code>/opt/cni/bin/cilium-cni</code> plugin, config file <code>/etc/cni/net.d/05-cilium.conflist</code> and deploy two pods on the Kubernetes cluster.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you use CRI-O, make sure you have enabled the <code>/opt/cni/bin/</code> plugin directory. See <a href="../en/CRI-O.html#Plugin_directories" title="CRI-O">CRI-O#Plugin directories</a>.</div>
<h3><span class="mw-headline" id="kubeadm_with_config">kubeadm with config</span></h3>
<p>You will most likely find that creating the control plane requires several attempts find the optimal configuration for your particular setup. To make this easier (and the process with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kubeadm">kubeadm</a></span> more repeatable generally), you may run the initialization step using config files.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> Plan on using two config files, one for inits and one for resets to more rapidly test configurations.</div>
<h4><span class="mw-headline" id="Create_the_init_config">Create the init config</span></h4>
<p>You can create this file anywhere, but we will go with <code>/etc/kubeadm</code> for this example.
</p>
<pre># mkdir -pv /etc/kubeadm
# cd /etc/kubeadm
# kubeadm config print init-defaults &gt; init.yaml
</pre>
<p>This will produce the following file.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/kubeadm/init.yaml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">apiVersion: kubeadm.k8s.io/v1beta3
bootstrapTokens:
- groups:
  - system:bootstrappers:kubeadm:default-node-token
  token: abcdef.0123456789abcdef
  ttl: 24h0m0s
  usages:
  - signing
  - authentication
kind: InitConfiguration
localAPIEndpoint:
  advertiseAddress: 1.2.3.4
  bindPort: 6443
nodeRegistration:
  criSocket: unix:///var/run/containerd/containerd.sock
  imagePullPolicy: IfNotPresent
  name: node
  taints: null
---
apiServer:
  timeoutForControlPlane: 4m0s
apiVersion: kubeadm.k8s.io/v1beta3
certificatesDir: /etc/kubernetes/pki
clusterName: kubernetes
controllerManager: {}
dns: {}
etcd:
  local:
    dataDir: /var/lib/etcd
imageRepository: registry.k8s.io
kind: ClusterConfiguration
kubernetesVersion: 1.29.0
networking:
  dnsDomain: cluster.local
  serviceSubnet: 10.96.0.0/12
scheduler: {}
</pre>
<p>Most of the default settings should work, though you will need to update a few of them.
</p>
<h5><span class="mw-headline" id="Bootstrap_token">Bootstrap token</span></h5>
<p>Create a token with <code>kubeadm token generate</code> and use it instead of <code>token: abcdef.0123456789abcdef</code> in the config.
</p>
<h5><span class="mw-headline" id="Advertise_address">Advertise address</span></h5>
<p>The <code>advertiseAddress: 1.2.3.4</code> should be an IPv4 address of a network interface on the control plane being initialized, probably something in the <code>192.168.0.0/16</code> subnet.
</p>
<h5><span class="mw-headline" id="Node_name">Node name</span></h5>
<p>The default node name can either be left at <code>node</code> and added to your local DNS server or hosts file, or you can change it to an address that is routable on your local network. It should be a DNS-compatible hostname, such as <code>kcp01.example.com</code>. This will allow your control plane to be found on your local network when you join other nodes.
</p>
<h4><span class="mw-headline" id="Init_the_cluster">Init the cluster</span></h4>
<p>With all of these changes set, we can initialize our cluster.
</p>
<pre># kubeadm init --config /etc/kubeadm/init.yaml
</pre>
<p>This will produce a good amount of output that will provide instructions on how to join nodes to the cluster, update your kubeconfig to interact with the new cluster, and other tasks.
</p>
<h5><span class="mw-headline" id="Use_calico_for_CNI_config">Use calico for CNI config</span></h5>
<p>The last thing you need before you can start adding nodes and running workloads is a properly configured CNI. This example will use <a rel="nofollow" class="external text" href="https://docs.tigera.io/calico/latest/getting-started/kubernetes/self-managed-onprem/onpremises">calico</a> for that. 
</p>
<pre># cd /etc/cni/net.d
# curl <a rel="nofollow" class="external free" href="https://raw.githubusercontent.com/projectcalico/calico/v3.27.2/manifests/calico.yaml">https://raw.githubusercontent.com/projectcalico/calico/v3.27.2/manifests/calico.yaml</a> -O
# kubectl create -f calico.yaml
</pre>
<p>If this completes successfully, you are ready to start adding nodes and running workloads on your cluster.
</p>
<h4><span class="mw-headline" id="Create_the_reset_config">Create the reset config</span></h4>
<p>Just in case <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kubeadm">kubeadm</a></span> does not land the init the first time, you can also create a config file for use with the reset command:
</p>
<pre># kubeadm config print reset-defaults &gt; /etc/kubeadm/reset.yaml
</pre>
<p>This will create the following file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/kubeadm/reset.yaml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">apiVersion: kubeadm.k8s.io/v1beta4
certificatesDir: /etc/kubernetes/pki
criSocket: unix:///var/run/containerd/containerd.sock
kind: ResetConfiguration
</pre>
<h5><span class="mw-headline" id="Reset_a_cluster">Reset a cluster</span></h5>
<p>To reset the cluster back to zero, run the following command:
</p>
<pre># kubeadm reset --config /etc/kubeadm/reset.yaml
</pre>
<p>This can be done as many times as required to sort out your cluster's ideal configuration.
</p>
<h4><span class="mw-headline" id="Create_the_join_config">Create the join config</span></h4>
<p>Most likely once you init the cluster you'll be able to join any nodes with the command listed in the output of the init command, but if you happen to run in to trouble it will be helpful to have a join config available on the nodes you're joining. You can either create this file on your control plane, or run the command on nodes that you intend to join to the cluster, we'll assume you did the latter.
</p>
<pre># kubeadm config print join-defaults &gt; /etc/kubeadm/join.yaml
</pre>
<p>This will create the following file.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/kubeadm/join.yaml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">apiVersion: kubeadm.k8s.io/v1beta3
caCertPath: /etc/kubernetes/pki/ca.crt
discovery:
  bootstrapToken:
    apiServerEndpoint: kcp01.example.com:6443
    token: abcdef.0123456789abcdef
    unsafeSkipCAVerification: true
  timeout: 5m0s
  tlsBootstrapToken: abcdef.0123456789abcdef
kind: JoinConfiguration
nodeRegistration:
  criSocket: unix:///var/run/containerd/containerd.sock
  imagePullPolicy: IfNotPresent
  name: node01.example.com
  taints: null
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You'll need to create two different tokens for this configuration file, the first for <code>discovery.bootstrapToken.token</code> and the second for the <code>discovery.tlsBootstrapToken</code> attribute.</div>
<h2><span class="mw-headline" id="Join_cluster">Join cluster</span></h2>
<p>With the token information generated in <a href="#Create_cluster">#Create cluster</a> it is possible to make another machine join the cluster as worker node with command <code>kubeadm join</code>.
</p>
<p>Remember you need to <a href="#Choose_container_runtime_interface_(CRI)">choose a container runtime interface</a> for working nodes as well by passing flag <code>&lt;SOCKET&gt;</code> to command <code>kubeadm join</code>. 
</p>
<p>For example:
</p>
<pre># kubeadm join <i>&lt;api-server-ip&gt;:&lt;port&gt;</i> --token <i>&lt;token&gt;</i> --discovery-token-ca-cert-hash sha256:<i>&lt;hash&gt;</i> --node-name=<i>&lt;name_of_the_node&gt;</i> --cri-socket=<i>&lt;SOCKET&gt;</i>
</pre>
<p>To generate new bootstrap token,
</p>
<pre>kubeadm token create --print-join-command
</pre>
<p>If you are using Cilium and find the working node remains to be <code>NotReady</code>, check the status of working node using:
</p>
<pre>kubectl describe node &lt;node-id&gt; --namespace=kube-system
</pre>
<p>If you found the following condition status: 
</p>
<pre>Type                  Status       Reason
----                  ------       ------
NetworkUnavailable    False        CiliumIsUp
Ready                 False        KubeletNotReady container runtime network not ready: NetworkReady=false reason:NetworkPluginNotReady message:Network plugin returns error: cni plugin not initialized
</pre>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">Restart</a> <code>containerd.service</code> and <code>kubelet.service</code> on the working node
</p>
<h2><span class="mw-headline" id="Tips_and_tricks">Tips and tricks</span></h2>
<h3><span class="mw-headline" id="Tear_down_a_cluster">Tear down a cluster</span></h3>
<p>When it is necessary to start from scratch, use <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kubectl">kubectl</a></span> to <a rel="nofollow" class="external text" href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/#tear-down">tear down</a> a cluster.
</p>
<pre>kubectl drain &lt;node name&gt; --delete-local-data --force --ignore-daemonsets
</pre>
<p>Here <code>&lt;node name&gt;</code> is the name of the node that should be drained and reset.
Use <code>kubectl get node -A</code> to list all nodes.
</p>
<p>Then reset the node:
</p>
<pre># kubeadm reset
</pre>
<h3><span class="mw-headline" id="Operating_from_behind_a_proxy">Operating from behind a proxy</span></h3>
<p><code>kubeadm</code> reads the <code>https_proxy</code>, <code>http_proxy</code>, and <code>no_proxy</code> environment variables. Kubernetes internal networking should be included in the latest one, for example
</p>
<pre>export no_proxy="192.168.122.0/24,10.96.0.0/12,192.168.123.0/24"
</pre>
<p>where the second one is the default service network CIDR.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="Failed_to_get_container_stats">Failed to get container stats</span></h3>
<p>If <code>kubelet.service</code> emits
</p>
<pre>Failed to get system container stats for "/system.slice/kubelet.service": failed to get cgroup stats for "/system.slice/kubelet.service": failed to get container info for "/system.slice/kubelet.service": unknown container "/system.slice/kubelet.service"
</pre>
<p>it is necessary to add configuration for the kubelet (see <a rel="nofollow" class="external text" href="https://github.com/kubernetes/kubernetes/issues/56850">relevant upstream ticket</a>).
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/var/lib/kubelet/config.yaml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">systemCgroups: '/systemd/system.slice'
kubeletCgroups: '/systemd/system.slice'
</pre>
<h3><span class="mw-headline" id="Pods_cannot_communicate_when_using_Flannel_CNI_and_systemd-networkd">Pods cannot communicate when using Flannel CNI and systemd-networkd</span></h3>
<p>See <a rel="nofollow" class="external text" href="https://github.com/flannel-io/flannel/issues/1321#issuecomment-678284129">upstream bug report</a>.
</p>
<p><a href="../en/Systemd-networkd.html" title="Systemd-networkd">systemd-networkd</a> assigns a persistent MAC address to every link. This policy is defined in its shipped configuration file <code>/usr/lib/systemd/network/99-default.link</code>. However, <a rel="nofollow" class="external text" href="https://github.com/flannel-io/flannel/">Flannel</a> relies on being able to pick its own MAC address. To override systemd-networkd's behaviour for <code>flannel<i>*</i></code> interfaces, create the following configuration file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/network/50-flannel.link</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Match]
OriginalName=flannel*

[Link]
MACAddressPolicy=none</pre>
<p>Then <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">restart</a> <code>systemd-networkd.service</code>.
</p>
<p>If the cluster is already running, you might need to manually delete the <code>flannel.1</code> interface and the <code>kube-flannel-ds-<i>*</i></code> pod on each node, including the master. The pods will be recreated immediately and they themselves will recreate the <code>flannel.1</code> interfaces.
</p>
<p>Delete the interface <code>flannel.1</code>:
</p>
<pre># ip link delete flannel.1
</pre>
<p>Delete the <code>kube-flannel-ds-<i>*</i></code> pod. Use the following command to delete all <code>kube-flannel-ds-<i>*</i></code> pods on all nodes:
</p>
<pre>$ kubectl -n kube-system delete pod -l="app=flannel"
</pre>
<h3>
<span id="CoreDNS_Pod_pending_forever.2C_the_control_plane_node_remains_.22NotReady.22"></span><span class="mw-headline" id='CoreDNS_Pod_pending_forever,_the_control_plane_node_remains_"NotReady"'>CoreDNS Pod pending forever, the control plane node remains "NotReady"</span>
</h3>
<p>When bootstrap the Kubernetes with <code>kubeadm init</code> on a single machine, and there is no other machine <code>kubeadm join</code> the cluster, the control-plane node is default to be tainted. As a result, no workload will be scheduled on the working machine.
</p>
<p>One can confirm the control-plane node is tainted by the following commands: 
</p>
<pre>kubectl get nodes -o json | jq '.items[].spec.taints
</pre>
<p>To temporarily allow scheduling on the control-plane node, execute:
</p>
<pre>kubectl taint nodes &lt;your-node-name&gt; node-role.kubernetes.io/control-plane:NoSchedule-
</pre>
<p>Then <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">restart</a> <code>containerd.service</code> and <code>kubelet.service</code> to apply the updates.
</p>
<h3>
<span id=".5Bkubelet-finalize.5D_malformed_header:_missing_HTTP_content-type"></span><span class="mw-headline" id="[kubelet-finalize]_malformed_header:_missing_HTTP_content-type">[kubelet-finalize] malformed header: missing HTTP content-type</span>
</h3>
<p>You may have forgotten to <a href="#Choose_cgroup_driver_for_containerd">choose systemd cgroup driver</a>. See <a rel="nofollow" class="external text" href="https://github.com/kubernetes/kubeadm/issues/2767#issuecomment-1623967664">kubeadm issue 2767</a> reporting this.
</p>
<h3><span class="mw-headline" id="CoreDNS_Pod_does_not_start_due_to_loops">CoreDNS Pod does not start due to loops</span></h3>
<p>When the host node runs a local DNS cache such as <a href="../en/Systemd-resolved.html" title="Systemd-resolved">systemd-resolved</a>, the CoreDNS may fail to start due to detecting a forwarding loop. This can be checked as follows:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># kubectl get pods -n kube-system</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">NAME                               READY   STATUS             RESTARTS      AGE
cilium-jc98m                       1/1     Running            0             21m
cilium-operator-64664858c8-zjzcq   1/1     Running            0             21m
coredns-7db6d8ff4d-29zfg           0/1     CrashLoopBackOff   6 (41s ago)   21m
coredns-7db6d8ff4d-zlvsm           0/1     CrashLoopBackOff   6 (50s ago)   21m
etcd-k8s                           1/1     Running            19            21m
kube-apiserver-k8s                 1/1     Running            17            21m
kube-controller-manager-k8s        1/1     Running            16            21m
kube-proxy-cvntt                   1/1     Running            0             21m
kube-scheduler-k8s                 1/1     Running            23            21m
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># kubectl logs -n kube-system coredns-7db6d8ff4d-29zfg</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
[FATAL] plugin/loop: Loop ([::1]:46171 -&gt; :53) detected for zone ".", see <a rel="nofollow" class="external free" href="https://coredns.io/plugins/loop#troubleshooting">https://coredns.io/plugins/loop#troubleshooting</a>. Query: "HINFO 64811921068182325.3042126689798234092."
</pre>
<p>This is caused by <i>kubelet</i> passing the host <code>/etc/resolv.conf</code> file, to all Pods using the default <code>dnsPolicy</code>. CoreDNS uses this <code>/etc/resolv.conf</code> as a list of upstreams to forward requests to. Since it contains a loopback address such as 127.0.0.53, CoreDNS ends up forwarding requests to itself.
</p>
<p>See <a rel="nofollow" class="external free" href="https://coredns.io/plugins/loop/#troubleshooting">https://coredns.io/plugins/loop/#troubleshooting</a> to resolve the issue.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://kubernetes.io/docs/home/">Kubernetes Documentation</a> - The upstream documentation</li>
<li>
<a rel="nofollow" class="external text" href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/">Kubernetes Cluster with Kubeadm</a> - Upstream documentation on how to setup a Kubernetes cluster using kubeadm</li>
<li>
<a rel="nofollow" class="external text" href="https://kubernetes.io/docs/reference/glossary/?fundamental=true">Kubernetes Glossary</a> - The official glossary explaining all Kubernetes specific terminology</li>
<li>
<a rel="nofollow" class="external text" href="https://kubernetes.io/docs/concepts/cluster-administration/addons/">Kubernetes Addons</a> - A list of third-party addons</li>
<li>
<a rel="nofollow" class="external text" href="https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/">Kubelet Config File</a> - Documentation on the Kubelet configuration file</li>
<li>
<a rel="nofollow" class="external text" href="https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/">Taints and Tolerations</a> - Documentation on node affinities and taints</li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Virtualization.html" title="Category:Virtualization">Virtualization</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Style.html" title="Category:Pages or sections flagged with Template:Style">Pages or sections flagged with Template:Style</a></li>
<li><a href="../en/Category:Sections_flagged_with_Template:Remove.html" title="Category:Sections flagged with Template:Remove">Sections flagged with Template:Remove</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Kubernetes&amp;oldid=819378">https://wiki.archlinux.org/index.php?title=Kubernetes&amp;oldid=819378</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 21 October 2024, at 11:53.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
