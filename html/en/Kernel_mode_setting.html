<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Kernel mode setting - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Kernel_mode_setting rootpage-Kernel_mode_setting skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Background" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Background">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Background</div>
		</a>
		
		<ul id="toc-Background-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Configuration</div>
		</a>
		
			<button aria-controls="toc-Configuration-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configuration subsection</span>
			</button>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
			<li id="toc-Late_KMS_start" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Late_KMS_start">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Late KMS start</div>
			</a>
			
			<ul id="toc-Late_KMS_start-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Early_KMS_start" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Early_KMS_start">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>Early KMS start</div>
			</a>
			
			<ul id="toc-Early_KMS_start-sublist" class="vector-toc-list">
				<li id="toc-mkinitcpio" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#mkinitcpio">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2.1</span>mkinitcpio</div>
			</a>
			
			<ul id="toc-mkinitcpio-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Booster" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Booster">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2.2</span>Booster</div>
			</a>
			
			<ul id="toc-Booster-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Troubleshooting">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Troubleshooting</div>
		</a>
		
			<button aria-controls="toc-Troubleshooting-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Troubleshooting subsection</span>
			</button>
		
		<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
			<li id="toc-My_fonts_are_too_tiny" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#My_fonts_are_too_tiny">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>My fonts are too tiny</div>
			</a>
			
			<ul id="toc-My_fonts_are_too_tiny-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Forcing_modes_and_EDID" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Forcing_modes_and_EDID">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Forcing modes and EDID</div>
		</a>
		
			<button aria-controls="toc-Forcing_modes_and_EDID-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Forcing modes and EDID subsection</span>
			</button>
		
		<ul id="toc-Forcing_modes_and_EDID-sublist" class="vector-toc-list">
			<li id="toc-Forcing_modes" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Forcing_modes">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>Forcing modes</div>
			</a>
			
			<ul id="toc-Forcing_modes-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Disabling_modesetting" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Disabling_modesetting">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Disabling modesetting</div>
		</a>
		
		<ul id="toc-Disabling_modesetting-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Kernel mode setting</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 6 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-6" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">6 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-de mw-list-item"><a href="https://wiki.archlinux.de/title/KMS" title="KMS – Deutsch" lang="de" hreflang="de" class="interlanguage-link-target"><span>Deutsch</span></a></li>
<li class="interlanguage-link interwiki-es mw-list-item"><a href="../es/Kernel_mode_setting.html" title="Kernel mode setting – español" lang="es" hreflang="es" class="interlanguage-link-target"><span>Español</span></a></li>
<li class="interlanguage-link interwiki-fr mw-list-item"><a href="../fr/Kernel_mode_setting.html" title="Kernel mode setting – français" lang="fr" hreflang="fr" class="interlanguage-link-target"><span>Français</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/%E3%82%AB%E3%83%BC%E3%83%8D%E3%83%AB%E3%83%A2%E3%83%BC%E3%83%89%E8%A8%AD%E5%AE%9A" title="カーネルモード設定 – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-ru mw-list-item"><a href="../ru/Kernel_mode_setting.html" title="Kernel mode setting – русский" lang="ru" hreflang="ru" class="interlanguage-link-target"><span>Русский</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/Kernel_mode_setting" title="Kernel mode setting – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/ATI.html" title="ATI">ATI</a></li>
<li><a href="../en/Intel_graphics.html" title="Intel graphics">Intel graphics</a></li>
<li><a href="../en/Nouveau.html" title="Nouveau">Nouveau</a></li>
</ul>
</div>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-view-fullscreen.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs expansion.</b></p>
<div>
<b>Reason:</b> KMS and rootless X (1.16), see <a href="../en/Talk:Kernel_mode_setting.html" title="Talk:Kernel mode setting">Talk:Kernel mode setting</a> and <a href="../en/Xorg.html#Rootless_Xorg" title="Xorg">Xorg#Rootless Xorg</a>. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Kernel_mode_setting.html">Talk:Kernel mode setting</a>)</div>
</div>
<p>Kernel <a href="https://en.wikipedia.org/wiki/Mode-setting" class="extiw" title="wikipedia:Mode-setting">Mode Setting</a> (KMS) is a method for setting display resolution and depth in the kernel space rather than user space.
</p>
<p>The Linux kernel's implementation of KMS enables native resolution in the framebuffer and allows for instant console (tty) switching.  KMS also enables newer technologies (such as <a href="https://en.wikipedia.org/wiki/Direct_Rendering_Infrastructure#DRI2" class="extiw" title="wikipedia:Direct Rendering Infrastructure">DRI2</a>) which will help reduce artifacts and increase 3D performance, even kernel space power-saving.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The proprietary <a href="../en/NVIDIA.html" title="NVIDIA">NVIDIA</a> driver (since 364.12) also implements kernel mode-setting, but it does not use the built-in kernel implementation and a fbdev driver for the high-resolution console is only present as an opt-in experimental feature (since 545.29)</div>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Background">Background</span></h2>
<p>Previously, setting up the video card was the job of the X server. Because of this, it was not easily possible to have fancy graphics in <a href="../en/Linux_console.html#Virtual_consoles" class="mw-redirect" title="Virtual console">virtual consoles</a>. Also, each time a switch from X to a virtual console was made (<code>Ctrl+Alt+F2</code>), the server had to give control over the video card to the kernel, which was slow and caused flickering. The same "painful" process happened when the control was given back to the X server (<code>Alt+F7</code> when X runs in VT7).
</p>
<p>With Kernel Mode Setting (KMS), the kernel is now able to set the mode of the video card. This makes fancy graphics during bootup, virtual console and X fast switching possible, among other things.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>At first, note that for <i>any</i> method you use, you should <i>always</i> disable:
</p>
<ul>
<li>Any <code>vga=</code> options in your bootloader as these will conflict with the native resolution enabled by KMS.</li>
<li>Any <code>video=</code> lines that enable a framebuffer that conflicts with the driver.</li>
<li>Any other framebuffer drivers (such as <a href="../en/Uvesafb.html" title="Uvesafb">uvesafb</a>).</li>
</ul>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:View-refresh-red.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section is out of date.</b></p>
<div>
<b>Reason:</b> Arch <a href="../en/Kernel.html#Officially_supported_kernels" title="Kernel">officially supported kernels</a> have <i>simpledrm</i> KMS driver inbuilt <a rel="nofollow" class="external autonumber" href="https://gitlab.archlinux.org/archlinux/packaging/packages/linux/-/blob/88ea405f03782d77b9cb30f54efa1f52280e53aa/config#L6955">[1]</a> for years now. Which means Arch users <b>always</b> have early KMS start. So this section is more about "when <i>simpledrm</i> transfers control to another driver". (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Kernel_mode_setting.html">Talk:Kernel mode setting</a>)</div>
</div>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-view-fullscreen.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs expansion.</b></p>
<div>
<b>Reason:</b> Mention <i>simpledrm</i> and its ability to work as a generic graphics driver. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Kernel_mode_setting.html">Talk:Kernel mode setting</a>)</div>
</div>
<h3><span class="mw-headline" id="Late_KMS_start">Late KMS start</span></h3>
<p><a href="../en/Intel_graphics.html" class="mw-redirect" title="Intel">Intel</a>, <a href="../en/Nouveau.html" title="Nouveau">Nouveau</a>, <a href="../en/ATI.html" title="ATI">ATI</a> and <a href="../en/AMDGPU.html" title="AMDGPU">AMDGPU</a> drivers already enable KMS automatically for all chipsets, so you do not need to do anything.
</p>
<p>The proprietary <a href="../en/NVIDIA.html" title="NVIDIA">NVIDIA</a> driver supports KMS (since 364.12), which has to be <a href="../en/NVIDIA.html#DRM_kernel_mode_setting" title="NVIDIA">manually enabled</a>.
</p>
<h3><span class="mw-headline" id="Early_KMS_start">Early KMS start</span></h3>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> If you encounter problems with the resolution, you can check whether <a href="#Forcing_modes_and_EDID">enforcing the mode</a> helps.</div>
<p>KMS is typically initialized after the <a href="../en/Arch_boot_process.html#initramfs" title="Arch boot process">initramfs stage</a>. However, it is possible to enable KMS already during the initramfs stage. Add the required module for the <a href="../en/Xorg.html#Driver_installation" title="Xorg">video driver</a> to the initramfs configuration file:
</p>
<ul>
<li>
<code>amdgpu</code> for <a href="../en/AMDGPU.html" title="AMDGPU">AMDGPU</a>, or <code>radeon</code> when using the legacy <a href="../en/ATI.html" title="ATI">ATI</a> driver.</li>
<li>
<code>i915</code> for <a href="../en/Intel_graphics.html" title="Intel graphics">Intel graphics</a>.</li>
<li>
<code>nouveau</code> for the open-source <a href="../en/Nouveau.html" title="Nouveau">Nouveau</a> driver.</li>
<li>
<code>nvidia nvidia_modeset nvidia_uvm nvidia_drm</code> for the out-of-tree <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nvidia">nvidia</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nvidia-open">nvidia-open</a></span> drivers. See <a href="../en/NVIDIA.html#DRM_kernel_mode_setting" title="NVIDIA">NVIDIA#DRM kernel mode setting</a> for details.</li>
</ul>
<ul>
<li>
<code>mgag200</code> for Matrox graphics.</li>
<li>Depending on <a href="../en/QEMU.html" title="QEMU">QEMU</a> graphics in use (<i>qemu</i> option <code>-vga <i>type</i></code> or <a href="../en/Libvirt.html" title="Libvirt">libvirt</a> <code>&lt;video&gt;&lt;model type='<i>type</i>'&gt;</code><a rel="nofollow" class="external autonumber" href="https://libvirt.org/formatdomain.html#video-devices">[2]</a>):
<ul>
<li>
<code>bochs</code> for <code>std</code> (<i>qemu</i>) and <code>vga</code>/<code>bochs</code> (<i>libvirt</i>),</li>
<li>
<code>virtio-gpu</code> for <code>virtio</code>,</li>
<li>
<code>qxl</code> for <code>qxl</code>,</li>
<li>
<code>vmwgfx</code> for <code>vmware</code> (<i>qemu</i>) and <code>vmvga</code> (<i>libvirt</i>),</li>
<li>
<code>cirrus</code> for <code>cirrus</code>.</li>
</ul>
</li>
<li>Depending on <a href="../en/VirtualBox.html" title="VirtualBox">VirtualBox</a> graphics controller:
<ul>
<li>
<code>vmwgfx</code> for VMSVGA,</li>
<li>
<code>vboxvideo</code> for VBoxVGA or VBoxSVGA.</li>
</ul>
</li>
</ul>
<p>Initramfs configuration instructions are slightly different depending on the initramfs generator you use.
</p>
<h4><span class="mw-headline" id="mkinitcpio">mkinitcpio</span></h4>
<p>For in-tree modules, make sure <code>kms</code> is included in the HOOKS array in <code>/etc/mkinitcpio.conf</code> (this is the default since <a rel="nofollow" class="external text" href="https://gitlab.archlinux.org/archlinux/mkinitcpio/mkinitcpio/-/merge_requests/126/diffs#57ac3bb5162944ca1d6c5fa29ff4d7cc886e04bb_53_52">mkinitcpio v33</a>).
</p>
<p>For out-of-tree modules, place the module names in the MODULES array. For example, to enable early KMS for the NVIDIA graphics driver:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">MODULES=(... nvidia nvidia_modeset nvidia_uvm nvidia_drm ...)</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you use <a href="../en/PRIME.html" title="PRIME">PRIME</a> Graphics Processing Unit (GPU) with Intel Integrated Graphics Processors (IGP) being your primary GPU and AMD as the discrete one, <code>intel_agp</code> may lead to troubles when resuming from hibernation (monitor gets no signal). See <a rel="nofollow" class="external autonumber" href="https://bbs.archlinux.org/viewtopic.php?id=262043">[3]</a> for details.</div>
<p>If you are using the <a href="#Forcing_modes_and_EDID">#Forcing modes and EDID</a> method, you should embed the custom file into <a href="../en/Arch_boot_process.html#initramfs" class="mw-redirect" title="Initramfs">initramfs</a> as well:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">FILES=(/usr/lib/firmware/edid/<i>your_edid</i>.bin)</pre>
<p>Then <a href="../en/Mkinitcpio.html#Image_creation_and_activation" class="mw-redirect" title="Regenerate the initramfs">regenerate the initramfs</a>.
</p>
<h4><span class="mw-headline" id="Booster">Booster</span></h4>
<p>If you use <a href="../en/Booster.html" title="Booster">Booster</a>, you can load required modules with this config change:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/booster.yaml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">modules_force_load: i915
</pre>
<p>If you are using the <a href="#Forcing_modes_and_EDID">#Forcing modes and EDID</a> method, you should embed the custom file into your booster images as well:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/booster.yaml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">extra_files: /usr/lib/firmware/edid/<i>your_edid</i>.bin
</pre>
<p>Then <a href="../en/Booster.html#Regenerate_booster_images" title="Booster">regenerate</a> the booster images.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="My_fonts_are_too_tiny">My fonts are too tiny</span></h3>
<p>See <a href="../en/Linux_console.html#Fonts" title="Linux console">Linux console#Fonts</a> for how to change your console font to a large font. The Terminus font (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=terminus-font">terminus-font</a></span>) is available in many sizes, such as <code>ter-132b</code> which is larger.
</p>
<p>Alternatively, <a href="#Disabling_modesetting">disabling modesetting</a> might switch to lower resolution and make fonts appear larger.
</p>
<h2><span class="mw-headline" id="Forcing_modes_and_EDID">Forcing modes and EDID</span></h2>
<p>If your native resolution is not automatically configured or no display at all is detected, then your monitor might send none or just a skewed <a href="https://en.wikipedia.org/wiki/EDID" class="extiw" title="wikipedia:EDID">EDID</a> file. The kernel will try to catch this case and will set one of the most typical resolutions.
</p>
<p>In case you have the EDID file for your monitor, you merely need to explicitly enforce it (see below). However, most often one does not have direct access to a sane file and it is necessary to either extract an existing one and fix it or to generate a new one.
</p>
<p>Generating new EDID binaries for various resolutions and configurations is possible during kernel compilation by following the <a rel="nofollow" class="external text" href="https://docs.kernel.org/admin-guide/edid.html">upstream documentation</a> (also see <a rel="nofollow" class="external text" href="https://www.osadl.org/Single-View.111+M5315d29dd12.0.html">here</a> for a short guide). Other solutions are outlined in details in this <a rel="nofollow" class="external text" href="https://kodi.wiki/view/Archive:Creating_and_using_edid.bin_via_xorg.conf">article</a>.
Extracting an existing one is in most cases easier, e.g. if your monitor works fine under Windows, you might have luck extracting the EDID from the corresponding driver, or if a similar monitor works which has the same settings, you may use <span class="plainlinks archwiki-template-man" title="$ man 1 get-edid"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/get-edid.1">get-edid(1)</a></span> from the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=read-edid">read-edid</a></span> package. You can also try looking in <code>/sys/class/drm/*/edid</code>.
</p>
<p>After having prepared your EDID, place it in a directory, e.g. called <code>edid</code> under <code>/usr/lib/firmware/</code> and copy your binary into it.
</p>
<p>To load it at boot, specify the following in the <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel command line">kernel command line</a>:
</p>
<pre>drm.edid_firmware=edid/your_edid.bin
</pre>
<p>In order to apply it only to a specific connector, use:
</p>
<pre>drm.edid_firmware=VGA-1:edid/your_edid.bin
</pre>
<p>If you want to set multiple edid files, use:
</p>
<pre>drm.edid_firmware=VGA-1:edid/your_edid.bin,VGA-2:edid/your_other_edid.bin
</pre>
<p>For the built-in resolutions, refer to the table below. The <b>Name</b> column specifies the name which one is supposed to use in order to enforce its usage.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Users of kernel version &gt;=6.9 have to provide their own custom EDID binary as the built-in modes were removed in <a rel="nofollow" class="external text" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=89ac522d4507126d353834973ddbbf7b6acfdeef">version 6.9</a>.</div> 
<table class="wikitable">

<tbody>
<tr>
<th>Resolution</th>
<th>Name
</th>
</tr>
<tr>
<td>800x600</td>
<td>edid/800x600.bin
</td>
</tr>
<tr>
<td>1024x768</td>
<td>edid/1024x768.bin
</td>
</tr>
<tr>
<td>1280x1024</td>
<td>edid/1280x1024.bin
</td>
</tr>
<tr>
<td>1600x1200 (kernel 3.10 or higher)</td>
<td>edid/1600x1200.bin
</td>
</tr>
<tr>
<td>1680x1050</td>
<td>edid/1680x1050.bin
</td>
</tr>
<tr>
<td>1920x1080</td>
<td>edid/1920x1080.bin
</td>
</tr>
</tbody>
</table>
<p>If you are doing <a href="#Early_KMS_start">early KMS</a>, you must <a href="../en/Mkinitcpio.html#BINARIES_and_FILES" title="Mkinitcpio">include the custom EDID file in the initramfs</a>, otherwise you will run into problems.
</p>
<p>The value of the <code>drm.edid_firmware</code> parameter may also be altered after boot by writing to <code>/sys/module/drm/parameters/edid_firmware</code>:
</p>
<pre># echo edid/your_edid.bin &gt; /sys/module/drm/parameters/edid_firmware
</pre>
<p>This will only take effect for newly plugged in displays, already plugged-in screens will continue to use their existing EDID settings. For external displays, replugging them is sufficient to see the effect however.
</p>
<p>Since kernel 3.15, to load an EDID after boot, you can use debugfs instead of a kernel command line parameter if the kernel is not in <a href="../en/Security.html#Kernel_lockdown_mode" title="Security">lockdown mode</a>.  This is very useful if you swap the monitors on a connector or just for testing.  Once you have an EDID file as above, run:
</p>
<pre># cat correct-edid.bin &gt; /sys/kernel/debug/dri/0/HDMI-A-2/edid_override
</pre>
<p>And to disable:
</p>
<pre># echo -n reset &gt; /sys/kernel/debug/dri/0/HDMI-A-2/edid_override
</pre>
<p>If your monitor supports hotplugging, you can also trigger a hotplug to make the monitor use the new EDID you just loaded (e.g. into <code>edid_override</code>), so you don't have to physically replug the monitor nor reboot:
</p>
<pre># echo 1 &gt; /sys/kernel/debug/dri/0/HDMI-A-2/trigger_hotplug
</pre>
<h3><span class="mw-headline" id="Forcing_modes">Forcing modes</span></h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> The method described below is somehow incomplete because e.g. <a href="../en/Xorg.html" title="Xorg">Xorg</a> does not take into account the resolution specified, so users are encouraged to use the method described above. However, specifying resolution with <code>video=</code> command line may be useful in some scenarios.</div>
<p>From <a rel="nofollow" class="external text" href="https://nouveau.freedesktop.org/wiki/KernelModeSetting">the nouveau wiki</a>:
</p>
<dl><dd>A mode can be forced on the kernel command line. Unfortunately, the command line option video is poorly documented in the DRM case. Bits and pieces on how to use it can be found in
<ul>
<li><a rel="nofollow" class="external free" href="https://docs.kernel.org/fb/modedb.html">https://docs.kernel.org/fb/modedb.html</a></li>
<li><a rel="nofollow" class="external free" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/gpu/drm/drm_fb_helper.c">https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/gpu/drm/drm_fb_helper.c</a></li>
</ul>
</dd></dl>
<p>The format is:
</p>
<pre>video=&lt;driver&gt;:&lt;conn&gt;:&lt;xres&gt;x&lt;yres&gt;[M][R][-&lt;bpp&gt;][@&lt;refresh&gt;][i][m][eDd]
</pre>
<ul>
<li>
<code>&lt;driver&gt;</code>: Specify a video mode at bootup.</li>
<li>
<code>&lt;conn&gt;</code>: Specifies the video connection type, such as VGA, DVI, HDMI, etc., see <code>/sys/class/drm/</code> for available connectors</li>
<li>
<code>&lt;xres&gt;</code>: The horizontal resolution in pixels.</li>
<li>
<code>&lt;yres&gt;</code>: The vertical resolution in pixels.</li>
<li>
<code>[M]</code>: Enables the use of VESA Coordinated Video Timings (CVT) to calculate the video mode timings instead of looking up the mode from a database</li>
<li>
<code>[R]</code>: Enables reduced blanking calculations for digital displays when using CVT. This reduces the horizontal and vertical blanking intervals to save bandwidth.</li>
<li>
<code>[-&lt;bpp&gt;]</code>: Specifies the color depth or bits per pixel (e.g., -24 for 24-bit color).</li>
<li>
<code>[@&lt;refresh&gt;]</code>: Specifies the refresh rate in Hz.</li>
<li>
<code>[i]</code>: Enables interlaced mode.</li>
<li>
<code>[m]</code>: Adds margins to the CVT calculation (1.8% of xres rounded down to 8 pixels and 1.8% of yres)</li>
<li>
<code>[e]</code>: output forced to on</li>
<li>
<code>[D]</code>: digital output forced to on (e.g. DVI-I connector)</li>
<li>
<code>[d]</code>: output forced to off</li>
</ul>
<p>You can override the modes of several outputs using <code>video=</code> several times, for instance, to force <code>DVI</code> to <i>1024x768</i> at <i>85 Hz</i> and <code>TV-out</code> off: 
</p>
<pre>video=DVI-I-1:1024x768@85 video=TV-1:d
</pre>
<p>To get the name and current status of connectors, you can use the following shell oneliner:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ for p in /sys/class/drm/*/status; do con=${p%/status}; echo -n "${con#*/card?-}: "; cat $p; done</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">DVI-I-1: connected
HDMI-A-1: disconnected
VGA-1: disconnected
</pre>
<h2><span class="mw-headline" id="Disabling_modesetting">Disabling modesetting</span></h2>
<p>You may want to disable KMS for various reasons. To disable KMS, add <code>nomodeset</code> as a kernel parameter. See <a href="../en/Kernel_parameters.html" title="Kernel parameters">Kernel parameters</a> for more info.
</p>
<p>Along with the <code>nomodeset</code> kernel parameter, for an Intel graphics card, you need to add <code>i915.modeset=0</code>, and for an Nvidia graphics card, you need to add <code>nouveau.modeset=0</code>. For Nvidia Optimus dual-graphics system, you need to add all the three kernel parameters (i.e. <code>"nomodeset i915.modeset=0 nouveau.modeset=0"</code>).
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Some <a href="../en/Xorg.html" title="Xorg">Xorg</a> drivers will not work with KMS disabled. See the wiki page on your specific driver for details.</div>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Graphics.html" title="Category:Graphics">Graphics</a></li>
<li><a href="../en/Category:Kernel.html" title="Category:Kernel">Kernel</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Kernel_mode_setting&amp;oldid=814470">https://wiki.archlinux.org/index.php?title=Kernel_mode_setting&amp;oldid=814470</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 13 August 2024, at 15:45.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
