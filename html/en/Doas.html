<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>doas - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Doas rootpage-Doas skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Installation</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Usage" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Usage">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Usage</div>
		</a>
		
		<ul id="toc-Usage-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Configuration</div>
		</a>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Tips_and_tricks" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Tips_and_tricks">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Tips and tricks</div>
		</a>
		
			<button aria-controls="toc-Tips_and_tricks-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Tips and tricks subsection</span>
			</button>
		
		<ul id="toc-Tips_and_tricks-sublist" class="vector-toc-list">
			<li id="toc-doas_persist_feature" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#doas_persist_feature">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>doas persist feature</div>
			</a>
			
			<ul id="toc-doas_persist_feature-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Smooth_transition_sudo_to_doas" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Smooth_transition_sudo_to_doas">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2</span>Smooth transition sudo to doas</div>
			</a>
			
			<ul id="toc-Smooth_transition_sudo_to_doas-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Bash_tab_completion" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Bash_tab_completion">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.3</span>Bash tab completion</div>
			</a>
			
			<ul id="toc-Bash_tab_completion-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading">doas</h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 3 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-3" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">3 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Doas" title="Doas – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-ru mw-list-item"><a href="../ru/Doas.html" title="Doas – русский" lang="ru" hreflang="ru" class="interlanguage-link-target"><span>Русский</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/Doas" title="Doas – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<p><span>
</span>
</p>
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/Users_and_groups.html" title="Users and groups">Users and groups</a></li>
<li><a href="../en/Sudo.html" title="Sudo">sudo</a></li>
<li><a href="../en/List_of_applications/Security.html#Privilege_elevation" title="List of applications/Security">List of applications/Security#Privilege elevation</a></li>
</ul>
</div>
<p><a href="https://en.wikipedia.org/wiki/doas" class="extiw" title="wikipedia:doas">OpenDoas</a> is a portable version of OpenBSD's doas command, known for being substantially smaller in size compared to <a href="../en/Sudo.html" title="Sudo">sudo</a>. Like <i>sudo</i>, <i>doas</i> is used to assume the identity of another user on the system.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>Install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=opendoas">opendoas</a></span> package.
</p>
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
<p>To begin using <i>doas</i> as a non-privileged user, it must be properly configured. See <a href="#Configuration">#Configuration</a>.
</p>
<p>To use <i>doas</i>, simply prefix a command and its arguments with <code>doas</code> and a space:
</p>
<pre>$ doas <i>cmd</i>
</pre>
<p>For example, to use <a href="../en/Pacman.html" title="Pacman">pacman</a>:
</p>
<pre>$ doas pacman -Syu
</pre>
<p>To get to an interactive shell as an other user (omitting <code>-u <i>user</i></code> will default to root):
</p>
<pre>$ doas -su <i>user</i>
</pre>
<p>Logging in as an other user is needed for some commands, see <a href="../en/Sudo.html#Login_shell" title="Sudo">Sudo#Login shell</a>.
</p>
<p>For more information, see <span class="plainlinks archwiki-template-man" title="$ man 1 doas"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/doas.1">doas(1)</a></span>.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>After installing OpenDoas, it will be attached with <a href="../en/PAM.html" title="PAM">PAM</a>, but no default configuration or examples are included. 
</p>
<p>To allow members of group <a href="../en/Users_and_groups.html#Group_list" class="mw-redirect" title="Wheel">wheel</a> to run commands as other users, create a configuration file with the following content:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/doas.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">permit setenv {PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin} :wheel

</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>The configuration file must end with a newline.</li>
<li>The <code>setenv</code> option works around an <a rel="nofollow" class="external text" href="https://github.com/Duncaen/OpenDoas/issues/117">issue</a> arising from OpenDoas's BSD origin where additional system packages are stored under <code>/usr/local/bin</code>. In Linux <code>/usr/local/bin</code> is generally used to override executables so it comes before <code>/usr/bin</code> which contains executables from packages.</li>
</ul>
</div>
<p>The owner and group for <code>/etc/doas.conf</code> should both be <code>0</code>, file permissions should be set to <code>0400</code>:
</p>
<pre># chown -c root:root /etc/doas.conf
# chmod -c 0400 /etc/doas.conf
</pre>
<p>To check <code>/etc/doas.conf</code> for syntax errors, run:
</p>
<pre># if doas -C /etc/doas.conf; then echo "config ok"; else echo "config error"; fi
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> It is imperative that <code>/etc/doas.conf</code> is free of syntax errors!</div>
<p>To allow members of the <code>plugdev</code> group to run <a href="../en/S.M.A.R.T..html#smartctl" class="mw-redirect" title="Smartctl">smartctl</a> without password as <a href="../en/Users_and_groups.html#Overview" class="mw-redirect" title="Root user">Root user</a>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/doas.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">permit nopass :plugdev as root cmd /usr/bin/smartctl
</pre>
<p>The general syntax form of <code>/etc/doas.conf</code> is:
</p>
<pre>permit|deny [options] identity [as target] [cmd command [args ...]]
</pre>
<p>The last matching rule determines the action taken, so rules must be ordered accordingly.
</p>
<p>For more details please read <span class="plainlinks archwiki-template-man" title="$ man 5 doas.conf"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/doas.conf.5">doas.conf(5)</a></span>.
</p>
<h2><span class="mw-headline" id="Tips_and_tricks">Tips and tricks</span></h2>
<h3><span class="mw-headline" id="doas_persist_feature">doas persist feature</span></h3>
<p><i>doas</i> provides a persist feature: after the user successfully authenticates, they will not be prompted for a password again for some time. It is disabled by default, enable it with the <code>persist</code> option:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/doas.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">permit <b>persist</b> setenv {PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin} :wheel
</pre>
<p>Executing <code>doas -L</code> clears a persisted authentication prior to its automatic timeout.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The persist feature is disabled by default, because it is potentially dangerous. In the original <i>doas</i>, a kernel API is used to set and clear timeouts. This API is OpenBSD specific and no similar API is available on other operating systems. As a workaround, the persist feature is implemented using timestamp files similar to <i>sudo</i>.</div>
<h3><span class="mw-headline" id="Smooth_transition_sudo_to_doas">Smooth transition sudo to doas</span></h3>
<p>For a smooth transition from <i>sudo</i> to <i>doas</i> and to stay downward compatible, you could add to your environment:
</p>
<pre>alias sudo='doas'
alias sudoedit='doas rnano'
</pre>
<p>Or alternatively, symlink <i>doas</i> to where <i>sudo</i> would normally be (but it does not provide <code>sudoedit</code> command):
</p>
<pre># ln -s $(which doas) /usr/bin/sudo
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> By default <i>sudo</i> preserves some environment variables while <i>doas</i> does not, most notably XAUTHORITY, LANG and LC_ALL. This means you will not be able to start graphical applications under X nor to access the user's locale without further configuration. For instance, to allow members of the <i>wheel</i> group to run graphical applications and to access the user's locale using the setenv option:
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/doas.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">permit setenv { XAUTHORITY LANG LC_ALL } :wheel
</pre>
</div>
<h3><span class="mw-headline" id="Bash_tab_completion">Bash tab completion</span></h3>
<p>By default Bash will only tab complete files and directories within the current or referenced directory. To tell Bash to complete arguments as if they were separate commands (also leveraging the tab completion settings of other commands) the following can be added to either the users <code>.bashrc</code>, or the global <code>/etc/bash.bashrc</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.bashrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">complete -cf doas
</pre>
<p>If <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bash-completion">bash-completion</a></span> is installed, the following can be used instead to allow for additional completion of the target command:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.bashrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">complete -F _command doas
</pre>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Security.html" title="Category:Security">Security</a></li>
<li><a href="../en/Category:Commands.html" title="Category:Commands">Commands</a></li>
</ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Doas&amp;oldid=811643">https://wiki.archlinux.org/index.php?title=Doas&amp;oldid=811643</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 30 June 2024, at 13:13.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
