<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-os vector-sticky-header-enabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>PPTP Client - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.45.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-PPTP_Client rootpage-PPTP_Client skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Installation</span>
			</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Configure" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configure">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Configure</span>
			</div>
		</a>
		
			<button aria-controls="toc-Configure-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configure subsection</span>
			</button>
		
		<ul id="toc-Configure-sublist" class="vector-toc-list">
			<li id="toc-Configure_using_pptpsetup" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configure_using_pptpsetup">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1</span>
					<span>Configure using <i>pptpsetup</i></span>
				</div>
			</a>
			
			<ul id="toc-Configure_using_pptpsetup-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Configure_by_hand" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configure_by_hand">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2</span>
					<span>Configure by hand</span>
				</div>
			</a>
			
			<ul id="toc-Configure_by_hand-sublist" class="vector-toc-list">
				<li id="toc-Edit_The_options_File" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Edit_The_options_File">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2.1</span>
					<span>Edit The options File</span>
				</div>
			</a>
			
			<ul id="toc-Edit_The_options_File-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Edit_The_chap-secrets_File" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Edit_The_chap-secrets_File">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2.2</span>
					<span>Edit The chap-secrets File</span>
				</div>
			</a>
			
			<ul id="toc-Edit_The_chap-secrets_File-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Name_Your_Tunnel" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Name_Your_Tunnel">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2.3</span>
					<span>Name Your Tunnel</span>
				</div>
			</a>
			
			<ul id="toc-Name_Your_Tunnel-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Connect" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Connect">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Connect</span>
			</div>
		</a>
		
			<button aria-controls="toc-Connect-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Connect subsection</span>
			</button>
		
		<ul id="toc-Connect-sublist" class="vector-toc-list">
			<li id="toc-Routing" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Routing">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1</span>
					<span>Routing</span>
				</div>
			</a>
			
			<ul id="toc-Routing-sublist" class="vector-toc-list">
				<li id="toc-Split_Tunneling" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Split_Tunneling">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1.1</span>
					<span>Split Tunneling</span>
				</div>
			</a>
			
			<ul id="toc-Split_Tunneling-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Route_All_Traffic" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Route_All_Traffic">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1.2</span>
					<span>Route All Traffic</span>
				</div>
			</a>
			
			<ul id="toc-Route_All_Traffic-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Route_All_Traffic_by_/etc/ppp/ip-up.d" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Route_All_Traffic_by_/etc/ppp/ip-up.d">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1.3</span>
					<span>Route All Traffic by /etc/ppp/ip-up.d</span>
				</div>
			</a>
			
			<ul id="toc-Route_All_Traffic_by_/etc/ppp/ip-up.d-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Split_Tunneling_based_on_port_by_/etc/ppp/ip-up.d" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Split_Tunneling_based_on_port_by_/etc/ppp/ip-up.d">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1.4</span>
					<span>Split Tunneling based on port by /etc/ppp/ip-up.d</span>
				</div>
			</a>
			
			<ul id="toc-Split_Tunneling_based_on_port_by_/etc/ppp/ip-up.d-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Disconnect" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Disconnect">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">4</span>
				<span>Disconnect</span>
			</div>
		</a>
		
		<ul id="toc-Disconnect-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Making_A_VPN_Daemon_and_Connecting_On_Boot" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Making_A_VPN_Daemon_and_Connecting_On_Boot">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">5</span>
				<span>Making A VPN Daemon and Connecting On Boot</span>
			</div>
		</a>
		
		<ul id="toc-Making_A_VPN_Daemon_and_Connecting_On_Boot-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Troubleshooting">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">6</span>
				<span>Troubleshooting</span>
			</div>
		</a>
		
		<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Remarks" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Remarks">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">7</span>
				<span>Remarks</span>
			</div>
		</a>
		
		<ul id="toc-Remarks-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar no-font-mode-scale">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left" title="Table of Contents">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">PPTP Client</span></h1>
							
</header>
				<div class="vector-column-end no-font-mode-scale">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/PPTP_server.html" title="PPTP server">PPTP server</a></li>
</ul>
</div>
<p>pptpclient is a program implementing the Microsoft PPTP protocol. As such, it can be used to connect to a Microsoft VPN network (or any PPTP-based VPN) provided by a school or workplace.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning</strong> The PPTP protocol is inherently insecure. See <a rel="nofollow" class="external free" href="https://poptop.sourceforge.net/dox/protocol-security.phtml">https://poptop.sourceforge.net/dox/protocol-security.phtml</a> for details.</div>
<meta property="mw:PageProp/toc">
<div class="mw-heading mw-heading2"><h2 id="Installation">Installation</h2></div>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pptpclient">pptpclient</a></span> package.
</p>
<div class="mw-heading mw-heading2"><h2 id="Configure">Configure</h2></div>
<p>To configure pptpclient you will need to collect the following information from your network administrator:
</p>
<ul>
<li>The IP address or hostname of the VPN server.</li>
<li>The username you will use to connect.</li>
<li>The password you will use to connect.</li>
<li>The authentication (Windows) domain name. This is not necessary for certain networks.</li>
</ul>
<p>You must also decide what to name the tunnel.
</p>
<div class="mw-heading mw-heading3"><h3 id="Configure_using_pptpsetup">Configure using <i>pptpsetup</i>
</h3></div>
<p>You can configure and delete tunnels by running the <i>pptpsetup</i> tool as root. For example:
</p>
<pre>pptpsetup --create my_tunnel --server vpn.example.com --username archie --password foo --encrypt
pptpsetup --delete my_tunnel
</pre>
<p>You can <a href="#Connect">#Connect</a> after a tunnel has been configured.
</p>
<div class="mw-heading mw-heading3"><h3 id="Configure_by_hand">Configure by hand</h3></div>
<p>You can also edit all necessary configuration files by hand, rather than relying on <i>pptpsetup</i>.
</p>
<div class="mw-heading mw-heading4"><h4 id="Edit_The_options_File">Edit The options File</h4></div>
<p>The <code>/etc/ppp/options</code> file sets security options for your VPN client. If you have trouble connecting to your network, you may need to relax the options. At a minimum, this file should contain the options <code>lock</code>, <code>noauth</code>, <code>nobsdcomp</code> and <code>nodeflate</code>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ppp/options</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># Lock the port
lock
# We don't need the tunnel server to authenticate itself
noauth
# Turn off compression protocols we know won't be used
nobsdcomp
nodeflate
# We won't do PAP, EAP, CHAP, or MSCHAP, but we will accept MSCHAP-V2
# (you may need to remove these refusals if the server is not using MPPE)
refuse-pap
refuse-eap
refuse-chap
refuse-mschap</pre>
<div class="mw-heading mw-heading4"><h4 id="Edit_The_chap-secrets_File">Edit The chap-secrets File</h4></div>
<p>The <code>/etc/ppp/chap-secrets</code> file contains credentials for authenticating a tunnel. Make sure no one except root can read this file, as it contains sensitive information.
</p>
<pre>chmod 0600 /etc/ppp/chap-secrets
</pre>
<p>Edit the file. It has the following format:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ppp/chap-secrets</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">&lt;DOMAIN&gt;\\&lt;USERNAME&gt; PPTP &lt;PASSWORD&gt; *</pre>
<p>Replace each bracketed term with an appropriate value. Omit <code>&lt;DOMAIN&gt;\\</code> if your connection does not require a domain.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> Place your password in double quotation marks (<code>"</code>) if it contains special characters such as <code>$</code>.</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning</strong> This file contains passwords in plain text. Guard it well!</div>
<div class="mw-heading mw-heading4"><h4 id="Name_Your_Tunnel">Name Your Tunnel</h4></div>
<p>The <code>/etc/ppp/peers/&lt;TUNNEL&gt;</code> file contains tunnel-specific configuration options. <code>&lt;TUNNEL&gt;</code> is the name you wish to use for your VPN connection. The file should look like this:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ppp/peers/&lt;TUNNEL&gt;</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">pty "pptp &lt;SERVER&gt; --nolaunchpppd"
name &lt;DOMAIN&gt;\\&lt;USERNAME&gt;
remotename PPTP
require-mppe-128
file /etc/ppp/options
ipparam &lt;TUNNEL&gt;</pre>
<p>Again, omit <code>&lt;DOMAIN&gt;\\</code> if your connection does not require a domain. <code>&lt;SERVER&gt;</code> is the remote address of the VPN server, <code>&lt;DOMAIN&gt;</code> is the domain your user belongs to, <code>&lt;USERNAME&gt;</code> is the name you will use to connect to the server, and <code>&lt;TUNNEL&gt;</code> is the name of the connection.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> <code>remotename PPTP</code> is used to find <code>&lt;PASSWORD&gt;</code> in the <code>/etc/ppp/chap-secrets</code> File.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> If you do not need MPPE support, you should remove the <code>require-mppe-128</code> option from this file and from <code>/etc/ppp/options</code>
</div>
<div class="mw-heading mw-heading2"><h2 id="Connect">Connect</h2></div>
<p>To make sure that everything is configured properly, as root execute:
</p>
<pre># pon &lt;TUNNEL&gt; debug dump logfd 2 nodetach
</pre>
<p>If everything has been configured correctly, the <code>pon</code> command should not terminate. Once you are satisfied that it has connected successfully, you can terminate the command.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> As an additional verification you can run <code>ip addr show</code> and ensure that a new device, <code>ppp0</code>, is available.</div>
<p>To connect to your VPN normally, simply execute:
</p>
<pre># pon &lt;TUNNEL&gt;
</pre>
<p>Where <code>&lt;TUNNEL&gt;</code> is the name of the tunnel you established earlier. Note that this command should be run as root.
</p>
<div class="mw-heading mw-heading3"><h3 id="Routing">Routing</h3></div>
<p>Once you have connected to your VPN, you should be able to interact with anything available on the VPN server. To access anything on the remote network, you need to add a new route to your routing table.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> Depending on your configuration, you may need to re-add the routing information every time you connect to your VPN.</div>
<p>For more information on how to add routes, you can read this article which has many more examples: <a rel="nofollow" class="external text" href="https://pptpclient.sourceforge.net/routing.phtml">PPTP Routing Howto</a>
</p>
<div class="mw-heading mw-heading4"><h4 id="Split_Tunneling">Split Tunneling</h4></div>
<p>Packets with a destination of your VPN's network should be routed through the VPN interface (usually <code>ppp0</code>). To do this, you create the route:
</p>
<pre># ip route add 192.168.10.0/24 dev ppp0
</pre>
<p>This will route all the traffic with a destination of 192.168.10.* through your VPN's interface, (<code>ppp0</code>).
</p>
<div class="mw-heading mw-heading4"><h4 id="Route_All_Traffic">Route All Traffic</h4></div>
<p>It may be desirable to route <i>all</i> traffic through your VPN connection. You can do this by running:
</p>
<pre># ip route add default dev ppp0
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> Routing all traffic through the VPN may result in slower over all connection speed because your traffic will be routed through the remote VPN before being routed normally.</div>
<div class="mw-heading mw-heading4"><h4 id="Route_All_Traffic_by_/etc/ppp/ip-up.d">
<span id="Route_All_Traffic_by_.2Fetc.2Fppp.2Fip-up.d"></span>Route All Traffic by /etc/ppp/ip-up.d</h4></div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> All scripts in <code>/etc/ppp/ip-up.d/</code> will called when the VPN connection is established.</div>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ppp/ip-up.d/01-routes.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash

# This script is called with the following arguments:
# Arg Name
# $1 Interface name
# $2 The tty
# $3 The link speed
# $4 Local IP number
# $5 Peer IP number
# $6 Optional ``ipparam'' value foo

ip route add default via $4
</pre>
<p>Make sure the script is executable.
</p>
<div class="mw-heading mw-heading4"><h4 id="Split_Tunneling_based_on_port_by_/etc/ppp/ip-up.d">
<span id="Split_Tunneling_based_on_port_by_.2Fetc.2Fppp.2Fip-up.d"></span>Split Tunneling based on port by /etc/ppp/ip-up.d</h4></div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> All scripts in <code>/etc/ppp/ip-up.d/</code> will called when the VPN connection is established.</div>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ppp/ip-up.d/01-routebyport.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash

# This script is called with the following arguments:
# Arg Name
# $1 Interface name
# $2 The tty
# $3 The link speed
# $4 Local IP number
# $5 Peer IP number
# $6 Optional ``ipparam'' value foo

echo 0 &gt; /proc/sys/net/ipv4/conf/$1/rp_filter
echo 1 &gt; /proc/sys/net/ipv4/ip_forward
echo 1 &gt; /proc/sys/net/ipv4/ip_dynaddr

ip route flush table vpn
ip route add default via $5 dev $1 table vpn

# forward only IRC ports over VPN
iptables -t mangle -A OUTPUT -p tcp -m multiport --dports 6667,6697 -j MARK --set-mark 0x1
iptables -t nat    -A POSTROUTING -o $1 -j MASQUERADE

ip rule  add fwmark 0x1 pri 100 lookup vpn
ip rule  add from $4 pri 200 table vpn
ip route flush cache
</pre>
<p>Make sure the script is executable and that the vpn table is added to <code>/etc/iproute2/rt_tables</code>
</p>
<pre>201 vpn
</pre>
<div class="mw-heading mw-heading2"><h2 id="Disconnect">Disconnect</h2></div>
<p>Execute the following to disconnect from a VPN:
</p>
<pre># poff &lt;TUNNEL&gt;
</pre>
<p><code>&lt;TUNNEL&gt;</code> is the name of your tunnel.
</p>
<div class="mw-heading mw-heading2"><h2 id="Making_A_VPN_Daemon_and_Connecting_On_Boot">Making A VPN Daemon and Connecting On Boot</h2></div>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:View-refresh-red.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section is out of date.</b></p>
<div>
<b>Reason:</b> References rc.d: needs an update to <a href="../en/Systemd.html" title="Systemd">systemd</a>. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:PPTP_Client.html">Talk:PPTP Client</a>)</div>
</div>
<p>You can create a simple daemon for your VPN connection by creating an appropriate <code>/etc/rc.d/*</code> script:
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> As always, <code>&lt;TUNNEL&gt;</code> is the name of your tunnel. <code>&lt;ROUTING COMMAND&gt;</code> is the command you use to add the appropriate route to the routing table.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> The <i>stop</i> functionality of this script <b>will not work</b> if the <code>updetach</code> and <code>persist</code> arguments are passed to <code>/usr/bin/pon</code> when pon is started. The reason for this is that the <code>/usr/bin/poff</code> script contains a bug when determining the PID of the specified <code>pppd</code> process if arguments were passed to <code>pon</code>.
<p>To resolve this issue, you can patch your <code>/usr/bin/poff</code> file by making the following changes on line 93:
</p>
<pre>-PID=`ps axw | grep "[ /]pppd call $1 *\$" | awk '{print $1}'`
+PID=`ps axw | grep "[ /]pppd call $1" | awk '{print $1}'`</pre>
</div>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/rc.d/name-of-your-vpn</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash

. /etc/rc.conf
. /etc/rc.d/functions

DAEMON=&lt;TUNNEL&gt;-vpn
ARGS=

[ -r /etc/conf.d/$DAEMON ] &amp;&amp; . /etc/conf.d/$DAEMON

case "$1" in
 start)
   stat_busy "Starting $DAEMON"
   pon &lt;TUNNEL&gt; updetach persist &amp;&gt;/dev/null &amp;&amp; &lt;ROUTING COMMAND&gt; &amp;&gt;/dev/null
   if [ $? = 0 ]; then
     add_daemon $DAEMON
     stat_done
   else
     stat_fail
     exit 1
   fi
   ;;
 stop)
   stat_busy "Stopping $DAEMON"
   poff &lt;TUNNEL&gt; &amp;&gt;/dev/null
   if [ $? = 0 ]; then
     rm_daemon $DAEMON
     stat_done
   else
     stat_fail
     exit 1
   fi
   ;;
 restart)
   $0 stop
   sleep 1
   $0 start
   ;;
 *)
   echo "usage: $0 {start|stop|restart}"  
esac
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> We call <code>pon</code> in the script with two additional arguments: <code>updetach</code> and <code>persist</code>. The argument <code>updetach</code> makes pon block until the connection has been established. The other argument, <code>persist</code>, makes the network automatically reconnect in the event of a failure. To connect at boot add @&lt;TUNNEL&gt;-vpn to the end of your <code>DAEMONS</code> array in <code>/etc/rc.conf</code>.</div>
<div class="mw-heading mw-heading2"><h2 id="Troubleshooting">Troubleshooting</h2></div>
<p>If client connections keep timing out with "LCP: timeout sending Config-Requests", make sure that GRE is allowed through the client firewall. For iptables, the necessary command is:
</p>
<pre>iptables -A INPUT -p 47 -j ACCEPT
</pre>
<p>Alternatively, if you only want to allow PPTP traffic that corresponds to a connection request coming from your local machine, you can use the conntrack PPTP helper:
</p>
<pre>iptables -A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT 
iptables -t raw -A OUTPUT -p tcp --dport 1723 -j CT --helper pptp
</pre>
<p>The second line should autoload the <code>nf_conntrack_pptp</code> and <code>nf_conntrack_proto_gre</code> kernel modules, which are needed for this.
</p>
<p>If you get “EAP: unknown authentication type 26; Naking”, open /etc/ppp/options.pptp and commented out the lines <b>refuse-chap</b> and <b>refuse-mschap</b>
and add the options file entry to the tunnel file like this: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ppp/peers/&lt;tunel&gt;</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># written by pptpsetup
pty "pptp vpn.foo.com --nolaunchpppd"
lock
noauth
nobsdcomp
nodeflate
name USERNAME
remotename vpn
file /etc/ppp/options.pptp
ipparam vpn
require-mppe-128</pre>
<div class="mw-heading mw-heading2"><h2 id="Remarks">Remarks</h2></div>
<p>You can find more information about configuring pptpclient at their website: <a rel="nofollow" class="external text" href="https://pptpclient.sourceforge.net/">pptpclient website</a>. The contents of this article were adapted from their Ubuntu How-To which also provides some hints on how to do things such as connecting on boot. These examples should be easy to adapt into daemons or other scripts to help automate your configuration.
</p>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Virtual_Private_Network.html" title="Category:Virtual Private Network">Virtual Private Network</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=PPTP_Client&amp;oldid=844420">https://wiki.archlinux.org/index.php?title=PPTP_Client&amp;oldid=844420</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 17 August 2025, at 08:59.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><picture><source media="(min-width: 500px)" srcset="/resources/assets/poweredby_mediawiki.svg" width="88" height="31"><img src="/resources/assets/mediawiki_compact.svg" width="25" height="25" loading="lazy"></picture></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-header-container vector-sticky-header-container no-font-mode-scale">
	<div id="vector-sticky-header" class="vector-sticky-header">
		<div class="vector-sticky-header-start">
			<div class="vector-sticky-header-icon-start vector-button-flush-left vector-button-flush-right" aria-hidden="true">
				<button class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-sticky-header-search-toggle" tabindex="-1" data-event-name="ui.vector-sticky-search-form.icon"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
			</button>
		</div>
			
		<div role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box">
			<div class="vector-typeahead-search-container">
				<div class="cdx-typeahead-search cdx-typeahead-search--show-thumbnail">
					<form action="/index.php" id="vector-sticky-search-form" class="cdx-search-input cdx-search-input--has-end-button">
						<div class="cdx-search-input__input-wrapper" data-search-loc="header-moved">
							<div class="cdx-text-input cdx-text-input--has-start-icon">
								<input class="cdx-text-input__input mw-searchInput" autocomplete="off" type="search" name="search" placeholder="Search ArchWiki">
								<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
							</div>
							<input type="hidden" name="title" value="Special:Search">
						</div>
						<button class="cdx-button cdx-search-input__end-button">Search</button>
					</form>
				</div>
			</div>
		</div>
		<div class="vector-sticky-header-context-bar">
				<nav aria-label="Contents" class="vector-toc-landmark">
						
					<div id="vector-sticky-header-toc" class="vector-dropdown mw-portlet mw-portlet-sticky-header-toc vector-sticky-header-toc vector-button-flush-left">
						<input type="checkbox" id="vector-sticky-header-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-sticky-header-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
						<label id="vector-sticky-header-toc-label" for="vector-sticky-header-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
						</label>
						<div class="vector-dropdown-content">
					
						<div id="vector-sticky-header-toc-unpinned-container" class="vector-unpinned-container">
						</div>
					
						</div>
					</div>
			</nav>
				<div class="vector-sticky-header-context-bar-primary" aria-hidden="true"><span class="mw-page-title-main">PPTP Client</span></div>
			</div>
		</div>
		<div class="vector-sticky-header-end" aria-hidden="true">
			<div class="vector-sticky-header-icons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-talk-sticky-header" tabindex="-1" data-event-name="talk-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbles mw-ui-icon-wikimedia-speechBubbles"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-subject-sticky-header" tabindex="-1" data-event-name="subject-sticky-header"><span class="vector-icon mw-ui-icon-article mw-ui-icon-wikimedia-article"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-history-sticky-header" tabindex="-1" data-event-name="history-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-history mw-ui-icon-wikimedia-wikimedia-history"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only mw-watchlink" id="ca-watchstar-sticky-header" tabindex="-1" data-event-name="watch-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-star mw-ui-icon-wikimedia-wikimedia-star"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only reading-lists-bookmark" id="ca-bookmark-sticky-header" tabindex="-1" data-event-name="watch-sticky-bookmark"><span class="vector-icon mw-ui-icon-wikimedia-bookmarkOutline mw-ui-icon-wikimedia-wikimedia-bookmarkOutline"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-edit-sticky-header" tabindex="-1" data-event-name="wikitext-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-wikiText mw-ui-icon-wikimedia-wikimedia-wikiText"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-ve-edit-sticky-header" tabindex="-1" data-event-name="ve-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-edit mw-ui-icon-wikimedia-wikimedia-edit"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-viewsource-sticky-header" tabindex="-1" data-event-name="ve-edit-protected-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-editLock mw-ui-icon-wikimedia-wikimedia-editLock"></span>

<span></span>
			</a>
		</div>
			<div class="vector-sticky-header-buttons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive" id="ca-addsection-sticky-header" tabindex="-1" data-event-name="addsection-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbleAdd-progressive mw-ui-icon-wikimedia-speechBubbleAdd-progressive"></span>

<span>Add topic</span>
			</a>
		</div>
			<div class="vector-sticky-header-icon-end">
				<div class="vector-user-links">
				</div>
			</div>
		</div>
	</div>
</div>
<div class="mw-portlet mw-portlet-dock-bottom emptyPortlet" id="p-dock-bottom">
	<ul>
		
	</ul>
</div>
</body>
</html>
