<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>CoreDNS - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-CoreDNS rootpage-CoreDNS skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Installation</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Configuration</div>
		</a>
		
			<button aria-controls="toc-Configuration-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configuration subsection</span>
			</button>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
			<li id="toc-NextDNS_as_upstream_resolver" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#NextDNS_as_upstream_resolver">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>NextDNS as upstream resolver</div>
			</a>
			
			<ul id="toc-NextDNS_as_upstream_resolver-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Example_Configuration" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Example_Configuration">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Example Configuration</div>
		</a>
		
		<ul id="toc-Example_Configuration-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">CoreDNS</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 1 language">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-1" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">1 language</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/CoreDNS" title="CoreDNS – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/Domain_name_resolution.html" title="Domain name resolution">Domain name resolution</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://coredns.io/">CoreDNS</a> is a DNS server/forwarder, written in Go, that chains plugins. Each plugin performs a (DNS) function.
</p>
<p>CoreDNS is a fast and flexible DNS server. The key word here is flexible: with CoreDNS you are able to do what you want with your DNS data by utilizing plugins. If some functionality is not provided out of the box you can add it by writing a plugin.
</p>
<p>CoreDNS can listen for DNS requests coming in over UDP/TCP (go'old DNS), TLS (<a href="https://tools.ietf.org/html/rfc7858" class="extiw" title="rfc:7858">RFC:7858</a>), also called DoT, DNS over HTTP/2 - DoH - (<a href="https://tools.ietf.org/html/rfc8484" class="extiw" title="rfc:8484">RFC:8484</a>)
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/coredns/">coredns</a></span><sup><small>AUR</small></sup>, or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/coredns-bin/">coredns-bin</a></span><sup><small>AUR</small></sup>, or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/coredns-git/">coredns-git</a></span><sup><small>AUR</small></sup> package.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>Currently only <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/coredns-git/">coredns-git</a></span><sup><small>AUR</small></sup> provides an example configuration file.  You can find that here: <a rel="nofollow" class="external text" href="https://aur.archlinux.org/cgit/aur.git/tree/corefile.example?h=coredns-git">Example CoreDNS configuration file</a>
</p>
<p>systemd will look in <code>/etc/coredns/Corefile</code>, save the above configuration file in that location.
</p>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start/enable">Start/enable</a> <code>coredns.service</code>.
</p>
<ul><li><span class="plainlinks archwiki-template-man" title="$ man 1 coredns"><a rel="nofollow" class="external text" href="https://coredns.io/manual/toc/">coredns(1)</a></span></li></ul>
<p>With the example configuration CoreDNS will start on port 1053.  You can use the <code>drill</code> command to verify to use CoreDNS is working:  <code>drill archlinux.org @127.0.0.1 -p 1053</code>
</p>
<h3><span class="mw-headline" id="NextDNS_as_upstream_resolver">NextDNS as upstream resolver</span></h3>
<p>If you would like to encrypt your recursive requests, edit the Corefile and remove lines 6 through 12 in the example configuration. 
<code>forward . tls://45.90.28.0 tls://45.90.30.0 { tls_servername dns.nextdns.io </code>}
</p>
<ul><li><span class="plainlinks archwiki-template-man" title="$ man 7 coredns-forward"><a rel="nofollow" class="external text" href="https://coredns.io/plugins/forward/">coredns-forward(7)</a></span></li></ul>
<p>You can use any dns53 or DoT resolver in the forward. as the local resolver, edit <code>/etc/coredns/Corefile</code> and change <code>.:1053</code> to <code>.:53</code> you can then configure <code>127.0.0.1</code> as your nameserver (see see <a href="../en/Domain_name_resolution.html" title="Domain name resolution">Domain name resolution</a>). <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">Restart</a> <code>coredns.service</code> after that.
</p>
<p>Run <code>journalctl -u coredns</code> as root to verify things are working by default. The resolver will now listen on port <code>53</code>. If the resolver should be accessible from other hosts, configure other network interfaces in <code>/etc/coredns/Corefile</code> with <code>bind</code>. Also the <code>acl</code> plugin can be used to block ranges that should be use the server for recursion. Refer to <a rel="nofollow" class="external text" href="https://coredns.io/plugins/">CoreDNS plugin documentation</a> for more information.
</p>
<ul><li><span class="plainlinks archwiki-template-man" title="$ man 7 coredns-bind"><a rel="nofollow" class="external text" href="https://coredns.io/plugins/bind/">coredns-bind(7)</a></span></li></ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Unless you specifically want to run an open DNS resolver, do not configure the resolver to listen on a public (internet-facing) IP address.</div>
<ul><li><span class="plainlinks archwiki-template-man" title="$ man 7 coredns-acl"><a rel="nofollow" class="external text" href="https://coredns.io/plugins/acl/">coredns-acl(7)</a></span></li></ul>
<p>If the resolver should respect entries from the <code>/etc/hosts</code> file, add a <code>hosts</code> line to <code>/etc/coredns/Corefile</code>.
</p>
<ul><li><span class="plainlinks archwiki-template-man" title="$ man 7 coredns-hosts"><a rel="nofollow" class="external text" href="https://coredns.io/plugins/hosts/">coredns-hosts(7)</a></span></li></ul>
<h2><span class="mw-headline" id="Example_Configuration">Example Configuration</span></h2>
<p>This is a configuration with useful plugins:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/coredns/Corefile</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">.:53 {
       bind 127.0.53.1 192.168.1.254 192.0.0.1 
       bufsize 1232 
       acl { 
               allow net 192.168.0.0/16 172.16.0.0/12 10.0.0.0/8 192.0.0.0/24
               block
       }
       hosts { 
               reload 0
               fallthrough
       }
       loadbalance
       forward . tls://45.90.28.0 tls://45.90.30.0 {
               tls_servername dns.nextdns.io
       }
       cache {
               success 4096
               denial  1024
               prefetch 512
       }
       prometheus :9153
       errors
       log
}</pre>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><span class="plainlinks archwiki-template-man" title="$ man 1 coredns"><a rel="nofollow" class="external text" href="https://coredns.io/manual/toc/">coredns(1)</a></span></li>
<li><a rel="nofollow" class="external text" href="https://coredns.io/manual/toc/">CoreDNS manual</a></li>
<li><a rel="nofollow" class="external text" href="https://coredns.io/plugins/">CoreDNS plugins</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/coredns/coredns">CoreDNS github</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Domain_Name_System.html" title="Category:Domain Name System">Domain Name System</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=CoreDNS&amp;oldid=740304">https://wiki.archlinux.org/index.php?title=CoreDNS&amp;oldid=740304</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 6 August 2022, at 11:05.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
