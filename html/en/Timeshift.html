<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-os vector-sticky-header-enabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Timeshift - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.45.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Timeshift rootpage-Timeshift skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Installation</span>
			</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Configuration</span>
			</div>
		</a>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Usage" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Usage">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Usage</span>
			</div>
		</a>
		
		<ul id="toc-Usage-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Configuring_btrfs_snapshots" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configuring_btrfs_snapshots">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">4</span>
				<span>Configuring btrfs snapshots</span>
			</div>
		</a>
		
			<button aria-controls="toc-Configuring_btrfs_snapshots-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configuring btrfs snapshots subsection</span>
			</button>
		
		<ul id="toc-Configuring_btrfs_snapshots-sublist" class="vector-toc-list">
			<li id="toc-Making_a_supported_Btrfs_layout_during_installation" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Making_a_supported_Btrfs_layout_during_installation">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.1</span>
					<span>Making a supported Btrfs layout during installation</span>
				</div>
			</a>
			
			<ul id="toc-Making_a_supported_Btrfs_layout_during_installation-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Converting_an_installed_system_to_the_compatible_Btrfs_layout" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Converting_an_installed_system_to_the_compatible_Btrfs_layout">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.2</span>
					<span>Converting an installed system to the compatible Btrfs layout</span>
				</div>
			</a>
			
			<ul id="toc-Converting_an_installed_system_to_the_compatible_Btrfs_layout-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Excluding_directories_from_Btrfs_snapshots" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Excluding_directories_from_Btrfs_snapshots">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.3</span>
					<span>Excluding directories from Btrfs snapshots</span>
				</div>
			</a>
			
			<ul id="toc-Excluding_directories_from_Btrfs_snapshots-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-GRUB_entries_for_btrfs_snapshots" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#GRUB_entries_for_btrfs_snapshots">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.4</span>
					<span>GRUB entries for btrfs snapshots</span>
				</div>
			</a>
			
			<ul id="toc-GRUB_entries_for_btrfs_snapshots-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Troubleshooting">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">5</span>
				<span>Troubleshooting</span>
			</div>
		</a>
		
			<button aria-controls="toc-Troubleshooting-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Troubleshooting subsection</span>
			</button>
		
		<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
			<li id="toc-Timeshift_GUI_not_launching_on_Wayland" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Timeshift_GUI_not_launching_on_Wayland">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.1</span>
					<span>Timeshift GUI not launching on Wayland</span>
				</div>
			</a>
			
			<ul id="toc-Timeshift_GUI_not_launching_on_Wayland-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Delete_button_does_nothing/&quot;Directory_not_empty&quot;_error" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Delete_button_does_nothing/&quot;Directory_not_empty&quot;_error">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.2</span>
					<span>Delete button does nothing/"Directory not empty" error</span>
				</div>
			</a>
			
			<ul id="toc-Delete_button_does_nothing/&quot;Directory_not_empty&quot;_error-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar no-font-mode-scale">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left" title="Table of Contents">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Timeshift</span></h1>
							
</header>
				<div class="vector-column-end no-font-mode-scale">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/Btrfs.html" title="Btrfs">Btrfs</a></li>
<li><a href="../en/System_maintenance.html" title="System maintenance">System maintenance</a></li>
<li><a href="../en/Synchronization_and_backup_programs.html" title="Synchronization and backup programs">Synchronization and backup programs</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://github.com/linuxmint/timeshift">Timeshift</a> is a tool originally created by <a rel="nofollow" class="external text" href="https://teejeetech.com/">Tony George</a>, that is now part of the <a rel="nofollow" class="external text" href="https://github.com/linuxmint/xapp">Xapp project</a>.
</p>
<p>Timeshift helps create incremental snapshots of the file system at regular intervals, which can then be restored at a later date to undo all changes to the system.
</p>
<p>It supports <a href="../en/Rsync.html" title="Rsync">rsync</a> snapshots for all filesystems, and uses the built-in snapshot features for <a href="../en/Btrfs.html" title="Btrfs">Btrfs</a> drives configured to use the <code>@</code> and <code>@home</code> subvolume layout for <a href="../en/Partitioning.html#/" title="Partitioning">root</a> and <a href="../en/Partitioning.html#/home" title="Partitioning">home</a> directories respectively.
</p>
<meta property="mw:PageProp/toc">
<div class="mw-heading mw-heading2"><h2 id="Installation">Installation</h2></div>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=timeshift">timeshift</a></span> package and <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable/start">enable/start</a> your chosen cron scheduler (see <a href="../en/Cron.html#Configuration" title="Cron">cron#Configuration</a>). This will ensure that snapshots scheduled within the Timeshift application run as intended.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=timeshift">timeshift</a></span> package currently takes a hard dependency on <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=cronie">cronie</a></span> as the cron scheduler.</div>
<p>Alternatively, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/timeshift-systemd-timer/">timeshift-systemd-timer</a></span><sup><small>AUR</small></sup> can be installed instead of using a cron scheduler.
</p>
<div class="mw-heading mw-heading2"><h2 id="Configuration">Configuration</h2></div>
<p>Timeshift can be fully configured using the <code>timeshift-gtk</code> graphical user interface, but if running graphical applications is not an option, its configuration file can be edited directly. Copy the template file <code>/etc/timeshift/default.json</code> to <code>/etc/timeshift/timeshift.json</code> and edit settings you want to change. 
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> 
<ul>
<li>If you want to enable btrfs mode, make sure that your subvolume layout is compatible. See <a href="#Configuring_btrfs_snapshots">#Configuring btrfs snapshots</a>.</li>
<li>The exclusion patterns are applied from top to bottom, with the first match overriding subsequent ones.</li>
<li>The exclude option is not supported in Btrfs mode. See <a href="#Excluding_directories_from_Btrfs_snapshots">#Excluding directories from Btrfs snapshots</a>.</li>
</ul>
</div>
<p>Here is an example of a <a href="../en/Rsync.html" title="Rsync">rsync</a>-based configuration with three weekly snapshots and rules to exclude the <code>/var/cache</code>, <code>/var/tmp</code> and <code>/home/archie</code> directories, while including the <code>/home/archie/.config</code> directory and its content into the snapshots:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/timeshift/timeshift.json</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">{
    "backup_device_uuid" : "<i>root-partition UUID</i>",
    "do_first_run" : "false",
    "btrfs_mode" : "false",
    "include_btrfs_home_for_backup" : "false",
    "include_btrfs_home_for_restore" : "false",
    "schedule_weekly" : "true",
    "count_weekly" : "3",
    "date_format" : "%Y-%m-%d %H:%M:%S",
    "exclude" : [
        "/var/cache/**",
        "/var/tmp/**",
        "+ /home/archie/.config/***",
        "/home/archie/**"
    ],
    "exclude-apps" : []
}
</pre>
<div class="mw-heading mw-heading2"><h2 id="Usage">Usage</h2></div>
<p>Snapshots can be managed through the <code>timeshift-gtk</code> graphical user interface, as well as the <code>timeshift</code> command-line user interface tool.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip</strong> Use the <code>--scripted</code> key when using <code>timeshift</code> in scripts.</div>
<p>Listing snapshots:
</p>
<pre># timeshift --list
</pre>
<p>Creating a snapshot:
</p>
<pre># timeshift --create --comments "<i>comment</i>"
</pre>
<p>Restoring a snapshot:
</p>
<pre># timeshift --restore --snapshot "<i>snapshot</i>"
</pre>
<p>Deleting a snapshot:
</p>
<pre># timeshift --delete --snapshot "<i>snapshot</i>"
</pre>
<div class="mw-heading mw-heading2"><h2 id="Configuring_btrfs_snapshots">Configuring btrfs snapshots</h2></div>
<p>Timeshift requires a <a rel="nofollow" class="external text" href="https://archive.kernel.org/oldwiki/btrfs.wiki.kernel.org/index.php/SysadminGuide.html#Flat">flat Btrfs layout</a> with subvolumes for <code>/</code> and optionally <code>/home</code> being named as <code>/@</code> and <code>/@home</code>.
</p>
<div class="mw-heading mw-heading3"><h3 id="Making_a_supported_Btrfs_layout_during_installation">Making a supported Btrfs layout during installation</h3></div>
<p>The instruction below assumes that you are following the <a href="../en/Installation_guide.html" title="Installation guide">installation guide</a>.
</p>
<p>Right after the <a href="../en/Btrfs.html" title="Btrfs">Btrfs</a> filesystem is <a href="../en/Btrfs.html#File_system_creation" title="Btrfs">created</a> and <a href="../en/File_systems.html#Mount_a_file_system" title="File systems">mounted</a> to <code>/mnt</code>, <a href="../en/Btrfs.html#Creating_a_subvolume" title="Btrfs">create subvolumes</a> named <code>/mnt/@</code> and <code>/mnt/@home</code>. <a href="../en/File_systems.html#Unmount_a_file_system" class="mw-redirect" title="Unmount">Unmount</a> <code>/mnt</code> and mount the subvolumes using the <code>subvol</code> parameter:
</p>
<pre># mount -o subvol=@ /dev/<i>root_partition</i> /mnt
# mount --mkdir -o subvol=@home /dev/<i>root_partition</i> /mnt/home
</pre>
<p>Proceed with the installation as normal.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning</strong> Make sure to remove the <code>subvolid</code> mount parameter for <code>/</code> and <code>/home</code> from the <a href="../en/Fstab.html" title="Fstab">Fstab</a> file if it was generated using <a href="../en/Genfstab.html" title="Genfstab">genfstab</a>, or you will be unable to boot after restoring from a snapshot.</div>
<div class="mw-heading mw-heading3"><h3 id="Converting_an_installed_system_to_the_compatible_Btrfs_layout">Converting an installed system to the compatible Btrfs layout</h3></div>
<p>The following instructions assume that the system is installed in the top-level (ID=5) subvolume, you may need to adapt these depending on your configuration.
</p>
<p>Start by creating a snapshot of your root named <code>/@</code> and mount it to <code>/mnt</code>:
</p>
<pre># btrfs subvolume snapshot / /@
# mount -o subvol=@ /dev/<i>root-partition</i> /mnt
</pre>
<p><a href="../en/Btrfs.html#Creating_a_subvolume" title="Btrfs">Create</a> the <code>/@home</code> subvolume, move the user data into it and mount it at <code>/mnt/home</code>:
</p>
<pre># mv /mnt/home/* /@home
# mount -o subvol=@home /mnt/home
</pre>
<p>Mount your <a href="../en/EFI_system_partition.html" title="EFI system partition">EFI system partition</a> to <code>/mnt/<i>esp</i></code> if you have one. <a href="../en/Chroot.html#Usage" title="Chroot">Chroot</a> into <code>/mnt</code>, reinstall and reconfigure the <a href="../en/Boot_loader.html" class="mw-redirect" title="Boot loader">boot loader</a>. For an amd64 EFI system with <a href="../en/GRUB.html" title="GRUB">GRUB</a>, just running:
</p>
<pre># grub-install --target=x86_64-efi --efi-directory=<i>esp</i> --bootloader-id=GRUB
# grub-mkconfig -o /boot/grub/grub.cfg
</pre>
<p>would be enough, however if you use any other bootloader that has no automatic configuration, you need to manually add <code>rootflags=subvol=@</code> to the kernel options (see <a href="../en/Kernel_parameters.html#Boot_loader_configuration" title="Kernel parameters">Kernel parameters#Boot loader configuration</a>).
</p>
<p>Edit the <a href="../en/Fstab.html" title="Fstab">fstab</a> file so that the entry for <code>/</code> contains <code>subvol=@</code> mount option, and add an entry for <code>/home</code> with <code>subvol=@home</code> mount option. Example of how it may look like:
</p>
<pre>...
UUID=<i>d8efe946-8d28-40d6-943a-70af51a8d2cd</i>  /       btrfs   defaults,subvol=@      0    0
UUID=<i>d8efe946-8d28-40d6-943a-70af51a8d2cd</i>  /home   btrfs   defaults,subvol=@home  0    0
...
</pre>
<p>Exit the chroot, <a href="../en/Systemd.html#Power_management" class="mw-redirect" title="Reboot">reboot</a> and confirm with the <code>mount</code> command that everything is done correctly. Mount the toplevel using <code>mount -o subvolid=5 /dev/<i>root-partition</i> /mnt</code> and cleanup the old root.
</p>
<div class="mw-heading mw-heading3"><h3 id="Excluding_directories_from_Btrfs_snapshots">Excluding directories from Btrfs snapshots</h3></div>
<p>Btrfs mode does not support the exclusion of individual files and directories from snapshots. However, it is possible to work around this to some extent by creating additional subvolumes at the top-level and mounting them in place of directories, which will effectively exclude them.
</p>
<p>Here is an example of how to exclude the <code>/var/log</code> directory, to prevent the system logs from rolling back and make it easy to inspect them after a system breakage:
</p>
<p>Start by mounting the top-level and create the subvolume inside of it:
</p>
<pre># mount -o subvolid=5 /dev/root-partition /mnt
# btrfs subvolume create /mnt/@var_log
</pre>
<p>Add a new entry for it to <a href="../en/Fstab.html" title="Fstab">fstab</a>:
</p>
<pre>UUID=<i>root-partition-UUID</i>  /var/log   btrfs   defaults,subvol=@var_log  0    0
</pre>
<div class="mw-heading mw-heading3"><h3 id="GRUB_entries_for_btrfs_snapshots">GRUB entries for btrfs snapshots</h3></div>
<p>To add snapshots to the <a href="../en/GRUB.html" title="GRUB">GRUB</a> menu each time <a href="../en/GRUB.html#Generate_the_main_configuration_file" title="GRUB">GRUB configuration is generated</a>, install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=grub-btrfs">grub-btrfs</a></span> package. It comes with the <code>grub-btrfsd.service</code>, which can be <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enabled">enabled</a> to automatically update the GRUB configuration whenever a new snapshot is created.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> <code>grub-btrfsd</code> requires the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=inotify-tools">inotify-tools</a></span> package to function</div>
<p>To make grub-btrfsd work with Timeshift, edit the service by running:
</p>
<pre># systemctl edit --full grub-btrfsd
</pre>
<p>and change the line:
</p>
<pre>ExecStart=/usr/bin/grub-btrfsd /.snapshots --syslog
</pre>
<p>to:
</p>
<pre>ExecStart=/usr/bin/grub-btrfsd --syslog --timeshift-auto
</pre>
<p>After saving the changes, <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">restart</a> the service.
</p>
<div class="mw-heading mw-heading2"><h2 id="Troubleshooting">Troubleshooting</h2></div>
<div class="mw-heading mw-heading3"><h3 id="Timeshift_GUI_not_launching_on_Wayland">Timeshift GUI not launching on Wayland</h3></div>
<p><a href="../en/Wayland.html#Xwayland" class="mw-redirect" title="Xwayland">Xwayland</a> will only allow the user who started the X server to connect clients to it (see <a href="../en/Privilege_elevation_for_graphical_applications.html#XWayland" title="Privilege elevation for graphical applications">Privilege elevation for graphical applications#XWayland</a>).
</p>
<p>Due to Timeshift requiring root permissions, attempting to launch the Timeshift <a href="https://en.wikipedia.org/wiki/Graphical_user_interface" class="extiw" title="wikipedia:Graphical user interface">GUI</a> via an application launcher or a terminal with the command <code>timeshift-launcher</code> will result in an error containing <code>xhost: command not found</code>.
</p>
<p>Users encountering this error may also be presented with their <a href="../en/Polkit.html#Authentication_agents" title="Polkit">authentication agent</a> prompting for a password, only to find that the Timeshift GUI does not launch after entering the password. <a rel="nofollow" class="external autonumber" href="https://arcolinuxforum.com/viewtopic.php?t=2453">[1]</a><sup>[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2025-03-15—HTTP 404]</sup> This is because the command <code>timeshift-launcher</code> requires the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xorg-xhost">xorg-xhost</a></span> package: <a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">install</a> it.
</p>
<p>If <a href="../en/GTK.html" title="GTK">GTK</a> cannot open your display and you get a warning message in the terminal, it means that the root user need the access to the graphical X server (Display :0, :1, etc.)
</p>
<p>Normally only the user who started the graphical session can open new windows in your compositor and since your need to execute <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=timeshift">timeshift</a></span> with the <a href="../en/Root_user.html" class="mw-redirect" title="Root user">root user</a>, you are not able to open the GUI
</p>
<pre>$ xhost +SI:localuser:root
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning</strong> This command can grant any local user access to your X screen. It is advised against running <code>xhost</code> on multi-user systems. See <a href="../en/Xhost.html" title="Xhost">xhost</a> and <a href="../en/Privilege_elevation_for_graphical_applications.html" title="Privilege elevation for graphical applications">Privilege elevation for graphical applications</a> for more details.</div>
<div class="mw-heading mw-heading3"><h3 id="Delete_button_does_nothing/&quot;Directory_not_empty&quot;_error">
<span id="Delete_button_does_nothing.2F.22Directory_not_empty.22_error"></span>Delete button does nothing/"Directory not empty" error</h3></div>
<p>If the delete button silently fails in GUI and <code>timeshift --delete --snapshot <i>snapshot</i></code> results in
</p>
<pre>E: ERROR: Could not destroy subvolume/snapshot: Directory not empty
</pre>
<p>this means the snapshot contains one or more nested subvolumes and those need to be removed manually. In order to do so, you need to mount the toplevel subvolume and see the subvolume list:
</p>
<pre># mount -o subvolid=5 /dev/<i>root_partition</i> /mnt
# btrfs subvolume list /mnt
</pre>
<p>If you see any subvolumes located inside the snapshot, make sure they do not contain anything you would like to copy first and remove them by running:
</p>
<pre># btrfs subvolume remove /mnt/timeshift-btrfs/snapshots/<i>snapshot/@/path/to/subvolume</i>
</pre>
<p>And remove the snapshot using timeshift as normal. Alternatively, you can remove the whole snapshot and all the nested subvolumes by running <code>rm -rf /mnt/timeshift-btrfs/snapshots/<i>snapshot</i></code>.
</p>
<p>Typically, this issue occurs because <a href="../en/Systemd-nspawn.html" title="Systemd-nspawn">systemd-nspawn</a> creates <code>/var/lib/machines</code> and <code>/var/lib/portables</code> subvolumes automatically. You can avoid this by creating them as directories in advance <a rel="nofollow" class="external autonumber" href="https://github.com/systemd/systemd/issues/853#issuecomment-127758653">[2]</a>
</p>
<pre># mkdir -p /var/lib/machines /var/lib/portables
</pre>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:File_systems.html" title="Category:File systems">File systems</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Timeshift&amp;oldid=862865">https://wiki.archlinux.org/index.php?title=Timeshift&amp;oldid=862865</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 26 January 2026, at 09:27.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><picture><source media="(min-width: 500px)" srcset="/resources/assets/poweredby_mediawiki.svg" width="88" height="31"><img src="/resources/assets/mediawiki_compact.svg" width="25" height="25" loading="lazy"></picture></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-header-container vector-sticky-header-container no-font-mode-scale">
	<div id="vector-sticky-header" class="vector-sticky-header">
		<div class="vector-sticky-header-start">
			<div class="vector-sticky-header-icon-start vector-button-flush-left vector-button-flush-right" aria-hidden="true">
				<button class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-sticky-header-search-toggle" tabindex="-1" data-event-name="ui.vector-sticky-search-form.icon"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
			</button>
		</div>
			
		<div role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box">
			<div class="vector-typeahead-search-container">
				<div class="cdx-typeahead-search cdx-typeahead-search--show-thumbnail">
					<form action="/index.php" id="vector-sticky-search-form" class="cdx-search-input cdx-search-input--has-end-button">
						<div class="cdx-search-input__input-wrapper" data-search-loc="header-moved">
							<div class="cdx-text-input cdx-text-input--has-start-icon">
								<input class="cdx-text-input__input mw-searchInput" autocomplete="off" type="search" name="search" placeholder="Search ArchWiki">
								<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
							</div>
							<input type="hidden" name="title" value="Special:Search">
						</div>
						<button class="cdx-button cdx-search-input__end-button">Search</button>
					</form>
				</div>
			</div>
		</div>
		<div class="vector-sticky-header-context-bar">
				<nav aria-label="Contents" class="vector-toc-landmark">
						
					<div id="vector-sticky-header-toc" class="vector-dropdown mw-portlet mw-portlet-sticky-header-toc vector-sticky-header-toc vector-button-flush-left">
						<input type="checkbox" id="vector-sticky-header-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-sticky-header-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
						<label id="vector-sticky-header-toc-label" for="vector-sticky-header-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
						</label>
						<div class="vector-dropdown-content">
					
						<div id="vector-sticky-header-toc-unpinned-container" class="vector-unpinned-container">
						</div>
					
						</div>
					</div>
			</nav>
				<div class="vector-sticky-header-context-bar-primary" aria-hidden="true"><span class="mw-page-title-main">Timeshift</span></div>
			</div>
		</div>
		<div class="vector-sticky-header-end" aria-hidden="true">
			<div class="vector-sticky-header-icons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-talk-sticky-header" tabindex="-1" data-event-name="talk-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbles mw-ui-icon-wikimedia-speechBubbles"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-subject-sticky-header" tabindex="-1" data-event-name="subject-sticky-header"><span class="vector-icon mw-ui-icon-article mw-ui-icon-wikimedia-article"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-history-sticky-header" tabindex="-1" data-event-name="history-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-history mw-ui-icon-wikimedia-wikimedia-history"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only mw-watchlink" id="ca-watchstar-sticky-header" tabindex="-1" data-event-name="watch-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-star mw-ui-icon-wikimedia-wikimedia-star"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only reading-lists-bookmark" id="ca-bookmark-sticky-header" tabindex="-1" data-event-name="watch-sticky-bookmark"><span class="vector-icon mw-ui-icon-wikimedia-bookmarkOutline mw-ui-icon-wikimedia-wikimedia-bookmarkOutline"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-edit-sticky-header" tabindex="-1" data-event-name="wikitext-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-wikiText mw-ui-icon-wikimedia-wikimedia-wikiText"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-ve-edit-sticky-header" tabindex="-1" data-event-name="ve-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-edit mw-ui-icon-wikimedia-wikimedia-edit"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-viewsource-sticky-header" tabindex="-1" data-event-name="ve-edit-protected-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-editLock mw-ui-icon-wikimedia-wikimedia-editLock"></span>

<span></span>
			</a>
		</div>
			<div class="vector-sticky-header-buttons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive" id="ca-addsection-sticky-header" tabindex="-1" data-event-name="addsection-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbleAdd-progressive mw-ui-icon-wikimedia-speechBubbleAdd-progressive"></span>

<span>Add topic</span>
			</a>
		</div>
			<div class="vector-sticky-header-icon-end">
				<div class="vector-user-links">
				</div>
			</div>
		</div>
	</div>
</div>
<div class="mw-portlet mw-portlet-dock-bottom emptyPortlet" id="p-dock-bottom">
	<ul>
		
	</ul>
</div>
</body>
</html>
