<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-os vector-sticky-header-enabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>AppArmor - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.44.2">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-AppArmor rootpage-AppArmor skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Installation</span>
			</div>
		</a>
		
			<button aria-controls="toc-Installation-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Installation subsection</span>
			</button>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
			<li id="toc-Custom_kernel" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Custom_kernel">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.1</span>
					<span>Custom kernel</span>
				</div>
			</a>
			
			<ul id="toc-Custom_kernel-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Usage" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Usage">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Usage</span>
			</div>
		</a>
		
			<button aria-controls="toc-Usage-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Usage subsection</span>
			</button>
		
		<ul id="toc-Usage-sublist" class="vector-toc-list">
			<li id="toc-Display_current_status" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Display_current_status">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1</span>
					<span>Display current status</span>
				</div>
			</a>
			
			<ul id="toc-Display_current_status-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Parsing_profiles" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Parsing_profiles">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2</span>
					<span>Parsing profiles</span>
				</div>
			</a>
			
			<ul id="toc-Parsing_profiles-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Disabling_loading" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Disabling_loading">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.3</span>
					<span>Disabling loading</span>
				</div>
			</a>
			
			<ul id="toc-Disabling_loading-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Configuration</span>
			</div>
		</a>
		
			<button aria-controls="toc-Configuration-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configuration subsection</span>
			</button>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
			<li id="toc-Auditing_and_generating_profiles" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Auditing_and_generating_profiles">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1</span>
					<span>Auditing and generating profiles</span>
				</div>
			</a>
			
			<ul id="toc-Auditing_and_generating_profiles-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Understanding_profiles" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Understanding_profiles">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2</span>
					<span>Understanding profiles</span>
				</div>
			</a>
			
			<ul id="toc-Understanding_profiles-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Tips_and_tricks" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Tips_and_tricks">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">4</span>
				<span>Tips and tricks</span>
			</div>
		</a>
		
			<button aria-controls="toc-Tips_and_tricks-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Tips and tricks subsection</span>
			</button>
		
		<ul id="toc-Tips_and_tricks-sublist" class="vector-toc-list">
			<li id="toc-Get_desktop_notification_on_DENIED_actions" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Get_desktop_notification_on_DENIED_actions">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.1</span>
					<span>Get desktop notification on DENIED actions</span>
				</div>
			</a>
			
			<ul id="toc-Get_desktop_notification_on_DENIED_actions-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Speed-up_AppArmor_start_by_caching_profiles" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Speed-up_AppArmor_start_by_caching_profiles">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.2</span>
					<span>Speed-up AppArmor start by caching profiles</span>
				</div>
			</a>
			
			<ul id="toc-Speed-up_AppArmor_start_by_caching_profiles-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Troubleshooting">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">5</span>
				<span>Troubleshooting</span>
			</div>
		</a>
		
			<button aria-controls="toc-Troubleshooting-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Troubleshooting subsection</span>
			</button>
		
		<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
			<li id="toc-Failing_to_start_Samba_SMB/CIFS_server" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Failing_to_start_Samba_SMB/CIFS_server">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.1</span>
					<span>Failing to start Samba SMB/CIFS server</span>
				</div>
			</a>
			
			<ul id="toc-Failing_to_start_Samba_SMB/CIFS_server-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Login_impossible_after_upgrading_to_AppArmor_v4" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Login_impossible_after_upgrading_to_AppArmor_v4">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.2</span>
					<span>Login impossible after upgrading to AppArmor v4</span>
				</div>
			</a>
			
			<ul id="toc-Login_impossible_after_upgrading_to_AppArmor_v4-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Differences_between_Linux_distributions" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Differences_between_Linux_distributions">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.3</span>
					<span>Differences between Linux distributions</span>
				</div>
			</a>
			
			<ul id="toc-Differences_between_Linux_distributions-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">6</span>
				<span>See also</span>
			</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar vector-feature-custom-font-size-clientpref--excluded">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left" title="Table of Contents">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">AppArmor</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 2 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-2" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">2 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/AppArmor" title="AppArmor – 日本語" lang="ja" hreflang="ja" data-title="AppArmor" data-language-autonym="日本語" data-language-local-name="日本語" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/AppArmor" title="AppArmor – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" data-title="AppArmor" data-language-autonym="中文（简体）" data-language-local-name="中文（简体）" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end vector-feature-custom-font-size-clientpref--excluded">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/Security.html" title="Security">Security</a></li>
<li><a href="../en/SELinux.html" title="SELinux">SELinux</a></li>
<li><a href="../en/TOMOYO_Linux.html" title="TOMOYO Linux">TOMOYO Linux</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://apparmor.net/">AppArmor</a> is a <a href="../en/Security.html#Mandatory_access_control" class="mw-redirect" title="Mandatory Access Control">Mandatory Access Control</a> (MAC) system, implemented upon the <a href="https://en.wikipedia.org/wiki/Linux_Security_Modules" class="extiw" title="wikipedia:Linux Security Modules">Linux Security Modules</a> (LSM).
</p>
<p>AppArmor, like most other LSMs, supplements rather than replaces the default Discretionary Access Control (DAC). As such it is impossible to grant a process more privileges than it had in the first place. 
</p>
<p>Ubuntu, SUSE and a number of other distributions use it by default. RHEL (and its variants) use SELinux which requires good userspace integration to work properly. SELinux attaches labels to all files, processes and objects and is therefore very flexible. However configuring SELinux is considered to be very complicated and requires a supported filesystem. AppArmor on the other hand works using file paths and its configuration can be easily adapted.
</p>
<p>AppArmor proactively protects the operating system and applications from external or internal threats and even zero-day attacks by enforcing a specific rule set on a per application basis. Security policies completely define what system resources individual applications can access, and with what privileges. Access is denied by default if no profile says otherwise. A few default policies are included with AppArmor and using a combination of advanced static analysis and learning-based tools, AppArmor policies for even very complex applications can be deployed successfully in a matter of hours.
</p>
<p>Every breach of policy triggers a message in the system log, and AppArmor can be configured to notify users with real-time violation warnings popping up on the desktop.
</p>
<meta property="mw:PageProp/toc">
<div class="mw-heading mw-heading2"><h2 id="Installation">Installation</h2></div>
<p>AppArmor is available in all <a href="../en/Kernel.html#Officially_supported_kernels" title="Kernel">officially supported kernels</a>.
</p>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=apparmor">apparmor</a></span> for userspace tools and libraries to control AppArmor. To load all AppArmor profiles on startup, <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">enable</a> <code>apparmor.service</code>.
</p>
<p>To enable AppArmor as default security model on every boot, set the following <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a>:
</p>
<pre>lsm=landlock,lockdown,yama,integrity,apparmor,bpf
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> The <code>lsm=</code> kernel parameter sets the initialization order of Linux security modules. The kernel's configured <code>lsm=</code> value can be found with <code>zgrep CONFIG_LSM= /proc/config.gz</code> and the current value with <code>cat /sys/kernel/security/lsm</code>.
<ul>
<li>Make sure that <code>apparmor</code> is the first "major" module in the list.<a rel="nofollow" class="external autonumber" href="https://docs.kernel.org/admin-guide/LSM/index.html">[1]</a> Examples of valid values and their order can be found in <a rel="nofollow" class="external text" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/security/Kconfig">security/Kconfig</a>.</li>
<li>
<code>capability</code> should be omitted from <code>lsm=</code> as it will always get included automatically.</li>
</ul>
</div>
<div class="mw-heading mw-heading3"><h3 id="Custom_kernel">Custom kernel</h3></div>
<p>When <a href="../en/Kernel.html#Compilation" class="mw-redirect" title="Kernels">compiling the kernel</a>, it is required to set at least the following options:
</p>
<pre>CONFIG_SECURITY_APPARMOR=y
CONFIG_AUDIT=y
</pre>
<p>To enable the AppArmor Linux security model by default and omit the need to set kernel parameters, additionally set the <code>CONFIG_LSM</code> option and specify <code>apparmor</code> as the first "major" module in the list:
</p>
<pre>CONFIG_LSM="landlock,lockdown,yama,integrity,apparmor,bpf"
</pre>
<div class="mw-heading mw-heading2"><h2 id="Usage">Usage</h2></div>
<div class="mw-heading mw-heading3"><h3 id="Display_current_status">Display current status</h3></div>
<p>To test if AppArmor has been correctly enabled:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ aa-enabled</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Yes
</pre>
<p>To display the current loaded status use <span class="plainlinks archwiki-template-man" title="$ man 8 aa-status"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/aa-status.8">aa-status(8)</a></span>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># aa-status</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">apparmor module is loaded.
44 profiles are loaded.
44 profiles are in enforce mode.
 ...
0 profiles are in complain mode.
0 processes have profiles defined.
0 processes are in enforce mode.
0 processes are in complain mode.
0 processes are unconfined but have a profile defined.
</pre>
<p>In <i>complain mode</i>, policy violations of profiles are allowed but are logged. Complain mode is used for testing new profiles. Note that deny rules of profiles are enforced/blocked even in complain mode.
</p>
<p>In <i>enforce mode</i>, policy violations of profiles are blocked and logged.
</p>
<div class="mw-heading mw-heading3"><h3 id="Parsing_profiles">Parsing profiles</h3></div>
<p>To load (enforce or complain), unload, reload, cache and stat profiles use <code>apparmor_parser</code>. The default action (<code>-a</code>) is to load a new profile in enforce mode, loading it in complain mode is possible using the <code>-C</code> switch, in order to overwrite an existing profile use the <code>-r</code> option and to remove a profile use <code>-R</code>. Each action may also apply to multiple profiles. Refer to <span class="plainlinks archwiki-template-man" title="$ man 8 apparmor_parser"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/apparmor_parser.8">apparmor_parser(8)</a></span> man page for more information.
</p>
<div class="mw-heading mw-heading3"><h3 id="Disabling_loading">Disabling loading</h3></div>
<p>Disable AppArmor by unloading all profiles for the current session:
</p>
<pre># aa-teardown 
</pre>
<p>To prevent AppArmor profiles from loading at the next boot <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Disable">disable</a> <code>apparmor.service</code>. To prevent the kernel from loading AppArmor, append <code>apparmor=0</code> to the <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameters</a>, or remove the <code>lsm=</code> kernel parameter that was added when <a href="#Installation">setting up AppArmor</a>.
</p>
<div class="mw-heading mw-heading2"><h2 id="Configuration">Configuration</h2></div>
<div class="mw-heading mw-heading3"><h3 id="Auditing_and_generating_profiles">Auditing and generating profiles</h3></div>
<p>To create new profiles the <a href="../en/Audit_framework.html" title="Audit framework">Audit framework</a> should be running. This is because Arch Linux adopted <a href="../en/Systemd.html" title="Systemd">systemd</a> and does not do kernel logging to file by default. AppArmor can grab kernel audit logs from the userspace auditd daemon, allowing you to build a profile.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> Apparmor audit messages uses  <a rel="nofollow" class="external text" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/6/html/security_guide/sec-Audit_Record_Types#sec-Audit_Record_Types">AVC</a> record type, and can break audit log parsing when searching logs with <a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ausearch.8">ausearch</a>. Check the bug reports <a rel="nofollow" class="external autonumber" href="https://bugs.launchpad.net/ubuntu/+source/audit/+bug/1117804">[2]</a>,  <a rel="nofollow" class="external autonumber" href="https://bugs.archlinux.org/task/60870">[3]</a>, <a rel="nofollow" class="external autonumber" href="https://github.com/linux-audit/audit-userspace/issues/351">[4]</a>
</div>
<p>New AppArmor profiles can be created by utilizing <span class="plainlinks archwiki-template-man" title="$ man 8 aa-genprof"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/aa-genprof.8">aa-genprof(8)</a></span> or <span class="plainlinks archwiki-template-man" title="$ man 8 aa-autodep"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/aa-autodep.8">aa-autodep(8)</a></span>. The profile is first created in <i>complain mode</i>: in this mode policy violations are only reported but not enforced. The rules are interactively created by the <span class="plainlinks archwiki-template-man" title="$ man 8 aa-logprof"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/aa-logprof.8">aa-logprof(8)</a></span> tool available in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=apparmor">apparmor</a></span> package. Finally the profile should be set into <i>enforce mode</i> with <span class="plainlinks archwiki-template-man" title="$ man 8 aa-enforce"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/aa-enforce.8">aa-enforce(8)</a></span>. In this mode the policy defined by the rules in the respecting profile are enforced. If necessary, additional rules can be added by repeatedly executing <span class="plainlinks archwiki-template-man" title="$ man 8 aa-logprof"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/aa-logprof.8">aa-logprof(8)</a></span>, or the profile can be set back to complain mode with <span class="plainlinks archwiki-template-man" title="$ man 8 aa-complain"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/aa-complain.8">aa-complain(8)</a></span>. Detailed guide about using those tools is available at <a rel="nofollow" class="external text" href="https://gitlab.com/apparmor/apparmor/wikis/Profiling_with_tools">AppArmor wiki - Profiling with tools</a>.
</p>
<p>Note that <span class="plainlinks archwiki-template-man" title="$ man 8 aa-logprof"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/aa-logprof.8">aa-logprof(8)</a></span> also offers <i>deny</i> rules which are actually not strictly necessary as according to the basic AppArmor logic everything is forbidden which is not explicitly allowed by a rule. However, <i>deny</i> rules serve two purposes:
</p>
<ol>
<li>
<i>deny</i> rules take precedence over <i>allow</i> rules. They are often used in many <a rel="nofollow" class="external text" href="https://man.archlinux.org/man/extra/apparmor/apparmor.d.5.en##include_mechanism">abstractions</a> located in <code>/etc/apparmor.d/abstractions</code> in order to block any access to important folders/files. This makes sure that inadvertently created allow rules do not make a profile too permissive.</li>
<li>
<i>deny</i> rules silence logging and make subsequent runs of <i>aa-logprof</i> less noisy. It is important to keep in mind that <i>deny</i> rules are enforced also in <i>complain mode</i> - hence, if an application does not work properly even in complain mode it should be checked if a deny rule in the profile or in one of the included abstractions is the culprit.</li>
</ol>
<p>Alternatively profiles may be also created manually, see guide available at <a rel="nofollow" class="external text" href="https://gitlab.com/apparmor/apparmor/wikis/Profiling_by_hand">AppArmor wiki - Profiling by hand</a>.
</p>
<p>In addition to the default profiles in <code>/etc/apparmor.d/</code>, there are more predefined profiles in <code>/usr/share/apparmor/extra-profiles/</code>. Note that those are not necessarily deemed production-ready, so manual intervention or usage of <span class="plainlinks archwiki-template-man" title="$ man 8 aa-logprof"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/aa-logprof.8">aa-logprof(8)</a></span> may be required.
</p>
<p>Another set of AppArmor profiles can be found in the <a rel="nofollow" class="external text" href="https://github.com/roddhjav/apparmor.d">apparmor.d</a> project, however, as of writing, the project is not currently stable.
</p>
<div class="mw-heading mw-heading3"><h3 id="Understanding_profiles">Understanding profiles</h3></div>
<p>Profiles are human readable text files residing under <code>/etc/apparmor.d/</code> describing how binaries should be treated when executed. A basic profile looks similar to this:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/apparmor.d/usr.bin.test</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#include &lt;tunables/global&gt;

profile test /usr/lib/test/test_binary {
    #include &lt;abstractions/base&gt;

    # Main libraries and plugins
    /usr/share/TEST/** r,
    /usr/lib/TEST/** rm,

    # Configuration files and logs
    @{HOME}/.config/ r,
    @{HOME}/.config/TEST/** rw,
}
</pre>
<p>Strings preceded by a <code>@</code> symbol are variables defined by abstractions (<code>/etc/apparmor.d/abstractions/</code>), tunables (<code>/etc/apparmor.d/tunables/</code>) or by the profile itself. <code>#include</code> includes other profile-files directly. Paths followed by a set of characters are <a rel="nofollow" class="external text" href="https://man.archlinux.org/man/extra/apparmor/apparmor.d.5.en#Access_Modes">access permissions</a>. Pattern matching is done using <a rel="nofollow" class="external text" href="https://man.archlinux.org/man/extra/apparmor/apparmor.d.5.en#Globbing">AppArmor's globbing syntax</a>.
</p>
<p>Most common use cases are covered by the following statements:
</p>
<ul>
<li>
<code>r</code> — read: read data</li>
<li>
<code>w</code> — write: create, delete, write to a file and extend it</li>
<li>
<code>m</code> — memory map executable: memory map a file executable</li>
<li>
<code>x</code> — execute: execute file; needs to be preceded by a <a rel="nofollow" class="external text" href="https://gitlab.com/apparmor/apparmor/wikis/AppArmor_Core_Policy_Reference#execute-rules">qualifier</a>
</li>
</ul>
<p>Remember that those permission do not allow binaries to exceed the permission dictated by the Discretionary Access Control (DAC).
</p>
<p>This is merely a short overview, for a more detailed guide be sure to have a look at the <span class="plainlinks archwiki-template-man" title="$ man 5 apparmor.d"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/apparmor.d.5">apparmor.d(5)</a></span> man page and <a rel="nofollow" class="external text" href="https://gitlab.com/apparmor/apparmor/wikis/AppArmor_Core_Policy_Reference">documentation</a>.
</p>
<div class="mw-heading mw-heading2"><h2 id="Tips_and_tricks">Tips and tricks</h2></div>
<div class="mw-heading mw-heading3"><h3 id="Get_desktop_notification_on_DENIED_actions">Get desktop notification on DENIED actions</h3></div>
<p>The notification daemon displays desktop notifications whenever AppArmor denies a program access. To automatically start <i>aa-notify</i> daemon on login follow below steps:
</p>
<p>Install the <a href="../en/Audit_framework.html" title="Audit framework">Audit framework</a> and enable and start the userspace Linux Audit daemon. Allow your desktop user to read audit logs in <code>/var/log/audit</code> by adding it to <code>audit</code> <a href="../en/Users_and_groups.html#Group_management" class="mw-redirect" title="User group">user group</a>:
</p>
<pre># groupadd -r audit
# gpasswd -a <i>user</i> audit
</pre>
<p>Add <code>audit</code> group to <code>auditd.conf</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/audit/auditd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">log_group = audit</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> As of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=audit">audit</a></span> 4.1.2-1 Arch Linux ships a set of <code>tmpfiles.d</code> configuration files which include the following lines:
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/lib/tmpfiles.d/audit.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[...]
d /var/log/audit 700 root root - -
[...]
z /var/log/audit 700 root root - -</pre>
<p>These will make <code>/var/log/audit</code> unreadable to a user account which is only a member of <code>audit</code> user group any time <code>systemd-tmpfiles</code> is called, such as during a system upgrade via pacman. You can override this behavior by creating the following file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/tmpfiles.d/audit.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">z /var/log/audit 750 root audit - -</pre>
</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip</strong> You may use other already existing system groups like <code>wheel</code> or <code>adm</code>.</div>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=python-notify2">python-notify2</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=python-psutil">python-psutil</a></span>.
</p>
<p>Create a <a href="../en/Desktop_entries.html" class="mw-redirect" title="Desktop launcher">desktop launcher</a> with the below content:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/autostart/apparmor-notify.desktop</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Desktop Entry]
Type=Application
Name=AppArmor Notify
Comment=Receive on screen notifications of AppArmor denials
TryExec=aa-notify
Exec=aa-notify -p -s 1 -w 60 -f /var/log/audit/audit.log
StartupNotify=false
NoDisplay=true</pre>
<p>Reboot and check if the <code>aa-notify</code> process is running:
</p>
<pre>$ pgrep -ax aa-notify
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> Depending on your specific system configuration there could be A LOT of notifications displayed.</div>
<p>For more information, see <span class="plainlinks archwiki-template-man" title="$ man 8 aa-notify"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/aa-notify.8">aa-notify(8)</a></span>.
</p>
<div class="mw-heading mw-heading3"><h3 id="Speed-up_AppArmor_start_by_caching_profiles">Speed-up AppArmor start by caching profiles</h3></div>
<p>Since AppArmor has to translate the configured profiles into a binary format it may significantly increase the boot time. You can check current AppArmor startup time with:
</p>
<pre>$ systemd-analyze blame | grep apparmor
</pre>
<p>To enable caching AppArmor profiles, uncomment:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/apparmor/parser.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">## Turn creating/updating of the cache on by default
write-cache</pre>
<p>To change default cache location add:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/apparmor/parser.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">cache-loc=/path/to/location</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note</strong> Since 2.13.1 default cache location is <code>/var/cache/apparmor/</code>, previously it was <code>/etc/apparmor.d/cache.d/</code>.</div>
<p>Reboot and check AppArmor startup time again to see improvement:
</p>
<pre>$ systemd-analyze blame | grep apparmor
</pre>
<div class="mw-heading mw-heading2"><h2 id="Troubleshooting">Troubleshooting</h2></div>
<div class="mw-heading mw-heading3"><h3 id="Failing_to_start_Samba_SMB/CIFS_server">
<span id="Failing_to_start_Samba_SMB.2FCIFS_server"></span>Failing to start Samba SMB/CIFS server</h3></div>
<p>See <a href="../en/Samba.html#Permission_issues_on_AppArmor" title="Samba">Samba#Permission issues on AppArmor</a>.
</p>
<div class="mw-heading mw-heading3"><h3 id="Login_impossible_after_upgrading_to_AppArmor_v4">Login impossible after upgrading to AppArmor v4</h3></div>
<p>In rare cases, after upgrading to AppArmor version 4, <a rel="nofollow" class="external text" href="https://gitlab.archlinux.org/archlinux/packaging/packages/apparmor/-/issues/2">it becomes impossible to log into any system account</a>.
</p>
<p>The <a href="../en/Systemd/Journal.html" title="Systemd/Journal">system journal</a> might contain errors like these:
</p>
<pre>unix_chkpwd[1612]: check pass; user unknown
unix_chkpwd[1612]: password check failed for user (john)
gdm-password][1574]: pam_unix(gdm-password:auth): authentication failure; logname= uid=0 euid=0 tty=/dev/tty1 ruser= rhost=  user=john
kernel: audit: type=1400 audit(1730844640.468:171): apparmor="DENIED" operation="capable" class="cap" profile="unix-chkpwd" pid=1612 comm="unix_chkpwd" capability=2  capname="dac_read_search"
kernel: audit: type=1400 audit(1730844640.468:172): apparmor="DENIED" operation="capable" class="cap" profile="unix-chkpwd" pid=1612 comm="unix_chkpwd" capability=1  capname="dac_override"</pre>
<p>This might be caused by <code>/etc/shadow</code> and/or <code>/etc/gshadow</code> not being readable by the <code>root</code> user (i.e. the permission bits of those files might be entirely unset). Thus, a possible solution would be to:
</p>
<ol>
<li>Reboot, and <a href="#Disabling_loading">disable AppArmor</a> either by editing the appropriate <a href="../en/Arch_boot_process.html#Boot_loader" class="mw-redirect" title="Boot loader">boot loader</a> entry during boot or by using fallback boot entry, which doesn't have AppArmor enabled.</li>
<li>Log in as <code>root</code>, and set the correct file permissions: <code>chmod 600 /etc/shadow /etc/gshadow</code>
</li>
<li>Reboot once again.</li>
</ol>
<div class="mw-heading mw-heading3"><h3 id="Differences_between_Linux_distributions">Differences between Linux distributions</h3></div>
<p>Information you find often is about AppArmor on Ubuntu, which can be confusing, since Ubuntu carries a lot of kernel patches regarding AppArmor. Other distributions may also carry their own kernel patches, while Arch Linux uses a close-to-mainline kernel.
</p>
<p>For example, <span class="plainlinks archwiki-template-man" title="$ man 5 apparmor.d"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/apparmor.d.5">apparmor.d(5)</a></span> documented <code>dbus</code> rules years prior their support in the mainline kernel in 6.17 <a rel="nofollow" class="external autonumber" href="https://web.git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=c05e705812d1">[5]</a>. Support also varies by <a href="../en/D-Bus.html#Implementations" class="mw-redirect" title="Dbus">D-Bus implementation</a>: the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dbus">dbus</a></span> package is built without AppArmor support, necessary for applying dbus AppArmor rules.
</p>
<p>AppArmor-specific kernel patches applied by Ubuntu can be found at (replace <code><i>jammy</i></code> with the codename of the Ubuntu version you are interested in):
</p>
<pre>https://git.launchpad.net/~ubuntu-kernel/ubuntu/+source/linux/+git/<i>jammy</i>/log/?qt=grep&amp;q=UBUNTU%3A+SAUCE%3A+apparmor
</pre>
<p>The ABI versions supported by the userland tools can be found in <code>/etc/apparmor.d/abi/</code>. The ABI supported by the currently running kernel can be shown with:
</p>
<pre>$ aa-features-abi --extract
</pre>
<p>or
</p>
<pre>$ ls /sys/kernel/security/apparmor/features/
</pre>
<div class="mw-heading mw-heading2"><h2 id="See_also">See also</h2></div>
<ul>
<li><a href="https://en.wikipedia.org/wiki/AppArmor" class="extiw" title="wikipedia:AppArmor">Wikipedia:AppArmor</a></li>
<li><a rel="nofollow" class="external text" href="https://gitlab.com/apparmor/apparmor/wikis/home">AppArmor wiki</a></li>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.com/apparmor/apparmor/wikis/AppArmor_Core_Policy_Reference">AppArmor Core Policy Reference</a> — Detailed description of available options in a profile</li>
<li>
<a rel="nofollow" class="external text" href="https://ubuntuforums.org/showthread.php?t=1008906">Ubuntu Tutorial</a> — General overview of available utilities and profile creation</li>
<li>
<a rel="nofollow" class="external text" href="https://help.ubuntu.com/community/AppArmor">Ubuntu Wiki</a> — Basic command overview</li>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.com/apparmor/apparmor/wikis/AppArmor_versions">AppArmor Versions</a> — Version overview and links to the respective release notes</li>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.com/apparmor/apparmor/wikis/Kernel_interfaces">Kernel Interfaces</a> — Low level interfaces to the AppArmor kernel module</li>
<li>
<a href="https://en.wikipedia.org/wiki/Linux_Security_Modules" class="extiw" title="wikipedia:Linux Security Modules">wikipedia:Linux Security Modules</a> — Linux kernel module on which basis AppArmor is build upon</li>
<li><a rel="nofollow" class="external text" href="https://doc.opensuse.org/documentation/leap/security/single-html/book-security/index.html#part-apparmor">AppArmor in openSUSE Security Guide</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Access_control.html" title="Category:Access control">Access control</a></li>
<li><a href="../en/Category:Kernel.html" title="Category:Kernel">Kernel</a></li>
</ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=AppArmor&amp;oldid=853107">https://wiki.archlinux.org/index.php?title=AppArmor&amp;oldid=853107</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 17 November 2025, at 02:56.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><picture><source media="(min-width: 500px)" srcset="/resources/assets/poweredby_mediawiki.svg" width="88" height="31"><img src="/resources/assets/mediawiki_compact.svg" width="25" height="25" loading="lazy"></picture></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-header-container vector-sticky-header-container">
	<div id="vector-sticky-header" class="vector-sticky-header">
		<div class="vector-sticky-header-start">
			<div class="vector-sticky-header-icon-start vector-button-flush-left vector-button-flush-right" aria-hidden="true">
				<button class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-sticky-header-search-toggle" tabindex="-1" data-event-name="ui.vector-sticky-search-form.icon"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
			</button>
		</div>
			
		<div role="search" class="vector-search-box-vue vector-search-box">
			<div class="vector-typeahead-search-container">
				<div class="cdx-typeahead-search">
					<form action="/index.php" id="vector-sticky-search-form" class="cdx-search-input cdx-search-input--has-end-button">
						<div class="cdx-search-input__input-wrapper" data-search-loc="header-moved">
							<div class="cdx-text-input cdx-text-input--has-start-icon">
								<input class="cdx-text-input__input" type="search" name="search" placeholder="Search ArchWiki">
								<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
							</div>
							<input type="hidden" name="title" value="Special:Search">
						</div>
						<button class="cdx-button cdx-search-input__end-button">Search</button>
					</form>
				</div>
			</div>
		</div>
		<div class="vector-sticky-header-context-bar">
				<nav aria-label="Contents" class="vector-toc-landmark">
						
					<div id="vector-sticky-header-toc" class="vector-dropdown mw-portlet mw-portlet-sticky-header-toc vector-sticky-header-toc vector-button-flush-left">
						<input type="checkbox" id="vector-sticky-header-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-sticky-header-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
						<label id="vector-sticky-header-toc-label" for="vector-sticky-header-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
						</label>
						<div class="vector-dropdown-content">
					
						<div id="vector-sticky-header-toc-unpinned-container" class="vector-unpinned-container">
						</div>
					
						</div>
					</div>
			</nav>
				<div class="vector-sticky-header-context-bar-primary" aria-hidden="true"><span class="mw-page-title-main">AppArmor</span></div>
			</div>
		</div>
		<div class="vector-sticky-header-end" aria-hidden="true">
			<div class="vector-sticky-header-icons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-talk-sticky-header" tabindex="-1" data-event-name="talk-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbles mw-ui-icon-wikimedia-speechBubbles"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-subject-sticky-header" tabindex="-1" data-event-name="subject-sticky-header"><span class="vector-icon mw-ui-icon-article mw-ui-icon-wikimedia-article"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-history-sticky-header" tabindex="-1" data-event-name="history-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-history mw-ui-icon-wikimedia-wikimedia-history"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only mw-watchlink" id="ca-watchstar-sticky-header" tabindex="-1" data-event-name="watch-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-star mw-ui-icon-wikimedia-wikimedia-star"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-edit-sticky-header" tabindex="-1" data-event-name="wikitext-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-wikiText mw-ui-icon-wikimedia-wikimedia-wikiText"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-ve-edit-sticky-header" tabindex="-1" data-event-name="ve-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-edit mw-ui-icon-wikimedia-wikimedia-edit"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-viewsource-sticky-header" tabindex="-1" data-event-name="ve-edit-protected-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-editLock mw-ui-icon-wikimedia-wikimedia-editLock"></span>

<span></span>
			</a>
		</div>
			<div class="vector-sticky-header-buttons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive" id="ca-addsection-sticky-header" tabindex="-1" data-event-name="addsection-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbleAdd-progressive mw-ui-icon-wikimedia-speechBubbleAdd-progressive"></span>

<span>Add topic</span>
			</a>
		</div>
			<div class="vector-sticky-header-icon-end">
				<div class="vector-user-links">
				</div>
			</div>
		</div>
	</div>
</div>
<div class="mw-portlet mw-portlet-dock-bottom emptyPortlet" id="p-dock-bottom">
	<ul>
		
	</ul>
</div>
</body>
</html>
