<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Ruby on Rails - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.43.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Ruby_on_Rails rootpage-Ruby_on_Rails skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Installation</span>
			</div>
		</a>
		
			<button aria-controls="toc-Installation-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Installation subsection</span>
			</button>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
			<li id="toc-RubyGems" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#RubyGems">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.1</span>
					<span>RubyGems</span>
				</div>
			</a>
			
			<ul id="toc-RubyGems-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Pacman" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Pacman">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.2</span>
					<span>Pacman</span>
				</div>
			</a>
			
			<ul id="toc-Pacman-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Quarry_binary_repository" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Quarry_binary_repository">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">1.3</span>
					<span>Quarry binary repository</span>
				</div>
			</a>
			
			<ul id="toc-Quarry_binary_repository-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Configuration</span>
			</div>
		</a>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Application_servers" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Application_servers">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Application servers</span>
			</div>
		</a>
		
			<button aria-controls="toc-Application_servers-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Application servers subsection</span>
			</button>
		
		<ul id="toc-Application_servers-sublist" class="vector-toc-list">
			<li id="toc-Thin" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Thin">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1</span>
					<span>Thin</span>
				</div>
			</a>
			
			<ul id="toc-Thin-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Unicorn" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Unicorn">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2</span>
					<span>Unicorn</span>
				</div>
			</a>
			
			<ul id="toc-Unicorn-sublist" class="vector-toc-list">
				<li id="toc-Systemd_service" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Systemd_service">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.1</span>
					<span>Systemd service</span>
				</div>
			</a>
			
			<ul id="toc-Systemd_service-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Nginx_Configuration" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Nginx_Configuration">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.2</span>
					<span>Nginx Configuration</span>
				</div>
			</a>
			
			<ul id="toc-Nginx_Configuration-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Apache/Nginx_(using_Phusion_Passenger)" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Apache/Nginx_(using_Phusion_Passenger)">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.3</span>
					<span>Apache/Nginx (using Phusion Passenger)</span>
				</div>
			</a>
			
			<ul id="toc-Apache/Nginx_(using_Phusion_Passenger)-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Puma_(with_Nginx_as_reverse_proxy_server)" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Puma_(with_Nginx_as_reverse_proxy_server)">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.4</span>
					<span>Puma (with Nginx as reverse proxy server)</span>
				</div>
			</a>
			
			<ul id="toc-Puma_(with_Nginx_as_reverse_proxy_server)-sublist" class="vector-toc-list">
				<li id="toc-Option_A:_With_configuration_file" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Option_A:_With_configuration_file">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.4.1</span>
					<span>Option A: With configuration file</span>
				</div>
			</a>
			
			<ul id="toc-Option_A:_With_configuration_file-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Option_2:_by_systemd" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Option_2:_by_systemd">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.4.2</span>
					<span>Option 2: by systemd</span>
				</div>
			</a>
			
			<ul id="toc-Option_2:_by_systemd-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Databases" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Databases">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">4</span>
				<span>Databases</span>
			</div>
		</a>
		
			<button aria-controls="toc-Databases-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Databases subsection</span>
			</button>
		
		<ul id="toc-Databases-sublist" class="vector-toc-list">
			<li id="toc-SQLite" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#SQLite">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.1</span>
					<span>SQLite</span>
				</div>
			</a>
			
			<ul id="toc-SQLite-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-PostgreSQL" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#PostgreSQL">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.2</span>
					<span>PostgreSQL</span>
				</div>
			</a>
			
			<ul id="toc-PostgreSQL-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-MySQL" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#MySQL">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.3</span>
					<span>MySQL</span>
				</div>
			</a>
			
			<ul id="toc-MySQL-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Database_Access_Configuration" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Database_Access_Configuration">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.4</span>
					<span>Database Access Configuration</span>
				</div>
			</a>
			
			<ul id="toc-Database_Access_Configuration-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Create_the_databases_from_Rails" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Create_the_databases_from_Rails">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.5</span>
					<span>Create the databases from Rails</span>
				</div>
			</a>
			
			<ul id="toc-Create_the_databases_from_Rails-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-The_Perfect_Rails_Setup" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#The_Perfect_Rails_Setup">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">5</span>
				<span>The Perfect Rails Setup</span>
			</div>
		</a>
		
			<button aria-controls="toc-The_Perfect_Rails_Setup-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle The Perfect Rails Setup subsection</span>
			</button>
		
		<ul id="toc-The_Perfect_Rails_Setup-sublist" class="vector-toc-list">
			<li id="toc-Step_0:_SQLite" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Step_0:_SQLite">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.1</span>
					<span>Step 0: SQLite</span>
				</div>
			</a>
			
			<ul id="toc-Step_0:_SQLite-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Step_1:_RVM" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Step_1:_RVM">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.2</span>
					<span>Step 1: RVM</span>
				</div>
			</a>
			
			<ul id="toc-Step_1:_RVM-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Step_2:_Rubies" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Step_2:_Rubies">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.3</span>
					<span>Step 2: Rubies</span>
				</div>
			</a>
			
			<ul id="toc-Step_2:_Rubies-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Step_3:_Nginx_with_Passenger_support" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Step_3:_Nginx_with_Passenger_support">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.4</span>
					<span>Step 3: Nginx with Passenger support</span>
				</div>
			</a>
			
			<ul id="toc-Step_3:_Nginx_with_Passenger_support-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Step_4:_Gemsets_and_Apps" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Step_4:_Gemsets_and_Apps">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.5</span>
					<span>Step 4: Gemsets and Apps</span>
				</div>
			</a>
			
			<ul id="toc-Step_4:_Gemsets_and_Apps-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Passenger_for_Nginx_and_Passenger_Standalone" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Passenger_for_Nginx_and_Passenger_Standalone">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.6</span>
					<span>Passenger for Nginx and Passenger Standalone</span>
				</div>
			</a>
			
			<ul id="toc-Passenger_for_Nginx_and_Passenger_Standalone-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Step_5:_.rvmrc_files_and_ownerships" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Step_5:_.rvmrc_files_and_ownerships">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.7</span>
					<span>Step 5: .rvmrc files and ownerships</span>
				</div>
			</a>
			
			<ul id="toc-Step_5:_.rvmrc_files_and_ownerships-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Step_6:_Reverse_proxies" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Step_6:_Reverse_proxies">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.8</span>
					<span>Step 6: Reverse proxies</span>
				</div>
			</a>
			
			<ul id="toc-Step_6:_Reverse_proxies-sublist" class="vector-toc-list">
				<li id="toc-Launch_Passenger_Standalone_daemons_at_system_start-up" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Launch_Passenger_Standalone_daemons_at_system_start-up">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.8.1</span>
					<span>Launch Passenger Standalone daemons at system start-up</span>
				</div>
			</a>
			
			<ul id="toc-Launch_Passenger_Standalone_daemons_at_system_start-up-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Step_7:_Deployment" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Step_7:_Deployment">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.9</span>
					<span>Step 7: Deployment</span>
				</div>
			</a>
			
			<ul id="toc-Step_7:_Deployment-sublist" class="vector-toc-list">
				<li id="toc-With_subdomains" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#With_subdomains">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.9.1</span>
					<span>With subdomains</span>
				</div>
			</a>
			
			<ul id="toc-With_subdomains-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Without_subdomains" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Without_subdomains">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.9.2</span>
					<span>Without subdomains</span>
				</div>
			</a>
			
			<ul id="toc-Without_subdomains-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-References" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#References">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.10</span>
					<span>References</span>
				</div>
			</a>
			
			<ul id="toc-References-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">6</span>
				<span>See also</span>
			</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-References_2" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#References_2">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">7</span>
				<span>References</span>
			</div>
		</a>
		
		<ul id="toc-References_2-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Ruby on Rails</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 2 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-2" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">2 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Ruby_on_Rails" title="Ruby on Rails – 日本語" lang="ja" hreflang="ja" data-title="Ruby on Rails" data-language-autonym="日本語" data-language-local-name="日本語" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/Ruby_on_Rails" title="Ruby on Rails – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" data-title="Ruby on Rails" data-language-autonym="中文（简体）" data-language-local-name="中文（简体）" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<p><a rel="nofollow" class="external text" href="https://rubyonrails.org/">Ruby on Rails</a>, often shortened to Rails or RoR, is an open source web application framework for the <a href="../en/Ruby.html" title="Ruby">Ruby</a> programming language. It is intended to be used with an Agile development methodology that is used by web developers for rapid development.
</p>
<p><br>
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>Ruby on Rails requires <a href="../en/Ruby.html" title="Ruby">Ruby</a> to be installed, so read that article first for installation instructions. The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nodejs">nodejs</a></span> package is also required if using uglifier (Ruby wrapper for <a rel="nofollow" class="external text" href="https://github.com/mishoo/UglifyJS2">UglifyJS JavaScript compressor</a>, optional)
The Rails framework is linked to a version of Ruby (or the system Ruby installation).
Ruby version(s) installed can be from system or from rbenv or from rvm (Ruby Version Manager).
</p>
<h3><span class="mw-headline" id="RubyGems">RubyGems</span></h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You can also install Rails system-wide using Gems. To do this, run the following commands as root and append them with <code>--no-user-install</code>. Please read <a href="../en/Ruby.html#Installing_gems_system-wide" title="Ruby">Ruby#Installing gems system-wide</a> for possible dangers of using RubyGem in this way.</div>
<p>The following command will install Rails for the current user:
</p>
<pre>$ gem install rails
</pre>
<p>Building the documentation takes a while. If you want to skip it, append <code>--no-document</code> to the install command.
</p>
<pre>$ gem install rails --no-document
</pre>
<p>gem is a package manager for Ruby modules, somewhat like pacman is to Arch Linux. To update your gems, simply run:
</p>
<pre>$ gem update
</pre>
<h3><span class="mw-headline" id="Pacman">Pacman</span></h3>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ruby-rails/">ruby-rails</a></span><sup><small>AUR</small></sup> package. Alternatively, see <a href="../en/Ruby.html#Managing_RubyGems_using_pacman" title="Ruby">Ruby#Managing RubyGems using pacman</a>.
</p>
<h3><span class="mw-headline" id="Quarry_binary_repository">Quarry binary repository</span></h3>
<p>Install <i>ruby-rails</i> from the unofficial <a href="../en/Unofficial_user_repositories.html#quarry" title="Unofficial user repositories">quarry</a> repository.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>Rails is bundled with a basic HTTP server called Puma. You can create a test application to test it. First, create an application with the rails command:
</p>
<pre>$ rails new testapp_name
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you get an error like <code>Errno::ENOENT: No such file or directory (...) An error occurred while installing x, and Bundler cannot continue.</code>, you might have to configure <a href="../en/Ruby.html#Bundler" title="Ruby">Bundler</a> so that it installs gems per-user and not system-wide. Alternatively, run <code>rails new testapp_name</code> once as root. If it has completed successfully, delete <code>testapp_name/</code> and run <code>rails new testapp_name</code> again as a regular user.</div>
<p>This creates a new folder inside your current working directory. 
</p>
<pre>$ cd testapp_name
</pre>
<p>Next start the web server. It listens on port 3000 by default:
</p>
<pre>$ rails server
</pre>
<p>Now visit the testapp_name website on your local machine by opening http://localhost:3000 in your browser
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If Ruby complains about not being able to find a JavaScript runtime, install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nodejs">nodejs</a></span>.</div>
<p>A test-page should be shown greeting you "Welcome aboard".
</p>
<h2><span class="mw-headline" id="Application_servers">Application servers</span></h2>
<p>The built-in Ruby On Rails HTTP server (called Puma) is convenient for basic development, but it is not recommended for production use. Instead, you should use an application server such as <a href="#Thin">#Thin</a>, <a href="#Unicorn">#Unicorn</a> or <a href="#Apache/Nginx_(using_Phusion_Passenger)">Phusion Passenger</a>.
</p>
<h3><span class="mw-headline" id="Thin">Thin</span></h3>
<p><a rel="nofollow" class="external text" href="https://github.com/macournoyer/thin">Thin</a> is a fast and very simple Ruby web server.
</p>
<p>First install thin gem:
</p>
<pre>$ gem install thin
</pre>
<p>Then start it using:
</p>
<pre>$ thin start
</pre>
<h3><span class="mw-headline" id="Unicorn">Unicorn</span></h3>
<p><a rel="nofollow" class="external text" href="https://yhbt.net/unicorn/">Unicorn</a> is an application server that cannot talk directly to clients. Instead, a web server must sit between clients and Unicorn, proxying requests as needed. Unicorn is loosely based on Mongrel. It is used by Github, and it uses an architecture that tries hard to find the best child for handling a request. <a rel="nofollow" class="external text" href="https://github.com/blog/517-unicorn">Explanation of differences between Unicorn and Mongrel</a>.
</p>
<p>Install the Unicorn gem:
</p>
<pre># gem install unicorn
</pre>
<p>Then create a configuration file for your application in <code>/etc/unicorn/</code>. For example; here is a configuration example based on <a rel="nofollow" class="external text" href="https://web.archive.org/web/20140114222409/http://www.warden.pl:80/2011/01/07/running-redmine-under-unicorn-in-debian/">this tutorial</a> for Redmine:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/unicorn/redmine.ru</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">working_directory "/srv/http/redmine"
pid "/tmp/redmine.pid"

preload_app true
timeout 60
worker_processes 4
listen 4000
stderr_path('/var/log/unicorn.log')

GC.respond_to?(:copy_on_write_friendly=) and GC.copy_on_write_friendly = true

after_fork do |server, worker|
	#start the worker on port 4000, 4001, 4002 etc...
	addr = "0.0.0.0:#{4000 + worker.nr}"
	# infinite tries to start the worker
	server.listen(addr, :tries =&gt; -1, :delay =&gt; -1, :backlog =&gt; 128)

	#Drop privileges if running as root
	worker.user('nobody', 'nobody') if Process.euid == 0
end
</pre>
<p>Start it using:
</p>
<pre># /usr/bin/unicorn -D -E production -c /etc/unicorn/redmine.ru
</pre>
<h4><span class="mw-headline" id="Systemd_service">Systemd service</span></h4>
<p>Put the following contents in <code>/etc/systemd/system/unicorn.service</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/unicorn.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Unicorn application server
After=network.target

[Service]
Type=forking
User=redmine
ExecStart=/usr/bin/unicorn -D -E production -c /etc/unicorn/redmine.ru

[Install]
WantedBy=multi-user.target</pre>
<p>You can now easily start and stop unicorn using systemctl
</p>
<h4><span class="mw-headline" id="Nginx_Configuration">Nginx Configuration</span></h4>
<p>After setting up <a href="../en/Nginx.html" title="Nginx">Nginx</a>, configure unicorn as an upstream server using something like this (Warning: this is a stripped example. It probably does not work without additional configuration):
</p>
<pre>http {
	upstream unicorn {
		server 127.0.0.1:4000 fail_timeout=0;
		server 127.0.0.1:4001 fail_timeout=0;
		server 127.0.0.1:4002 fail_timeout=0;
		server 127.0.0.1:4003 fail_timeout=0;
	}

	server {
		listen		80 default;
		server_name	YOURHOSTNAMEHERE;

		location / {
			root			/srv/http/redmine/public;
			proxy_set_header	X-Forwarded-For $proxy_add_x_forwarded_for;
			proxy_set_header Host   $http_host;
			proxy_redirect		off;
			proxy_pass		<a rel="nofollow" class="external free" href="http://unicorn">http://unicorn</a>;
		}
	}
}</pre>
<h3>
<span id="Apache.2FNginx_.28using_Phusion_Passenger.29"></span><span class="mw-headline" id="Apache/Nginx_(using_Phusion_Passenger)">Apache/Nginx (using Phusion Passenger)</span>
</h3>
<p><a rel="nofollow" class="external text" href="https://www.phusionpassenger.com/">Phusion Passenger</a> is a module available for <a href="../en/Nginx.html" title="Nginx">Nginx</a> and <a href="../en/Apache_HTTP_Server.html" title="Apache HTTP Server">Apache HTTP Server</a>, that greatly simplifies setting up a Rails server environment. Nginx does not support modules as Apache and has to be compiled with <code>mod_rails</code> in order to support Passenger; let Passenger compile it for you. As for Apache, let Passenger set up the module for you.
</p>
<p>Two differents choices (one or the other, not both in same time):
</p>
<ol>
<li>Install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=passenger">passenger</a></span> package.</li>
<li>Installing the 'passenger' gem from any version of ruby (user setting): <pre># gem install passenger</pre>
</li>
</ol>
<p>If you are aiming to use <a href="../en/Apache_HTTP_Server.html" title="Apache HTTP Server">Apache HTTP Server</a>, install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mod_passenger">mod_passenger</a></span> package (if passenger is not installed from gem), and run:
</p>
<pre># passenger-install-apache2-module
</pre>
<p>In case a rails application is deployed with a sub-URI, like <a rel="nofollow" class="external free" href="http://example.com/yourapplication">http://example.com/yourapplication</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2023-05-06 ⓘ]</sup>, some additional configuration is required, see <a rel="nofollow" class="external text" href="https://www.phusionpassenger.com/library/deploy/apache/deploy/ruby/#deploying-an-app-to-a-sub-uri-or-subdirectory">the Passenger documentation</a>.
</p>
<p>For <a href="../en/Nginx.html" title="Nginx">Nginx</a>, install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nginx-mod-passenger">nginx-mod-passenger</a></span> package (if passenger is not installed from gem), and run:
</p>
<pre># passenger-install-nginx-module
</pre>
<p>The installer will provide you with any additional information regarding the installation (such as installing additional libraries).
</p>
<p>To serve an application with Nginx, configure it as follows:
</p>
<pre>server {
    server_name app.example.org;
    root path_to_app/public; # Be sure to point to 'public' folder!
    passenger_enabled on;
    rails_env development; # Rails environment.
}
</pre>
<h3>
<span id="Puma_.28with_Nginx_as_reverse_proxy_server.29"></span><span class="mw-headline" id="Puma_(with_Nginx_as_reverse_proxy_server)">Puma (with Nginx as reverse proxy server)</span>
</h3>
<p><a rel="nofollow" class="external text" href="https://puma.io/">Puma</a> (<a rel="nofollow" class="external text" href="https://github.com/puma/puma">Github Page</a>) is a simple, fast, threaded, and highly concurrent HTTP 1.1 server for Ruby/Rack applications, and is considered the replacement for Webrick and Mongrel. It was designed to be the go-to server for Rubinius, but also works well with JRuby and MRI. While reverse proxy server would acts as a load balancer that routes all external requests to a pool of web apps.
</p>
<p>For a webserver it is better to use a server user and group, check <a href="../en/Users_and_groups.html#Example_adding_a_user" title="Users and groups">Users and groups#Example adding a user</a>, below use <code>rails</code> as user name and <code>server</code> as group name, also <code>my_app</code> as rails app name.
</p>
<p>Start by copying your app to /var/www/my_app. And set new ownership with
</p>
<pre># cd /var/www/
# chown -R rails:server my_app
</pre>
<p>and permission for user with
</p>
<pre># chmod -R 775 my_app
</pre>
<p>Then add <code>puma gem</code> in the Gemfile and install with
</p>
<pre>$ cd my_app 
$ bundle install
</pre>
<p>Also install <code>nginx</code> by pacman.
</p>
<p>Under your app folder, create sockets, pid and log folder with
</p>
<pre>$ mkdir -p shared/pids shared/sockets shared/log
</pre>
<p>Backup nginx.conf with
</p>
<pre># cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.backup
</pre>
<p>Then create a new nginx.conf file with your favorite editor, copy codes below and modify as you like:
</p>
<pre>#user html;
worker_processes  1; # this may connect with the worker numbers puma can use.

#error_log  logs/error.log;
#error_log  logs/error.log  notice;
#error_log  logs/error.log  info;

#pid        logs/nginx.pid;

events {
    worker_connections  1024;
}

http {
	upstream app {
	    # Path to Puma SOCK file, as defined previously
 	    server unix:/var/www/my_app/shared/sockets/puma.sock;
	}

	server {
	    listen 80;
	    server_name localhost; # or your server name

	    root /var/www/my_app/public;

	    try_files $uri/index.html $uri @app;

	    location @app {
		proxy_pass http://app;
		proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
		proxy_set_header Host $http_host;
		proxy_redirect off;
	    }

	    error_page 500 502 503 504 /500.html;
	    client_max_body_size 4G;
	    keepalive_timeout 10;
	}
}</pre>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start">Start</a> the <code>nginx</code> service.
</p>
<p>There are several ways to start puma server, two ways are recommended below:
</p>
<p>In common create file <code>config/puma.rb</code>, copy codes below and modify as you like:
</p>
<pre># Change to match your CPU core count
# You can check available worker numbers with $ grep -c processor /proc/cpuinfo
# also see the comment in the nginx.conf
workers 2

# Min and Max threads per worker
#threads 1, 6

app_dir = File.expand_path("../..", __FILE__)
shared_dir = "#{app_dir}/shared"

# Default to production
#rails_env = ENV['RAILS_ENV'] || "production"
#environment rails_env

# Set up socket location
bind "unix://#{shared_dir}/sockets/puma.sock"

# Logging
#stdout_redirect "#{shared_dir}/log/puma.stdout.log", "#{shared_dir}/log/puma.stderr.log", true

# Set master PID and state locations
pidfile "#{shared_dir}/pids/puma.pid"
#state_path "#{shared_dir}/pids/puma.state"
#activate_control_app

#on_worker_boot do
#  require "active_record"
#  ActiveRecord::Base.connection.disconnect! rescue ActiveRecord::ConnectionNotEstablished
#  ActiveRecord::Base.establish_connection(YAML.load_file("#{app_dir}/config/database.yml")[rails_env])
#end</pre>
<h4><span class="mw-headline" id="Option_A:_With_configuration_file">Option A: With configuration file</span></h4>
<p>Start server with
</p>
<pre>$ bundle exec puma -C config/puma.rb
</pre>
<p>You can also run it in background with parameter <code>-d</code> and check with
</p>
<pre>$ pgrep puma
</pre>
<p>when you want to <code>kill</code> it.
</p>
<p>If you want to keep it after you log out, you can use
</p>
<pre>$ nohup bundle exec puma -C config/puma.rb &amp;
</pre>
<p>But if the system reboot, the process will still get lost.
</p>
<h4><span class="mw-headline" id="Option_2:_by_systemd">Option 2: by systemd</span></h4>
<p><a href="../en/Help:Reading.html#Append,_add,_create,_edit" class="mw-redirect" title="Create">Create</a> a new systemd unit: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/systemd/user/puma.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Puma application server
After=network.target

[Service]
WorkingDirectory=/var/www/my_app
#Environment=RAILS_ENV=production
PIDFile=/var/www/my_app/shared/pids/puma.pid
ExecStart=/home/rails/.gem/ruby/2.2.0/bin/bundle exec \
	 /home/rails/.gem/ruby/2.2.0/bin/puma \
	 -C /var/www/my_app/config/puma.rb

[Install]
WantedBy=default.target</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong>  For <code>ExecStart</code>, if you have installed gem globally, you can change routes to <code>/usr/local/bin/</code> in <code>ExecStart</code>.</div>
<p>Then <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start">start</a> the <code>puma.service</code> <a href="../en/Systemd/User.html" class="mw-redirect" title="User unit">user unit</a>. 
</p>
<p>To enable puma system-widely, <a href="../en/Help:Reading.html#Append,_add,_create,_edit" class="mw-redirect" title="Create">create</a>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/puma.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Puma application server
After=network.target

[Service]
WorkingDirectory=/var/www/my_app
#Environment=RAILS_ENV=production
User=rails
PIDFile=/var/www/my_app/shared/pids/puma.pid
ExecStart=/home/rails/.gem/ruby/2.2.0/bin/bundle exec \
	 /home/rails/.gem/ruby/2.2.0/bin/puma \
	 -C /var/www/my_app/config/puma.rb

[Install]
WantedBy=multi-user.target</pre>
<p>For further reading take a look at <a href="#References">#References</a>. Also, for easily deploying app in production mode, you can try <a rel="nofollow" class="external text" href="https://github.com/capistrano/capistrano">capistrano</a>
</p>
<h2><span class="mw-headline" id="Databases">Databases</span></h2>
<p>Most web applications will need to interact with some sort of database. ActiveRecord (the ORM used by Rails to provide database abstraction) supports several database vendors, the most popular of which are MySQL, SQLite, and PostgreSQL.
And then you will have next to configure the file "config/database.yml" for Rails application web site able to connect on your database.
</p>
<h3><span class="mw-headline" id="SQLite">SQLite</span></h3>
<p>SQLite is the default lightweight database for Ruby on Rails. To enable SQLite, simply install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=sqlite">sqlite</a></span>.
</p>
<h3><span class="mw-headline" id="PostgreSQL">PostgreSQL</span></h3>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=postgresql">postgresql</a></span>.
</p>
<p>Install for Rails:
</p>
<pre># gem install pg
</pre>
<p>Or add the gem inside your Gemfile of your project, then use bundle.
</p>
<p>create a new Rails web site:
</p>
<pre># rails new my_web_site -d postgresql
</pre>
<h3><span class="mw-headline" id="MySQL">MySQL</span></h3>
<p>First, install and configure a MySQL server. Please refer to <a href="../en/MariaDB.html" title="MariaDB">MariaDB</a> on how to do this.
</p>
<p>A gem with some native extensions is required, probably best installed as root:
</p>
<pre># gem install mysql
</pre>
<p>You can generate a rails application configured for MySQL by using the <code>-d</code> parameter:
</p>
<pre>$ rails new testapp_name -d mysql
</pre>
<h3><span class="mw-headline" id="Database_Access_Configuration">Database Access Configuration</span></h3>
<p>What ever Database (MySQL or Postgresql or SQlite (the default one) you use, you then need to edit <code>config/database.yml</code>. Rails uses different databases for development, testing, production and other environments. Here is an example development configuration for MySQL running on localhost:
</p>
<pre> default:
   adapter: mysql (or postgresql or sqlite)
   username: my_user_name_access
   password: my_secret_password
</pre>
<p>For safety reasons, it is a good practice to not directly put password (who will be no more secret) as clear text in a text file.
Instead you can replace "my_secret_password' by "'&lt;%= ENV["MYSQL_PASSWD"] %&gt;'" where MYSQL_PASSWD can be an environment variable exported from the user environment the server use (~/.profile or ~/.bashrc or ~/.zshrc depend of your choice and utility). Surrounding &lt;%= ENV.... %&gt; by "'" searve in case of your password has some special chars like # or !, etc...
</p>
<h3><span class="mw-headline" id="Create_the_databases_from_Rails">Create the databases from Rails</span></h3>
<p>Note that you do not have to actually create the database using MySQL or Postgresql or Sqlite, as this can be done via Rails directly with:
</p>
<p>For rails-4.X version:
</p>
<pre># rake db:create
</pre>
<p>For rails-5.X version:
</p>
<pre># rails db:create (for version of Rails-5.X)
</pre>
<p>If no errors are shown, then your database has been created and Rails can talk to your MySQL database.
</p>
<h2><span class="mw-headline" id="The_Perfect_Rails_Setup">The Perfect Rails Setup</span></h2>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-edit-clear.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs language, wiki syntax or style improvements. See <a href="../en/Help:Style.html" title="Help:Style">Help:Style</a> for reference.</b></p>
<div>
<b>Reason:</b> Bloggish title, content mostly just reiterates the things mentioned above. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Ruby_on_Rails.html">Talk:Ruby on Rails</a>)</div>
</div>
<p><i>Phusion Passenger running multiple Ruby versions.</i>
</p>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://archlinux.org/">Arch Linux</a>: A simple, lightweight distribution. ;)</li>
<li>
<a rel="nofollow" class="external text" href="https://www.nginx.org/">Nginx</a>: A fast and lightweight <b>web server</b> with a strong focus on high concurrency, performance and low memory usage.</li>
<li>
<a rel="nofollow" class="external text" href="http://www.modrails.com/">Passenger</a> (a.k.a. mod_rails or mod_rack): Supports both Apache and Nginx web servers. It makes deployment of Ruby web applications, such as those built on Ruby on Rails web framework, a breeze.</li>
<li>
<a rel="nofollow" class="external text" href="https://rvm.io/">Ruby Version Manager</a> (RVM): A command-line tool which allows you to easily install, manage, and work with multiple Ruby environments from interpreters to sets of gems. RVM lets you deploy each project with its own completely self-contained and dedicated environment —from the specific version of ruby, all the way down to the precise set of required gems to run your application—.</li>
<li>
<a rel="nofollow" class="external text" href="https://sqlite.org/">SQLite</a>: The default lightweight <b>database</b> for Ruby on Rails.</li>
</ul>
<h3><span class="mw-headline" id="Step_0:_SQLite">Step 0: SQLite</span></h3>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=sqlite">sqlite</a></span>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Of course SQLite is not critical in this setup, you can use MySQL and PostgreSQL as well.</div>
<h3><span class="mw-headline" id="Step_1:_RVM">Step 1: RVM</span></h3>
<p>Make a multi-user <a href="../en/RVM.html" title="RVM">RVM</a> installation as specified <a href="../en/RVM.html#Multi-user_installation" title="RVM">here</a>.
</p>
<p>In the 'adding users to the rvm group' step, do
</p>
<pre># usermod -a -G rvm http
# usermod -a -G rvm nobody
</pre>
<p><code>http</code> and <code>nobody</code> are the users related to Nginx and Passenger, respectively.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Maybe adding the 'nobody' user to the 'rvm' group is not necessary.</div>
<h3><span class="mw-headline" id="Step_2:_Rubies">Step 2: Rubies</span></h3>
<p>Once you have a working RVM installation in your hands, it is time to install the latest Ruby interpreter
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> During the installation of Ruby patches will be applied. Consider installing the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=base-devel">base-devel</a></span> package beforehand.</div>
<pre>$ rvm install 2.0.0
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong>  It may be useful to delete the 'global' gemsets of the environments that have web applications. Their gems might somehow interfere with Passenger. In that case, a <code>rvm 2.0.0 do gemset delete global</code> is sufficient.</div>
<h3><span class="mw-headline" id="Step_3:_Nginx_with_Passenger_support">Step 3: Nginx with Passenger support</span></h3>
<p>Run the following to allow passenger install nginx:
</p>
<pre>$ rvm use 2.0.0 
$ gem install passenger
$ rvmsudo passenger-install-nginx-module
</pre>
<p>The passenger gem will be put into the <i>default</i> gemset.
</p>
<p>This will download the sources of Nginx, compile and install it for you. It will guide you through all the process. Note that the default location for Nginx will be <code>/opt/nginx</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you encounter a compilation error regarding Boost threads, see <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=139164">this</a> article.</div>
<p>After completion, add the following two lines into the 'http block' at <code>/opt/nginx/conf/nginx.conf</code> that look like:
</p>
<pre>http { 
  ...
  passenger_root /usr/local/rvm/gems/ruby-2.0.0-p353/gems/passenger-3.0.9;
  passenger_ruby /usr/local/rvm/wrappers/ruby-2.0.0-p353/ruby;
  ...
}
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This step is currently being done automatically by the installer script.</div>
<h3><span class="mw-headline" id="Step_4:_Gemsets_and_Apps">Step 4: Gemsets and Apps</span></h3>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:View-refresh-red.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section is out of date.</b></p>
<div>
<b>Reason:</b> better examples needed – BrowserCMS has been unmaintained for years (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Ruby_on_Rails.html">Talk:Ruby on Rails</a>)</div>
</div>
<p>For each Rails application you should have a gemset. Suppose that you want to try <a rel="nofollow" class="external text" href="http://refinerycms.com">RefineryCMS</a> against BrowserCMS, two open-source Content Management Systems based on Rails.
</p>
<p>Install RefineryCMS first:
</p>
<pre>$ rvm use 2.0.0@refinery --create
$ gem install rails -v 4.0.1
$ gem install passenger
$ gem install refinerycms refinerycms-i18n sqlite3
</pre>
<p>Deploy a RefineryCMS instance called <i>refineria</i>:
</p>
<pre>$ cd /srv/http/
$ rvmsudo refinerycms refineria
</pre>
<p>Install BrowserCMS in a different gemset:
</p>
<pre>$ rvm use 2.0.0@browser --create
$ gem install rails -v 4.0.1
$ gem install passenger
$ gem install browsercms sqlite3
</pre>
<p>Deploy a BrowserCMS instance called <i>navegador</i>:
</p>
<pre>$ cd /srv/http/
$ rvmsudo browsercms demo navegador
$ cd /srv/http/navegador
$ rvmsudo rake db:install
</pre>
<h3><span class="mw-headline" id="Passenger_for_Nginx_and_Passenger_Standalone">Passenger for Nginx and Passenger Standalone</span></h3>
<p>Observe that the passenger gem was installed three times and with different intentions; in the environments
</p>
<ul>
<li>
<i>2.0.0</i> =&gt; for Nginx,</li>
<li>
<i>2.0.0@refinery</i> =&gt; Standalone</li>
<li>
<i>2.0.0@browser</i> =&gt; Standalone</li>
</ul>
<p>The strategy is to combine Passenger for Nginx with Passenger Standalone. One must first identify the Ruby environment (interpreter plus gemset) that one uses the most; in this setup the Ruby interpreter and the default gemset were selected. One then proceeds with setting up Passenger for Nginx to use that environment (step 3).
</p>
<ul>
<li>Applications within the chosen environment can be served as in <a href="#Apache/Nginx_(using_Phusion_Passenger)">Apache/Nginx (using Phusion Passenger)</a>, page up in this article.</li>
<li>All applications that are to use a different Ruby version and/or gemset can be served separately through Passenger Standalone and hook into the main web server via a reverse proxy configuration (step 6).</li>
</ul>
<h3><span class="mw-headline" id="Step_5:_.rvmrc_files_and_ownerships">Step 5: .rvmrc files and ownerships</span></h3>
<p>This step is crucial for the correct behaviour of the setup. RVM seeks for .rvmrc files when changing folders; if it finds one, it reads it. In these files normally one stores a line like
</p>
<pre>rvm &lt;ruby_version&gt;@&lt;gemset_name&gt;
</pre>
<p>so the specified environment is set at the entrance of applications' root folder.
</p>
<p>Create /srv/http/refineria/.rvmrc doing
</p>
<pre># echo "rvm ree@refinery" &gt; /srv/http/refineria/.rvmrc
</pre>
<p>, and /srv/http/navegador/.rvmrc with
</p>
<pre># echo "rvm 2.0.0@browser" &gt; /srv/http/navegador/.rvmrc
</pre>
<p>You have to enter to both application root folders now, because every first time that RVM finds a .rvmrc it asks you if you trust the given file, consequently you must validate the two files you have just created.
</p>
<p>These files aid the programs involved to find the correct gems.
</p>
<p>Apart, if applications' files and folders are not owned by the right user you will face database write-access problems. The use of rvmsudo produces <i>root</i>-owned archives when generated by Rails; in the other hand, <i>nobody</i> is the user for Passenger —if you have not changed it—: who will use and should posses them. Fix this doing
</p>
<pre># chown -R nobody.nobody /srv/http/refineria /srv/http/navegador
</pre>
<h3><span class="mw-headline" id="Step_6:_Reverse_proxies">Step 6: Reverse proxies</span></h3>
<p>You have to start the Passenger Standalone web servers for your applications. So, do
</p>
<pre>$ cd /srv/http/refineria
$ rvmsudo passenger start --socket tmp/sockets/passenger.socket -d
</pre>
<p>and
</p>
<pre>$ cd /srv/http/navegador
$ rvmsudo passenger start --socket tmp/sockets/passenger.socket -d
</pre>
<p>. The first time that you run a Passenger Standalone it will perform a minor installation.
</p>
<p>Note that you are using <i>unix domain</i> sockets instead of the commonly-used <i>TCP</i> sockets; it turns out that unix domain are significantly faster than TCP sockets.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you are experimenting trouble with unix sockets, changing to TCP should work:
<pre>rvmsudo passenger start -a 127.0.0.1 -p 3000 -d
</pre>
</div>
<h4><span class="mw-headline" id="Launch_Passenger_Standalone_daemons_at_system_start-up">Launch Passenger Standalone daemons at system start-up</span></h4>
<p><i>Do you have a script? Please post it here.</i>
</p>
<p>The systemd script below was made for a Typo blog I host at /srv/http/typo. It is located at /etc/systemd/system/passenger_typo.service. I set the Environment= tags (see "man systemd.exec") from the output of "rvm env". The only exception was PATH=, which I had to combine from my regular PATH and the output of rvm env.
</p>
<p>Note: If you do not set the "WorkingDirectory=" variable to your application folder, passenger will fail to find your app and will subsequently shut itself down.
</p>
<pre>[Unit]
Description=Passenger Standalone Script for Typo
After=network.target

[Service]
Type=forking
WorkingDirectory=/srv/http/typo
PIDFile=/srv/http/typo/tmp/pids/passenger.pid

Environment=PATH=/usr/local/rvm/gems/ruby-2.0.0-p0@typo/bin:/usr/local/rvm/gems/ruby-2.0.0-p0@global/bin:/usr/local/rvm/rubies/ruby-2.0.0-p0/bin:/usr/local/rvm/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/sbin:/usr/sbin:/sbin:/usr/bin/core_perl
Environment=rvm_env_string=ruby-2.0.0-p0@typo
Environment=rvm_path=/usr/local/rvm
Environment=rvm_ruby_string=ruby-2.0.0-p0
Environment=rvm_gemset_name=typo
Environment=RUBY_VERSION=ruby-2.0.0-p0
Environment=GEM_HOME=/usr/local/rvm/gems/ruby-2.0.0-p0@typo
Environment=GEM_PATH=/usr/local/rvm/gems/ruby-2.0.0-p0@typo:/usr/local/rvm/gems/ruby-2.0.0-p0@global
Environment=MY_RUBY_HOME=/usr/local/rvm/rubies/ruby-2.0.0-p0
Environment=IRBRC=/usr/local/rvm/rubies/ruby-2.0.0-p0/.irbrc

ExecStart=/bin/bash -c "rvmsudo passenger start --socket /srv/http/typo/tmp/sockets/passenger.socket -d"

[Install]
WantedBy=multi-user.target</pre>
<h3><span class="mw-headline" id="Step_7:_Deployment">Step 7: Deployment</span></h3>
<h4><span class="mw-headline" id="With_subdomains">With subdomains</span></h4>
<p>Once again edit /opt/nginx/conf/nginx.conf to include some vital instructions:
</p>
<pre>## RefineryCMS ##

server {
    server_name refinery.domain.com;
    root /srv/http/refineria/public;
    location / {
        proxy_pass <a rel="nofollow" class="external free" href="http://unix:/srv/http/refineria/tmp/sockets/passenger.socket">http://unix:/srv/http/refineria/tmp/sockets/passenger.socket</a>;
        proxy_set_header Host $host;
    }
}

## BrowserCMS ##

server {
    server_name browser.domain.com;
    root /srv/http/navegador/public;
    location / {
        proxy_pass <a rel="nofollow" class="external free" href="http://unix:/srv/http/navegador/tmp/sockets/passenger.socket">http://unix:/srv/http/navegador/tmp/sockets/passenger.socket</a>;
        proxy_set_header Host $host;
    }
}
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Or if using TCP sockets, configure the <i>proxy_pass</i> directive like
<pre>proxy_pass <a rel="nofollow" class="external free" href="http://127.0.0.1:3000">http://127.0.0.1:3000</a>;</pre>
</div>
<h4><span class="mw-headline" id="Without_subdomains">Without subdomains</span></h4>
<p>If you for some reason do not want to host each application on its own subdomain but rather in a url like: <code>site.com/railsapp</code> then you could do something like this in your config:
</p>
<pre>server {
    server_name site.com;
    #Base for the html files etc
    root /srv/http/;

    #First application you want hosted under domain site.com/railsapp
    location /railsapp {
        root /srv/http/railsapp/public;
        #you may need to change passenger_base_uri to be the uri you want to point at, ie:
        #passenger_base_uri /railsapp;
        #but probably only if you are using the other solution with passenger phusion
        proxy_pass <a rel="nofollow" class="external free" href="http://unix:/srv/http/railsapp/tmp/sockets/passenger.socket">http://unix:/srv/http/railsapp/tmp/sockets/passenger.socket</a>;
        proxy_set_header Host $host;
    }

    #Second applicatino you want hosted under domain site.com/anotherapp
    location /anotherapp {
        root /srv/http/anotherapp/public;
        #same thing about the passenger_base_uri here, but with value /anotherapp instead
        proxy_pass <a rel="nofollow" class="external free" href="http://unix:/srv/http/anotherapp/tmp/sockets/passenger.socket">http://unix:/srv/http/anotherapp/tmp/sockets/passenger.socket</a>;
        proxy_set_header Host $host;
    }
}
</pre>
<p>At this point you are in conditions to <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start">start</a> the <code>nginx</code> service and to access both CMSs through <i>refinery.domain.com</i> and <i>browser.domain.com</i>.
</p>
<h3><span class="mw-headline" id="References">References</span></h3>
<ul>
<li><a rel="nofollow" class="external text" href="https://rvm.io/integration/passenger">Using RVM rubies with Phusion Passenger</a></li>
<li>
<a rel="nofollow" class="external free" href="https://blog.phusion.nl/2010/09/21/phusion-passenger-running-multiple-ruby-versions">https://blog.phusion.nl/2010/09/21/phusion-passenger-running-multiple-ruby-versions</a><sup title="Last check status: SSL error">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2023-07-30 ⓘ]</sup>
</li>
<li><a rel="nofollow" class="external text" href="https://web.archive.org/web/20201111173525/http://ruby-journal.com/how-to-setup-rails-app-with-puma-and-nginx/">How to Setup Rails App With Puma and NGINX</a></li>
<li><a rel="nofollow" class="external free" href="https://www.digitalocean.com/community/tutorials/how-to-deploy-a-rails-app-with-puma-and-nginx-on-ubuntu-14-04">https://www.digitalocean.com/community/tutorials/how-to-deploy-a-rails-app-with-puma-and-nginx-on-ubuntu-14-04</a></li>
</ul>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a href="../en/Ruby.html" title="Ruby">Ruby</a></li>
<li><a href="../en/Nginx.html" title="Nginx">Nginx</a></li>
<li><a href="../en/Category:Web_applications.html" class="mw-redirect" title="LAMP">LAMP</a></li>
<li><a href="../en/MySQL.html" title="MySQL">MySQL</a></li>
</ul>
<h2><span class="mw-headline" id="References_2">References</span></h2>
<ul><li><a rel="nofollow" class="external text" href="https://rubyonrails.org/">Official site</a></li></ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Web_frameworks.html" title="Category:Web frameworks">Web frameworks</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Style.html" title="Category:Pages or sections flagged with Template:Style">Pages or sections flagged with Template:Style</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Ruby_on_Rails&amp;oldid=814828">https://wiki.archlinux.org/index.php?title=Ruby_on_Rails&amp;oldid=814828</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 20 August 2024, at 08:29.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki.svg" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul></ul>
</div>
</body>
</html>
