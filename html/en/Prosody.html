<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Prosody - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Prosody rootpage-Prosody skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Installation</div>
		</a>
		
			<button aria-controls="toc-Installation-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Installation subsection</span>
			</button>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
			<li id="toc-Optional_dependencies" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Optional_dependencies">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1</span>Optional dependencies</div>
			</a>
			
			<ul id="toc-Optional_dependencies-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Configuration</div>
		</a>
		
			<button aria-controls="toc-Configuration-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configuration subsection</span>
			</button>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
			<li id="toc-Authentication" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Authentication">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Authentication</div>
			</a>
			
			<ul id="toc-Authentication-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Logging" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Logging">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>Logging</div>
			</a>
			
			<ul id="toc-Logging-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Operation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Operation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Operation</div>
		</a>
		
			<button aria-controls="toc-Operation-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Operation subsection</span>
			</button>
		
		<ul id="toc-Operation-sublist" class="vector-toc-list">
			<li id="toc-Security" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Security">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>Security</div>
			</a>
			
			<ul id="toc-Security-sublist" class="vector-toc-list">
				<li id="toc-User_registration" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#User_registration">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.1</span>User registration</div>
			</a>
			
			<ul id="toc-User_registration-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Stream_encryption" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Stream_encryption">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.2</span>Stream encryption</div>
			</a>
			
			<ul id="toc-Stream_encryption-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Listing_users" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Listing_users">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>Listing users</div>
			</a>
			
			<ul id="toc-Listing_users-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Removal" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Removal">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Removal</div>
		</a>
		
		<ul id="toc-Removal-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Tips_and_tricks" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Tips_and_tricks">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Tips and tricks</div>
		</a>
		
			<button aria-controls="toc-Tips_and_tricks-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Tips and tricks subsection</span>
			</button>
		
		<ul id="toc-Tips_and_tricks-sublist" class="vector-toc-list">
			<li id="toc-Components" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Components">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1</span>Components</div>
			</a>
			
			<ul id="toc-Components-sublist" class="vector-toc-list">
				<li id="toc-Multi-User_Chat" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Multi-User_Chat">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.1</span>Multi-User Chat</div>
			</a>
			
			<ul id="toc-Multi-User_Chat-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Prosody_modules" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Prosody_modules">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2</span>Prosody modules</div>
			</a>
			
			<ul id="toc-Prosody_modules-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Console" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Console">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.3</span>Console</div>
			</a>
			
			<ul id="toc-Console-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Troubleshooting">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>Troubleshooting</div>
		</a>
		
		<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Development" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Development">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">7</span>Development</div>
		</a>
		
		<ul id="toc-Development-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Communication" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Communication">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">8</span>Communication</div>
		</a>
		
		<ul id="toc-Communication-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">9</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Prosody</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 3 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-3" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">3 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-de mw-list-item"><a href="https://wiki.archlinux.de/title/Prosody" title="Prosody – Deutsch" lang="de" hreflang="de" class="interlanguage-link-target"><span>Deutsch</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Prosody" title="Prosody – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-ru mw-list-item"><a href="../ru/Prosody.html" title="Prosody – русский" lang="ru" hreflang="ru" class="interlanguage-link-target"><span>Русский</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<p>From the <a rel="nofollow" class="external text" href="https://prosody.im/">official website</a>:
</p>
<dl><dd>Prosody is a modern XMPP communication server. It aims to be easy to set up and configure, and efficient with system resources. Additionally, for developers it aims to be easy to extend and give a flexible system on which to rapidly develop added functionality, or prototype new protocols.</dd></dl>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=prosody">prosody</a></span> package.
</p>
<h3><span class="mw-headline" id="Optional_dependencies">Optional dependencies</span></h3>
<p>Prosody has optional depedencies that although not strictly required for its operation, provide useful features. These dependencies may also have to be built and installed from the AUR. If you are unfamiliar with how to build and install packages from the AUR please see <a href="../en/Arch_User_Repository.html#Installing_and_upgrading_packages" title="Arch User Repository">Arch User Repository#Installing and upgrading packages</a>. As of prosody version <a rel="nofollow" class="external text" href="https://blog.prosody.im/prosody-0-11-2-released/">0.11.2</a>, Lua 5.2 is needed. 
</p>
<dl>
<dt>TLS/SSL Support (Recommended)</dt>
<dd>Allow Prosody to encrypt streams to prevent eavesdropping.<br><i>Requires:</i> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lua52-sec">lua52-sec</a></span>
</dd>
</dl>
<dl>
<dt>MySQL/Postgresql Backend</dt>
<dd>Allow Prosody to use a MySQL/mariadb/Postgresql backend for better scaling and performance.<br><i>Requires:</i> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lua52-dbi">lua52-dbi</a></span>
</dd>
</dl>
<dl>
<dt>Better Connection Scaling (Recommended)</dt>
<dd>Allow Prosody to use <a rel="nofollow" class="external text" href="https://www.monkey.org/~provos/libevent/">libevent</a> to handle a greater number of simultaneous connections.<br><i>Requires:</i> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/lua52-event/">lua52-event</a></span><sup><small>AUR</small></sup>
</dd>
</dl>
<dl>
<dt>Stream Compression</dt>
<dd>Allow Prosody to compress client-to-server streams for compatible clients to save bandwidth.<br><i>Requires:</i> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lua52-zlib">lua52-zlib</a></span>
</dd>
</dl>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The <code>posix</code> module and <code>pidfile</code> setting contained in the default configuration file are required for Prosody's proper operation.</div>
<p>The main configuration file is located at <code>/etc/prosody/prosody.cfg.lua</code>. Information on how to configure Prosody can be found in Prosody's <a rel="nofollow" class="external text" href="https://prosody.im/doc/configure">documentation</a>. The syntax of the configuration file can be checked after any changes are made by running: 
</p>
<pre># luac5.2 -p /etc/prosody/prosody.cfg.lua
</pre>
<p>No output means the syntax is correct.
</p>
<h3><span class="mw-headline" id="Authentication">Authentication</span></h3>
<p>The default configuration uses <a rel="nofollow" class="external text" href="https://prosody.im/doc/modules/mod_auth_internal_hashed">mod_auth_internal_hashed</a>. If you remove the line, it will default to <a rel="nofollow" class="external text" href="https://prosody.im/doc/modules/mod_auth_internal_plain">mod_auth_internal_plain</a>.
</p>
<h3><span class="mw-headline" id="Logging">Logging</span></h3>
<p>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=prosody">prosody</a></span> package is pre-configured to log to syslog. Thus, by default, Prosody log messages are available in the <a href="../en/Systemd/Journal.html" class="mw-redirect" title="Systemd journal">systemd journal</a>.
</p>
<h2><span class="mw-headline" id="Operation">Operation</span></h2>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start/enable">Start/enable</a> the <code>prosody.service</code> systemd service.
</p>
<p>Prosody uses the default XMPP ports, 5222 and 5269, for client-to-server and server-to-server communications respectively. Configure your firewall as necessary.
</p>
<p>You can manipulate Prosody users by using the <code>prosodyctl</code> program. To add a user:
</p>
<pre># prosodyctl adduser <i>JID</i>
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> You will likely want to make at least one user an administrator by adding their Jabber ID to the <code>admins</code> list in the configuration file.</div>
<p>See <span class="plainlinks archwiki-template-man" title="$ man 1 prosodyctl"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/prosodyctl.1">prosodyctl(1)</a></span> for details.
</p>
<h3><span class="mw-headline" id="Security">Security</span></h3>
<h4><span class="mw-headline" id="User_registration">User registration</span></h4>
<p>Prosody supports XMPP's in-band registration <a rel="nofollow" class="external text" href="https://xmpp.org/extensions/xep-0077.html">standard</a>, which allows users to register with an XMPP client from within their client and change their passwords. While this is convenient for users it does not allow administrators to moderate the registration of new users. As such, the <code>register</code> module is enabled in the default configuration but <code>allow_registration</code> is set to <code>false</code>. This allows existing users to change their passwords from within their client but does not allow new users to register themselves.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> If you do decide to support new in-band registrations, you will likely find the <code>watchregistrations</code> and <code>welcome</code> modules useful.</div>
<h4><span class="mw-headline" id="Stream_encryption">Stream encryption</span></h4>
<p>Prosody can utilize TLS certificates to encrypt client-to-server communications (if the proper <a href="#Optional_dependencies">dependencies</a> are installed). See the relevant sections of <code>prosody.cfg.lua</code> to configure Prosody to utilize these certificates.
</p>
<p>To require encryption for client-to-server communications add the following to your configuration file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/prosody/prosody.cfg.lua</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Host "*"

    c2s_require_encryption = true</pre>
<p>Similarly, for server-to-server communications you may do:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/prosody/prosody.cfg.lua</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Host "*"

    s2s_require_encryption = true</pre>
<p>While requiring client-to-server encryption is generally a good idea, please keep in mind that some popular XMPP services such as Google Talk/Gmail do not support server-to-server encryption.
</p>
<h3><span class="mw-headline" id="Listing_users">Listing users</span></h3>
<p>A simple way to see a list of the registered users is
</p>
<pre># ls -l /var/lib/prosody/*/accounts/*
</pre>
<p>alternatively, you can download the module <a rel="nofollow" class="external text" href="https://prosody.im/files/mod_listusers.lua">mod_listusers.lua</a>, and use it as
</p>
<pre># prosodyctl mod_listusers
</pre>
<h2><span class="mw-headline" id="Removal">Removal</span></h2>
<p>After normally uninstalling Prosody with pacman, the <code>/etc/prosody</code> and <code>/var/lib/prosody</code> directories may be left on your filesystem, and you may want to remove them if you do not plan on reinstalling Prosody.
</p>
<h2><span class="mw-headline" id="Tips_and_tricks">Tips and tricks</span></h2>
<h3><span class="mw-headline" id="Components">Components</span></h3>
<p>Prosody supports XMPP components, which provide extra services to clients. Components are either provided internally by special Prosody modules or externally using the protocol specified in <a rel="nofollow" class="external text" href="https://xmpp.org/extensions/xep-0114.html">XEP-0114</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Components must use a different hostname from the <code>VirtualHost</code> names defined in <code>prosody.cfg.lua</code>. Attempting to host a component on the same hostname as a defined <code>VirtualHost</code> <b>will</b> result in errors.</div>
<p>By default, Prosody will listen for external components. If you do not plan to use any external components with Prosody you can disable this behavior by adding the following your configuration:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/prosody/prosody.cfg.lua</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">component_ports = {}</pre>
<h4><span class="mw-headline" id="Multi-User_Chat">Multi-User Chat</span></h4>
<p>A common component used with XMPP servers is Multi-User Chat (MUC), which allows conferences between multiple users. MUC is provided as an internal component with Prosody. To enable MUC add the following to your configuration file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/prosody/prosody.cfg.lua</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Component "conference.example.com" "muc"
</pre>
<p>This will enable the MUC component on host <code>conference.example.com</code>.
</p>
<h3><span class="mw-headline" id="Prosody_modules">Prosody modules</span></h3>
<p><a rel="nofollow" class="external text" href="https://prosody.im/community_modules">Prosody Modules</a> is a collection of extra modules not distributed with Prosody. These modules are in various states of development from highly experimental to relatively stable. You should consult a given module's wiki page for more information. An example of an extra module is <code><a rel="nofollow" class="external text" href="https://code.google.com/p/prosody-modules/wiki/mod_pastebin">pastebin</a></code>, which when loaded will intercept long messages (for example, log file output) and replace them with a link to a pastebin hosted using Prosody's internal HTTP server (provided by the core module, <code>httpserver</code>).
</p>
<p>To use an extra module download its raw file(s) from the source browser (when viewing a file, search for the link "View raw file"). Alternatively and likely easier, use Mercurial to clone the entire repository:
</p>
<dl><dt>Prosody 0.9+</dt></dl>
<p><code>$ hg clone https://hg.prosody.im/prosody-modules/ prosody-modules</code>
</p>
<dl><dt>Prosody 0.8</dt></dl>
<p><code>$ hg clone http://0-8.prosody-modules.googlecode.com/hg/ prosody-modules</code>
</p>
<p>Now you can copy the module (and any additional files it needs) to Prosody's module directory at <code>/usr/lib/prosody/modules</code>. To enable the module add it to your <code>modules_enabled</code> list in your <code>prosody.cfg.lua</code> for the host or component you wish to use it for. For example, to use the <code>pastebin</code> module on a MUC component:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/prosody/prosody.cfg.lua</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Component "conference.example.com" "muc"
    modules_enabled = { "pastebin" }</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> An enforced Prosody convention is that modules are named <code>mod_<i>foo</i>.lua</code> but simply enabled by adding <code><i>foo</i></code> to the <code>modules_enabled</code> list.</div>
<h3><span class="mw-headline" id="Console">Console</span></h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> The console does not require any authentication so any user on a multi-user system can connect and issue commands on the console. Therefore it is <b>not</b> recommended to enable the <code>console</code> module on a multi-user system.</div>
<p>The <code>console</code> module provides a telnet console from which administrative operations and queries can be performed. You can connect to the console by issuing:
</p>
<p><code>$ telnet localhost 5582</code>
</p>
<p>You of course need the <code>telnet</code> program provided by the <code>inetutils</code> package. Use the <code>help</code> command in the console to get usage help.
</p>
<p>The console even allows you to execute Lua commands directly on the server by preceding a command with <code>&gt;</code>. For example to see if a client connection is compressed:
</p>
<p><code>&gt; full_sessions["romeo@montague.lit/Resource"].compressed</code>
</p>
<p>Will return <code>true</code> if the connection is compressed or <code>nil</code> if it is not.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<p>One of Prosody's primary design principles is to be simple to use and configure. However, issues can still arise (and likely will as is the case with any complex software). If you encounter a problem there are a variety of steps you can take to narrow down the cause:
</p>
<ul>
<li>
<b>Check for known issues</b><br>Look at the <a rel="nofollow" class="external text" href="https://prosody.im/doc/release">release notes</a> for your Prosody version to see if your issue is listed as a known issue. Also check the <a rel="nofollow" class="external text" href="https://prosody.im/issues/list">issue tracker</a> to see if your issue has already been reported.</li>
<li>
<b>Check configuration syntax</b><br>Run <code>luac5.1 -p /etc/prosody/prosody.cfg.lua</code> to check for any syntax errors in your configuration file. If there is no output your syntax is fine.</li>
<li>
<b>Check the log</b><br>Errors are only logged if there is a critical problem so always address those issues. If you think you have a very low level issue (like protocol compatibility between clients and servers with Prosody) then you can enable the very verbose debug level logging.</li>
<li>
<b>Check permissions</b><br>The Prosody package should add a new <code>prosody</code> user and group to your system and set appropriate permissions, but it is always good to double check. Ensure that <code>/etc/prosody</code> and <code>/var/lib/prosody</code> are owned by the <code>prosody</code> user and that the user has appropriate permissions to read and write to those paths and all contained files.</li>
<li>
<b>Check listening ports</b><br>When troubleshooting connection issues make sure that Prosody is actually listening for connections. You may do so by running <code>ss -tul</code> and making sure that <code>xmpp-client</code> (port 5222) and <code>xmpp-server</code> (port 5269) are listed.</li>
<li>
<b>Restart</b><br>Like most things, it does not hurt to <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">restart</a> <code>prosody.service</code> to see if it resolves an issue.</li>
</ul>
<p>If you are unable to resolve your issue yourself there are a variety of resources you can use to seek help. In order of immediacy with which you will likely receive help:
</p>
<ol>
<li>XMPP Conference: <code>prosody@conference.prosody.im</code>
</li>
<li>Mailing List: <code>prosody-users@googlegroups.com</code>, <a rel="nofollow" class="external text" href="https://groups.google.com/forum/#!forum/prosody-users">web interface</a>
</li>
<li>
<a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewforum.php?id=4">Arch Forums</a> (for package issues)</li>
</ol>
<h2><span class="mw-headline" id="Development">Development</span></h2>
<p>A development packages is maintained for Prosody in the AUR, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/prosody-hg/">prosody-hg</a></span><sup><small>AUR</small></sup>. <code>prosody-hg</code> tracks the <a rel="nofollow" class="external text" href="https://www.selenic.com/mercurial/wiki/">Mercurial</a> repository tip for Prosody and will always contain the latest code as it is checked in. Both packages are built similarly to the stable package.
</p>
<h2><span class="mw-headline" id="Communication">Communication</span></h2>
<ul>
<li>Mailing Lists: <a rel="nofollow" class="external text" href="https://groups.google.com/forum/#!forum/prosody-dev">prosody-dev</a>, <a rel="nofollow" class="external text" href="https://groups.google.com/forum/#!forum/prosody-users">prosody-users</a>
</li>
<li>Conference: <code>prosody@conference.prosody.im</code>
</li>
<li>Blog: <a rel="nofollow" class="external text" href="https://blog.prosody.im/">Prosodical Thoughts</a>
</li>
</ul>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://prosody.im/doc">Official documentation</a></li>
<li>
<a rel="nofollow" class="external text" href="https://blog.prosody.im/">Prosodical Thoughts</a> (Blog)</li>
<li><a rel="nofollow" class="external text" href="https://prosody.im/issues/">Issue Tracker</a></li>
<li>
<a rel="nofollow" class="external text" href="https://hg.prosody.im/prosody-modules/">Prosody Modules</a> (Extra Modules)</li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:XMPP.html" title="Category:XMPP">XMPP</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Prosody&amp;oldid=775264">https://wiki.archlinux.org/index.php?title=Prosody&amp;oldid=775264</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 10 April 2023, at 17:11.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
