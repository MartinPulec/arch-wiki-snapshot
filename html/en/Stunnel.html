<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Stunnel - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Stunnel rootpage-Stunnel skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Installation</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Configuration</div>
		</a>
		
			<button aria-controls="toc-Configuration-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configuration subsection</span>
			</button>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
			<li id="toc-Byte_order_mark_(BOM)" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Byte_order_mark_(BOM)">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Byte order mark (BOM)</div>
			</a>
			
			<ul id="toc-Byte_order_mark_(BOM)-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Authentication" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Authentication">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>Authentication</div>
			</a>
			
			<ul id="toc-Authentication-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Tips_and_Tricks" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Tips_and_Tricks">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Tips and Tricks</div>
		</a>
		
			<button aria-controls="toc-Tips_and_Tricks-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Tips and Tricks subsection</span>
			</button>
		
		<ul id="toc-Tips_and_Tricks-sublist" class="vector-toc-list">
			<li id="toc-DNS_over_TLS" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#DNS_over_TLS">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>DNS over TLS</div>
			</a>
			
			<ul id="toc-DNS_over_TLS-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Encrypting_NFSv4_with_Stunnel_TLS" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Encrypting_NFSv4_with_Stunnel_TLS">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>Encrypting NFSv4 with Stunnel TLS</div>
			</a>
			
			<ul id="toc-Encrypting_NFSv4_with_Stunnel_TLS-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Stunnel</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 1 language">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-1" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">1 language</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Stunnel" title="Stunnel – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/Transport_Layer_Security.html" title="Transport Layer Security">Transport Layer Security</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://www.stunnel.org">stunnel</a> (“Secure Tunnel”) is a
</p>
<dl><dd>cross-platform application used to provide a universal TLS/SSL tunneling service. It is a sort of proxy designed to add TLS encryption functionality to existing clients and servers without any changes in the programs' code. It is designed for security, portability, and scalability (including load-balancing), making it suitable for large deployments. It uses <a href="../en/OpenSSL.html" title="OpenSSL">OpenSSL</a>, and distributed under GNU GPL version 2 or later with OpenSSL exception.</dd></dl>
<p>Can tunnel only TCP packets. Its <a rel="nofollow" class="external text" href="https://www.stunnel.org/faq.html">FAQ</a> has some work around for UDP. <a href="../en/WireGuard.html" title="WireGuard">WireGuard</a> also has UDP capabilities.
</p>
<p>Authentication can also be used by the server to allow access only to approved clients.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=stunnel">stunnel</a></span> package.
</p>
<p>Depending on your usage, you might also <a href="../en/Systemd.html#Editing_provided_units" title="Systemd">edit the provided systemd units</a> to better <a href="../en/Systemd.html#Handling_dependencies" title="Systemd">handle dependencies</a>. In order for the stunnel to start up automatically at system boot you must <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">enable</a> it.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>The main configuration file is read from <code>/etc/stunnel/stunnel.conf</code>. It is an ini-style file. It is composed from a global section, followed by one, or more, service sections. 
</p>
<p>A client is one to accept non TLS encrypted data. Stunnel will TLS encrypts its data and connects to the stunnel server. The stunnel server accepts TLS encrypted data and extracts it. It then connects to where the data should be sent to.
</p>
<p>The default <code>debug</code> value is 5, which is very verbose. After verifying correct operation, it is worth explicitly setting lower value in the configuration file.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/stunnel/stunnel.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">debug = 3</pre>
<p>For better security, it is advised to explicitly set an appropriate uid and gid, other then root, for the global section and the per service sections. The configuration tokens <code>setuid</code> and <code>setgid</code> are available for this purpose.
</p>
<h3>
<span id="Byte_order_mark_.28BOM.29"></span><span class="mw-headline" id="Byte_order_mark_(BOM)">Byte order mark (BOM)</span>
</h3>
<p>The configuration file should have a UTF-8 <a href="https://en.wikipedia.org/wiki/Byte_order_mark" class="extiw" title="wikipedia:Byte order mark">byte order mark (BOM)</a>, at the beginning of the file. A BOM is the unicode character U+FEFF. Its UTF-8 representation is the (hexadecimal) byte sequence 0xEF, 0xBB, 0xBF. Creating a file with these bytes at its beginning can be done by
</p>
<pre># echo -e '\x<b>ef</b>\x<b>bb</b>\x<b>bf</b>; BOM composed of non printable characters. It is here, before the semicolon!' &gt; /etc/stunnel/stunnel.conf
</pre>
<p>To test if those bytes appear, one can use
</p>
<pre>% od --address-radix=n --format=x1c --read-bytes=8 /etc/stunnel/stunnel.conf
  <b>ef  bb  bf</b>  3b  20  42  4f  4d
 357 273 277   ;       B   O   M</pre>
<p>Note that when printing the file to the screen, such as with <code>cat</code>, or when editing the file with a text editor, the BOM bytes are usually not displayed. They should be there, though. Which is why you might want to verify that they are still there after editing is completed with the above <code>od</code>, or similar, command.
</p>
<h3><span class="mw-headline" id="Authentication">Authentication</span></h3>
<p>At least one of the client and the server, and optionally both, should be authenticated. Either a pre shared secret, or a key and certificate pair, can be used for authentication. A pre shared secret has to be transferred to all involved machines a priory by other means, such as <a href="../en/SCP_and_SFTP.html" title="SCP and SFTP">SCP and SFTP</a>. When such transfer is acceptable, pre shared key is the fastest method. Its speed might help mitigating attacks. A simple configuration for a single server with a single client that are using a pre shared secret is:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">client:/etc/stunnel/stunnel.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">; BOM composed of non printable characters. It is here, before the semicolon!
setuid = stunnel
setgid = stunnel

[trivial client]
client     = yes
accept     = 127.0.0.1:&lt;src_port&gt;
connect    = &lt;server_host&gt;:&lt;server_port&gt;
debug      = 3
PSKsecrets = /etc/stunnel/psk.txt
setuid     = stunnel
setgid     = stunnel</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">server:/etc/stunnel/stunnel.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">; BOM composed of non printable characters. It is here, before the semicolon!
setuid = stunnel
setgid = stunnel

[trivial server]
accept     = &lt;server_port&gt;
connect    = &lt;dst_port&gt;
ciphers    = PSK
debug      = 3
PSKsecrets = /etc/stunnel/psk.txt
setuid     = stunnel
setgid     = stunnel</pre>
<p>where <code>/etc/stunnel/psk.txt</code> could be created on one machine by
</p>
<pre># openssl rand -base64 -out /etc/stunnel/psk.txt 180
# sed --in-place '1s/^/psk:/' /etc/stunnel/psk.txt
</pre>
<p>and copied to the other machine by secure means before starting stunnel. The <a href="../en/File_permissions_and_attributes.html" class="mw-redirect" title="Permissions">permissions</a> for each <code>psk.txt</code> file should be set appropriately. The psk string from the <code>sed</code> command is just a random name for the sake of the example. Do read <span class="plainlinks archwiki-template-man" title="$ man 8 stunnel"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/stunnel.8">stunnel(8)</a></span>.
</p>
<h2><span class="mw-headline" id="Tips_and_Tricks">Tips and Tricks</span></h2>
<h3><span class="mw-headline" id="DNS_over_TLS">DNS over TLS</span></h3>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Merge-arrows-2.svg" decoding="async" width="36" height="40" class="mw-file-element"></span></span><b>This article or section is a candidate for merging with <a href="../en/DNS_over_HTTPS_servers.html#DNS_over_TLS_configuration_via_stunnel" title="DNS over HTTPS servers">DNS over HTTPS servers#DNS over TLS configuration via stunnel</a>.</b></p>
<div>
<b>Notes:</b> Some configuration examples are provided there. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Stunnel.html">Talk:Stunnel</a>)</div>
</div>
<p><a href="../en/BIND.html" title="BIND">BIND</a> does not offer builtin facilities for encryption of queries and answers. Bind knowledge base suggests using stunnel. See <a rel="nofollow" class="external free" href="https://kb.isc.org/docs/aa-01386">https://kb.isc.org/docs/aa-01386</a>. The link mentions <a href="../en/Unbound.html" title="Unbound">unbound</a> at the bottom of the page. A user that have only shell accounts on both the client and the server can still tunnel DNS traffic even when both the resolver and the NS do not support DNS over TLS.
</p>
<h3><span class="mw-headline" id="Encrypting_NFSv4_with_Stunnel_TLS">Encrypting NFSv4 with Stunnel TLS</span></h3>
<p>See <a rel="nofollow" class="external text" href="https://www.linuxjournal.com/content/encrypting-nfsv4-stunnel-tls">Encrypting NFSv4 with Stunnel TLS</a>
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/stunnel" class="extiw" title="wikipedia:stunnel">Wikipedia:stunnel</a></li>
<li><a href="https://wiki.debian.org/Pan#SSL_encryption" class="extiw" title="debian:Pan">Debian:Pan#SSL encryption</a></li>
<li><a rel="nofollow" class="external text" href="https://www.linuxjournal.com/article/7628">Paranoid Penguin - Rehabilitating Clear-Text Network Applications with Stunnel</a></li>
<li><a rel="nofollow" class="external text" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-an-ssl-tunnel-using-stunnel-on-ubuntu">How To Set Up an SSL Tunnel Using Stunnel on Ubuntu</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Transport_Layer_Security.html" title="Category:Transport Layer Security">Transport Layer Security</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Merge.html" title="Category:Pages or sections flagged with Template:Merge">Pages or sections flagged with Template:Merge</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Stunnel&amp;oldid=767919">https://wiki.archlinux.org/index.php?title=Stunnel&amp;oldid=767919</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 17 February 2023, at 12:45.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
