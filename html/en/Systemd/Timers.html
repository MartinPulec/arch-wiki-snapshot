<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>systemd/Timers - ArchWiki</title>
<link rel="stylesheet" href="../../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Systemd_Timers rootpage-Systemd skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Timer_units" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Timer_units">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Timer units</div>
		</a>
		
		<ul id="toc-Timer_units-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Service_units" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Service_units">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Service units</div>
		</a>
		
		<ul id="toc-Service_units-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Management" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Management">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Management</div>
		</a>
		
		<ul id="toc-Management-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Examples" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Examples">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Examples</div>
		</a>
		
			<button aria-controls="toc-Examples-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Examples subsection</span>
			</button>
		
		<ul id="toc-Examples-sublist" class="vector-toc-list">
			<li id="toc-Monotonic_timer" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Monotonic_timer">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>Monotonic timer</div>
			</a>
			
			<ul id="toc-Monotonic_timer-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Realtime_timer" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Realtime_timer">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2</span>Realtime timer</div>
			</a>
			
			<ul id="toc-Realtime_timer-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Transient_timer_units" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Transient_timer_units">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Transient timer units</div>
		</a>
		
		<ul id="toc-Transient_timer_units-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-As_a_cron_replacement" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#As_a_cron_replacement">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>As a cron replacement</div>
		</a>
		
			<button aria-controls="toc-As_a_cron_replacement-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle As a cron replacement subsection</span>
			</button>
		
		<ul id="toc-As_a_cron_replacement-sublist" class="vector-toc-list">
			<li id="toc-Benefits" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Benefits">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.1</span>Benefits</div>
			</a>
			
			<ul id="toc-Benefits-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Caveats" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Caveats">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.2</span>Caveats</div>
			</a>
			
			<ul id="toc-Caveats-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-MAILTO" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#MAILTO">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.3</span>MAILTO</div>
			</a>
			
			<ul id="toc-MAILTO-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Using_a_crontab" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Using_a_crontab">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.4</span>Using a crontab</div>
			</a>
			
			<ul id="toc-Using_a_crontab-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Manually" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Manually">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.5</span>Manually</div>
			</a>
			
			<ul id="toc-Manually-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Tips_and_tricks" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Tips_and_tricks">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">7</span>Tips and tricks</div>
		</a>
		
			<button aria-controls="toc-Tips_and_tricks-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Tips and tricks subsection</span>
			</button>
		
		<ul id="toc-Tips_and_tricks-sublist" class="vector-toc-list">
			<li id='toc-Handling_"time_to_live"' class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href='#Handling_"time_to_live"'>
				<div class="vector-toc-text">
				<span class="vector-toc-numb">7.1</span>Handling "time to live"</div>
			</a>
			
			<ul id='toc-Handling_"time_to_live"-sublist' class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Desktop_notifications" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Desktop_notifications">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">7.2</span>Desktop notifications</div>
			</a>
			
			<ul id="toc-Desktop_notifications-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">8</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading">systemd/Timers</h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 7 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-7" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">7 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-de mw-list-item"><a href="https://wiki.archlinux.de/title/Systemd/Timers" title="Systemd/Timers – Deutsch" lang="de" hreflang="de" class="interlanguage-link-target"><span>Deutsch</span></a></li>
<li class="interlanguage-link interwiki-es mw-list-item"><a href="../../es/Systemd/Timers.html" title="Systemd (Español)/Timers – español" lang="es" hreflang="es" class="interlanguage-link-target"><span>Español</span></a></li>
<li class="interlanguage-link interwiki-fr mw-list-item"><a href="../../fr/Systemd/Timers.html" title="Systemd (Français)/Timers – français" lang="fr" hreflang="fr" class="interlanguage-link-target"><span>Français</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Systemd/%E3%82%BF%E3%82%A4%E3%83%9E%E3%83%BC" title="Systemd/タイマー – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-pt mw-list-item"><a href="../../pt/Systemd/Timers.html" title="Systemd (Português)/Timers – português" lang="pt" hreflang="pt" class="interlanguage-link-target"><span>Português</span></a></li>
<li class="interlanguage-link interwiki-ru mw-list-item"><a href="../../ru/Systemd/Timers.html" title="Systemd (Русский)/Timers – русский" lang="ru" hreflang="ru" class="interlanguage-link-target"><span>Русский</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/Systemd/Timers" title="Systemd/Timers – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"><div class="subpages">&lt; <a href="../../en/Systemd.html" title="Systemd">Systemd</a>
</div></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<p><span>
</span>
</p>
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../../en/Systemd.html" title="Systemd">systemd</a></li>
<li><a href="../../en/Systemd/User.html" title="Systemd/User">systemd/User</a></li>
<li><a href="../../en/Systemd/FAQ.html" class="mw-redirect" title="Systemd FAQ">systemd FAQ</a></li>
<li><a href="../../en/Cron.html" title="Cron">cron</a></li>
</ul>
</div>
<p>Timers are <a href="../../en/Systemd.html" title="Systemd">systemd</a> unit files whose name ends in <i>.timer</i> that control <i>.service</i> files or events. Timers can be used as an alternative to <a href="../../en/Cron.html" title="Cron">cron</a> (read <a href="#As_a_cron_replacement">#As a cron replacement</a>). Timers have built-in support for calendar time events, monotonic time events, and can be run asynchronously.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Timer_units">Timer units</span></h2>
<p>Timers are <i>systemd</i> unit files with a suffix of <i>.timer</i>. Timers are like other <a href="../../en/Systemd.html#Writing_unit_files" title="Systemd">unit configuration files</a> and are loaded from the same paths but include a <code>[Timer]</code> section which defines when and how the timer activates. Timers are defined as one of two types:
</p>
<ul>
<li>
<b>Realtime timers</b> (a.k.a. wallclock timers) activate on a calendar event, the same way that cronjobs do. The option <code>OnCalendar=</code> is used to define them.</li>
<li>
<b>Monotonic timers</b> activate after a time span relative to a varying starting point. They stop if the computer is temporarily suspended or shut down. There are number of different monotonic timers but all have the form: <code>On<i>Type</i>Sec=</code>. Common monotonic timers include <code>OnBootSec</code> and <code>OnUnitActiveSec</code>.</li>
</ul>
<p>For a full explanation of timer options, see the <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.timer"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.timer.5">systemd.timer(5)</a></span>. The argument syntax for calendar events and time spans is defined in <span class="plainlinks archwiki-template-man" title="$ man 7 systemd.time"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.time.7">systemd.time(7)</a></span>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> <i>systemd</i> offers the target <code>timers.target</code> which sets up all timers that should be active after boot (see <span class="plainlinks archwiki-template-man" title="$ man 7 systemd.special"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.special.7">systemd.special(7)</a></span> for details). To use it, add <code>WantedBy=timers.target</code> to the <code>[Install]</code> section of your timer and <a href="../../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">enable</a> the timer unit.</div>
<h2><span class="mw-headline" id="Service_units">Service units</span></h2>
<p>For each <i>.timer</i> file, a matching <i>.service</i> file exists (e.g. <code>foo.timer</code> and <code>foo.service</code>). The <i>.timer</i> file activates and controls the <i>.service</i> file. The <i>.service</i> does not require an <code>[Install]</code> section as it is the <i>timer</i> units that are enabled. If necessary, it is possible to control a differently-named unit using the <code>Unit=</code> option in the timer's <code>[Timer]</code> section.
</p>
<h2><span class="mw-headline" id="Management">Management</span></h2>
<p>To use a <i>timer</i> unit <a href="../../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">enable</a> and <a href="../../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start">start</a> it like any other unit (remember to add the <i>.timer</i> suffix). To view all started timers, run:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ systemctl list-timers</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">NEXT                          LEFT        LAST                          PASSED     UNIT                         ACTIVATES
Thu 2014-07-10 19:37:03 CEST  11h left    Wed 2014-07-09 19:37:03 CEST  12h ago    systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service
Fri 2014-07-11 00:00:00 CEST  15h left    Thu 2014-07-10 00:00:13 CEST  8h ago     logrotate.timer              logrotate.service
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>To list all timers (including inactive), use <code>systemctl list-timers --all</code>.</li>
<li>The status of a service started by a timer will likely be inactive unless it is currently being triggered.</li>
<li>If a timer gets out of sync, it may help to delete its <code>stamp-*</code> file in <code>/var/lib/systemd/timers</code> (or <code>~/.local/share/systemd/</code> in case of user timers). These are zero length files which mark the last time each timer was run. If deleted, they will be reconstructed on the next start of their timer.</li>
</ul>
</div>
<h2><span class="mw-headline" id="Examples">Examples</span></h2>
<p>A service unit file can be scheduled with a timer out-of-the-box. The following examples schedule <code>foo.service</code> to be run with a corresponding timer called <code>foo.timer</code>.
</p>
<h3><span class="mw-headline" id="Monotonic_timer">Monotonic timer</span></h3>
<p>A timer which will start 15 minutes after boot and again every week while the system is running.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/foo.timer</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Run foo weekly and on boot

[Timer]
OnBootSec=15min
OnUnitActiveSec=1w

[Install]
WantedBy=timers.target
</pre>
<h3><span class="mw-headline" id="Realtime_timer">Realtime timer</span></h3>
<p>A timer which starts once a week (at 12:00am on Monday). When activated, it triggers the service immediately if it missed the last start time (option <code>Persistent=true</code>), for example due to the system being powered off:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/foo.timer</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Run foo weekly

[Timer]
OnCalendar=weekly
Persistent=true

[Install]
WantedBy=timers.target</pre>
<p>When more specific dates and times are required, <code>OnCalendar</code> events uses the following format:
</p>
<pre>DayOfWeek Year-Month-Day Hour:Minute:Second
</pre>
<p>An asterisk may be used to specify any value and commas may be used to list possible values. Two values separated by <code>..</code> indicate a contiguous range.
</p>
<p>In the below example the service is run the first four days of each month at 12:00 PM, but <i>only</i> if that day is a Monday or a Tuesday.
</p>
<pre>OnCalendar=Mon,Tue *-*-01..04 12:00:00
</pre>
<p>To run a service on the first Saturday of every month, use:
</p>
<pre>OnCalendar=Sat *-*-1..7 18:00:00
</pre>
<p>When using the <code>DayOfWeek</code> part, at least one weekday has to be specified. If you want something to run every day at 4am, use:
</p>
<pre>OnCalendar=*-*-* 4:00:00
</pre>
<p>To run a service at different times, <code>OnCalendar</code> may be specified more than once. In the example below, the service runs at 22:30 on weekdays and at 20:00 on weekends.
</p>
<pre>OnCalendar=Mon..Fri 22:30
OnCalendar=Sat,Sun 20:00
</pre>
<p>You can also specify a timezone at the end of the directive (use <code>timedatectl list-timezones</code> to list accepted values)
</p>
<pre>OnCalendar=*-*-* 02:00:00 Europe/Paris
</pre>
<p>More information is available in <span class="plainlinks archwiki-template-man" title="$ man 7 systemd.time"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.time.7">systemd.time(7)</a></span>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 
<ul>
<li>
<code>OnCalendar</code> time specifications can be tested in order to verify their validity and to calculate the next time the condition would elapse when used on a timer unit file with the <code>calendar</code> option of the <i>systemd-analyze</i> utility. For example, one can use <code>systemd-analyze calendar weekly</code> or <code>systemd-analyze calendar "Mon,Tue *-*-01..04 12:00:00"</code>. Add <code>--iterations=N</code> to ask for more iterations to be printed.</li>
<li>The <code>faketime</code> command is especially useful to test various scenarios with the above command; it comes with the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libfaketime">libfaketime</a></span> package.</li>
<li>Special event expressions like <code>daily</code> and <code>weekly</code> refer to <i>specific start times</i> and thus any timers sharing such calendar events will start simultaneously. Timers sharing start events can cause poor system performance if the timers' services compete for system resources. The <code>RandomizedDelaySec</code> option in the <code>[Timer]</code> section avoids this problem by randomly staggering the start time of each timer. See <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.timer"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.timer.5">systemd.timer(5)</a></span>.</li>
<li>Add the option <code>AccuracySec=1us</code> to the <code>[Timer]</code> section, to avoid the inaccuracy of the <i>1m</i> default value of <code>AccuracySec</code>. Also see <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.timer"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.timer.5">systemd.timer(5)</a></span>.</li>
<li>Some options (<code>WakeSystem</code>) may require specific system capabilities and prevent a timer from starting, resulting in the following error messages: "Failed to enter waiting state: Operation not supported" and "Failed with result 'resources'.".</li>
</ul>
</div>
<h2><span class="mw-headline" id="Transient_timer_units">Transient timer units</span></h2>
<p>One can use <code>systemd-run</code> to create transient <i>.timer</i> units. That is, one can set a command to run at a specified time without having a service file. For example the following command touches a file after 30 seconds:
</p>
<pre># systemd-run --on-active=30 /bin/touch /tmp/foo
</pre>
<p>One can also specify a pre-existing service file that does not have a timer file. For example, the following starts the systemd unit named <code><i>someunit</i>.service</code> after 12.5 hours have elapsed:
</p>
<pre># systemd-run --on-active="12h 30m" --unit <i>someunit</i>.service
</pre>
<p>See <span class="plainlinks archwiki-template-man" title="$ man 1 systemd-run"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-run.1">systemd-run(1)</a></span> for more information and examples.
</p>
<h2><span class="mw-headline" id="As_a_cron_replacement">As a cron replacement</span></h2>
<p>Although <a href="../../en/Cron.html" title="Cron">cron</a> is arguably the most well-known job scheduler, <i>systemd</i> timers can be an alternative.
</p>
<h3><span class="mw-headline" id="Benefits">Benefits</span></h3>
<p>The main benefits of using timers come from each job having its own <i>systemd</i> service. Some of these benefits are:
</p>
<ul>
<li>Jobs can be easily started independently of their timers. This simplifies debugging.</li>
<li>Each job can be configured to run in a specific environment (see <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.exec"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.exec.5">systemd.exec(5)</a></span>).</li>
<li>Jobs can be attached to <a href="../../en/Cgroups.html" title="Cgroups">cgroups</a>.</li>
<li>Jobs can be set up to depend on other <i>systemd</i> units.</li>
<li>Jobs are logged in the <i>systemd</i> journal for easy debugging.</li>
</ul>
<h3><span class="mw-headline" id="Caveats">Caveats</span></h3>
<p>Some things that are easy to do with cron are difficult to do with timer units alone:
</p>
<ul>
<li>Creation: to set up a timed job with <i>systemd</i> you need to create two files and run <code>systemctl</code> commands, compared to adding a single line to a crontab.</li>
<li>Emails: there is no built-in equivalent to cron's <code>MAILTO</code> for sending emails on job failure. See <a href="#MAILTO">#MAILTO</a> for an example of setting up a similar functionality using <code>OnFailure=</code>.</li>
</ul>
<p>Also note that <a href="../../en/Systemd/User.html" title="Systemd/User">user</a> timer units will only run during an active user login session by default. However, <a href="../../en/Systemd/User.html#Automatic_start-up_of_systemd_user_instances" title="Systemd/User">lingering</a> can enable services to run at boot even when the user has no active login session.
</p>
<h3><span class="mw-headline" id="MAILTO">MAILTO</span></h3>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../../File:Merge-arrows-2.svg" decoding="async" width="36" height="40" class="mw-file-element"></span></span><b>This article or section is a candidate for merging with <a href="../../en/Systemd.html#Notifying_about_failed_services" title="Systemd">systemd#Notifying about failed services</a>.</b></p>
<div>
<b>Notes:</b> Same topic, different solution. (Discuss in <a rel="nofollow" class="external text" href="../../en/Talk:Systemd/Timers.html">Talk:Systemd/Timers</a>)</div>
</div>
<p>You can set up systemd to send an e-mail when a unit fails. Cron sends mail to <code>MAILTO</code> if the job outputs to stdout or stderr, but many jobs are setup to only output on error. First you need two files: an executable for sending the mail and a <i>.service</i> for starting the executable. For this example, the executable is just a shell script using <code>sendmail</code>, which is in packages that provide <code>smtp-forwarder</code>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/local/bin/systemd-email</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh

/usr/bin/sendmail -t &lt;&lt;ERRMAIL
To: $1
From: systemd &lt;root@$HOSTNAME&gt;
Subject: $2
Content-Transfer-Encoding: 8bit
Content-Type: text/plain; charset=UTF-8

$(systemctl status --full "$2")
ERRMAIL
</pre>
<p>Whatever executable you use, it should probably take at least two arguments as this shell script does: the address to send to and the unit file to get the status of. The <i>.service</i> we create will pass these arguments:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/status_email_<i>user</i>@.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=status email for %i to <i>user</i>

[Service]
Type=oneshot
ExecStart=/usr/local/bin/systemd-email <i>address</i> %i
User=nobody
Group=systemd-journal</pre>
<p>Where <code><i>user</i></code> is the user being emailed and <code><i>address</i></code> is that user's email address. Although the recipient is hard-coded, the unit file to report on is passed as an instance parameter, so this one service can send email for many other units. At this point you can <a href="../../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start">start</a> <code>status_email_<i>user</i>@dbus.service</code> to verify that you can receive the emails.
</p>
<p>Then simply <a href="../../en/Systemd.html#Editing_provided_units" class="mw-redirect" title="Edit">edit</a> the service you want emails for and add <code>OnFailure=status_email_<i>user</i>@%n.service</code> to the <code>[Unit]</code> section. <code>%n</code> passes the unit's name to the template.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>If you set up sSMTP security according to <a href="../../en/SSMTP.html#Security" title="SSMTP">sSMTP#Security</a> the user <code>nobody</code> will not have access to <code>/etc/ssmtp/ssmtp.conf</code>, and the <code>systemctl start status_email_<i>user</i>@dbus.service</code> command will fail. One solution is to use <code>root</code> as the User in the <code>status_email_<i>user</i>@.service</code> unit.</li>
<li>If you try to use <code>mail -s somelogs <i>address</i></code> in your email script, <code>mail</code> will fork and systemd will kill the mail process when it sees your script exit. Make the mail non-forking by doing <code>mail -Ssendwait -s somelogs <i>address</i></code>.</li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> Newer versions of systemd recommend using <code>DynamicUser=true</code> as a replacement for <code>User=nobody</code> which is now discouraged. See <a rel="nofollow" class="external text" href="https://github.com/v2fly/v2ray-core/issues/428">GitHub issue 428</a> for more details.</div>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../../File:Merge-arrows-2.svg" decoding="async" width="36" height="40" class="mw-file-element"></span></span><b>This article or section is a candidate for merging with <a href="../../en/Systemd.html#Drop-in_files" class="mw-redirect" title="Drop-in snippet">drop-in snippet</a>.</b></p>
<div>
<b>Notes:</b> This is a great tip that would benefit more people on the dedicated page. (Discuss in <a rel="nofollow" class="external text" href="../../en/Talk:Systemd/Timers.html">Talk:Systemd/Timers</a>)</div>
</div>
<p>Note that systemd also allows to set top level per-type drop-ins, to change some aspect of all units of a given type (e.g. <code>service</code>) by creating a file like <code>/etc/systemd/system/service.d/someName.conf</code>, which could set <code>OnFailure</code> for e.g. all services.
</p>
<h3><span class="mw-headline" id="Using_a_crontab">Using a crontab</span></h3>
<p>Several of the caveats can be worked around by installing a package that parses a traditional crontab to configure the timers. <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/systemd-cron-next-git/">systemd-cron-next-git</a></span><sup><small>AUR</small></sup> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/systemd-cron/">systemd-cron</a></span><sup><small>AUR</small></sup> are two such packages. These can provide the missing <code>MAILTO</code> feature.
</p>
<p>Also, like with crontabs, a unified view of all scheduled jobs can be obtained with <code>systemctl</code>. See <a href="#Management">#Management</a>.
</p>
<h3><span class="mw-headline" id="Manually">Manually</span></h3>
<p>Outside of migrating from an existing crontab, using the same periodicity as cron can be desired. To avoid the tedious task of creating a timer for each service to start periodically, use a <a href="../../en/Systemd.html#Using_units" title="Systemd">template unit</a>, for example: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/monthly@.timer</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Monthly Timer for %i service

[Timer]
OnCalendar=*-*-1 02:00:00
AccuracySec=6h
RandomizedDelaySec=1h
Persistent=true
Unit=%i.service

[Install]
WantedBy=default.target</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> See <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.timer"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.timer.5#OPTIONS">systemd.timer(5) § OPTIONS</a></span> for the importance of using <code>RandomizedDelaySec</code> and not only <code>AccuracySec</code> to avoid all units started by the timer firing at once.</div>
<p>Then one only needs to <a href="../../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable/start">enable/start</a> <code>monthly@<i>unit_name</i>.timer</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> The template units can be nested, e.g. one could <a href="../../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable/start">enable/start</a> <code>monthly@btrfs-scrub@mnt-$(systemd-escape bbb76c63-e4ac-4e39-8897-a120c5d30686).timer</code>.</div>
<h2><span class="mw-headline" id="Tips_and_tricks">Tips and tricks</span></h2>
<h3>
<span id="Handling_.22time_to_live.22"></span><span class="mw-headline" id='Handling_"time_to_live"'>Handling "time to live"</span>
</h3>
<p>Some software will track the time elapsed since they last ran, for example blocking the update of a database if the last download ended less than 24 hours ago. 
</p>
<p>By default, timers do not track when the task they launched has ended. To work around this, we can use <code>OnUnitInactiveSeconds</code>: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/daily-inactive@.timer</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Launch %i service 24hours after it deactivated

[Timer]
<b>OnUnitInactiveSec=1day1sec</b>
Unit=%i.service
Persistent=true

[Install]
WantedBy=default.target</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> With <code>Restart=on-failure</code> along with <code>RestartSec</code>, it is possible to have a unit rerun after failure and success according to different schedules, see <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.service"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.service.5#OPTIONS">systemd.service(5) § OPTIONS</a></span>.</div>
<h3><span class="mw-headline" id="Desktop_notifications">Desktop notifications</span></h3>
<p>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/systemd-timer-notify/">systemd-timer-notify</a></span><sup><small>AUR</small></sup> provides an automatic desktop notification that helps you notice when a systemd service is triggered by a timer and is running. The notification will automatically close when the service finishes.
</p>
<p>This can be helpful for understanding why CPU usage is high or for preventing a shutdown when a backup service hasn't finished.
</p>
<p>For more details and configuration options, visit <a rel="nofollow" class="external free" href="https://gitlab.com/Zesko/systemd-timer-notify">https://gitlab.com/Zesko/systemd-timer-notify</a>
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><span class="plainlinks archwiki-template-man" title="$ man 5 systemd.timer"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.timer.5">systemd.timer(5)</a></span></li>
<li><a href="https://fedoraproject.org/wiki/Features/SystemdCalendarTimers" class="extiw" title="fedora:Features/SystemdCalendarTimers">Fedora:Features/SystemdCalendarTimers</a></li>
<li><a href="https://wiki.gentoo.org/wiki/Systemd#Timer_services" class="extiw" title="gentoo:Systemd">Gentoo:Systemd#Timer services</a></li>
<li>
<b>systemd-cron</b> — provides systemd units to run cron scripts; using <i>systemd-crontab-generator</i> to convert crontabs</li>
</ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://github.com/systemd-cron/systemd-cron">https://github.com/systemd-cron/systemd-cron</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/systemd-cron/">systemd-cron</a></span><sup><small>AUR</small></sup>
</dd></dl>
<ul><li>
<b>systemd-cron-next</b> — tool to generate timers/services from crontab and anacrontab files</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://github.com/systemd-cron/systemd-cron-next">https://github.com/systemd-cron/systemd-cron-next</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/systemd-cron-next-git/">systemd-cron-next-git</a></span><sup><small>AUR</small></sup>
</dd></dl>
<ul><li><a rel="nofollow" class="external text" href="https://fedoramagazine.org/systemd-timers-for-scheduling-tasks/">Systemd Timers for Scheduling Tasks</a></li></ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../../en/Category:System_administration.html" title="Category:System administration">System administration</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../../en/Category:Pages_or_sections_flagged_with_Template:Merge.html" title="Category:Pages or sections flagged with Template:Merge">Pages or sections flagged with Template:Merge</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Systemd/Timers&amp;oldid=821727">https://wiki.archlinux.org/index.php?title=Systemd/Timers&amp;oldid=821727</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 29 November 2024, at 14:38.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
