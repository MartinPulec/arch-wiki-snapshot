<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>E4rat - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-E4rat rootpage-E4rat skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Process" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Process">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Process</div>
		</a>
		
			<button aria-controls="toc-Process-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Process subsection</span>
			</button>
		
		<ul id="toc-Process-sublist" class="vector-toc-list">
			<li id="toc-Who_benefits,_who_does_not" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Who_benefits,_who_does_not">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1</span>Who benefits, who does not</div>
			</a>
			
			<ul id="toc-Who_benefits,_who_does_not-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Installation</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Getting_it_to_work" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Getting_it_to_work">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Getting it to work</div>
		</a>
		
			<button aria-controls="toc-Getting_it_to_work-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Getting it to work subsection</span>
			</button>
		
		<ul id="toc-Getting_it_to_work-sublist" class="vector-toc-list">
			<li id="toc-e4rat-collect" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#e4rat-collect">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>e4rat-collect</div>
			</a>
			
			<ul id="toc-e4rat-collect-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-e4rat-realloc" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#e4rat-realloc">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>e4rat-realloc</div>
			</a>
			
			<ul id="toc-e4rat-realloc-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-e4rat-preload" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#e4rat-preload">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3</span>e4rat-preload</div>
			</a>
			
			<ul id="toc-e4rat-preload-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-e4rat_and_init_systems" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#e4rat_and_init_systems">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>e4rat and init systems</div>
		</a>
		
		<ul id="toc-e4rat_and_init_systems-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-e4rat-lite" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#e4rat-lite">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>e4rat-lite</div>
		</a>
		
			<button aria-controls="toc-e4rat-lite-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle e4rat-lite subsection</span>
			</button>
		
		<ul id="toc-e4rat-lite-sublist" class="vector-toc-list">
			<li id="toc-Using_e4rat-lite" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Using_e4rat-lite">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1</span>Using e4rat-lite</div>
			</a>
			
			<ul id="toc-Using_e4rat-lite-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Bootchart" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Bootchart">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>Bootchart</div>
		</a>
		
			<button aria-controls="toc-Bootchart-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Bootchart subsection</span>
			</button>
		
		<ul id="toc-Bootchart-sublist" class="vector-toc-list">
			<li id="toc-bootchart_2" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#bootchart_2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.1</span>bootchart</div>
			</a>
			
			<ul id="toc-bootchart_2-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-bootchart2" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#bootchart2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.2</span>bootchart2</div>
			</a>
			
			<ul id="toc-bootchart2-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Troubleshooting">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">7</span>Troubleshooting</div>
		</a>
		
			<button aria-controls="toc-Troubleshooting-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Troubleshooting subsection</span>
			</button>
		
		<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
			<li id="toc-startup.log_is_not_created" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#startup.log_is_not_created">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">7.1</span>startup.log is not created</div>
			</a>
			
			<ul id="toc-startup.log_is_not_created-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-e4rat_erroneously_reports_an_ext2_files_system" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#e4rat_erroneously_reports_an_ext2_files_system">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">7.2</span>e4rat erroneously reports an ext2 files system</div>
			</a>
			
			<ul id="toc-e4rat_erroneously_reports_an_ext2_files_system-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-/var/lib/e4rat/startup.log_is_not_accessible" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#/var/lib/e4rat/startup.log_is_not_accessible">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">7.3</span>/var/lib/e4rat/startup.log is not accessible</div>
			</a>
			
			<ul id="toc-/var/lib/e4rat/startup.log_is_not_accessible-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Remove_annoying_message_that_mess_up_boot_message" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Remove_annoying_message_that_mess_up_boot_message">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">7.4</span>Remove annoying message that mess up boot message</div>
			</a>
			
			<ul id="toc-Remove_annoying_message_that_mess_up_boot_message-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">8</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">E4rat</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 4 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-4" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">4 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-de mw-list-item"><a href="https://wiki.archlinux.de/title/e4rat" title="e4rat – Deutsch" lang="de" hreflang="de" class="interlanguage-link-target"><span>Deutsch</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/E4rat" title="E4rat – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-ru mw-list-item"><a href="../ru/E4rat.html" title="E4rat – русский" lang="ru" hreflang="ru" class="interlanguage-link-target"><span>Русский</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/E4rat" title="E4rat – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/Improving_performance/Boot_process.html" class="mw-redirect" title="Improve boot performance">Improve boot performance</a></li>
<li><a href="../en/Preload.html" title="Preload">Preload</a></li>
<li><a href="../en/Ext4.html" title="Ext4">Ext4</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="http://e4rat.sourceforge.net/">e4rat</a> stands for e4 'reduced access time' (ext4 file system only) and is a project by Andreas Rid and Gundolf Kiefer. The <a rel="nofollow" class="external text" href="http://e4rat.sourceforge.net/">e4rat range of tools</a> are comprised of e4rat-collect, e4rat-realloc and e4rat-preload.
</p>
<p>There is an alternative implementation called e4rat-lite, which appears to be more active and more optimised than the original e4rat project, see <a href="#e4rat-lite">#e4rat-lite</a>.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Process">Process</span></h2>
<p>If you look at a classical <a href="../en/Bootchart.html" title="Bootchart">bootchart</a> you will notice that neither disk nor CPU are utilized fully during the boot process. e4rat changes this to make full use of both disk and CPU during boot process and thus reduce boot time drastically. Its usage consists of three stages:
</p>
<ul>
<li>
<b>e4rat-collect</b> - assemble a list of all files loaded during a specified time after boot (default 120 seconds but this can be adjusted)</li>
<li>
<b>e4rat-realloc</b> - reallocate all the files in the list to one continuous space on the hard disk</li>
<li>
<b>e4rat-preload</b> - preload them all (using multiple CPU cores) for quick booting and loading of applications</li>
</ul>
<h3>
<span id="Who_benefits.2C_who_does_not"></span><span class="mw-headline" id="Who_benefits,_who_does_not">Who benefits, who does not</span>
</h3>
<p>e4rat has proven to be extremely effective for typical single user set-ups which boot straight into X, perhaps even with a number of programs open. If you have a server set-up and boot only into the CLI your boot time decrease may not be as drastic. Users of SSD drives do not benefit because there are no moving parts and thus (almost) no disk latency.
</p>
<p>It is always better to be safe than sorry. Just make backup if you cannot afford to lose data on your partition.
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/e4rat/">e4rat</a></span><sup><small>AUR</small></sup>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>In order to build it, you must first rebuild <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=audit">audit</a></span> from the <a href="../en/Arch_build_system.html" class="mw-redirect" title="ABS">ABS</a> with <code>staticlibs</code> option explicitly enabled. Simply installing the default <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=audit">audit</a></span> package will result in a build error.</li>
<li>Audit needs these options to be enabled in the kernel configuration (CONFIG_AUDIT) together with support for auditing system calls (CONFIG_AUDITSYSCALL) also see <a href="../en/Kernel/Arch_build_system.html" title="Kernel/Arch build system">Kernel/Arch build system</a>. Probably you will need <code>audit=1</code> to add to your kernel parameters.</li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> The <a href="#e4rat-lite">#e4rat-lite</a> does not need the rebuilded <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=audit">audit</a></span>, it works fine with the version from the official repos.
</div>
<h2><span class="mw-headline" id="Getting_it_to_work">Getting it to work</span></h2>
<p>Now for the nitty-gritty:
</p>
<h3><span class="mw-headline" id="e4rat-collect">e4rat-collect</span></h3>
<p>To have e4rat collect a list of files you will need to append <code>init=/sbin/e4rat-collect</code> to your  <a href="../en/Kernel_parameters.html" title="Kernel parameters">kernel parameters</a>. For example:
</p>
<pre>kernel /vmlinuz-linux root=/dev/disk/by-label/ARCH init=/sbin/e4rat-collect ro 5
</pre>
<p>This will only have to be done once so you may prefer to append this command on the grub command line itself.
</p>
<p>Upon booting e4rat-collect will watch your system for a default of 120 seconds. So if you boot, log into X, open your favourite browser and email client all within 2 minutes, every one of those activities is logged. To change the default of 120 seconds edit <code>/etc/e4rat.conf</code>. To manually stop e4rat-collect type:
</p>
<pre>e4rat-collect -k
</pre>
<p>or
</p>
<pre>pkill e4rat-collect
</pre>
<p>Upon successful boot and after having waited the allotted time you should see the file <code>/var/lib/e4rat/startup.log</code>.
</p>
<p>Do not forget to remove the e4rat-collect command from your <a href="../en/Arch_boot_process.html#Boot_loader" class="mw-redirect" title="Boot loader">Boot loader</a> configuration file (not necessary if you inserted it on the grub command line).
</p>
<h3><span class="mw-headline" id="e4rat-realloc">e4rat-realloc</span></h3>
<p>Once <i>e4rat-collect</i> has finished to run, do:
</p>
<pre># e4rat-realloc /var/lib/e4rat/startup.log
</pre>
<p>This can take a while depending on how many files you have in your startup.log file.
Switching to rescue mode with <code>systemctl isolate rescue</code> (<a href="../en/Systemd.html#Mapping_between_SysV_runlevels_and_systemd_targets" title="Systemd">Systemd#Mapping between SysV runlevels and systemd targets</a>) may allow for more inodes/blocks to be reallocated as some may not be free while in <i>multiuser.target</i>
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>It may be worthwhile to repeat the reallocation step multiple times before exiting or rebooting in order to further reduce the fragmentation count. Simply re-run the command  a few times to see if this is possible on your setup. If so you will see the count number reduced after a few runs. This is perfectly safe and should not cause any issues with booting.</li>
<li>Users using SysV-style <a href="../en/Init.html" title="Init">init</a> systems must switch to runlevel 1 using <code>sudo init 1</code> prior to running <code>e4rat-realloc</code>
</li>
</ul>
</div>
<h3><span class="mw-headline" id="e4rat-preload">e4rat-preload</span></h3>
<p>Append <code>init=/sbin/e4rat-preload</code> permanently to your <a href="../en/Kernel_parameters.html" title="Kernel parameters">kernel parameters</a>.
</p>
<h2><span class="mw-headline" id="e4rat_and_init_systems">e4rat and init systems</span></h2>
<p>e4rat-collect defaults to replacing itself with <code>/sbin/init</code> upon completion. With the default <code>systemd</code> installation, this file is a symbolic link to <code>/lib/systemd/systemd</code>. If you need to specify another process with PID 1, such as <code>/usr/bin/busybox</code>, you can change this in <code>/etc/e4rat.conf</code> by setting the <code>init</code> parameter:
</p>
<pre>init /usr/bin/busybox
</pre>
<p>This allows to launch both <code>e4rat-preload</code> and <code>bootchart</code> in the same boot sequence.
</p>
<h2><span class="mw-headline" id="e4rat-lite">e4rat-lite</span></h2>
<p>An alternative to e4rat with some improvements made. It is also expected to circumvent some issues one may experience with the original e4rat package.
It can be acquired from <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/e4rat-lite-git/">e4rat-lite-git</a></span><sup><small>AUR</small></sup>.
</p>
<h3><span class="mw-headline" id="Using_e4rat-lite">Using e4rat-lite</span></h3>
<p>The commands for e4rat-lite work almost identically to e4rat. Look at <a rel="nofollow" class="external text" href="https://github.com/ShyPixie/e4rat-lite#how-to-use">the README of the project</a>. The summary:
</p>
<p>collect: <code>init=/usr/bin/e4rat-lite-collect</code> - also default limit 120 seconds, you can also end the collection session using:
</p>
<pre># e4rat-lite-collect -k
</pre>
<p>realloc: <code> /usr/bin/e4rat-lite-realloc</code> - the switch to runlevel 1 is recommended, if you use <a href="../en/Systemd.html" title="Systemd">systemd</a> run this beforehand:
</p>
<pre># systemctl isolate rescue.target
</pre>
<p>preload: <code>init=/usr/bin/e4rat-lite-preload</code>
</p>
<p>startup.log: <code> /var/lib/e4rat-lite/startup.log</code>
</p>
<p>configuration file: <code> /etc/e4rat-lite.conf</code> - if you use <a href="../en/Systemd.html" title="Systemd">systemd</a> change init_file property to:
</p>
<pre>init_file=/usr/lib/systemd/systemd
</pre>
<h2><span class="mw-headline" id="Bootchart">Bootchart</span></h2>
<p><a href="../en/Bootchart.html" title="Bootchart">Bootchart</a> can be used to generate graphs of the system startup. This is useful to get visual representations of the CPU and Disk usages.
While not required, a before and after comparison of the boot process can be obtained using Bootchart.
</p>
<h3><span class="mw-headline" id="bootchart_2">bootchart</span></h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The official bootchart package appears to be deprecated, as it no longer includes the bootchart-render command needed to generate the graph. It is recommended to use bootchart2 as an alternative.</div>
<p>This version of <a href="../en/Bootchart.html" title="Bootchart">bootchart</a> automatically stops logging as soon as a <a href="../en/Display_manager.html" title="Display manager">display manager</a> comes up. The following overrides that and continues logging:
</p>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Inaccurate.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>The factual accuracy of this article or section is disputed.</b></p>
<div>
<b>Reason:</b> It has been reported that the following line does not work. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:E4rat.html">Talk:E4rat</a>)</div>
</div>
<p>To continue logging adjust your <code>/etc/bootchartd.conf</code> as follows:
</p>
<pre>AUTO_STOP_LOGGER="no"
</pre>
<p>To stop it manually type:
</p>
<pre># bootchartd stop
</pre>
<p>To run both e4rat-preload and bootchart append the following to your grub kernel line:
</p>
<pre>init=/sbin/bootchartd bootchart_init=/sbin/e4rat-preload
</pre>
<h3><span class="mw-headline" id="bootchart2">bootchart2</span></h3>
<p>To get <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/bootchart2/">bootchart2</a></span><sup><small>AUR</small></sup> working together with e4rat edit <code>/sbin/bootchartd2</code> and replace the line where it says 
</p>
<pre>init="/sbin/init"
</pre>
<p>with
</p>
<pre>init="/sbin/e4rat-preload"
</pre>
<p>This will allow you to measure your boot time with the information that Bootchart2 provides.
</p>
<p>It is easy to set up when to stop bootchart2 (contrary to bootchart) by editing its configuration file <code>/etc/bootchartd2.conf</code>. The line
</p>
<pre>EXIT_PROC="kdm_greet xterm konsole gnome-terminal metacity mutter compiz ldm icewm-session enlightenment"
</pre>
<p>can be configured to stop Bootchart2 logging when the specified application launches. Alternatively it may be left empty for the logging to be stopped manually.
</p>
<p>To generate the chart, run the command: <code>pybootchartgui -i</code>
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<p>If things do not work you may want to try the following.
</p>
<h3><span class="mw-headline" id="startup.log_is_not_created">startup.log is not created</span></h3>
<ul>
<li>Disable auditd service</li>
<li>Check the following for any hints</li>
</ul>
<pre># dmesg | grep e4rat
</pre>
<ul>
<li>Try to increase verbosity and loglevel to 31 in your <code>e4rat.conf</code>
</li>
<li>Try using e4rat-lite instead of e4rat</li>
</ul>
<h3><span class="mw-headline" id="e4rat_erroneously_reports_an_ext2_files_system">e4rat erroneously reports an ext2 files system</span></h3>
<p>Add <code>rootfstype=ext4</code> to <a href="../en/Kernel_parameters.html" title="Kernel parameters">kernel parameters</a> from your bootloader.
</p>
<h3>
<span id=".2Fvar.2Flib.2Fe4rat.2Fstartup.log_is_not_accessible"></span><span class="mw-headline" id="/var/lib/e4rat/startup.log_is_not_accessible">/var/lib/e4rat/startup.log is not accessible</span>
</h3>
<p>This suggests that you have <code>/var</code> on a separate partition which is not yet mounted during boot. You need move your <code>startup.log</code> to an accessible partition (<code>/etc/e4rat/</code> is just fine) and adjust your <code>/etc/e4rat.conf</code> to reflect this change:
</p>
<pre>startup_log_file /etc/e4rat/startup.log
</pre>
<h3><span class="mw-headline" id="Remove_annoying_message_that_mess_up_boot_message">Remove annoying message that mess up boot message</span></h3>
<p>If you are annoyed by the e4rat-preload message during boot, decrease verbose to 1 in <code>/etc/e4rat.conf</code>
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=115976">Main discussion on the forum</a></li>
<li><a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=117776">Improved e4rat-preload - forum thread</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Boot_process.html" title="Category:Boot process">Boot process</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=E4rat&amp;oldid=796009">https://wiki.archlinux.org/index.php?title=E4rat&amp;oldid=796009</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 4 January 2024, at 11:40.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
