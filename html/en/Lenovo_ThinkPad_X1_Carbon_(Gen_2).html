<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Lenovo ThinkPad X1 Carbon (Gen 2) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Lenovo_ThinkPad_X1_Carbon_Gen_2 rootpage-Lenovo_ThinkPad_X1_Carbon_Gen_2 skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Power_management" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Power_management">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Power management</div>
		</a>
		
			<button aria-controls="toc-Power_management-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Power management subsection</span>
			</button>
		
		<ul id="toc-Power_management-sublist" class="vector-toc-list">
			<li id="toc-Wake_from_suspend" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Wake_from_suspend">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1</span>Wake from suspend</div>
			</a>
			
			<ul id="toc-Wake_from_suspend-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Keyboard" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Keyboard">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Keyboard</div>
		</a>
		
			<button aria-controls="toc-Keyboard-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Keyboard subsection</span>
			</button>
		
		<ul id="toc-Keyboard-sublist" class="vector-toc-list">
			<li id="toc-Automatically_turn_on_keyboard_backlight_when_typing" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Automatically_turn_on_keyboard_backlight_when_typing">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Automatically turn on keyboard backlight when typing</div>
			</a>
			
			<ul id="toc-Automatically_turn_on_keyboard_backlight_when_typing-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Trackpad" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Trackpad">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Trackpad</div>
		</a>
		
			<button aria-controls="toc-Trackpad-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Trackpad subsection</span>
			</button>
		
		<ul id="toc-Trackpad-sublist" class="vector-toc-list">
			<li id="toc-Lock-ups_on_click" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Lock-ups_on_click">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>Lock-ups on click</div>
			</a>
			
			<ul id="toc-Lock-ups_on_click-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Tweaking_trackpad_behavior" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Tweaking_trackpad_behavior">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>Tweaking trackpad behavior</div>
			</a>
			
			<ul id="toc-Tweaking_trackpad_behavior-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Touchpad_not_working_after_wake_up_from_sleep" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Touchpad_not_working_after_wake_up_from_sleep">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3</span>Touchpad not working after wake up from sleep</div>
			</a>
			
			<ul id="toc-Touchpad_not_working_after_wake_up_from_sleep-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Audio" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Audio">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Audio</div>
		</a>
		
			<button aria-controls="toc-Audio-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Audio subsection</span>
			</button>
		
		<ul id="toc-Audio-sublist" class="vector-toc-list">
			<li id="toc-ALSA-Preamplifier" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#ALSA-Preamplifier">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>ALSA-Preamplifier</div>
			</a>
			
			<ul id="toc-ALSA-Preamplifier-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Processor" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Processor">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Processor</div>
		</a>
		
		<ul id="toc-Processor-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-BIOS_update" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#BIOS_update">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>BIOS update</div>
		</a>
		
		<ul id="toc-BIOS_update-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Network" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Network">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">7</span>Network</div>
		</a>
		
			<button aria-controls="toc-Network-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Network subsection</span>
			</button>
		
		<ul id="toc-Network-sublist" class="vector-toc-list">
			<li id="toc-Wired" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Wired">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">7.1</span>Wired</div>
			</a>
			
			<ul id="toc-Wired-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Wireless" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Wireless">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">7.2</span>Wireless</div>
			</a>
			
			<ul id="toc-Wireless-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Display" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Display">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">8</span>Display</div>
		</a>
		
			<button aria-controls="toc-Display-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Display subsection</span>
			</button>
		
		<ul id="toc-Display-sublist" class="vector-toc-list">
			<li id="toc-Touchscreen" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Touchscreen">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">8.1</span>Touchscreen</div>
			</a>
			
			<ul id="toc-Touchscreen-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-HiDPI" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#HiDPI">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">8.2</span>HiDPI</div>
			</a>
			
			<ul id="toc-HiDPI-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">9</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Lenovo ThinkPad X1 Carbon (Gen 2)</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 1 language">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-1" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">1 language</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Lenovo_ThinkPad_X1_Carbon_(Gen_2)" title="Lenovo ThinkPad X1 Carbon (Gen 2) – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-edit-clear.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section does not follow the <a href="../en/Help:Laptop_page_guidelines.html" title="Help:Laptop page guidelines">Laptop page guidelines</a>.</b></p>
<div>
<b>Reason:</b> Needs an accessibility and function keys sections. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Lenovo_ThinkPad_X1_Carbon_(Gen_2).html">Talk:Lenovo ThinkPad X1 Carbon (Gen 2)</a>)</div>
</div>
<table class="wikitable" style="float: right;">

<tbody>
<tr>
<th>Hardware</th>
<th>PCI/USB ID</th>
<th>Working?
</th>
</tr>
<tr>
<td>GPU</td>
<td><code>8086:0a16</code></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td>Audio</td>
<td><code>8086:9c20</code></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td>Wi-Fi</td>
<td><code>8086:08b2</code></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td>Ethernet</td>
<td><code>8086:155a</code></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td>WWAN</td>
<td rowspan="2"><code>1199:a001</code></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td>GPS</td>
<td data-sort-value="3" style="background: #ffa; color: inherit; vertical-align: middle; text-align: center;">Untested
</td>
</tr>
<tr>
<td>Bluetooth</td>
<td><code>8087:07dc</code></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td>Webcam</td>
<td><code>04ca:7036</code></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td>Fingerprint reader</td>
<td><code>138a:0017</code></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td>Trackpad</td>
<td></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td>Touchscreen</td>
<td></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
</tbody>
</table>
<p>Almost everything works out of the box. Most of the hardware is based on the Intel Lynx Point reference design.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Power_management">Power management</span></h2>
<p>The <a href="../en/Kernel_module.html" title="Kernel module">kernel module</a> <code>thinkpad_acpi</code> picks up most of the sensors. The kernel module <code>tp_smapi</code> is not currently supported. PCIe ASPM does not currently work.
</p>
<p><a href="../en/Udev.html" title="Udev">Udev</a> does not not notify whenever battery discharges by 1%, but it does notify at 80%, 20%, 5%, 4% and 0%.  To take advantage of this, see (Suspend On Low Battery <a href="../en/Laptop.html#Hibernate_on_low_battery_level" title="Laptop">Laptop#Hibernate on low battery level</a>)
</p>
<h3><span class="mw-headline" id="Wake_from_suspend">Wake from suspend</span></h3>
<p>Wake from suspend can be buggy with earlier versions of the bios, see:
<a rel="nofollow" class="external autonumber" href="https://marc.info/?l=linux-thinkpad&amp;m=139403589015682&amp;w=2">[1]</a>
</p>
<p>This can be solved by flashing the bios to a version &gt;=1.13. Look here for Lenovo's bios versions:
<a rel="nofollow" class="external autonumber" href="https://support.lenovo.com/en_GB/downloads/detail.page?DocID=DS039783">[2]</a>
</p>
<p>A guide how to make a bootable BIOS key drive can be found here:
<a rel="nofollow" class="external autonumber" href="http://positon.org/lenovo-thinkpad-bios-update-with-linux-and-usb">[3]</a>
</p>
<p>And some fairly old help from Lenovo here:
<a rel="nofollow" class="external autonumber" href="https://www.thinkwiki.org/wiki/BIOS_Upgrade#Using_grub4dos_.28also_for_Linux.29">[4]</a>
</p>
<p>If the function keys fail to wake after suspend, ensure you have a kernel version &gt;=3.15.
</p>
<p>If you build your own kernels, make sure to either enable <a href="../en/Trusted_Platform_Module.html" class="mw-redirect" title="TPM">TPM</a> (Trusted Platform Module) drivers or disable the Security Chip in the BIOS.
</p>
<h2><span class="mw-headline" id="Keyboard">Keyboard</span></h2>
<p>On kernel 3.14 and lower the adaptive panel at the top of the keyboard is locked to function mode.
</p>
<p>From kernel 3.15, Home mode is also available which allows access to screen brightness and other controls.
</p>
<p>If you wish to remap keys to get back to a sane keyboard layout, you can use either <a href="../en/Xmodmap.html" title="Xmodmap">xmodmap</a> or other <a href="../en/Input_remap_utilities.html" title="Input remap utilities">input remap utilities</a>.
</p>
<h3><span class="mw-headline" id="Automatically_turn_on_keyboard_backlight_when_typing">Automatically turn on keyboard backlight when typing</span></h3>
<p>The keyboard backlight works out of the box and there is a button on the soft keyboard to toggle it between off, low, and high brightness. Using a C program that continuously checks for keyboard input, it is possible to only activate the backlight for a certain time.
</p>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:View-refresh-red.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section is out of date.</b></p>
<div>
<b>Reason:</b> See <a href="../Special:Diff/764472/764600.html" title="Special:Diff/764472/764600">Special:Diff/764472/764600</a>. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Lenovo_ThinkPad_X1_Carbon_(Gen_2).html">Talk:Lenovo ThinkPad X1 Carbon (Gen 2)</a>)</div>
</div>
<p>The program source is as a follows
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">kbdbacklight.c</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/* Original Author: Howard Chu &lt;hyc@symas.com&gt; 2013-01-15
 *
 * compile as "gcc -O2 -o kbdbacklight kbdbacklight.c" and run it in the background, or arrange to have it run at bootup.
 *
 * adapted by gabtub@gmail.com 2017-01-22
 * using https://gist.github.com/hadess/6847281
 * based on http://askubuntu.com/questions/383501/enable-the-keyboard-backlights-on-supported-lenovo-e-g-carbon-x1-with-command
 * original code found at  http://forum.notebookreview.com/threads/asus-keyboard-backlight-controller.703985/
 * sigterm catching done as shown in https://airtower.wordpress.com/2010/06/16/catch-sigterm-exit-gracefully/
 *
 * fixed by sva 2022-10-08
 * refactored the whole code out of boredom. keyboard should now be detected automatically using libudev.h 2023-06-25
 * uses /sys/class/leds/, s.t. ec_sys is not necessary
 *
 * monitor keyboard activity and toggle keyboard backlight
 */
#include &lt;stdio.h&gt; // fprintf(), snprintf(), stderr
#include &lt;unistd.h&gt; // write(), close(), read()
#include &lt;string.h&gt; // strlen(), strncpy()
#include &lt;fcntl.h&gt; // open(), O_RDONLY, O_WRONLY
#include &lt;limits.h&gt; // PATH_MAX
#include &lt;poll.h&gt; // poll()

#include &lt;linux/input.h&gt; // struct input_event, EV_KEY
#include &lt;libudev.h&gt; // udev stuff

#define IDLE_MSEC 1000
#define BRGHT_OFF 0
#define BRGHT_MED 128
#define BRGHT_HI 255

static volatile int running = 1;

static int find_keyboard(char* devnode, size_t size) {
  struct udev* udev = udev_new();
  if (!udev) {
    fprintf(stderr, "Failed to create udev context\n");
    return -1;
  }

  struct udev_enumerate* enumerate = udev_enumerate_new(udev);
  if (!enumerate) {
    fprintf(stderr, "Failed to create udev enumerate\n");
    udev_unref(udev);
    return -1;
  }

  udev_enumerate_add_match_subsystem(enumerate, "input");
  udev_enumerate_add_match_property(enumerate, "ID_INPUT_KEYBOARD", "1");
  udev_enumerate_scan_devices(enumerate);

  struct udev_list_entry* devices = udev_enumerate_get_list_entry(enumerate);
  struct udev_list_entry* entry;
  int found = 0;

  udev_list_entry_foreach(entry, devices) {
    const char* path = udev_list_entry_get_name(entry);
    struct udev_device* dev = udev_device_new_from_syspath(udev, path);
    if (!dev) {
      fprintf(stderr, "Failed to create udev device\n");
      continue;
    }

    const char* devnode_path = udev_device_get_devnode(dev);
    if (devnode_path) {
      if (strlen(devnode_path) &lt; size) {
        strncpy(devnode, devnode_path, size);
        found = 1;
        break;
      } else {
        fprintf(stderr, "Device node path is too long\n");
      }
    }

    udev_device_unref(dev);
  }

  udev_enumerate_unref(enumerate);
  udev_unref(udev);

  return found ? 0 : -1;
}

static int set_backlight(int brightness) {
  char buf[16];
  snprintf(buf, sizeof(buf), "%d", brightness);
  int fd = open("/sys/class/leds/tpacpi::kbd_backlight/brightness", O_WRONLY);
  if (fd &lt; 0) {
    fprintf(stderr, "Failed to open keyboard backlight file\n");
    return -1;
  }
  if (write(fd, buf, strlen(buf)) != strlen(buf)) {
    fprintf(stderr, "Failed to set keyboard backlight\n");
    close(fd);
    return -1;
  }
  close(fd);
  return 0;
}

static void handle_input(int fd, int* brightness) {
  struct input_event ev;
  int rc = read(fd, &amp;ev, sizeof(ev));
  if (rc &gt; 0) {
    if (ev.type == EV_KEY &amp;&amp; ev.value == 1) {
      set_backlight(BRGHT_HI);
      *brightness = BRGHT_HI;
    }
  }
}

static void handle_timeout(int fd, int* brightness) {
  set_backlight(BRGHT_OFF);
  *brightness = BRGHT_OFF;
}

static void handle_poll(int fd, int* brightness) {
  struct pollfd pfd;
  pfd.fd = fd;
  pfd.events = POLLIN;
  int timeout = IDLE_MSEC;
  while (running) {
    int rc = poll(&amp;pfd, 1, timeout);
    if (rc &gt; 0) {
      handle_input(fd, brightness);
      timeout = IDLE_MSEC;
    } else if (rc == 0) {
      handle_timeout(fd, brightness);
      timeout = -1;
    }
  }
}

int main(int argc, char** argv) {
  char devnode[PATH_MAX];
  if (find_keyboard(devnode, sizeof(devnode)) &lt; 0) {
    fprintf(stderr, "Failed to find keyboard device\n");
    return 1;
  }

  int fd = open(devnode, O_RDONLY);
  if (fd &lt; 0) {
    fprintf(stderr, "Failed to open keyboard device\n");
    return 1;
  }

  int brightness = BRGHT_OFF;
  set_backlight(brightness);
  handle_poll(fd, &amp;brightness);
  close(fd);
  return 0;
}
</pre>
<p>This file can be compiled with:
</p>
<pre>$ gcc -O2 -o kbdbacklight kbdbacklight.c -ludev
</pre>
<p>and must be executed as root. 
</p>
<p>It would be possible to autostart this by creating a systemd service as follows:
</p>
<ul>
<li>Create a folder /usr/local/customscripts/kbdbacklight/</li>
<li>Save the compiled c program to /usr/local/customscripts/kbdbacklight/kbdbacklight</li>
<li>Create the following bash script in the same folder:</li>
</ul>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/local/customscripts/kbdbacklight/kbdbacklight.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash
# must be executed as root
./kbdbacklight &amp;
RETVAL=$?
PID=$!
[ $RETVAL -eq 0 ] &amp;&amp; echo $PID &gt; /usr/local/customscripts/kbdbacklight/pid
</pre>
<ul><li>Create the following systemd service and place it in /etc/systemd/system/kbdbacklight.service</li></ul>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/kbdbacklight.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=starts a daemon monitoring keyboard usage. will turn on keyboard backlight until no key is pressed for a TIMEOUT period
Requires=
After=

[Service]
Type=forking
User=root
WorkingDirectory=/usr/local/customscripts/kbdbacklight/
ExecStart=/usr/local/customscripts/kbdbacklight/kbdbacklight.sh &amp;
PIDFile=/usr/local/customscripts/kbdbacklight/pid

[Install]
WantedBy=multi-user.target
</pre>
<ul><li>
<a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start/enable">start/enable</a> <code>kbdbacklight.service</code>
</li></ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Specify the amount timeout for turning the backlight off again by adjusting the constant IDLE_MSEC in the C program (and recompiling it again).</div>
<h2><span class="mw-headline" id="Trackpad">Trackpad</span></h2>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Inaccurate.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>The factual accuracy of this article or section is disputed.</b></p>
<div>
<b>Reason:</b> When both <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xf86-input-synaptics">xf86-input-synaptics</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xf86-input-libinput">xf86-input-libinput</a></span> are installed, the trackpoint (red thingy) uses libinput by default, so it does not cooperate with the trackpad (which by default is driven by synaptics), and as a result you cannot scroll with middle button + trackpoint. Keeping only <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xf86-input-libinput">xf86-input-libinput</a></span> gets everything working. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Lenovo_ThinkPad_X1_Carbon_(Gen_2).html">Talk:Lenovo ThinkPad X1 Carbon (Gen 2)</a>)</div>
</div>
<p>To enable Trackpad support you need to install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xf86-input-synaptics">xf86-input-synaptics</a></span>.
</p>
<h3><span class="mw-headline" id="Lock-ups_on_click">Lock-ups on click</span></h3>
<p>There are significant issues with the trackpad locking up on click. This is due to the trackpad operating in buggy PS/2 mode.
</p>
<p>One alternative is to abandon the trackpad completely and use the trackpoint.  Make sure xf86-input-synaptics is not installed - the trackpad will still register button one mouse clicks.  Using xbindkeys <a href="../en/Xbindkeys.html" title="Xbindkeys">Xbindkeys</a> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xdotool">xdotool</a></span>, right button clicks can be mapped to some other event.  For example:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.xbindkeysrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># Emit a right click on Alt + trackpad click
"xdotool click 3"
  Mod1 + b:1 + Release
</pre>
<h3><span class="mw-headline" id="Tweaking_trackpad_behavior">Tweaking trackpad behavior</span></h3>
<p>The behavior of the trackpad by default can be contrary to your expectations, particularly if you are coming from an OS X style trackpad. The following settings can help significantly:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xorg.conf.d/99-x1carbon.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># Copy this to /etc/X11/xorg.conf.d/99-x1carbon.conf
 Section "InputClass"
     Identifier "X1 carbon stuff"
     MatchIsTouchpad "on"
     MatchDevicePath "/dev/input/event*"
     Driver "synaptics"

     # Enable two finger scrolling vertically, disable horizontally
     Option "VertTwoFingerScroll" "1"
     Option "HorizTwoFingerScroll" "0"

     # No scrolling along the edge
     Option "VertEdgeScroll" "0"
     Option "HorizEdgeScroll" "0"

     Option "LockedDrags" "0"
     Option "FingerPress" "1"

     # Turn off the blasted corners as buttons
     Option "RTCornerButton" "0"
     Option "RBCornerButton" "0"
     Option "LTCornerButton" "0"
     Option "LBCornerButton" "0"

     # Ignore "taps" and listen for "clicks"
     Option "TapButton1" "0"
     Option "TapButton2" "0"
     Option "TapButton3" "0"
     Option "ClickFinger1" "1" # Left click one finger
     Option "ClickFinger2" "3" # Right click two fingers
     Option "ClickFinger3" "0" # Three finger click disabled

     Option "TapAndDragGesture" "0"

     # No circular scrolling
     Option "CircularScrolling" "0"
 EndSection
</pre>
<p>If you are using gnome-shell, you may need to tell the settings app not to overwrite our changes:
</p>
<pre>$ gsettings set org.gnome.settings-daemon.plugins.mouse active false
</pre>
<h3><span class="mw-headline" id="Touchpad_not_working_after_wake_up_from_sleep">Touchpad not working after wake up from sleep</span></h3>
<p>See <a href="../en/Touchpad_Synaptics.html#Touchpad_does_not_work_after_resuming_from_hibernate/suspend" title="Touchpad Synaptics">Touchpad Synaptics#Touchpad does not work after resuming from hibernate/suspend</a>.
</p>
<h2><span class="mw-headline" id="Audio">Audio</span></h2>
<p>You may need to add a default sound card options to its <a href="../en/Kernel_module.html#Setting_module_options" class="mw-redirect" title="Kernel module parameter">kernel module parameter</a>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/alsa-base.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">options snd_hda_intel index=1</pre>
<h3><span class="mw-headline" id="ALSA-Preamplifier">ALSA-Preamplifier</span></h3>
<p>It is a common problem on laptops running linux that the sound, even on maximum, is not loud enough. This can be fixed by adding an ALSA preamplifier.
</p>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=alsa-utils">alsa-utils</a></span>.
</p>
<p>Change the config in /etc/asound.conf to the following ( you might have to adjust the cardnumber):
</p>
<pre># Set your DEFAULT device to the softvol plug-in
# NOT to a hardware card device
#
# The "!" means completely override the previous default
# Not just changing/adding to it.
pcm.!default {
  type plug
  slave.pcm "softvol"
}

# Configure softvol
pcm.softvol {
  type softvol

  # Send softvol's output to dmix
  slave {
    pcm "dmix"
    # If you wanted to you could send the output to a card directly
    # But in most cases it's better to send it to dmix and let
    # dmix handle where to send it. You can add a whole extra section
    # to configure dmix and where it sends output, but I'm
    # not covering that here.

    ## Use Card 0 Device 0 instead of dmix
    # pcm "hw:0,0"
    ## Use Card 2 Device 0 instead of dmix
    # pcm "hw:2,0"
  }

  # Add a control slider in your mixer interfaces
  # i.e. KMix and alsamixer
  control {
    name "Pre-Amp"
    card 0 #&lt;CardNumberYouWantControlToShowOn&gt; i.e. card 0 or card 2
  }

  # Minimum dB when slider is at 0%
  min_dB -5.0

  # Maximum DB when slider is at 100%
  max_dB 40.0

  # How many levels the slider should go through
  # i.e. how granular do you want your control to be
  resolution 12
}

</pre>
<p>Taken from <a rel="nofollow" class="external text" href="https://web.archive.org/web/20160316004932/http://blog.tpa.me.uk/2013/10/23/alsa-pre-amp-volume-boost-the-simple-explanation/">here</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> It is possible to permanently damage your loudspeakers if you turn it up too much!</div>
<h2><span class="mw-headline" id="Processor">Processor</span></h2>
<p>See <a href="../en/Microcode.html" title="Microcode">Microcode</a> how to update to processor's microcode.
</p>
<h2><span class="mw-headline" id="BIOS_update">BIOS update</span></h2>
<p>To install a BIOS update from linux, download the bootable iso <a rel="nofollow" class="external text" href="https://pcsupport.lenovo.com/fi/en/products/LAPTOPS-AND-NETBOOKS/THINKPAD-X-SERIES-LAPTOPS/THINKPAD-X1-CARBON-TYPE-20A7-20A8/downloads/DS039783">from here</a>
</p>
<p>Since there is no CD drive, <a rel="nofollow" class="external text" href="https://thinkwiki.de/BIOS-Update_ohne_optisches_Laufwerk_unter_Linux#El_Torito_Image_auf_USB-Stick_.28nur_UEFI.29">this method</a> can be used (German).
</p>
<h2><span class="mw-headline" id="Network">Network</span></h2>
<h3><span class="mw-headline" id="Wired">Wired</span></h3>
<p>There is a small port on the right side for Ethernet. An adapter is required. In case of loss of the adapter, the part number for ordering is 04X6435.
</p>
<h3><span class="mw-headline" id="Wireless">Wireless</span></h3>
<p>Works out of the box. The module <code>iwlwifi</code> should be automatically loaded by <a href="../en/Udev.html" title="Udev">udev</a>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ lspci</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Network controller: Intel Corporation Wireless 7260 (rev 83)
</pre>
<h2><span class="mw-headline" id="Display">Display</span></h2>
<h3><span class="mw-headline" id="Touchscreen">Touchscreen</span></h3>
<p>Works out of the box as single touch. The hardware is multi-touch, but current stable drivers only support left-click mouse emulation. Seems to work with <a href="../en/Touchegg.html" title="Touchegg">Touchegg</a>.
</p>
<h3><span class="mw-headline" id="HiDPI">HiDPI</span></h3>
<p>Since the display has such a high pixel density, you might encounter problems. See here: <a href="../en/HiDPI.html" title="HiDPI">HiDPI</a>
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li><a rel="nofollow" class="external text" href="https://www.thinkwiki.org/wiki/ThinkWiki">ThinkWiki</a></li></ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Lenovo.html" title="Category:Lenovo">Lenovo</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Laptop_style.html" title="Category:Pages or sections flagged with Template:Laptop style">Pages or sections flagged with Template:Laptop style</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Lenovo_ThinkPad_X1_Carbon_(Gen_2)&amp;oldid=812417">https://wiki.archlinux.org/index.php?title=Lenovo_ThinkPad_X1_Carbon_(Gen_2)&amp;oldid=812417</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 14 July 2024, at 05:59.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
