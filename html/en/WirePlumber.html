<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>WirePlumber - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-WirePlumber rootpage-WirePlumber skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Installation</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Configuration</div>
		</a>
		
			<button aria-controls="toc-Configuration-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configuration subsection</span>
			</button>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
			<li id="toc-Configuration_file_layout" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configuration_file_layout">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Configuration file layout</div>
			</a>
			
			<ul id="toc-Configuration_file_layout-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Modifying_the_configuration" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Modifying_the_configuration">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>Modifying the configuration</div>
			</a>
			
			<ul id="toc-Modifying_the_configuration-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Obtain_interface_name_for_rules_matching" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Obtain_interface_name_for_rules_matching">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3</span>Obtain interface name for rules matching</div>
			</a>
			
			<ul id="toc-Obtain_interface_name_for_rules_matching-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Changing_a_device/node_property" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Changing_a_device/node_property">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4</span>Changing a device/node property</div>
			</a>
			
			<ul id="toc-Changing_a_device/node_property-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Disable_a_device/node" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Disable_a_device/node">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.5</span>Disable a device/node</div>
			</a>
			
			<ul id="toc-Disable_a_device/node-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Simultaneous_output_to_multiple_sinks_on_the_same_sound_card" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Simultaneous_output_to_multiple_sinks_on_the_same_sound_card">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.6</span>Simultaneous output to multiple sinks on the same sound card</div>
			</a>
			
			<ul id="toc-Simultaneous_output_to_multiple_sinks_on_the_same_sound_card-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Simultaneous_output_to_transient_devices" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Simultaneous_output_to_transient_devices">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.7</span>Simultaneous output to transient devices</div>
			</a>
			
			<ul id="toc-Simultaneous_output_to_transient_devices-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Tips_and_tricks" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Tips_and_tricks">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Tips and tricks</div>
		</a>
		
			<button aria-controls="toc-Tips_and_tricks-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Tips and tricks subsection</span>
			</button>
		
		<ul id="toc-Tips_and_tricks-sublist" class="vector-toc-list">
			<li id="toc-Keyboard_volume_control" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Keyboard_volume_control">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>Keyboard volume control</div>
			</a>
			
			<ul id="toc-Keyboard_volume_control-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Show_volume_level" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Show_volume_level">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>Show volume level</div>
			</a>
			
			<ul id="toc-Show_volume_level-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Keep_Bluetooth_running_after_logout_/_Headless_Bluetooth" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Keep_Bluetooth_running_after_logout_/_Headless_Bluetooth">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3</span>Keep Bluetooth running after logout / Headless Bluetooth</div>
			</a>
			
			<ul id="toc-Keep_Bluetooth_running_after_logout_/_Headless_Bluetooth-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Troubleshooting">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Troubleshooting</div>
		</a>
		
		<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">WirePlumber</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 2 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-2" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">2 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/WirePlumber" title="WirePlumber – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-ru mw-list-item"><a href="../ru/WirePlumber.html" title="WirePlumber – русский" lang="ru" hreflang="ru" class="interlanguage-link-target"><span>Русский</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/PipeWire.html" title="PipeWire">PipeWire</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://pipewire.pages.freedesktop.org/wireplumber">WirePlumber</a> is a powerful session and policy manager for <a href="../en/PipeWire.html" title="PipeWire">PipeWire</a>. Based on a modular design, with Lua plugins that implement the actual management functionality, it is highly configurable and extendable.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=wireplumber">wireplumber</a></span> package. Any conflicting PipeWire Session Managers will be uninstalled.
</p>
<p>WirePlumber uses systemd <a href="../en/Systemd/User.html" class="mw-redirect" title="User unit">user units</a> to manage the server.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:View-refresh-red.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section is out of date.</b></p>
<div>
<b>Reason:</b> WirePlumber's configuration format is changing.<a rel="nofollow" class="external autonumber" href="https://www.collabora.com/news-and-blog/blog/2022/10/27/from-lua-to-json-refactoring-wireplumber-configuration-system/">[1]</a> (Discuss in <a href="../en/ArchWiki_talk:Requests.html#Update_for_new_WirePlumber_configuration_format" title="ArchWiki talk:Requests">ArchWiki talk:Requests#Update for new WirePlumber configuration format</a>)</div>
</div>
<h3><span class="mw-headline" id="Configuration_file_layout">Configuration file layout</span></h3>
<p><a rel="nofollow" class="external text" href="https://pipewire.pages.freedesktop.org/wireplumber/daemon/configuration.html">WirePlumber's configuration</a> comprises global PipeWire-flavored JSON objects such as <code>context</code> and <code>alsa_monitor</code> that are modified to change its behavior. The configuration files are read from <code>~/.config/wireplumber/</code> (user configuration), <code>/etc/wireplumber/</code> (global configuration), and then <code>/usr/share/wireplumber/</code> (stock configuration).
</p>
<p>WirePlumber starts by reading the <a rel="nofollow" class="external text" href="https://pipewire.pages.freedesktop.org/wireplumber/daemon/configuration/conf_file.html">main configuration file</a>. This is a JSON-like file that sets up the PipeWire context, <a rel="nofollow" class="external text" href="https://docs.pipewire.org/page_spa_plugins.html">SPA plugins</a>, modules, and components. Among these components is the <a href="https://en.wikipedia.org/wiki/Lua_(programming_language)" class="extiw" title="wikipedia:Lua (programming language)">Lua</a> scripting engine, which is used to dynamically modify the global objects.
</p>
<p>There are different main configuration files that ship with the package:
</p>
<ul>
<li>The single-instance configuration file, at <code>/usr/share/wireplumber/wireplumber.conf</code>. This is the default configuration, which includes the functionality of all the other configurations within one process.
<ul><li>See the <a rel="nofollow" class="external text" href="https://pipewire.pages.freedesktop.org/wireplumber/daemon/configuration/main.html">documentation for the "context" object</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2024-07-30 ⓘ]</sup> used in all of the main configuration files.</li></ul>
</li>
<li>The main configuration file, at <code>/usr/share/wireplumber/main.conf</code>. This loads the modules and components necessary for the WirePlumber core, and loads <a rel="nofollow" class="external text" href="https://pipewire.pages.freedesktop.org/wireplumber/configuration/config_lua.html">Lua configuration files</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2024-01-13 ⓘ]</sup> from <code><i>config-dir</i>/main.lua.d/</code>. <a rel="nofollow" class="external autonumber" href="https://pipewire.pages.freedesktop.org/wireplumber/configuration/config_lua.html">[2]</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2024-01-13 ⓘ]</sup>
<ul><li>See the documentation for the <a rel="nofollow" class="external text" href="https://pipewire.pages.freedesktop.org/wireplumber/daemon/configuration/alsa.html">ALSA objects</a> and <a rel="nofollow" class="external text" href="https://pipewire.pages.freedesktop.org/wireplumber/daemon/configuration/access.html">"access" objects</a>.</li></ul>
</li>
<li>The <a href="../en/Bluetooth.html" title="Bluetooth">Bluetooth</a> configuration file, at <code>/usr/share/wireplumber/bluetooth.conf</code>. This is suitable for a WirePlumber process that is handling Bluetooth connectivity for the core process. This loads Lua files from <code><i>config-dir</i>/bluetooth.lua.d/</code>.
<ul><li>See the <a rel="nofollow" class="external text" href="https://pipewire.pages.freedesktop.org/wireplumber/daemon/configuration/bluetooth.html">documentation for the Bluetooth object</a>.</li></ul>
</li>
<li>The <i>policy</i> configuration file, at <code>/usr/share/wireplumber/policy.conf</code>. This encapsulates policy functionality, which is how WirePlumber makes decisions about moving and making changes to nodes. This loads Lua files from <code><i>config-dir</i>/policy.lua.d/</code>
<ul><li>See the <a rel="nofollow" class="external text" href="https://pipewire.pages.freedesktop.org/wireplumber/daemon/configuration/policy.html">documentation for the policy-related objects</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2024-07-30 ⓘ]</sup>.</li></ul>
</li>
</ul>
<p>The Lua configuration files in the <code>lua.d/</code> directories also load Lua scripts from <code><i>config-dir</i>/scripts/</code>. These scripts implement some of the logic/functionality of Pipewire, and could also be worth modifying under certain circumstances.
</p>
<h3><span class="mw-headline" id="Modifying_the_configuration">Modifying the configuration</span></h3>
<p>The recommended way to configure WirePlumber is to add a <a rel="nofollow" class="external text" href="https://pipewire.pages.freedesktop.org/wireplumber/daemon/configuration/conf_file.html#the-spa-json-format">SPA-JSON</a> file to the appropriate <code>wireplumber.conf.d/</code> directory within <code>/etc/wireplumber/</code> or <code>~/.config/wireplumber/</code>. Some things to consider are:
</p>
<ul>
<li>If there is an existing config you want to override, copy it from <code>/usr/share/wireplumber/</code> to the destination while keeping its name the same. Configuration files with the same name but in a lower priority location will be ignored. <a rel="nofollow" class="external autonumber" href="https://pipewire.pages.freedesktop.org/wireplumber/configuration/locations.html#location-of-configuration-files">[3]</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2024-01-13 ⓘ]</sup>
</li>
<li>Otherwise, if you are adding a new config, you should start it with a number bigger than 50 (e.g. <code>51-my-config.conf</code>), as the default configuration is mostly done at or below 50 in the alphanumeric ordering.
<ul><li>Note that WirePlumber performs <a rel="nofollow" class="external text" href="https://pipewire.pages.freedesktop.org/wireplumber/configuration/config_lua.html#multi-path-merging">multi-path merging</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2024-01-13 ⓘ]</sup>, meaning that a lower numbered stock config will run before your new script, as alphanumeric ordering takes precedence over directory priorities.</li></ul>
</li>
<li>The directory you choose should be consistent with what the stock configuration does, but it does not strictly matter unless you are <a rel="nofollow" class="external text" href="https://pipewire.pages.freedesktop.org/wireplumber/configuration/multi_instance.html">using multiple instances</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2024-01-13 ⓘ]</sup>.</li>
<li>ALSA properties for Bluetooth devices <i>must</i> be configured in <code>wireplumber.conf.d/</code>. A separate <code>bluetooth.lua.d/</code> directory is no longer required since version 0.5.</li>
</ul>
<h3><span class="mw-headline" id="Obtain_interface_name_for_rules_matching">Obtain interface name for rules matching</span></h3>
<p>In the Lua scripts, you need to specify <code>matches</code> rules with a property from an <a rel="nofollow" class="external text" href="https://docs.pipewire.org/page_objects_design.html">object</a> of the interface you want to configure.
</p>
<p>Use the command <code>wpctl status</code> to show all objects managed by WirePlumber. Find the <code><i>ID</i></code> assigned to the target interface. Then use command <code>wpctl inspect <i>ID</i></code> to get a needed property.
</p>
<p>Example, if you target interface is <code>HD Audio Controller Analog Stereo</code> and consider following output:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ wpctl status</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">PipeWire 'pipewire-0' [0.3.56, user@hostname, cookie:1163266174]

Audio
 ├─ Devices:
 │      42. HD Audio Controller                 [alsa]
 │     105. USB PnP Audio Device                [alsa]
 │
 ├─ Sinks:
 │  *   <b>48. HD Audio Controller Analog Stereo</b>   [vol: 0.50]
 │
 ├─ ...
 │
 ├─ Sources:
 │  *  101. USB PnP Audio Device Mono           [vol: 0.74]
 │
 └─ ...</pre>
<p>the interface <code><i>ID</i></code> is <code>48</code>.
</p>
<p>Then use inspect command to view object detail, listed all properties in that object:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ wpctl inspect 48</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">id 48, type PipeWire:Interface:Node
    ...
    device.api = "alsa"
    device.class = "sound"
  * device.id = "42"
    device.profile.description = "Analog Stereo"
    device.profile.name = "analog-stereo"
    ...
  * factory.id = "18"
    factory.mode = "merge"
    factory.name = "api.alsa.pcm.sink"
    ...
  * media.class = "Audio/Sink"
  * node.description = "HD Audio Controller Analog Stereo"
  * node.name = "alsa_output.pci-0000_08_00.4.analog-stereo"
  * node.nick = "ALC1220 Analog"
    ...
  * object.path = "alsa:pcm:1:front:1:playback"
  * object.serial = "49"
    ...</pre>
<p>Choose <code>device.name</code> or <code>node.name</code> property to use with the <code>matches</code> rules in the Lua configuration script.
</p>
<p>Avoid using <code>device.id</code>, it is dynamic and changes often.
</p>
<p>Multiple properties in <code>matches</code> rules is possible, see the <code>alsa_monitor.rules</code> section in <a rel="nofollow" class="external text" href="https://web.archive.org/web/20231226224659/https://pipewire.pages.freedesktop.org/wireplumber/configuration/alsa.html#modifying-the-default-configuration">documentation for the WirePlumber ALSA configuration</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>You can determine the <code>Endpoint</code> class of this object from the <code>media.class</code> property.</li>
<li>For ALSA, <code>node</code> objects are Sinks or Sources / <code>device</code> objects correspond to the card.</li>
<li>Since v0.4.9, ALSA nodes use the PCM name to populate <code>node.nick</code>, which is useful at least on HDA cards using UCM, where all outputs (analog, HDMI, etc.) are exposed as <code>Node</code> on a single profile.</li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 
<ul>
<li>The command <code>pw-top</code> shows the PipeWire <code>Device</code> and <code>Node</code> currently in use.</li>
<li>Similar inspection command from PipeWire is <code>pw-cli info <i>ID</i></code>.</li>
</ul>
</div>
<h3>
<span id="Changing_a_device.2Fnode_property"></span><span class="mw-headline" id="Changing_a_device/node_property">Changing a device/node property</span>
</h3>
<p>To change a device or node property, such as its description or nick, you must create a <a rel="nofollow" class="external text" href="https://pipewire.pages.freedesktop.org/wireplumber/daemon/configuration/conf_file.html#the-spa-json-format">SPA-JSON</a> file and add it into <code>/etc/wireplumber/</code> or <code>~/.config/wireplumber/</code> under the proper path and name.
</p>
<p>For instance, to change the description of an ALSA node, you would create a file such as:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/wireplumber/wireplumber.conf.d/51-device-rename.conf (or ~/.config/wireplumber/wireplumber.conf.d/51-device-rename.conf)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">monitor.alsa.rules = [
  {
    matches = [
      {
        node.name = "alsa_output.pci-0000_00_1f.3.output_analog-stereo"
      }
    ]
    actions = {
      update-props = {
        node.description = "Laptop"
      }
    }
  }
]</pre>
<p>If instead you wish to change something on a Bluetooth node or device, you could create a file such as:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/wireplumber/wireplumber.conf.d/52-bluez-rename.conf (or ~/.config/wireplumber/wireplumber.conf.d/52-bluez-rename.conf)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">monitor.bluez.rules = [
  {
    matches = [
      {
        node.name = "bluez_output.02_11_45_A0_B3_27.a2dp-sink"
      }
    ]
    actions = {
      update-props = {
        node.nick = "Headphones"
      }
    }
  }
]</pre>
<p>The properties that you can change as well as the matching rules to select devices or nodes are documented at <a rel="nofollow" class="external text" href="https://pipewire.pages.freedesktop.org/wireplumber/daemon/configuration/alsa.html">ALSA configuration</a> and <a rel="nofollow" class="external text" href="https://pipewire.pages.freedesktop.org/wireplumber/daemon/configuration/bluetooth.html">Bluetooth configuration</a>.
</p>
<h3>
<span id="Disable_a_device.2Fnode"></span><span class="mw-headline" id="Disable_a_device/node">Disable a device/node</span>
</h3>
<p>Since WirePlumber v0.4.7, users could now disable any devices or nodes by property <code>device.disabled</code> or <code>node.disabled</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/wireplumber/wireplumber.conf.d/51-alsa-disable.conf (or ~/.config/wireplumber/wireplumber.conf.d/51-alsa-disable.conf)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">monitor.alsa.rules = [
  {
    matches = [
      {
        device.name = "alsa_card.pci-0000_08_00.4"
      }
    ]
    actions = {
      update-props = {
         device.disabled = true
      }
    }
  }
]</pre>
<p>For the name of <code>alsa_card.*</code> in your system, see <a href="#Obtain_interface_name_for_rules_matching">#Obtain interface name for rules matching</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Common use-case, for example, is to disable NVIDIA's HDMI audio output.</div>
<h3><span class="mw-headline" id="Simultaneous_output_to_multiple_sinks_on_the_same_sound_card">Simultaneous output to multiple sinks on the same sound card</span></h3>
<p>Create a copy of <code>/usr/share/alsa-card-profile/mixer/profile-sets/default.conf</code> so that changes persist across updates. Here we define a profile joining the two default mappings for Analog and HDMI.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/share/alsa-card-profile/mixer/profile-sets/multiple.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[General]
auto-profiles = no

[Mapping analog-stereo]
device-strings = front:%f
channel-map = left,right
paths-output = analog-output analog-output-lineout analog-output-speaker analog-output-headphones analog-output-headphones-2
paths-input = analog-input-front-mic analog-input-rear-mic analog-input-internal-mic analog-input-dock-mic analog-input analog-input-mic analog-input-linein analog-input-aux analog-input-video analog-input-tvtuner analog-input-fm analog-input-mic-line analog-input-headphone-mic analog-input-headset-mic
priority = 15

[Mapping hdmi-stereo]
description = Digital Stereo (HDMI)
device-strings = hdmi:%f
paths-output = hdmi-output-0
channel-map = left,right
priority = 9
direction = output

[Profile multiple]
description = Analog Stereo Duplex + Digital Stereo (HDMI) Output
output-mappings = analog-stereo hdmi-stereo
input-mappings = analog-stereo</pre>
<p>Now we configure Wireplumber to use the new card-profile for matching devices. For identifying information see <a href="#Obtain_interface_name_for_rules_matching">#Obtain interface name for rules matching</a>. We apply the configuration by creating a JSON file such as the following:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/wireplumber/wireplumber.conf.d/51-alsa-custom.conf
(or ~/.config/wireplumber/wireplumber.conf.d/51-alsa-custom.conf)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">monitor.alsa.rules = [
  {
    matches = [
      {
        device.nick = "HDA Intel PCH"
      }
    ]
    actions = {
      update-props = {
        api.alsa.use-acp = true,
        api.acp.auto-profile = false
        api.acp.auto-port = false
        device.profile-set = "multiple.conf"
        device.profile = "multiple"
      }
    }
  }
]</pre>
<h3><span class="mw-headline" id="Simultaneous_output_to_transient_devices">Simultaneous output to transient devices</span></h3>
<p>You may wish to output sound to onboard and external devices simultaneously - even when the external devices are not always plugged in.
To accomplish this we create a virtual node that will always be present, regardless of what hardware is plugged in. We then link the transient hardware (in this example USB headphones) to the virtual node whenever they are plugged in.
</p>
<p>First create a script that will run during login (this is usually easiest done via your window manager's Startup function).
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/local/sbin/create-virtual-sink.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash

# Create a new sink called Simultaneous Output
pw-cli create-node adapter '{ factory.name=support.null-audio-sink node.name="Simultaneous Output" node.description="Simultaneous Output" media.class=Audio/Sink object.linger=true audio.position=[FL FR] }'

# Connect the normal permanent sound card output to the new sink
pw-link "Simultaneous Output:monitor_FL" alsa_output.pci-0000_05_04.0.analog-stereo:playback_FL
pw-link "Simultaneous Output:monitor_FR" alsa_output.pci-0000_05_04.0.analog-stereo:playback_FR

# Switch the default output to the new virtual sink
wpctl set-default `wpctl status | grep "\. Simultaneous Output" | egrep '^ │( )*[0-9]*' -o | cut -c6-55 | egrep -o '[0-9]*'`</pre>
<p>In the above example, initially the only output device is our 'normal' on-board soundcard (alsa_output.pci-0000_05_04.0.analog-stereo). You can find the designator for your card by running <code>wpctl status</code> and <code>wpctl inspect</code>.
</p>
<p>Run the following script when your USB headphones are inserted in order to link them to the virtual sink:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">link-virtual-sink-headphones.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash
# link the virtual sync to your headphones should run when detected by UDEV

# wait a second for the drivers to load
sleep 1s

# link the headphones to your virtual sink
sudo -u user1 env XDG_RUNTIME_DIR=/run/user/1000 pw-link "Simultaneous Output:monitor_FL" alsa_output.usb-Kingston_HyperX_Cloud_Flight_S_000000000001-00.analog-stereo:playback_FL
sudo -u user1 env XDG_RUNTIME_DIR=/run/user/1000 pw-link "Simultaneous Output:monitor_FR" alsa_output.usb-Kingston_HyperX_Cloud_Flight_S_000000000001-00.analog-stereo:playback_FR

# finish and return the code for success
exit 0</pre>
<p>Ideally you would run this script automatically when your headphones are inserted. The instructions on the <a href="../en/Udev.html" title="Udev">Udev</a> page describe how you would create a custom rule for that. (Although note, that you cannot run this script directly - because UDEV will not load drivers until _after_ any specifed script has run. So you will have to have an intermediate script with some nohup trickery or something like that).
You will also need to modify the above script so that the XDG_RUNTIME_DIR matches your user id number and <b>user1</b> will need to be replaced with your username.
</p>
<p>You can add any arbitrary number of devices to this virtual sink in the same manner.
</p>
<p>If you are having trouble keeping track what devices are connected where, the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=qpwgraph">qpwgraph</a></span> tool is excellent for getting a visual representation of which devices are connected to each other.
</p>
<h2><span class="mw-headline" id="Tips_and_tricks">Tips and tricks</span></h2>
<h3><span class="mw-headline" id="Keyboard_volume_control">Keyboard volume control</span></h3>
<p>See <a href="../en/Keyboard_shortcuts.html#Xorg" title="Keyboard shortcuts">Keyboard shortcuts#Xorg</a> to bind the following commands to your volume keys: <code>XF86AudioRaiseVolume</code>, <code>XF86AudioLowerVolume</code>, <code>XF86AudioMute</code> and <code>XF86AudioMicMute</code>.
</p>
<p>To raise the volume, with a limit of 150%:
</p>
<pre>$ wpctl set-volume -l 1.5 @DEFAULT_AUDIO_SINK@ 5%+
</pre>
<p>To lower the volume:
</p>
<pre>$ wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
</pre>
<p>To mute/unmute the volume:
</p>
<pre>$ wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
</pre>
<p>To mute/unmute the microphone:
</p>
<pre>$ wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> To use sinks or sources other than the default ones, run <code>wpctl status</code> to list all available sinks, and use sink or source numbers in place of <code>@DEFAULT_AUDIO_SINK@</code> or <code>_SOURCE@</code>.</div>
<h3><span class="mw-headline" id="Show_volume_level">Show volume level</span></h3>
<p>To get the volume level and mute status of the default sink:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ wpctl get-volume @DEFAULT_AUDIO_SINK@</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Volume: 0.45</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The mute status is only visible when the sink is muted.</div>
<h3>
<span id="Keep_Bluetooth_running_after_logout_.2F_Headless_Bluetooth"></span><span class="mw-headline" id="Keep_Bluetooth_running_after_logout_/_Headless_Bluetooth">Keep Bluetooth running after logout / Headless Bluetooth</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You also need to enable <a href="../en/Systemd/User.html#Automatic_start-up_of_systemd_user_instances" title="Systemd/User">lingering</a> for the user running <a href="../en/PipeWire.html" title="PipeWire">PipeWire</a>/Wireplumber.</div>
<p>Since 0.4.8 the requirement to <code>support.logind</code> has to be disabled for the bluez seat-monitoring.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/wireplumber/wireplumber.conf.d/80-disable-logind.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">wireplumber.profiles = {
  main = {
    monitor.bluez.seat-monitoring = disabled
  }
}</pre>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<p>Since WirePlumber only exists to manage PipeWire sessions, WirePlumber-related fixes may be found in <a href="../en/PipeWire.html#Troubleshooting" title="PipeWire">PipeWire#Troubleshooting</a>.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://pipewire.pages.freedesktop.org/wireplumber/">Documentation</a> — Official documentation</li>
<li>
<a rel="nofollow" class="external text" href="https://www.collabora.com/news-and-blog/blog/2020/05/07/wireplumber-the-pipewire-session-manager/">WirePlumber, the PipeWire session manager</a> — Blog post by George Kiagiadakis (Collabora) from May 2020, detailing how WirePlumber works</li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Multimedia.html" title="Category:Multimedia">Multimedia</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li>
<li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=WirePlumber&amp;oldid=813508">https://wiki.archlinux.org/index.php?title=WirePlumber&amp;oldid=813508</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 30 July 2024, at 20:55.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
