<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>MariaDB - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.4">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-MariaDB rootpage-MariaDB skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Installation</div>
		</a>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Configuration" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Configuration">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Configuration</div>
		</a>
		
			<button aria-controls="toc-Configuration-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configuration subsection</span>
			</button>
		
		<ul id="toc-Configuration-sublist" class="vector-toc-list">
			<li id="toc-Add_user" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Add_user">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Add user</div>
			</a>
			
			<ul id="toc-Add_user-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Configuration_files" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configuration_files">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>Configuration files</div>
			</a>
			
			<ul id="toc-Configuration_files-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Enable_auto-completion" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Enable_auto-completion">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3</span>Enable auto-completion</div>
			</a>
			
			<ul id="toc-Enable_auto-completion-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Using_UTF8MB4" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Using_UTF8MB4">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4</span>Using UTF8MB4</div>
			</a>
			
			<ul id="toc-Using_UTF8MB4-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Using_a_tmpfs_for_tmpdir" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Using_a_tmpfs_for_tmpdir">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.5</span>Using a tmpfs for tmpdir</div>
			</a>
			
			<ul id="toc-Using_a_tmpfs_for_tmpdir-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Time_zone_tables" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Time_zone_tables">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.6</span>Time zone tables</div>
			</a>
			
			<ul id="toc-Time_zone_tables-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Security" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Security">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Security</div>
		</a>
		
			<button aria-controls="toc-Security-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Security subsection</span>
			</button>
		
		<ul id="toc-Security-sublist" class="vector-toc-list">
			<li id="toc-Improve_initial_security" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Improve_initial_security">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>Improve initial security</div>
			</a>
			
			<ul id="toc-Improve_initial_security-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Listen_only_on_the_loopback_address" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Listen_only_on_the_loopback_address">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>Listen only on the loopback address</div>
			</a>
			
			<ul id="toc-Listen_only_on_the_loopback_address-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Enable_access_locally_only_via_Unix_sockets" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Enable_access_locally_only_via_Unix_sockets">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3</span>Enable access locally only via Unix sockets</div>
			</a>
			
			<ul id="toc-Enable_access_locally_only_via_Unix_sockets-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Grant_remote_access" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Grant_remote_access">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.4</span>Grant remote access</div>
			</a>
			
			<ul id="toc-Grant_remote_access-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Configure_access_to_home_directories" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Configure_access_to_home_directories">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.5</span>Configure access to home directories</div>
			</a>
			
			<ul id="toc-Configure_access_to_home_directories-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Maintenance" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Maintenance">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Maintenance</div>
		</a>
		
			<button aria-controls="toc-Maintenance-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Maintenance subsection</span>
			</button>
		
		<ul id="toc-Maintenance-sublist" class="vector-toc-list">
			<li id="toc-Upgrade_databases_on_major_releases" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Upgrade_databases_on_major_releases">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>Upgrade databases on major releases</div>
			</a>
			
			<ul id="toc-Upgrade_databases_on_major_releases-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Checking,_optimizing_and_repairing_databases" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Checking,_optimizing_and_repairing_databases">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2</span>Checking, optimizing and repairing databases</div>
			</a>
			
			<ul id="toc-Checking,_optimizing_and_repairing_databases-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Backup" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Backup">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Backup</div>
		</a>
		
			<button aria-controls="toc-Backup-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Backup subsection</span>
			</button>
		
		<ul id="toc-Backup-sublist" class="vector-toc-list">
			<li id="toc-Compression" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Compression">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1</span>Compression</div>
			</a>
			
			<ul id="toc-Compression-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Non-interactive" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Non-interactive">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2</span>Non-interactive</div>
			</a>
			
			<ul id="toc-Non-interactive-sublist" class="vector-toc-list">
				<li id="toc-Example_script" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Example_script">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2.1</span>Example script</div>
			</a>
			
			<ul id="toc-Example_script-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Holland_Backup" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Holland_Backup">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.3</span>Holland Backup</div>
			</a>
			
			<ul id="toc-Holland_Backup-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Troubleshooting">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>Troubleshooting</div>
		</a>
		
			<button aria-controls="toc-Troubleshooting-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Troubleshooting subsection</span>
			</button>
		
		<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
			<li id="toc-Unable_to_run_mariadb-upgrade_because_MariaDB_cannot_start" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Unable_to_run_mariadb-upgrade_because_MariaDB_cannot_start">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.1</span>Unable to run mariadb-upgrade because MariaDB cannot start</div>
			</a>
			
			<ul id="toc-Unable_to_run_mariadb-upgrade_because_MariaDB_cannot_start-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Reset_the_root_password" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Reset_the_root_password">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.2</span>Reset the root password</div>
			</a>
			
			<ul id="toc-Reset_the_root_password-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Check_and_repair_all_tables" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Check_and_repair_all_tables">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.3</span>Check and repair all tables</div>
			</a>
			
			<ul id="toc-Check_and_repair_all_tables-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Optimize_all_tables" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Optimize_all_tables">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.4</span>Optimize all tables</div>
			</a>
			
			<ul id="toc-Optimize_all_tables-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-OS_error_22_when_running_on_ZFS" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#OS_error_22_when_running_on_ZFS">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.5</span>OS error 22 when running on ZFS</div>
			</a>
			
			<ul id="toc-OS_error_22_when_running_on_ZFS-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Cannot_login_through_CLI,_but_phpmyadmin_works_well" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Cannot_login_through_CLI,_but_phpmyadmin_works_well">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.6</span>Cannot login through CLI, but phpmyadmin works well</div>
			</a>
			
			<ul id="toc-Cannot_login_through_CLI,_but_phpmyadmin_works_well-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-MariaDB_binary_logs_are_taking_up_huge_disk_space" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#MariaDB_binary_logs_are_taking_up_huge_disk_space">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.7</span>MariaDB binary logs are taking up huge disk space</div>
			</a>
			
			<ul id="toc-MariaDB_binary_logs_are_taking_up_huge_disk_space-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-OpenRC_fails_to_start_MariaDB" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#OpenRC_fails_to_start_MariaDB">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.8</span>OpenRC fails to start MariaDB</div>
			</a>
			
			<ul id="toc-OpenRC_fails_to_start_MariaDB-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Changed_limits_warning_on_max_open_files/table_open_cache" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Changed_limits_warning_on_max_open_files/table_open_cache">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.9</span>Changed limits warning on max_open_files/table_open_cache</div>
			</a>
			
			<ul id="toc-Changed_limits_warning_on_max_open_files/table_open_cache-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id='toc-10.4_to_10.5_upgrade_crash:_"InnoDB:_Upgrade_after_a_crash_is_not_supported._The_redo_log_was_created_with_MariaDB_10.4.x"' class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href='#10.4_to_10.5_upgrade_crash:_"InnoDB:_Upgrade_after_a_crash_is_not_supported._The_redo_log_was_created_with_MariaDB_10.4.x"'>
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.10</span>10.4 to 10.5 upgrade crash: "InnoDB: Upgrade after a crash is not supported. The redo log was created with MariaDB 10.4.x"</div>
			</a>
			
			<ul id='toc-10.4_to_10.5_upgrade_crash:_"InnoDB:_Upgrade_after_a_crash_is_not_supported._The_redo_log_was_created_with_MariaDB_10.4.x"-sublist' class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Table_'mysql.xxx'_does_not_exist_in_engine" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Table_'mysql.xxx'_does_not_exist_in_engine">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">6.11</span>Table 'mysql.xxx' does not exist in engine</div>
			</a>
			
			<ul id="toc-Table_'mysql.xxx'_does_not_exist_in_engine-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">7</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">MariaDB</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 4 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-4" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">4 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-de mw-list-item"><a href="https://wiki.archlinux.de/title/MariaDB" title="MariaDB – Deutsch" lang="de" hreflang="de" class="interlanguage-link-target"><span>Deutsch</span></a></li>
<li class="interlanguage-link interwiki-fr mw-list-item"><a href="../fr/MariaDB.html" title="MariaDB – français" lang="fr" hreflang="fr" class="interlanguage-link-target"><span>Français</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/MariaDB" title="MariaDB – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/MariaDB" title="MariaDB – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/PhpMyAdmin.html" title="PhpMyAdmin">phpMyAdmin</a></li>
<li><a href="../en/Adminer.html" title="Adminer">Adminer</a></li>
<li><a href="../en/JDBC_and_MySQL.html" title="JDBC and MySQL">JDBC and MySQL</a></li>
<li><a href="../en/Open_Database_Connectivity.html" title="Open Database Connectivity">Open Database Connectivity</a></li>
</ul>
</div>
<p><a href="https://en.wikipedia.org/wiki/MariaDB" class="extiw" title="wikipedia:MariaDB">MariaDB</a> is a reliable, high performance and full-featured database server which aims to be an 'always Free, backward compatible, drop-in' replacement of <a href="../en/MySQL.html" title="MySQL">MySQL</a>. Since 2013 MariaDB is Arch Linux's default implementation of MySQL.<a rel="nofollow" class="external autonumber" href="https://archlinux.org/news/mariadb-replaces-mysql-in-repositories/">[1]</a>
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a rel="nofollow" class="external text" href="https://mariadb.com/">MariaDB</a> is the <a rel="nofollow" class="external text" href="https://archlinux.org/news/mariadb-replaces-mysql-in-repositories/">default implementation</a> of MySQL in Arch Linux, provided with the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mariadb">mariadb</a></span> package.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 
<ul>
<li>If the database (in <code>/var/lib/mysql</code>) resides on a <a href="../en/Btrfs.html" title="Btrfs">Btrfs</a> file system, you should consider disabling <a href="../en/Btrfs.html#Copy-on-Write_(CoW)" title="Btrfs">Copy-on-Write</a> for the directory before creating any database.</li>
<li>If the database resides on a <a href="../en/ZFS.html" title="ZFS">ZFS</a> file system, you should consult <a href="../en/ZFS.html#Databases" title="ZFS">ZFS#Databases</a> before creating any database.</li>
</ul>
</div>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mariadb">mariadb</a></span>, and run the following command <b>before starting</b> the <code>mariadb.service</code>:
</p>
<pre># mariadb-install-db --user=mysql --basedir=/usr --datadir=/var/lib/mysql
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> If you use something different from <code>/var/lib/mysql</code> for your data dir, you need to set <code>datadir=<i>YOUR_DATADIR</i></code> under section <code>[mariadb]</code> of your <code>/etc/my.cnf.d/server.cnf</code>.</div>
<p>Now <code>mariadb.service</code> can be <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Started">started</a> and/or <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enabled">enabled</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Before continuing, it is recommended to <a href="#Improve_initial_security">improve the initial security</a> of MariaDB installation.</div>
<p>To simplify administration, you might want to install a <a href="../en/MySQL.html#Graphical_tools" title="MySQL">front-end</a>.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>By default both <code>root</code> user and the user running the server can administer the database.
</p>
<p>To administer the server, run <i>mariadb</i> as the user running the server: 
</p>
<pre>[mysql]$ mariadb
</pre>
<p>Or as root:
</p>
<pre># mariadb
</pre>
<h3><span class="mw-headline" id="Add_user">Add user</span></h3>
<p>Creating a new user takes two steps: create the user; grant privileges. In the below example, the user <i>monty</i> with <i>some_pass</i> as password is being created, then granted full permissions to the database <i>mydb</i>: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># mariadb -u root -p</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">MariaDB&gt; CREATE USER 'monty'@'localhost' IDENTIFIED BY 'some_pass';
MariaDB&gt; GRANT ALL PRIVILEGES ON mydb.* TO 'monty'@'localhost';
MariaDB&gt; quit
</pre>
<h3><span class="mw-headline" id="Configuration_files">Configuration files</span></h3>
<p><i>MariaDB</i> configuration options are read from the following files in the given order (according to <code>mysqld --help --verbose | head -10</code> output):
</p>
<pre>/etc/my.cnf /etc/my.cnf.d/ ~/.my.cnf
</pre>
<p>Create a configuration file in <code>/etc/my.cnf.d/</code> with a <i>.cnf</i> extension to ensure that upgrades preserve your configuration.
</p>
<p>Depending on the scope of the changes you want to make (system-wide, user-only...), use the corresponding file. See <a rel="nofollow" class="external text" href="https://mariadb.com/kb/en/library/configuring-mariadb-with-option-files/">this entry</a> of the Knowledge Base for more information.
</p>
<h3><span class="mw-headline" id="Enable_auto-completion">Enable auto-completion</span></h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Enabling this feature can make the client initialization longer.</div>
<p>The MariaDB client completion feature is disabled by default. To enable it system-wide edit <code>/etc/my.cnf.d/client.cnf</code>, and add <code>auto-rehash</code> under <code>client-mariadb</code>. Note that this must not be placed under <code>mysqld</code>. Completion will be enabled next time you run the MariaDB client.
</p>
<h3><span class="mw-headline" id="Using_UTF8MB4">Using UTF8MB4</span></h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Before changing the character set be sure to create a backup first.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mariadb">mariadb</a></span> package already uses <code>utf8mb4</code> as charset and <code>utf8mb4_unicode_ci</code> as collation. Users using the default (character) settings may want to skip this section.</li>
<li>UTF8MB4 is recommended over UTF-8 since it allows full Unicode support <a rel="nofollow" class="external autonumber" href="https://mathiasbynens.be/notes/mysql-utf8mb4">[2]</a> <a rel="nofollow" class="external autonumber" href="https://stackoverflow.com/questions/30074492/what-is-the-difference-between-utf8mb4-and-utf8-charsets-in-mysql">[3]</a>.</li>
</ul>
</div>
<p><a href="../en/Help:Reading.html#Append,_add,_create,_edit" class="mw-redirect" title="Append">Append</a> the following values to the main configuration file located at <code>/etc/my.cnf.d/my.cnf</code>:
</p>
<pre>[client]
default-character-set = utf8mb4

[mariadb]
collation_server = utf8mb4_unicode_ci
character_set_server = utf8mb4

[mariadb-client]
default-character-set = utf8mb4</pre>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">Restart</a> <code>mariadb.service</code> to apply the changes. Changing the character set does not change existing table formats, only newly created tables, and the protocol interaction that fetches data.
</p>
<p>See <a href="#Maintenance">#Maintenance</a> to optimize and check the database health.
</p>
<h3><span class="mw-headline" id="Using_a_tmpfs_for_tmpdir">Using a tmpfs for tmpdir</span></h3>
<p>The directory used by MariaDB for storing temporary files is named <i>tmpdir</i>. For example, it is used to perform disk based large sorts, as well as for internal and explicit temporary tables.
</p>
<p>Create the directory with appropriate permissions:
</p>
<pre># mkdir -pv /var/lib/mysqltmp
# chown mysql:mysql /var/lib/mysqltmp
</pre>
<p>Add the following <a href="../en/Tmpfs.html" title="Tmpfs">tmpfs</a> mount to your <code>/etc/fstab</code> file:
</p>
<pre>tmpfs   /var/lib/mysqltmp   tmpfs   rw,gid=mysql,uid=mysql,size=100M,mode=0750,noatime   0 0
</pre>
<p>Add to your <code>/etc/my.cnf.d/server.cnf</code> file under the <code>mysqld</code> group:
</p>
<pre>tmpdir      = /var/lib/mysqltmp
</pre>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Stop">Stop</a> <code>mariadb.service</code>, <a href="../en/File_systems.html#Mount_a_file_system" class="mw-redirect" title="Mount">mount</a> <code>/var/lib/mysqltmp/</code> and <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start">start</a> <code>mariadb.service</code>.
</p>
<h3><span class="mw-headline" id="Time_zone_tables">Time zone tables</span></h3>
<p>Although time zone tables are created during the installation, they are not automatically populated. They need to be populated if you are planning on using CONVERT_TZ() in SQL queries.
</p>
<p>To populate the time zone tables with all the time zones:
</p>
<pre>$ mariadb-tzinfo-to-sql /usr/share/zoneinfo | mariadb -u root -p mysql
</pre>
<p>Optionally, you may populate the table with specific time zone files:
</p>
<pre>$ mariadb-tzinfo-to-sql <i>timezone_file</i> <i>timezone_name</i> | mariadb -u root -p mysql
</pre>
<h2><span class="mw-headline" id="Security">Security</span></h2>
<h3><span class="mw-headline" id="Improve_initial_security">Improve initial security</span></h3>
<p>The <code>mariadb-secure-installation</code> command will interactively guide you through a number of recommended security measures, such as removing anonymous accounts and removing the test database:
</p>
<pre># mariadb-secure-installation
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> After running this, please note that TCP port 3306 will still be open, but refusing connections with an error message. To prevent MySQL from listening on an external interface, see the <a href="#Listen_only_on_the_loopback_address">#Listen only on the loopback address</a> and <a href="#Enable_access_locally_only_via_Unix_sockets">#Enable access locally only via Unix sockets</a> sections.</div>
<h3><span class="mw-headline" id="Listen_only_on_the_loopback_address">Listen only on the loopback address</span></h3>
<p>By default, MariaDB will listen on the 0.0.0.0 address, which includes all network interfaces. In order to restrict MariaDB to listen only to the loopback address, add the following line in <code>/etc/my.cnf.d/server.cnf</code>:
</p>
<pre>[mariadb]
bind-address = localhost
</pre>
<p>This will bind to both 127.0.0.1 and ::1, and enable MariaDB to receive connections both in IPv4 and IPv6.
</p>
<h3><span class="mw-headline" id="Enable_access_locally_only_via_Unix_sockets">Enable access locally only via Unix sockets</span></h3>
<p>By default, MariaDB is accessible via both Unix sockets and the network. If MariaDB is only needed for the localhost, you can improve security by not listening on TCP port 3306, and only listening on Unix sockets instead. To do this, add the following line in <code>/etc/my.cnf.d/server.cnf</code>:
</p>
<pre>[mariadb]
skip-networking
</pre>
<p>You will still be able to log in locally as before, but only using Unix sockets.
</p>
<h3><span class="mw-headline" id="Grant_remote_access">Grant remote access</span></h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> This is not considered as best practice and may cause security issues. Consider using <a href="../en/Secure_Shell.html" title="Secure Shell">Secure Shell</a>, <a href="../en/List_of_applications/Internet.html#Remote_desktop" class="mw-redirect" title="VNC">VNC</a> or <a href="../en/Category:Virtual_Private_Network.html" class="mw-redirect" title="VPN">VPN</a>, if you want to maintain the MariaDB server from another host inside/outside your network.</div>
<p>To allow remote access to the MariaDB server, ensure that MariaDB has <a href="#Enable_access_locally_only_via_Unix_sockets">networking enabled</a> and is <a href="#Listen_only_on_the_loopback_address">listening on the appropriate interface</a>.
</p>
<p>Grant any MariaDB user remote access (example for root):
</p>
<pre># mariadb -u root -p
</pre>
<p>Check current users with remote access privileged:
</p>
<pre>SELECT User, Host FROM mysql.user WHERE Host &lt;&gt; 'localhost';
</pre>
<p>Now grant remote access for your user (here root):
</p>
<pre>GRANT ALL PRIVILEGES ON *.* TO 'root'@'192.168.1.%' IDENTIFIED BY 'my_optional_remote_password' WITH GRANT OPTION;
</pre>
<p>You can change the '%' wildcard to a specific host if you like. The password can be different from user's main password.
</p>
<h3><span class="mw-headline" id="Configure_access_to_home_directories">Configure access to home directories</span></h3>
<p>For security reasons, the systemd service file contains <code>ProtectHome=true</code>, which prevents MariaDB from accessing files under the <code>/home</code>, <code>/root</code> and <code>/run/user</code> hierarchies. The <code>datadir</code> has to be in an accessible location and <a href="../en/File_permissions_and_attributes.html#Changing_ownership" class="mw-redirect" title="Chown">owned</a> by the <code>mysql</code> user and group.
</p>
<p>You can modify this behavior by creating a supplementary service file as described <a rel="nofollow" class="external text" href="https://mariadb.com/kb/en/systemd/#configuring-access-to-home-directories">here</a>.
</p>
<h2><span class="mw-headline" id="Maintenance">Maintenance</span></h2>
<h3><span class="mw-headline" id="Upgrade_databases_on_major_releases">Upgrade databases on major releases</span></h3>
<p>Upon a major version release of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mariadb">mariadb</a></span> (for example mariadb-10.3.10-1 to mariadb-10.9.4-1), it is wise to upgrade the system database to make new server features available:
</p>
<pre># mariadb-upgrade -u root -p
</pre>
<p>To upgrade from 10.3.x to 10.9.x:
</p>
<ul>
<li>perform a clean shutdown of the 10.3.x server</li>
<li>upgrade the package</li>
<li>run <code>mariadb-upgrade</code> (from the new package version) against the new running daemon</li>
</ul>
<p>If the (new) daemon is not starting, see <a href="#Unable_to_run_mariadb-upgrade_because_MariaDB_cannot_start">#Unable to run mariadb-upgrade because MariaDB cannot start</a>.
</p>
<h3>
<span id="Checking.2C_optimizing_and_repairing_databases"></span><span class="mw-headline" id="Checking,_optimizing_and_repairing_databases">Checking, optimizing and repairing databases</span>
</h3>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mariadb-clients">mariadb-clients</a></span> ships with <i>mariadb-check</i> which can be used to check, repair, and optimize tables within databases from the shell. See <span class="plainlinks archwiki-template-man" title="$ man 1 mariadb-check"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mariadb-check.1">mariadb-check(1)</a></span> for more.  Several command tasks are shown:
</p>
<p>To check all tables in all databases:
</p>
<pre>$ mariadb-check --all-databases -u root -p -c
</pre>
<p>To analyze all tables in all databases:
</p>
<pre>$ mariadb-check --all-databases -u root -p -a
</pre>
<p>To repair all tables in all databases:
</p>
<pre>$ mariadb-check --all-databases -u root -p -r
</pre>
<p>To optimize all tables in all databases:
</p>
<pre>$ mariadb-check --all-databases -u root -p -o
</pre>
<h2><span class="mw-headline" id="Backup">Backup</span></h2>
<p>There are various <a rel="nofollow" class="external text" href="https://mariadb.com/kb/en/mariadb/documentation/backing-up-and-restoring/">tools and strategies</a> to back up your databases.
</p>
<p>If you are using the default InnoDB storage engine, a <a rel="nofollow" class="external text" href="https://mariadb.com/kb/en/mariadb/documentation/clients-and-utilities/backup-restore-and-import/mysqldump/#examples">suggested</a> way of backing up all your bases online while provisioning for <a rel="nofollow" class="external text" href="https://dev.mysql.com/doc/refman/5.6/en/point-in-time-recovery.html">point-in-time recovery</a> (also known as "roll-forward", when you need to restore an old backup and replay the changes that happened since that backup) is to execute the following command:
</p>
<pre>$ mariadb-dump --single-transaction --flush-logs --events --routines --master-data=2 --all-databases -u root -p &gt; all_databases.sql
</pre>
<p>This will prompt for <b>MariaDB's</b> root user's password, which was defined during database <a href="#Configuration">#Configuration</a>.
</p>
<p>Specifying the password on the command line is <a rel="nofollow" class="external text" href="https://dev.mysql.com/doc/refman/5.6/en/password-security-user.html">strongly discouraged</a>, as it exposes it to discovery by other users through the use of <code>ps aux</code> or other techniques. Instead, the aforementioned command will prompt for the specified user's password, concealing it away.
</p>
<h3><span class="mw-headline" id="Compression">Compression</span></h3>
<p>As SQL tables can get pretty large, it is recommended to pipe the output of the aforementioned command in a <a href="../en/Archiving_and_compression.html#Compression_only" title="Archiving and compression">compression utility</a> like <span class="plainlinks archwiki-template-man" title="$ man 1 xz"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/xz.1">xz(1)</a></span>:
</p>
<pre>$ mariadb-dump --single-transaction --flush-logs --events --routines --master-data=2 --all-databases -u root -p | xz -z &gt; all_databases.sql.xz
</pre>
<p>Decompressing the backup thus created and reloading it in the server is achieved by doing:
</p>
<pre>$ xzcat all_databases.sql.xz | mariadb -u root -p
</pre>
<p>This will recreate and repopulate all the databases previously backed up (see <a rel="nofollow" class="external text" href="https://stackoverflow.com/questions/23180963/restore-all-mysql-database-from-a-all-database-sql-gz-file#comment35453351_23180977">this</a> or <a rel="nofollow" class="external text" href="https://www.linuxquestions.org/questions/linux-server-73/how-to-restore-mysqldump-all-databases-backup-892922/">this</a>).
</p>
<h3><span class="mw-headline" id="Non-interactive">Non-interactive</span></h3>
<p>If you want to setup non-interactive backup script for use in <a href="../en/Cron.html" title="Cron">cron</a> jobs or <a href="../en/Systemd/Timers.html" class="mw-redirect" title="Systemd/cron functionality">systemd timers</a>, see <a rel="nofollow" class="external text" href="https://mariadb.com/kb/en/configuring-mariadb-with-option-files/">option files</a> and <a rel="nofollow" class="external text" href="https://stackoverflow.com/a/9293090">this illustration</a> for <i>mariadb-dump</i>.
</p>
<p>Basically you should add the following section to the relevant <a href="#Configuration_files">configuration file</a>:
</p>
<pre>[mariadb-dump]
user=mysqluser
password=secret</pre>
<p>Mentioning a user here is optional, but doing so will free you from having to mention it on the command line. If you want to set this for all tools, including <code>mariadb-client</code>, use the <code>[client]</code> group.
</p>
<h4><span class="mw-headline" id="Example_script">Example script</span></h4>
<p>The database can be dumped to a file for easy backup. The following shell script will do this for you, creating a <code>db_backup.xz</code> file in the same directory as the script, containing your database dump:
</p>
<pre>#!/bin/sh

THISDIR=$(dirname $(readlink -f "$0"))

mariadb-dump --single-transaction --flush-logs --events --routines --master-data=2 --all-databases \
 | xz -z &gt; $THISDIR/db_backup.xz
echo 'purge master logs before date_sub(now(), interval 7 day);' | mariadb
</pre>
<p>See also the official <code>mariadb-dump</code> page in the <a rel="nofollow" class="external text" href="https://mariadb.com/kb/en/mariadb/documentation/clients-and-utilities/backup-restore-and-import/mysqldump">MariaDB</a> manuals.
</p>
<h3><span class="mw-headline" id="Holland_Backup">Holland Backup</span></h3>
<p>A python-based software package named <a rel="nofollow" class="external text" href="https://hollandbackup.org/">Holland Backup</a> allows to automate all of the backup work. It supports direct mysqldump, LVM snapshots to tar files (mysqllvm), LVM snapshots with mysqldump (mysqldump-lvm), and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xtrabackup">xtrabackup</a></span> methods to extract the data. The Holland framework supports a multitude of options and is highly configurable to address almost any backup situation.
</p>
<p>The main <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/holland/">holland</a></span><sup><small>AUR</small></sup> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/holland-common/">holland-common</a></span><sup><small>AUR</small></sup> packages provide the core framework; one of the sub-packages (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/holland-mysqldump/">holland-mysqldump</a></span><sup><small>AUR</small></sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/holland-mysqllvm/">holland-mysqllvm</a></span><sup><small>AUR</small></sup> and/or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/holland-xtrabackup/">holland-xtrabackup</a></span><sup><small>AUR</small></sup> must be installed for full operation. Example configurations for each method are in the <code>/usr/share/doc/holland/examples/</code> directory and can be copied to <code>/etc/holland/backupsets/</code>, as well as using the <code>holland mk-config</code> command to generate a base configuration for a named provider.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="Unable_to_run_mariadb-upgrade_because_MariaDB_cannot_start">Unable to run mariadb-upgrade because MariaDB cannot start</span></h3>
<p>Try run MariaDB in a standalone:
</p>
<pre># mariadbd-safe --datadir=/var/lib/mysql/
</pre>
<p>And then run:
</p>
<pre># mariadb-upgrade -u root -p
</pre>
<h3><span class="mw-headline" id="Reset_the_root_password">Reset the root password</span></h3>
<ol>
<li>Stop <code>mariadb.service</code>.</li>
<li>Start the MariaDB server with safety features: <pre># mariadbd-safe --skip-grant-tables --skip-networking &amp;</pre>
</li>
<li>Connect to it: <pre># mariadb -u root</pre>
</li>
<li>Change root password: <pre>MariaDB [mysql]&gt; FLUSH PRIVILEGES;
MariaDB [mysql]&gt; ALTER USER 'root'@'localhost' IDENTIFIED BY 'new_password';
MariaDB [mysql]&gt; exit
</pre>
</li>
<li>Kill running mariadbd* processes: <pre># kill $(cat /var/lib/mysql/$HOSTNAME.pid)</pre>
</li>
<li>Start <code>mariadb.service</code>.</li>
</ol>
<h3><span class="mw-headline" id="Check_and_repair_all_tables">Check and repair all tables</span></h3>
<p>Check and auto repair all tables in all databases, <a rel="nofollow" class="external text" href="https://mariadb.com/kb/en/mysqlcheck/">see more</a>:
</p>
<pre># mariadb-check -A --auto-repair -u root -p
</pre>
<h3><span class="mw-headline" id="Optimize_all_tables">Optimize all tables</span></h3>
<p>Forcefully optimize all tables, automatically fixing table errors that may come up.
</p>
<pre># mariadb-check -A --auto-repair -f -o -u root -p
</pre>
<h3><span class="mw-headline" id="OS_error_22_when_running_on_ZFS">OS error 22 when running on ZFS</span></h3>
<p>If using MySQL databases on <a href="../en/ZFS.html" title="ZFS">ZFS</a>, the error <code>InnoDB: Operating system error number 22 in a file operation</code> may occur.
</p>
<p>A workaround is to disable <code>aio_writes</code> in <code>/etc/my.cnf.d/my.cnf</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/my.cnf.d/my.cnf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[mariadb]
innodb_use_native_aio = 0</pre>
<h3>
<span id="Cannot_login_through_CLI.2C_but_phpmyadmin_works_well"></span><span class="mw-headline" id="Cannot_login_through_CLI,_but_phpmyadmin_works_well">Cannot login through CLI, but phpmyadmin works well</span>
</h3>
<p>This may happen if you are using a long (&gt;80) password. <code>mariadb</code> CLI cannot handle that many characters in readline mode. So, if you are planning to use the recommended password input mode:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ mariadb -u <i>user</i> -p</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Password:
</pre>
<p>Consider changing the password to smaller one.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You still can log in by specifying the password as an argument to mariadb command.
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> This behavior is considered dangerous, because your password might leak, for example, to the logs. Use it only in case of emergency and do not forget to change password right afterwards.</div>
<pre>$ mariadb -u <i>user</i> -p"<i>some-very-strong-password</i>"
</pre>
</div>
<h3><span class="mw-headline" id="MariaDB_binary_logs_are_taking_up_huge_disk_space">MariaDB binary logs are taking up huge disk space</span></h3>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:View-refresh-red.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section is out of date.</b></p>
<div>
<b>Reason:</b> /etc/my.cnf.d/my.cnf no longer exists (Discuss in <a href='../en/Talk:MariaDB.html#Mistakes_in_"MariaDB_binary_logs_are_taking_up_huge_disk_space"' title="Talk:MariaDB">Talk:MariaDB#Mistakes in "MariaDB binary logs are taking up huge disk space"</a>)</div>
</div>
<p>By default, mariadbd creates binary log files at <code>/var/lib/mysql/mysql-bin.<i>XXXXXX</i></code> with the numbers ascending. These logs are useful for replication master server or data recovery, but these binary logs can easily eat up large amounts of disk space. If you do not plan to use replication or data recovery features, you may disable binary logging by commenting out these lines in <code>/etc/my.cnf.d/my.cnf</code> then restart:
</p>
<pre>#log-bin=mysql-bin
#binlog_format=mixed
</pre>
<p>Or, if you want to keep these logs but keep their size in check and old logs deleted, you can set these limits then restart:
</p>
<pre>log-bin=mysql-bin
expire_logs_days = 10
max_binlog_size  = 100M
</pre>
<p>Alternatively, there exists a MariaDB command to manually purge logs older than a specific one. For example, you may see a file named <code>mysql-bin.<i>000023</i></code> and want to delete every log older than it. As long as the log-bin=mysql-bin setting is in effect, you would run:
</p>
<pre># mariadb -u root -p"PASSWORD" -e "PURGE BINARY LOGS TO 'mysql-bin.<i>000023</i>;"
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Using any of these methods may decrease the chances of successful data recovery when trying to repair database tables (i.e. on database corruption).</div>
<h3><span class="mw-headline" id="OpenRC_fails_to_start_MariaDB">OpenRC fails to start MariaDB</span></h3>
<p>To use MariaDB with <a href="../en/OpenRC.html" title="OpenRC">OpenRC</a> you need to add the following lines to the <code>[mariadb]</code> section in the MySQL configuration file, located at <code>/etc/my.cnf.d/my.cnf</code>.
</p>
<pre>user = mysql
basedir = /usr
datadir = /var/lib/mysql
pid-file = /run/mysqld/mysql.pid
</pre>
<p>You should now be able to start MariaDB using:
</p>
<pre># rc-service mysql start
</pre>
<h3>
<span id="Changed_limits_warning_on_max_open_files.2Ftable_open_cache"></span><span class="mw-headline" id="Changed_limits_warning_on_max_open_files/table_open_cache">Changed limits warning on max_open_files/table_open_cache</span>
</h3>
<p>Increase the number of file descriptors by creating a <a href="../en/Systemd.html#Drop-in_files" title="Systemd">systemd drop-in</a>, e.g.:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/mariadb.service.d/limit_nofile.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Service]
LimitNOFILE=8192</pre>
<h3>
<span id="10.4_to_10.5_upgrade_crash:_.22InnoDB:_Upgrade_after_a_crash_is_not_supported._The_redo_log_was_created_with_MariaDB_10.4.x.22"></span><span class="mw-headline" id='10.4_to_10.5_upgrade_crash:_"InnoDB:_Upgrade_after_a_crash_is_not_supported._The_redo_log_was_created_with_MariaDB_10.4.x"'>10.4 to 10.5 upgrade crash: "InnoDB: Upgrade after a crash is not supported. The redo log was created with MariaDB 10.4.x"</span>
</h3>
<p>Before MariaDB 10.5, redo log was unnecessarily split into multiple files.<a rel="nofollow" class="external autonumber" href="https://mariadb.com/kb/en/upgrading-from-mariadb-104-to-mariadb-105/">[4]</a>
</p>
<p>Do NOT ever remove the old binary logs <code>/var/lib/mysql/ib_logfile*</code> out of the way.
</p>
<p>To resolve this, install MariaDB 10.4. Start it and let it undergo a clean shutdown. After that happens you can upgrade to 10.5 again. Same applies if another version of MariaDB was specified.
</p>
<h3>
<span id="Table_.27mysql.xxx.27_does_not_exist_in_engine"></span><span class="mw-headline" id="Table_'mysql.xxx'_does_not_exist_in_engine">Table 'mysql.xxx' does not exist in engine</span>
</h3>
<p>Symptom: When running <i>mariadb-upgrade</i> or <i>mariadb-check</i>, it return one or more error like these:
</p>
<pre>Table 'mysql.xxx' does not exist in engine
</pre>
<p>Where "xxx" usually is the system table inside the mysql database.
</p>
<p>Steps to fix this,
</p>
<ol>
<li>Create backup directory outside of MariaDB <code>${DATADIR}&lt;/nowiki&gt;</code>, for example in <code>$HOME/mariadb_backup</code>.</li>
<li>Copy the offending files from <code>${DATADIR}/mysql/xxx.{frm,ibd}&lt;/nowiki&gt;</code> to backup directory. The <code>xxx.ibd</code> may not exist.</li>
<li>Drop the tables with <i>DROP TABLE mysql.xxx</i> on the <code>mariadb</code> prompt.</li>
<li>Run the <i>mariadb-check</i>. On success, the file <code>xxx.frm</code> and <code>xxx.ibd</code> should be created again.</li>
<li>Re-run <i>mariadb-upgrade</i> if necessary. You may need the <i>--force</i> option.</li>
</ol>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://mariadb.org/">MariaDB Official Website</a></li>
<li><a rel="nofollow" class="external text" href="https://mariadb.com/kb/en/">MariaDB knowledge Base</a></li>
<li><a rel="nofollow" class="external text" href="https://www.askapache.com/mysql/performance-tuning-mysql/">MySQL Performance Tuning Scripts and Know-How</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Relational_DBMSs.html" title="Category:Relational DBMSs">Relational DBMSs</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=MariaDB&amp;oldid=816531">https://wiki.archlinux.org/index.php?title=MariaDB&amp;oldid=816531</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 15 September 2024, at 08:17.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
