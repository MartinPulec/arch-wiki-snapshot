<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>MacBookPro7,1 - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-MacBookPro7_1 rootpage-MacBookPro7_1 skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Preparation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Preparation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Preparation</div>
		</a>
		
			<button aria-controls="toc-Preparation-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Preparation subsection</span>
			</button>
		
		<ul id="toc-Preparation-sublist" class="vector-toc-list">
			<li id="toc-Install_Boot_Manager" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Install_Boot_Manager">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1</span>Install Boot Manager</div>
			</a>
			
			<ul id="toc-Install_Boot_Manager-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Shrinking_Macintosh_HD" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Shrinking_Macintosh_HD">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.2</span>Shrinking Macintosh HD</div>
			</a>
			
			<ul id="toc-Shrinking_Macintosh_HD-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-EFI_vs_CSM_mode" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#EFI_vs_CSM_mode">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.3</span>EFI vs CSM mode</div>
			</a>
			
			<ul id="toc-EFI_vs_CSM_mode-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Installation" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Installation">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Installation</div>
		</a>
		
			<button aria-controls="toc-Installation-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Installation subsection</span>
			</button>
		
		<ul id="toc-Installation-sublist" class="vector-toc-list">
			<li id="toc-Dual_Boot" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Dual_Boot">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Dual Boot</div>
			</a>
			
			<ul id="toc-Dual_Boot-sublist" class="vector-toc-list">
				<li id="toc-EFI-Mode" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#EFI-Mode">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.1</span>EFI-Mode</div>
			</a>
			
			<ul id="toc-EFI-Mode-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-CSM-Mode" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#CSM-Mode">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.2</span>CSM-Mode</div>
			</a>
			
			<ul id="toc-CSM-Mode-sublist" class="vector-toc-list">
				<li id="toc-Cannot_find_root_device" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#Cannot_find_root_device">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1.2.1</span>Cannot find root device</div>
			</a>
			
			<ul id="toc-Cannot_find_root_device-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Network" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Network">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Network</div>
		</a>
		
		<ul id="toc-Network-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Video" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Video">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Video</div>
		</a>
		
			<button aria-controls="toc-Video-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Video subsection</span>
			</button>
		
		<ul id="toc-Video-sublist" class="vector-toc-list">
			<li id="toc-Nouveau" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Nouveau">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>Nouveau</div>
			</a>
			
			<ul id="toc-Nouveau-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Nvidia" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Nvidia">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2</span>Nvidia</div>
			</a>
			
			<ul id="toc-Nvidia-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Backlight_Control" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Backlight_Control">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Backlight Control</div>
		</a>
		
		<ul id="toc-Backlight_Control-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Fan_control" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Fan_control">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>Fan control</div>
		</a>
		
		<ul id="toc-Fan_control-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Additional_Notes" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Additional_Notes">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">7</span>Additional Notes</div>
		</a>
		
		<ul id="toc-Additional_Notes-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">MacBookPro7,1</span></h1>
				</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Merge-arrows-2.svg" decoding="async" width="36" height="40" class="mw-file-element"></span></span><b>This article or section is a candidate for merging with <a href="../en/Laptop/Apple.html#Model_list" title="Laptop/Apple">Laptop/Apple#Model list</a>.</b></p>
<div>
<b>Notes:</b> There's already a blurb with <a href="../en/Laptop/Apple.html#MacBookPro7,1_Mid_2010" title="Laptop/Apple">Laptop/Apple#MacBookPro7,1 Mid 2010</a>, adding the working status in the table should be enough. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:MacBookPro7,1.html">Talk:MacBookPro7,1</a>)</div>
</div>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-edit-clear.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section does not follow the <a href="../en/Help:Laptop_page_guidelines.html" title="Help:Laptop page guidelines">Laptop page guidelines</a>.</b></p>
<div>
<b>Reason:</b> Multiple <a href="../en/Help:Style.html" title="Help:Style">Help:Style</a> violations, the article is written in first person, wall of text duplicating other articles (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:MacBookPro7,1.html">Talk:MacBookPro7,1</a>)</div>
</div>
<p>This page contains tips on installing Arch Linux on a Mid 2010 13" MacBook Pro alongside a pre-existing OSX operating system.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Preparation">Preparation</span></h2>
<h3><span class="mw-headline" id="Install_Boot_Manager">Install Boot Manager</span></h3>
<p><b>Optional.</b> The easiest way to begin is by <a rel="nofollow" class="external text" href="https://www.rodsbooks.com/refind/">installing rEFInd</a> on Mac OSX before moving on to Arch. This will place a boot menu on startup. The config will be in your OSX partition - if this is not desirable it is possible to install it later in Arch. Keep in mind that since Apple's OS X 10.11 (El Capitan), the feature System Integrity Protection (SIP) does not allow for rEFInd installation in the way described on the Installing rEFInd page. See <a rel="nofollow" class="external text" href="https://www.rodsbooks.com/refind/sip.html">this site</a> for more information and installation instructions.
</p>
<h3><span class="mw-headline" id="Shrinking_Macintosh_HD">Shrinking Macintosh HD</span></h3>
<p>Using Mac OSX's disk utility, create a new partition, calculate the amount of free space required for all new partitions and shrink Macintosh HD to accommodate for this amount. Leave the new partition as free space for now.
</p>
<h3><span class="mw-headline" id="EFI_vs_CSM_mode">EFI vs CSM mode</span></h3>
<p>It is probably good to consider on forehand what the differences are and which will work best for you, especially considering the drawback EFI mode has on the NVIDIA driver.
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>To install an x86_64 system, follow the <a href="../en/Mac.html" title="Mac">Mac</a> EFI installation instructions.
It is recommended to read the <a href="../en/Unified_Extensible_Firmware_Interface.html" class="mw-redirect" title="UEFI">UEFI</a>, <a href="../en/Partitioning.html#GUID_Partition_Table" class="mw-redirect" title="GPT">GPT</a> and <a href="../en/Arch_boot_process.html#Boot_loader" title="Arch boot process">Arch boot process#Boot loader</a> pages before trying any of this on your machine.
Also of note, <a rel="nofollow" class="external text" href="https://gist.github.com/Apsu/4108795">GIST</a>.
</p>
<p>See notes on <b>video support</b> before attempting installation!
</p>
<p><i>The following assumes that you have somehow managed to install Arch Linux to a single partition on your drive, and that you still have your osx installation on a different partition.</i>
</p>
<h3><span class="mw-headline" id="Dual_Boot">Dual Boot</span></h3>
<p>If you want to dualboot osx and linux, the easiest way to do so is to use <a href="../en/REFInd.html" title="REFInd">rEFInd</a>.
rEFInd is a updated and maintained fork of <a rel="nofollow" class="external text" href="https://refit.sourceforge.net/">rEFIt</a> and should be used in its place.
</p>
<p>I have found it easiest to install rEFInd from osx. Depending on your setup, you will either install it to your osx partition, or to the ESP partition (install.sh --esp). See <a rel="nofollow" class="external text" href="https://www.rodsbooks.com/refind/installing.html#installsh">here</a> for instructions.
Installing to the ESP partition can cause some <b>startup delay</b>, which can be overcome by simply renaming rEFInd's installation folder to "BOOT" and the executable to "bootx64.efi"<a rel="nofollow" class="external autonumber" href="https://www.rodsbooks.com/refind/installing.html#sluggish">[1]</a>
</p>
<p>Assuming that rEFInd was installed to the ESP, I have found it convenient to later mount the ESP as my "/boot" directory.
That way, by setting
</p>
<pre>scan_all_linux_kernels
</pre>
<p>in your refind.conf, rEFInd will automatically pickup the kernel. All you need to add is a "refind_linux.conf" file to the root of the ESP, containing your boot args. I use:
</p>
<pre>"Boot with defaults"    "root=/dev/sda3 rootfstype=xfs ro add_efi_memmap"
</pre>
<p>Note that my root partition is sda3 and that I use the xfs filesystem on it, yours may differ!
So my ESP partition looks like this when mounted under "/boot":
</p>
<pre>EFI/
 APPLE/
 BOOT/
  bootx64.efi
  drivers/
  icons/
  keys/
  refind.conf
initramfs-linux-fallback.img
initramfs-linux.img
refind_linux.conf
vmlinuz-linux
</pre>
<p>Note that the EFI/BOOT directory is normally named EFI/REFIND and that the bootx64.efi is normally named refind_x64.efi.
</p>
<h4><span class="mw-headline" id="EFI-Mode">EFI-Mode</span></h4>
<p>Consult <a href="../en/Unified_Extensible_Firmware_Interface.html" class="mw-redirect" title="UEFI">UEFI</a>
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> efibootmgr may brick your Mac firmware.</div>
<p>You should now be able to boot your mac in efi-mode via the kernel's efistub feature. rEFInd should present you with an option to do so.
See <a rel="nofollow" class="external text" href="https://www.rodsbooks.com/refind/linux.html">here</a> for more general information on the topic.
This however has some drawbacks, as mentioned in the <b>Video</b> section below.
</p>
<h4><span class="mw-headline" id="CSM-Mode">CSM-Mode</span></h4>
<p>Booting your mac in csm- or legacy-mode provides a solution. To do so, we need a <b>hybrid mbr</b>, with at least one 'active/bootable' partition. See <a rel="nofollow" class="external text" href="https://www.rodsbooks.com/gdisk/hybrid.html">here</a> for more general information on how to setup a hybrid mbr.
Simply boot in <b>efi-mode</b>, then assuming you have three partitions, the ESP partition, an osx and a linux partition you will need to use gdisk to set things up.
</p>
<pre># gdisk /dev/sda
</pre>
<p>Press 'p' to print your partition table, which should look somewhat like mine:
</p>
<pre>Number  Start (sector)    End (sector)  Size       Code  Name
  1              40          409639   200.0 MiB   0700  EFI System Partition
  2          409640       393186215   187.3 GiB   AF00  OSX
  3       393186216       625142414   110.6 GiB   8300  Linux filesystem
</pre>
<p>Press 'r' to enter recovery and transformation mode.
</p>
<p>Now press 'o' to print your mbr. It should only list a single partition covering the entire disk. Or depending on with which tools you used to partition your disk maybe some other entries.
</p>
<p>Press 'h' to create a new hybrid mbr. You will be prompted for some input:
</p>
<pre>Type from one to three GPT partition numbers, separated by spaces, to be
added to the hybrid MBR, in sequence:
</pre>
<p>I chose to mirror my gpt, so I entered '1 2 3', but it should be enough to just use one partition here. In my example, this would need to be the ESP partition, so '1', but in case you do not want to use the ESP to store your kernels, this could also be the linux partition, so '3'. You decide :) 
</p>
<p>Another and maybe more secure way to mirror the gpt is only to enter '1' for the first and only partition, the EFI or boot partition. This prevents the strange behaviour of MacOS. It can happen that MacOS or its bootsystem cannot find its partition and will end up in a rather long loop. Then proceed as written below.
</p>
<p>Make sure to say 'Yes' to the next promt:
</p>
<pre>Place EFI GPT (0xEE) partition first in MBR (good for GRUB)? (Y/N): y
</pre>
<p>Then set at least one partition as active/bootable:
</p>
<pre>Creating entry for GPT partition #1 (MBR partition #2)
Enter an MBR hex code (default 07): 
Set the bootable flag? (Y/N): y
</pre>
<p>Note the MBR hex code depends on the partition type, press 'l' in gdisk's main menu to list them.
</p>
<p>Press 'o' (<b>make sure you are still in the recovery menu!!!</b>) again to see your new hybrid mbr, in my case:
</p>
<pre>Number  Boot  Start Sector   End Sector   Status      Code
  1                     1           39   primary     0xEE
  2      *             40       409639   primary     0x07
  3                409640    393186215   primary     0xAF
  4             393186216    625142414   primary     0x83
</pre>
<p>Or if you choose to only mirror the first one, it can also look like this:
</p>
<pre>Number  Boot  Start Sector   End Sector   Status      Code
  1                     1           39   primary     0xEE
  2      *             40       409639   primary     0xEF
</pre>
<p>Even if the mbr table looks like this (<i>note that in the second table only the last two lines are missing</i>), the bootloader will know what to boot.
You can compare start and end sectors between the two tables if you wish.
</p>
<p>Press 'w' to write the table to disk and reboot.
</p>
<h5><span class="mw-headline" id="Cannot_find_root_device">Cannot find root device</span></h5>
<p>If booting fails, first try to use the initramfs-linux-fallback.img, as it includes more modules than your "auto-detected" initramfs, and should allow the kernel to actually find your root partition.
You will then need to <a href="../en/Mkinitcpio.html#Image_creation_and_activation" class="mw-redirect" title="Regenerate the initramfs">regenerate the initramfs</a>. The whole booting process with the regular initramfs-linux should end up successfully, if not, then add the following configuration and rebuild the initramfs again: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">MODULES="ata_generic libata xfs"</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You will only need <code>xfs</code> if your root partition is actually formatted with it, exchange it with the appropriate module for the file-system you use.</div>
<p>Once you reboot, rEFInd should now present you with three options, two linux entries and one for osx. One linux entry will boot the kernel via efistub in <b>efi-mode</b>, the other will call syslinux(or your chosen bootloader) which then should boot the system in <b>csm-mode</b>. Do the latter from now on!
</p>
<p>The easiest way to see if you were successful, is to install the <a href="../en/NVIDIA.html" title="NVIDIA">NVIDIA</a> driver and start X.
</p>
<h2><span class="mw-headline" id="Network">Network</span></h2>
<p><a href="../en/Network_configuration/Wireless.html" class="mw-redirect" title="Wireless Setup">Wireless Setup</a> provides instructions on how to identify your card, but if your MacBook Pro 7,1 is like mine then you will head to <a href="../en/Broadcom_wireless.html" title="Broadcom wireless">Broadcom Wireless</a> and use this command.
</p>
<pre>$ lspci -vnn -d 14e4:
</pre>
<p>If from this you discover that your full PCI-ID is <code>[14e4:432b]</code>, then the following advice applies to you: Do not waste time on the <code>b43</code> driver. I have been fiddling with it for weeks, and switching to <code>broadcom-wl</code> made all the problems go away. <code>broadcom-wl</code> might make your device names funky, but that's easily fixed with the udev rule documented on <a href="../en/Broadcom_wireless.html" title="Broadcom wireless">Broadcom Wireless</a>.
</p>
<p>I also recommend <code>netctl</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Alternative solution for using b43:
<p>As of kernel version 3.17.1-2, Broadcom Wireless driver most likely will not work (ERROR @wl_cfg80211_scan :WLC_SCAN error (-22)). The only option seems to be loading the b43 driver in <a href="https://en.wikipedia.org/wiki/Programmed_input/output" class="extiw" title="wikipedia:Programmed input/output">PIO</a> mode. To enable PIO mode, install driver by following the guide at <a rel="nofollow" class="external text" href="https://wireless.wiki.kernel.org/en/users/drivers/b43">wireless.wiki.kernel.org</a>, then load the b43 kernel module with pio=1 and qos=0 parameters. To make this happen at boot, create <code>b43-firmware.conf</code> file in <code>/etc/modprobe.d/</code> and add the following lines:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">b43-firmware.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">options b43 pio=1 qos=0

blacklist wl
blacklist brcmsmac
blacklist brcmfmac
blacklist b43legacy
blacklist bcm43xx
blacklist brcm80211
</pre> 
<p><del>Although using PIO should be much slower than using <a href="https://en.wikipedia.org/wiki/Direct_memory_access" class="extiw" title="wikipedia:Direct memory access">DMA</a>, I have not noticed any performance drop.</del> Further testing showed repetitive occurrences of noticable performance drops. Mostly expressed as rapid decrease of transfer speed, sometimes even dropped connections. It also seems that b43 driver has issues operating at 5Ghz.
</p>
<p>Some later kernels are giving me more success (without PIO), but still some wifi drops have occurred.
</p>
</div>
<h2><span class="mw-headline" id="Video">Video</span></h2>
<p>According to the <a rel="nofollow" class="external text" href="https://support.apple.com/kb/SP583?locale=en_US">Apple Product Technical Specifications</a> the MacBook Pro 7,1 has an <a rel="nofollow" class="external text" href="https://web.archive.org/web/20161127112429/http://www.geforce.com/hardware/desktop-gpus/geforce-GT-320-OEM">NVIDIA GeForce GT 320M</a> in it.
</p>
<h3><span class="mw-headline" id="Nouveau">Nouveau</span></h3>
<p>Consult <a href="../en/Nouveau.html" title="Nouveau">Nouveau</a> for general info on the driver. Works out of the box, performance however is not that great and your system will get quite <i>hot</i> when running nouveau.
Will cause issues in electron based applications! Fix by adding --disable-gpu to the .shortcut!
</p>
<h3><span class="mw-headline" id="Nvidia">Nvidia</span></h3>
<p>Consult <a href="../en/NVIDIA.html" title="NVIDIA">NVIDIA</a> for general info on the driver. The drivers work out of the box when booting the mac in csm- or legacy-mode.
See <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=162289">here</a> for some discussion on the topic.
</p>
<p>Running the drivers in <b>efi-mode</b> requires setting some PCI registers before the kernel modules get loaded, preferably using a udev hook or GRUB script. You can also use a efi shell script in REFind as stated <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?pid=1833995#p1833995">here</a>. Otherwise, the screen just remains black when X starts. Follow these <a rel="nofollow" class="external text" href="https://askubuntu.com/questions/264247/proprietary-nvidia-drivers-with-efi-on-mac-to-prevent-overheating/613573#613573">instructions</a> in order to find the appropriate PCI device IDs for which to set the registers. This approach has been confirmed to work and is still being actively discussed inside the above mentioned <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?pid=1522950#p1522950">thread</a>. Updated EFI Shell boot method <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?pid=1910114#p1910114">here.</a> The latest NVIDIA drivers are no longer supported for this MacBook's GPU you will instead need to use these ones <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/nvidia-340xx-dkms/">nvidia-340xx-dkms</a></span><sup><small>AUR</small></sup>! Once installed create a config by running the command:
</p>
<pre># nvidia-xconfig
</pre>
<p>That will automatically generate a config for xorg (/etc/X11/xorg.conf). After that's done you will need to fix the fonts in your current DE/Window manager settings or by editing the xorg config!
</p>
<p>The NVIDIA binary driver does not support either simple display configuration switching or automatic monitor/display configuration on hotplug events, but this can be achieved by using autorandr and autorandr_launcher. Install autorandr first, and manually save each configuration as a profile.  autorandr_launcher can then be compiled and configured as a systemctl service.
<a rel="nofollow" class="external text" href="https://github.com/phillipberndt/autorandr">autorandr</a>
<a rel="nofollow" class="external text" href="https://github.com/smac89/autorandr-launcher">autorandr_launcher</a>
</p>
<h2><span class="mw-headline" id="Backlight_Control">Backlight Control</span></h2>
<p>When using Nvidia drivers, you can use <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/nvidia-bl-dkms/">nvidia-bl-dkms</a></span><sup><small>AUR</small></sup> to get controls in /sys/class/backlight/nvidia_backlight.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong>  <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/nvidia-bl-dkms/">nvidia-bl-dkms</a></span><sup><small>AUR</small></sup> does not build with kernel 5.x as of 14/3/2020, though <a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/nvidia-bl-dkms/#comment-823986">this comment</a> has a solution that fixes it on modern kernels (confirmed on 5.14.16-arch1-1) </div>
<p>You can also use <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xorg-xbacklight">xorg-xbacklight</a></span> which sets the xrandr Backlight property usually only available on intel hardware.
</p>
<h2><span class="mw-headline" id="Fan_control">Fan control</span></h2>
<p>For controlling the fans <a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">install</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/mbpfan-git/">mbpfan-git</a></span><sup><small>AUR</small></sup>, by default the fans always run really loud without this package, then <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">enable</a> <code>mbpfan.service</code>.
</p>
<h2><span class="mw-headline" id="Additional_Notes">Additional Notes</span></h2>
<p>For XFCE use cases:
</p>
<p>If you have issues with rebooting/power off function with XFCE power manager, add acpi=force to GRUB_CMDLINE_LINUX_DEFAULT in /etc/default/grub.
</p>
<p>Older versions of XFCE power manager will break backlight key handling if you select "handle display brightness keys" after installing nvidia driver (even after re-adding "RegistryDwords" "EnableBrightnessControl=1" to /usr/share/X11/xorg.conf.d/10-nvidia-brightness.conf)
</p>
<p>The PCI bridge values (prior to installing nvidia drivers) should be manually set in /etc/grub.d/01_enable_vga.conf
</p>
<p><a rel="nofollow" class="external text" href="https://askubuntu.com/questions/264247/proprietary-nvidia-drivers-with-efi-on-mac-to-prevent-overheating">Configuring PCI for installing NVIDIA drivers</a>
</p>
<p><a rel="nofollow" class="external text" href="https://askubuntu.com/questions/76081/brightness-not-working-after-installing-nvidia-driver">Enabling brightness function keys</a>
</p>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Apple.html" title="Category:Apple">Apple</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Merge.html" title="Category:Pages or sections flagged with Template:Merge">Pages or sections flagged with Template:Merge</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Laptop_style.html" title="Category:Pages or sections flagged with Template:Laptop style">Pages or sections flagged with Template:Laptop style</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=MacBookPro7,1&amp;oldid=791446">https://wiki.archlinux.org/index.php?title=MacBookPro7,1&amp;oldid=791446</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 29 October 2023, at 19:33.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
