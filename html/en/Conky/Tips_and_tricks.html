<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-zebra-design-disabled vector-feature-custom-font-size-clientpref-disabled vector-feature-client-preferences-disabled vector-feature-typography-survey-disabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Conky/Tips and tricks - ArchWiki</title>
<link rel="stylesheet" href="../../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.41.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Conky_Tips_and_tricks rootpage-Conky skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-main-menu-container">
		</div>
	<input type="checkbox" id="vector-toc-collapsed-checkbox" class="vector-menu-checkbox">
			<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark vector-sticky-pinned-container">
				<div id="vector-toc-pinned-container" class="vector-pinned-container">
				<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Display_package_update_information" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Display_package_update_information">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Display package update information</div>
		</a>
		
		<ul id="toc-Display_package_update_information-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-tail_text_files" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#tail_text_files">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>tail text files</div>
		</a>
		
		<ul id="toc-tail_text_files-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Display_weather_forecast" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Display_weather_forecast">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Display weather forecast</div>
		</a>
		
		<ul id="toc-Display_weather_forecast-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Display_a_countdown_timer" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Display_a_countdown_timer">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Display a countdown timer</div>
		</a>
		
		<ul id="toc-Display_a_countdown_timer-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Display_RSS_feeds" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Display_RSS_feeds">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Display RSS feeds</div>
		</a>
		
		<ul id="toc-Display_RSS_feeds-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Display_a_calendar_for_the_current_month" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Display_a_calendar_for_the_current_month">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>Display a calendar for the current month</div>
		</a>
		
		<ul id="toc-Display_a_calendar_for_the_current_month-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Display_rTorrent_stats" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Display_rTorrent_stats">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">7</span>Display rTorrent stats</div>
		</a>
		
		<ul id="toc-Display_rTorrent_stats-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Display_your_WordPress_blog_stats" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Display_your_WordPress_blog_stats">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">8</span>Display your WordPress blog stats</div>
		</a>
		
		<ul id="toc-Display_your_WordPress_blog_stats-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Display_number_of_new_emails" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Display_number_of_new_emails">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">9</span>Display number of new emails</div>
		</a>
		
			<button aria-controls="toc-Display_number_of_new_emails-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Display number of new emails subsection</span>
			</button>
		
		<ul id="toc-Display_number_of_new_emails-sublist" class="vector-toc-list">
			<li id="toc-Gmail" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Gmail">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">9.1</span>Gmail</div>
			</a>
			
			<ul id="toc-Gmail-sublist" class="vector-toc-list">
				<li id="toc-method_1" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#method_1">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">9.1.1</span>method 1</div>
			</a>
			
			<ul id="toc-method_1-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-method_2" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#method_2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">9.1.2</span>method 2</div>
			</a>
			
			<ul id="toc-method_2-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-method_3" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#method_3">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">9.1.3</span>method 3</div>
			</a>
			
			<ul id="toc-method_3-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-IMAP_+_SSL_using_Perl" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#IMAP_+_SSL_using_Perl">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">9.1.4</span>IMAP + SSL using Perl</div>
			</a>
			
			<ul id="toc-IMAP_+_SSL_using_Perl-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-IMAP_using_PHP" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#IMAP_using_PHP">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">9.1.5</span>IMAP using PHP</div>
			</a>
			
			<ul id="toc-IMAP_using_PHP-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Show_graphic_of_active_network_interface" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Show_graphic_of_active_network_interface">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">10</span>Show graphic of active network interface</div>
		</a>
		
		<ul id="toc-Show_graphic_of_active_network_interface-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-User-contributed_configuration_examples" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#User-contributed_configuration_examples">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">11</span>User-contributed configuration examples</div>
		</a>
		
		<ul id="toc-User-contributed_configuration_examples-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

				</div>
	</nav>
		
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<label id="vector-toc-collapsed-button" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet vector-button-flush-left cdx-button--icon-only" for="vector-toc-collapsed-checkbox" role="button" aria-controls="vector-toc" tabindex="0" title="Table of Contents">
						<span class="vector-icon mw-ui-icon-wikimedia-listBullet"></span>
						<span>Toggle the table of contents</span>
					</label>
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Conky/Tips and tricks</span></h1>
				</header>
				<div class="vector-column-end">
					<nav class="vector-page-tools-landmark vector-sticky-pinned-container" aria-label="Page tools">
						<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
			
						</div>
	</nav>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"><div class="subpages">&lt; <a href="../../en/Conky.html" title="Conky">Conky</a>
</div></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr">
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../../en/Conky.html" title="Conky">Conky</a></li>
</ul>
</div>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Display_package_update_information">Display package update information</span></h2>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pacman-contrib">pacman-contrib</a></span> provides a script called <code>checkupdates</code> which displays package updates from the official repos. Use <code>${execi 3600 checkupdates | wc -l}</code> to display the total number of packages.
</p>
<h2><span class="mw-headline" id="tail_text_files">tail text files</span></h2>
<p><i>conky</i> is able to <span class="plainlinks archwiki-template-man" title="$ man 1 conky"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/conky.1#tail">conky(1) § tail</a></span> files to your desktop, which is mostly useful for text files. Such as reading <code>/var/log/</code> files to display all kinds of log messages. Most of these files can only be read by <code>root</code>, but running <i>conky</i> as <code>root</code> is not recommended, so you will need to add yourself to the <code>log</code> <a href="../../en/Users_and_groups.html#Group_management" class="mw-redirect" title="User group">user group</a>. In addition, since <a href="../../en/Systemd.html" title="Systemd">systemd</a> log files are binary files, this feature is less useful then it used to be. However, it could be accomplished using <a href="../../en/Lua.html" title="Lua">lua</a> scripts.
</p>
<h2><span class="mw-headline" id="Display_weather_forecast">Display weather forecast</span></h2>
<p>It is achieved by reading external web pages, usually pages dedicated to weather forecast. See <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=37381">this thread</a>. Another weather script in lua: <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=222998">here</a>
</p>
<h2><span class="mw-headline" id="Display_a_countdown_timer">Display a countdown timer</span></h2>
<p><a rel="nofollow" class="external text" href="https://github.com/orschiro/scriptlets/tree/master/ConkyTimer">ConkyTimer</a> is a simple countdown timer that displays the remaining time of a defined task.
</p>
<p>Start the timer using <code>conkytimer "&lt;task description&gt;" &lt;min&gt;</code>.
</p>
<h2><span class="mw-headline" id="Display_RSS_feeds">Display RSS feeds</span></h2>
<p><i>Conky</i> has the ability to display RSS feeds natively without the need for an outside script to run and output into Conky. For example, to display the titles of the ten most recent Planet Arch updates and refresh the feed every minute, you would put this into your <code>conky.conf</code> in the <code>TEXT</code> section:
</p>
<pre>${rss <a rel="nofollow" class="external free" href="https://planet.archlinux.org/rss20.xml">https://planet.archlinux.org/rss20.xml</a> 300 item_titles 10 }
</pre>
<p>If you want to display Arch Forum rss feed, add this line:
</p>
<pre>${rss <a rel="nofollow" class="external free" href="https://bbs.archlinux.org/extern.php?action=feed&amp;type=rss">https://bbs.archlinux.org/extern.php?action=feed&amp;type=rss</a> 300 item_titles 4}
</pre>
<p>where 300 is in seconds the refresh interval (15 minutes is default), 4 the number of items you wish to show.
</p>
<h2><span class="mw-headline" id="Display_a_calendar_for_the_current_month">Display a calendar for the current month</span></h2>
<p>You can use the following lua script to display a calendar. It uses <code>color1</code> and the default color from your configuration. It looks best with a monospace font.
</p>
<pre> #!/usr/bin/env lua
 
 conky_color = "${color1}%2d${color}"
 
 t = os.date('*t', os.time())
 year, month, currentday = t.year, t.month, t.day
 
 daystart = os.date("*t",os.time{year=year,month=month,day=01}).wday
 
 month_name = os.date("%B")
 
 days_in_month = {
     31, 28, 31, 30, 31, 30, 
     31, 31, 30, 31, 30, 31
 }
 
 -- check for leap year
 -- Any year that is evenly divisible by 4 is a leap year
 -- Any year that is evenly divisible by 100 is a leap year if
 -- it is also evenly divisible by 400.
 LeapYear = function (year)
     return year % 4 == 0 and (year % 100 ~= 0 or year % 400 == 0)
 end
 
 if LeapYear(year) then
     days_in_month[2] = 29
 end
 
 title_start = (20 - (string.len(month_name) + 5)) / 2
 
 title = string.rep(" ", math.floor(title_start+0.5)) .. -- add padding to center the title
         (" %s %s\n Su Mo Tu We Th Fr Sa\n"):format(month_name, year)
 
 io.write(title)
 
 function seq(a,b)
     if a &gt; b then
         return
     else
         return a, seq(a+1,b)
     end 
 end
 
 days = days_in_month[month]
 
 io.write(
     string.format(
         string.rep("   ", daystart-1) ..
         string.rep(" %2d", days), seq(1,days)
     ):gsub(string.rep(".",21),"%0\n")
      :gsub(("%2d"):format(currentday),
            (conky_color):format(currentday)
      ) .. "\n"
 )
</pre>
<p>Inside your <code>conky.conf</code> you can then place the following, making sure the path matches where you saved the script.
</p>
<pre> conky.text = [[
 ${execpi 3600 ~/.config/conky/cal.lua}
 ]]
</pre>
<h2><span class="mw-headline" id="Display_rTorrent_stats">Display rTorrent stats</span></h2>
<p>See <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=67304">this thread</a>.
</p>
<h2><span class="mw-headline" id="Display_your_WordPress_blog_stats">Display your WordPress blog stats</span></h2>
<p>This can be achieved by using the in python written extension named <a rel="nofollow" class="external text" href="https://evilshit.wordpress.com/2013/04/20/conkypress-a-wordpress-stats-visualization-tool-for-your-desktop/">ConkyPress</a>.
</p>
<h2><span class="mw-headline" id="Display_number_of_new_emails">Display number of new emails</span></h2>
<p>Conky has built in support for IMAP and POP3, but does not have support for access over ssl. Conky's FAQ recommends using <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=stunnel">stunnel</a></span> for this and has an example configuration <a rel="nofollow" class="external text" href="https://conky.sourceforge.net/faq.html#Conky's-built-in-IMAP-and-POP3-doesn't-support-SSL-or-TLS/">here</a>.
</p>
<p>Modify <code>/etc/stunnel/stunnel.conf</code> as follows, and then <a href="../../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start">start</a> <code>stunnel.service</code>:
</p>
<ol><li>Service-level configuration for TLS server</li></ol>
<pre>[imap]
client = yes
accept  = 143
connect = imap.gmail.com:143
protocol = imap
sslVersion = TLSv1
# Service-level configuration for SSL server
[imaps]
client = yes
accept  = 993
connect = imap.gmail.com:993
</pre>
<p>Then add the following to <code>conky.conf</code>:
</p>
<pre>conky.config = {
    imap = "localhost username password [-i 120] [-f 'inbox'] [-p 993]",
}
</pre>
<pre>conky.text {
    Inbox: ${imap_unseen}/${imap_messages}
}
</pre>
<h3><span class="mw-headline" id="Gmail">Gmail</span></h3>
<p>If you use 2-factor authentication, you need to use an <a rel="nofollow" class="external text" href="https://myaccount.google.com/apppasswords">App Password</a>.
</p>
<p>For method 1, 2 and 3:
</p>
<p>Create one of the following files in a convenient location (for example in <code>~/.scripts/</code>).
</p>
<p>Then add the following string to your <code>conky.conf</code> in order the check your Gmail account for new email every five minutes (300 seconds) and display:
</p>
<pre>${execi 300 python ~/.scripts/gmail.py}
</pre>
<h4><span class="mw-headline" id="method_1">method 1</span></h4>
<p>This script uses retrieves the number of new email via Gmail's Atom API.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">gmail.py</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/usr/bin/env python3

import urllib.request

email = 'your email'
password = 'your password'

# Set up authentication for gmail
auth_handler = urllib.request.HTTPBasicAuthHandler()
auth_handler.add_password(realm='mail.google.com',
                          uri='https://mail.google.com/',
                          user=email,
                          passwd=password)
opener = urllib.request.build_opener(auth_handler)
# ...and install it globally so it can be used with urlopen.
urllib.request.install_opener(opener)

gmailurl = 'https://mail.google.com/gmail/feed/atom'
with urllib.request.urlopen(gmailurl) as page:
    contents = page.read().decode('utf-8')

ifrom = contents.index('&lt;fullcount&gt;') + 11
ito   = contents.index('&lt;/fullcount&gt;')

fullcount = contents[ifrom:ito]

print('{} new emails'.format(fullcount))

</pre>
<h4><span class="mw-headline" id="method_2">method 2</span></h4>
<p>Same as method 1, but does proper XML parsing.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">gmail.py</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/usr/bin/env python3

import urllib.request
from xml.etree import ElementTree as etree

email = 'your email'
password = 'your password'

# Set up authentication for gmail
auth_handler = urllib.request.HTTPBasicAuthHandler()
auth_handler.add_password(realm='mail.google.com',
                          uri='https://mail.google.com/',
                          user=email,
                          passwd=password)
opener = urllib.request.build_opener(auth_handler)
# ...and install it globally so it can be used with urlopen.
urllib.request.install_opener(opener)

gmailurl = 'https://mail.google.com/gmail/feed/atom'
NS = '{http://purl.org/atom/ns#}'
with urllib.request.urlopen(gmailurl) as source:
    tree = etree.parse(source)
fullcount = tree.find(NS + 'fullcount').text

print('{} new emails'.format(fullcount))
</pre>
<h4><span class="mw-headline" id="method_3">method 3</span></h4>
<p>The same way, but with using <code>curl</code>, <code>grep</code> and <code>sed</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">gmail.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/usr/bin/sh

curl -s -u <b>email</b>:<b>password</b> https://mail.google.com/mail/feed/atom | grep fullcount | sed 's/&lt;[^0-9]*&gt;//g'
</pre>
<p>replace <i>email</i> and <i>password</i> with your data.
</p>
<h4>
<span id="IMAP_.2B_SSL_using_Perl"></span><span class="mw-headline" id="IMAP_+_SSL_using_Perl">IMAP + SSL using Perl</span>
</h4>
<p><i>Conky</i> has built in support for IMAP accounts but does not support SSL. This can be provided using this script from <a rel="nofollow" class="external text" href="https://www.unix.com/shell-programming-scripting/115322-perl-conky-gmail-imap-unread-message-count.html">this forum post</a>. This requires the Perl/CPAN Modules Mail::IMAPClient and IO::Socket::SSL which are in the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=perl-mail-imapclient">perl-mail-imapclient</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=perl-io-socket-ssl">perl-io-socket-ssl</a></span> packages
</p>
<p>Create a file named <code>imap.pl</code> in a location to be read by <i>conky</i> (for example in <code>~/.scripts/</code>). In this file, add (with the appropriate changes):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">imap.pl</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/usr/bin/perl
 
# by gxmsgx
# description: get the count of unread messages on imap

use strict;
use Mail::IMAPClient;
use IO::Socket::SSL;

my $username = 'example.username'; 
my $password = 'password123'; 

my $socket = IO::Socket::SSL-&gt;new(
  PeerAddr =&gt; 'imap.server',
  PeerPort =&gt; 993
 )
 or die "socket(): $@";
 
my $client = Mail::IMAPClient-&gt;new(
  Socket   =&gt; $socket,
  User     =&gt; $username,
  Password =&gt; $password,
 )
 or die "new(): $@";
 
if ($client-&gt;IsAuthenticated()) {
  my $msgct;

  $client-&gt;select("INBOX");
  $msgct = $client-&gt;unseen_count||'0';
  print "$msgct\n";
}

$client-&gt;logout();
</pre>
<p>Add to <code>conky.conf</code>:
</p>
<pre>${execi 300 ~/.scripts/imap.pl} 
</pre>
<p>or wherever you saved the file.
</p>
<p>If you use Gmail you might need to <a rel="nofollow" class="external text" href="https://www.google.com/accounts/IssuedAuthSubTokens?hide_authsub=1">generate</a> an application specific password.
</p>
<p>Alternatively, you can use stunnel as shown above: <a href="#Gmail">#Gmail</a>
</p>
<h4><span class="mw-headline" id="IMAP_using_PHP">IMAP using PHP</span></h4>
<p>Another alternative using PHP. PHP needs to be installed and <code>extension=imap</code> must be uncommented in <code>/etc/php/php.ini</code>.
</p>
<p>Then create a file named <code>imap.php</code> in a location to be read by <i>conky</i> (for example in <code>~/.scripts/</code>). Make the file <a href="../../en/Help:Reading.html#Make_executable" class="mw-redirect" title="Executable">executable</a>. 
</p>
<p>In this file, add (with the appropriate changes):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">imap.php</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/usr/bin/php
&lt;?php
// See http://php.net/manual/function.imap-open.php for more information about
// the mailbox string in the first parameter of imap_open.
// This example is ready to use with Office 365 Exchange Mails,
// just replace your username (=email address) and the password.
$mbox = imap_open("{outlook.office365.com:993/imap/ssl/novalidate-cert}", "username", "password");

// Total number of emails
$nrTotal = imap_num_msg($mbox);
 
// Number of unseen emails. There are other ways using imap_status to count
// unseen messages, but they don't work with Office 365 Exchange. This one does.
$unseen = imap_search($mbox, 'UNSEEN');
$nrUnseen = $unseen ? count($unseen) : 0;
 
// Display the result, format as you like.
echo $nrUnseen.'/'.$nrTotal;
 
// Not needed, because the connection is closed after the script end.
// For the sake of clean public available scripts, we are nice to
// the imap server and close the connection manually.
imap_close($mbox);
</pre>
<p>Add to <code>conky.conf</code>:
</p>
<pre>${execi 300 ~/.scripts/imap.php} 
</pre>
<p>or wherever you saved the file.
</p>
<p>This script displays A/B where A is the number of unseen emails and B is the total number of mails in the mailbox. There are a lot of other information available through a lot of PHP functions like with imap_Status (<a rel="nofollow" class="external free" href="https://php.net/manual/function.imap-status.php">https://php.net/manual/function.imap-status.php</a>). Just see the PHP docs about IMAP: <a rel="nofollow" class="external free" href="https://php.net/manual/ref.imap.php">https://php.net/manual/ref.imap.php</a>.
</p>
<h2><span class="mw-headline" id="Show_graphic_of_active_network_interface">Show graphic of active network interface</span></h2>
<p>To test if a network inferface is currently active, you can use the test conky variable <code> if_existing</code> on the <code> operstate</code> of the interface. Here is an example for wlo1 :
</p>
<pre>draw_graph_borders yes 
${if_existing /sys/class/net/wlo1/operstate up}
${color #0077ff}Net Down:$color ${downspeed wlo1}      ${color #0077ff}Net Up:$color ${upspeed wlo1}
${color #0077ff}${downspeedgraph wlo1 32,155 104E8B 0077ff} $alignr${color #0077ff}${upspeedgraph wlo1 32,155 104E8B 0077ff}
${endif}
</pre>
<p>This is the expected result :
</p>
<p><a rel="nofollow" class="external free" href="https://i.imgur.com/pQQbsP6.png">https://i.imgur.com/pQQbsP6.png</a>
</p>
<h2><span class="mw-headline" id="User-contributed_configuration_examples">User-contributed configuration examples</span></h2>
<ul><li>A sample rings script with nvidia support - <a rel="nofollow" class="external text" href="https://gist.github.com/anonymous/85d052c0c23e58bc3666">gist</a>
</li></ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../../en/Category:System_monitors.html" title="Category:System monitors">System monitors</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Conky/Tips_and_tricks&amp;oldid=757890">https://wiki.archlinux.org/index.php?title=Conky/Tips_and_tricks&amp;oldid=757890</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 24 November 2022, at 11:38.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
