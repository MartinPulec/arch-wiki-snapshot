<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>SCP and SFTP - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.43.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-SCP_and_SFTP rootpage-SCP_and_SFTP skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Secure_file_transfer_protocol_(SFTP)" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Secure_file_transfer_protocol_(SFTP)">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Secure file transfer protocol (SFTP)</span>
			</div>
		</a>
		
		<ul id="toc-Secure_file_transfer_protocol_(SFTP)-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Secure_file_transfer_protocol_(SFTP)_with_a_chroot_jail" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Secure_file_transfer_protocol_(SFTP)_with_a_chroot_jail">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Secure file transfer protocol (SFTP) with a chroot jail</span>
			</div>
		</a>
		
			<button aria-controls="toc-Secure_file_transfer_protocol_(SFTP)_with_a_chroot_jail-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Secure file transfer protocol (SFTP) with a chroot jail subsection</span>
			</button>
		
		<ul id="toc-Secure_file_transfer_protocol_(SFTP)_with_a_chroot_jail-sublist" class="vector-toc-list">
			<li id="toc-Setup_the_filesystem" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Setup_the_filesystem">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1</span>
					<span>Setup the filesystem</span>
				</div>
			</a>
			
			<ul id="toc-Setup_the_filesystem-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Create_an_unprivileged_user" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Create_an_unprivileged_user">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2</span>
					<span>Create an unprivileged user</span>
				</div>
			</a>
			
			<ul id="toc-Create_an_unprivileged_user-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Setup_OpenSSH" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Setup_OpenSSH">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.3</span>
					<span>Setup OpenSSH</span>
				</div>
			</a>
			
			<ul id="toc-Setup_OpenSSH-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Secure_copy_protocol_(SCP)" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Secure_copy_protocol_(SCP)">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Secure copy protocol (SCP)</span>
			</div>
		</a>
		
			<button aria-controls="toc-Secure_copy_protocol_(SCP)-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Secure copy protocol (SCP) subsection</span>
			</button>
		
		<ul id="toc-Secure_copy_protocol_(SCP)-sublist" class="vector-toc-list">
			<li id="toc-General_Usage" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#General_Usage">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1</span>
					<span>General Usage</span>
				</div>
			</a>
			
			<ul id="toc-General_Usage-sublist" class="vector-toc-list">
				<li id="toc-Linux_to_Linux" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Linux_to_Linux">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1.1</span>
					<span>Linux to Linux</span>
				</div>
			</a>
			
			<ul id="toc-Linux_to_Linux-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Linux_to_Windows" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Linux_to_Windows">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1.2</span>
					<span>Linux to Windows</span>
				</div>
			</a>
			
			<ul id="toc-Linux_to_Windows-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Scponly" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Scponly">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2</span>
					<span>Scponly</span>
				</div>
			</a>
			
			<ul id="toc-Scponly-sublist" class="vector-toc-list">
				<li id="toc-Adding_a_chroot_jail" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Adding_a_chroot_jail">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.1</span>
					<span>Adding a chroot jail</span>
				</div>
			</a>
			
			<ul id="toc-Adding_a_chroot_jail-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Uploads_to_Chroot_jail_root_dir" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Uploads_to_Chroot_jail_root_dir">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.2</span>
					<span>Uploads to Chroot jail root dir</span>
				</div>
			</a>
			
			<ul id="toc-Uploads_to_Chroot_jail_root_dir-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">SCP and SFTP</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 2 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-2" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">2 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/SCP_%E3%81%A8_SFTP" title="SCP と SFTP – 日本語" lang="ja" hreflang="ja" data-title="SCP と SFTP" data-language-autonym="日本語" data-language-local-name="日本語" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/SCP_%E4%B8%8E_SFTP" title="SCP 与 SFTP – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" data-title="SCP 与 SFTP" data-language-autonym="中文（简体）" data-language-local-name="中文（简体）" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="archwiki-template-meta-related-articles">
<p>Related articles</p>
<ul>
<li><a href="../en/SSHFS.html" title="SSHFS">SSHFS</a></li>
<li><a href="../en/SFTP_chroot.html" title="SFTP chroot">SFTP chroot</a></li>
<li><a href="../en/Pure-FTPd.html" title="Pure-FTPd">Pure-FTPd</a></li>
</ul>
</div>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Merge-arrows-2.svg" decoding="async" width="36" height="40" class="mw-file-element"></span></span><b>This article or section is a candidate for merging with <a href="../en/SFTP_chroot.html" title="SFTP chroot">SFTP chroot</a>.</b></p>
<div>
<b>Notes:</b> Instructions seem to be the same as in <a href="../en/SFTP_chroot.html" title="SFTP chroot">SFTP chroot</a> and has more content. (Discuss in <a href="../en/Talk:SCP_and_SFTP.html#Incorrect_'Considered_for_redirection'_banner?" title="Talk:SCP and SFTP">Talk:SCP and SFTP#Incorrect 'Considered for redirection' banner?</a>)</div>
</div>
<p>The <a href="https://en.wikipedia.org/wiki/Secure_copy" class="extiw" title="wikipedia:Secure copy">Secure copy (SCP)</a> is a protocol to transfer files via a <a href="../en/Secure_Shell.html" title="Secure Shell">Secure Shell</a> connection. The <a href="https://en.wikipedia.org/wiki/SSH_file_transfer_protocol" class="extiw" title="wikipedia:SSH file transfer protocol">SSH file transfer protocol (SFTP)</a> is a related protocol, also relying on a secure shell back-end. Both protocols allow secure file transfers, encrypting passwords and transferred data. The SFTP protocol, however, features additional capabilities like, for example, resuming broken transfers or remote file manipulation like deletion.
</p>
<meta property="mw:PageProp/toc">
<h2>
<span id="Secure_file_transfer_protocol_.28SFTP.29"></span><span class="mw-headline" id="Secure_file_transfer_protocol_(SFTP)">Secure file transfer protocol (SFTP)</span>
</h2>
<p>Install and configure <a href="../en/OpenSSH.html" title="OpenSSH">OpenSSH</a>. Once running, SFTP is available by default.
</p>
<p>Access files with the <i>sftp</i> program or <a href="../en/SSHFS.html" title="SSHFS">SSHFS</a>. Many standard FTP programs should work as well.
</p>
<h2>
<span id="Secure_file_transfer_protocol_.28SFTP.29_with_a_chroot_jail"></span><span class="mw-headline" id="Secure_file_transfer_protocol_(SFTP)_with_a_chroot_jail">Secure file transfer protocol (SFTP) with a chroot jail</span>
</h2>
<p>Sysadmins can jail a subset of users to a chroot jail using <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=openssh">openssh</a></span> thus restricting their access to a particular directory tree.  This can be useful to simply share some files without granting full system access or shell access.  Users with this type of setup may use SFTP clients such as <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=filezilla">filezilla</a></span> to put/get files in the chroot jail.
</p>
<h3><span class="mw-headline" id="Setup_the_filesystem">Setup the filesystem</span></h3>
<p>Create a jail directory:
</p>
<pre># mkdir -p /var/lib/jail
</pre>
<p>Optionally, bind mount the filesystem to be shared to this directory. In this example, <code>/mnt/data/share</code> is to be used.  It is owned by root and has octal permissions of 755.
</p>
<pre># mount -o bind /mnt/data/share /var/lib/jail
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> Consider adding an entry to <code>/etc/fstab</code> to make the bind mount survive a reboot.</div>
<h3><span class="mw-headline" id="Create_an_unprivileged_user">Create an unprivileged user</span></h3>
<p>Create the share user and setup a good password:
</p>
<pre># useradd -g sshusers -d /var/lib/jail foo
# passwd foo
</pre>
<h3><span class="mw-headline" id="Setup_OpenSSH">Setup OpenSSH</span></h3>
<p>Add the following to the end of <code>/etc/ssh/sshd_config</code> to enable the share and to enforce the restrictions:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ssh/sshd_config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
 Match group sshusers
  ChrootDirectory %h
  X11Forwarding no
  AllowTcpForwarding no
  PasswordAuthentication yes
  ForceCommand internal-sftp
</pre>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Restart">Restart</a> <code>sshd.service</code> to re-read the configuration file. See <a href="../en/SFTP_chroot.html" title="SFTP chroot">SFTP chroot</a> to configure the keys correctly when using chroot or it will get permission denied.
</p>
<p>Test that in fact, the restrictions are enforced by attempting an ssh connection via the shell. The ssh server should return a polite notice of the setup:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ ssh foo@someserver.com</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">foo@someserver.com's password:
This service allows sftp connections only.
Connection to someserver.com closed.
</pre>
<h2>
<span id="Secure_copy_protocol_.28SCP.29"></span><span class="mw-headline" id="Secure_copy_protocol_(SCP)">Secure copy protocol (SCP)</span>
</h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a>, configure and <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start">start</a> <a href="../en/OpenSSH.html" title="OpenSSH">OpenSSH</a>. It contains the <i>scp</i> utility to transfer files.
</p>
<p>More features are available by installing additional packages, for example <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/rssh/">rssh</a></span><sup><small>AUR</small></sup> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=scponly">scponly</a></span> described below.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Since OpenSSH 9.0 the <i>scp</i> utility uses the SFTP protocol by default. The <code>-O</code> option must be used to use the legacy SCP protocol.</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> The scp protocol is outdated, inflexible and not readily fixed. Its authors recommend the use of more modern protocols like sftp and rsync for file transfer instead.<a rel="nofollow" class="external autonumber" href="https://lists.mindrot.org/pipermail/openssh-unix-dev/2019-March/037672.html">[1]</a>
</div>
<h3><span class="mw-headline" id="General_Usage">General Usage</span></h3>
<h4><span class="mw-headline" id="Linux_to_Linux">Linux to Linux</span></h4>
<p>Copy file from a remote host to local host SCP example:
</p>
<pre>$ scp username@from_host:file.txt /local/directory/
</pre>
<p>Copy file from local host to a remote host SCP example:
</p>
<pre>$ scp file.txt username@to_host:/remote/directory/
</pre>
<p>Copy directory from a remote host to local host SCP example:
</p>
<pre>$ scp -r username@from_host:/remote/directory/  /local/directory/
</pre>
<p>Copy directory from local host to a remote host SCP example:
</p>
<pre>$ scp -r /local/directory/ username@to_host:/remote/directory/
</pre>
<p>Copy file from remote host to remote host SCP example:
</p>
<pre>$ scp username@from_host:/remote/directory/file.txt username@to_host:/remote/directory/
</pre>
<h4><span class="mw-headline" id="Linux_to_Windows">Linux to Windows</span></h4>
<p>Use a Windows program such as <a rel="nofollow" class="external text" href="https://winscp.net/eng/download.php">WinSCP</a>
</p>
<h3><span class="mw-headline" id="Scponly">Scponly</span></h3>
<p><a rel="nofollow" class="external text" href="https://github.com/scponly/scponly/wiki">Scponly</a> is a limited shell for allowing users scp/sftp access and only scp/sftp access. Additionally, one can setup <i>scponly</i> to chroot the user into a particular directory increasing the level of security. 
</p>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">install</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=scponly">scponly</a></span>. 
</p>
<p>For existing users, simply set the user's shell to scponly:
</p>
<pre># usermod -s /usr/bin/scponly <i>username</i>
</pre>
<h4><span class="mw-headline" id="Adding_a_chroot_jail">Adding a chroot jail</span></h4>
<p>The package comes with a script to create a chroot. To use it, run: 
</p>
<pre># /usr/share/doc/scponly/setup_chroot.sh
</pre>
<ul>
<li>Provide answers</li>
<li>Check that <code>/path/to/chroot</code> has <code>root:root</code> owner and <code>r-x</code> for others</li>
<li>Change the shell for selected user to <code>/usr/bin/scponlyc</code>
</li>
<li>sftp-server may require some libnss modules such as libnss_files. Copy them to chroot's <code>/lib</code> path.</li>
</ul>
<h4><span class="mw-headline" id="Uploads_to_Chroot_jail_root_dir">Uploads to Chroot jail root dir</span></h4>
<p>For security reasons the directory set as the chroot directory must be owned by root with only root having write access to it otherwise sftp/ssh connections will be denied. This of course means regular users cannot upload files to the root directory. In order to get around this while not compromising security you can create a folder inside the chroot directory which the regular user or group has write access to, e.g:
</p>
<pre># cd /var/lib/jail
# mkdir uploads
# chown :sshusers uploads
# chmod 730 uploads
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This will only allow users of group "sshusers" to upload to (but not list the contents of) the "uploads" directory. Use <code>chmod 770</code> to allow sshusers to view contents.</div>
<p>Some applications utilizing SFTP do not allow input of sub-directories when performing operations (e.g. uploading files), and will attempt to upload files to the chroot base directory (which will be denied). In order to force these applications to use a specific sub-directory you can append the following to the "ForceCommand" option:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ssh/sshd_config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
 Match group sshusers
  ...
  ForceCommand internal-sftp -d /uploads
</pre>
<p>Users on connect will then have their start directory change to the specified sub-directory (remember to restart the sshd server).
</p>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Secure_Shell.html" title="Category:Secure Shell">Secure Shell</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Merge.html" title="Category:Pages or sections flagged with Template:Merge">Pages or sections flagged with Template:Merge</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=SCP_and_SFTP&amp;oldid=834356">https://wiki.archlinux.org/index.php?title=SCP_and_SFTP&amp;oldid=834356</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 23 May 2025, at 10:20.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki.svg" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul></ul>
</div>
</body>
</html>
