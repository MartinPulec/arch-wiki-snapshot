<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Offline installation - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Offline_installation rootpage-Offline_installation skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Prepare_local_repository" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Prepare_local_repository">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Prepare local repository</div>
		</a>
		
		<ul id="toc-Prepare_local_repository-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Mount_and_configure" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Mount_and_configure">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Mount and configure</div>
		</a>
		
		<ul id="toc-Mount_and_configure-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Pacstrap" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Pacstrap">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Pacstrap</div>
		</a>
		
		<ul id="toc-Pacstrap-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Offline_installation_of_packages" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Offline_installation_of_packages">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Offline installation of packages</div>
		</a>
		
			<button aria-controls="toc-Offline_installation_of_packages-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Offline installation of packages subsection</span>
			</button>
		
		<ul id="toc-Offline_installation_of_packages-sublist" class="vector-toc-list">
			<li id="toc-Install_from_file" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Install_from_file">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>Install from file</div>
			</a>
			
			<ul id="toc-Install_from_file-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Offline_cache" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Offline_cache">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2</span>Offline cache</div>
			</a>
			
			<ul id="toc-Offline_cache-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Local_repository" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Local_repository">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.3</span>Local repository</div>
			</a>
			
			<ul id="toc-Local_repository-sublist" class="vector-toc-list">
				<li id="toc-Complete_repository" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Complete_repository">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.3.1</span>Complete repository</div>
			</a>
			
			<ul id="toc-Complete_repository-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-See_also" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>See also</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Offline installation</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 5 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-5" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">5 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-cs mw-list-item"><a href="../cs/Offline_installation.html" title="Offline installation – čeština" lang="cs" hreflang="cs" class="interlanguage-link-target"><span>Čeština</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/%E3%82%AA%E3%83%95%E3%83%A9%E3%82%A4%E3%83%B3%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB" title="オフラインインストール – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-pt mw-list-item"><a href="../pt/Offline_installation.html" title="Offline installation – português" lang="pt" hreflang="pt" class="interlanguage-link-target"><span>Português</span></a></li>
<li class="interlanguage-link interwiki-ru mw-list-item"><a href="../ru/Offline_installation.html" title="Offline installation – русский" lang="ru" hreflang="ru" class="interlanguage-link-target"><span>Русский</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/Offline_installation" title="Offline installation – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<p>This article provides instructions on installing Arch Linux on a system without an Internet connection. To do this, another system with a working Internet connection is required.
</p>
<p>First, follow the <a href="../en/Installation_guide.html" title="Installation guide">Installation guide</a>, skipping the <a href="../en/Installation_guide.html#Connect_to_the_internet" title="Installation guide">Installation guide#Connect to the internet</a> section, until the <a href="../en/Installation_guide.html#Install_essential_packages" title="Installation guide">Installation guide#Install essential packages</a> step.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Extracting the root file system image (<code>airootfs.sfs</code>) from the ISO or copying the live environment's root file system is not a supported installation method.</div>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Prepare_local_repository">Prepare local repository</span></h2>
<p>Follow <a href="../en/Pacman/Tips_and_tricks.html#Installing_packages_from_a_CD/DVD_or_USB_stick" title="Pacman/Tips and tricks">Pacman/Tips and tricks#Installing packages from a CD/DVD or USB stick</a> for instructions on preparing a local repository with the necessary files on a separate host installation.
</p>
<p>At the very least, for a functioning system, the following packages are recommended:
</p>
<pre># pacman -Syw --cachedir . --dbpath /tmp/blankdb base base-devel linux linux-firmware mkinitcpio vim
</pre>
<p>Create your custom offline repository:
</p>
<pre># repo-add ./custom.db.tar.zst ./*[^sig]
</pre>
<h2><span class="mw-headline" id="Mount_and_configure">Mount and configure</span></h2>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../File:Tango-view-fullscreen.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs expansion.</b></p>
<div>
<b>Reason:</b> Add optional instructions on placing the custom repo in the ISO. (Discuss in <a rel="nofollow" class="external text" href="../en/Talk:Offline_installation.html">Talk:Offline installation</a>)</div>
</div>
<p>Once the repository is prepared, connect the external media to the new installation, and mount it on the newly created root filesystem:
</p>
<pre># mount --mkdir /dev/sd<i>xy</i> /mnt/repo
</pre>
<p>Edit your archiso <code>/etc/pacman.conf</code> and add a new section:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pacman.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[custom]
SigLevel = Optional
Server = file:///mnt/repo/</pre>
<p>Comment out <code>[core]</code> and <code>[extra]</code> so that <i>pacman</i> does not fail on the default repositories.
</p>
<h2><span class="mw-headline" id="Pacstrap">Pacstrap</span></h2>
<p>You can now continue to <i>pacstrap</i> your locally-available packages to the new installation:
</p>
<pre># pacstrap -K /mnt base base-devel linux linux-firmware mkinitcpio vim
</pre>
<h2><span class="mw-headline" id="Offline_installation_of_packages">Offline installation of packages</span></h2>
<h3><span class="mw-headline" id="Install_from_file">Install from file</span></h3>
<p>In case the offline installation process was only temporary, but requires manual installation of some packages before being able to access a network, see <a href="../en/Pacman.html#Additional_commands" title="Pacman">pacman#Additional commands</a> to learn how to install local packages. 
</p>
<p><a href="../en/Command-line_shell.html" class="mw-redirect" title="Shell">Shell</a> <a href="https://en.wikipedia.org/wiki/Glob_(programming)" class="extiw" title="wikipedia:Glob (programming)">globbing</a> can be used to install many packages at once: 
</p>
<pre># pacman -U <i>/package/folder/</i>*.tar.zst
</pre>
<h3><span class="mw-headline" id="Offline_cache">Offline cache</span></h3>
<p>You can put the required files into <code>/var/lib/pacman/sync</code> and <code>/var/cache/pacman/pkg</code>, so as to make <code>pacman</code> think it has everything it needs to do searches, updates, and installs. The following method is based on two forum threads: <a rel="nofollow" class="external autonumber" href="https://bbs.archlinux.org/viewtopic.php?pid=463238#p463238">[1]</a><a rel="nofollow" class="external autonumber" href="https://bbs.archlinux.org/viewtopic.php?id=30431">[2]</a>.
</p>
<p>The steps are:
</p>
<ol>
<li>downloading the up to date package databases on a computer with internet access,</li>
<li>transferring them to the offline computer,</li>
<li>generating the list of packages required from the offline computer to update it,</li>
<li>downloading them with their signature on a computer with internet access,</li>
<li>transferring them to the <i>pacman</i> cache of the offline computer,</li>
<li>installing the updates.</li>
</ol>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> If you changed your default repositories from the defaults (core, extra and multilib), you should review your <code>/etc/pacman.conf</code> file.</div>
<p>The following script will download the updated package databases. If needed, change <code>MIRROR</code> to any mirror from the <a rel="nofollow" class="external text" href="https://archlinux.org/mirrors/status/">mirror status list</a>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">download_databases.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh

ARCH="x86_64"
MIRROR="https://mirrors.kernel.org/archlinux/"

wget "${MIRROR}/core/os/${ARCH}/core.db"
wget "${MIRROR}/extra/os/${ARCH}/extra.db"
wget "${MIRROR}/multilib/os/${ARCH}/multilib.db"

# and possibly -uncomment- (if customized in /etc/pacman.conf or pacman.conf.d):

#wget "${MIRROR}/core-testing/os/${ARCH}/core-testing.db"
#wget "${MIRROR}/extra-testing/os/${ARCH}/extra-testing.db"
#wget "${MIRROR}/multilib-testing/os/${ARCH}/multilib-testing.db"

# and -additionally- debug and staging packages.</pre>
<p>Make the script <a href="../en/Help:Reading.html#Make_executable" class="mw-redirect" title="Executable">executable</a> and run it. You will obtain multiple <i>.db</i> files. 
</p>
<p>The following steps will be transferring the <i>.db</i> files to the offline PC, making it so you are working with up-to-date package lists (as if you ran <code>pacman -Sy</code>), then generating a list of package required for the update: 
</p>
<pre># cp *.db /var/lib/pacman/sync/
# pacman -Sup --noconfirm &gt; pkglist
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Make sure that you have enabled at least one of the servers defined in the <code>/etc/pacman.d/mirrorlist</code> file. Otherwise, all what you get is a misleading error message: <code>error: no database for package: <i>package-name</i></code>.</div>
<p>You will also need to download the corresponding package signatures, so prepare the list of signatures to download:
</p>
<pre># sed -e 's/\.zst$/.zst.sig/' ../pkglist &gt; ../siglist
</pre>
<p>Next, bring the two lists with you to a place where you have internet and download the listed packages in an empty directory:
</p>
<pre># wget -nv -i ../pkglist
# wget -nv -i ../siglist
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> When using <a rel="nofollow" class="external text" href="https://www.cygwin.com">cygwin</a> or some other kind of Windows environment to download the packages, the filenames will get mangled since default Windows file naming requires to escape e.g. colons. To avoid this (under cygwin, since it does not follow such restrictions), use <code>wget --restrict-file-names=unix</code>.</div>
<p>Take all the <code>*.pkg.tar.zst</code> and <code>*.pkg.tar.zst.sig</code> files back home, put them in <code>/var/cache/pacman/pkg</code> and finally run:
</p>
<pre># pacman -Su
</pre>
<h3><span class="mw-headline" id="Local_repository">Local repository</span></h3>
<p>In case the new system is expected to remain offline or airgapped, it should be configured to expect only local repositories. 
</p>
<h4><span class="mw-headline" id="Complete_repository">Complete repository</span></h4>
<p>After chrooting into your new installation, edit the new <code>/etc/pacman.conf</code> in the same way as previously (but without the <code>/mnt</code> prefix):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pacman.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[custom]
SigLevel = Optional
Server = file:///repo/</pre>
<p>Comment out all other repositories and save. Continue configuring the new system as usual.
</p>
<p>From now on any updates to the offline system can be made by bringing an up to date copy of the local repository, mounting it to <code>/repo</code> and running <i>pacman</i> commands as usual.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li>
<a href="../en/Help:Browsing.html#Offline_viewing" title="Help:Browsing">Help:Browsing#Offline viewing</a>: for browsing ArchWiki offline.</li></ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Live_Arch_systems.html" title="Category:Live Arch systems">Live Arch systems</a></li>
<li><a href="../en/Category:Installation_process.html" title="Category:Installation process">Installation process</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Offline_installation&amp;oldid=809243">https://wiki.archlinux.org/index.php?title=Offline_installation&amp;oldid=809243</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 25 May 2024, at 09:12.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
