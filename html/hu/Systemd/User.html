<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-os vector-sticky-header-enabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>systemd (Magyar)/User (Magyar) - ArchWiki</title>
<link rel="stylesheet" href="../../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.45.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Systemd_Magyar_User_Magyar rootpage-Systemd_Magyar skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Hogyan_működik?" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Hogyan_m%C5%B1k%C3%B6dik?">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Hogyan működik?</span>
			</div>
		</a>
		
		<ul id="toc-Hogyan_működik?-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Basic_setup" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Basic_setup">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Basic setup</span>
			</div>
		</a>
		
			<button aria-controls="toc-Basic_setup-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Basic setup subsection</span>
			</button>
		
		<ul id="toc-Basic_setup-sublist" class="vector-toc-list">
			<li id="toc-Környezeti_változók" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#K%C3%B6rnyezeti_v%C3%A1ltoz%C3%B3k">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1</span>
					<span>Környezeti változók</span>
				</div>
			</a>
			
			<ul id="toc-Környezeti_változók-sublist" class="vector-toc-list">
				<li id="toc-Systemd_user_instance" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Systemd_user_instance">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1.1</span>
					<span>Systemd user instance</span>
				</div>
			</a>
			
			<ul id="toc-Systemd_user_instance-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Service_example" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Service_example">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1.2</span>
					<span>Service example</span>
				</div>
			</a>
			
			<ul id="toc-Service_example-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-DISPLAY_and_XAUTHORITY" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#DISPLAY_and_XAUTHORITY">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1.3</span>
					<span>DISPLAY and XAUTHORITY</span>
				</div>
			</a>
			
			<ul id="toc-DISPLAY_and_XAUTHORITY-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-PATH" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#PATH">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1.4</span>
					<span>PATH</span>
				</div>
			</a>
			
			<ul id="toc-PATH-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-pam_env" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#pam_env">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1.5</span>
					<span>pam_env</span>
				</div>
			</a>
			
			<ul id="toc-pam_env-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Automatic_start-up_of_systemd_user_instances" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Automatic_start-up_of_systemd_user_instances">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2</span>
					<span>Automatic start-up of systemd user instances</span>
				</div>
			</a>
			
			<ul id="toc-Automatic_start-up_of_systemd_user_instances-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Writing_user_units" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Writing_user_units">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Writing user units</span>
			</div>
		</a>
		
			<button aria-controls="toc-Writing_user_units-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Writing user units subsection</span>
			</button>
		
		<ul id="toc-Writing_user_units-sublist" class="vector-toc-list">
			<li id="toc-Example" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Example">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1</span>
					<span>Example</span>
				</div>
			</a>
			
			<ul id="toc-Example-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Example_with_variables" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Example_with_variables">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2</span>
					<span>Example with variables</span>
				</div>
			</a>
			
			<ul id="toc-Example_with_variables-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Reading_the_journal" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Reading_the_journal">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.3</span>
					<span>Reading the journal</span>
				</div>
			</a>
			
			<ul id="toc-Reading_the_journal-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Temporary_files" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Temporary_files">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">4</span>
				<span>Temporary files</span>
			</div>
		</a>
		
		<ul id="toc-Temporary_files-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Xorg_and_systemd" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Xorg_and_systemd">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">5</span>
				<span>Xorg and systemd</span>
			</div>
		</a>
		
			<button aria-controls="toc-Xorg_and_systemd-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Xorg and systemd subsection</span>
			</button>
		
		<ul id="toc-Xorg_and_systemd-sublist" class="vector-toc-list">
			<li id="toc-Automatic_login_into_Xorg_without_display_manager" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Automatic_login_into_Xorg_without_display_manager">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.1</span>
					<span>Automatic login into Xorg without display manager</span>
				</div>
			</a>
			
			<ul id="toc-Automatic_login_into_Xorg_without_display_manager-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Xorg_as_a_systemd_user_service" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Xorg_as_a_systemd_user_service">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.2</span>
					<span>Xorg as a systemd user service</span>
				</div>
			</a>
			
			<ul id="toc-Xorg_as_a_systemd_user_service-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-xinit_and_application_as_a_systemd_service" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#xinit_and_application_as_a_systemd_service">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.3</span>
					<span>xinit and application as a systemd service</span>
				</div>
			</a>
			
			<ul id="toc-xinit_and_application_as_a_systemd_service-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Some_use_cases" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Some_use_cases">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">6</span>
				<span>Some use cases</span>
			</div>
		</a>
		
			<button aria-controls="toc-Some_use_cases-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Some use cases subsection</span>
			</button>
		
		<ul id="toc-Some_use_cases-sublist" class="vector-toc-list">
			<li id="toc-Window_manager" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Window_manager">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">6.1</span>
					<span>Window manager</span>
				</div>
			</a>
			
			<ul id="toc-Window_manager-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Persistent_terminal_multiplexer" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Persistent_terminal_multiplexer">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">6.2</span>
					<span>Persistent terminal multiplexer</span>
				</div>
			</a>
			
			<ul id="toc-Persistent_terminal_multiplexer-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Kill_user_processes_on_logout" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Kill_user_processes_on_logout">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">7</span>
				<span>Kill user processes on logout</span>
			</div>
		</a>
		
		<ul id="toc-Kill_user_processes_on_logout-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Troubleshooting" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Troubleshooting">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">8</span>
				<span>Troubleshooting</span>
			</div>
		</a>
		
			<button aria-controls="toc-Troubleshooting-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Troubleshooting subsection</span>
			</button>
		
		<ul id="toc-Troubleshooting-sublist" class="vector-toc-list">
			<li id="toc-Runtime_directory_'/run/user/1000'_is_not_owned_by_UID_1000,_as_it_should" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Runtime_directory_'/run/user/1000'_is_not_owned_by_UID_1000,_as_it_should">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">8.1</span>
					<span>Runtime directory '/run/user/1000' is not owned by UID 1000, as it should</span>
				</div>
			</a>
			
			<ul id="toc-Runtime_directory_'/run/user/1000'_is_not_owned_by_UID_1000,_as_it_should-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-&quot;A_stop_job_is_running_for_User_Manager_for_UID_1000&quot;" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#&quot;A_stop_job_is_running_for_User_Manager_for_UID_1000&quot;">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">8.2</span>
					<span>"A stop job is running for User Manager for UID 1000"</span>
				</div>
			</a>
			
			<ul id="toc-&quot;A_stop_job_is_running_for_User_Manager_for_UID_1000&quot;-sublist" class="vector-toc-list">
				<li id="toc-Finding_and_overriding_the_misbehaving_service" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Finding_and_overriding_the_misbehaving_service">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">8.2.1</span>
					<span>Finding and overriding the misbehaving service</span>
				</div>
			</a>
			
			<ul id="toc-Finding_and_overriding_the_misbehaving_service-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Changing_the_timeout_value" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Changing_the_timeout_value">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">8.2.2</span>
					<span>Changing the timeout value</span>
				</div>
			</a>
			
			<ul id="toc-Changing_the_timeout_value-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-További_olvasnivaló_a_témában" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#Tov%C3%A1bbi_olvasnival%C3%B3_a_t%C3%A9m%C3%A1ban">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">9</span>
				<span>További olvasnivaló a témában</span>
			</div>
		</a>
		
		<ul id="toc-További_olvasnivaló_a_témában-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar no-font-mode-scale">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left" title="Table of Contents">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading">systemd (Magyar)/User (Magyar)</h1>
							
</header>
				<div class="vector-column-end no-font-mode-scale">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"><div class="subpages">&lt; <bdi dir="ltr"><a href="../../hu/Systemd.html" title="Systemd (Magyar)">Systemd (Magyar)</a></bdi>
</div></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="hu" dir="ltr">
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Fordítás állapota:</strong> Ez a cikk az angol <a href="../../en/Systemd/User.html" title="Systemd/User">systemd/User</a> című cikk magyar nyelvre lefordított változata. Utolsó fordítás dátuma: 2025.11.29. Amennyiben a lefordítás időpontja óta az angol nyelvű cikkben történtek újabb <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Systemd/User&amp;diff=0&amp;oldid=839770">módosítások</a>, akkor Ön segíthet hozzászinkronizálni az angolhoz ezt a magyar nyelvű fordítást.</div>
<p><span>
</span>
</p>
<div class="archwiki-template-meta-related-articles">
<p>Kapcsolódó cikkek</p>
<ul>
<li><a href="../../hu/Systemd.html" title="Systemd (Magyar)">systemd (Magyar)</a></li>
<li><a href="../../hu/Automatic_login_to_virtual_console.html" class="mw-redirect" title="Automatic login to virtual console (Magyar)">Automatic login to virtual console (Magyar)</a></li>
<li><a href="../../hu/Start_X_at_login.html" class="mw-redirect" title="Start X at login (Magyar)">Start X at login (Magyar)</a></li>
</ul>
</div>
<p><a href="../../en/Systemd.html" title="Systemd">systemd</a> offers the ability to manage services under the user's control with a per-user systemd instance, enabling them to start, stop, enable, and disable their own <b>user units</b>. This is convenient for daemons and other services that are commonly run for a single user, such as <a href="../../en/Music_Player_Daemon.html" class="mw-redirect" title="Mpd">mpd</a>, or to perform automated tasks like fetching mail.
</p>
<meta property="mw:PageProp/toc">
<div class="mw-heading mw-heading2"><h2 id="Hogyan_működik?">
<span id="Hogyan_m.C5.B1k.C3.B6dik.3F"></span>Hogyan működik?</h2></div>
<p>As per default configuration in <code>/etc/pam.d/system-login</code>, the <code>pam_systemd</code> module automatically launches a <code>systemd --user</code> instance when the user logs in for the first time. This process will survive as long as there is some session for that user, and will be killed as soon as the last session for the user is closed. When <a href="#Automatic_start-up_of_systemd_user_instances">#Automatic start-up of systemd user instances</a> is enabled, the instance is started on boot and will not be killed. The systemd user instance is responsible for managing user services, which can be used to run daemons or automated tasks with all the benefits of systemd, such as socket activation, timers, dependency system, and strict process control via cgroups.
</p>
<p>Similar to system units, user units are located in the following directories (ordered by ascending precedence):
</p>
<ul>
<li>
<code>/usr/lib/systemd/user/</code> where units provided by installed packages belong.</li>
<li>
<code>~/.local/share/systemd/user/</code> where units of packages that have been installed in the home directory belong.</li>
<li>
<code>/etc/systemd/user/</code> where system-wide user units are placed by the system administrator.</li>
<li>
<code>~/.config/systemd/user/</code> where the user puts their own units.</li>
</ul>
<p>When a systemd user instance starts, it brings up the per user target <code>default.target</code>. Other units can be controlled manually with <code>systemctl --user</code>. See <span class="plainlinks archwiki-template-man" title="$ man 7 systemd.special"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.special.7#UNITS_MANAGED_BY_THE_USER_SERVICE_MANAGER">systemd.special(7) § UNITS MANAGED BY THE USER SERVICE MANAGER</a></span>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Megjegyzés</strong> 
<ul>
<li>Be aware that the <code>systemd --user</code> instance is a per-user process, and not per-session. The rationale is that most resources handled by user services, like sockets or state files will be per-user (live on the user's home directory) and not per session. This means that all user services run outside of a session. As a consequence, programs that need to be run inside a session will probably break in user services. The way systemd handles user sessions is pretty much in flux. See <a rel="nofollow" class="external autonumber" href="https://mail.gnome.org/archives/desktop-devel-list/2014-January/msg00079.html">[1]</a> and <a rel="nofollow" class="external autonumber" href="https://lists.freedesktop.org/archives/systemd-devel/2014-March/017552.html">[2]</a> for some hints on where things are going.</li>
<li>
<code>systemd --user</code> runs as a separate process from the <code>systemd --system</code> process. User units can not reference or depend on system units or units of other users.</li>
</ul>
</div>
<div class="mw-heading mw-heading2"><h2 id="Basic_setup">Basic setup</h2></div>
<p>All the user units will be placed in <code>~/.config/systemd/user/</code>. If you want to start units on first login, execute <code>systemctl --user enable <i>unit</i></code> for any unit you want to be autostarted.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tipp</strong> If you want to enable a unit for all users rather than the user executing the <i>systemctl</i> command, run <code>systemctl --global enable <i>unit</i></code> as root. Similarly for <code>disable</code>.</div>
<div class="mw-heading mw-heading3"><h3 id="Környezeti_változók">
<span id="K.C3.B6rnyezeti_v.C3.A1ltoz.C3.B3k"></span>Környezeti változók</h3></div>
<p>Units started by user instance of systemd do not inherit any of the <a href="../../en/Environment_variables.html" title="Environment variables">environment variables</a> set in places like <code>.bashrc</code> etc. There are several ways to set environment variables for them:
</p>
<ul>
<li>For users with a <code>$HOME</code> directory, create a <i>.conf</i> file in the <code>~/.config/environment.d/</code> directory with lines of the form <code>NAME=VAL</code>. Affects only that user's user unit. See <span class="plainlinks archwiki-template-man" title="$ man 5 environment.d"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/environment.d.5">environment.d(5)</a></span> for more information.</li>
<li>Use the <code>DefaultEnvironment</code> option in <code>/etc/systemd/user.conf</code> file. Affects all user units.</li>
<li>Add a drop-in configuration file in <code>/etc/systemd/system/user@<i>UID</i>.service.d/</code>, see <a href="#Service_example">#Service example</a>
</li>
<li>Add a drop-in configuration file in <code>/etc/systemd/system/user@.service.d/</code> (affects all users), see <a href="#Service_example">#Service example</a>
</li>
<li>At any time, use <code>systemctl --user set-environment</code> or <code>systemctl --user import-environment</code>. Affects all user units started after setting the environment variables, but not the units that were already running.</li>
<li>Using the <code>dbus-update-activation-environment --systemd --all</code> command provided by <a href="../../en/D-Bus.html" class="mw-redirect" title="Dbus">dbus</a>. Has the same effect as <code>systemctl --user import-environment</code>, but also affects the D-Bus session. You can add this to the end of your shell initialization file.</li>
<li>For "global" environment variables for the user environment you can use the <code>environment.d</code> directories which are parsed by some generators. See <span class="plainlinks archwiki-template-man" title="$ man 5 environment.d"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/environment.d.5">environment.d(5)</a></span> and <span class="plainlinks archwiki-template-man" title="$ man 7 systemd.generator"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.generator.7">systemd.generator(7)</a></span> for more information.</li>
<li>You can also write a <span class="plainlinks archwiki-template-man" title="$ man 7 systemd.environment-generator"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.environment-generator.7">systemd.environment-generator(7)</a></span> script which can produce environment variables that vary from user to user, this is probably the best way if you need per-user environments (this is the case for <code>XDG_RUNTIME_DIR</code>, <code>DBUS_SESSION_BUS_ADDRESS</code>, etc).</li>
</ul>
<p>One variable you may want to set is <code>PATH</code>.
</p>
<p>After configuration, the command <code>systemctl --user show-environment</code> can be used to verify that the values are correct. You may need to run <code>systemctl --user daemon-reload</code> for changes to take effect immediately.
</p>
<div class="mw-heading mw-heading4"><h4 id="Systemd_user_instance">Systemd user instance</h4></div>
<p>The above only addresses default environment variables for user units. However, the systemd user instance itself is also affected by some environment variables. In particular, certain specifiers (see <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.unit"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.unit.5#SPECIFIERS">systemd.unit(5) § SPECIFIERS</a></span>) are affected by <a href="../../en/XDG_Base_Directory.html" title="XDG Base Directory">XDG variables</a>.
</p>
<p>However, the systemd user instance will <i>only</i> use environment variables that are set when it is started. In particular, it will not try parsing files, see <a rel="nofollow" class="external text" href="https://github.com/systemd/systemd/issues/29414">upstream bug #29414 (closed WONTFIX)</a>. Therefore, if such environment variables are needed, they should be set in a drop-in configuration file, see <a href="#Service_example">#Service example</a>.
</p>
<p>Systemd does not provide introspection tools to check these values, however, something like the following service can be used to help checking that the specifiers expand as expected:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$XDG_CONFIG_HOME/systemd/user/test-specifiers.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Service]
Type=oneshot
ExecStart=printf '(systemd)=(envvar)\n'
ExecStart=printf '%%s=%%s\n' %C "${XDG_CACHE_HOME}"
ExecStart=printf '%%s=%%s\n' %E "${XDG_CONFIG_HOME}"
ExecStart=printf '%%s=%%s\n' %L "${XDG_STATE_HOME}"/log
ExecStart=printf '%%s=%%s\n' %S "${XDG_STATE_HOME}"
ExecStart=printf '%%s=%%s\n' %t "${XDG_RUNTIME_DIR}"</pre>
<div class="mw-heading mw-heading4"><h4 id="Service_example">Service example</h4></div>
<p>Create the <a href="../../en/Systemd.html#Drop-in_files" title="Systemd">drop-in</a> directory <code>/etc/systemd/system/user@.service.d/</code> and inside create a file that has the extension <i>.conf</i> (e.g. <code>local.conf</code>):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/user@.service.d/local.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Service]
Environment="PATH=/usr/lib/ccache/bin:/usr/local/sbin:/usr/local/bin:/usr/bin"
Environment="EDITOR=nano -c"
Environment="BROWSER=firefox"
Environment="NO_AT_BRIDGE=1"
Environment="XDG_STATE_HOME=%h/.local/var/state"</pre>
<div class="mw-heading mw-heading4"><h4 id="DISPLAY_and_XAUTHORITY">DISPLAY and XAUTHORITY</h4></div>
<p><code>DISPLAY</code> is used by any X application to know which display to use and <code>XAUTHORITY</code> to provide a path to the user's <code>.Xauthority</code> file and thus the cookie needed to access the X server. If you plan on launching X applications from systemd units, these variables need to be set. Systemd provides a script in <code>/etc/X11/xinit/xinitrc.d/50-systemd-user.sh</code> to import those variables into the systemd user session on X launch. <a rel="nofollow" class="external autonumber" href="https://github.com/systemd/systemd/blob/v219/NEWS#L194">[3]</a> So unless you start X in a nonstandard way, user services should be aware of the <code>DISPLAY</code> and <code>XAUTHORITY</code>.
</p>
<div class="mw-heading mw-heading4"><h4 id="PATH">PATH</h4></div>
<p>If you customize your <code>PATH</code> and plan on launching applications that make use of it from systemd units, you should make sure the modified <code>PATH</code> is set on the systemd environment. Assuming you set your <code>PATH</code> in <code>.bash_profile</code>, the best way to make systemd aware of your modified <code>PATH</code> is by adding the following to <code>.bash_profile</code> after the <code>PATH</code> variable is set:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.bash_profile</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">systemctl --user import-environment PATH
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Megjegyzés</strong> 
<ul>
<li>This will not affect systemd services started before <code>PATH</code> is imported.</li>
<li>
<i>systemd</i> does not look at the set <code>PATH</code> when resolving non-absolute binaries itself.</li>
</ul>
</div>
<div class="mw-heading mw-heading4"><h4 id="pam_env">pam_env</h4></div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Megjegyzés</strong> This way of setting environment variables per user is deprecated and will be removed.</div>
<p>Environment variables can be made available through use of the <code>pam_env.so</code> module. See <a href="../../en/Environment_variables.html#Using_pam_env" title="Environment variables">Environment variables#Using pam_env</a> for configuration details.
</p>
<div class="mw-heading mw-heading3"><h3 id="Automatic_start-up_of_systemd_user_instances">Automatic start-up of systemd user instances</h3></div>
<p>The systemd user instance is started after the first login of a user and killed after the last session of the user is closed. Sometimes it may be useful to start it right after boot, and keep the systemd user instance running after the last session closes, for instance to have some user process running without any open session. Lingering is used to that effect. Use the following command to enable lingering for your own user, if <a href="../../en/Polkit.html" title="Polkit">polkit</a> is installed:
</p>
<pre>$ loginctl enable-linger
</pre>
<p>Without <i>polkit</i> or to enable lingering for a different user:
</p>
<pre># loginctl enable-linger <i>username</i>
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Figyelmeztetés</strong> systemd services are <b>not</b> sessions, they run outside of <i>logind</i>. Do not use lingering to enable automatic login as it will <a href="../../en/General_troubleshooting.html#Session_permissions" title="General troubleshooting">break the session</a>.</div>
<p>To list all users which have the permit for lingering see column "LINGER" with <code>yes</code>:
</p>
<pre>$ loginctl list-users 
</pre>
<p>or inspect <code>/var/lib/systemd/linger</code>. To revoke lingering:
</p>
<pre># loginctl disable-linger <i>username</i>
</pre>
<div class="mw-heading mw-heading2"><h2 id="Writing_user_units">Writing user units</h2></div>
<p>See <a href="../../en/Systemd.html#Writing_unit_files" title="Systemd">systemd#Writing unit files</a> for general information about writing systemd unit files.
</p>
<div class="mw-heading mw-heading3"><h3 id="Example">Example</h3></div>
<p>The following is an example of a user version of the mpd service:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/systemd/user/mpd.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Music Player Daemon

[Service]
ExecStart=/usr/bin/mpd --no-daemon

[Install]
WantedBy=default.target</pre>
<div class="mw-heading mw-heading3"><h3 id="Example_with_variables">Example with variables</h3></div>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../../File:Inaccurate.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>The factual accuracy of this article or section is disputed.</b></p>
<div>
<b>Reason:</b> User units do not support ordering after system ones yet. (Discuss in <a href="/index.php?title=Talk:Systemd_(Magyar)/User_(Magyar)&amp;action=edit&amp;redlink=1" class="new" title="Talk:Systemd (Magyar)/User (Magyar) (page does not exist)">Talk:Systemd (Magyar)/User (Magyar)#Does the article has a bad example due to a user unit referring to a system target?</a>)</div>
</div>
<p>The following is a user service used by <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/foldingathome/">foldingathome</a></span><sup><small>AUR</small></sup>, which takes into account variable home directories where <a href="../../en/Folding@home.html" title="Folding@home">Folding@home</a> can find certain files:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/systemd/user/foldingathome-user.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Folding@home distributed computing client
After=network.target

[Service]
Type=simple
WorkingDirectory=%h/.config/fah
ExecStart=/usr/bin/FAHClient
CPUSchedulingPolicy=idle
IOSchedulingClass=3

[Install]
WantedBy=default.target</pre>
<p>As detailed in <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.unit"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.unit.5#SPECIFIERS">systemd.unit(5) § SPECIFIERS</a></span>, the <code>%h</code> variable is replaced by the home directory of the user running the service. There are other variables that can be taken into account in the <a href="../../en/Systemd.html" title="Systemd">systemd</a> manpages.
</p>
<div class="mw-heading mw-heading3"><h3 id="Reading_the_journal">Reading the journal</h3></div>
<p>The journal for the user can be read using the analogous command:
</p>
<pre>$ journalctl --user
</pre>
<p>To specify a unit, one can use
</p>
<pre>$ journalctl --user-unit myunit.service
</pre>
<p>Or, equivalently:
</p>
<pre>$ journalctl --user -u myunit.service
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Megjegyzés</strong> journald will not write user journals for users with UIDs below 1000, instead <a rel="nofollow" class="external text" href="https://github.com/systemd/systemd/blob/a33687b792908aa6c9f4c0b22e8935643ee0ddb6/src/journal/journald-server.c#L402">directing</a> everything to the system journal.</div>
<div class="mw-heading mw-heading2"><h2 id="Temporary_files">Temporary files</h2></div>
<p><i>systemd-tmpfiles</i> allows users to manage custom volatile and temporary files and directories just like in the system-wide way (see <a href="../../en/Systemd.html#systemd-tmpfiles_-_temporary_files" title="Systemd">systemd#systemd-tmpfiles - temporary files</a>). User-specific configuration files are read from <code>~/.config/user-tmpfiles.d/</code> and <code>~/.local/share/user-tmpfiles.d/</code>, in that order. For this functionality to be used, it is needed to enable the necessary systemd user units for your user:
</p>
<pre>$ systemctl --user enable systemd-tmpfiles-setup.service systemd-tmpfiles-clean.timer
</pre>
<p>The syntax of the configuration files is the same than those used system-wide. See the <span class="plainlinks archwiki-template-man" title="$ man 8 systemd-tmpfiles"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-tmpfiles.8">systemd-tmpfiles(8)</a></span> and <span class="plainlinks archwiki-template-man" title="$ man 5 tmpfiles.d"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/tmpfiles.d.5">tmpfiles.d(5)</a></span> man pages for details.
</p>
<div class="mw-heading mw-heading2"><h2 id="Xorg_and_systemd">Xorg and systemd</h2></div>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../../File:Tango-view-fullscreen.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>This article or section needs expansion.</b></p>
<div>
<b>Reason:</b> Cover <code>graphical-session.target</code>: <span class="plainlinks archwiki-template-man" title="$ man 7 systemd.special"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.special.7#Special_Passive_User_Units">systemd.special(7) § Special Passive User Units</a></span>, <a rel="nofollow" class="external autonumber" href="https://goral.net.pl/post/systemd-x-sessions/">[4]</a>. (Discuss in <a rel="nofollow" class="external text" href="../../hu/Talk:Systemd/User.html">Talk:Systemd (Magyar)/User (Magyar)</a>)</div>
</div>
<p>There are several ways to run xorg within systemd units. Below there are 3 options, either by starting a new user session with an xorg process, launching xorg from a systemd user service, or launching xinit and application as a service.
</p>
<div class="mw-heading mw-heading3"><h3 id="Automatic_login_into_Xorg_without_display_manager">Automatic login into Xorg without display manager</h3></div>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../../File:Inaccurate.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>The factual accuracy of this article or section is disputed.</b></p>
<div>
<b>Reason:</b> This setup ends up with two user D-Bus buses, one for the desktop, and an other for systemd. Why cannot we use the systemd one alone?  (Discuss in <a rel="nofollow" class="external text" href="../../hu/Talk:Systemd/User.html">Talk:Systemd (Magyar)/User (Magyar)</a>)</div>
</div>
<p>This option will launch a system unit that will start a user session with an xorg server and then run the usual <code>~/.xinitrc</code> to launch the window manager, etc. You need to have <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/xlogin-git/">xlogin-git</a></span><sup><small>AUR</small></sup> installed. Set up your xinitrc as specified in the <a href="../../en/Xinit.html#xinitrc" title="Xinit">Xinit#xinitrc</a> section.
</p>
<p>The session will use its own dbus daemon, but various systemd utilities will automatically connect to the <code>dbus.service</code> instance. Finally, <a href="../../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">enable</a> the <code>xlogin@<i>username</i></code> service for automatic login at boot. The user session lives entirely inside a systemd scope and everything in the user session should work just fine.
</p>
<div class="mw-heading mw-heading3"><h3 id="Xorg_as_a_systemd_user_service">Xorg as a systemd user service</h3></div>
<p>Alternatively, <a href="../../en/Xorg.html" title="Xorg">xorg</a> can be run from within a systemd user service. This is nice since other X-related units can be made to depend on xorg, etc, but on the other hand, it has some drawbacks explained below.
</p>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xorg-server">xorg-server</a></span> provides integration with systemd in two ways:
</p>
<ul>
<li>Can be run unprivileged, delegating device management to logind (see Hans de Goede commits around <a rel="nofollow" class="external text" href="https://gitlab.freedesktop.org/xorg/xserver/-/commit/82863656ec449644cd34a86388ba40f36cea11e9">this commit</a>).</li>
<li>Can be made into a socket activated service (see <a rel="nofollow" class="external text" href="https://gitlab.freedesktop.org/xorg/xserver/-/commit/b3d3ffd19937827bcbdb833a628f9b1814a6e189">this commit</a>).</li>
</ul>
<p>Unfortunately, to be able to run xorg in unprivileged mode, it needs to run inside a session. So, right now the handicap of running xorg as user service is that it must be run with root privileges (like before 1.16), and cannot take advantage of the unprivileged mode introduced in 1.16.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Megjegyzés</strong> This is not a fundamental restriction imposed by logind, but the reason seems to be that xorg needs to know which session to take over, and right now it gets this information calling <a rel="nofollow" class="external text" href="https://www.freedesktop.org/wiki/Software/systemd/logind">logind</a>'s <code>GetSessionByPID</code> using its own pid as argument. See <a rel="nofollow" class="external text" href="https://lists.x.org/archives/xorg-devel/2014-February/040476.html">this thread</a> and <a rel="nofollow" class="external text" href="https://gitlab.freedesktop.org/xorg/xserver/-/blob/master/hw/xfree86/os-support/linux/systemd-logind.c">xorg sources</a>. It seems likely that xorg could be modified to get the session from the tty it is attaching to, and then it could run unprivileged from a user service outside a session.</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Figyelmeztetés</strong> On xorg 1.18 socket activation seems to be broken. The client triggering the activation deadlocks. See the upstream bug report <a rel="nofollow" class="external autonumber" href="https://gitlab.freedesktop.org/xorg/xserver/issues/491">[5]</a>. As a temporary workaround you can start the xorg server without socket activation, making sure the clients connect after a delay, so the server is fully started. There seems to be no nice mechanism to get a startup notification for the X server.</div>
<p>This is how to launch xorg from a user service:
</p>
<p>1. Make xorg run with root privileges for any user, by editing <code>/etc/X11/Xwrapper.config</code>. This builds on <a href="../../en/Xorg.html#Xorg_as_Root" title="Xorg">Xorg#Xorg as Root</a> by adding the stipulation that this need not be done from a physical console. That is, <code>allowed_user</code>'s default of <code>console</code> is being overwritten with <code>anybody</code>; see <span class="plainlinks archwiki-template-man" title="$ man 1 Xorg.wrap"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/Xorg.wrap.1">Xorg.wrap(1)</a></span>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/Xwrapper.config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">allowed_users=anybody
needs_root_rights=yes</pre>
<p>2. Add the following units to <code>~/.config/systemd/user</code>
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/systemd/user/xorg@.socket</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Socket for xorg at display %i

[Socket]
ListenStream=/tmp/.X11-unix/X%i</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/systemd/user/xorg@.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Xorg server at display %i

Requires=xorg@%i.socket
After=xorg@%i.socket

[Service]
Type=simple
SuccessExitStatus=0 1

ExecStart=/usr/bin/Xorg :%i -nolisten tcp -noreset -verbose 2 "vt${XDG_VTNR}"</pre>
<p>where <code>${XDG_VTNR}</code> is the virtual terminal where xorg will be launched, either hard-coded in the service unit, or set  in the systemd environment with
</p>
<pre>$ systemctl --user set-environment XDG_VTNR=1
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Megjegyzés</strong> xorg should be launched at the same virtual terminal where the user logged in. Otherwise logind will consider the session inactive.</div>
<p>3. Make sure to configure the <code>DISPLAY</code> environment variable as explained <a href="#DISPLAY_and_XAUTHORITY">above</a>.
</p>
<p>4. Then, to enable socket activation for xorg on display 0 and tty 2 one would do:
</p>
<pre>$ systemctl --user set-environment XDG_VTNR=2     # So that xorg@.service knows which vt use
$ systemctl --user start xorg@0.socket            # Start listening on the socket for display 0
</pre>
<p>Now running any X application will launch xorg on virtual terminal 2 automatically.
</p>
<p>The environment variable <code>XDG_VTNR</code> can be set in the systemd environment from <code>.bash_profile</code>, and then one could start any X application, including a window manager, as a systemd unit that depends on <code>xorg@0.socket</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Figyelmeztetés</strong> Currently running a window manager as a user service means it runs outside of a session with the problems this may bring: <a href="../../en/General_troubleshooting.html#Session_permissions" title="General troubleshooting">break the session</a>. However, it seems that systemd developers intend to make something like this possible. See <a rel="nofollow" class="external autonumber" href="https://mail.gnome.org/archives/desktop-devel-list/2014-January/msg00079.html">[6]</a> and <a rel="nofollow" class="external autonumber" href="https://lists.freedesktop.org/archives/systemd-devel/2014-March/017552.html">[7]</a>
</div>
<div class="mw-heading mw-heading3"><h3 id="xinit_and_application_as_a_systemd_service">xinit and application as a systemd service</h3></div>
<div class="noprint archwiki-template-message">
<p><span class="mw-default-size" typeof="mw:File"><span><img src="../../File:Inaccurate.svg" decoding="async" width="48" height="48" class="mw-file-element"></span></span><b>The factual accuracy of this article or section is disputed.</b></p>
<div>
<b>Reason:</b> This should be a <i>user</i> service, not a <i>system</i> service. In particular, this setting break dbus session. (Discuss in <a rel="nofollow" class="external text" href="../../hu/Talk:Systemd/User.html">Talk:Systemd (Magyar)/User (Magyar)</a>)</div>
</div>
<p>The service below is an example to run xinit and <code>mate-session</code> with user privilege.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/xinit.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
After=graphical.target systemd-user-sessions.service modprobe@drm.service
Conflicts=getty@tty1.service mdoprobe@drm.service

[Service]
Type=simple
User=<i>username</i>
WorkingDirectory=~

PAMName=login
Environment=XDG_SESSION_TYPE=x11
TTYPath=/dev/tty1
StandardInput=tty
UnsetEnvironment=TERM

StandardOutput=journal
ExecStart=/bin/xinit /bin/mate-session -- -quiet -logfile /dev/null -nolisten tcp vt01
[Install]
WantedBy=graphical.target</pre>
<p>See also <a rel="nofollow" class="external autonumber" href="https://vincent.bernat.ch/en/blog/2021-startx-systemd">[8]</a> .
</p>
<div class="mw-heading mw-heading2"><h2 id="Some_use_cases">Some use cases</h2></div>
<div class="mw-heading mw-heading3"><h3 id="Window_manager">Window manager</h3></div>
<p>To run a window manager as a systemd service, you first need to run <a href="#Xorg_as_a_systemd_user_service">#Xorg as a systemd user service</a>. In the following we will use <a href="../../en/Awesome.html" title="Awesome">awesome</a> as an example:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/systemd/user/awesome.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Awesome window manager
After=xorg.target
Requires=xorg.target

[Service]
ExecStart=/usr/bin/awesome
Restart=always
RestartSec=10
 
[Install]
WantedBy=wm.target</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Megjegyzés</strong> The <code>[Install]</code> section includes a <code>WantedBy</code> part. When using <code>systemctl --user enable</code> it will link this as <code>~/.config/systemd/user/wm.target.wants/<i>window_manager</i>.service</code>, allowing it to be started at login. Is recommended to enable this service, not to link it manually.</div>
<div class="mw-heading mw-heading3"><h3 id="Persistent_terminal_multiplexer">Persistent terminal multiplexer</h3></div>
<p>Rather than logging you into a window manager session for your user session by default, you may want to automatically run a terminal multiplexer (such as <a href="../../en/Screen.html" title="Screen">screen</a> or <a href="../../en/Tmux.html" title="Tmux">tmux</a>) in the background. 
</p>
<p><a href="../../en/Help:Reading.html#Append,_add,_create,_edit" class="mw-redirect" title="Create">Create</a> the following: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/systemd/user/multiplexer.target</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Terminal multiplexer
Documentation=info:screen man:screen(1) man:tmux(1)
After=cruft.target
Wants=cruft.target

[Install]
Alias=default.target</pre>
<p>Separating login from X login is most likely only useful for those who boot to a TTY instead of to a display manager (in which case you can simply bundle everything you start in <code>mystuff.target</code>). 
</p>
<p>The dependency <code>cruft.target</code>, like the <code>mystuff.target</code> above, allows starting anything which should run before the multiplexer starts (or which you want started at boot regardless of timing), such as a GnuPG daemon session.
</p>
<p>You then need to create a service for your multiplexer session. Here is a sample service, using tmux as an example and sourcing a gpg-agent session which wrote its information to <code>/tmp/gpg-agent-info</code>. This sample session, when you start X, will also be able to run X programs, since <code>$DISPLAY</code> is set: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/systemd/user/tmux.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=tmux: A terminal multiplexer 
Documentation=man:tmux(1)
After=gpg-agent.service
Wants=gpg-agent.service

[Service]
Type=forking
ExecStart=/usr/bin/tmux start
ExecStop=/usr/bin/tmux kill-server
Environment=DISPLAY=:0
EnvironmentFile=/tmp/gpg-agent-info

[Install]
WantedBy=multiplexer.target</pre>
<p><a href="../../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">Enable</a> <code>tmux.service</code>, <code>multiplexer.target</code> and any services you created to be run by <code>cruft.target</code>, <a href="../../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start">start</a> <code>user@.service</code> as usual and you should be done.
</p>
<div class="mw-heading mw-heading2"><h2 id="Kill_user_processes_on_logout">Kill user processes on logout</h2></div>
<p>Arch Linux builds the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=systemd">systemd</a></span> package with <code>--without-kill-user-processes</code>, setting <code>KillUserProcesses</code> to <code>no</code> by default. This setting causes user processes not to be killed when the user logs out. To change this behavior in order to have all user processes killed on the user's logout, set <code>KillUserProcesses=yes</code> in <code>/etc/systemd/logind.conf</code>. 
</p>
<p>Note that changing this setting breaks terminal multiplexers such as <a href="../../en/Tmux.html" title="Tmux">tmux</a> and <a href="../../en/GNU_Screen.html" title="GNU Screen">GNU Screen</a>. If you change this setting, you can still use a terminal multiplexer by using <code>systemd-run</code> as follows:
</p>
<pre>$ systemd-run --scope --user <i>command</i> <i>args</i>
</pre>
<p>For example, to run <code>screen</code> you would do:
</p>
<pre>$ systemd-run --scope --user screen -S <i>foo</i>
</pre>
<p>Using <code>systemd-run</code> will keep the process running after logout only while the user is logged in at least once somewhere else in the system and <code>user@.service</code> is still running. 
</p>
<p>After the user logs out of all sessions, <code>user@.service</code> will be terminated too, by default, unless the user has "lingering" enabled <a rel="nofollow" class="external autonumber" href="https://github.com/systemd/systemd/blob/76153ad45f09b6ae45464f2e03d3afefbb4b2afe/NEWS#L274">[9]</a>. To effectively allow users to run long-term tasks even if they are completely logged out, lingering must be enabled for them. See <a href="#Automatic_start-up_of_systemd_user_instances">#Automatic start-up of systemd user instances</a> and <span class="plainlinks archwiki-template-man" title="$ man 1 loginctl"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/loginctl.1">loginctl(1)</a></span> for details.
</p>
<div class="mw-heading mw-heading2"><h2 id="Troubleshooting">Troubleshooting</h2></div>
<div class="mw-heading mw-heading3"><h3 id="Runtime_directory_'/run/user/1000'_is_not_owned_by_UID_1000,_as_it_should">
<span id="Runtime_directory_.27.2Frun.2Fuser.2F1000.27_is_not_owned_by_UID_1000.2C_as_it_should"></span>Runtime directory '/run/user/1000' is not owned by UID 1000, as it should</h3></div>
<pre>systemd[1867]: pam_systemd(systemd-user:session): Runtime directory '/run/user/1000' is not owned by UID 1000, as it should.
systemd[1867]: Trying to run as user instance, but $XDG_RUNTIME_DIR is not set
</pre>
<p>If you see errors such as this and your login session is broken, it is possible that another system (non-user) service on your system is creating this directory. This can happen for example if you use a <a href="../../en/Docker.html" title="Docker">docker</a> container that has a bind mount to <code>/run/user/1000</code>. To fix this, you can either fix the container by removing the mount, or disable/delay the docker service.
</p>
<div class="mw-heading mw-heading3"><h3 id="&quot;A_stop_job_is_running_for_User_Manager_for_UID_1000&quot;">
<span id=".22A_stop_job_is_running_for_User_Manager_for_UID_1000.22"></span>"A stop job is running for User Manager for UID 1000"</h3></div>
<p>If you see this message during shutdown, usually with a 2 minute timeout, it means that one of the user services did not stop in a timely manner. This can be caused by a misbehaving application which spawned a transient service earlier. You can simply wait for the timeout to expire, but if this bothers you, you can either create an override for the misbehaving service or reduce the global timeout for all user services.
</p>
<div class="mw-heading mw-heading4"><h4 id="Finding_and_overriding_the_misbehaving_service">Finding and overriding the misbehaving service</h4></div>
<p>To troubleshoot this problem, start the <a href="../../en/General_troubleshooting.html#Recovery_shells" title="General troubleshooting">systemd debug shell</a>:
</p>
<pre># systemctl start debug-shell
</pre>
<p>Then, reboot or shut down the system. When the problem occurs, switch to the debug shell using <code>Ctrl+Alt+F9</code>. To find out which service is preventing the shutdown, run:
</p>
<pre># systemctl --user list-jobs
</pre>
<p>For most open source applications, this problem should be reported to the respective maintainers such that an override isn't necessary. For closed source applications, however, an override can be created like so:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ systemctl --user edit --force <i>name</i>@.service </pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Service]
TimeoutStopSec=1s</pre>
<p>This will shorten the timeout of that particular service to 1 second. The <code>--force</code> parameter is only required for transient services which do not create a <code>.service</code> file on disk. The override will work regardless. Instead of the timeout, <code>KillSignal=SIGKILL</code> can be used. This will cause the service to be killed immediately when the user manager is stopped. Only use this if you know the service can handle it.
</p>
<div class="mw-heading mw-heading4"><h4 id="Changing_the_timeout_value">Changing the timeout value</h4></div>
<p>If you don't care which service is preventing the shutdown, you can change the global timeout for all user services in a similar manner:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># systemctl edit user@.service </pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Service]
TimeoutStopSec=10s</pre>
<p>After this timeout, any user services which haven't gracefully stopped will be killed, which is equivalent to a sudden power loss. Adjust this value for your particular use case. Setting the timeout too low may cause data corruption depending on the application.
</p>
<div class="mw-heading mw-heading2"><h2 id="További_olvasnivaló_a_témában">
<span id="Tov.C3.A1bbi_olvasnival.C3.B3_a_t.C3.A9m.C3.A1ban"></span>További olvasnivaló a témában</h2></div>
<ul>
<li><a rel="nofollow" class="external text" href="https://bitbucket.org/KaiSforza/systemd-user-units/wiki/Home">KaiSforza's Bitbucket wiki</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/zoqaeski/systemd-user-units">Zoqaeski's units on GitHub</a></li>
<li><a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=167115">Arch forum thread about changes in systemd 206 user instances</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../../hu/Category:System_administration.html" title="Category:System administration (Magyar)">System administration (Magyar)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../../en/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li>
<li><a href="../../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Systemd_(Magyar)/User_(Magyar)&amp;oldid=854576">https://wiki.archlinux.org/index.php?title=Systemd_(Magyar)/User_(Magyar)&amp;oldid=854576</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 29 November 2025, at 18:07.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><picture><source media="(min-width: 500px)" srcset="/resources/assets/poweredby_mediawiki.svg" width="88" height="31"><img src="/resources/assets/mediawiki_compact.svg" width="25" height="25" loading="lazy"></picture></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-header-container vector-sticky-header-container no-font-mode-scale">
	<div id="vector-sticky-header" class="vector-sticky-header">
		<div class="vector-sticky-header-start">
			<div class="vector-sticky-header-icon-start vector-button-flush-left vector-button-flush-right" aria-hidden="true">
				<button class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-sticky-header-search-toggle" tabindex="-1" data-event-name="ui.vector-sticky-search-form.icon"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
			</button>
		</div>
			
		<div role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box">
			<div class="vector-typeahead-search-container">
				<div class="cdx-typeahead-search cdx-typeahead-search--show-thumbnail">
					<form action="/index.php" id="vector-sticky-search-form" class="cdx-search-input cdx-search-input--has-end-button">
						<div class="cdx-search-input__input-wrapper" data-search-loc="header-moved">
							<div class="cdx-text-input cdx-text-input--has-start-icon">
								<input class="cdx-text-input__input mw-searchInput" autocomplete="off" type="search" name="search" placeholder="Search ArchWiki">
								<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
							</div>
							<input type="hidden" name="title" value="Special:Search">
						</div>
						<button class="cdx-button cdx-search-input__end-button">Search</button>
					</form>
				</div>
			</div>
		</div>
		<div class="vector-sticky-header-context-bar">
				<nav aria-label="Contents" class="vector-toc-landmark">
						
					<div id="vector-sticky-header-toc" class="vector-dropdown mw-portlet mw-portlet-sticky-header-toc vector-sticky-header-toc vector-button-flush-left">
						<input type="checkbox" id="vector-sticky-header-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-sticky-header-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
						<label id="vector-sticky-header-toc-label" for="vector-sticky-header-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
						</label>
						<div class="vector-dropdown-content">
					
						<div id="vector-sticky-header-toc-unpinned-container" class="vector-unpinned-container">
						</div>
					
						</div>
					</div>
			</nav>
				<div class="vector-sticky-header-context-bar-primary" aria-hidden="true">systemd (Magyar)/User (Magyar)</div>
			</div>
		</div>
		<div class="vector-sticky-header-end" aria-hidden="true">
			<div class="vector-sticky-header-icons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-talk-sticky-header" tabindex="-1" data-event-name="talk-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbles mw-ui-icon-wikimedia-speechBubbles"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-subject-sticky-header" tabindex="-1" data-event-name="subject-sticky-header"><span class="vector-icon mw-ui-icon-article mw-ui-icon-wikimedia-article"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-history-sticky-header" tabindex="-1" data-event-name="history-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-history mw-ui-icon-wikimedia-wikimedia-history"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only mw-watchlink" id="ca-watchstar-sticky-header" tabindex="-1" data-event-name="watch-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-star mw-ui-icon-wikimedia-wikimedia-star"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only reading-lists-bookmark" id="ca-bookmark-sticky-header" tabindex="-1" data-event-name="watch-sticky-bookmark"><span class="vector-icon mw-ui-icon-wikimedia-bookmarkOutline mw-ui-icon-wikimedia-wikimedia-bookmarkOutline"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-edit-sticky-header" tabindex="-1" data-event-name="wikitext-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-wikiText mw-ui-icon-wikimedia-wikimedia-wikiText"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-ve-edit-sticky-header" tabindex="-1" data-event-name="ve-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-edit mw-ui-icon-wikimedia-wikimedia-edit"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-viewsource-sticky-header" tabindex="-1" data-event-name="ve-edit-protected-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-editLock mw-ui-icon-wikimedia-wikimedia-editLock"></span>

<span></span>
			</a>
		</div>
			<div class="vector-sticky-header-buttons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive" id="ca-addsection-sticky-header" tabindex="-1" data-event-name="addsection-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbleAdd-progressive mw-ui-icon-wikimedia-speechBubbleAdd-progressive"></span>

<span>Add topic</span>
			</a>
		</div>
			<div class="vector-sticky-header-icon-end">
				<div class="vector-user-links">
				</div>
			</div>
		</div>
	</div>
</div>
<div class="mw-portlet mw-portlet-dock-bottom emptyPortlet" id="p-dock-bottom">
	<ul>
		
	</ul>
</div>
</body>
</html>
