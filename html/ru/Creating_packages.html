<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-os vector-sticky-header-enabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Creating packages (Русский) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.45.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Creating_packages_Русский rootpage-Creating_packages_Русский skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Обзор" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#%D0%9E%D0%B1%D0%B7%D0%BE%D1%80">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Обзор</span>
			</div>
		</a>
		
		<ul id="toc-Обзор-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Подготовка" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#%D0%9F%D0%BE%D0%B4%D0%B3%D0%BE%D1%82%D0%BE%D0%B2%D0%BA%D0%B0">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Подготовка</span>
			</div>
		</a>
		
			<button aria-controls="toc-Подготовка-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Подготовка subsection</span>
			</button>
		
		<ul id="toc-Подготовка-sublist" class="vector-toc-list">
			<li id="toc-Необходимое_программное_обеспечение" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9D%D0%B5%D0%BE%D0%B1%D1%85%D0%BE%D0%B4%D0%B8%D0%BC%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%BD%D0%BE%D0%B5_%D0%BE%D0%B1%D0%B5%D1%81%D0%BF%D0%B5%D1%87%D0%B5%D0%BD%D0%B8%D0%B5">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1</span>
					<span>Необходимое программное обеспечение</span>
				</div>
			</a>
			
			<ul id="toc-Необходимое_программное_обеспечение-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Загрузка_и_тестирование_установки" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%97%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B0_%D0%B8_%D1%82%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B8">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2</span>
					<span>Загрузка и тестирование установки</span>
				</div>
			</a>
			
			<ul id="toc-Загрузка_и_тестирование_установки-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Установка_в_чистый_chroot" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B2_%D1%87%D0%B8%D1%81%D1%82%D1%8B%D0%B9_chroot">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.3</span>
					<span>Установка в чистый chroot</span>
				</div>
			</a>
			
			<ul id="toc-Установка_в_чистый_chroot-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Создание_PKGBUILD" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_PKGBUILD">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Создание PKGBUILD</span>
			</div>
		</a>
		
			<button aria-controls="toc-Создание_PKGBUILD-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Создание PKGBUILD subsection</span>
			</button>
		
		<ul id="toc-Создание_PKGBUILD-sublist" class="vector-toc-list">
			<li id="toc-Определение_переменных_PKGBUILD" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9E%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D0%B5%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D1%85_PKGBUILD">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1</span>
					<span>Определение переменных PKGBUILD</span>
				</div>
			</a>
			
			<ul id="toc-Определение_переменных_PKGBUILD-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Функции_PKGBUILD" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A4%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%B8_PKGBUILD">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2</span>
					<span>Функции PKGBUILD</span>
				</div>
			</a>
			
			<ul id="toc-Функции_PKGBUILD-sublist" class="vector-toc-list">
				<li id="toc-prepare()" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#prepare()">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.1</span>
					<span>prepare()</span>
				</div>
			</a>
			
			<ul id="toc-prepare()-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-pkgver()" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#pkgver()">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.2</span>
					<span>pkgver()</span>
				</div>
			</a>
			
			<ul id="toc-pkgver()-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-build()" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#build()">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.3</span>
					<span>build()</span>
				</div>
			</a>
			
			<ul id="toc-build()-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-check()" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#check()">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.4</span>
					<span>check()</span>
				</div>
			</a>
			
			<ul id="toc-check()-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-package()" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#package()">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2.5</span>
					<span>package()</span>
				</div>
			</a>
			
			<ul id="toc-package()-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Тестирование_PKGBUILD_и_пакета" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#%D0%A2%D0%B5%D1%81%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_PKGBUILD_%D0%B8_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%B0">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">4</span>
				<span>Тестирование PKGBUILD и пакета</span>
			</div>
		</a>
		
			<button aria-controls="toc-Тестирование_PKGBUILD_и_пакета-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Тестирование PKGBUILD и пакета subsection</span>
			</button>
		
		<ul id="toc-Тестирование_PKGBUILD_и_пакета-sublist" class="vector-toc-list">
			<li id="toc-Проверка_целостности_пакета" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0_%D1%86%D0%B5%D0%BB%D0%BE%D1%81%D1%82%D0%BD%D0%BE%D1%81%D1%82%D0%B8_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%B0">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.1</span>
					<span>Проверка целостности пакета</span>
				</div>
			</a>
			
			<ul id="toc-Проверка_целостности_пакета-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Использование_pkgctl_для_сборки_в_чистом_chroot-окружении" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_pkgctl_%D0%B4%D0%BB%D1%8F_%D1%81%D0%B1%D0%BE%D1%80%D0%BA%D0%B8_%D0%B2_%D1%87%D0%B8%D1%81%D1%82%D0%BE%D0%BC_chroot-%D0%BE%D0%BA%D1%80%D1%83%D0%B6%D0%B5%D0%BD%D0%B8%D0%B8">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.2</span>
					<span>Использование pkgctl для сборки в чистом chroot-окружении</span>
				</div>
			</a>
			
			<ul id="toc-Использование_pkgctl_для_сборки_в_чистом_chroot-окружении-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Отправка_пакетов_в_AUR" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#%D0%9E%D1%82%D0%BF%D1%80%D0%B0%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2_%D0%B2_AUR">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">5</span>
				<span>Отправка пакетов в AUR</span>
			</div>
		</a>
		
		<ul id="toc-Отправка_пакетов_в_AUR-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Резюме" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#%D0%A0%D0%B5%D0%B7%D1%8E%D0%BC%D0%B5">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">6</span>
				<span>Резюме</span>
			</div>
		</a>
		
			<button aria-controls="toc-Резюме-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Резюме subsection</span>
			</button>
		
		<ul id="toc-Резюме-sublist" class="vector-toc-list">
			<li id="toc-Предупреждения" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%B5%D0%B4%D1%83%D0%BF%D1%80%D0%B5%D0%B6%D0%B4%D0%B5%D0%BD%D0%B8%D1%8F">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">6.1</span>
					<span>Предупреждения</span>
				</div>
			</a>
			
			<ul id="toc-Предупреждения-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Более_подробные_руководства" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#%D0%91%D0%BE%D0%BB%D0%B5%D0%B5_%D0%BF%D0%BE%D0%B4%D1%80%D0%BE%D0%B1%D0%BD%D1%8B%D0%B5_%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%B0">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">7</span>
				<span>Более подробные руководства</span>
			</div>
		</a>
		
		<ul id="toc-Более_подробные_руководства-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Автоматизация" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#%D0%90%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">8</span>
				<span>Автоматизация</span>
			</div>
		</a>
		
			<button aria-controls="toc-Автоматизация-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Автоматизация subsection</span>
			</button>
		
		<ul id="toc-Автоматизация-sublist" class="vector-toc-list">
			<li id="toc-Контрольные_суммы" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9A%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5_%D1%81%D1%83%D0%BC%D0%BC%D1%8B">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">8.1</span>
					<span>Контрольные суммы</span>
				</div>
			</a>
			
			<ul id="toc-Контрольные_суммы-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Генераторы_PKGBUILD" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%93%D0%B5%D0%BD%D0%B5%D1%80%D0%B0%D1%82%D0%BE%D1%80%D1%8B_PKGBUILD">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">8.2</span>
					<span>Генераторы PKGBUILD</span>
				</div>
			</a>
			
			<ul id="toc-Генераторы_PKGBUILD-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Смотрите_также" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#%D0%A1%D0%BC%D0%BE%D1%82%D1%80%D0%B8%D1%82%D0%B5_%D1%82%D0%B0%D0%BA%D0%B6%D0%B5">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">9</span>
				<span>Смотрите также</span>
			</div>
		</a>
		
		<ul id="toc-Смотрите_также-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar no-font-mode-scale">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left" title="Table of Contents">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Creating packages (Русский)</span></h1>
							
</header>
				<div class="vector-column-end no-font-mode-scale">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="ru" dir="ltr">
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Состояние перевода:</strong> На этой странице представлен перевод статьи <a href="../en/Creating_packages.html" title="Creating packages">Creating packages</a>. Дата последней синхронизации: 23 августа 2023. Вы можете <a href="../ru/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (Русский)">помочь</a> синхронизировать перевод, если в английской версии произошли <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Creating_packages&amp;diff=0&amp;oldid=785205">изменения</a>.</div>
<div class="archwiki-template-meta-related-articles">
<p>Ссылки по теме</p>
<ul>
<li><a href="../en/14f969a1641beebdce58e32da57a009c.html" class="mw-redirect" title="Система сборки Arch">Система сборки Arch</a></li>
<li><a href="../en/1b1f00baa8bea2eae32e7ad4e72d1fac.html" class="mw-redirect" title="Стандарты создания пакетов для Arch">Стандарты создания пакетов для Arch</a></li>
<li><a href="../en/30c45e8c66befb80fb2b1d9cb7b9a8d7.html" class="mw-redirect" title="Пользовательский репозиторий Arch">Пользовательский репозиторий Arch</a></li>
<li><a href="../en/Creating_packages_for_other_distributions.html" title="Creating packages for other distributions">Creating packages for other distributions</a></li>
<li><a href="../ru/Makepkg.html" title="Makepkg (Русский)">makepkg (Русский)</a></li>
<li><a href="../ru/Pacman.html" title="Pacman (Русский)">pacman (Русский)</a></li>
<li><a href="../en/Patching_packages.html" title="Patching packages">Patching packages</a></li>
<li><a href="../ru/PKGBUILD.html" title="PKGBUILD (Русский)">PKGBUILD (Русский)</a></li>
<li><a href="../ru/.SRCINFO.html" title=".SRCINFO (Русский)">.SRCINFO (Русский)</a></li>
<li><a href="../DeveloperWiki:Building_in_a_clean_chroot.html" title="DeveloperWiki:Building in a clean chroot">DeveloperWiki:Building in a clean chroot</a></li>
</ul>
</div>
<p>Эта статья призвана помочь пользователям в создании собственных пакетов с помощью «портоподобной» <a href="../ru/Arch_build_system.html" title="Arch build system (Русский)">системы сборки</a>, в том числе для публикации в <a href="../ru/Arch_User_Repository.html" title="Arch User Repository (Русский)">AUR</a>. В ней рассказывается о создании файла описания сборки пакета — <a href="../ru/PKGBUILD.html" title="PKGBUILD (Русский)">PKGBUILD</a>, используемого утилитой <code>makepkg</code> для создания бинарного пакета из исходного кода. Если у вас уже есть <code>PKGBUILD</code>, смотрите статью <a href="../ru/Makepkg.html" title="Makepkg (Русский)">makepkg (Русский)</a>. Инструкции относительно существующих правил и способов улучшения качества пакетов описаны в статье <a href="../en/1b1f00baa8bea2eae32e7ad4e72d1fac.html" class="mw-redirect" title="Стандарты создания пакетов для Arch">Стандарты создания пакетов для Arch</a>.
</p>
<meta property="mw:PageProp/toc">
<div class="mw-heading mw-heading2"><h2 id="Обзор">
<span id=".D0.9E.D0.B1.D0.B7.D0.BE.D1.80"></span>Обзор</h2></div>
<p>Пакеты в Arch Linux собираются с помощью утилиты <a href="../ru/Makepkg.html" title="Makepkg (Русский)">makepkg</a> и информации, хранящейся в файле <a href="../ru/PKGBUILD.html" title="PKGBUILD (Русский)">PKGBUILD</a>. При запуске <code>makepkg</code> ищет <code>PKGBUILD</code> в текущем каталоге и выполняет записанные в нём инструкции для получения необходимых файлов и/или их компиляции для упаковки в файл пакета (<code>pkgname.pkg.tar.zst</code>). Полученный пакет содержит двоичные файлы и инструкции по установке, готовые к установке с помощью <a href="../ru/Pacman.html" title="Pacman (Русский)">pacman</a>.
</p>
<p>Пакет Arch — это не более чем tar-архив, или «tarball», сжатый с помощью <span class="plainlinks archwiki-template-man" title="$ man 1 zstd"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/zstd.1">zstd(1)</a></span>, который содержит следующие созданные утилитой makepkg файлы:
</p>
<ul>
<li>Бинарные файлы для установки.</li>
<li>
<code>.PKGINFO</code>: содержит все метаданные, необходимые pacman для работы с пакетами, зависимостями и т.д.</li>
<li>
<code>.BUILDINFO</code>: содержит информацию, необходимую для воспроизводимых сборок. Этот файл присутствует, только если пакет собран с помощью pacman 5.1 или более новой версии. См. <span class="plainlinks archwiki-template-man" title="$ man 5 BUILDINFO"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/BUILDINFO.5">BUILDINFO(5)</a></span>.</li>
<li>
<code>.MTREE</code>: содержит хэши и временные метки файлов, которые включаются в локальную базу данных, чтобы pacman мог проверить целостность пакета.</li>
<li>
<code>.INSTALL</code>: необязательный файл, используемый для выполнения команд после этапа установки/обновления/удаления. (Этот файл присутствует, только если он указан в <code>PKGBUILD</code>).</li>
<li>
<code>.Changelog</code>: необязательный файл, хранящийся у сопровождающего пакета и документирующий изменения пакета. (Он присутствует не во всех пакетах).</li>
</ul>
<div class="mw-heading mw-heading2"><h2 id="Подготовка">
<span id=".D0.9F.D0.BE.D0.B4.D0.B3.D0.BE.D1.82.D0.BE.D0.B2.D0.BA.D0.B0"></span>Подготовка</h2></div>
<div class="mw-heading mw-heading3"><h3 id="Необходимое_программное_обеспечение">
<span id=".D0.9D.D0.B5.D0.BE.D0.B1.D1.85.D0.BE.D0.B4.D0.B8.D0.BC.D0.BE.D0.B5_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D0.BD.D0.BE.D0.B5_.D0.BE.D0.B1.D0.B5.D1.81.D0.BF.D0.B5.D1.87.D0.B5.D0.BD.D0.B8.D0.B5"></span>Необходимое программное обеспечение</h3></div>
<p>Сперва убедитесь, что необходимые инструменты <a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" title="Help:Reading (Русский)">установлены</a>: <a href="../ru/Meta_package_and_package_group.html#%D0%A0%D0%B0%D0%B7%D0%BD%D0%B8%D1%86%D0%B0_%D0%BC%D0%B5%D0%B6%D0%B4%D1%83_%D0%BC%D0%B5%D1%82%D0%B0-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%BC_%D0%B8_%D0%B3%D1%80%D1%83%D0%BF%D0%BF%D0%BE%D0%B9_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" title="Meta package and package group (Русский)">мета-пакета</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=base-devel">base-devel</a></span> должно быть достаточно; он подтягивает <code>make</code> и дополнительные инструменты, необходимые для компиляции из исходного кода.
</p>
<p>Ключевым инструментом для сборки пакетов является <a href="../ru/Makepkg.html" title="Makepkg (Русский)">makepkg</a> (предоставляется пакетом <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pacman">pacman</a></span>), который делает следующее:
</p>
<ol>
<li>Проверяет, установлены ли зависимости пакета.</li>
<li>Загружает исходные файлы с указанного сервера(ов).</li>
<li>Распаковывает исходные файлы.</li>
<li>Компилирует программу и устанавливает её в окружении fakeroot.</li>
<li>Удаляет символы из двоичных файлов и библиотек.</li>
<li>Генерирует метафайл пакета, который включается в каждый пакет.</li>
<li>Сжимает окружение fakeroot в файл пакета.</li>
<li>Сохраняет файл пакета в настроенном каталоге назначения, который по умолчанию является текущим рабочим каталогом.</li>
</ol>
<div class="mw-heading mw-heading3"><h3 id="Загрузка_и_тестирование_установки">
<span id=".D0.97.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BA.D0.B0_.D0.B8_.D1.82.D0.B5.D1.81.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D1.83.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B8"></span>Загрузка и тестирование установки</h3></div>
<p>Загрузите исходный tarball программы, которую хотите упаковать, распакуйте его и следуйте указаниям автора для установки программы. Запишите все команды и/или шаги, необходимые для компиляции и установки. Вы будете повторять эти же команды в файле <code>PKGBUILD</code>.
</p>
<p>Большинство авторов программ придерживаются трёхэтапного цикла сборки:
</p>
<pre>./configure
make
make install
</pre>
<p>Это подходящее время, чтобы убедиться, что программа работает правильно.
</p>
<div class="mw-heading mw-heading3"><h3 id="Установка_в_чистый_chroot">
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_.D0.B2_.D1.87.D0.B8.D1.81.D1.82.D1.8B.D0.B9_chroot"></span>Установка в чистый chroot</h3></div>
<p>Рекомендуется следовать <a href="../DeveloperWiki:Building_in_a_clean_chroot.html" title="DeveloperWiki:Building in a clean chroot">DeveloperWiki:Building in a clean chroot</a>, чтобы убедиться, что пакеты и конфигурация вашей системы не приведут к ошибкам в PKGBUILD. Это более надёжный и корректный способ сборки пакетов, позволяющий обнаружить отсутствующие зависимости, о необходимости которых вы не подозревали, поскольку они уже присутствовали в вашей системе.
</p>
<div class="mw-heading mw-heading2"><h2 id="Создание_PKGBUILD">
<span id=".D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D0.B5_PKGBUILD"></span>Создание PKGBUILD</h2></div>
<p>При запуске <code>makepkg</code> ищет в текущем рабочем каталоге файл <code>PKGBUILD</code>. Если он найден, то загружает исходный код программы и компилирует его в соответствии с инструкциями, указанными в файле <code>PKGBUILD</code>. Инструкции должны быть полностью интерпретируемы оболочкой <a href="https://en.wikipedia.org/wiki/ru:Bash" class="extiw" title="wikipedia:ru:Bash">Bash</a>. После успешного завершения результирующие двоичные файлы и метаданные пакета, то есть версия пакета и зависимости, упаковываются в файл пакета <code>pkgname.pkg.tar.zst</code>. Получившийся пакет можно установить, просто используя <code>makepkg --install</code>, который вызовет pacman в фоновом режиме, или непосредственно используя <code>pacman -U <i>pkgname.pkg.tar.zst</i></code>.
</p>
<p>Чтобы начать сборку нового пакета, сначала создайте новый каталог для пакета и измените текущий каталог на него. Затем необходимо создать файл <code>PKGBUILD</code>: можно использовать прототип PKGBUILD, находящийся в <code>/usr/share/pacman/</code>, или начать с файла <code>PKGBUILD</code> из другого пакета. Последний вариант может оказаться удобным, если уже существует похожий пакет.
</p>
<div class="mw-heading mw-heading3"><h3 id="Определение_переменных_PKGBUILD">
<span id=".D0.9E.D0.BF.D1.80.D0.B5.D0.B4.D0.B5.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D0.B5.D1.80.D0.B5.D0.BC.D0.B5.D0.BD.D0.BD.D1.8B.D1.85_PKGBUILD"></span>Определение переменных PKGBUILD</h3></div>
<p>Примеры PKGBUILD находятся в <code>/usr/share/pacman/</code>. Объяснение возможных переменных <code>PKGBUILD</code> можно найти в статье <a href="../ru/PKGBUILD.html" title="PKGBUILD (Русский)">PKGBUILD (Русский)</a>.
</p>
<p><i>makepkg</i> определяет две переменные, которые следует использовать в процессе сборки и установки:
</p>
<dl>
<dt><code>srcdir</code></dt>
<dd>Указывает на каталог, в который <i>makepkg</i> помещает файлы, указанные в массиве source.</dd>
</dl>
<dl>
<dt><code>pkgdir</code></dt>
<dd>Указывает на каталог, в который <i>makepkg</i> собирает установленный пакет, который становится корневым каталогом вашего собранного пакета.</dd>
</dl>
<p>Они содержат <i>абсолютные</i> пути — это означает, что при правильном использовании этих переменных вам не нужно беспокоиться о своём рабочем каталоге.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание</strong> <i>makepkg</i>, а значит, и функции <code>build()</code> и <code>package()</code>, предназначены для неинтерактивной работы. Интерактивные утилиты или скрипты, вызываемые в этих функциях, могут нарушить работу <i>makepkg</i>, особенно если они вызываются с включенным протоколированием сборки (<code>--log</code>). (См. <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/13214">FS#13214</a>.)</div>
<div class="mw-heading mw-heading3"><h3 id="Функции_PKGBUILD">
<span id=".D0.A4.D1.83.D0.BD.D0.BA.D1.86.D0.B8.D0.B8_PKGBUILD"></span>Функции PKGBUILD</h3></div>
<p>При сборке пакета <code>makepkg</code> будет вызывать следующие пять функций, если они определены в PKGBUILD. Функция <code>package()</code> является обязательной в каждом PKGBUILD и будет вызываться всегда. Если какая-либо из других функций не определена, то <code>makepkg</code> просто пропустит вызов этой функции.
</p>
<p>Во время сборки функции вызываются в том порядке, в котором они перечислены здесь.
</p>
<div class="mw-heading mw-heading4"><h4 id="prepare()">
<span id="prepare.28.29"></span>prepare()</h4></div>
<p>С помощью этой функции выполняются команды, используемые для подготовки исходных текстов к сборке, например <a href="../en/Patching_packages.html" title="Patching packages">применение патчей</a>. Эта функция запускается сразу после извлечения пакета, перед <a href="#pkgver()">pkgver()</a> и функцией сборки. Если извлечение пропущено (<code>makepkg --noextract</code>), то <code>prepare()</code> не выполняется.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание</strong> (Из <span class="plainlinks archwiki-template-man" title="$ man 5 PKGBUILD"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/PKGBUILD.5">PKGBUILD(5)</a></span>) Функция выполняется в режиме <code>bash -e</code>, то есть любая команда, которая завершает работу с ненулевым статусом, приводит к выходу из функции.</div>
<p>Когда неясно, куда поместить ту или иную функцию — в <code>prepare()</code> или <code>build()</code>, можно воспользоваться эмпирическим правилом: помещать в <code>prepare()</code> те шаги, которые должны выполняться ровно один раз после извлечения исходных текстов, а в <code>build()</code> — те шаги, которые имеет смысл повторно выполнять после внесения любых ручных правок в извлечённые файлы.
</p>
<div class="mw-heading mw-heading4"><h4 id="pkgver()">
<span id="pkgver.28.29"></span>pkgver()</h4></div>
<p><code>pkgver()</code> запускается после извлечения исходных текстов, их распаковки и выполнения <a href="#prepare()">prepare()</a>. Таким образом, переменную pkgver можно обновить на этапе makepkg.
</p>
<p>Это особенно полезно при <a href="../en/VCS_package_guidelines.html" title="VCS package guidelines">создании пакетов git/svn/hg/etc.</a>, когда процесс сборки может оставаться неизменным, но исходники могут обновляться каждый день, а то и каждый час. Старый способ сделать это заключался в том, чтобы поместить дату в поле pkgver, но тогда даже если если программа не обновлялась, то makepkg все равно пересобирал её из-за изменившегося номера версии. Некоторые полезные команды для этого — <code>git describe</code>, <code>hg identify -ni</code> и т. д. Пожалуйста, проверяйте их перед отправкой PKGBUILD, так как сбой в функции <code>pkgver()</code> может остановить сборку на корню.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание</strong> pkgver не может содержать пробелы или дефисы (<code>-</code>). Для исправления этого часто используется sed.</div>
<div class="mw-heading mw-heading4"><h4 id="build()">
<span id="build.28.29"></span>build()</h4></div>
<p>Теперь необходимо реализовать функцию <code>build()</code> в файле <code>PKGBUILD</code>. Эта функция использует обычные команды оболочки в синтаксисе <a href="https://en.wikipedia.org/wiki/ru:Bash" class="extiw" title="wikipedia:ru:Bash">Bash</a> для автоматической компиляции программ и создания каталога <code>pkg</code> для их установки. Она позволяет <i>makepkg</i> упаковывать файлы без необходимости рыться в файловой системе.
</p>
<p>Первым шагом в функции <code>build()</code> является переход в каталог, созданный в результате распаковки архива с исходным кодом. <i>makepkg</i> изменит текущий каталог на <code>$srcdir</code> перед выполнением функции <code>build()</code>. Поэтому в большинстве случаев, как это предлагается в <code>/usr/share/pacman/PKGBUILD.proto</code>, первая команда будет выглядеть следующим образом:
</p>
<pre>cd "$pkgname-$pkgver"
</pre>
<p>Теперь необходимо прописать те же команды, которые использовались при ручной компиляции программы. Функция <code>build()</code>, по сути, автоматизирует всё, что вы делали вручную, и компилирует программу в среде сборки fakeroot. Если в упаковываемом программном обеспечении используется скрипт configure, то при сборке пакетов для pacman рекомендуется использовать <code>--prefix=/usr</code>. Многие программы устанавливают файлы относительно каталога <code>/usr/local</code>, что следует делать только в случае ручной сборки из исходных текстов. Все пакеты Arch Linux должны использовать каталог <code>/usr</code>. Как видно из файла <code>/usr/share/pacman/PKGBUILD.proto</code>, следующие две строки часто выглядят следующим образом:
</p>
<pre>./configure --prefix=/usr
make
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание</strong> Если вашей программе не требуется сборка — не используйте функцию <code>build()</code>. Функция <code>build()</code> не является обязательной, а вот <code>package()</code> является таковой.</div>
<div class="mw-heading mw-heading4"><h4 id="check()">
<span id="check.28.29"></span>check()</h4></div>
<p>Место для вызовов <code>make check</code> и аналогичных процедур проверки. Настоятельно рекомендуется иметь <code>check()</code>, так как проверка помогает убедиться в том, что программа правильно и хорошо работает с зависимостями.
</p>
<p>Пользователи, которым она не нужна (а иногда и сопровождающие, которые не могут исправить пакет для её прохождения), могут отключить её, добавив <code>!check</code> в массив <code>options</code> в <code>PKGBUILD</code>/<span class="plainlinks archwiki-template-man" title="$ man 5 makepkg.conf"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/makepkg.conf.5">makepkg.conf(5)</a></span> или вызвать <code>makepkg</code> с флагом <code>--nocheck</code>.
</p>
<div class="mw-heading mw-heading4"><h4 id="package()">
<span id="package.28.29"></span>package()</h4></div>
<p>Последним шагом является помещение скомпилированных файлов в каталог, из которого <i>makepkg</i> сможет получить их для создания пакета. По умолчанию это каталог <code>pkg</code> — простая среда fakeroot. Каталог <code>pkg</code> повторяет иерархию корневой файловой системы путей установки программного обеспечения. Если вам приходится вручную размещать файлы в корне вашей файловой системы, то их следует устанавливать в каталог <code>pkg</code> в той же структуре каталогов. Например, если вы хотите установить файл в <code>/usr/bin</code>, то вместо этого его следует поместить в <code>$pkgdir/usr/bin</code>. Лишь немногие процедуры установки требуют от пользователя копирования десятков файлов вручную. Вместо этого для большинства программ достаточно вызвать команду <code>make install</code>. Для корректной установки программы в каталог <code>pkg</code> последняя строка должна выглядеть следующим образом:
</p>
<pre>make DESTDIR="$pkgdir/" install
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание</strong> В некоторых случаях в <code>Makefile</code> не используется <code>DESTDIR</code>; вместо него может потребоваться использовать <code>prefix</code>. Если пакет собран с помощью <i>autoconf</i> / <i>automake</i>, используйте <code>DESTDIR</code>; именно это <a rel="nofollow" class="external text" href="https://www.gnu.org/software/automake/manual/automake.html#Install">документировано</a> в руководствах. Если <code>DESTDIR</code> не работает, попробуйте собрать с помощью <code>make prefix="$pkgdir/usr/" install</code>. Если и это не сработает, то придётся подробнее изучить команды установки, выполняемые командой "<code>make &lt;...&gt; install</code>".</div>
<p><code>makepkg --repackage</code> запускает только функцию <code>package()</code>, то есть создаёт пакет без сборки. Это может сэкономить время, например, если вы изменили только переменную <code>depends</code> пакета.
</p>
<div class="mw-heading mw-heading2"><h2 id="Тестирование_PKGBUILD_и_пакета">
<span id=".D0.A2.D0.B5.D1.81.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_PKGBUILD_.D0.B8_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.B0"></span>Тестирование PKGBUILD и пакета</h2></div>
<p>В процессе написания функции <code>build()</code> необходимо часто тестировать изменения, чтобы убедиться в отсутствии ошибок. Это можно сделать с помощью команды <code>makepkg</code> в каталоге, содержащем файл <code>PKGBUILD</code>. При правильно оформленном <code>PKGBUILD</code> makepkg создаст пакет; при неработающем или незавершённом <code>PKGBUILD</code> она выдаст ошибку.
</p>
<p>При успешном завершении работы makepkg поместит в рабочий каталог файл с именем <code>pkgname-pkgver.pkg.tar.zst</code>. Этот пакет может быть установлен командой <code>pacman -U</code>. Однако то, что файл пакета был собран, не означает, что он полностью работоспособен. Он может содержать только каталог и ни одного файла, если, например, неправильно указан префикс. С помощью функций запроса pacman можно вывести список файлов, содержащихся в пакете, и зависимостей, которые он требует, с помощью <code>pacman -Qlp [package file]</code> и <code>pacman -Qip [package file]</code> соответственно.
</p>
<p>Если пакет выглядит нормально, то все готово! Однако если вы планируете опубликовать файл <code>PKGBUILD</code>, то обязательно проверьте и перепроверьте содержимое массива <code>depends</code>.
</p>
<p>Также убедитесь, что двоичные файлы пакета действительно <i>работают</i> безупречно! Очень неприятно выпускать пакет, содержащий все необходимые файлы, но аварийно завершающий работу из-за непонятной опции конфигурации, которая не совсем корректно работает с остальной частью системы. Впрочем, если вы собираете пакеты только для себя, то можно об этом не слишком беспокоиться, ведь в конце концов от своих ошибок будете страдать только вы.
</p>
<div class="mw-heading mw-heading3"><h3 id="Проверка_целостности_пакета">
<span id=".D0.9F.D1.80.D0.BE.D0.B2.D0.B5.D1.80.D0.BA.D0.B0_.D1.86.D0.B5.D0.BB.D0.BE.D1.81.D1.82.D0.BD.D0.BE.D1.81.D1.82.D0.B8_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.B0"></span>Проверка целостности пакета</h3></div>
<p>После тестирования работоспособности пакета проверьте его на наличие ошибок с помощью <a href="../en/Namcap.html" title="Namcap">namcap</a>:
</p>
<pre>$ namcap PKGBUILD
$ namcap <i>&lt;имя файла пакета&gt;</i>.pkg.tar.zst
</pre>
<p>Namcap выполнит:
</p>
<ol>
<li>Проверку содержимого PKGBUILD на наличие типичных ошибок и иерархию файлов пакета на наличие ненужных или неправильно размещённых файлов</li>
<li>Сканирование всех ELF-файлов пакета с помощью <code>ldd</code>, автоматически сообщая, какие пакеты с необходимыми разделяемыми библиотеками отсутствуют в <code>depends</code>, а какие могут быть опущены как транзитивные зависимости</li>
<li>Эвристический поиск отсутствующих и избыточных зависимостей</li>
</ol>
<p>и многое другое.
</p>
<p>Возьмите за привычку проверять свои пакеты с помощью namcap во избежание необходимости исправлять простейшие ошибки после отправки пакета.
</p>
<div class="mw-heading mw-heading3"><h3 id="Использование_pkgctl_для_сборки_в_чистом_chroot-окружении">
<span id=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_pkgctl_.D0.B4.D0.BB.D1.8F_.D1.81.D0.B1.D0.BE.D1.80.D0.BA.D0.B8_.D0.B2_.D1.87.D0.B8.D1.81.D1.82.D0.BE.D0.BC_chroot-.D0.BE.D0.BA.D1.80.D1.83.D0.B6.D0.B5.D0.BD.D0.B8.D0.B8"></span>Использование pkgctl для сборки в чистом chroot-окружении</h3></div>
<p>Вы можете использовать <code>pkgctl</code> из <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=devtools">devtools</a></span> для проверки возможно ли собрать пакет там, где ещё не установлены другие пакеты. Находясь в каталоге PKGBUILD выполнить:
</p>
<pre>$ pkgctl build
</pre>
<p>И проверьте вывод на наличие возможных ошибок или предупреждений. Если пакет зависит от других пакетов AUR, эти пакеты должны быть собраны и перенесены в окружение chroot:
</p>
<pre>$ pkgctl build -I path/to/somepkg.tar.gz -I ...
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание</strong>  Если пакет установлен с помощью помощника AUR, велика вероятность того, что его tarball можно найти в его кэш-каталоге.</div>
<p>Дополнительные опции см. в <span class="plainlinks archwiki-template-man" title="$ man 1 pkgctl-build"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/pkgctl-build.1">pkgctl-build(1)</a></span>.
</p>
<div class="mw-heading mw-heading2"><h2 id="Отправка_пакетов_в_AUR">
<span id=".D0.9E.D1.82.D0.BF.D1.80.D0.B0.D0.B2.D0.BA.D0.B0_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2_.D0.B2_AUR"></span>Отправка пакетов в AUR</h2></div>
<p>Пожалуйста, прочитайте <a href="../ru/AUR_submission_guidelines.html" title="AUR submission guidelines (Русский)">правила отправки пакетов в AUR</a>, где подробно описан процесс отправки.
</p>
<div class="mw-heading mw-heading2"><h2 id="Резюме">
<span id=".D0.A0.D0.B5.D0.B7.D1.8E.D0.BC.D0.B5"></span>Резюме</h2></div>
<ol>
<li>Загрузите исходный архив программы, для которой создаётся пакет.</li>
<li>Попробуйте скомпилировать пакет и установить его в произвольный каталог.</li>
<li>Скопируйте прототип <code>/usr/share/pacman/PKGBUILD.proto</code> и переименуйте его в <code>PKGBUILD</code> во временный рабочий каталог.</li>
<li>Отредактируйте <code>PKGBUILD</code> в соответствии с потребностями вашего пакета.</li>
<li>Запустите <code>makepkg</code> и проверьте, правильно ли собран пакет.</li>
<li>Если нет - повторите два предыдущих шага.</li>
</ol>
<div class="mw-heading mw-heading3"><h3 id="Предупреждения">
<span id=".D0.9F.D1.80.D0.B5.D0.B4.D1.83.D0.BF.D1.80.D0.B5.D0.B6.D0.B4.D0.B5.D0.BD.D0.B8.D1.8F"></span>Предупреждения</h3></div>
<ul>
<li>Прежде чем автоматизировать процесс сборки пакета, необходимо хотя бы раз выполнить его вручную, если только вы не знаете <i>точно</i>, что делаете, <i>заранее</i>, но в этом случае вы бы не читали эту статью. К сожалению, хотя многие авторы программ придерживаются трёхэтапного цикла сборки "<code>./configure</code>; <code>make</code>; <code>make install</code>", он не всегда таков, и ситуация может стать очень неприятной, если придётся применять патчи, чтобы вообще заставить всё работать. Правило: если вы не можете заставить программу скомпилироваться из исходного архива и установить себя в определённый временный подкаталог — не стоит даже пытаться упаковать её. В <code>makepkg</code> нет волшебной пыльцы фей, избавляющей от проблем.</li>
<li>В некоторых случаях пакеты вообще недоступны в виде исходных текстов, и для того, чтобы заставить их работать, приходится использовать что-то вроде <code>sh installer.run</code>. Вам придётся провести довольно много исследований (прочитать README, инструкции INSTALL, man-страницы, возможно, ebuild'ы от Gentoo или других программ установки пакетов, возможно, даже MAKEFILE или исходный код), чтобы заставить их работать. В некоторых очень запущенных случаях приходится редактировать исходные файлы, чтобы заставить их работать. Однако <code>makepkg</code> должен отработать полностью автономно, без участия пользователя. Поэтому если необходимо отредактировать make-файлы, то, возможно, придётся дополнить <code>PKGBUILD</code> патчем и применять его в функции <code>prepare()</code>, либо выполнить несколько команд <code>sed</code> внутри функции <code>prepare()</code>.</li>
</ul>
<div class="mw-heading mw-heading2"><h2 id="Более_подробные_руководства">
<span id=".D0.91.D0.BE.D0.BB.D0.B5.D0.B5_.D0.BF.D0.BE.D0.B4.D1.80.D0.BE.D0.B1.D0.BD.D1.8B.D0.B5_.D1.80.D1.83.D0.BA.D0.BE.D0.B2.D0.BE.D0.B4.D1.81.D1.82.D0.B2.D0.B0"></span>Более подробные руководства</h2></div>
<div class="archwiki-template-navigation">
<b><a href="../ru/Arch_package_guidelines.html" title="Arch package guidelines (Русский)">Указания по созданию пакетов</a></b>
<hr>
<p><a href="../en/32-bit_package_guidelines.html" title="32-bit package guidelines">32-bit</a> – <a href="../ru/CLR_package_guidelines.html" title="CLR package guidelines (Русский)">CLR</a> – <a href="../en/CMake_package_guidelines.html" title="CMake package guidelines">CMake</a> – <a href="../ru/Cross-compiling_tools_package_guidelines.html" title="Cross-compiling tools package guidelines (Русский)">Cross</a> – <a href="../en/DKMS_package_guidelines.html" title="DKMS package guidelines">DKMS</a> – <a href="../en/Eclipse_plugin_package_guidelines.html" title="Eclipse plugin package guidelines">Eclipse</a> – <a href="../en/Electron_package_guidelines.html" title="Electron package guidelines">Electron</a> – <a href="../en/Font_package_guidelines.html" title="Font package guidelines">Font</a> – <a href="../en/Free_Pascal_package_guidelines.html" title="Free Pascal package guidelines">Free Pascal</a> – <a href="../ru/GNOME_package_guidelines.html" title="GNOME package guidelines (Русский)">GNOME</a> – <a href="../en/Go_package_guidelines.html" title="Go package guidelines">Go</a> – <a href="../en/Haskell_package_guidelines.html" title="Haskell package guidelines">Haskell</a> – <a href="../en/Java_package_guidelines.html" title="Java package guidelines">Java</a> – <a href="../en/KDE_package_guidelines.html" title="KDE package guidelines">KDE</a> – <a href="../en/Kernel_module_package_guidelines.html" title="Kernel module package guidelines">Kernel</a> – <a href="../en/Lisp_package_guidelines.html" title="Lisp package guidelines">Lisp</a> – <a href="../en/Meson_package_guidelines.html" title="Meson package guidelines">Meson</a> – <a href="../en/MinGW_package_guidelines.html" title="MinGW package guidelines">MinGW</a> – <a href="../en/Node.js_package_guidelines.html" title="Node.js package guidelines">Node.js</a> – <a href="../en/Nonfree_applications_package_guidelines.html" title="Nonfree applications package guidelines">Nonfree</a> – <a href="../en/OCaml_package_guidelines.html" title="OCaml package guidelines">OCaml</a> – <a href="../en/Perl_package_guidelines.html" title="Perl package guidelines">Perl</a> – <a href="../en/PHP_package_guidelines.html" title="PHP package guidelines">PHP</a> – <a href="../ru/Python_package_guidelines.html" title="Python package guidelines (Русский)">Python</a> – <a href="../en/R_package_guidelines.html" title="R package guidelines">R</a> – <a href="../en/Ruby_package_guidelines.html" title="Ruby package guidelines">Ruby</a> – <a href="../en/Rust_package_guidelines.html" title="Rust package guidelines">Rust</a> – <a href="../en/Shell_package_guidelines.html" title="Shell package guidelines">Shell</a> – <a href="../en/VCS_package_guidelines.html" title="VCS package guidelines">VCS</a> – <a href="../en/Web_application_package_guidelines.html" title="Web application package guidelines">Web</a> – <a href="../ru/Wine_package_guidelines.html" class="mw-redirect" title="Wine package guidelines (Русский)">Wine</a>
</p>
</div>
<div class="mw-heading mw-heading2"><h2 id="Автоматизация">
<span id=".D0.90.D0.B2.D1.82.D0.BE.D0.BC.D0.B0.D1.82.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D1.8F"></span>Автоматизация</h2></div>
<div class="mw-heading mw-heading3"><h3 id="Контрольные_суммы">
<span id=".D0.9A.D0.BE.D0.BD.D1.82.D1.80.D0.BE.D0.BB.D1.8C.D0.BD.D1.8B.D0.B5_.D1.81.D1.83.D0.BC.D0.BC.D1.8B"></span>Контрольные суммы</h3></div>
<p>Процесс обновления контрольных сумм для новых выпусков программ может быть автоматизирован с помощью инструмента <code>updpkgsums</code>; подробнее об этом см. в разделе <a href="../ru/Makepkg.html#%D0%92%D1%8B%D1%87%D0%B8%D1%81%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BD%D0%BE%D0%B2%D1%8B%D1%85_%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8C%D0%BD%D1%8B%D1%85_%D1%81%D1%83%D0%BC%D0%BC" title="Makepkg (Русский)">makepkg (Русский)#Вычисление новых контрольных сумм</a>.
</p>
<div class="mw-heading mw-heading3"><h3 id="Генераторы_PKGBUILD">
<span id=".D0.93.D0.B5.D0.BD.D0.B5.D1.80.D0.B0.D1.82.D0.BE.D1.80.D1.8B_PKGBUILD"></span>Генераторы PKGBUILD</h3></div>
<p>PKGBUILD для некоторых пакетов могут быть созданы автоматически.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание</strong> Пользователи по-прежнему несут ответственность за обеспечение соответствия пакета высоким стандартам качества перед отправкой созданных файлов в <a href="../ru/Arch_User_Repository.html" title="Arch User Repository (Русский)">AUR</a>.</div>
<ul>
<li>
<a href="../ru/Haskell.html" class="mw-redirect" title="Haskell (Русский)">Haskell</a>: <a rel="nofollow" class="external text" href="https://github.com/magthe/cblrepo">cblrepo</a>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=arch-hs">arch-hs</a></span>
</li>
<li>
<a href="../en/Node.js.html" title="Node.js">Node.js</a>: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/nodejs-npm2arch/">nodejs-npm2arch</a></span><sup><small>AUR</small></sup>
</li>
<li>
<a href="../en/Perl.html" title="Perl">Perl</a>: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/perl-cpanplus-dist-arch/">perl-cpanplus-dist-arch</a></span><sup><small>AUR</small></sup>
</li>
<li>
<a href="../ru/Python.html" title="Python (Русский)">Python</a>: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pipman-git/">pipman-git</a></span><sup><small>AUR</small></sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pip2arch-git/">pip2arch-git</a></span><sup><small>AUR</small></sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/python-pypi2pkgbuild/">python-pypi2pkgbuild</a></span><sup><small>AUR</small></sup>
</li>
<li>
<a href="../en/Ruby.html" title="Ruby">Ruby</a>: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/gem2arch/">gem2arch</a></span><sup><small>AUR</small></sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pacgem/">pacgem</a></span><sup><small>AUR</small></sup>
</li>
<li>
<a href="../ru/Rust.html" title="Rust (Русский)">Rust</a>: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/cargo-pkgbuild/">cargo-pkgbuild</a></span><sup><small>AUR</small></sup>
</li>
</ul>
<div class="mw-heading mw-heading2"><h2 id="Смотрите_также">
<span id=".D0.A1.D0.BC.D0.BE.D1.82.D1.80.D0.B8.D1.82.D0.B5_.D1.82.D0.B0.D0.BA.D0.B6.D0.B5"></span>Смотрите также</h2></div>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=91408">How to correctly create a patch file</a>.</li>
<li>
<a rel="nofollow" class="external text" href="https://github.com/archwomen/classroom-media/tree/master/classlogs">Arch Linux Classroom IRC Logs of classes about creating PKGBUILDs</a>.</li>
<li><a rel="nofollow" class="external text" href="https://www.linuxfromscratch.org/hints/downloads/files/fakeroot.txt">Fakeroot approach for package installation</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../ru/Category:About_Arch.html" title="Category:About Arch (Русский)">About Arch (Русский)</a></li>
<li><a href="../ru/Category:Package_development.html" title="Category:Package development (Русский)">Package development (Русский)</a></li>
</ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Creating_packages_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;oldid=857754">https://wiki.archlinux.org/index.php?title=Creating_packages_(Русский)&amp;oldid=857754</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 20 December 2025, at 19:59.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><picture><source media="(min-width: 500px)" srcset="/resources/assets/poweredby_mediawiki.svg" width="88" height="31"><img src="/resources/assets/mediawiki_compact.svg" width="25" height="25" loading="lazy"></picture></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-header-container vector-sticky-header-container no-font-mode-scale">
	<div id="vector-sticky-header" class="vector-sticky-header">
		<div class="vector-sticky-header-start">
			<div class="vector-sticky-header-icon-start vector-button-flush-left vector-button-flush-right" aria-hidden="true">
				<button class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-sticky-header-search-toggle" tabindex="-1" data-event-name="ui.vector-sticky-search-form.icon"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
			</button>
		</div>
			
		<div role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box">
			<div class="vector-typeahead-search-container">
				<div class="cdx-typeahead-search cdx-typeahead-search--show-thumbnail">
					<form action="/index.php" id="vector-sticky-search-form" class="cdx-search-input cdx-search-input--has-end-button">
						<div class="cdx-search-input__input-wrapper" data-search-loc="header-moved">
							<div class="cdx-text-input cdx-text-input--has-start-icon">
								<input class="cdx-text-input__input mw-searchInput" autocomplete="off" type="search" name="search" placeholder="Search ArchWiki">
								<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
							</div>
							<input type="hidden" name="title" value="Special:Search">
						</div>
						<button class="cdx-button cdx-search-input__end-button">Search</button>
					</form>
				</div>
			</div>
		</div>
		<div class="vector-sticky-header-context-bar">
				<nav aria-label="Contents" class="vector-toc-landmark">
						
					<div id="vector-sticky-header-toc" class="vector-dropdown mw-portlet mw-portlet-sticky-header-toc vector-sticky-header-toc vector-button-flush-left">
						<input type="checkbox" id="vector-sticky-header-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-sticky-header-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
						<label id="vector-sticky-header-toc-label" for="vector-sticky-header-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
						</label>
						<div class="vector-dropdown-content">
					
						<div id="vector-sticky-header-toc-unpinned-container" class="vector-unpinned-container">
						</div>
					
						</div>
					</div>
			</nav>
				<div class="vector-sticky-header-context-bar-primary" aria-hidden="true"><span class="mw-page-title-main">Creating packages (Русский)</span></div>
			</div>
		</div>
		<div class="vector-sticky-header-end" aria-hidden="true">
			<div class="vector-sticky-header-icons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-talk-sticky-header" tabindex="-1" data-event-name="talk-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbles mw-ui-icon-wikimedia-speechBubbles"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-subject-sticky-header" tabindex="-1" data-event-name="subject-sticky-header"><span class="vector-icon mw-ui-icon-article mw-ui-icon-wikimedia-article"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-history-sticky-header" tabindex="-1" data-event-name="history-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-history mw-ui-icon-wikimedia-wikimedia-history"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only mw-watchlink" id="ca-watchstar-sticky-header" tabindex="-1" data-event-name="watch-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-star mw-ui-icon-wikimedia-wikimedia-star"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only reading-lists-bookmark" id="ca-bookmark-sticky-header" tabindex="-1" data-event-name="watch-sticky-bookmark"><span class="vector-icon mw-ui-icon-wikimedia-bookmarkOutline mw-ui-icon-wikimedia-wikimedia-bookmarkOutline"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-edit-sticky-header" tabindex="-1" data-event-name="wikitext-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-wikiText mw-ui-icon-wikimedia-wikimedia-wikiText"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-ve-edit-sticky-header" tabindex="-1" data-event-name="ve-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-edit mw-ui-icon-wikimedia-wikimedia-edit"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-viewsource-sticky-header" tabindex="-1" data-event-name="ve-edit-protected-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-editLock mw-ui-icon-wikimedia-wikimedia-editLock"></span>

<span></span>
			</a>
		</div>
			<div class="vector-sticky-header-buttons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive" id="ca-addsection-sticky-header" tabindex="-1" data-event-name="addsection-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbleAdd-progressive mw-ui-icon-wikimedia-speechBubbleAdd-progressive"></span>

<span>Add topic</span>
			</a>
		</div>
			<div class="vector-sticky-header-icon-end">
				<div class="vector-user-links">
				</div>
			</div>
		</div>
	</div>
</div>
<div class="mw-portlet mw-portlet-dock-bottom emptyPortlet" id="p-dock-bottom">
	<ul>
		
	</ul>
</div>
</body>
</html>
