<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>pacman (Русский)/Tips and tricks (Русский) - ArchWiki</title>
<link rel="stylesheet" href="../../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Pacman_Русский_Tips_and_tricks_Русский rootpage-Pacman_Русский skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Обслуживание" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%9E%D0%B1%D1%81%D0%BB%D1%83%D0%B6%D0%B8%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Обслуживание</div>
		</a>
		
			<button aria-controls="toc-Обслуживание-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Обслуживание subsection</span>
			</button>
		
		<ul id="toc-Обслуживание-sublist" class="vector-toc-list">
			<li id="toc-Список_пакетов" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1</span>Список пакетов</div>
			</a>
			
			<ul id="toc-Список_пакетов-sublist" class="vector-toc-list">
				<li id="toc-С_версией" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A1_%D0%B2%D0%B5%D1%80%D1%81%D0%B8%D0%B5%D0%B9">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1.1</span>С версией</div>
			</a>
			
			<ul id="toc-С_версией-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-С_размером" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A1_%D1%80%D0%B0%D0%B7%D0%BC%D0%B5%D1%80%D0%BE%D0%BC">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1.2</span>С размером</div>
			</a>
			
			<ul id="toc-С_размером-sublist" class="vector-toc-list">
				<li id="toc-По_отдельности" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#%D0%9F%D0%BE_%D0%BE%D1%82%D0%B4%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1.2.1</span>По отдельности</div>
			</a>
			
			<ul id="toc-По_отдельности-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-С_зависимостями" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#%D0%A1_%D0%B7%D0%B0%D0%B2%D0%B8%D1%81%D0%B8%D0%BC%D0%BE%D1%81%D1%82%D1%8F%D0%BC%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1.2.2</span>С зависимостями</div>
			</a>
			
			<ul id="toc-С_зависимостями-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-С_датой" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A1_%D0%B4%D0%B0%D1%82%D0%BE%D0%B9">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1.3</span>С датой</div>
			</a>
			
			<ul id="toc-С_датой-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Не_в_группе_или_репозитории" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9D%D0%B5_%D0%B2_%D0%B3%D1%80%D1%83%D0%BF%D0%BF%D0%B5_%D0%B8%D0%BB%D0%B8_%D1%80%D0%B5%D0%BF%D0%BE%D0%B7%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1.4</span>Не в группе или репозитории</div>
			</a>
			
			<ul id="toc-Не_в_группе_или_репозитории-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-В_разработке" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%92_%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B5">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1.5</span>В разработке</div>
			</a>
			
			<ul id="toc-В_разработке-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Зависимости_пакета" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%97%D0%B0%D0%B2%D0%B8%D1%81%D0%B8%D0%BC%D0%BE%D1%81%D1%82%D0%B8_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%B0">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1.6</span>Зависимости пакета</div>
			</a>
			
			<ul id="toc-Зависимости_пакета-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Просмотр_пакетов" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.2</span>Просмотр пакетов</div>
			</a>
			
			<ul id="toc-Просмотр_пакетов-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Список_файлов_пакета_с_размером" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%B0_%D1%81_%D1%80%D0%B0%D0%B7%D0%BC%D0%B5%D1%80%D0%BE%D0%BC">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.3</span>Список файлов пакета с размером</div>
			</a>
			
			<ul id="toc-Список_файлов_пакета_с_размером-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Поиск_файлов_без_пакета-владельца" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D0%BE%D0%B8%D1%81%D0%BA_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%D0%B1%D0%B5%D0%B7_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%B0-%D0%B2%D0%BB%D0%B0%D0%B4%D0%B5%D0%BB%D1%8C%D1%86%D0%B0">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.4</span>Поиск файлов без пакета-владельца</div>
			</a>
			
			<ul id="toc-Поиск_файлов_без_пакета-владельца-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Отслеживание_созданных_пакетами_файлов-сирот" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9E%D1%82%D1%81%D0%BB%D0%B5%D0%B6%D0%B8%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%B0%D0%BC%D0%B8_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2-%D1%81%D0%B8%D1%80%D0%BE%D1%82">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.5</span>Отслеживание созданных пакетами файлов-сирот</div>
			</a>
			
			<ul id="toc-Отслеживание_созданных_пакетами_файлов-сирот-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Удаление_неиспользуемых_пакетов" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A3%D0%B4%D0%B0%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BD%D0%B5%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.6</span>Удаление неиспользуемых пакетов</div>
			</a>
			
			<ul id="toc-Удаление_неиспользуемых_пакетов-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Более_тщательное_определение_ненужных_пакетов" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%91%D0%BE%D0%BB%D0%B5%D0%B5_%D1%82%D1%89%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5_%D0%BE%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BD%D0%B5%D0%BD%D1%83%D0%B6%D0%BD%D1%8B%D1%85_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.7</span>Более тщательное определение ненужных пакетов</div>
			</a>
			
			<ul id="toc-Более_тщательное_определение_ненужных_пакетов-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Удаление_всех_пакетов,_кроме_базовых" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A3%D0%B4%D0%B0%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B2%D1%81%D0%B5%D1%85_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2,_%D0%BA%D1%80%D0%BE%D0%BC%D0%B5_%D0%B1%D0%B0%D0%B7%D0%BE%D0%B2%D1%8B%D1%85">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.8</span>Удаление всех пакетов, кроме базовых</div>
			</a>
			
			<ul id="toc-Удаление_всех_пакетов,_кроме_базовых-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Список_зависимостей_нескольких_пакетов" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA_%D0%B7%D0%B0%D0%B2%D0%B8%D1%81%D0%B8%D0%BC%D0%BE%D1%81%D1%82%D0%B5%D0%B9_%D0%BD%D0%B5%D1%81%D0%BA%D0%BE%D0%BB%D1%8C%D0%BA%D0%B8%D1%85_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.9</span>Список зависимостей нескольких пакетов</div>
			</a>
			
			<ul id="toc-Список_зависимостей_нескольких_пакетов-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Список_изменённых_файлов_для_резервного_копирования" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA_%D0%B8%D0%B7%D0%BC%D0%B5%D0%BD%D1%91%D0%BD%D0%BD%D1%8B%D1%85_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%D0%B4%D0%BB%D1%8F_%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%BD%D0%BE%D0%B3%D0%BE_%D0%BA%D0%BE%D0%BF%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.10</span>Список изменённых файлов для резервного копирования</div>
			</a>
			
			<ul id="toc-Список_изменённых_файлов_для_резервного_копирования-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Резервная_копия_базы_данных_pacman" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A0%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%BD%D0%B0%D1%8F_%D0%BA%D0%BE%D0%BF%D0%B8%D1%8F_%D0%B1%D0%B0%D0%B7%D1%8B_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85_pacman">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.11</span>Резервная копия базы данных pacman</div>
			</a>
			
			<ul id="toc-Резервная_копия_базы_данных_pacman-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Просмотр_списка_изменений_пакета" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80_%D1%81%D0%BF%D0%B8%D1%81%D0%BA%D0%B0_%D0%B8%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D0%B9_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%B0">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.12</span>Просмотр списка изменений пакета</div>
			</a>
			
			<ul id="toc-Просмотр_списка_изменений_пакета-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Установка_и_восстановление" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B8_%D0%B2%D0%BE%D1%81%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Установка и восстановление</div>
		</a>
		
			<button aria-controls="toc-Установка_и_восстановление-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Установка и восстановление subsection</span>
			</button>
		
		<ul id="toc-Установка_и_восстановление-sublist" class="vector-toc-list">
			<li id="toc-Установка_пакетов_с_CD/DVD_или_USB-накопителя" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2_%D1%81_CD/DVD_%D0%B8%D0%BB%D0%B8_USB-%D0%BD%D0%B0%D0%BA%D0%BE%D0%BF%D0%B8%D1%82%D0%B5%D0%BB%D1%8F">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Установка пакетов с CD/DVD или USB-накопителя</div>
			</a>
			
			<ul id="toc-Установка_пакетов_с_CD/DVD_или_USB-накопителя-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Собственный_локальный_репозиторий" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A1%D0%BE%D0%B1%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D1%8B%D0%B9_%D0%BB%D0%BE%D0%BA%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%80%D0%B5%D0%BF%D0%BE%D0%B7%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%B9">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>Собственный локальный репозиторий</div>
			</a>
			
			<ul id="toc-Собственный_локальный_репозиторий-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Сетевой_кэш_pacman_с_совместным_доступом" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A1%D0%B5%D1%82%D0%B5%D0%B2%D0%BE%D0%B9_%D0%BA%D1%8D%D1%88_pacman_%D1%81_%D1%81%D0%BE%D0%B2%D0%BC%D0%B5%D1%81%D1%82%D0%BD%D1%8B%D0%BC_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%BE%D0%BC">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3</span>Сетевой кэш pacman с совместным доступом</div>
			</a>
			
			<ul id="toc-Сетевой_кэш_pacman_с_совместным_доступом-sublist" class="vector-toc-list">
				<li id="toc-Кэш_только_на_чтение" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9A%D1%8D%D1%88_%D1%82%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE_%D0%BD%D0%B0_%D1%87%D1%82%D0%B5%D0%BD%D0%B8%D0%B5">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.1</span>Кэш только на чтение</div>
			</a>
			
			<ul id="toc-Кэш_только_на_чтение-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Overlay-монтирование_кэша_только_на_чтение" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Overlay-%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BA%D1%8D%D1%88%D0%B0_%D1%82%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE_%D0%BD%D0%B0_%D1%87%D1%82%D0%B5%D0%BD%D0%B8%D0%B5">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.2</span>Overlay-монтирование кэша только на чтение</div>
			</a>
			
			<ul id="toc-Overlay-монтирование_кэша_только_на_чтение-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Распределённый_кэш_только_на_чтение" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A0%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D1%91%D0%BD%D0%BD%D1%8B%D0%B9_%D0%BA%D1%8D%D1%88_%D1%82%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE_%D0%BD%D0%B0_%D1%87%D1%82%D0%B5%D0%BD%D0%B8%D0%B5">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.3</span>Распределённый кэш только на чтение</div>
			</a>
			
			<ul id="toc-Распределённый_кэш_только_на_чтение-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Кэш_на_чтение_и_запись" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9A%D1%8D%D1%88_%D0%BD%D0%B0_%D1%87%D1%82%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B8_%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D1%8C">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.4</span>Кэш на чтение и запись</div>
			</a>
			
			<ul id="toc-Кэш_на_чтение_и_запись-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Двухсторонний_кэш_на_основе_rsync" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%94%D0%B2%D1%83%D1%85%D1%81%D1%82%D0%BE%D1%80%D0%BE%D0%BD%D0%BD%D0%B8%D0%B9_%D0%BA%D1%8D%D1%88_%D0%BD%D0%B0_%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D0%B5_rsync">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.5</span>Двухсторонний кэш на основе rsync</div>
			</a>
			
			<ul id="toc-Двухсторонний_кэш_на_основе_rsync-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Динамический_обратный_прокси-кэш_на_основе_nginx" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%94%D0%B8%D0%BD%D0%B0%D0%BC%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%BE%D0%B1%D1%80%D0%B0%D1%82%D0%BD%D1%8B%D0%B9_%D0%BF%D1%80%D0%BE%D0%BA%D1%81%D0%B8-%D0%BA%D1%8D%D1%88_%D0%BD%D0%B0_%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D0%B5_nginx">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.6</span>Динамический обратный прокси-кэш на основе nginx</div>
			</a>
			
			<ul id="toc-Динамический_обратный_прокси-кэш_на_основе_nginx-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Кэширующий_прокси-сервер_Pacoloco" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9A%D1%8D%D1%88%D0%B8%D1%80%D1%83%D1%8E%D1%89%D0%B8%D0%B9_%D0%BF%D1%80%D0%BE%D0%BA%D1%81%D0%B8-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80_Pacoloco">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.7</span>Кэширующий прокси-сервер Pacoloco</div>
			</a>
			
			<ul id="toc-Кэширующий_прокси-сервер_Pacoloco-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Кэширующий_прокси-сервер_Flexo" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9A%D1%8D%D1%88%D0%B8%D1%80%D1%83%D1%8E%D1%89%D0%B8%D0%B9_%D0%BF%D1%80%D0%BE%D0%BA%D1%81%D0%B8-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80_Flexo">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.8</span>Кэширующий прокси-сервер Flexo</div>
			</a>
			
			<ul id="toc-Кэширующий_прокси-сервер_Flexo-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Синхронизация_кэша_пакетов_специальными_программами" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A1%D0%B8%D0%BD%D1%85%D1%80%D0%BE%D0%BD%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F_%D0%BA%D1%8D%D1%88%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2_%D1%81%D0%BF%D0%B5%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%BC%D0%B8_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B0%D0%BC%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.9</span>Синхронизация кэша пакетов специальными программами</div>
			</a>
			
			<ul id="toc-Синхронизация_кэша_пакетов_специальными_программами-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Предотвращение_нежелательной_очистки_кэша_пакетов" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%B5%D0%B4%D0%BE%D1%82%D0%B2%D1%80%D0%B0%D1%89%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BD%D0%B5%D0%B6%D0%B5%D0%BB%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9_%D0%BE%D1%87%D0%B8%D1%81%D1%82%D0%BA%D0%B8_%D0%BA%D1%8D%D1%88%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.10</span>Предотвращение нежелательной очистки кэша пакетов</div>
			</a>
			
			<ul id="toc-Предотвращение_нежелательной_очистки_кэша_пакетов-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Воссоздание_пакета_из_файловой_системы" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%92%D0%BE%D1%81%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%B0_%D0%B8%D0%B7_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2%D0%BE%D0%B9_%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D1%8B">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4</span>Воссоздание пакета из файловой системы</div>
			</a>
			
			<ul id="toc-Воссоздание_пакета_из_файловой_системы-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Список_установленных_пакетов" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA_%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%BD%D1%8B%D1%85_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.5</span>Список установленных пакетов</div>
			</a>
			
			<ul id="toc-Список_установленных_пакетов-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Установка_пакетов_по_списку" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2_%D0%BF%D0%BE_%D1%81%D0%BF%D0%B8%D1%81%D0%BA%D1%83">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.6</span>Установка пакетов по списку</div>
			</a>
			
			<ul id="toc-Установка_пакетов_по_списку-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Список_изменённых_файлов_пакетов" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA_%D0%B8%D0%B7%D0%BC%D0%B5%D0%BD%D1%91%D0%BD%D0%BD%D1%8B%D1%85_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.7</span>Список изменённых файлов пакетов</div>
			</a>
			
			<ul id="toc-Список_изменённых_файлов_пакетов-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Переустановка_всех_пакетов" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D0%B5%D1%80%D0%B5%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B2%D1%81%D0%B5%D1%85_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.8</span>Переустановка всех пакетов</div>
			</a>
			
			<ul id="toc-Переустановка_всех_пакетов-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Восстановление_локальной_базы_данных" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%92%D0%BE%D1%81%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BB%D0%BE%D0%BA%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9_%D0%B1%D0%B0%D0%B7%D1%8B_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.9</span>Восстановление локальной базы данных</div>
			</a>
			
			<ul id="toc-Восстановление_локальной_базы_данных-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Восстановление_USB-носителя_из_существующей_установки" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%92%D0%BE%D1%81%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_USB-%D0%BD%D0%BE%D1%81%D0%B8%D1%82%D0%B5%D0%BB%D1%8F_%D0%B8%D0%B7_%D1%81%D1%83%D1%89%D0%B5%D1%81%D1%82%D0%B2%D1%83%D1%8E%D1%89%D0%B5%D0%B9_%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.10</span>Восстановление USB-носителя из существующей установки</div>
			</a>
			
			<ul id="toc-Восстановление_USB-носителя_из_существующей_установки-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Просмотр_отдельного_файла_внутри_файла_.pkg" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80_%D0%BE%D1%82%D0%B4%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE_%D1%84%D0%B0%D0%B9%D0%BB%D0%B0_%D0%B2%D0%BD%D1%83%D1%82%D1%80%D0%B8_%D1%84%D0%B0%D0%B9%D0%BB%D0%B0_.pkg">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.11</span>Просмотр отдельного файла внутри файла .pkg</div>
			</a>
			
			<ul id="toc-Просмотр_отдельного_файла_внутри_файла_.pkg-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Список_приложений,_использующих_устаревшие_библиотеки" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA_%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B9,_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D1%8E%D1%89%D0%B8%D1%85_%D1%83%D1%81%D1%82%D0%B0%D1%80%D0%B5%D0%B2%D1%88%D0%B8%D0%B5_%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.12</span>Список приложений, использующих устаревшие библиотеки</div>
			</a>
			
			<ul id="toc-Список_приложений,_использующих_устаревшие_библиотеки-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Установка_контента_только_на_нужном_языке" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BA%D0%BE%D0%BD%D1%82%D0%B5%D0%BD%D1%82%D0%B0_%D1%82%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE_%D0%BD%D0%B0_%D0%BD%D1%83%D0%B6%D0%BD%D0%BE%D0%BC_%D1%8F%D0%B7%D1%8B%D0%BA%D0%B5">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.13</span>Установка контента только на нужном языке</div>
			</a>
			
			<ul id="toc-Установка_контента_только_на_нужном_языке-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Установка_пакетов_при_плохом_соединении" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2_%D0%BF%D1%80%D0%B8_%D0%BF%D0%BB%D0%BE%D1%85%D0%BE%D0%BC_%D1%81%D0%BE%D0%B5%D0%B4%D0%B8%D0%BD%D0%B5%D0%BD%D0%B8%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.14</span>Установка пакетов при плохом соединении</div>
			</a>
			
			<ul id="toc-Установка_пакетов_при_плохом_соединении-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Производительность" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%BE%D0%B8%D0%B7%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D1%8C">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Производительность</div>
		</a>
		
			<button aria-controls="toc-Производительность-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Производительность subsection</span>
			</button>
		
		<ul id="toc-Производительность-sublist" class="vector-toc-list">
			<li id="toc-Увеличение_скорости_загрузки" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A3%D0%B2%D0%B5%D0%BB%D0%B8%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D1%81%D0%BA%D0%BE%D1%80%D0%BE%D1%81%D1%82%D0%B8_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>Увеличение скорости загрузки</div>
			</a>
			
			<ul id="toc-Увеличение_скорости_загрузки-sublist" class="vector-toc-list">
				<li id="toc-Powerpill" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Powerpill">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.1</span>Powerpill</div>
			</a>
			
			<ul id="toc-Powerpill-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-wget" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#wget">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.2</span>wget</div>
			</a>
			
			<ul id="toc-wget-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-aria2" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#aria2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.3</span>aria2</div>
			</a>
			
			<ul id="toc-aria2-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Другие_приложения" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%94%D1%80%D1%83%D0%B3%D0%B8%D0%B5_%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.4</span>Другие приложения</div>
			</a>
			
			<ul id="toc-Другие_приложения-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Утилиты" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%A3%D1%82%D0%B8%D0%BB%D0%B8%D1%82%D1%8B">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Утилиты</div>
		</a>
		
			<button aria-controls="toc-Утилиты-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Утилиты subsection</span>
			</button>
		
		<ul id="toc-Утилиты-sublist" class="vector-toc-list">
			<li id="toc-Графические" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%93%D1%80%D0%B0%D1%84%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B5">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>Графические</div>
			</a>
			
			<ul id="toc-Графические-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading">pacman (Русский)/Tips and tricks (Русский)</h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 7 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-7" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">7 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-de mw-list-item"><a href="https://wiki.archlinux.de/title/Pacman-Tipps" title="Pacman-Tipps – Deutsch" lang="de" hreflang="de" class="interlanguage-link-target"><span>Deutsch</span></a></li>
<li class="interlanguage-link interwiki-en mw-list-item"><a href="../../en/Pacman/Tips_and_tricks.html" title="Pacman/Tips and tricks – English" lang="en" hreflang="en" class="interlanguage-link-target"><span>English</span></a></li>
<li class="interlanguage-link interwiki-es mw-list-item"><a href="../../es/Pacman/Tips_and_tricks.html" title="Pacman (Español)/Tips and tricks – español" lang="es" hreflang="es" class="interlanguage-link-target"><span>Español</span></a></li>
<li class="interlanguage-link interwiki-fr mw-list-item"><a href="../../fr/Pacman/Tips_and_tricks.html" title="Pacman (Français)/Tips and tricks – français" lang="fr" hreflang="fr" class="interlanguage-link-target"><span>Français</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Pacman_%E3%83%92%E3%83%B3%E3%83%88" title="Pacman ヒント – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-pt mw-list-item"><a href="../../pt/Pacman/Tips_and_tricks.html" title="Pacman (Português)/Tips and tricks – português" lang="pt" hreflang="pt" class="interlanguage-link-target"><span>Português</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/Pacman/Tips_and_tricks" title="Pacman/Tips and tricks – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"><div class="subpages">&lt; <a href="../../ru/Pacman.html" title="Pacman (Русский)">Pacman (Русский)</a>
</div></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="ru" dir="ltr">
<p><span>
</span>
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Состояние перевода:</strong> На этой странице представлен перевод статьи <a href="../../en/Pacman/Tips_and_tricks.html" title="Pacman/Tips and tricks">pacman/Tips and tricks</a>. Дата последней синхронизации: 19 мая 2023. Вы можете <a href="../../ru/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (Русский)">помочь</a> синхронизировать перевод, если в английской версии произошли <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Pacman/Tips_and_tricks&amp;diff=0&amp;oldid=777583">изменения</a>.</div>
<div class="archwiki-template-meta-related-articles">
<p>Ссылки по теме</p>
<ul>
<li><a href="../../ru/Mirrors.html" class="mw-redirect" title="Зеркала">Зеркала</a></li>
<li><a href="../../ru/Creating_packages.html" class="mw-redirect" title="Создание пакетов">Создание пакетов</a></li>
</ul>
</div>
<p>Полезные советы, которые расширят возможности используемых утилит и самого <i>pacman</i>, можно найти в статьях <a href="../../ru/Core_utilities.html" class="mw-redirect" title="Базовые утилиты">Базовые утилиты</a> и <a href="../../ru/Bash.html" title="Bash (Русский)">Bash</a>.
</p>
<meta property="mw:PageProp/toc">
<h2>
<span id=".D0.9E.D0.B1.D1.81.D0.BB.D1.83.D0.B6.D0.B8.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Обслуживание">Обслуживание</span>
</h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> В примерах ниже используется утилита <i>comm</i>, входные данные для которой должны быть предварительно отсортированы утилитой <i>sort</i>. Вместо этого можно использовать команды <code>grep -Fxf</code> и <code>grep -Fxvf</code>.
</div>
<p>Смотрите также <a href="../../ru/System_maintenance.html" class="mw-redirect" title="Обслуживание системы">Обслуживание системы</a>.
</p>
<h3>
<span id=".D0.A1.D0.BF.D0.B8.D1.81.D0.BE.D0.BA_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="Список_пакетов">Список пакетов</span>
</h3>
<h4>
<span id=".D0.A1_.D0.B2.D0.B5.D1.80.D1.81.D0.B8.D0.B5.D0.B9"></span><span class="mw-headline" id="С_версией">С версией</span>
</h4>
<p>При составлении отчётов об ошибках или обсуждении установленных пакетов может понадобиться составить список пакетов с версиями.
</p>
<ul>
<li>Пакеты, установленные <a href="../../ru/Pacman.html#%D0%9F%D1%80%D0%B8%D1%87%D0%B8%D0%BD%D0%B0_%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B8" class="mw-redirect" title="Причина установки">явно</a>: <code>pacman -Qe</code>.</li>
<li>Пакеты в <a href="../../ru/Meta_package_and_package_group.html" class="mw-redirect" title="Группа пакетов">группе</a> <code><i>группа</i></code>: <code>pacman -Sg <i>группа</i></code>.</li>
<li>Сторонние пакеты (как правило, скачаны и установлены вручную либо были удалены из репозиториев): <code>pacman -Qm</code>.</li>
<li>Пакеты из базы синхронизации: <code>pacman -Qn</code>.</li>
<li>Пакеты из базы синхронизации, установленные явно и не являющиеся зависимостями, в том числе опциональными: <code>pacman -Qent</code>.</li>
<li>Пакеты по регулярному выражению (regex): <code>pacman -Qs <i>regex</i></code>.</li>
<li>Пакеты по регулярному выражению с пользовательским форматом вывода (требуется пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=expac">expac</a></span>): <code>expac -s '%-30n %v' <i>regex</i></code>.</li>
</ul>
<h4>
<span id=".D0.A1_.D1.80.D0.B0.D0.B7.D0.BC.D0.B5.D1.80.D0.BE.D0.BC"></span><span class="mw-headline" id="С_размером">С размером</span>
</h4>
<p>При необходимости освободить место на жёстком диске полезно будет узнать размер установленных пакетов. Можно определить как размер каждого пакета в отдельности, так и суммарный размер пакета и его зависимостей.
</p>
<h5>
<span id=".D0.9F.D0.BE_.D0.BE.D1.82.D0.B4.D0.B5.D0.BB.D1.8C.D0.BD.D0.BE.D1.81.D1.82.D0.B8"></span><span class="mw-headline" id="По_отдельности">По отдельности</span>
</h5>
<p>Список установленных пакетов с размером:
</p>
<pre>$ LC_ALL=C pacman -Qi | awk '/^Name/{name=$3} /^Installed Size/{print $4$5, name}' | sort -h
</pre>
<h5>
<span id=".D0.A1_.D0.B7.D0.B0.D0.B2.D0.B8.D1.81.D0.B8.D0.BC.D0.BE.D1.81.D1.82.D1.8F.D0.BC.D0.B8"></span><span class="mw-headline" id="С_зависимостями">С зависимостями</span>
</h5>
<p>Размеры пакетов вместе с зависимостями (два способа):
</p>
<ul>
<li>Установите пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=expac">expac</a></span> и выполните <code>expac -H M '%m\t%n' | sort -h</code>.</li>
<li>Установите пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pacgraph/">pacgraph</a></span><sup><small>AUR</small></sup> и выполните <code>pacgraph -c</code>.</li>
</ul>
<p>Размер загружаемых пакетов (если <code><i>пакеты</i></code> не указать, то будет выведен список всех пакетов в базе синхронизации):
</p>
<pre>$ expac -S -H M '%k\t%n' <i>пакеты</i>
</pre>
<p>Размер и описание явно установленных пакетов, не входящих ни в <a href="../../ru/Meta_package_and_package_group.html#%D0%A0%D0%B0%D0%B7%D0%BD%D0%B8%D1%86%D0%B0_%D0%BC%D0%B5%D0%B6%D0%B4%D1%83_%D0%BC%D0%B5%D1%82%D0%B0-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%BC_%D0%B8_%D0%B3%D1%80%D1%83%D0%BF%D0%BF%D0%BE%D0%B9_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Мета-пакет">мета-пакет</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=base">base</a></span>, ни в <a href="../../ru/Meta_package_and_package_group.html" class="mw-redirect" title="Группа пакетов">группу пакетов</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/groups/x86_64/xorg/">xorg</a></span>:
</p>
<pre>$ expac -H M "%011m\t%-20n\t%10d" $(comm -23 &lt;(pacman -Qqen | sort) &lt;({ pacman -Qqg xorg; expac -l '\n' '%E' base; } | sort -u)) | sort -n
</pre>
<p>Список пакетов, которым требуется обновление, с размером загрузки:
</p>
<pre>$ expac -S -H M '%k\t%n' $(pacman -Qqu) | sort -sh
</pre>
<p>Список только необязательных зависимостей:
</p>
<pre>$ expac -S "%o" <i>пакет</i>
</pre>
<h4>
<span id=".D0.A1_.D0.B4.D0.B0.D1.82.D0.BE.D0.B9"></span><span class="mw-headline" id="С_датой">С датой</span>
</h4>
<p>Список последних 20 установленных пакетов при помощи <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=expac">expac</a></span>:
</p>
<pre>$ expac --timefmt='%Y-%m-%d %T' '%l\t%n' | sort | tail -n 20
</pre>
<p>или в секундах с начала эпохи (1970-01-01 UTC):
</p>
<pre>$ expac --timefmt=%s '%l\t%n' | sort -n | tail -n 20
</pre>
<h4>
<span id=".D0.9D.D0.B5_.D0.B2_.D0.B3.D1.80.D1.83.D0.BF.D0.BF.D0.B5_.D0.B8.D0.BB.D0.B8_.D1.80.D0.B5.D0.BF.D0.BE.D0.B7.D0.B8.D1.82.D0.BE.D1.80.D0.B8.D0.B8"></span><span class="mw-headline" id="Не_в_группе_или_репозитории">Не в группе или репозитории</span>
</h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> В разделе <a href="#%D0%A3%D0%B4%D0%B0%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BD%D0%B5%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2">#Удаление неиспользуемых пакетов</a> описано, как вывести список пакетов, которые были установлены как зависимости, но больше не нужны ни одному пакету.
</div>
<p>Список явно установленных пакетов не из <a href="../../ru/Meta_package_and_package_group.html#%D0%A0%D0%B0%D0%B7%D0%BD%D0%B8%D1%86%D0%B0_%D0%BC%D0%B5%D0%B6%D0%B4%D1%83_%D0%BC%D0%B5%D1%82%D0%B0-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%BC_%D0%B8_%D0%B3%D1%80%D1%83%D0%BF%D0%BF%D0%BE%D0%B9_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Мета-пакет">мета-пакета</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=base">base</a></span>:
</p>
<pre>$ comm -23 &lt;(pacman -Qqe | sort) &lt;(expac -l '\n' '%E' base | sort)
</pre>
<p>Список явно установленных пакетов, которые не входят в мета-пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=base">base</a></span> или <a href="../../ru/Meta_package_and_package_group.html" class="mw-redirect" title="Группа пакетов">группу пакетов</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/groups/x86_64/xorg/">xorg</a></span>:
</p>
<pre>$ comm -23 &lt;(pacman -Qqe | sort) &lt;({ pacman -Qqg xorg; expac -l '\n' '%E' base; } | sort -u)
</pre>
<p>Список установленных пакетов, которые не явлются зависимостями других пакетов и не принадлежат мета-пакету <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=base">base</a></span> или группе пакетов <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/groups/x86_64/xorg/">xorg</a></span>:
</p>
<pre>$ comm -23 &lt;(pacman -Qqt | sort) &lt;({ pacman -Qqg xorg; echo base; } | sort -u)
</pre>
<p>То же, но с описаниями:
</p>
<pre>$ expac -H M '%-20n\t%10d' $(comm -23 &lt;(pacman -Qqt | sort) &lt;({ pacman -Qqg xorg; echo base; } | sort -u))
</pre>
<p>Список пакетов, установленных <b>не</b> из репозитория <code><i>имя_репозитория</i></code>:
</p>
<pre>$ comm -23 &lt;(pacman -Qq | sort) &lt;(pacman -Sql <i>имя_репозитория</i> | sort)
</pre>
<p>Список пакетов, установленных <b>из</b> репозитория <code><i>имя_репозитория</i></code> :
</p>
<pre>$ comm -12 &lt;(pacman -Qq | sort) &lt;(pacman -Sql <i>имя_репозитория</i> | sort)
</pre>
<p>Список пакетов Arch Linux ISO, которые не входят в мета-пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=base">base</a></span>:
</p>
<pre>$ comm -23 &lt;(curl https://gitlab.archlinux.org/archlinux/archiso/-/raw/master/configs/releng/packages.x86_64) &lt;(expac -l '\n' '%E' base | sort)
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> В качестве альтернативы вместо <code>comm</code> можно использовать <code>combine</code> из пакета <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=moreutils">moreutils</a></span>, который имеет более простой для запоминания синтаксис. Смотрите <span class="plainlinks archwiki-template-man" title="$ man 1 combine"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/combine.1">combine(1)</a></span>.</div>
<h4>
<span id=".D0.92_.D1.80.D0.B0.D0.B7.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.BA.D0.B5"></span><span class="mw-headline" id="В_разработке">В разработке</span>
</h4>
<p>Список установленных пакетов, которые считаются нестабильными и/или находятся в стадии активной разработки:
</p>
<pre>$ pacman -Qq | grep -Ee '-(bzr|cvs|darcs|git|hg|svn)$'
</pre>
<h4>
<span id=".D0.97.D0.B0.D0.B2.D0.B8.D1.81.D0.B8.D0.BC.D0.BE.D1.81.D1.82.D0.B8_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.B0"></span><span class="mw-headline" id="Зависимости_пакета">Зависимости пакета</span>
</h4>
<p>Чтобы узнать список зависимостей пакета, можно посмотреть вывод команды:
</p>
<pre>$ pacman -Qi <i>пакет</i>
</pre>
<p>Для использования в скриптах, чтобы не приходилось парсить вывод этой команды, можно использовать <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=expac">expac</a></span>:
</p>
<pre>$ expac -S '%D' <i>пакет</i>
</pre>
<h3>
<span id=".D0.9F.D1.80.D0.BE.D1.81.D0.BC.D0.BE.D1.82.D1.80_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="Просмотр_пакетов">Просмотр пакетов</span>
</h3>
<p>Следующая команда выведет информацию об установленных пакетах:
</p>
<pre>$ pacman -Qq | fzf --preview 'pacman -Qil {}' --layout=reverse --bind 'enter:execute(pacman -Qil {} | less)'
</pre>
<p>Утилита <a href="../../en/Fzf.html" title="Fzf">fzf</a> выдаёт данные в терминал в виде двух панелей: названия пакетов слева, информация о них — справа.
</p>
<p>Начните вводить буквы, чтобы искать пакет по названию; навигация по списку — стрелками или комбинациями клавиш <code>Ctrl-j</code>/<code>Ctrl-k</code>; нажатие <code>Enter</code> выводит информацию о пакете в формате <i>less</i>.
</p>
<p>Следующая команда fzf позволяет просматривать пакеты, о которых знает <i>pacman</i> (и установленные, и не установленные):
</p>
<pre>$ pacman -Slq | fzf --preview 'pacman -Si {}' --layout=reverse
</pre>
<p>Клавиши для навигации те же, но <code>Enter</code> не работает.
</p>
<h3>
<span id=".D0.A1.D0.BF.D0.B8.D1.81.D0.BE.D0.BA_.D1.84.D0.B0.D0.B9.D0.BB.D0.BE.D0.B2_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.B0_.D1.81_.D1.80.D0.B0.D0.B7.D0.BC.D0.B5.D1.80.D0.BE.D0.BC"></span><span class="mw-headline" id="Список_файлов_пакета_с_размером">Список файлов пакета с размером</span>
</h3>
<p>Если какой-то пакет стал занимать слишком много места на диске и вы хотите понять, какие файлы в этом виноваты, выполните:
</p>
<pre>$ pacman -Qql <i>пакет</i> | grep -v '/$' | xargs -r du -h | sort -h
</pre>
<h3>
<span id=".D0.9F.D0.BE.D0.B8.D1.81.D0.BA_.D1.84.D0.B0.D0.B9.D0.BB.D0.BE.D0.B2_.D0.B1.D0.B5.D0.B7_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.B0-.D0.B2.D0.BB.D0.B0.D0.B4.D0.B5.D0.BB.D1.8C.D1.86.D0.B0"></span><span class="mw-headline" id="Поиск_файлов_без_пакета-владельца">Поиск файлов без пакета-владельца</span>
</h3>
<p>Если в вашей системе появились файлы, которые не принадлежат ни одному пакету (обычная ситуация, если вы не <a href="../../ru/System_maintenance.html#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B9%D1%82%D0%B5_%D0%BC%D0%B5%D0%BD%D0%B5%D0%B4%D0%B6%D0%B5%D1%80_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2_%D0%B4%D0%BB%D1%8F_%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B8_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%BD%D0%BE%D0%B3%D0%BE_%D0%BE%D0%B1%D0%B5%D1%81%D0%BF%D0%B5%D1%87%D0%B5%D0%BD%D0%B8%D1%8F" class="mw-redirect" title="Обслуживание системы">используете пакетный менеджер для установки программ</a>), то стоит их найти и удалить.
</p>
<p>Первый способ найти такие файлы — командой <code>pacreport --unowned-files</code> (пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pacutils">pacutils</a></span>) с правами root, которая, помимо прочего, выведет список "ничьих" файлов.
</p>
<p>Второй — составить список интересующих файлов и проверить их через <i>pacman</i>:
</p>
<pre># find /etc /usr /opt | LC_ALL=C pacman -Qqo - 2&gt;&amp;1 &gt;&amp;- &gt;/dev/null | cut -d ' ' -f 5-
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> Скрипт <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lostfiles">lostfiles</a></span> делает то же самое, но в нём также используется обширный чёрный список для удаления из вывода наиболее часто встречающихся "ложных срабатываний".
</div>
<h3>
<span id=".D0.9E.D1.82.D1.81.D0.BB.D0.B5.D0.B6.D0.B8.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D1.81.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.BD.D1.8B.D1.85_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.B0.D0.BC.D0.B8_.D1.84.D0.B0.D0.B9.D0.BB.D0.BE.D0.B2-.D1.81.D0.B8.D1.80.D0.BE.D1.82"></span><span class="mw-headline" id="Отслеживание_созданных_пакетами_файлов-сирот">Отслеживание созданных пакетами файлов-сирот</span>
</h3>
<p>Как правило, в нормально функционирующей системе со временем скапливаются файлы-<a rel="nofollow" class="external text" href="http://ftp.rpm.org/max-rpm/s1-rpm-inside-files-list-directives.html#S3-RPM-INSIDE-FLIST-GHOST-DIRECTIVE">призраки</a>, вроде файлов состояний, логов, индексов и т.п.
</p>
<p>Утилита <code>pacreport</code> из пакета <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pacutils">pacutils</a></span> отслеживает такие файлы в привязке к создавшим их пакетам с помощью настроек в файле <code>/etc/pacreport.conf</code> (см. <span class="plainlinks archwiki-template-man" title="$ man 1 pacreport"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/pacreport.1#FILES">pacreport(1) § FILES</a></span>).
</p>
<p>Пример настроек (сокращённо):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pacreport.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Options]
IgnoreUnowned = usr/share/applications/mimeinfo.cache

[PkgIgnoreUnowned]
alsa-utils = var/lib/alsa/asound.state
bluez = var/lib/bluetooth
ca-certificates = etc/ca-certificates/trust-source/*
dbus = var/lib/dbus/machine-id
glibc = etc/ld.so.cache
grub = boot/grub/*
linux = boot/initramfs-linux.img
pacman = var/lib/pacman/local
update-mime-database = usr/share/mime/magic</pre>
<p>После этого команда <code>pacreport --unowned-files</code> с правами root выведет список файлов-сирот, если связанные с ними пакеты были удалены (или вместо старых файлов были созданы новые).
</p>
<p>Кроме того, утилита <a rel="nofollow" class="external text" href="https://github.com/CyberShadow/aconfmgr">aconfmgr</a> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/aconfmgr-git/">aconfmgr-git</a></span><sup><small>AUR</small></sup>) может отслеживать изменённые файлы и файлы без пакета-владельца с помощью скрипта настройки.
</p>
<h3>
<span id=".D0.A3.D0.B4.D0.B0.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BD.D0.B5.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D1.83.D0.B5.D0.BC.D1.8B.D1.85_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="Удаление_неиспользуемых_пакетов">Удаление неиспользуемых пакетов</span>
</h3>
<p>Пакеты-сироты — это пакеты, которые когда-то были установлены как зависимости других пакетов, но на данный момент не требуются ни одному установленному пакету.
</p>
<p>Они со временем могут накапливаться в системе при удалении пакетов командой <code>pacman -R <i>пакет</i></code> вместо <code>pacman -Rs <i>пакет</i></code>, при установке <a href="../../ru/PKGBUILD.html#makedepends" title="PKGBUILD (Русский)">зависимостей для сборки</a> или при установке новых версий пакетов, которым больше не требуются некоторые старые зависимости.
</p>
<p>Команда для рекурсивного удаления пакетов-сирот и их файлов настроек:
</p>
<pre># pacman -Qtdq | pacman -Rns -
</pre>
<p>Если неиспользуемых пакетов найдено не было, <i>pacman</i> выведет сообщение <code>ошибка: аргумент '-' указан без ввода в stdin</code>. Это нормальное поведение команды <code>pacman -Rns</code>, которой не было передано аргументов. Можно избавиться от ошибки добавлением <span class="plainlinks archwiki-template-man" title="$ man 1 ifne"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ifne.1">ifne(1)</a></span> из пакета <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=moreutils">moreutils</a></span> в начале второй команды.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Параметр <code>-Qt</code> выводит только чистые пакеты-сироты. Чтобы включить список пакеты, которые являются <i>опциональными</i> зависимостями, укажите флаг <code>-t</code> дважды (например, <code>-Qtt</code>).
</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> Добавьте команду <code>pacman -Qtd</code> в PostTransaction <a href="../../ru/Pacman.html#%D0%A5%D1%83%D0%BA%D0%B8" title="Pacman (Русский)">хук pacman</a>, чтобы получить уведомление, если после транзакции имеются пакеты-сироты. Это позволяет узнать об удалении пакета из репозитория, поскольку любой удалённый пакет также станет сиротой в локальной установке (если он не был установлен явно). Чтобы избежать появления ошибки, если сироты не найдены, используйте следующую команду для <code>Exec</code> в вашем хуке: <code>/usr/bin/bash -c "/usr/bin/pacman -Qtd || /usr/bin/echo '=&gt; None found.'"</code> Пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pacman-log-orphans-hook/">pacman-log-orphans-hook</a></span><sup><small>AUR</small></sup> предоставляет такой хук с более подробными инструкциями.</div>
<h3>
<span id=".D0.91.D0.BE.D0.BB.D0.B5.D0.B5_.D1.82.D1.89.D0.B0.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D0.BE.D0.B5_.D0.BE.D0.BF.D1.80.D0.B5.D0.B4.D0.B5.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BD.D0.B5.D0.BD.D1.83.D0.B6.D0.BD.D1.8B.D1.85_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="Более_тщательное_определение_ненужных_пакетов">Более тщательное определение ненужных пакетов</span>
</h3>
<p>Иногда описанный выше метод находит не все ненужные пакеты, например, из-за циклических зависимостей.
</p>
<p>Для поиска таких пакетов:
</p>
<pre>$ pacman -Qqd | pacman -Rsu --print -
</pre>
<p>Для удаления всех пакетов из этого списка запустите команду без аргумента <code>--print</code>.
</p>
<h3>
<span id=".D0.A3.D0.B4.D0.B0.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B2.D1.81.D0.B5.D1.85_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2.2C_.D0.BA.D1.80.D0.BE.D0.BC.D0.B5_.D0.B1.D0.B0.D0.B7.D0.BE.D0.B2.D1.8B.D1.85"></span><span class="mw-headline" id="Удаление_всех_пакетов,_кроме_базовых">Удаление всех пакетов, кроме базовых</span>
</h3>
<p>Если возникла необходимость очистить систему, оставив только базовый набор пакетов, то проще всего изменить <a href="../../ru/Pacman.html#%D0%9F%D1%80%D0%B8%D1%87%D0%B8%D0%BD%D0%B0_%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B8" class="mw-redirect" title="Причина установки">причину установки</a> ненужных пакетов на "зависимость", после чего удалить неиспользуемые зависимости.
</p>
<p>Сначала измените причину установки всех явно установленных пакетов на "зависимость":
</p>
<pre># pacman -D --asdeps $(pacman -Qqe)
</pre>
<p>Затем измените причину установки пакетов, которые вы удалять <b>не</b> хотите, на "установлен явно":
</p>
<pre># pacman -D --asexplicit base linux linux-firmware
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> 
<ul>
<li>В последней команде следует указать все пакеты, которые должны остаться в системе. В статье <a href="../../ru/Installation_guide.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D0%BD%D1%8B%D1%85_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Руководство по установке">Руководство по установке#Установка основных пакетов</a> перечислены пакеты, которые нужны для нормального функционирования базовой системы.</li>
<li>Последняя команда удалит также и пакет программы-загрузчика. Система всё ещё будет загружаться, но изменить параметры загрузки станет невозможно.</li>
</ul>
</div>
<p>Наконец, удалите ненужные пакеты-зависимости, как описано в разделе <a href="#%D0%A3%D0%B4%D0%B0%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BD%D0%B5%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D1%85_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2">#Удаление неиспользуемых пакетов</a>.
</p>
<h3>
<span id=".D0.A1.D0.BF.D0.B8.D1.81.D0.BE.D0.BA_.D0.B7.D0.B0.D0.B2.D0.B8.D1.81.D0.B8.D0.BC.D0.BE.D1.81.D1.82.D0.B5.D0.B9_.D0.BD.D0.B5.D1.81.D0.BA.D0.BE.D0.BB.D1.8C.D0.BA.D0.B8.D1.85_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="Список_зависимостей_нескольких_пакетов">Список зависимостей нескольких пакетов</span>
</h3>
<p>Ниже приведена команда для вывода списка зависимостей нескольких пакетов, отсортированого в алфавитном порядке с удалением дубликатов.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Чтобы вывести информацию только для пакетов, установленных в системе, в команде ниже используйте <code>pacman -Qi</code>.
</div>
<pre>$ LC_ALL=C pacman -Si <i>пакеты</i> | awk -F'[:&lt;=&gt;]' '/^Depends/ {print $2}' | xargs -n1 | sort -u
</pre>
<p>То же самое, с помощью <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=expac">expac</a></span>:
</p>
<pre>$ expac -l '\n' %E -S <i>пакеты</i> | sort -u
</pre>
<h3>
<span id=".D0.A1.D0.BF.D0.B8.D1.81.D0.BE.D0.BA_.D0.B8.D0.B7.D0.BC.D0.B5.D0.BD.D1.91.D0.BD.D0.BD.D1.8B.D1.85_.D1.84.D0.B0.D0.B9.D0.BB.D0.BE.D0.B2_.D0.B4.D0.BB.D1.8F_.D1.80.D0.B5.D0.B7.D0.B5.D1.80.D0.B2.D0.BD.D0.BE.D0.B3.D0.BE_.D0.BA.D0.BE.D0.BF.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F"></span><span class="mw-headline" id="Список_изменённых_файлов_для_резервного_копирования">Список изменённых файлов для резервного копирования</span>
</h3>
<p>Чтобы получить список файлов настроек, которые <a href="../../ru/Pacman/Pacnew_and_Pacsave.html#%D0%A0%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%BD%D1%8B%D0%B5_%D0%BA%D0%BE%D0%BF%D0%B8%D0%B8_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%B0" title="Pacman (Русский)/Pacnew and Pacsave (Русский)">могут изменяться пользователем</a> (то есть файлы, указанные в <a href="../../ru/PKGBUILD.html#backup" title="PKGBUILD (Русский)">массиве backup файла PKGBUILD</a>) и в которых есть пользовательские изменения, используйте команду:
</p>
<pre># pacman -Qii | awk '/^MODIFIED/ {print $2}'
</pre>
<p>Команда должна выполняться с правами root, чтобы в список вошли файлы, доступ на чтение которых есть только у суперпользователя (вроде файла <code>/etc/sudoers</code>).
</p>
<p>Это можно использовать при выборочном резервном копировании системы или при копировании конфигурацию системы с одной машины на другую.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> 
<ul>
<li>В разделе <a href="#%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA_%D0%B8%D0%B7%D0%BC%D0%B5%D0%BD%D1%91%D0%BD%D0%BD%D1%8B%D1%85_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2">#Список изменённых файлов пакетов</a> описано, как вывести список всех известных <i>pacman</i> изменённых файлов, а не только файлы с резервными копиями.</li>
<li>В разделе <a href="#%D0%9F%D0%BE%D0%B8%D1%81%D0%BA_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%D0%B1%D0%B5%D0%B7_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%B0-%D0%B2%D0%BB%D0%B0%D0%B4%D0%B5%D0%BB%D1%8C%D1%86%D0%B0">#Поиск файлов без пакета-владельца</a> описано, как вывести список файлов, которые <i>pacman</i> не отслеживает.</li>
</ul>
</div>
<h3>
<span id=".D0.A0.D0.B5.D0.B7.D0.B5.D1.80.D0.B2.D0.BD.D0.B0.D1.8F_.D0.BA.D0.BE.D0.BF.D0.B8.D1.8F_.D0.B1.D0.B0.D0.B7.D1.8B_.D0.B4.D0.B0.D0.BD.D0.BD.D1.8B.D1.85_pacman"></span><span class="mw-headline" id="Резервная_копия_базы_данных_pacman">Резервная копия базы данных pacman</span>
</h3>
<p>Следующая команда создаст резервную копию локальной базы данных <i>pacman</i>:
</p>
<pre>$ tar -cjf pacman_database.tar.bz2 /var/lib/pacman/local
</pre>
<p>Сохраните резервную копию на одном или нескольких внешних устройствах, вроде USB-накопителя, внешнего жесткого диска или CD-R.
</p>
<p>Чтобы восстановить базу данных, поместите файл <code>pacman_database.tar.bz2</code> в каталог <code>/</code> и выполните:
</p>
<pre># tar -xjvf pacman_database.tar.bz2
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Если файлы базы данных <i>pacman</i> повреждены, а резервные копии отсутствуют, надежда на восстановление базы данных всё же остаётся. Подробнее см. <a href="#%D0%92%D0%BE%D1%81%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BB%D0%BE%D0%BA%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9_%D0%B1%D0%B0%D0%B7%D1%8B_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85">#Восстановление локальной базы данных</a>.
</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> Пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pakbak-git/">pakbak-git</a></span><sup><small>AUR</small></sup> содержит скрипт и службу <a href="../../ru/Systemd.html" title="Systemd (Русский)">systemd</a> для автоматизации этой задачи. Настройка осуществляется с помощью файла <code>/etc/pakbak.conf</code>.
</div>
<h3>
<span id=".D0.9F.D1.80.D0.BE.D1.81.D0.BC.D0.BE.D1.82.D1.80_.D1.81.D0.BF.D0.B8.D1.81.D0.BA.D0.B0_.D0.B8.D0.B7.D0.BC.D0.B5.D0.BD.D0.B5.D0.BD.D0.B8.D0.B9_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.B0"></span><span class="mw-headline" id="Просмотр_списка_изменений_пакета">Просмотр списка изменений пакета</span>
</h3>
<p>При внесении изменений в состав пакета сопроводители часто подробно комментируют произведённые правки. Утилита <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pacolog/">pacolog</a></span><sup><small>AUR</small></sup> позволяет просматривать эти комментарии из командной строки. Команда <code>pacolog <i>пакет</i></code> выведет последние сообщения о правках для пакетов из официальных репозиториев и AUR.
</p>
<h2>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_.D0.B8_.D0.B2.D0.BE.D1.81.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Установка_и_восстановление">Установка и восстановление</span>
</h2>
<p>Альтернативные способы получения и восстановления пакетов.
</p>
<h3>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2_.D1.81_CD.2FDVD_.D0.B8.D0.BB.D0.B8_USB-.D0.BD.D0.B0.D0.BA.D0.BE.D0.BF.D0.B8.D1.82.D0.B5.D0.BB.D1.8F"></span><span class="mw-headline" id="Установка_пакетов_с_CD/DVD_или_USB-накопителя">Установка пакетов с CD/DVD или USB-накопителя</span>
</h3>
<p>Загрузите пакеты или группы пакетов:
</p>
<pre># cd ~/Packages
# pacman -Syw --cachedir . base base-devel grub-bios xorg gimp
# repo-add ./custom.db.tar.gz ./*
</pre>
<p>По умолчанию <i>pacman</i> работает с деревом каталогов (и базами данных) на хосте, поэтому он не сможет правильно разрешать и загружать зависимости. Если необходимы все пакеты и зависимости, лучше создать временную пустую базу данных и работать с ней через опцию <code>--dbpath</code>:
</p>
<pre># mkdir /tmp/blankdb
# pacman -Syw --cachedir . --dbpath /tmp/blankdb base base-devel grub-bios xorg gimp
# repo-add ./custom.db.tar.gz ./*
</pre>
<p>Затем запишите каталог <code>Packages</code> на CD/DVD, USB-накопитель, внешний жёсткий диск и т.д.
</p>
<p>Установка пакетов:
</p>
<p><b>1.</b> Примонтируйте носитель:
</p>
<p>Для CD/DVD:
</p>
<pre># mount --mkdir /dev/sr0 /mnt/repo
</pre>
<p>Для USB, жёсткого диска и т. п.:
</p>
<pre># mount --mkdir /dev/sd<i>xY</i> /mnt/repo
</pre>
<p><b>2.</b> Отредактируйте файл <code>pacman.conf</code>, добавив свой репозиторий <i>перед</i> всеми остальными (extra, core и др.). Это необходимо, чтобы пакеты на CD/DVD/USB получили приоритет над пакетами в стандартных репозиториях:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pacman.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[custom]
SigLevel = PackageRequired
Server = file:///mnt/repo/Packages</pre>
<p><b>3.</b> В заключение, синхронизируйте базу данных <i>pacman</i>, чтобы получить доступ к новому репозиторию:
</p>
<pre># pacman -Syu
</pre>
<h3>
<span id=".D0.A1.D0.BE.D0.B1.D1.81.D1.82.D0.B2.D0.B5.D0.BD.D0.BD.D1.8B.D0.B9_.D0.BB.D0.BE.D0.BA.D0.B0.D0.BB.D1.8C.D0.BD.D1.8B.D0.B9_.D1.80.D0.B5.D0.BF.D0.BE.D0.B7.D0.B8.D1.82.D0.BE.D1.80.D0.B8.D0.B9"></span><span class="mw-headline" id="Собственный_локальный_репозиторий">Собственный локальный репозиторий</span>
</h3>
<p>Скрипт <i>repo-add</i> (входит в состав <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pacman">pacman</a></span>) может создать базу данных для личного репозитория. Команда <code>repo-add --help</code> выведет краткую информацию о работе утилиты. База данных пакетов представляет собой tar-файл, возможно сжатый, с суффиксом <i>.db</i> или <i>.files</i>, за которым следует суффикс архива <i>.tar</i>, <i>.tar.gz</i>, <i>.tar.bz2</i>, <i>.tar.xz</i>, <i>.tar.zst</i> или <i>.tar.Z</i>. На момент запуска утилиты базы может ещё не быть, но родительские каталоги уже должны быть созданы.
</p>
<p>Следующая команда добавляет новый пакет к базе данных или заменяет старую версию существующего пакета на более новую:
</p>
<pre>$ repo-add <i>/путь/к/репозиторию.db.tar.gz /путь/к/пакету-1.0-1-x86_64.pkg.tar.zst</i>
</pre>
<p>Для работы <i>repo-add</i> база данных и пакеты могут храниться в разных каталогах, но когда вы станете работать с базой через <i>pacman</i>, её нужно объединить с пакетами в одном месте. Хранение всех пакетов репозитория в одном каталоге также позволяет использовать подстановочные символы в командной оболочке, чтобы добавлять или обновлять несколько пакетов за раз:
</p>
<pre>$ repo-add <i>/путь/к/репозиторию.db.tar.gz /путь/к/*.pkg.tar.zst</i>
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно:</strong> <i>repo-add</i> добавляет элементы в базу данных в том порядке, в каком получает их из командной строки. Если добавляется несколько разных версий одного и того же пакета, убедитесь, что правильная версия указана последней. В частности, обратите внимание, что лексический порядок командной оболочки зависит от локали и может отличаться от правил сравнения версий пакетов <i>pacman</i> (см. <span class="plainlinks archwiki-template-man" title="$ man 8 vercmp"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/vercmp.8">vercmp(8)</a></span>).
</div>
<p>Если вы собираетесь поддерживать несколько версий пакета для разных архитектур, то следует соблюдать некоторые предосторожности. Под каждую архитектуру должен быть выделен отдельный каталог:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ tree ~/customrepo/ | sed "s/$(uname -m)/<i>архитектура</i>/g"</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/home/archie/customrepo/
└── <i>архитектура</i>
    ├── customrepo.db -&gt; customrepo.db.tar.xz
    ├── customrepo.db.tar.xz
    ├── customrepo.files -&gt; customrepo.files.tar.xz
    ├── customrepo.files.tar.xz
    └── personal-website-git-b99cce0-1-<i>архитектура</i>.pkg.tar.zst

1 directory, 5 files
</pre>
<p>При запуске repo-add проверяет, подходят ли пакеты для добавления в базу. Если нет, то появится сообщение об ошибке:
</p>
<pre>==&gt; ERROR: '/home/archie/customrepo/<i>архитектура</i>/foo-<i>архитектура</i>.pkg.tar.zst' does not have a valid database archive extension.
</pre>
<p>Утилита <i>repo-remove</i> удаляет пакеты из базы данных:
</p>
<pre>$ repo-remove <i>/путь/к/repo.db.tar.gz пакеты</i>
</pre>
<p>После создания локальной базы данных укажите репозиторий в файле <code>pacman.conf</code> на каждой системе, где он будет использоваться. Пример настроек пользовательского репозитория можно найти в самом файле. Название репозитория представляет собой имя файла базы данных без суффикса. В примере выше репозиторий называется <code>repo</code>. Ссылаться на репозиторий можно по URL <code>file://</code> или через HTTP <code>http://localhost/path/to/directory</code>.
</p>
<p>При желании добавьте свой репозиторий в <a href="../../en/Unofficial_user_repositories.html" title="Unofficial user repositories">список неофициальных репозиториев</a>, чтобы сообщество могло извлечь из него пользу.
</p>
<h3>
<span id=".D0.A1.D0.B5.D1.82.D0.B5.D0.B2.D0.BE.D0.B9_.D0.BA.D1.8D.D1.88_pacman_.D1.81_.D1.81.D0.BE.D0.B2.D0.BC.D0.B5.D1.81.D1.82.D0.BD.D1.8B.D0.BC_.D0.B4.D0.BE.D1.81.D1.82.D1.83.D0.BF.D0.BE.D0.BC"></span><span class="mw-headline" id="Сетевой_кэш_pacman_с_совместным_доступом">Сетевой кэш pacman с совместным доступом</span>
</h3>
<p>Если в вашей локальной сети есть несколько машин с Arch Linux, сетевой кэш позволит значительно уменьшить время загрузки новых пакетов. При этом важно помнить, что в кэше не должно быть пакетов для разных архитектур (например, i686 и x86_64), иначе возникнут проблемы.
</p>
<h4>
<span id=".D0.9A.D1.8D.D1.88_.D1.82.D0.BE.D0.BB.D1.8C.D0.BA.D0.BE_.D0.BD.D0.B0_.D1.87.D1.82.D0.B5.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Кэш_только_на_чтение">Кэш только на чтение</span>
</h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Если <i>pacman</i> не сможет загрузить 3 пакета с сервера, он будет использовать другое зеркало. Смотрите <a rel="nofollow" class="external free" href="https://bbs.archlinux.org/viewtopic.php?id=268066">https://bbs.archlinux.org/viewtopic.php?id=268066</a>.</div>
<p>В качестве быстрого решения можно запустить <a rel="nofollow" class="external text" href="https://gist.github.com/willurd/5720255">простой временный веб-сервер</a>, который другие компьютеры могут использовать в качестве первого зеркала.
</p>
<p>Сперва сделайте базы данных <i>pacman</i> доступными в каталоге, который будет обслуживаться веб-сервером:
</p>
<pre># ln -s /var/lib/pacman/sync/*.db /var/cache/pacman/pkg/
</pre>
<p>Затем запустите веб-сервер, раздающий файлы из этого каталога. Например, можно использовать <a href="../../ru/Python.html" title="Python (Русский)">Python</a>-модуль <a rel="nofollow" class="external text" href="https://docs.python.org/3/library/http.server.html#http-server-cli">http.server</a>:
</p>
<pre>$ python -m http.server -d /var/cache/pacman/pkg/
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> По умолчанию он принимает соединения на порте <code>8000</code> на всех сетевых интерфейсах. Для использования другого порта или привязки к конкретному интерфейсу можно добавить параметры, например:
<pre>$ python -m http.server -d /var/cache/pacman/pkg/ --bind 127.0.0.1 8080
</pre>
</div>
<p>После этого на каждом клиентском компьютере <a href="../../ru/Help:Reading.html#%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C,_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D1%82%D1%8C,_%D1%80%D0%B5%D0%B4%D0%B0%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D1%82%D1%8C" title="Help:Reading (Русский)">отредактируйте</a> файл <code>/etc/pacman.d/mirrorlist</code>, добавив адрес запущенного вами веб-сервера в качестве первого зеркала:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pacman.d/mirrorlist</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Server = http://<i>ip-адрес-сервера</i>:<i>порт</i>
...</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно:</strong> <b>Не</b> добавляйте сюда <code>/repos/$repo/os/$arch</code> как в других зеркалах, поскольку в данном случае такая иерархия не существует и её использование не сработает.</div>
<p>В качестве более автономного решения можно использовать <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=darkhttpd">darkhttpd</a></span>. Замените ранее показанную команду <code>python</code>, например, на такую:
</p>
<pre>$ sudo -u http darkhttpd /var/cache/pacman/pkg --no-server-id
</pre>
<p>Также для удобства можно запустить darkhttpd как службу <i>systemd</i>; смотрите раздел <a href="../../ru/Systemd.html#%D0%9D%D0%B0%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%D1%8E%D0%BD%D0%B8%D1%82%D0%BE%D0%B2" title="Systemd (Русский)">systemd (Русский)#Написание файлов юнитов</a>.
</p>
<p>Можно использовать <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=miniserve">miniserve</a></span> — небольшой веб-сервер на Rust:
</p>
<pre>$ miniserve /var/cache/pacman/pkg
</pre>
<p>Отредактируйте <code>/etc/pacman.d/mirrorlist</code> как описано выше, указав тот URL, на котором доступен mimiserve.
</p>
<p>Если у вас уже есть веб-сервер, запущенный для каких-то других целей, можно использовать его как сервер локального репозитория вместо описанных ранее вариантов. Например, для сервера <a href="../../ru/Nginx.html" title="Nginx (Русский)">nginx</a> добавьте в настройки блок правил <code>server</code> с указанием прослушивать порт 8080:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/nginx/nginx.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">server {
    listen 8080;
    root /var/cache/pacman/pkg;
    server_name myarchrepo.localdomain;
    try_files $uri $uri/;
}
</pre>
<p>Не забудьте после этого <a href="../../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Перезапустить">перезапустить</a> службу <code>nginx.service</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> Какой бы веб-сервер вы ни использовали, в настройках межсетевого экрана (если он есть) нужно открыть используемый веб-сервером порт для трафика из локальной сети (и, при необходимости, включить блокировку пакетов, приходящих извне). Смотрите раздел <a href="../../ru/Security.html#%D0%A1%D0%B5%D1%82%D1%8C_%D0%B8_%D0%BC%D0%B5%D0%B6%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D1%8B%D0%B5_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D1%8B" class="mw-redirect" title="Безопасность">Безопасность#Сеть и межсетевые экраны</a>.</div>
<h4>
<span id="Overlay-.D0.BC.D0.BE.D0.BD.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.BA.D1.8D.D1.88.D0.B0_.D1.82.D0.BE.D0.BB.D1.8C.D0.BA.D0.BE_.D0.BD.D0.B0_.D1.87.D1.82.D0.B5.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Overlay-монтирование_кэша_только_на_чтение">Overlay-монтирование кэша только на чтение</span>
</h4>
<p>Можно настроить использование отдельной машины в локальной сети как read-only кэш пакетов. Для этого используется <a href="../../ru/Overlay_filesystem.html" title="Overlay filesystem (Русский)">overlay-монтирование</a> каталога <code>/var/cache/pacman/pkg</code>. Преимущество такой конфигурации — на сервере установлен полный набор новейших пакетов, которые используются другими машинами; в результате можно сэкономить внешнюю (из локальной сети) пропускную способность.
</p>
<p>Пример:
</p>
<pre># mkdir /tmp/remote_pkg /mnt/workdir_pkg /tmp/pacman_pkg
# sshfs <i>remote_username</i>@<i>remote_pkgcache_addr</i>:/var/cache/pacman/pkg /tmp/remote_pkg -C
# mount -t overlay overlay -o lowerdir=/tmp/remote_pkg,upperdir=/var/cache/pacman/pkg,workdir=/mnt/workdir_pkg /tmp/pacman_pkg
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Рабочий каталог должен быть пустым каталогом на том же смонтированном устройстве, что и <code>upperdir</code>. Смотрите <a href="../../ru/Overlay_filesystem.html#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5" title="Overlay filesystem (Русский)">Overlay filesystem (Русский)#Использование</a>.</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> Если просмотр содержимого overlay-каталога <code>/tmp/pacman_pkg</code> выдаёт ошибки, например, "Stale file handle", попробуйте использовать опции монтирования <code>-o redirect_dir=off -o index=off</code>.</div>
<p>После этого запустите <i>pacman</i> с опцией <code>--cachedir /tmp/pacman_pkg</code>:
</p>
<pre># pacman -Syu --cachedir /tmp/pacman_pkg
</pre>
<h4>
<span id=".D0.A0.D0.B0.D1.81.D0.BF.D1.80.D0.B5.D0.B4.D0.B5.D0.BB.D1.91.D0.BD.D0.BD.D1.8B.D0.B9_.D0.BA.D1.8D.D1.88_.D1.82.D0.BE.D0.BB.D1.8C.D0.BA.D0.BE_.D0.BD.D0.B0_.D1.87.D1.82.D0.B5.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Распределённый_кэш_только_на_чтение">Распределённый кэш только на чтение</span>
</h4>
<p>В Arch Linux есть несколько инструментов, которые выполняют автоматический поиск кэша пакетов на других компьютерах в локальной сети. Среди них <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pacredir">pacredir</a></span>, <a href="../../en/Pacserve.html" title="Pacserve">pacserve</a>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pkgdistcache/">pkgdistcache</a></span><sup><small>AUR</small></sup> и <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/paclan/">paclan</a></span><sup><small>AUR</small></sup>. pkgdistcache использует Avahi вместо чистого UDP, который может работать лучше в некоторых домашних сетях, где используется связка WiFi и Ethernet.
</p>
<p>Также раньше использовались утилиты <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=64391">PkgD</a> и <a rel="nofollow" class="external text" href="https://github.com/toofishes/multipkg">multipkg</a>, но их разработка была прекращена.
</p>
<h4>
<span id=".D0.9A.D1.8D.D1.88_.D0.BD.D0.B0_.D1.87.D1.82.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B8_.D0.B7.D0.B0.D0.BF.D0.B8.D1.81.D1.8C"></span><span class="mw-headline" id="Кэш_на_чтение_и_запись">Кэш на чтение и запись</span>
</h4>
<p>Чтобы несколько машин могли работать с общим кэшем пакетов, откройте совместный доступ к каталогу <code>/var/cache/pacman/</code> с помощью любого сетевого протокола монтирования файловых систем. В этом разделе описано, как использовать <a href="../../ru/SSHFS.html" title="SSHFS (Русский)">SSHFS</a> для организации совместного доступа к кэшу пакетов и некоторым каталогам с библиотеками в локальной сети. Имейте в виду, что сетевой кэш может быть довольно медленным, в том числе и из-за выбранной файловой системы.
</p>
<p>Во-первых, установите любой пакет с поддержкой сетевых файловых систем: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=sshfs">sshfs</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=curlftpfs">curlftpfs</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=samba">samba</a></span> или <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nfs-utils">nfs-utils</a></span>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> 
<ul>
<li>Полезную информацию о работе с <i>sshfs</i> можно найти в статье <a href="../../en/SSH_keys.html" class="mw-redirect" title="Ключи SSH">Ключи SSH</a>.</li>
<li>
<i>smbfs</i> по умолчанию не умеет работать с файлами, имена которых содержат двоеточия. В итоге клиент будет загружать такие пакеты заново при каждом обновлении. Чтобы это предотвратить, используйте на системе-клиенте опцию монтирования <code>mapchars</code>.</li>
</ul>
</div>
<p>Теперь, чтобы открыть совместный доступ к пакетам, смонтируйте каталог сервера <code>/var/cache/pacman/pkg</code> в каталог <code>/var/cache/pacman/pkg</code> на клиентских машинах.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно:</strong> Не делайте каталог <code>/var/cache/pacman/pkg</code> или любой из его родительских каталогов (например, <code>/var</code>) символической ссылкой. Pacman ожидает, что это будут именно каталоги. Когда <i>pacman</i> будет переустанавливать или обновлять самого себя, он удалит все символические ссылки и создаст вместо них пустые каталоги. Однако поскольку при этом <i>pacman</i> полагается на некоторые файлы в этих каталогах, то процесс обновления будет нарушен. Подробнее см. <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/50298">FS#50298</a>.
</div>
<h4>
<span id=".D0.94.D0.B2.D1.83.D1.85.D1.81.D1.82.D0.BE.D1.80.D0.BE.D0.BD.D0.BD.D0.B8.D0.B9_.D0.BA.D1.8D.D1.88_.D0.BD.D0.B0_.D0.BE.D1.81.D0.BD.D0.BE.D0.B2.D0.B5_rsync"></span><span class="mw-headline" id="Двухсторонний_кэш_на_основе_rsync">Двухсторонний кэш на основе rsync</span>
</h4>
<p>Другой подход к созданию сетевого кэша — использовать <a href="../../ru/Rsync.html" title="Rsync (Русский)">rsync</a>. Настройте сервер кэша, запустите на нём <a href="../../ru/Rsync.html#%D0%94%D0%B5%D0%BC%D0%BE%D0%BD_rsync" title="Rsync (Русский)">демон rsync</a> и выполните двухстороннюю синхронизацию между сервером и клиентскими машинами по протоколу rsync. В этом случае имена файлов с двоеточиями проблемы не создадут.
</p>
<p>Ниже приведён пример работы с кэшем на машине-клиенте. Команда <code>uname -m</code> позволяет выполнить синхронизацию пакетов с учётом архитектуры:
</p>
<pre> # rsync rsync://server/share_$(uname -m)/ /var/cache/pacman/pkg/ ...
 # pacman ...
 # paccache ...
 # rsync /var/cache/pacman/pkg/ rsync://server/share_$(uname -m)/  ...
</pre>
<h4>
<span id=".D0.94.D0.B8.D0.BD.D0.B0.D0.BC.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B8.D0.B9_.D0.BE.D0.B1.D1.80.D0.B0.D1.82.D0.BD.D1.8B.D0.B9_.D0.BF.D1.80.D0.BE.D0.BA.D1.81.D0.B8-.D0.BA.D1.8D.D1.88_.D0.BD.D0.B0_.D0.BE.D1.81.D0.BD.D0.BE.D0.B2.D0.B5_nginx"></span><span class="mw-headline" id="Динамический_обратный_прокси-кэш_на_основе_nginx">Динамический обратный прокси-кэш на основе nginx</span>
</h4>
<p>Сервер <a href="../../ru/Nginx.html" title="Nginx (Русский)">nginx</a> может работать в качестве посредника для запросов пакетов на официальные upstream-зеркала, кэшируя ответы на локальном диске. Все последующие запросы к этим пакетам будут адресоваться к локальному кэшу, минимизируя интернет-трафик при обновлении большого количества компьютеров.
</p>
<p>В примере ниже кэширующий сервер запущен на адресе <code>http://cache.domain.example:8080/</code>. Пакеты хранятся в каталоге <code>/srv/http/pacman-cache/</code>.
</p>
<p>Установите <a href="../../ru/Nginx.html" title="Nginx (Русский)">nginx</a> на машине, предназначенной для хранения кэша. Создайте каталог кэша с необходимыми разрешениями, чтобы nginx мог записывать в него файлы:
</p>
<pre># mkdir /srv/http/pacman-cache
# chown http:http /srv/http/pacman-cache
</pre>
<p>Используйте <a rel="nofollow" class="external text" href="https://github.com/nastasie-octavian/nginx_pacman_cache_config/blob/c54eca4776ff162ab492117b80be4df95880d0e2/nginx.conf">этот файл настроек</a> в качестве отправной точки для редактирования <code>/etc/nginx/nginx.conf</code>. Проверьте, чтобы директива <code>resolver</code> работала так, как ожидается. В блоках правил исходящих запросов <code>server</code> укажите директиву <code>proxy_pass</code> с адресами официальных зеркал (пример ожидаемого формата этой директивы можно найти в самом файле настроек). После настройки <a href="../../ru/Nginx.html#%D0%97%D0%B0%D0%BF%D1%83%D1%81%D0%BA" title="Nginx (Русский)">включите и запустите nginx</a>.
</p>
<p>Чтобы использовать кэш на каждом компьютере с Arch Linux (включая тот, который хранит кэш), нужно добавить следующую строку в начало файла <code>mirrorlist</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pacman.d/mirrorlist</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Server = http://cache.domain.example:8080/$repo/os/$arch
...
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Поскольку каталог кэша будет расти с течением времени, необходимо предусмотреть метод удаления старых пакетов. Утилита <code>paccache</code> (входит в пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pacman-contrib">pacman-contrib</a></span>) автоматизирует очистку в соответствии с различными критериями. Например, команда <code>find /srv/http/pacman-cache/ -type d -exec paccache -v -r -k 2 -c {} \;</code> оставит в кэше только две последние версии каждого пакета.
</div>
<h4>
<span id=".D0.9A.D1.8D.D1.88.D0.B8.D1.80.D1.83.D1.8E.D1.89.D0.B8.D0.B9_.D0.BF.D1.80.D0.BE.D0.BA.D1.81.D0.B8-.D1.81.D0.B5.D1.80.D0.B2.D0.B5.D1.80_Pacoloco"></span><span class="mw-headline" id="Кэширующий_прокси-сервер_Pacoloco">Кэширующий прокси-сервер Pacoloco</span>
</h4>
<p><a rel="nofollow" class="external text" href="https://github.com/anatol/pacoloco">Pacoloco</a> — простой прокси-сервер, кэширующий пакеты из репозиториев <i>pacman</i>. Также он поддерживает <a rel="nofollow" class="external text" href="https://github.com/anatol/pacoloco/commit/048b09956b0d8ef71c0ed1f804fd332d9ab5e3c8">автоматическую предзагрузку</a> обновлений для ранее скачивавшихся пакетов.
</p>
<p>Устанавливается с пакетом <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pacoloco">pacoloco</a></span>. Откройте файл настроек и добавьте зеркала <i>pacman</i>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pacoloco.yaml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">port: 9129
repos:
  mycopy:
    urls:
      - http://mirror.lty.me/archlinux
      - http://mirrors.kernel.org/archlinux
</pre>
<p><a href="../../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Перезапустите">Перезапустите</a> <code>pacoloco.service</code> и после этого прокси-репозиторий будет доступен по адресу <code>http://<i>сервер</i>:9129/repo/mycopy</code>.
</p>
<h4>
<span id=".D0.9A.D1.8D.D1.88.D0.B8.D1.80.D1.83.D1.8E.D1.89.D0.B8.D0.B9_.D0.BF.D1.80.D0.BE.D0.BA.D1.81.D0.B8-.D1.81.D0.B5.D1.80.D0.B2.D0.B5.D1.80_Flexo"></span><span class="mw-headline" id="Кэширующий_прокси-сервер_Flexo">Кэширующий прокси-сервер Flexo</span>
</h4>
<p><a rel="nofollow" class="external text" href="https://github.com/nroi/flexo">Flexo</a> — ещё один кэширующий прокси для репозиториев <i>pacman</i>. Flexo доступен в пакете <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/flexo-git/">flexo-git</a></span><sup><small>AUR</small></sup>. После установки <a href="../../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Запустите">запустите</a> службу <code>flexo.service</code>.
</p>
<p>Flexo по умолчанию работает на порте <code>7878</code>. Добавьте строку <code>Server = http://<i>мой_сервер</i>:7878/$repo/os/$arch</code> в самое начало файла <code>/etc/pacman.d/mirrorlist</code>, чтобы <i>pacman</i> загружал пакеты через Flexo.
</p>
<h4>
<span id=".D0.A1.D0.B8.D0.BD.D1.85.D1.80.D0.BE.D0.BD.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D1.8F_.D0.BA.D1.8D.D1.88.D0.B0_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2_.D1.81.D0.BF.D0.B5.D1.86.D0.B8.D0.B0.D0.BB.D1.8C.D0.BD.D1.8B.D0.BC.D0.B8_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D0.B0.D0.BC.D0.B8"></span><span class="mw-headline" id="Синхронизация_кэша_пакетов_специальными_программами">Синхронизация кэша пакетов специальными программами</span>
</h4>
<p>Утилиты <a href="../../en/Syncthing.html" title="Syncthing">Syncthing</a> и <a href="../../en/Resilio_Sync.html" class="mw-redirect" title="Resilio Sync (Русский)">Resilio Sync</a> можно использовать для синхронизации каталогов кэша <i>pacman</i> (например, <code>/var/cache/pacman/pkg</code>).
</p>
<h4>
<span id=".D0.9F.D1.80.D0.B5.D0.B4.D0.BE.D1.82.D0.B2.D1.80.D0.B0.D1.89.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BD.D0.B5.D0.B6.D0.B5.D0.BB.D0.B0.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D0.BE.D0.B9_.D0.BE.D1.87.D0.B8.D1.81.D1.82.D0.BA.D0.B8_.D0.BA.D1.8D.D1.88.D0.B0_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="Предотвращение_нежелательной_очистки_кэша_пакетов">Предотвращение нежелательной очистки кэша пакетов</span>
</h4>
<p>По умолчанию команда <code>pacman -Sc</code> очищает кэш от старых версий пакетов, которые были удалены из системы. В условиях совместного доступа к кэшу от нескольких машин в локальной сети <i>pacman</i> не может достоверно определить, какие пакеты установлены на каждой системе. По этой причине очистку кэша нужно ограничить.
</p>
<p>Чтобы удалялись только старые архивы:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pacman.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[options]
CleanMethod = KeepCurrent</pre>
<h3>
<span id=".D0.92.D0.BE.D1.81.D1.81.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D0.B5_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.B0_.D0.B8.D0.B7_.D1.84.D0.B0.D0.B9.D0.BB.D0.BE.D0.B2.D0.BE.D0.B9_.D1.81.D0.B8.D1.81.D1.82.D0.B5.D0.BC.D1.8B"></span><span class="mw-headline" id="Воссоздание_пакета_из_файловой_системы">Воссоздание пакета из файловой системы</span>
</h3>
<p>С помощью пакета <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/fakepkg/">fakepkg</a></span><sup><small>AUR</small></sup> можно воссоздать пакет из файловой системы. Файлы будут собраться в том виде, в каком они есть, следовательно, сделанные в них изменения войдут в "собранный" пакет. По этой причине распространять пакет среди других пользователей не рекомендуется; для этого гораздо лучше подойдёт <a href="../../ru/Arch_build_system.html" class="mw-redirect" title="Система сборки Arch">система сборки Arch</a> или <a href="../../en/Arch_Linux_Archive.html" title="Arch Linux Archive">архив Arch Linux</a>.
</p>
<h3>
<span id=".D0.A1.D0.BF.D0.B8.D1.81.D0.BE.D0.BA_.D1.83.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.D0.BD.D1.8B.D1.85_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="Список_установленных_пакетов">Список установленных пакетов</span>
</h3>
<p>Создание списка <a href="../../ru/Pacman.html#%D0%9F%D1%80%D0%B8%D1%87%D0%B8%D0%BD%D0%B0_%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B8" class="mw-redirect" title="Причина установки">явно установленных</a> пакетов может оказаться полезным, если вы собираетесь сделать резервную копию системы или ускорить процесс установки на новой машине:
</p>
<pre>$ pacman -Qqe &gt; pkglist.txt
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> 
<ul>
<li>С параметром <code>-t</code> в список не будут включены пакеты, которые нужны другим явно установленным пакетам. При переустановке по этому списку они всё равно будут установлены, но уже как зависимости.</li>
<li>С опцией <code>-n</code> в список не войдут внешние пакеты (например, из <a href="../../ru/Arch_User_Repository.html" title="Arch User Repository (Русский)">AUR</a>).</li>
<li>Команда <code>comm -13 &lt;(pacman -Qqdt | sort) &lt;(pacman -Qqdtt | sort) &gt; optdeplist.txt</code> создаст список установленных опциональных зависимостей, которые можно будет переустановить с параметром <code>--asdeps</code>.</li>
<li>Команда <code>pacman -Qqem &gt; foreignpkglist.txt</code> создаст список пакетов из AUR и других внешних пакетов, которые были установлены явно.</li>
</ul>
</div>
<p><a href="../../ru/Pacman.html#%D0%A5%D1%83%D0%BA%D0%B8" title="Pacman (Русский)">Хук</a> <i>pacman</i> позволит автоматизировать обновление списка пакетов. Пример:
</p>
<pre>[Trigger]
Operation = Install
Operation = Remove
Type = Package
Target = *

[Action]
When = PostTransaction
Exec = /bin/sh -c '/usr/bin/pacman -Qqe &gt; /etc/pkglist.txt'
</pre>
<h3>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2_.D0.BF.D0.BE_.D1.81.D0.BF.D0.B8.D1.81.D0.BA.D1.83"></span><span class="mw-headline" id="Установка_пакетов_по_списку">Установка пакетов по списку</span>
</h3>
<p>Следующая команда установит пакеты в соответствии с ранее созданным списком, при этом уже установленные пакеты переустанавливаться не будут:
</p>
<pre># pacman -S --needed - &lt; pkglist.txt
</pre>
<p>В списке могут оказаться внешние пакеты, из AUR или установленные локально. Чтобы их исключить, вместо предыдущей команды выполните следующую:
</p>
<pre># pacman -S --needed $(comm -12 &lt;(pacman -Slq | sort) &lt;(sort pkglist.txt))
</pre>
<p>Наконец, убедитесь, что установленные в системе пакеты совпадают со списком, и удалите всё, что в него не входит:
</p>
<pre># pacman -Rsu $(comm -23 &lt;(pacman -Qq | sort) &lt;(sort pkglist.txt))
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> Данные действия можно автоматизировать. См. <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/bacpac/">bacpac</a></span><sup><small>AUR</small></sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/packup/">packup</a></span><sup><small>AUR</small></sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pacmanity/">pacmanity</a></span><sup><small>AUR</small></sup> и <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pug/">pug</a></span><sup><small>AUR</small></sup>.
</div>
<h3>
<span id=".D0.A1.D0.BF.D0.B8.D1.81.D0.BE.D0.BA_.D0.B8.D0.B7.D0.BC.D0.B5.D0.BD.D1.91.D0.BD.D0.BD.D1.8B.D1.85_.D1.84.D0.B0.D0.B9.D0.BB.D0.BE.D0.B2_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="Список_изменённых_файлов_пакетов">Список изменённых файлов пакетов</span>
</h3>
<p>Если вы предполагаете, что какие-то файлы были повреждены (например, из-за ошибки программы или аппаратного обеспечения), стоит проверить их хэш-суммы. Сделать это можно с помощью пакета <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pacutils">pacutils</a></span>:
</p>
<pre># paccheck --md5sum --quiet
</pre>
<p>Восстановление базы данных описано в разделе <a href="#%D0%92%D0%BE%D1%81%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BB%D0%BE%D0%BA%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9_%D0%B1%D0%B0%D0%B7%D1%8B_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85">#Восстановление локальной базы данных</a>. Файлы <code>mtree</code> можно также <a href="#%D0%9F%D1%80%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80_%D0%BE%D1%82%D0%B4%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE_%D1%84%D0%B0%D0%B9%D0%BB%D0%B0_%D0%B2%D0%BD%D1%83%D1%82%D1%80%D0%B8_%D1%84%D0%B0%D0%B9%D0%BB%D0%B0_.pkg">извлечь как <code>.MTREE</code> из соответствующих файлов пакета</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Этот способ <b>не</b> подходит, если есть подозрение на злонамеренные изменения. В этом случае используйте live-окружение и независимый источник хэш-сумм.
</div>
<h3>
<span id=".D0.9F.D0.B5.D1.80.D0.B5.D1.83.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_.D0.B2.D1.81.D0.B5.D1.85_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="Переустановка_всех_пакетов">Переустановка всех пакетов</span>
</h3>
<p>Чтобы переустановить все пакеты, установленные из базы синхронизации, выполните:
</p>
<pre># pacman -Qqn | pacman -S -
</pre>
<p>Сторонние пакеты (AUR) придётся установить отдельно; найти их можно командой <code>pacman -Qqm</code>.
</p>
<p>По умолчанию при переустановке пакета <i>pacman</i> оставляет <a href="../../ru/Pacman.html#%D0%9F%D1%80%D0%B8%D1%87%D0%B8%D0%BD%D0%B0_%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B8" class="mw-redirect" title="Причина установки">причину установки</a> без изменений.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно:</strong> Принудительно перезаписать все пакеты можно флагом <code>--overwrite=*</code>. Учтите — это средство на самый крайний случай, см. <a href="../../ru/System_maintenance.html#%D0%98%D0%B7%D0%B1%D0%B5%D0%B3%D0%B0%D0%B9%D1%82%D0%B5_%D0%BE%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%BD%D1%8B%D1%85_%D0%BA%D0%BE%D0%BC%D0%B0%D0%BD%D0%B4_pacman" class="mw-redirect" title="Обслуживание системы">Обслуживание системы#Избегайте определенных команд pacman</a>.</div>
<h3>
<span id=".D0.92.D0.BE.D1.81.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BB.D0.BE.D0.BA.D0.B0.D0.BB.D1.8C.D0.BD.D0.BE.D0.B9_.D0.B1.D0.B0.D0.B7.D1.8B_.D0.B4.D0.B0.D0.BD.D0.BD.D1.8B.D1.85"></span><span class="mw-headline" id="Восстановление_локальной_базы_данных">Восстановление локальной базы данных</span>
</h3>
<p>См. <a href="../../ru/Pacman/Restore_local_database.html" class="mw-redirect" title="Pacman/Восстановление локальной базы данных">pacman/Восстановление локальной базы данных</a>.
</p>
<h3>
<span id=".D0.92.D0.BE.D1.81.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_USB-.D0.BD.D0.BE.D1.81.D0.B8.D1.82.D0.B5.D0.BB.D1.8F_.D0.B8.D0.B7_.D1.81.D1.83.D1.89.D0.B5.D1.81.D1.82.D0.B2.D1.83.D1.8E.D1.89.D0.B5.D0.B9_.D1.83.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B8"></span><span class="mw-headline" id="Восстановление_USB-носителя_из_существующей_установки">Восстановление USB-носителя из существующей установки</span>
</h3>
<p>Если вы установили Arch на USB-носитель и испортили его (например, выдернув носитель в процессе записи), стоит попробовать переустановить все пакеты. Возможно, это восстановит работоспособность флешки. Предположим, USB-носитель смонтирован в каталог <code>/newarch</code>:
</p>
<pre># pacman -S $(pacman -Qq --dbpath /newarch/var/lib/pacman) --root /newarch --dbpath /newarch/var/lib/pacman
</pre>
<h3>
<span id=".D0.9F.D1.80.D0.BE.D1.81.D0.BC.D0.BE.D1.82.D1.80_.D0.BE.D1.82.D0.B4.D0.B5.D0.BB.D1.8C.D0.BD.D0.BE.D0.B3.D0.BE_.D1.84.D0.B0.D0.B9.D0.BB.D0.B0_.D0.B2.D0.BD.D1.83.D1.82.D1.80.D0.B8_.D1.84.D0.B0.D0.B9.D0.BB.D0.B0_.pkg"></span><span class="mw-headline" id="Просмотр_отдельного_файла_внутри_файла_.pkg">Просмотр отдельного файла внутри файла .pkg</span>
</h3>
<p>Например, вы хотите увидеть содержимое файла <code>/etc/systemd/logind.conf</code> в пакете <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=systemd">systemd</a></span>:
</p>
<pre>$ bsdtar -xOf /var/cache/pacman/pkg/systemd-250.4-2-x86_64.pkg.tar.zst etc/systemd/logind.conf
</pre>
<p>Для просмотра файлов архива можно использовать <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=vim">vim</a></span>:
</p>
<pre>$ vim /var/cache/pacman/pkg/systemd-250.4-2-x86_64.pkg.tar.zst
</pre>
<h3>
<span id=".D0.A1.D0.BF.D0.B8.D1.81.D0.BE.D0.BA_.D0.BF.D1.80.D0.B8.D0.BB.D0.BE.D0.B6.D0.B5.D0.BD.D0.B8.D0.B9.2C_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D1.83.D1.8E.D1.89.D0.B8.D1.85_.D1.83.D1.81.D1.82.D0.B0.D1.80.D0.B5.D0.B2.D1.88.D0.B8.D0.B5_.D0.B1.D0.B8.D0.B1.D0.BB.D0.B8.D0.BE.D1.82.D0.B5.D0.BA.D0.B8"></span><span class="mw-headline" id="Список_приложений,_использующих_устаревшие_библиотеки">Список приложений, использующих устаревшие библиотеки</span>
</h3>
<p>Внесённые обновлением изменения не применятся к ранее запущенным процессам. Они продолжат использовать старые версии библиотек даже после обновления. Если какая-то из этих библиотек содержит уязвимость или опасный баг, продолжать её использовать — не самая лучшая идея.
</p>
<p>Процессы, зависящие от обновившихся библиотек, можно найти либо с помощью <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=htop">htop</a></span>, который подсвечивает имена затронутых программ, либо с помощью такой команды на основе <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lsof">lsof</a></span>, которая также выводит имена библиотек:
</p>
<pre># lsof +c 0 | grep -w DEL | awk '1 { print $1 ": " $NF }' | sort -u
</pre>
<p>Это решение позволяет найти только файлы, которые процессы постоянно держат открытыми, так что оно подходит в основном только для поиска обновившихся библиотек (файлы <code>.so</code>). Оно не покажет, например, зависимости приложений Java или Python.
</p>
<h3>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_.D0.BA.D0.BE.D0.BD.D1.82.D0.B5.D0.BD.D1.82.D0.B0_.D1.82.D0.BE.D0.BB.D1.8C.D0.BA.D0.BE_.D0.BD.D0.B0_.D0.BD.D1.83.D0.B6.D0.BD.D0.BE.D0.BC_.D1.8F.D0.B7.D1.8B.D0.BA.D0.B5"></span><span class="mw-headline" id="Установка_контента_только_на_нужном_языке">Установка контента только на нужном языке</span>
</h3>
<p>Многие пакеты по умолчанию устанавливают документацию и переводы на нескольких языках. Существует ряд программ, разработанных для удаления таких ненужных файлов. Например, утилита <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/localepurge/">localepurge</a></span><sup><small>AUR</small></sup> удалит лишние файлы локалей, если запустить её после установки пакета. Более прямой подход к этой проблеме — указать директиву <code>NoExtract</code> в файле <code>pacman.conf</code>, что предотвратит установку ненужных файлов.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Как сказано в разделе <a href="../../ru/Pacman.html#%D0%97%D0%B0%D0%BF%D1%80%D0%B5%D1%82_%D0%BD%D0%B0_%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D1%83_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2" title="Pacman (Русский)">pacman (Русский)#Запрет на установку файлов</a>, более поздние правила переопределяют предыдущие, и вы можете инвертировать правило, добавив к нему префикс <code>!</code>.</div>
<p>Например, чтобы не устанавливать переводы справки, кроме локали C, добавьте:
</p>
<pre>NoExtract = usr/share/help/* !usr/share/help/C/*
</pre>
<p>Чтобы не устанавливать HTML-документацию приложений <a href="../../ru/GTK.html" title="GTK (Русский)">GTK</a>, добавьте:
</p>
<pre>NoExtract = usr/share/gtk-doc/html/*
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно:</strong> Некоторые пользователи отмечали, что удаление <b>всех</b> локалей может привести к неожиданным последствиям в <a href="../../Special:PermanentLink/460285.html#Dangerous_NoExtract_example" title="Special:PermanentLink/460285">dmenu</a>, <a href="../../Special:PermanentLink/767628.html#Languages:_NoExtract_usr/share/X11/locale/*" title="Special:PermanentLink/767628">Steam</a> и даже в <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=250846">Xorg</a>. Следующий пример скорректирован, чтобы избежать подобных проблем путём установки только английских (US) файлов и локали C.</div>
<p>Для установки только необходимых <a href="../../ru/Locale.html" title="Locale (Русский)">локалей</a>:
</p>
<pre>NoExtract = usr/share/locale/* usr/share/X11/locale/*/* usr/share/i18n/locales/* opt/google/chrome/locales/* !usr/share/X11/locale/C/*
NoExtract = !usr/share/X11/locale/compose.dir !usr/share/X11/locale/iso8859-1/*
NoExtract = !*locale*/en*/* !usr/share/*locale*/locale.*
NoExtract = !usr/share/*locales/en_?? !usr/share/*locales/i18n* !usr/share/*locales/iso*
NoExtract = usr/share/i18n/charmaps/* !usr/share/i18n/charmaps/UTF-8.gz !usr/share/i18n/charmaps/ANSI_X3.4-1968.gz
NoExtract = !usr/share/*locales/trans*
NoExtract = !usr/share/*locales/C !usr/share/*locales/POSIX</pre>
<p>Чтобы не устанавливать переводы <a href="../../ru/Man_page.html" title="Man page (Русский)">man-страниц</a>:
</p>
<pre>NoExtract = usr/share/man/* !usr/share/man/man*
</pre>
<p>Чтобы не устанавливать файлы языков в <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=vim-runtime">vim-runtime</a></span>:
</p>
<pre>NoExtract = usr/share/vim/vim*/lang/*
</pre>
<p>Для установки только английского языка в приложениях <a href="../../ru/Qt.html" title="Qt (Русский)">Qt</a>:
</p>
<pre>NoExtract = usr/share/*/translations/*.qm usr/share/*/nls/*.qm usr/share/qt/phrasebooks/*.qph usr/share/qt/translations/*.pak !*/en-US.pak
</pre>
<p>Для установки только английского языка в приложения <a href="../../en/Electron.html" title="Electron">Electron</a>:
</p>
<pre>NoExtract = usr/share/*/locales/*.pak opt/*/locales/*.pak usr/lib/*/locales/*.pak !*/en-US.pak
</pre>
<p>Для установки только английской справки в <a href="../../ru/LibreOffice.html" title="LibreOffice (Русский)">LibreOffice</a>:
</p>
<pre>NoExtract = usr/lib/libreoffice/help/en-US/*
</pre>
<p>Для установки только английского языка в <a href="../../en/List_of_applications/Documents.html#Office_suites" title="List of applications/Documents">OnlyOffice</a>:
</p>
<pre>NoExtract = opt/onlyoffice/desktopeditors/dictionaries/* !opt/onlyoffice/desktopeditors/dictionaries/en_US/*
NoExtract = opt/onlyoffice/desktopeditors/editors/web-apps/apps/*/main/locale/* !*/en.json
NoExtract = opt/onlyoffice/desktopeditors/editors/web-apps/apps/*/main/resources/help/*/* !*/help/en/*
NoExtract = opt/onlyoffice/desktopeditors/editors/web-apps/apps/*/main/resources/symboltable/* !*/en.json
NoExtract = opt/onlyoffice/desktopeditors/editors/web-apps/apps/documenteditor/forms/locale/* !*/en.json
NoExtract = opt/onlyoffice/desktopeditors/editors/web-apps/apps/spreadsheeteditor/main/resources/formula-lang/* !*/en.json !*/en_desc.json
NoExtract = opt/onlyoffice/desktopeditors/converter/empty/*/* !opt/onlyoffice/desktopeditors/converter/empty/en-US/*</pre>
<p>Для установки только английского словаря Emoji в <a href="../../en/IBus.html" title="IBus">iBus</a>:
</p>
<pre>NoExtract = usr/share/ibus/dicts/emoji-*.dict !usr/share/ibus/dicts/emoji-en.dict
</pre>
<h3>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2_.D0.BF.D1.80.D0.B8_.D0.BF.D0.BB.D0.BE.D1.85.D0.BE.D0.BC_.D1.81.D0.BE.D0.B5.D0.B4.D0.B8.D0.BD.D0.B5.D0.BD.D0.B8.D0.B8"></span><span class="mw-headline" id="Установка_пакетов_при_плохом_соединении">Установка пакетов при плохом соединении</span>
</h3>
<p>При попытке скачать пакет через плохое соединение (например, в поезде с помощью мобильного телефона) используйте опцию <code>--disable-download-timeout</code>, чтобы уменьшить вероятность получения подобных ошибок:
</p>
<pre>error: failed retrieving file […] Operation too slow. Less than 1 bytes/sec transferred the last 10 seconds
</pre>
<p>или
</p>
<pre>error: failed retrieving file […] Operation timed out after 10014 milliseconds with 0 out of 0 bytes received
</pre>
<h2>
<span id=".D0.9F.D1.80.D0.BE.D0.B8.D0.B7.D0.B2.D0.BE.D0.B4.D0.B8.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D0.BE.D1.81.D1.82.D1.8C"></span><span class="mw-headline" id="Производительность">Производительность</span>
</h2>
<h3>
<span id=".D0.A3.D0.B2.D0.B5.D0.BB.D0.B8.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D1.81.D0.BA.D0.BE.D1.80.D0.BE.D1.81.D1.82.D0.B8_.D0.B7.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BA.D0.B8"></span><span class="mw-headline" id="Увеличение_скорости_загрузки">Увеличение скорости загрузки</span>
</h3>
<p>При загрузке пакетов <i>pacman</i> использует зеркала в том порядке, в каком они перечислены в файле <code>/etc/pacman.d/mirrorlist</code>. Зеркало, указанное первым, будет использоваться по умолчанию, и совсем не обязательно оно окажется для вас самым быстрым. Подробнее о выборе зеркал см. <a href="../../ru/Mirrors.html" class="mw-redirect" title="Зеркала">Зеркала</a>.
</p>
<p>Скорость загрузки пакетов можно повысить, если включить <a href="../../ru/Pacman.html#%D0%9F%D0%B0%D1%80%D0%B0%D0%BB%D0%BB%D0%B5%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B0" title="Pacman (Русский)">параллельную загрузку</a> или использовать сторонние приложения для загрузки вместо встроенного в <i>pacman</i> менеджера закачек.
</p>
<p>В любом случае, прежде чем делать какие-либо изменения, убедитесь, что используете последнюю версию <i>pacman</i>:
</p>
<pre># pacman -Syu
</pre>
<h4><span class="mw-headline" id="Powerpill">Powerpill</span></h4>
<p><a href="../../ru/Powerpill.html" title="Powerpill (Русский)">Powerpill</a> — обёртка для <i>pacman</i>, которая использует параллельную и сегментированную загрузку для повышения скорости.
</p>
<h4><span class="mw-headline" id="wget">wget</span></h4>
<p>Эта утилита будет очень полезна, если вам нужны более сложные настройки прокси, чем это позволяют возможности <i>pacman</i>.
</p>
<p><a href="../../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установите">Установите</a> пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=wget">wget</a></span>, после чего отредактируйте <code>/etc/pacman.conf</code>, указав в разделе <code>[options]</code> следующую строку:
</p>
<pre>XferCommand = /usr/bin/wget --passive-ftp --show-progress -c -q -N %u
</pre>
<p>Чтобы не указывать параметры <code>wget</code> в файле <code>/etc/pacman.conf</code>, можно отредактировать непосредственно файл настроек <code>wget</code> — либо общесистемный файл <code>/etc/wgetrc</code>, либо пользовательский <code>$HOME/.wgetrc</code>.
</p>
<h4><span class="mw-headline" id="aria2">aria2</span></h4>
<p><a href="../../ru/Aria2.html" title="Aria2 (Русский)">aria2</a> — небольшая загрузочная утилита с поддержкой возобновляемой и сегментной загрузки по протоколам HTTP/HTTPS и FTP. aria2 создаёт несколько одновременных соединений с зеркалом Arch, что увеличивает скорость загрузки файлов и пакетов.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Если указать aria2c в параметре <code>XferCommand</code>, то пакеты всё равно будут загружаться по очереди, а не параллельно. Pacman использует команду <code>XferCommand</code> для одного пакета за раз и ожидает её завершения, прежде чем перейти к следующему. Параллельная загрузка нескольких пакетов возможна с <a href="../../ru/Powerpill.html" title="Powerpill (Русский)">Powerpill</a>.</div>
<p>Установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=aria2">aria2</a></span>, затем добавьте следующую строку в раздел <code>[options]</code> файла <code>/etc/pacman.conf</code>:
</p>
<pre>XferCommand = /usr/bin/aria2c --allow-overwrite=true --continue=true --file-allocation=none --log-level=error --max-tries=2 --max-connection-per-server=2 --max-file-not-found=5 --min-split-size=5M --no-conf --remote-time=true --summary-interval=60 --timeout=5 --dir=/ --out %o %u
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?pid=1491879#p1491879">На форуме</a> предложен более простой способ настройки <i>pacman</i> на работу через aria2, с добавлением некоторых полезных опций.</div>
<p>Параметры aria2 описаны в руководстве <span class="plainlinks archwiki-template-man" title="$ man 1 aria2c"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/aria2c.1#OPTIONS">aria2c(1) § OPTIONS</a></span>. Некоторые разъяснения о параметрах последней команды:
</p>
<ul>
<li>
<code>-d, --dir</code>: каталог для сохранения скачиваемых файлов.</li>
<li>
<code>-o, --out</code>: итоговые имена скачиваемых файлов.</li>
<li>
<code>%o</code>: локальное имя файла в представлении <i>pacman</i>.</li>
<li>
<code>%u</code>: URL загрузки в представлении <i>pacman</i>.</li>
</ul>
<h4>
<span id=".D0.94.D1.80.D1.83.D0.B3.D0.B8.D0.B5_.D0.BF.D1.80.D0.B8.D0.BB.D0.BE.D0.B6.D0.B5.D0.BD.D0.B8.D1.8F"></span><span class="mw-headline" id="Другие_приложения">Другие приложения</span>
</h4>
<p>Есть и другие загрузочные приложения, с которыми может работать <i>pacman</i>. Ниже приводится список в виде соответствующих настроек <code>XferCommand</code>:
</p>
<ul>
<li>
<code>snarf</code>: <code>XferCommand = /usr/bin/snarf -N %u</code>
</li>
<li>
<code>lftp</code>: <code>XferCommand = /usr/bin/lftp -c pget %u</code>
</li>
<li>
<code>axel</code>: <code>XferCommand = /usr/bin/axel -n 2 -v -a -o %o %u</code>
</li>
<li>
<code>hget</code>: <code>XferCommand = /usr/bin/hget %u -n 2 -skip-tls false</code> (подробнее см. <a rel="nofollow" class="external text" href="https://github.com/huydx/hget">документацию на странице проекта</a>)</li>
<li>
<code>saldl</code>: <code>XferCommand = /usr/bin/saldl -c6 -l4 -s2m -o %o %u</code> (подробнее см. <a rel="nofollow" class="external text" href="https://saldl.github.io">документацию на странице проекта</a>)</li>
</ul>
<h2>
<span id=".D0.A3.D1.82.D0.B8.D0.BB.D0.B8.D1.82.D1.8B"></span><span class="mw-headline" id="Утилиты">Утилиты</span>
</h2>
<ul><li>
<b>Lostfiles</b> — Скрипт для обнаружения файлов, не принадлежащих ни одному пакету.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://github.com/graysky2/lostfiles">https://github.com/graysky2/lostfiles</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lostfiles">lostfiles</a></span>
</dd></dl>
<ul><li>
<b>pacutils</b> — Библиотека для программ, основанных на libalpm.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://github.com/andrewgregory/pacutils">https://github.com/andrewgregory/pacutils</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pacutils">pacutils</a></span>
</dd></dl>
<ul><li>
<b><a href="../../ru/Pkgfile.html" title="Pkgfile (Русский)">pkgfile</a></b> — Утилита, которая находит, какому пакету принадлежит файл.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://github.com/falconindy/pkgfile">https://github.com/falconindy/pkgfile</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pkgfile">pkgfile</a></span>
</dd></dl>
<ul><li>
<b>pkgtools</b> — Коллекция скриптов для пакетов Arch Linux.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://github.com/Daenyth/pkgtools">https://github.com/Daenyth/pkgtools</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pkgtools/">pkgtools</a></span><sup><small>AUR</small></sup>
</dd></dl>
<ul><li>
<b>pkgtop</b> — Интерактивный менеджер пакетов и системный менеджер, разработанный для GNU/Linux.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://github.com/orhun/pkgtop">https://github.com/orhun/pkgtop</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pkgtop-git/">pkgtop-git</a></span><sup><small>AUR</small></sup>
</dd></dl>
<ul><li>
<b><a href="../../ru/Powerpill.html" title="Powerpill (Русский)">Powerpill</a></b> — Использует параллельную и сегментную загрузку с помощью <a href="../../ru/Aria2.html" title="Aria2 (Русский)">aria2</a> и <a href="../../ru/Reflector.html" title="Reflector (Русский)">Reflector</a>, чтобы ускорить скачивание пакетов через <i>pacman</i>.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://xyne.dev/projects/powerpill/">https://xyne.dev/projects/powerpill/</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/powerpill/">powerpill</a></span><sup><small>AUR</small></sup>
</dd></dl>
<ul><li>
<b>repoctl</b> — Утилита для управления локальными репозиториями.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://github.com/cassava/repoctl">https://github.com/cassava/repoctl</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/repoctl/">repoctl</a></span><sup><small>AUR</small></sup>
</dd></dl>
<ul><li>
<b>repose</b> — Программа для создания репозиториев Arch Linux.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://github.com/vodik/repose">https://github.com/vodik/repose</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=repose">repose</a></span>
</dd></dl>
<ul><li>
<b><a href="../../en/Snapper.html#Wrapping_pacman_transactions_in_snapshots" title="Snapper">snap-pac</a></b> — Заставляет <i>pacman</i> использовать snapper для создания снимков до и после транзакции, как в YaST из openSUSE.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://github.com/wesbarnett/snap-pac">https://github.com/wesbarnett/snap-pac</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=snap-pac">snap-pac</a></span>
</dd></dl>
<ul><li>
<b>vrms-arch</b> — Виртуальный Ричард Столлман подсказывает тебе, какие несвободные пакеты установлены в системе.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://github.com/orospakr/vrms-arch">https://github.com/orospakr/vrms-arch</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/vrms-arch-git/">vrms-arch-git</a></span><sup><small>AUR</small></sup>
</dd></dl>
<h3>
<span id=".D0.93.D1.80.D0.B0.D1.84.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B8.D0.B5"></span><span class="mw-headline" id="Графические">Графические</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно:</strong> PackageKit по умолчанию использует права суперпользователя, поэтому настоятельно не рекомендуется его использовать. См. <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/50459">FS#50459</a> и <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/57943">FS#57943</a>.</div>
<ul><li>
<b>Apper</b> — Менеджер пакетов на основе PackageKit; написан на C++ с использованием Qt 5. Поддержка <a rel="nofollow" class="external text" href="https://www.freedesktop.org/wiki/Distributions/AppStream/">метаданных AppStream</a>.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://userbase.kde.org/Apper">https://userbase.kde.org/Apper</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=apper">apper</a></span><sup>[<a href="../../en/ArchWiki:Requests.html#Broken_package_links" class="mw-redirect" title="ArchWiki:Requests">ссылка недействительна</a>: package not found]</sup>
</dd></dl>
<ul><li>
<b>Deepin App Store</b> — Сторонний магазин приложений для DDE, собранный с DTK используя PackageKit. Поддерживает <a rel="nofollow" class="external text" href="https://www.freedesktop.org/wiki/Distributions/AppStream/">метаданные AppStream</a>.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://github.com/dekzi/dde-store">https://github.com/dekzi/dde-store</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=deepin-store">deepin-store</a></span>
</dd></dl>
<ul><li>
<b>Discover</b> — Менеджер приложений на основе PackageKit; написан на C++/QML с использованием Qt 5. Поддержка <a rel="nofollow" class="external text" href="https://www.freedesktop.org/wiki/Distributions/AppStream/">метаданных AppStream</a>, <a href="../../en/Flatpak.html" title="Flatpak">Flatpak</a> и <a href="../../en/Fwupd.html" title="Fwupd">обновления прошивок</a>.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://userbase.kde.org/Discover">https://userbase.kde.org/Discover</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=discover">discover</a></span>
</dd></dl>
<ul><li>
<b>GNOME PackageKit</b> — Менеджер пакетов на основе PackageKit, написан на Си с использованием GTK 3.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://freedesktop.org/software/PackageKit/">https://freedesktop.org/software/PackageKit/</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gnome-packagekit">gnome-packagekit</a></span>
</dd></dl>
<ul><li>
<b>GNOME Software</b> — Менеджер пакетов на основе PackageKit, написан на Си с использованием GTK 3. Поддержка <a rel="nofollow" class="external text" href="https://www.freedesktop.org/wiki/Distributions/AppStream/">метаданных AppStream</a>, <a href="../../en/Flatpak.html" title="Flatpak">Flatpak</a> и <a href="../../en/Fwupd.html" title="Fwupd">обновления прошивок</a>
</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://wiki.gnome.org/Apps/Software">https://wiki.gnome.org/Apps/Software</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gnome-software">gnome-software</a></span>
</dd></dl>
<ul><li>
<b>pcurses</b> — Обёртка для <i>pacman</i> на C++ с текстовым интерфейсом curses.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://github.com/schuay/pcurses">https://github.com/schuay/pcurses</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pcurses/">pcurses</a></span><sup><small>AUR</small></sup>
</dd></dl>
<ul><li>
<b>tkPacman</b> — Tk-обёртка для <i>pacman</i>, написанная на Tcl.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://sourceforge.net/projects/tkpacman">https://sourceforge.net/projects/tkpacman</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/tkpacman/">tkpacman</a></span><sup><small>AUR</small></sup>
</dd></dl>
<ul><li>
<b>bauh</b> — ранее известный как fpakman, - это графический интерфейс для управления программным обеспечением Linux (пакетами/приложениями). В настоящее время он поддерживает следующие форматы: AppImage, пакеты Debian и Arch Linux (включая AUR), Flatpak, Snap и веб-приложения.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://github.com/vinifmor/bauh">https://github.com/vinifmor/bauh</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/bauh-staging/">bauh-staging</a></span><sup><small>AUR</small></sup>
</dd></dl>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../../ru/Category:Package_manager.html" title="Category:Package manager (Русский)">Package manager (Русский)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../../en/Category:Pages_with_broken_package_links.html" title="Category:Pages with broken package links">Pages with broken package links</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Pacman_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)/Tips_and_tricks_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;oldid=799335">https://wiki.archlinux.org/index.php?title=Pacman_(Русский)/Tips_and_tricks_(Русский)&amp;oldid=799335</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 1 February 2024, at 18:08.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
