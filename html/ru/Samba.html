<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Samba (Русский) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Samba_Русский rootpage-Samba_Русский skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Сервер" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%A1%D0%B5%D1%80%D0%B2%D0%B5%D1%80">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Сервер</div>
		</a>
		
			<button aria-controls="toc-Сервер-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Сервер subsection</span>
			</button>
		
		<ul id="toc-Сервер-sublist" class="vector-toc-list">
			<li id="toc-Установка" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1</span>Установка</div>
			</a>
			
			<ul id="toc-Установка-sublist" class="vector-toc-list">
				<li id="toc-Включение_и_запуск_служб" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%92%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B8_%D0%B7%D0%B0%D0%BF%D1%83%D1%81%D0%BA_%D1%81%D0%BB%D1%83%D0%B6%D0%B1">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1.1</span>Включение и запуск служб</div>
			</a>
			
			<ul id="toc-Включение_и_запуск_служб-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Настройка_межсетевого_экрана" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_%D0%BC%D0%B5%D0%B6%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D0%BE%D0%B3%D0%BE_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1.2</span>Настройка межсетевого экрана</div>
			</a>
			
			<ul id="toc-Настройка_межсетевого_экрана-sublist" class="vector-toc-list">
				<li id="toc-Правило_UFW" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%B0%D0%B2%D0%B8%D0%BB%D0%BE_UFW">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1.2.1</span>Правило UFW</div>
			</a>
			
			<ul id="toc-Правило_UFW-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Служба_firewalld" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#%D0%A1%D0%BB%D1%83%D0%B6%D0%B1%D0%B0_firewalld">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1.2.2</span>Служба firewalld</div>
			</a>
			
			<ul id="toc-Служба_firewalld-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Использование" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.2</span>Использование</div>
			</a>
			
			<ul id="toc-Использование-sublist" class="vector-toc-list">
				<li id="toc-Управление_пользователями" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F%D0%BC%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.2.1</span>Управление пользователями</div>
			</a>
			
			<ul id="toc-Управление_пользователями-sublist" class="vector-toc-list">
				<li id="toc-Добавление_пользователя" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.2.1.1</span>Добавление пользователя</div>
			</a>
			
			<ul id="toc-Добавление_пользователя-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Просмотр_списка_пользователей" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80_%D1%81%D0%BF%D0%B8%D1%81%D0%BA%D0%B0_%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D0%B5%D0%B9">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.2.1.2</span>Просмотр списка пользователей</div>
			</a>
			
			<ul id="toc-Просмотр_списка_пользователей-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Смена_пароля_пользователя" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#%D0%A1%D0%BC%D0%B5%D0%BD%D0%B0_%D0%BF%D0%B0%D1%80%D0%BE%D0%BB%D1%8F_%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.2.1.3</span>Смена пароля пользователя</div>
			</a>
			
			<ul id="toc-Смена_пароля_пользователя-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Создание_общего_ресурса_для_анонимных_пользователей" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BE%D0%B1%D1%89%D0%B5%D0%B3%D0%BE_%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B0_%D0%B4%D0%BB%D1%8F_%D0%B0%D0%BD%D0%BE%D0%BD%D0%B8%D0%BC%D0%BD%D1%8B%D1%85_%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D0%B5%D0%B9">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.2.2</span>Создание общего ресурса для анонимных пользователей</div>
			</a>
			
			<ul id="toc-Создание_общего_ресурса_для_анонимных_пользователей-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Включение_следования_по_символическим_ссылкам" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%92%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F_%D0%BF%D0%BE_%D1%81%D0%B8%D0%BC%D0%B2%D0%BE%D0%BB%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%BC_%D1%81%D1%81%D1%8B%D0%BB%D0%BA%D0%B0%D0%BC">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.3</span>Включение следования по символическим ссылкам</div>
			</a>
			
			<ul id="toc-Включение_следования_по_символическим_ссылкам-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Расширенная_конфигурация" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A0%D0%B0%D1%81%D1%88%D0%B8%D1%80%D0%B5%D0%BD%D0%BD%D0%B0%D1%8F_%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D1%8F">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.4</span>Расширенная конфигурация</div>
			</a>
			
			<ul id="toc-Расширенная_конфигурация-sublist" class="vector-toc-list">
				<li id="toc-Создание_ресурсов_общего_доступа_от_имени_обычного_пользователя" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%BE%D0%B2_%D0%BE%D0%B1%D1%89%D0%B5%D0%B3%D0%BE_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0_%D0%BE%D1%82_%D0%B8%D0%BC%D0%B5%D0%BD%D0%B8_%D0%BE%D0%B1%D1%8B%D1%87%D0%BD%D0%BE%D0%B3%D0%BE_%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.4.1</span>Создание ресурсов общего доступа от имени обычного пользователя</div>
			</a>
			
			<ul id="toc-Создание_ресурсов_общего_доступа_от_имени_обычного_пользователя-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Установка_и_форсирование_прав_доступа" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B8_%D1%84%D0%BE%D1%80%D1%81%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BF%D1%80%D0%B0%D0%B2_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.4.2</span>Установка и форсирование прав доступа</div>
			</a>
			
			<ul id="toc-Установка_и_форсирование_прав_доступа-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Ограничение_версии_протокола_для_повышения_безопасности" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9E%D0%B3%D1%80%D0%B0%D0%BD%D0%B8%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B2%D0%B5%D1%80%D1%81%D0%B8%D0%B8_%D0%BF%D1%80%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%BB%D0%B0_%D0%B4%D0%BB%D1%8F_%D0%BF%D0%BE%D0%B2%D1%8B%D1%88%D0%B5%D0%BD%D0%B8%D1%8F_%D0%B1%D0%B5%D0%B7%D0%BE%D0%BF%D0%B0%D1%81%D0%BD%D0%BE%D1%81%D1%82%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.4.3</span>Ограничение версии протокола для повышения безопасности</div>
			</a>
			
			<ul id="toc-Ограничение_версии_протокола_для_повышения_безопасности-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Использование_шифрования_SMB" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%88%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F_SMB">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.4.4</span>Использование шифрования SMB</div>
			</a>
			
			<ul id="toc-Использование_шифрования_SMB-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Отключение_общего_доступа_к_принтерам" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9E%D1%82%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BE%D0%B1%D1%89%D0%B5%D0%B3%D0%BE_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0_%D0%BA_%D0%BF%D1%80%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%B0%D0%BC">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.4.5</span>Отключение общего доступа к принтерам</div>
			</a>
			
			<ul id="toc-Отключение_общего_доступа_к_принтерам-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Запрет_определённых_расширений_файлов_в_общем_ресурсе_Samba" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%97%D0%B0%D0%BF%D1%80%D0%B5%D1%82_%D0%BE%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D1%91%D0%BD%D0%BD%D1%8B%D1%85_%D1%80%D0%B0%D1%81%D1%88%D0%B8%D1%80%D0%B5%D0%BD%D0%B8%D0%B9_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%D0%B2_%D0%BE%D0%B1%D1%89%D0%B5%D0%BC_%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%B5_Samba">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.4.6</span>Запрет определённых расширений файлов в общем ресурсе Samba</div>
			</a>
			
			<ul id="toc-Запрет_определённых_расширений_файлов_в_общем_ресурсе_Samba-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Увеличение_пропускной_способности" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A3%D0%B2%D0%B5%D0%BB%D0%B8%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D1%80%D0%BE%D0%BF%D1%83%D1%81%D0%BA%D0%BD%D0%BE%D0%B9_%D1%81%D0%BF%D0%BE%D1%81%D0%BE%D0%B1%D0%BD%D0%BE%D1%81%D1%82%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.4.7</span>Увеличение пропускной способности</div>
			</a>
			
			<ul id="toc-Увеличение_пропускной_способности-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Включение_доступа_для_старых_клиентов_или_устройств" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%92%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0_%D0%B4%D0%BB%D1%8F_%D1%81%D1%82%D0%B0%D1%80%D1%8B%D1%85_%D0%BA%D0%BB%D0%B8%D0%B5%D0%BD%D1%82%D0%BE%D0%B2_%D0%B8%D0%BB%D0%B8_%D1%83%D1%81%D1%82%D1%80%D0%BE%D0%B9%D1%81%D1%82%D0%B2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.4.8</span>Включение доступа для старых клиентов или устройств</div>
			</a>
			
			<ul id="toc-Включение_доступа_для_старых_клиентов_или_устройств-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Включение_поиска_Spotlight" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%92%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D0%BE%D0%B8%D1%81%D0%BA%D0%B0_Spotlight">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.4.9</span>Включение поиска Spotlight</div>
			</a>
			
			<ul id="toc-Включение_поиска_Spotlight-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Клиент" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%9A%D0%BB%D0%B8%D0%B5%D0%BD%D1%82">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Клиент</div>
		</a>
		
			<button aria-controls="toc-Клиент-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Клиент subsection</span>
			</button>
		
		<ul id="toc-Клиент-sublist" class="vector-toc-list">
			<li id="toc-Просмотр_публичных_ресурсов_для_общего_доступа" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80_%D0%BF%D1%83%D0%B1%D0%BB%D0%B8%D1%87%D0%BD%D1%8B%D1%85_%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%BE%D0%B2_%D0%B4%D0%BB%D1%8F_%D0%BE%D0%B1%D1%89%D0%B5%D0%B3%D0%BE_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Просмотр публичных ресурсов для общего доступа</div>
			</a>
			
			<ul id="toc-Просмотр_публичных_ресурсов_для_общего_доступа-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Имена_хостов_NetBIOS/WINS" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%98%D0%BC%D0%B5%D0%BD%D0%B0_%D1%85%D0%BE%D1%81%D1%82%D0%BE%D0%B2_NetBIOS/WINS">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>Имена хостов NetBIOS/WINS</div>
			</a>
			
			<ul id="toc-Имена_хостов_NetBIOS/WINS-sublist" class="vector-toc-list">
				<li id="toc-Отключение_поддержки_NetBIOS/WINS" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9E%D1%82%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D0%B8_NetBIOS/WINS">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2.1</span>Отключение поддержки NetBIOS/WINS</div>
			</a>
			
			<ul id="toc-Отключение_поддержки_NetBIOS/WINS-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Ручное_монтирование" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A0%D1%83%D1%87%D0%BD%D0%BE%D0%B5_%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3</span>Ручное монтирование</div>
			</a>
			
			<ul id="toc-Ручное_монтирование-sublist" class="vector-toc-list">
				<li id="toc-Хранение_пароля_от_общих_ресурсов" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A5%D1%80%D0%B0%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D0%B0%D1%80%D0%BE%D0%BB%D1%8F_%D0%BE%D1%82_%D0%BE%D0%B1%D1%89%D0%B8%D1%85_%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%BE%D0%B2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3.1</span>Хранение пароля от общих ресурсов</div>
			</a>
			
			<ul id="toc-Хранение_пароля_от_общих_ресурсов-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Автоматическое_монтирование" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%90%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B5_%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4</span>Автоматическое монтирование</div>
			</a>
			
			<ul id="toc-Автоматическое_монтирование-sublist" class="vector-toc-list">
				<li id="toc-С_использованием_NetworkManager_и_GIO/gvfs" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A1_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC_NetworkManager_%D0%B8_GIO/gvfs">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4.1</span>С использованием NetworkManager и GIO/gvfs</div>
			</a>
			
			<ul id="toc-С_использованием_NetworkManager_и_GIO/gvfs-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-С_помощью_записи_в_fstab" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A1_%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E_%D0%B7%D0%B0%D0%BF%D0%B8%D1%81%D0%B8_%D0%B2_fstab">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4.2</span>С помощью записи в fstab</div>
			</a>
			
			<ul id="toc-С_помощью_записи_в_fstab-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-С_помощью_юнита_systemd" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A1_%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0_systemd">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4.3</span>С помощью юнита systemd</div>
			</a>
			
			<ul id="toc-С_помощью_юнита_systemd-sublist" class="vector-toc-list">
				<li id="toc-Автомонтирование" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#%D0%90%D0%B2%D1%82%D0%BE%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4.3.1</span>Автомонтирование</div>
			</a>
			
			<ul id="toc-Автомонтирование-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-smbnetfs" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#smbnetfs">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4.4</span>smbnetfs</div>
			</a>
			
			<ul id="toc-smbnetfs-sublist" class="vector-toc-list">
				<li id="toc-Демон" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#%D0%94%D0%B5%D0%BC%D0%BE%D0%BD">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4.4.1</span>Демон</div>
			</a>
			
			<ul id="toc-Демон-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-autofs" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#autofs">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4.5</span>autofs</div>
			</a>
			
			<ul id="toc-autofs-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Настройка_файлового_менеджера" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2%D0%BE%D0%B3%D0%BE_%D0%BC%D0%B5%D0%BD%D0%B5%D0%B4%D0%B6%D0%B5%D1%80%D0%B0">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.5</span>Настройка файлового менеджера</div>
			</a>
			
			<ul id="toc-Настройка_файлового_менеджера-sublist" class="vector-toc-list">
				<li id="toc-GNOME_Files,_Nemo,_Caja,_Thunar_и_PCManFM" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#GNOME_Files,_Nemo,_Caja,_Thunar_%D0%B8_PCManFM">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.5.1</span>GNOME Files, Nemo, Caja, Thunar и PCManFM</div>
			</a>
			
			<ul id="toc-GNOME_Files,_Nemo,_Caja,_Thunar_и_PCManFM-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-KDE" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#KDE">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.5.2</span>KDE</div>
			</a>
			
			<ul id="toc-KDE-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Другие_графические_окружения" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%94%D1%80%D1%83%D0%B3%D0%B8%D0%B5_%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B5_%D0%BE%D0%BA%D1%80%D1%83%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.5.3</span>Другие графические окружения</div>
			</a>
			
			<ul id="toc-Другие_графические_окружения-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Советы_и_рекомендации" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%A1%D0%BE%D0%B2%D0%B5%D1%82%D1%8B_%D0%B8_%D1%80%D0%B5%D0%BA%D0%BE%D0%BC%D0%B5%D0%BD%D0%B4%D0%B0%D1%86%D0%B8%D0%B8">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Советы и рекомендации</div>
		</a>
		
			<button aria-controls="toc-Советы_и_рекомендации-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Советы и рекомендации subsection</span>
			</button>
		
		<ul id="toc-Советы_и_рекомендации-sublist" class="vector-toc-list">
			<li id="toc-Обнаружение_общих_сетевых_ресурсов" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9E%D0%B1%D0%BD%D0%B0%D1%80%D1%83%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BE%D0%B1%D1%89%D0%B8%D1%85_%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D1%8B%D1%85_%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%BE%D0%B2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>Обнаружение общих сетевых ресурсов</div>
			</a>
			
			<ul id="toc-Обнаружение_общих_сетевых_ресурсов-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Удалённое_управление_компьютером_Windows" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A3%D0%B4%D0%B0%D0%BB%D1%91%D0%BD%D0%BD%D0%BE%D0%B5_%D1%83%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BA%D0%BE%D0%BC%D0%BF%D1%8C%D1%8E%D1%82%D0%B5%D1%80%D0%BE%D0%BC_Windows">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>Удалённое управление компьютером Windows</div>
			</a>
			
			<ul id="toc-Удалённое_управление_компьютером_Windows-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Решение_проблем" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%A0%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Решение проблем</div>
		</a>
		
			<button aria-controls="toc-Решение_проблем-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Решение проблем subsection</span>
			</button>
		
		<ul id="toc-Решение_проблем-sublist" class="vector-toc-list">
			<li id="toc-Не_удаётся_запустить_Samba_SMB/CIFS_сервер" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9D%D0%B5_%D1%83%D0%B4%D0%B0%D1%91%D1%82%D1%81%D1%8F_%D0%B7%D0%B0%D0%BF%D1%83%D1%81%D1%82%D0%B8%D1%82%D1%8C_Samba_SMB/CIFS_%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>Не удаётся запустить Samba SMB/CIFS сервер</div>
			</a>
			
			<ul id="toc-Не_удаётся_запустить_Samba_SMB/CIFS_сервер-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Проблемы_с_разрешениями_на_SELinux" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B_%D1%81_%D1%80%D0%B0%D0%B7%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D1%8F%D0%BC%D0%B8_%D0%BD%D0%B0_SELinux">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2</span>Проблемы с разрешениями на SELinux</div>
			</a>
			
			<ul id="toc-Проблемы_с_разрешениями_на_SELinux-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Проблемы_с_разрешениями_на_AppArmor" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B_%D1%81_%D1%80%D0%B0%D0%B7%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D1%8F%D0%BC%D0%B8_%D0%BD%D0%B0_AppArmor">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.3</span>Проблемы с разрешениями на AppArmor</div>
			</a>
			
			<ul id="toc-Проблемы_с_разрешениями_на_AppArmor-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-No_dialect_specified_on_mount" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#No_dialect_specified_on_mount">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4</span>No dialect specified on mount</div>
			</a>
			
			<ul id="toc-No_dialect_specified_on_mount-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Клиенты_Windows_продолжают_запрашивать_пароль,_даже_если_общие_ресурсы_Samba_созданы_с_правами_гостя" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9A%D0%BB%D0%B8%D0%B5%D0%BD%D1%82%D1%8B_Windows_%D0%BF%D1%80%D0%BE%D0%B4%D0%BE%D0%BB%D0%B6%D0%B0%D1%8E%D1%82_%D0%B7%D0%B0%D0%BF%D1%80%D0%B0%D1%88%D0%B8%D0%B2%D0%B0%D1%82%D1%8C_%D0%BF%D0%B0%D1%80%D0%BE%D0%BB%D1%8C,_%D0%B4%D0%B0%D0%B6%D0%B5_%D0%B5%D1%81%D0%BB%D0%B8_%D0%BE%D0%B1%D1%89%D0%B8%D0%B5_%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D1%8B_Samba_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D1%8B_%D1%81_%D0%BF%D1%80%D0%B0%D0%B2%D0%B0%D0%BC%D0%B8_%D0%B3%D0%BE%D1%81%D1%82%D1%8F">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.5</span>Клиенты Windows продолжают запрашивать пароль, даже если общие ресурсы Samba созданы с правами гостя</div>
			</a>
			
			<ul id="toc-Клиенты_Windows_продолжают_запрашивать_пароль,_даже_если_общие_ресурсы_Samba_созданы_с_правами_гостя-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Проблемы_подключения_к_Windows_7_-_mount_error(12):_cannot_allocate_memory" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B_%D0%BF%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D1%8F_%D0%BA_Windows_7_-_mount_error(12):_cannot_allocate_memory">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.6</span>Проблемы подключения к Windows 7 - mount error(12): cannot allocate memory</div>
			</a>
			
			<ul id="toc-Проблемы_подключения_к_Windows_7_-_mount_error(12):_cannot_allocate_memory-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id='toc-Проблемы_подключения_к_Windows_10_1709_и_новее_-_"Windows_cannot_access"_0x80004005' class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href='#%D0%9F%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B_%D0%BF%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D1%8F_%D0%BA_Windows_10_1709_%D0%B8_%D0%BD%D0%BE%D0%B2%D0%B5%D0%B5_-_"Windows_cannot_access"_0x80004005'>
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.7</span>Проблемы подключения к Windows 10 1709 и новее - "Windows cannot access" 0x80004005</div>
			</a>
			
			<ul id='toc-Проблемы_подключения_к_Windows_10_1709_и_новее_-_"Windows_cannot_access"_0x80004005-sublist' class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Ошибка:_Failed_to_retrieve_printer_list:_NT_STATUS_UNSUCCESSFUL" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9E%D1%88%D0%B8%D0%B1%D0%BA%D0%B0:_Failed_to_retrieve_printer_list:_NT_STATUS_UNSUCCESSFUL">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.8</span>Ошибка: Failed to retrieve printer list: NT_STATUS_UNSUCCESSFUL</div>
			</a>
			
			<ul id="toc-Ошибка:_Failed_to_retrieve_printer_list:_NT_STATUS_UNSUCCESSFUL-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Не_удается_предоставить_общий_доступ_к_папке" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9D%D0%B5_%D1%83%D0%B4%D0%B0%D0%B5%D1%82%D1%81%D1%8F_%D0%BF%D1%80%D0%B5%D0%B4%D0%BE%D1%81%D1%82%D0%B0%D0%B2%D0%B8%D1%82%D1%8C_%D0%BE%D0%B1%D1%89%D0%B8%D0%B9_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF_%D0%BA_%D0%BF%D0%B0%D0%BF%D0%BA%D0%B5">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.9</span>Не удается предоставить общий доступ к папке</div>
			</a>
			
			<ul id="toc-Не_удается_предоставить_общий_доступ_к_папке-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id='toc-"Просмотр"_сети_выдает_ошибку_"Не_удалось_получить_список_ресурсов_с_сервера"_(Failed_to_retrieve_share_list_from_server)' class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href='#"%D0%9F%D1%80%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80"_%D1%81%D0%B5%D1%82%D0%B8_%D0%B2%D1%8B%D0%B4%D0%B0%D0%B5%D1%82_%D0%BE%D1%88%D0%B8%D0%B1%D0%BA%D1%83_"%D0%9D%D0%B5_%D1%83%D0%B4%D0%B0%D0%BB%D0%BE%D1%81%D1%8C_%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B8%D1%82%D1%8C_%D1%81%D0%BF%D0%B8%D1%81%D0%BE%D0%BA_%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%BE%D0%B2_%D1%81_%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B0"_(Failed_to_retrieve_share_list_from_server)'>
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.10</span>"Просмотр" сети выдает ошибку "Не удалось получить список ресурсов с сервера" (Failed to retrieve share list from server)</div>
			</a>
			
			<ul id='toc-"Просмотр"_сети_выдает_ошибку_"Не_удалось_получить_список_ресурсов_с_сервера"_(Failed_to_retrieve_share_list_from_server)-sublist' class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-protocol_negotiation_failed:_NT_STATUS_INVALID_NETWORK_RESPONSE" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#protocol_negotiation_failed:_NT_STATUS_INVALID_NETWORK_RESPONSE">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.11</span>protocol negotiation failed: NT_STATUS_INVALID_NETWORK_RESPONSE</div>
			</a>
			
			<ul id="toc-protocol_negotiation_failed:_NT_STATUS_INVALID_NETWORK_RESPONSE-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Подключение_к_серверу_завершилось_неудачей:_(Error_NT_STATUS_UNSUCCESSFUL)" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BA_%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D1%83_%D0%B7%D0%B0%D0%B2%D0%B5%D1%80%D1%88%D0%B8%D0%BB%D0%BE%D1%81%D1%8C_%D0%BD%D0%B5%D1%83%D0%B4%D0%B0%D1%87%D0%B5%D0%B9:_(Error_NT_STATUS_UNSUCCESSFUL)">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.12</span>Подключение к серверу завершилось неудачей: (Error NT_STATUS_UNSUCCESSFUL)</div>
			</a>
			
			<ul id="toc-Подключение_к_серверу_завершилось_неудачей:_(Error_NT_STATUS_UNSUCCESSFUL)-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Подключение_к_серверу_завершилось_неудачей:_(Error_NT_STATUS_CONNECTION_REFUSED)" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BA_%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D1%83_%D0%B7%D0%B0%D0%B2%D0%B5%D1%80%D1%88%D0%B8%D0%BB%D0%BE%D1%81%D1%8C_%D0%BD%D0%B5%D1%83%D0%B4%D0%B0%D1%87%D0%B5%D0%B9:_(Error_NT_STATUS_CONNECTION_REFUSED)">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.13</span>Подключение к серверу завершилось неудачей: (Error NT_STATUS_CONNECTION_REFUSED)</div>
			</a>
			
			<ul id="toc-Подключение_к_серверу_завершилось_неудачей:_(Error_NT_STATUS_CONNECTION_REFUSED)-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Protocol_negotiation_failed:_NT_STATUS_CONNECTION_RESET" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Protocol_negotiation_failed:_NT_STATUS_CONNECTION_RESET">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.14</span>Protocol negotiation failed: NT_STATUS_CONNECTION_RESET</div>
			</a>
			
			<ul id="toc-Protocol_negotiation_failed:_NT_STATUS_CONNECTION_RESET-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Правильный_пароль_не_подходит_(ошибка_1326)" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%B0%D0%B2%D0%B8%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D0%BF%D0%B0%D1%80%D0%BE%D0%BB%D1%8C_%D0%BD%D0%B5_%D0%BF%D0%BE%D0%B4%D1%85%D0%BE%D0%B4%D0%B8%D1%82_(%D0%BE%D1%88%D0%B8%D0%B1%D0%BA%D0%B0_1326)">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.15</span>Правильный пароль не подходит (ошибка 1326)</div>
			</a>
			
			<ul id="toc-Правильный_пароль_не_подходит_(ошибка_1326)-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Сопоставление_зарезервированных_символов_Windows" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A1%D0%BE%D0%BF%D0%BE%D1%81%D1%82%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B7%D0%B0%D1%80%D0%B5%D0%B7%D0%B5%D1%80%D0%B2%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D1%85_%D1%81%D0%B8%D0%BC%D0%B2%D0%BE%D0%BB%D0%BE%D0%B2_Windows">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.16</span>Сопоставление зарезервированных символов Windows</div>
			</a>
			
			<ul id="toc-Сопоставление_зарезервированных_символов_Windows-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Папка,_к_которой_открыт_доступ_через_графический_интерфейс,_недоступна_для_гостей" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D0%B0%D0%BF%D0%BA%D0%B0,_%D0%BA_%D0%BA%D0%BE%D1%82%D0%BE%D1%80%D0%BE%D0%B9_%D0%BE%D1%82%D0%BA%D1%80%D1%8B%D1%82_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF_%D1%87%D0%B5%D1%80%D0%B5%D0%B7_%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81,_%D0%BD%D0%B5%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%BD%D0%B0_%D0%B4%D0%BB%D1%8F_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B9">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.17</span>Папка, к которой открыт доступ через графический интерфейс, недоступна для гостей</div>
			</a>
			
			<ul id="toc-Папка,_к_которой_открыт_доступ_через_графический_интерфейс,_недоступна_для_гостей-sublist" class="vector-toc-list">
				<li id="toc-Проверьте_правильность_конфигурации_samba" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D1%8C%D1%82%D0%B5_%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D1%8C_%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D0%B8_samba">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.17.1</span>Проверьте правильность конфигурации samba</div>
			</a>
			
			<ul id="toc-Проверьте_правильность_конфигурации_samba-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Проверьте_правильность_создания_общей_папки" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D1%8C%D1%82%D0%B5_%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D1%8C_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D1%8F_%D0%BE%D0%B1%D1%89%D0%B5%D0%B9_%D0%BF%D0%B0%D0%BF%D0%BA%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.17.2</span>Проверьте правильность создания общей папки</div>
			</a>
			
			<ul id="toc-Проверьте_правильность_создания_общей_папки-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Проверьте_доступ_к_папке_от_имени_гостя" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D1%8C%D1%82%D0%B5_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF_%D0%BA_%D0%BF%D0%B0%D0%BF%D0%BA%D0%B5_%D0%BE%D1%82_%D0%B8%D0%BC%D0%B5%D0%BD%D0%B8_%D0%B3%D0%BE%D1%81%D1%82%D1%8F">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.17.3</span>Проверьте доступ к папке от имени гостя</div>
			</a>
			
			<ul id="toc-Проверьте_доступ_к_папке_от_имени_гостя-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Mount_error:_Host_is_down" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Mount_error:_Host_is_down">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.18</span>Mount error: Host is down</div>
			</a>
			
			<ul id="toc-Mount_error:_Host_is_down-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Software_caused_connection_abort" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Software_caused_connection_abort">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.19</span>Software caused connection abort</div>
			</a>
			
			<ul id="toc-Software_caused_connection_abort-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Ошибка_аутентификации" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9E%D1%88%D0%B8%D0%B1%D0%BA%D0%B0_%D0%B0%D1%83%D1%82%D0%B5%D0%BD%D1%82%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.20</span>Ошибка аутентификации</div>
			</a>
			
			<ul id="toc-Ошибка_аутентификации-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Windows_1709_и_новее_не_видит_сервер_samba_при_просмотре_сети" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Windows_1709_%D0%B8_%D0%BD%D0%BE%D0%B2%D0%B5%D0%B5_%D0%BD%D0%B5_%D0%B2%D0%B8%D0%B4%D0%B8%D1%82_%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80_samba_%D0%BF%D1%80%D0%B8_%D0%BF%D1%80%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80%D0%B5_%D1%81%D0%B5%D1%82%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.21</span>Windows 1709 и новее не видит сервер samba при просмотре сети</div>
			</a>
			
			<ul id="toc-Windows_1709_и_новее_не_видит_сервер_samba_при_просмотре_сети-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Файлы_из_IOS_больше_не_могут_копироваться_в_общий_ресурс_Samba_в_Arch_Linux,_начиная_с_IOS_14.5" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A4%D0%B0%D0%B9%D0%BB%D1%8B_%D0%B8%D0%B7_IOS_%D0%B1%D0%BE%D0%BB%D1%8C%D1%88%D0%B5_%D0%BD%D0%B5_%D0%BC%D0%BE%D0%B3%D1%83%D1%82_%D0%BA%D0%BE%D0%BF%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D1%82%D1%8C%D1%81%D1%8F_%D0%B2_%D0%BE%D0%B1%D1%89%D0%B8%D0%B9_%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81_Samba_%D0%B2_Arch_Linux,_%D0%BD%D0%B0%D1%87%D0%B8%D0%BD%D0%B0%D1%8F_%D1%81_IOS_14.5">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.22</span>Файлы из IOS больше не могут копироваться в общий ресурс Samba в Arch Linux, начиная с IOS 14.5</div>
			</a>
			
			<ul id="toc-Файлы_из_IOS_больше_не_могут_копироваться_в_общий_ресурс_Samba_в_Arch_Linux,_начиная_с_IOS_14.5-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Смотрите_также" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%A1%D0%BC%D0%BE%D1%82%D1%80%D0%B8%D1%82%D0%B5_%D1%82%D0%B0%D0%BA%D0%B6%D0%B5">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Смотрите также</div>
		</a>
		
		<ul id="toc-Смотрите_также-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Samba (Русский)</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 5 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-5" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">5 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-de mw-list-item"><a href="https://wiki.archlinux.de/title/Samba" title="Samba – Deutsch" lang="de" hreflang="de" class="interlanguage-link-target"><span>Deutsch</span></a></li>
<li class="interlanguage-link interwiki-en mw-list-item"><a href="../en/Samba.html" title="Samba – English" lang="en" hreflang="en" class="interlanguage-link-target"><span>English</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Samba" title="Samba – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-pt mw-list-item"><a href="../pt/Samba.html" title="Samba – português" lang="pt" hreflang="pt" class="interlanguage-link-target"><span>Português</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/Samba" title="Samba – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="ru" dir="ltr">
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Состояние перевода:</strong> На этой странице представлен перевод статьи <a href="../en/Samba.html" title="Samba">Samba</a>. Дата последней синхронизации: 20 марта 2022. Вы можете <a href="../ru/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (Русский)">помочь</a> синхронизировать перевод, если в английской версии произошли <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Samba&amp;diff=0&amp;oldid=723547">изменения</a>.</div>
<div class="archwiki-template-meta-related-articles">
<p>Ссылки по теме</p>
<ul>
<li><a href="../ru/Active_Directory_integration.html" class="mw-redirect" title="Интеграция Active Directory">Интеграция Active Directory</a></li>
<li><a href="../en/Samba/Active_Directory_domain_controller.html" class="mw-redirect" title="Samba/Контроллер домена Active Directory">Samba/Контроллер домена Active Directory</a></li>
<li><a href="../en/NFS.html" class="mw-redirect" title="NFS (Русский)">NFS (Русский)</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://www.samba.org/">Samba</a> — это реализация сетевого протокола <a href="https://en.wikipedia.org/wiki/ru:Server_Message_Block" class="extiw" title="wikipedia:ru:Server Message Block">SMB</a>. Она облегчает организацию общего доступа к файлам и принтерам между системами Linux и Windows и является альтернативой <a href="../en/NFS.html" class="mw-redirect" title="NFS (Русский)">NFS</a>.
</p>
<p>Создание общих ресурсов описано в разделе <a href="#%D0%A1%D0%B5%D1%80%D0%B2%D0%B5%D1%80">#Сервер</a>; подключение к общим ресурсам описано в разделе <a href="#%D0%9A%D0%BB%D0%B8%D0%B5%D0%BD%D1%82">#Клиент</a>.
</p>
<meta property="mw:PageProp/toc">
<h2>
<span id=".D0.A1.D0.B5.D1.80.D0.B2.D0.B5.D1.80"></span><span class="mw-headline" id="Сервер">Сервер</span>
</h2>
<h3>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0"></span><span class="mw-headline" id="Установка">Установка</span>
</h3>
<p><a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установите">Установите</a> пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=samba">samba</a></span>.
</p>
<p>Samba настраивается с помощью файла <code>/etc/samba/smb.conf</code>, который подробно документирован на странице руководства <span class="plainlinks archwiki-template-man" title="$ man 5 smb.conf"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/smb.conf.5">smb.conf(5)</a></span>.
</p>
<p>В связи с тем, что пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=samba">samba</a></span> поставляется без данного файла, вам нужно создать его <b>перед</b> запуском <code>smb.service</code>.
</p>
<p>Вы можете воспользоваться документированным примером, как в  <code>smb.conf.default</code> из <a rel="nofollow" class="external text" href="https://git.samba.org/samba.git/?p=samba.git;a=blob_plain;f=examples/smb.conf.default;hb=HEAD">git-репозитория Samba</a> для создания <code>/etc/samba/smb.conf</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> 
<ul>
<li>Значение <code>log file</code> в стандартном файле настроек указывает в место, доступное только для чтения, что будет вызывать ошибки. Можно воспользоваться одним из следующих решений:
<ul>
<li>Задайте расположение, доступное для записи: <code>log file = /var/log/samba/%m.log</code>
</li>
<li>Используйте бекенд для нефайлового журналирования: замените <code>logging = syslog</code> на <code>syslog only = yes</code> или используйте <code>logging = systemd</code>
</li>
</ul>
</li>
<li>Если требуется; <code>workgroup</code>, указанная в секции <code>[global]</code>, должна соответствовать домашней группе (workgroup) Windows (по умолчанию: <code>WORKGROUP</code>).</li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> Каждый раз, когда вы изменяете файл <code>smb.conf</code>, запускайте команду <span class="plainlinks archwiki-template-man" title="$ man 1 testparm"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/testparm.1">testparm(1)</a></span> для проверки файла на синтаксические ошибки.</div>
<h4>
<span id=".D0.92.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B8_.D0.B7.D0.B0.D0.BF.D1.83.D1.81.D0.BA_.D1.81.D0.BB.D1.83.D0.B6.D0.B1"></span><span class="mw-headline" id="Включение_и_запуск_служб">Включение и запуск служб</span>
</h4>
<p>Для работы общего доступа к файлам <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Запустите">запустите</a> и <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Включите">включите</a> службу <code>smb.service</code>. Смотрите <span class="plainlinks archwiki-template-man" title="$ man 8 smbd"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/smbd.8">smbd(8)</a></span> для более подробной информации.
</p>
<p>Если вы хотите, чтобы сервер был доступен по имени хоста NetBIOS, пропишите желаемое имя в опции <code>netbios name</code> в <code>smb.conf</code> и <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Запустите">запустите</a> и <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Включите">включите</a> службу <code>nmb.service</code>. Смотрите <span class="plainlinks archwiki-template-man" title="$ man 8 nmbd"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/nmbd.8">nmbd(8)</a></span> для более подробной информации.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Использовать <code>nmb.service</code> необязательно, однако он нужен для подключения к Samba-серверу по имени хоста (например, <code>smb://hostname/</code>). Если в вашей сети используются только компьютеры с Windows 10 или новее, также стоит <a href="#Windows_1709_%D0%B8_%D0%BD%D0%BE%D0%B2%D0%B5%D0%B5_%D0%BD%D0%B5_%D0%B2%D0%B8%D0%B4%D0%B8%D1%82_%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80_samba_%D0%BF%D1%80%D0%B8_%D0%BF%D1%80%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80%D0%B5_%D1%81%D0%B5%D1%82%D0%B8">установить демон WSD</a>, чтобы Проводник отображал сервер в просмотре сети.</div>
<h4>
<span id=".D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_.D0.BC.D0.B5.D0.B6.D1.81.D0.B5.D1.82.D0.B5.D0.B2.D0.BE.D0.B3.D0.BE_.D1.8D.D0.BA.D1.80.D0.B0.D0.BD.D0.B0"></span><span class="mw-headline" id="Настройка_межсетевого_экрана">Настройка межсетевого экрана</span>
</h4>
<p>Если вы используете <a href="../ru/Category:Firewalls.html" class="mw-redirect" title="Межсетевой экран">межсетевой экран</a>, не забудьте открыть необходимые порты (как правило, 137-139 + 445). Для получения информации о полном списке портов, смотрите <a rel="nofollow" class="external text" href="https://www.samba.org/~tpot/articles/firewall.html">использование портов Samba</a>.
</p>
<h5>
<span id=".D0.9F.D1.80.D0.B0.D0.B2.D0.B8.D0.BB.D0.BE_UFW"></span><span class="mw-headline" id="Правило_UFW">Правило UFW</span>
</h5>
<p>Профиль <a href="../en/Uncomplicated_Firewall.html" class="mw-redirect" title="Ufw">Ufw</a> для SMB/CIFS доступен в стандартной установке UFW в <code>ufw-fileserver</code>.
</p>
<p>Разрешите Samba, выполнив команду <code>ufw allow CIFS</code> от имени root.
</p>
<p>Если вы удалили профиль, создайте или отредактируйте файл <code>/etc/ufw/applications.d/samba</code>, добавив следующее:
</p>
<pre>[Samba]
title=LanManager-like file and printer server for Unix
description=The Samba software suite is a collection of programs that implements the SMB/CIFS protocol for unix systems, allowing you to serve files and printers to Windows, NT, OS/2 and DOS clients. This protocol is sometimes also referred to as the LanManager or NetBIOS protocol.
ports=137,138/udp|139,445/tcp
</pre>
<p>Затем загрузите этот профиль в UFW, запустив команду <code>ufw app update Samba</code> как root.
</p>
<p>После этого можно разрешить доступ к Samba, запустив <code>ufw allow Samba</code> от имени root.
</p>
<h5>
<span id=".D0.A1.D0.BB.D1.83.D0.B6.D0.B1.D0.B0_firewalld"></span><span class="mw-headline" id="Служба_firewalld">Служба firewalld</span>
</h5>
<p>Для настройки <a href="../en/Firewalld.html" title="Firewalld">firewalld</a>, чтобы разрешить Samba в зоне <b>home</b>, выполните:
</p>
<pre># firewall-cmd --permanent --add-service={samba,samba-client,samba-dc} --zone=home
</pre>
<p>Эти три службы таковы:
</p>
<ul>
<li>
<code>samba</code>: для общего доступа к файлам.</li>
<li>
<code>samba-client</code>: для просмотра общих ресурсов других устройств по сети.</li>
<li>
<code>samba-dc</code>: для <a href="../en/Samba/Active_Directory_domain_controller.html" class="mw-redirect" title="Samba (Русский)/Active Directory domain controller (Русский)">контроллера домена Active Directory</a>.</li>
</ul>
<p>Параметр <code>--permanent</code> сделает изменения постоянными.
</p>
<h3>
<span id=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Использование">Использование</span>
</h3>
<h4>
<span id=".D0.A3.D0.BF.D1.80.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D1.8F.D0.BC.D0.B8"></span><span class="mw-headline" id="Управление_пользователями">Управление пользователями</span>
</h4>
<p>В следующем разделе описывается создание локальной (tdbsam) базы данных пользователей Samba. Для аутентификации пользователей и других целей Samba также может быть привязана к домену Active Directory, может сама служить контроллером домена Active Directory или использоваться с сервером LDAP.
</p>
<h5>
<span id=".D0.94.D0.BE.D0.B1.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D1.8F"></span><span class="mw-headline" id="Добавление_пользователя">Добавление пользователя</span>
</h5>
<p>Для работы Samba требуется какой-нибудь Linux-пользователь — вы можете использовать существующего пользователя или <a href="../ru/Users_and_groups.html#%D0%9F%D1%80%D0%B8%D0%BC%D0%B5%D1%80_%D0%B4%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F_%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F" title="Users and groups (Русский)">создать нового</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Пользователь и группа <i>nobody</i> изначально существуют в системе, используются как гостевой аккаунт (<code>guest account</code>) по умолчанию и могут быть использованы в ресурсах для общего доступа с опцией <code>guest ok = yes</code>, благодаря чему пользователям не понадобится логиниться для доступа к таким ресурсам.</div>
<p>Хотя имена пользователей Samba общие с системными пользователями, Samba использует для них отдельные пароли. Чтобы добавить нового пользователя Samba, воспользуйтесь следующей, заменив <code>пользователь_samba</code> на имя нужного пользователя:
</p>
<pre># smbpasswd -a <i>пользователь_samba</i>
</pre>
<p>Будет предложено задать пароль для этого пользователя.
</p>
<p>В зависимости от <a rel="nofollow" class="external text" href="https://www.samba.org/samba/docs/man/manpages-3/smb.conf.5.html#SERVERROLE">роли сервера</a> может понадобиться изменить <a href="../ru/File_permissions_and_attributes.html" class="mw-redirect" title="Разрешения и атрибуты файлов">разрешения и атрибуты файлов</a> для аккаунта Samba.
</p>
<p>Если вы хотите разрешить новому пользователю только доступ к Samba-ресурсам и запретить полноценный вход в систему, можно ограничить возможности входа:
</p>
<ul>
<li>отключить командную оболочку - <code>usermod --shell /usr/bin/nologin --lock <i>пользователь_samba</i></code>
</li>
<li>отключить вход по SSH - измените опцию <code>AllowUsers</code> в файле <code>/etc/ssh/sshd_config</code>
</li>
</ul>
<p>См. также <a href="../ru/Security.html" title="Security (Русский)">рекомендации по повышению защищённости системы</a>.
</p>
<h5>
<span id=".D0.9F.D1.80.D0.BE.D1.81.D0.BC.D0.BE.D1.82.D1.80_.D1.81.D0.BF.D0.B8.D1.81.D0.BA.D0.B0_.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D0.B5.D0.B9"></span><span class="mw-headline" id="Просмотр_списка_пользователей">Просмотр списка пользователей</span>
</h5>
<p>Список добавленных в Samba пользователей можно посмотреть с помощью команды <span class="plainlinks archwiki-template-man" title="$ man 8 pdbedit"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/pdbedit.8">pdbedit(8)</a></span>:
</p>
<pre># pdbedit -L -v
</pre>
<h5>
<span id=".D0.A1.D0.BC.D0.B5.D0.BD.D0.B0_.D0.BF.D0.B0.D1.80.D0.BE.D0.BB.D1.8F_.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D1.8F"></span><span class="mw-headline" id="Смена_пароля_пользователя">Смена пароля пользователя</span>
</h5>
<p>Чтобы сменить пароль пользователя, используйте <code>smbpasswd</code>:
</p>
<pre># smbpasswd <i>пользователь_samba</i>
</pre>
<h4>
<span id=".D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D0.B5_.D0.BE.D0.B1.D1.89.D0.B5.D0.B3.D0.BE_.D1.80.D0.B5.D1.81.D1.83.D1.80.D1.81.D0.B0_.D0.B4.D0.BB.D1.8F_.D0.B0.D0.BD.D0.BE.D0.BD.D0.B8.D0.BC.D0.BD.D1.8B.D1.85_.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D0.B5.D0.B9"></span><span class="mw-headline" id="Создание_общего_ресурса_для_анонимных_пользователей">Создание общего ресурса для анонимных пользователей</span>
</h4>
<p>1. Создайте пользователя Linux, который будет использоваться для анонимных пользователей Samba:
</p>
<pre># useradd guest -s /bin/nologin
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Имя пользователя может быть любым допустимым именем Linux, не только "guest". Пользователь не обязательно должен быть пользователем Samba.</div>
<p>2. Добавьте в <code>/etc/samba/smb.conf</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/samba/smb.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
[global]
security = user
map to guest = bad user
guest account = guest

[guest]
    comment = guest
    path = /tmp/
    public = yes
    only guest = yes
    writable = yes
    printable = no</pre>
<p>Теперь все анонимные пользователи будут использовать Linux-пользователя <code>guest</code> для доступа к каталогам, указанным в <code>guest.path</code> (в данном примере <code>/tmp/</code>).
</p>
<p>Убедитесь, что общие ресурсы корректно настроены в соответствии с секцией <i>Share Definitions</i> из <a rel="nofollow" class="external text" href="https://git.samba.org/samba.git/?p=samba.git;a=blob_plain;f=examples/smb.conf.default;hb=HEAD">smb.conf.default</a>.
</p>
<h3>
<span id=".D0.92.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D1.81.D0.BB.D0.B5.D0.B4.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F_.D0.BF.D0.BE_.D1.81.D0.B8.D0.BC.D0.B2.D0.BE.D0.BB.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B8.D0.BC_.D1.81.D1.81.D1.8B.D0.BB.D0.BA.D0.B0.D0.BC"></span><span class="mw-headline" id="Включение_следования_по_символическим_ссылкам">Включение следования по символическим ссылкам</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно:</strong> Включение опции <code>follow symlinks</code> может быть риском для безопасности.</div>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/samba/smb.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
[global]
   follow symlinks = yes
   wide links = yes
   unix extensions = no</pre>
<p>После изменений <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Перезапустите">перезапустите</a> службу <code>smb.service</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> При использовании <a href="../en/AppArmor.html" title="AppArmor">AppArmor</a>, если символическая ссылка указывает за пределы домашнего каталога пользователя или <a href="#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%BE%D0%B2_%D0%BE%D0%B1%D1%89%D0%B5%D0%B3%D0%BE_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0_%D0%BE%D1%82_%D0%B8%D0%BC%D0%B5%D0%BD%D0%B8_%D0%BE%D0%B1%D1%8B%D1%87%D0%BD%D0%BE%D0%B3%D0%BE_%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F">usershare</a>, понадобится <a href="#%D0%9F%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B_%D1%81_%D1%80%D0%B0%D0%B7%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D1%8F%D0%BC%D0%B8_%D0%BD%D0%B0_AppArmor">изменить разрешения в профиле AppArmor</a>.</div>
<h3>
<span id=".D0.A0.D0.B0.D1.81.D1.88.D0.B8.D1.80.D0.B5.D0.BD.D0.BD.D0.B0.D1.8F_.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D1.8F"></span><span class="mw-headline" id="Расширенная_конфигурация">Расширенная конфигурация</span>
</h3>
<h4>
<span id=".D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D0.B5_.D1.80.D0.B5.D1.81.D1.83.D1.80.D1.81.D0.BE.D0.B2_.D0.BE.D0.B1.D1.89.D0.B5.D0.B3.D0.BE_.D0.B4.D0.BE.D1.81.D1.82.D1.83.D0.BF.D0.B0_.D0.BE.D1.82_.D0.B8.D0.BC.D0.B5.D0.BD.D0.B8_.D0.BE.D0.B1.D1.8B.D1.87.D0.BD.D0.BE.D0.B3.D0.BE_.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D1.8F"></span><span class="mw-headline" id="Создание_ресурсов_общего_доступа_от_имени_обычного_пользователя">Создание ресурсов общего доступа от имени обычного пользователя</span>
</h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Это опциональная возможность. Можете пропустить этот раздел, если она вам не нужна.</div>
<p><a rel="nofollow" class="external text" href="https://www.samba.org/samba/docs/current/man-html/smb.conf.5.html">Usershares</a> — это возможность, позволяющая обычным пользователям добавлять, изменять и удалять собственные ресурсы общего доступа.
</p>
<ol>
<li>Создайте каталог, в котором будут храниться описания пользовательских общих ресурсов: <pre># mkdir /var/lib/samba/usershares</pre>
</li>
<li>Создайте <a href="../ru/Users_and_groups.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B3%D1%80%D1%83%D0%BF%D0%BF%D0%B0%D0%BC%D0%B8" title="Users and groups (Русский)">группу</a> для пользователей, которые смогут создавать общие ресурсы: <pre># groupadd -r sambashare</pre>
</li>
<li>Измените владельца каталога на <code>root</code>, а группу на <code>sambashare</code>: <pre># chown root:sambashare /var/lib/samba/usershares</pre>
</li>
<li>Измените разрешения каталога <code>usershares</code>, чтобы только пользователи из группы <code>sambashare</code> могли создавать файлы. Эта команда также устанавливает <a href="https://en.wikipedia.org/wiki/ru:Sticky_bit" class="extiw" title="wikipedia:ru:Sticky bit">sticky bit</a>, благодаря которому пользователи не смогут удалять чужие общие ресурсы: <pre># chmod 1770 /var/lib/samba/usershares</pre>
</li>
</ol>
<p>Задайте эти переменные в конфигурационном файле <code>smb.conf</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/samba/smb.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[global]
  usershare path = /var/lib/samba/usershares
  usershare max shares = 100
  usershare allow guests = yes
  usershare owner only = yes</pre>
<p>Добавьте вашего пользователя в группу <i>sambashare</i>. Замените <code>ваше_имя_пользователя</code> на имя вашего linux-пользователя:
</p>
<pre># gpasswd sambashare -a <i>ваше_имя_пользователя</i>
</pre>
<p><a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Перезапустите">Перезапустите</a> службы <code>smb.service</code> и <code>nmb.service</code>.
</p>
<p>Завершите сеанс и войдите снова, чтобы применилось добавление новой группы к вашему пользователю.
</p>
<p>Если вы хотите предоставить общий доступ к файлам, находящимся в вашем домашнем каталоге, не забудьте задать доступ как минимум на чтение другим пользователям (<code>chmod a+rX</code>).
</p>
<p>Теперь у вас должна появиться возможность настраивать общий доступ samba, используя графический интерфейс. Например, в <a href="../ru/Thunar.html" title="Thunar (Русский)">Thunar</a> или <a href="../en/Dolphin.html" title="Dolphin">Dolphin</a> вы можете нажать правую кнопку мыши на любом каталоге и предоставить для него общий доступ в сети.
</p>
<p>Для настройки общего доступа через командную строку используйте одну из следующих команд:
</p>
<pre># net usershare add <i>имя-ресурса</i> <i>абсолютный-путь</i> [<i>комментарий</i>] [<i>пользователь</i>:{R|D|F}] [guest_ok={y|n}]
# net usershare delete <i>имя-ресурса</i>
# net usershare list <i>wildcard-имя-ресурса</i>
# net usershare info <i>wildcard-имя-ресурса</i>
</pre>
<h4>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_.D0.B8_.D1.84.D0.BE.D1.80.D1.81.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.B0.D0.B2_.D0.B4.D0.BE.D1.81.D1.82.D1.83.D0.BF.D0.B0"></span><span class="mw-headline" id="Установка_и_форсирование_прав_доступа">Установка и форсирование прав доступа</span>
</h4>
<p>Разрешения могут быть применены и к серверу, и к отдельным ресурсам:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/samba/smb.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[global]
  ;inherit owner = unix only ; Наследовать владельца родительского каталога для новых файлов и каталогов
  ;inherit permissions = yes ; Наследовать разрешения родительского каталога для новых файлов и каталогов
  create mask = 0664
  directory mask = 2755
  force create mode = 0644
  force directory mode = 2755
  ...

[media]
  comment = Ресурс, доступный для <i>greg</i> и <i>pcusers</i>
  path = <i>/path/to/media</i>
  valid users = <i>greg @pcusers</i>
  force group = <i>+pcusers</i>
  public = no
  writable = yes
  create mask = 0664
  directory mask = 2775
  force create mode = 0664
  force directory mode = 2775

[public]
  comment = Общий ресурс, в котором <i>archie</i> имеет доступ на запись
  path = <i>/path/to/public</i>
  public = yes
  read only = yes
  write list = <i>archie</i>
  printable = no

[guests]
  comment = Ресурс, разрешающий чтение и запись всем пользователям
  path = <i>/path/to/guests</i>
  public = yes
  only guest = yes
  writable = yes
  printable = no</pre>
<p>См. <span class="plainlinks archwiki-template-man" title="$ man 5 smb.conf"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/smb.conf.5">smb.conf(5)</a></span> для более подробной информации о настройке прав доступа.
</p>
<h4>
<span id=".D0.9E.D0.B3.D1.80.D0.B0.D0.BD.D0.B8.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B2.D0.B5.D1.80.D1.81.D0.B8.D0.B8_.D0.BF.D1.80.D0.BE.D1.82.D0.BE.D0.BA.D0.BE.D0.BB.D0.B0_.D0.B4.D0.BB.D1.8F_.D0.BF.D0.BE.D0.B2.D1.8B.D1.88.D0.B5.D0.BD.D0.B8.D1.8F_.D0.B1.D0.B5.D0.B7.D0.BE.D0.BF.D0.B0.D1.81.D0.BD.D0.BE.D1.81.D1.82.D0.B8"></span><span class="mw-headline" id="Ограничение_версии_протокола_для_повышения_безопасности">Ограничение версии протокола для повышения безопасности</span>
</h4>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно:</strong> По умолчанию Samba версии 4.11 допускает соединение с использованием устаревшего и небезопасного протокола SMB1. Для этих версий Samba крайне рекомендуется задать опцию <code>server min protocol = SMB2_02</code> для защиты от ransomware атак. В Samba 4.11 и новее по умолчанию используется SMB2, так что изменения не требуются.</div>
<p>В файле <code>/etc/samba/smb.conf</code> добавьте опции <code>server min protocol</code> и <code>server max protocol</code> для ограничения используемых версий протокола:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/samba/smb.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[global]
  server min protocol = SMB2_02
  ; server max protocol = SMB3</pre>
<p>См. <code>server max protocol</code> в <span class="plainlinks archwiki-template-man" title="$ man 5 smb.conf"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/smb.conf.5">smb.conf(5)</a></span> для обзора поддерживаемых протоколов.
</p>
<p>Для совместимости со старыми клиентами и/или серверами вам может понадобиться указать <code>client min protocol = CORE</code> или <code>server min protocol = CORE</code>, но имейте в виду, что это делает вас уязвимым в связи с эксплойтами в SMB1, в том числе к ransomware атакам.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> Используйте <code>server min protocol = SMB3_00</code> если хотите использовать только самый новый протокол SMB3, например с клиентами на Windows 8 и новее.</div>
<p><a href="#%D0%A0%D1%83%D1%87%D0%BD%D0%BE%D0%B5_%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">Клиентам</a>, использующим <code>mount.cifs</code>, может понадобиться указать правильный <code>vers=*</code>, например:
</p>
<pre># mount -t cifs //<i>SERVER</i>/<i>имя-ресурса</i> /mnt/<i>точка-монтирования</i> -o username=<i>пользователь</i>,password=<i>пароль</i>,iocharset=<i>utf8</i>,vers=<i>3.1.1</i>
</pre>
<p>Подробнее см. <span class="plainlinks archwiki-template-man" title="$ man 8 mount.cifs"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mount.cifs.8">mount.cifs(8)</a></span>.
</p>
<h4>
<span id=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D1.88.D0.B8.D1.84.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F_SMB"></span><span class="mw-headline" id="Использование_шифрования_SMB">Использование шифрования SMB</span>
</h4>
<p>Нативное шифрование транспорта SMB доступно с версии SMB 3.0. Среди клиентов, поддерживающих такое шифрование, имеются Windows 8 и новее, Windows Server 2012 новее, smbclient в Samba 4.1 и новее.
</p>
<p>Для использования шифрования по умолчанию установите параметр <code>server smb encrypt</code> глобально или для отдельных ресурсов. Возможные значения — <code>off</code>, <code>enabled</code> (значение по умолчанию), <code>desired</code> или <code>required</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/samba/smb.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[global]
  server smb encrypt = desired</pre>
<p>Смотрите <span class="plainlinks archwiki-template-man" title="$ man 5 smb.conf"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/smb.conf.5">smb.conf(5)</a></span> для более подробной информации, особенно разделы <i>Effects for SMB1</i> и <i>Effects for SMB2</i>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> При <a href="#%D0%A0%D1%83%D1%87%D0%BD%D0%BE%D0%B5_%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">ручном монтировании</a> ресурса укажите опцию монтирования <code>seal</code> чтобы принудительно включить шифрование.</div>
<h4>
<span id=".D0.9E.D1.82.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BE.D0.B1.D1.89.D0.B5.D0.B3.D0.BE_.D0.B4.D0.BE.D1.81.D1.82.D1.83.D0.BF.D0.B0_.D0.BA_.D0.BF.D1.80.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D0.B0.D0.BC"></span><span class="mw-headline" id="Отключение_общего_доступа_к_принтерам">Отключение общего доступа к принтерам</span>
</h4>
<p>По умолчанию Samba предоставляет общий доступ к принтерам, настроенным через <a href="../ru/CUPS.html" title="CUPS (Русский)">CUPS</a>.
</p>
<p>Если вам это не нужно, используйте следующие опции для отключения:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/samba/smb.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[global]
  load printers = no
  printing = bsd
  printcap name = /dev/null
  disable spoolss = yes
  show add printer wizard = no</pre>
<h4>
<span id=".D0.97.D0.B0.D0.BF.D1.80.D0.B5.D1.82_.D0.BE.D0.BF.D1.80.D0.B5.D0.B4.D0.B5.D0.BB.D1.91.D0.BD.D0.BD.D1.8B.D1.85_.D1.80.D0.B0.D1.81.D1.88.D0.B8.D1.80.D0.B5.D0.BD.D0.B8.D0.B9_.D1.84.D0.B0.D0.B9.D0.BB.D0.BE.D0.B2_.D0.B2_.D0.BE.D0.B1.D1.89.D0.B5.D0.BC_.D1.80.D0.B5.D1.81.D1.83.D1.80.D1.81.D0.B5_Samba"></span><span class="mw-headline" id="Запрет_определённых_расширений_файлов_в_общем_ресурсе_Samba">Запрет определённых расширений файлов в общем ресурсе Samba</span>
</h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Использование этой опции влияет на производительность Samba, так как вынуждает проверять все файлы и каталоги на совпадение по мере их сканирования.</div>
<p>Samba предоставляет опцию для блокирования файлов по определённым паттернам, вроде расширений файлов. Её можно использовать для предотвращения распространения вирусов или для того, чтобы пользователи не тратили место на определённые файлы. Более подробную информацию можно найти в <span class="plainlinks archwiki-template-man" title="$ man 5 smb.conf"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/smb.conf.5">smb.conf(5)</a></span>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/samba/smb.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
[myshare]
  comment = Private
  path = /mnt/data
  read only = no
  veto files = /*.exe/*.com/*.dll/*.bat/*.vbs/*.tmp/*.mp3/*.avi/*.mp4/*.wmv/*.wma/</pre>
<h4>
<span id=".D0.A3.D0.B2.D0.B5.D0.BB.D0.B8.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.BF.D1.83.D1.81.D0.BA.D0.BD.D0.BE.D0.B9_.D1.81.D0.BF.D0.BE.D1.81.D0.BE.D0.B1.D0.BD.D0.BE.D1.81.D1.82.D0.B8"></span><span class="mw-headline" id="Увеличение_пропускной_способности">Увеличение пропускной способности</span>
</h4>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно:</strong> Помните, что это может привести к проблемам с подключением и потенциально сломать ваш стек TCP/IP.</div>
<p>Большинству пользователей подойдут настройки по умолчанию. Однако корректное использование 'socket options' может улучшить производительность, но ошибки в настройке также могут и ухудшить её. Проверяйте эффекты, прежде чем вносить какие-либо серьезные изменения.
</p>
<p>Читайте <span class="plainlinks archwiki-template-man" title="$ man 5 smb.conf"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/smb.conf.5">smb.conf(5)</a></span> прежде чем применять описанные здесь опции.
</p>
<p>Эти опции прописываются в файле <code>/etc/samba/smb.conf</code> в секции <code>[global]</code>.
</p>
<p>SMB3 multi-channel может улучшить производительности, однако иногда может испортить данные из-за race conditions. В будущих версиях ситуация может улучшиться:
</p>
<pre>server multi channel support = yes
</pre>
<p>Ограничение времени бездействия полезно для предотвращения исчерпания ресурсов сервера из-за большого количества неактивных подключений:
</p>
<pre>deadtime = 30
</pre>
<p>Использование sendfile улучшает эффективность использования процессора и повышает скорость Samba:
</p>
<pre>use sendfile = yes
</pre>
<p>Установка min receivefile size разрешает zero-copy запись непосредственно из буфера сокета в кэш файловой системы (если доступен). Это может улучшить производительность, но требует тестирования:
</p>
<pre>min receivefile size = 16384
</pre>
<p>Асинхронное чтение/запись файлов может повысить производительность:
</p>
<pre>aio read size = 1
aio write size = 1
</pre>
<p>Увеличение размера буферов приёма/отправки и флаги оптимизации сокетов могут быть полезны для улучшения производительности. Рекомендуется протестировать каждый флаг отдельно, так как они могут вызывать проблемы в некоторых сетях:
</p>
<pre>socket options = IPTOS_LOWDELAY TCP_NODELAY IPTOS_THROUGHPUT SO_RCVBUF=131072 SO_SNDBUF=131072
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Для некоторых опций может понадобиться изменить настройки сетевого интерфейса, см. <a href="../en/Sysctl.html#Networking" title="Sysctl">Sysctl#Networking</a>.</div>
<h4>
<span id=".D0.92.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B4.D0.BE.D1.81.D1.82.D1.83.D0.BF.D0.B0_.D0.B4.D0.BB.D1.8F_.D1.81.D1.82.D0.B0.D1.80.D1.8B.D1.85_.D0.BA.D0.BB.D0.B8.D0.B5.D0.BD.D1.82.D0.BE.D0.B2_.D0.B8.D0.BB.D0.B8_.D1.83.D1.81.D1.82.D1.80.D0.BE.D0.B9.D1.81.D1.82.D0.B2"></span><span class="mw-headline" id="Включение_доступа_для_старых_клиентов_или_устройств">Включение доступа для старых клиентов или устройств</span>
</h4>
<p>Последние версии Samba больше не предлагают старые методы аутентификации и протоколы, которые всё ещё используются некоторыми старыми клиентами (IP-камерами и т.д.). Такие устройства обычно требуют от сервера разрешения аутентификации NTLMv1 и протокола NT1, известного как CIFS. Чтобы эти устройства работали с последней версией Samba, добавьте эти два параметра в секцию <code>[global]</code>:
</p>
<pre>server min protocol = NT1
ntlm auth = yes
</pre>
<p>Для анонимного/гостевого доступа достаточно лишь первого параметра. Если старое устройство использует имя и пароль для доступа, то нужен и второй параметр тоже.
</p>
<h4>
<span id=".D0.92.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D0.BE.D0.B8.D1.81.D0.BA.D0.B0_Spotlight"></span><span class="mw-headline" id="Включение_поиска_Spotlight">Включение поиска Spotlight</span>
</h4>
<p>Spotlight позволяет поддерживающим его клиентам (например, MacOS Finder) быстро искать общие файлы.
</p>
<p>Установите и запустите <a href="../en/OpenSearch.html" title="OpenSearch">OpenSearch</a>. Установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/fs2es-indexer/">fs2es-indexer</a></span><sup><small>AUR</small></sup>, настройте каталоги, которые вы хотите индексировать, в <code>/etc/fs2es-indexer/config.yml</code>, и запустите/включите <code>fs2es-indexer.service</code> для периодического индексирования.
</p>
<p>Измените <code>smb.conf</code> как описано в <a rel="nofollow" class="external text" href="https://wiki.samba.org/index.php/Spotlight_with_Elasticsearch_Backend#Samba">Samba wiki</a> и перезапустите <code>smb.service</code> для применения изменений.
</p>
<h2>
<span id=".D0.9A.D0.BB.D0.B8.D0.B5.D0.BD.D1.82"></span><span class="mw-headline" id="Клиент">Клиент</span>
</h2>
<p><a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установите">Установите</a> пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=smbclient">smbclient</a></span>, который предоставляет ftp-подобный интерфейс командной строки. Часто используемые команды описаны в <span class="plainlinks archwiki-template-man" title="$ man 1 smbclient"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/smbclient.1">smbclient(1)</a></span>.
</p>
<p>В качестве легковесной альтернативы (без возможности посмотреть список общих ресурсов и т.д.) можно использовать <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=cifs-utils">cifs-utils</a></span>, который предоставляет команду <code>/usr/bin/mount.cifs</code>.
</p>
<p>Некоторые <a href="../ru/Desktop_environment.html" title="Desktop environment (Русский)">среды рабочего стола</a> также имеют графический интерфейс для доступа к общим ресурсам и управления ими (смотрите <a href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2%D0%BE%D0%B3%D0%BE_%D0%BC%D0%B5%D0%BD%D0%B5%D0%B4%D0%B6%D0%B5%D1%80%D0%B0">#Настройка файлового менеджера</a>).
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> 
<ul>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=smbclient">smbclient</a></span> требует наличия файла <code>/etc/samba/smb.conf</code> (смотрите раздел <a href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0">#Установка</a>); можно просто создать пустой файл командой <code>touch</code>.</li>
<li>После установки <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=cifs-utils">cifs-utils</a></span> или <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=smbclient">smbclient</a></span> загрузите <a href="../ru/Kernel_module.html" class="mw-redirect" title="Модуль ядра">модуль ядра</a> <code>cifs</code> или перезагрузитесь, чтобы не возникало ошибок монтирования.</li>
</ul>
</div>
<h3>
<span id=".D0.9F.D1.80.D0.BE.D1.81.D0.BC.D0.BE.D1.82.D1.80_.D0.BF.D1.83.D0.B1.D0.BB.D0.B8.D1.87.D0.BD.D1.8B.D1.85_.D1.80.D0.B5.D1.81.D1.83.D1.80.D1.81.D0.BE.D0.B2_.D0.B4.D0.BB.D1.8F_.D0.BE.D0.B1.D1.89.D0.B5.D0.B3.D0.BE_.D0.B4.D0.BE.D1.81.D1.82.D1.83.D0.BF.D0.B0"></span><span class="mw-headline" id="Просмотр_публичных_ресурсов_для_общего_доступа">Просмотр публичных ресурсов для общего доступа</span>
</h3>
<p>Чтобы вывести список общедоступных ресурсов на сервере:
</p>
<pre>$ smbclient -L <i>hostname</i> -U%
</pre>
<p>Также можно использовать команду <code>$ smbtree -N</code>, которая покажет древовидную диаграмму всех общих ресурсов. Она использует широковещательные (broadcast) запросы и потому не рекомендуется для использования в сетях с большим числом компьютеров, но может быть полезна для проверки правильности имён общих ресурсов. Опция <code>-N</code> (<code>-no-pass</code>) отключает запрос пароля.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> <code>smbtree</code> использует SMB1 и NetBIOS, что означает, что они должны быть включены на стороне сервера, а на стороне клиента нужно добавить <code>client min protocol = NT1</code> в <code>smb.conf</code>. Без этого <code>smbtree</code> ничего не выведет.</div>
<h3>
<span id=".D0.98.D0.BC.D0.B5.D0.BD.D0.B0_.D1.85.D0.BE.D1.81.D1.82.D0.BE.D0.B2_NetBIOS.2FWINS"></span><span class="mw-headline" id="Имена_хостов_NetBIOS/WINS">Имена хостов NetBIOS/WINS</span>
</h3>
<p>Клиенты Samba обрабатывают имена хостов NetBIOS автоматически по умолчанию (поведение регулируется опцией <code>name resolve order</code> в <code>smb.conf</code>). Другие программы (в том числе <code>mount.cifs</code>) используют <a href="../ru/Domain_name_resolution.html#Name_Service_Switch" title="Domain name resolution (Русский)">Name Service Switch</a>, который не использует NetBIOS по умолчанию.
</p>
<p>Пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=smbclient">smbclient</a></span> предоставляет драйвер libnss для разрешения имён NetBIOS. Для его использования <a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установите">установите</a> его вместе с пакетом <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=samba">samba</a></span> (который предоставляет демон <i>winbindd</i>), <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Запустите">запустите</a> и <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Включите">включите</a> службу <code>winbind.service</code> и добавьте <code>wins</code> в строку <code>hosts</code> в файле <span class="plainlinks archwiki-template-man" title="$ man 5 nsswitch.conf"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/nsswitch.conf.5">nsswitch.conf(5)</a></span>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/nsswitch.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
hosts: mymachines resolve [!UNAVAIL=return] files myhostname dns <b>wins</b>
...</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Из-за текущей ошибки в <code>winbind.service</code> вам нужно вручную изменить файл юнита как описано в <a rel="nofollow" class="external text" href="https://bugs.launchpad.net/ubuntu/+source/samba/+bug/1789097">этом баг-репорте</a>
</div>
<p>Теперь в процессе разрешения имён (например, при использовании <code>mount.cifs</code> или просто <code>ping <i>имя-netbios</i></code>) демон <i>winbindd</i> будет отправлять запросы с использованием протокола NetBIOS Name Service (NBNS, также известен как WINS).
</p>
<p>По умолчанию он отправляет широковещательный (broadcast) запрос в локальную сеть. Если у вас есть WINS-сервер, вы можете добавить <code>wins server = <i>ip-сервера-wins</i></code> в <code>smb.conf</code> и <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Перезапустить">перезапустить</a> <code>winbind.service</code>, тогда <i>winbindd</i> и другие клиенты Samba станут отправлять unicast-запросы на указанный IP.
</p>
<p>Если вы хотите, чтобы разрешение имени локального компьютера (которое указывается в опции <code>netbios name</code> в <code>smb.conf</code>) тоже работало, <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Запустите">запустите</a> и <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Включите">включите</a> службу <code>nmb.service</code>, которая будет обрабатывать входящие запросы.
</p>
<p>Вы можете протестировать разрешение WINS с помощью <code>nmblookup</code>. По умолчанию он отправляет широковещательные запросы в вашу локальную сеть независимо от значения опции <code>wins server</code>.
</p>
<p>Имейте в виду, что WINS использует трафик, приходящий из порта 137.
</p>
<h4>
<span id=".D0.9E.D1.82.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D0.BE.D0.B4.D0.B4.D0.B5.D1.80.D0.B6.D0.BA.D0.B8_NetBIOS.2FWINS"></span><span class="mw-headline" id="Отключение_поддержки_NetBIOS/WINS">Отключение поддержки NetBIOS/WINS</span>
</h4>
<p>Если разрешение имён хостов NetBIOS/WINS не используется, может быть предпочтительно отключение этого протокола:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/samba/smb.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[global]
  disable netbios = yes
  dns proxy = no</pre>
<p>Затем <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Отключите">отключите</a>/<a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Остановите">остановите</a> <code>winbind.service</code>.
</p>
<h3>
<span id=".D0.A0.D1.83.D1.87.D0.BD.D0.BE.D0.B5_.D0.BC.D0.BE.D0.BD.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Ручное_монтирование">Ручное монтирование</span>
</h3>
<p>Создайте точку монтирования для ресурса:
</p>
<pre># mkdir /mnt/<i>точка_монтирования</i>
</pre>
<p>Примонтируйте ресурс, в качестве <code>type</code> указав <code>mount.cifs</code>. Не все опции из перечисленных ниже необходимы или желательны:
</p>
<pre># mount -t cifs //<i>СЕРВЕР</i>/<i>имя_ресурса</i> /mnt/<i>точка_монтирования</i> -o username=<i>имя_пользователя</i>,password=<i>пароль</i>,workgroup=<i>рабочая_группа</i>,iocharset=<i>utf8</i>,uid=<i>пользователь</i>,gid=<i>группа</i>
</pre>
<p>Опции <code>uid</code> и <code>gid</code> соответствуют локальному (клиентскому) пользователю/группе, которые получат доступ на чтение и запись по указанному пути.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> 
<ul>
<li>Если используемые <code>uid</code> и <code>gid</code> не соответствуют пользователю на сервере, могут помочь опции <code>forceuid</code> и <code>forcegid</code>. Но имейте в виду, что тогда права доступа, отображаемые на клиенте, могут не соответствовать реальным правам доступа на сервере. Подробности смотрите в разделе <i>File And Directory Ownership And Permissions</i> в <span class="plainlinks archwiki-template-man" title="$ man 8 mount.cifs"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mount.cifs.8#FILE_AND_DIRECTORY_OWNERSHIP_AND_PERMISSIONS">mount.cifs(8) § FILE AND DIRECTORY OWNERSHIP AND PERMISSIONS</a></span>.</li>
<li>Для подключения общего ресурса Windows без аутентификации укажите <code>"username=*"</code>.</li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно:</strong> Использование <code>uid</code> и/или <code>gid</code> может приводить к ошибкам ввода-вывода; вместо этого рекомендуется установить/проверить корректность <a href="../ru/File_permissions_and_attributes.html" title="File permissions and attributes (Русский)">разрешений и атрибутов файлов</a>.</div>
<ul>
<li>
<code><i>СЕРВЕР</i></code> — Имя сервера.</li>
<li>
<code><i>имя_ресурса</i></code> — Название каталога с общим доступом.</li>
<li>
<code><i>точка_монтирования</i></code> — Локальный каталог, в который будет примонтирован ресурс.</li>
<li>
<code>[-o <i>опции</i>]</code> — Смотрите страницу руководства <span class="plainlinks archwiki-template-man" title="$ man 8 mount.cifs"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mount.cifs.8">mount.cifs(8)</a></span> для получения информации.</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> 
<ul>
<li>Не используйте слэш <code>/</code> в конце пути. <code>//<i>СЕРВЕР</i>/<i>имя_ресурса</i><b>/</b></code> не будет работать.</li>
<li>Если примонтированный вами ресурс работает нестабильно или зависает (freeze), попробуйте включить другую версию протокола SMB, используя опцию <code>vers=</code>. Например, <code>vers=2.0</code> для Windows Vista.</li>
<li>Если при завершении работы системы на примонтированных ресурсах происходят таймауты, смотрите <a href="../en/Wpa_supplicant.html#Problem_with_mounted_network_shares_(cifs)_and_shutdown" title="Wpa supplicant">wpa_supplicant#Problem with mounted network shares (cifs) and shutdown</a>.</li>
</ul>
</div>
<h4>
<span id=".D0.A5.D1.80.D0.B0.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D0.B0.D1.80.D0.BE.D0.BB.D1.8F_.D0.BE.D1.82_.D0.BE.D0.B1.D1.89.D0.B8.D1.85_.D1.80.D0.B5.D1.81.D1.83.D1.80.D1.81.D0.BE.D0.B2"></span><span class="mw-headline" id="Хранение_пароля_от_общих_ресурсов">Хранение пароля от общих ресурсов</span>
</h4>
<p>Хранение паролей в доступном для чтения файле не рекомендуется. Более безопасным методом является использование файла, например, внутри <code>/etc/samba/credentials</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/samba/credentials/share</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">username=<i>имя_пользователя</i>
password=<i>пароль</i></pre>
<p>В команде mount замените опции <code>username=myuser,password=mypass</code> на <code>credentials=/etc/samba/credentials/share</code>.
</p>
<p>Для безопасности этот файл должен быть доступен только для root:
</p>
<pre># chown root:root /etc/samba/credentials
# chmod 700 /etc/samba/credentials
# chmod 600 /etc/samba/credentials/share
</pre>
<h3>
<span id=".D0.90.D0.B2.D1.82.D0.BE.D0.BC.D0.B0.D1.82.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.BE.D0.B5_.D0.BC.D0.BE.D0.BD.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Автоматическое_монтирование">Автоматическое монтирование</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Вам может понадобиться <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Включить">включить</a> службу <code>systemd-networkd-wait-online.service</code> или <code>NetworkManager-wait-online.service</code> (зависит от вашей установки) для корректного запуска системы.</div>
<h4>
<span id=".D0.A1_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5.D0.BC_NetworkManager_.D0.B8_GIO.2Fgvfs"></span><span class="mw-headline" id="С_использованием_NetworkManager_и_GIO/gvfs">С использованием NetworkManager и GIO/gvfs</span>
</h4>
<p><a href="../en/NetworkManager.html#Network_services_with_NetworkManager_dispatcher" title="NetworkManager">NetworkManager</a> может быть настроен на запуск скриптов при изменении состояния сети. Приведённый ниже скрипт использует команду <i>gio</i>, чтобы автоматически монтировать общие ресурсы Samba аналогично тому, как делает ваш файловый менеджер, как описано <a href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2%D0%BE%D0%B3%D0%BE_%D0%BC%D0%B5%D0%BD%D0%B5%D0%B4%D0%B6%D0%B5%D1%80%D0%B0">ниже</a>. Скрипт также безопасно размонтирует их перед отключением сети путём отслеживания событий <code>pre-down</code> и <code>vpn-pre-down</code>. Сделайте скрипт <a href="../ru/Help:Reading.html#%D0%A1%D0%B4%D0%B5%D0%BB%D0%B0%D1%82%D1%8C_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D0%BD%D1%8F%D0%B5%D0%BC%D1%8B%D0%BC" class="mw-redirect" title="Исполняемым">исполняемым</a> после создания.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/NetworkManager/dispatcher.d/30-samba.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh

# Найдите UUID нужного соединения с помощью команды «nmcli con show».
# Поддерживаются все типы соединений NetworkManager: беспроводные, VPN, проводные...
WANTED_CON_UUID="CHANGE-ME-NOW-9c7eff15-010a-4b1c-a786-9b4efa218ba9"

# Пользователь, под которым будет примонтирован общий ресурс
USER="yourusername"
# Путь, который отображается в вашем файловом менеджере, когда вы вручную монтируете нужный общий ресурс
SMB_URL="smb://servername/share"

# Получаем runtime-каталог пользователя. Если его нет, то просто выходим
XDG_RUNTIME_DIR=$(loginctl show-user --property=RuntimePath --value "$USER") || exit 0

if [ "$CONNECTION_UUID" = "$WANTED_CON_UUID" ]; then
    
    # Параметр скрипта $1: название сетевого интерфейса, не используется
    # Параметр скрипта $2: отправленное событие
    
    case "$2" in
        "up")
            su $USER -c "DBUS_SESSION_BUS_ADDRESS=unix:path=$XDG_RUNTIME_DIR/bus gio mount $SMB_URL"
            ;;
        "pre-down"|"vpn-pre-down")
            su $USER -c "DBUS_SESSION_BUS_ADDRESS=unix:path=$XDG_RUNTIME_DIR/bus gio mount -uf $SMB_URL"
            ;;
    esac
fi
</pre>
<p>Создайте символическую ссылку в каталоге <code>/etc/NetworkManager/dispatcher.d/pre-down</code>, чтобы скрипт получал события <code>pre-down</code>:
</p>
<pre># ln -s /etc/NetworkManager/dispatcher.d/30-samba.sh /etc/NetworkManager/dispatcher.d/pre-down.d/30-samba.sh
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Так как этот скрипт использует пользовательскую шину, он будет работать, только если у указанного пользователя есть активные сеансы. Это означает, что ресурс не будет примонтирован автоматически после загрузки, если соединение с сетью было установлено до того, как вы залогинились.</div>
<h4>
<span id=".D0.A1_.D0.BF.D0.BE.D0.BC.D0.BE.D1.89.D1.8C.D1.8E_.D0.B7.D0.B0.D0.BF.D0.B8.D1.81.D0.B8_.D0.B2_fstab"></span><span class="mw-headline" id="С_помощью_записи_в_fstab">С помощью записи в fstab</span>
</h4>
<p>Простой пример <code>cifs</code> <a href="../ru/Fstab.html" title="Fstab (Русский)">записи в fstab</a> с аутентификацией:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/fstab</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">//<i>СЕРВЕР</i>/<i>имя_ресурса</i> /mnt/<i>точка_монтирования</i> cifs _netdev,nofail,username=<i>имя_пользователя</i>,password=<i>пароль</i> 0 0</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> 
<ul>
<li>Пробелы в именах ресурсов должны быть заменены на <code>\040</code> (восьмеричный ASCII-код для пробелов). Например, <code>//<i>СЕРВЕР</i>/имя ресурса</code> должно быть заменено на <code>//<i>СЕРВЕР</i>/имя\040ресурса</code> в <code>/etc/fstab</code>.</li>
<li>Чтобы разрешить монтирование простым пользователям без прав root, когда точка монтирования находится в доступном пользователю каталоге (например, домашнем), добавьте опцию <code>users</code> (обязательно с <b>s</b> на конце).</li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> Используйте <code>x-systemd.automount</code>, если вы хотите монтировать ресурс только при обращении. Подробнее смотрите <a href="../ru/Fstab.html#%D0%90%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B5_%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%81_systemd" title="Fstab (Русский)">Fstab (Русский)#Автоматическое монтирование с systemd</a>.</div>
<h4>
<span id=".D0.A1_.D0.BF.D0.BE.D0.BC.D0.BE.D1.89.D1.8C.D1.8E_.D1.8E.D0.BD.D0.B8.D1.82.D0.B0_systemd"></span><span class="mw-headline" id="С_помощью_юнита_systemd">С помощью юнита systemd</span>
</h4>
<p>Создайте новый файл <code>.mount</code> в каталоге <code>/etc/systemd/system</code>, например <code>mnt-myshare.mount</code>. Смотрите <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.mount"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.mount.5">systemd.mount(5)</a></span> для более подробной информации.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Имя создаваемого файла должно соответствовать точке монтирования, которую вы хотите использовать. Например, имя <code>mnt-myshare.mount</code> должно использоваться для точки монтирования <code>/mnt/myshare</code>. В противном случае вы получите ошибку <code>systemd[1]: mnt-myshare.mount: Where= setting does not match unit name. Refusing.</code>.</div>
<p><code>What=</code> путь к общему ресурсу
</p>
<p><code>Where=</code> путь, куда он будет примонтирован
</p>
<p><code>Options=</code> опции монтирования
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> 
<ul>
<li>К сетевым точкам монтирования автоматически добавляются <code>After</code>-зависимости <code>remote-fs-pre.target</code>, <code>network.target</code> и <code>network-online.target</code>, а также <code>Before</code>-зависимость <code>remote-fs.target</code>, если не указана опция <code>nofail</code>; иначе используется <code>Wants</code>.</li>
<li>
<a href="../ru/Help:Reading.html#%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C,_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D1%82%D1%8C,_%D1%80%D0%B5%D0%B4%D0%B0%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D1%82%D1%8C" class="mw-redirect" title="Добавьте">Добавьте</a> <code>noauto</code> в <code>Options</code> для отключения автоматического монтирования (если его не будет монтировать какой-нибудь другой юнит).</li>
<li>Если в качестве адреса сервера вы хотите использовать имя хоста вместо IP-адреса, добавьте <code>nss-lookup.target</code> в <code>After</code>. Это может предотвратить ошибки монтироваия при загрузке.</li>
</ul>
</div>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/mnt-myshare.mount</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Mount Share at boot

[Mount]
What=//server/share
Where=/mnt/myshare
Options=_netdev,credentials=/etc/samba/credentials/myshare,iocharset=utf8,rw
Type=cifs
TimeoutSec=30

[Install]
WantedBy=multi-user.target</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> 
<ul>
<li>На случай, если удалённая система станет недоступна, <a href="../ru/Help:Reading.html#%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C,_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D1%82%D1%8C,_%D1%80%D0%B5%D0%B4%D0%B0%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D1%82%D1%8C" class="mw-redirect" title="Добавьте">добавьте</a> <code>ForceUnmount=true</code> в секцию <code>[Mount]</code>, чтобы разрешить принудительное размонтирование.</li>
<li>Если общий ресурс имеет группы с доступом только для чтения, <a href="../ru/Help:Reading.html#%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C,_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D1%82%D1%8C,_%D1%80%D0%B5%D0%B4%D0%B0%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D1%82%D1%8C" class="mw-redirect" title="Добавьте">добавьте</a> <code>uid=<i>пользователь</i></code> или <code>gid=<i>группа</i></code> в <code>Options=</code>, чтобы указать пользователя/группу, которые имеют право на запись.</li>
</ul>
</div>
<p>Для использования <code>mnt-myshare.mount</code> <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Запустите">запустите</a> этот юнит и <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Включите">включите</a> его для автоматического монтирования при загрузке системы.
</p>
<h5>
<span id=".D0.90.D0.B2.D1.82.D0.BE.D0.BC.D0.BE.D0.BD.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Автомонтирование">Автомонтирование</span>
</h5>
<p>Для автоматического монтирования ресурса (при обращении к нему, как autofs) можно использовать следующий блок automount:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/mnt-myshare.automount</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Automount myshare

[Automount]
Where=/mnt/myshare

[Install]
WantedBy=multi-user.target</pre>
<p><a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Остановите">Остановите</a> и <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Отключите">отключите</a> юнит <code>mnt-myshare.mount</code>, а вместо него <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Запустите">запустите</a> и <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Включите">включите</a> юнит <code>mnt-myshare.automount</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> <a href="../ru/Help:Reading.html#%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%B8%D1%82%D1%8C,_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D1%82%D1%8C,_%D1%80%D0%B5%D0%B4%D0%B0%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D1%82%D1%8C" class="mw-redirect" title="Добавьте">Добавьте</a> <code>TimeoutIdleSec</code> для включения автоматического размонтирования при бездействии. Подробнее смотрите <span class="plainlinks archwiki-template-man" title="$ man 5 systemd.automount"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd.automount.5">systemd.automount(5)</a></span>.</div>
<h4><span class="mw-headline" id="smbnetfs">smbnetfs</span></h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> для smbnetfs необходима целая (нетронутая?) (intact) установка сервера Samba. Смотрите выше, как это сделать</div>
<p>Для начала удостоверьтесь, что вам доступны все ресурсы, которые вам нужны для монтирования:
</p>
<pre>$ smbtree -U <i>удаленный_пользователь</i>
</pre>
<p>Если это не работает, найдите и измените следующую строку в <code>/etc/samba/smb.conf</code> подобным образом:
</p>
<pre>domain master = auto
</pre>
<p>Затем <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Перезапустите">перезапустите</a> <code>smb.service</code> и <code>nmb.service</code>.
</p>
<p>Если всё работает как нужно, <a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установите">установите</a> пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=smbnetfs">smbnetfs</a></span>.
</p>
<p>Затем добавьте следующую строку в файл <code>/etc/fuse.conf</code>:
</p>
<pre>user_allow_other
</pre>
<p>Скопируйте каталог <code>/etc/smbnetfs/.smb</code> в вашу домашнюю директорию:
</p>
<pre>$ cp -a /etc/smbnetfs/.smb ~
</pre>
<p>Затем создайте ссылку на файл <code>smb.conf</code>:
</p>
<pre>$ ln -sf /etc/samba/smb.conf ~/.smb/smb.conf
</pre>
<p>Если для доступа к каким-либо общим ресурсам нужен пароль, измените файл <code>~/.smb/smbnetfs.auth</code>, прописав в нём пароли для определённых хостов примерно так:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.smb/smbnetfs.auth</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">auth			"хост" "пользователь" "пароль"
</pre>
<p>Также можно добавить записи для определённых хостов, которые будут монтироваться smbnetfs, если это необходимо. Более подробную информацию можно найти в <code>~/.smb/smbnetfs.conf</code>.
</p>
<p>Если вы используете <a href="../en/Dolphin.html" title="Dolphin">Dolphin</a> или <a href="../en/GNOME/Files.html" class="mw-redirect" title="GNOME Files">GNOME Files</a>, можно добавить следующую опцию <code>~/.smb/smbnetfs.conf</code>, чтобы избежать предупреждений о переполненном диске, так как smbnetfs по умолчанию сообщает, что свободно 0 байт:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.smb/smbnetfs.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">free_space_size 1073741824
</pre>
<p>Когда вы закончите настройку, необходимо выполнить
</p>
<pre>$ chmod 600 ~/.smb/smbnetfs.*
</pre>
<p>В противном случае smbnetfs пожалуется: 'insecure config file permissions'.
</p>
<p>Наконец, чтобы примонтировать сетевое окружение Samba в каталог по вашему выбору, выполните
</p>
<pre>$ smbnetfs <i>точка_монтирования</i>
</pre>
<h5>
<span id=".D0.94.D0.B5.D0.BC.D0.BE.D0.BD"></span><span class="mw-headline" id="Демон">Демон</span>
</h5>
<p>Пакет в Arch Linux также поддерживает дополнительный "общесистемный" режим для smbnetfs. Чтобы его включить, вам необходимо выполнить указанные изменения в каталоге <code>/etc/smbnetfs/.smb</code>.
</p>
<p>Затем вы можете запустить и/или включить в автозагрузку <a href="../ru/Daemons.html" class="mw-redirect" title="Daemon (Русский)">демон</a> <code>smbnetfs</code> обычным способом. Общесистемной точкой монтирования является <code>/mnt/smbnet/</code>.
</p>
<h4><span class="mw-headline" id="autofs">autofs</span></h4>
<p>Смотрите статью <a href="../ru/Autofs.html" title="Autofs (Русский)">Autofs</a> для получения информации об автомонтировщике ядра (kernel-based) Linux.
</p>
<h3>
<span id=".D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_.D1.84.D0.B0.D0.B9.D0.BB.D0.BE.D0.B2.D0.BE.D0.B3.D0.BE_.D0.BC.D0.B5.D0.BD.D0.B5.D0.B4.D0.B6.D0.B5.D1.80.D0.B0"></span><span class="mw-headline" id="Настройка_файлового_менеджера">Настройка файлового менеджера</span>
</h3>
<h4>
<span id="GNOME_Files.2C_Nemo.2C_Caja.2C_Thunar_.D0.B8_PCManFM"></span><span class="mw-headline" id="GNOME_Files,_Nemo,_Caja,_Thunar_и_PCManFM">GNOME Files, Nemo, Caja, Thunar и PCManFM</span>
</h4>
<p>Чтобы получить доступ к ресурсам samba через GNOME Files, Nemo, Caja, Thunar или PCManFM, установите пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gvfs-smb">gvfs-smb</a></span>, доступный в <a href="../ru/Official_repositories.html" title="Official repositories (Русский)">официальных репозиториях</a>.
</p>
<p>Нажмите <code>Ctrl+l</code> и введите <code>smb://<i>имя_сервера</i>/<i>ресурс</i></code> в панель адреса, чтобы получить доступ к ресурсу.
</p>
<p>Примонтированный ресурс, вероятно, будет представлен в файловой системе по пути <code>/run/user/<i>ваш_UID</i>/gvfs</code> или <code>~/.gvfs</code>.
</p>
<h4><span class="mw-headline" id="KDE">KDE</span></h4>
<p>Приложения KDE (например, Dolphin) имеют встроенную возможность просмотра ресурсов Samba, в этом случае нет необходимости в дополнительных пакетах. Используйте адрес <code>smb://<i>имя_сервера</i>/<i>имя_ресурса</i></code> для подключения и просмотра файлов. Для доступа к файлам из приложений, не являющихся частью KDE, можно установить <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kio-fuse">kio-fuse</a></span>.
</p>
<p>Графический интерфейс настроек предоставляется пакетом <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kdenetwork-filesharing">kdenetwork-filesharing</a></span>.
</p>
<h4>
<span id=".D0.94.D1.80.D1.83.D0.B3.D0.B8.D0.B5_.D0.B3.D1.80.D0.B0.D1.84.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B8.D0.B5_.D0.BE.D0.BA.D1.80.D1.83.D0.B6.D0.B5.D0.BD.D0.B8.D1.8F"></span><span class="mw-headline" id="Другие_графические_окружения">Другие графические окружения</span>
</h4>
<p>Есть несколько полезных программ, но им могут требоваться пакеты, созданные для них. Это может быть сделано с помощью Arch package build system. Хорошая новость заключается в том, что они не нуждаются в особом окружении, устанавливаемом для их поддержки, так что они "тянут" за собой меньше пакетов.
</p>
<ul>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pyneighborhood/">pyneighborhood</a></span><sup><small>AUR</small></sup> доступен <a href="../ru/Arch_User_Repository.html" title="Arch User Repository (Русский)">AUR</a>.</li>
<li>Плагины LinNeighborhood, RUmba, xffm-samba для Xffm недоступен в официальных репозиториях или в <a href="../ru/Arch_User_Repository.html" title="Arch User Repository (Русский)">AUR</a>. Поскольку они не поддерживаются официально (или поддерживаются, но неофициально), они могут быть устаревшими и не работать в полной мере</li>
</ul>
<h2>
<span id=".D0.A1.D0.BE.D0.B2.D0.B5.D1.82.D1.8B_.D0.B8_.D1.80.D0.B5.D0.BA.D0.BE.D0.BC.D0.B5.D0.BD.D0.B4.D0.B0.D1.86.D0.B8.D0.B8"></span><span class="mw-headline" id="Советы_и_рекомендации">Советы и рекомендации</span>
</h2>
<h3>
<span id=".D0.9E.D0.B1.D0.BD.D0.B0.D1.80.D1.83.D0.B6.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BE.D0.B1.D1.89.D0.B8.D1.85_.D1.81.D0.B5.D1.82.D0.B5.D0.B2.D1.8B.D1.85_.D1.80.D0.B5.D1.81.D1.83.D1.80.D1.81.D0.BE.D0.B2"></span><span class="mw-headline" id="Обнаружение_общих_сетевых_ресурсов">Обнаружение общих сетевых ресурсов</span>
</h3>
<p>Если о других системах в локальной сети ничего не известно, а инструменты вроде <a href="#smbnetfs">smbnetfs</a> не подходят, можно попробовать поискать ресурсы Samba вручную.
</p>
<p>Сперва <a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установите">установите</a> пакеты <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nmap">nmap</a></span> и <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=smbclient">smbclient</a></span>.
</p>
<p>Используйте <a href="../en/Nmap.html" title="Nmap">nmap</a> для сканирования локальной сети и поиска систем с открытым TCP-портом 445, который используется протоколом SMB. Имейте в виду, что вам может понадобиться использовать опцию <code>-Pn</code> или задать другой <a href="../en/Nmap.html#Ping_scan_types" title="Nmap">тип пинг-сканирования</a>, так как Windows-системы обычно защищены межсетевым экраном.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ nmap -p 445 "192.168.1.*"</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-13 12:00 UTC
Nmap scan report for 192.168.1.1
Host is up (0.0011s latency).

PORT    STATE  SERVICE
445/tcp open  microsoft-ds

Nmap scan report for 192.168.1.2
Host is up (0.00011s latency).

PORT    STATE SERVICE
445/tcp open  microsoft-ds

Nmap done: 256 IP addresses (2 hosts up) scanned in 2.45 seconds
</pre>
<p>Первый результат — другая система; второй — клиент, с которого было выполнено сканирование.
</p>
<p>Теперь можно подключиться к этим IP-адресам напрямую, но если вы хотите использовать имена хостов NetBIOS, можно использовать <span class="plainlinks archwiki-template-man" title="$ man 1 nmblookup"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/nmblookup.1">nmblookup(1)</a></span>, чтобы узнать имена NetBIOS. Имейте в виду, что это не будет работать, если NetBIOS отключен на стороне сервера.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ nmblookup -A 192.168.1.1</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Looking up status of 192.168.1.1
        PUTER           &lt;00&gt; -         B &lt;ACTIVE&gt;
        HOMENET         &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;
        PUTER           &lt;03&gt; -         B &lt;ACTIVE&gt;
        <b>PUTER           &lt;20&gt; -         B &lt;ACTIVE&gt;</b>
        HOMENET         &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;
        USERNAME        &lt;03&gt; -         B &lt;ACTIVE&gt;
        HOMENET         &lt;1d&gt; -         B &lt;ACTIVE&gt;
        MSBROWSE        &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;
</pre>
<p>Независимо от вывода, смотрите на <b>&lt;20&gt;</b>, который обозначает хост с открытыми сервисами.
</p>
<p>С помощью <span class="plainlinks archwiki-template-man" title="$ man 1 smbclient"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/smbclient.1">smbclient(1)</a></span> чтобы посмотреть список доступных ресурсов на сервере. Вместо IP-адреса можно использовать NetBIOS-имя (<code>PUTER</code> в данном примере), если оно доступно. Если будет запрошен пароль, можно просто нажать Enter — список общих ресурсов всё равно отобразится:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ smbclient -L \\192.168.1.1</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Sharename       Type      Comment
---------       ----      -------
MY_MUSIC        Disk
SHAREDDOCS      Disk
PRINTER$        Disk
PRINTER         Printer
IPC$            IPC       Remote Inter Process Communication

Server               Comment
---------            -------
PUTER

Workgroup            Master
---------            -------
HOMENET               PUTER
</pre>
<h3>
<span id=".D0.A3.D0.B4.D0.B0.D0.BB.D1.91.D0.BD.D0.BD.D0.BE.D0.B5_.D1.83.D0.BF.D1.80.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BA.D0.BE.D0.BC.D0.BF.D1.8C.D1.8E.D1.82.D0.B5.D1.80.D0.BE.D0.BC_Windows"></span><span class="mw-headline" id="Удалённое_управление_компьютером_Windows">Удалённое управление компьютером Windows</span>
</h3>
<p>Samba предлагает набор инструментов для взаимодействия с Windows. Они могут пригодиться, если доступ к компьютеру Windows через удалённый рабочий стол невозможен, как показано на некоторых примерах.
</p>
<p>Отправка команды shutdown с комментарием:
</p>
<pre>$ net rpc shutdown -C "comment" -I IPADDRESS -U USERNAME%PASSWORD
</pre>
<p>Принудительное выключение можно вызвать, заменив -C с комментарием на один -f. Для перезапуска можно добавить -r, за которым следует -C или -f.
</p>
<p>Остановка и запуск служб:
</p>
<pre>$ net rpc service stop SERVICENAME -I IPADDRESS -U USERNAME%PASSWORD
</pre>
<p>Список доступных команд net rpc:
</p>
<pre>$ net rpc
</pre>
<h2>
<span id=".D0.A0.D0.B5.D1.88.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC"></span><span class="mw-headline" id="Решение_проблем">Решение проблем</span>
</h2>
<h3>
<span id=".D0.9D.D0.B5_.D1.83.D0.B4.D0.B0.D1.91.D1.82.D1.81.D1.8F_.D0.B7.D0.B0.D0.BF.D1.83.D1.81.D1.82.D0.B8.D1.82.D1.8C_Samba_SMB.2FCIFS_.D1.81.D0.B5.D1.80.D0.B2.D0.B5.D1.80"></span><span class="mw-headline" id="Не_удаётся_запустить_Samba_SMB/CIFS_сервер">Не удаётся запустить Samba SMB/CIFS сервер</span>
</h3>
<ul>
<li>Проверьте <code>smb.conf</code> на наличие ошибок с помощью <span class="plainlinks archwiki-template-man" title="$ man 1 testparm"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/testparm.1">testparm(1)</a></span>.</li>
<li>Проверьте корректность прав доступа в <code>/var/cache/samba/</code> и <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Перезапустите">перезапустите</a> <code>smb.service</code>:</li>
</ul>
<pre># chmod 0755 /var/cache/samba/msg
</pre>
<h3>
<span id=".D0.9F.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC.D1.8B_.D1.81_.D1.80.D0.B0.D0.B7.D1.80.D0.B5.D1.88.D0.B5.D0.BD.D0.B8.D1.8F.D0.BC.D0.B8_.D0.BD.D0.B0_SELinux"></span><span class="mw-headline" id="Проблемы_с_разрешениями_на_SELinux">Проблемы с разрешениями на SELinux</span>
</h3>
<p><a href="../en/SELinux.html" class="mw-redirect" title="SELinux (Русский)">SELinux</a> по умолчанию не позволяет samba получать доступ к домашним каталогам пользователей. Чтобы решить эту проблему, выполните команду:
</p>
<pre># setsebool -P samba_enable_home_dirs 1
</pre>
<p>Аналогично, <code>samba_export_all_ro</code> и <code>samba_export_all_rw</code> дадут доступ к чтению и записи всех файлов.
</p>
<h3>
<span id=".D0.9F.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC.D1.8B_.D1.81_.D1.80.D0.B0.D0.B7.D1.80.D0.B5.D1.88.D0.B5.D0.BD.D0.B8.D1.8F.D0.BC.D0.B8_.D0.BD.D0.B0_AppArmor"></span><span class="mw-headline" id="Проблемы_с_разрешениями_на_AppArmor">Проблемы с разрешениями на AppArmor</span>
</h3>
<p>Если используется путь к ресурсу, расположенному вне домашнего каталога или каталога usershares, внесите его в белый список в <code>/etc/apparmor.d/local/usr.sbin.smbd</code>. Например:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/apparmor.d/local/usr.sbin.smbd</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">"/data/" rk,
"/data/**" lrwk,
</pre>
<h3><span class="mw-headline" id="No_dialect_specified_on_mount">No dialect specified on mount</span></h3>
<p>Клиент использует неподдерживаемую версию SMB/CIFS, которую сервер не принимает.
</p>
<p>Смотрите <a href="#%D0%9E%D0%B3%D1%80%D0%B0%D0%BD%D0%B8%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B2%D0%B5%D1%80%D1%81%D0%B8%D0%B8_%D0%BF%D1%80%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%BB%D0%B0_%D0%B4%D0%BB%D1%8F_%D0%BF%D0%BE%D0%B2%D1%8B%D1%88%D0%B5%D0%BD%D0%B8%D1%8F_%D0%B1%D0%B5%D0%B7%D0%BE%D0%BF%D0%B0%D1%81%D0%BD%D0%BE%D1%81%D1%82%D0%B8">#Ограничение версии протокола для повышения безопасности</a>.
</p>
<h3>
<span id=".D0.9A.D0.BB.D0.B8.D0.B5.D0.BD.D1.82.D1.8B_Windows_.D0.BF.D1.80.D0.BE.D0.B4.D0.BE.D0.BB.D0.B6.D0.B0.D1.8E.D1.82_.D0.B7.D0.B0.D0.BF.D1.80.D0.B0.D1.88.D0.B8.D0.B2.D0.B0.D1.82.D1.8C_.D0.BF.D0.B0.D1.80.D0.BE.D0.BB.D1.8C.2C_.D0.B4.D0.B0.D0.B6.D0.B5_.D0.B5.D1.81.D0.BB.D0.B8_.D0.BE.D0.B1.D1.89.D0.B8.D0.B5_.D1.80.D0.B5.D1.81.D1.83.D1.80.D1.81.D1.8B_Samba_.D1.81.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D1.8B_.D1.81_.D0.BF.D1.80.D0.B0.D0.B2.D0.B0.D0.BC.D0.B8_.D0.B3.D0.BE.D1.81.D1.82.D1.8F"></span><span class="mw-headline" id="Клиенты_Windows_продолжают_запрашивать_пароль,_даже_если_общие_ресурсы_Samba_созданы_с_правами_гостя">Клиенты Windows продолжают запрашивать пароль, даже если общие ресурсы Samba созданы с правами гостя</span>
</h3>
<p>Установите опцию <code>map to guest</code> в секции <code>global</code> в файле <code>/etc/samba/smb.conf</code>:
</p>
<pre>map to guest = Bad User
</pre>
<p>С версии Samba 4.10.10 используйте <code>Bad Password</code> вместо <code>Bad User</code>.
</p>
<h3>
<span id=".D0.9F.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC.D1.8B_.D0.BF.D0.BE.D0.B4.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D1.8F_.D0.BA_Windows_7_-_mount_error.2812.29:_cannot_allocate_memory"></span><span class="mw-headline" id="Проблемы_подключения_к_Windows_7_-_mount_error(12):_cannot_allocate_memory">Проблемы подключения к Windows 7 - mount error(12): cannot allocate memory</span>
</h3>
<p>Известная ошибка Windows 7 "mount error(12): cannot allocate memory" может быть исправлена установкой пары ключей в реестре системы Windows:
</p>
<ul>
<li>
<code>HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management\LargeSystemCache</code> (установить значение <code>1</code>)</li>
<li>
<code>HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\Size</code> (установить значение <code>3</code>)</li>
</ul>
<p>В качестве альтернативы можно запустить командную строку от имени Администратора и выполнить следующее:
</p>
<pre>reg add "HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v "LargeSystemCache" /t REG_DWORD /d 1 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters" /v "Size" /t REG_DWORD /d 3 /f
</pre>
<p>Выполните одно из следующих действий, чтобы изменения вступили в силу:
</p>
<ul>
<li>Перезагрузите Windows</li>
<li>Перезапустите службу на сервере через services.msc</li>
<li>Выполните в командной строке <code>net stop lanmanserver</code> и <code>net start lanmanserver</code>; после остановки служба может перезапуститься автоматически</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Поиск решения в интернете подскажет другое решение, рекомендующее пользователям добавить ключ, изменяющий размер "IRPStackSize". Это неправильное решение для устранения проблемы в Windows 7. Не применяйте его.</div>
<p><a rel="nofollow" class="external text" href="https://web.archive.org/web/20150819153712/http://alan.lamielle.net/2009/09/03/windows-7-nonpaged-pool-srv-error-2017/">Исходная статья</a>.
</p>
<h3>
<span id=".D0.9F.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC.D1.8B_.D0.BF.D0.BE.D0.B4.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D1.8F_.D0.BA_Windows_10_1709_.D0.B8_.D0.BD.D0.BE.D0.B2.D0.B5.D0.B5_-_.22Windows_cannot_access.22_0x80004005"></span><span class="mw-headline" id='Проблемы_подключения_к_Windows_10_1709_и_новее_-_"Windows_cannot_access"_0x80004005'>Проблемы подключения к Windows 10 1709 и новее - "Windows cannot access" 0x80004005</span>
</h3>
<p>Эта ошибка затрагивает некоторые машины под управлением Windows 10 версии 1709 и более поздних версий. Она не связана с отключением SMB1 в этой версии, а связана с тем, что Microsoft отключила небезопасный вход для гостей в этой версии для некоторых.
</p>
<p>Чтобы исправить ситуацию, откройте редактор групповой политики (<code>gpedit.msc</code>). Перейдите к настройке <i>Конфигурация компьютера\Административные шаблоны\Сеть\Рабочая станция Lanman &gt; Включить небезопасные гостевые входы</i> и включите её. В качестве альтернативы измените следующее значение в реестре:
</p>
<pre>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters]
"AllowInsecureGuestAuth"=dword:1
</pre>
<h3>
<span id=".D0.9E.D1.88.D0.B8.D0.B1.D0.BA.D0.B0:_Failed_to_retrieve_printer_list:_NT_STATUS_UNSUCCESSFUL"></span><span class="mw-headline" id="Ошибка:_Failed_to_retrieve_printer_list:_NT_STATUS_UNSUCCESSFUL">Ошибка: Failed to retrieve printer list: NT_STATUS_UNSUCCESSFUL</span>
</h3>
<p>Если вы являетесь домашним пользователем, используете samba исключительно для организации общего доступа к файлам с сервера или NAS и не заинтересованы в организации общего доступа к принтерам, вы можете исправить эту ошибку, добавив следующие строки в файл <code>/etc/samba/smb.conf</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/samba/smb.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[global]
  load printers = No
  printing = bsd
  printcap name = /dev/null
  disable spoolss = Yes</pre>
<p><a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Перезапустите">Перезапустите</a> службу <code>smb.service</code> и проверьте журнал:
</p>
<pre># cat /var/log/samba/smbd.log
</pre>
<p>и больше ошибка не должна появляться.
</p>
<h3>
<span id=".D0.9D.D0.B5_.D1.83.D0.B4.D0.B0.D0.B5.D1.82.D1.81.D1.8F_.D0.BF.D1.80.D0.B5.D0.B4.D0.BE.D1.81.D1.82.D0.B0.D0.B2.D0.B8.D1.82.D1.8C_.D0.BE.D0.B1.D1.89.D0.B8.D0.B9_.D0.B4.D0.BE.D1.81.D1.82.D1.83.D0.BF_.D0.BA_.D0.BF.D0.B0.D0.BF.D0.BA.D0.B5"></span><span class="mw-headline" id="Не_удается_предоставить_общий_доступ_к_папке">Не удается предоставить общий доступ к папке</span>
</h3>
<p>Проблема проявляется в том, что, когда вы пытаетесь предоставить общий доступ к папке через <i>Dolphin</i> (файловый менеджер), и вначале, вроде бы, все работает нормально, после перезапуска <i>Dolphin</i> иконка ресурса исчезла из папки, а в терминале (<i>Konsole</i>) вы видите следующий вывод:
</p>
<pre>‘net usershare’ returned error 255: net usershare: usershares are currently disabled
</pre>
<p>Для решения проблемы включите пользовательские общие ресурсы, как это описано в разделе <a href="#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%BE%D0%B2_%D0%BE%D0%B1%D1%89%D0%B5%D0%B3%D0%BE_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0_%D0%BE%D1%82_%D0%B8%D0%BC%D0%B5%D0%BD%D0%B8_%D0%BE%D0%B1%D1%8B%D1%87%D0%BD%D0%BE%D0%B3%D0%BE_%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F">#Создание ресурсов общего доступа от имени обычного пользователя</a>.
</p>
<h3>
<span id=".22.D0.9F.D1.80.D0.BE.D1.81.D0.BC.D0.BE.D1.82.D1.80.22_.D1.81.D0.B5.D1.82.D0.B8_.D0.B2.D1.8B.D0.B4.D0.B0.D0.B5.D1.82_.D0.BE.D1.88.D0.B8.D0.B1.D0.BA.D1.83_.22.D0.9D.D0.B5_.D1.83.D0.B4.D0.B0.D0.BB.D0.BE.D1.81.D1.8C_.D0.BF.D0.BE.D0.BB.D1.83.D1.87.D0.B8.D1.82.D1.8C_.D1.81.D0.BF.D0.B8.D1.81.D0.BE.D0.BA_.D1.80.D0.B5.D1.81.D1.83.D1.80.D1.81.D0.BE.D0.B2_.D1.81_.D1.81.D0.B5.D1.80.D0.B2.D0.B5.D1.80.D0.B0.22_.28Failed_to_retrieve_share_list_from_server.29"></span><span class="mw-headline" id='"Просмотр"_сети_выдает_ошибку_"Не_удалось_получить_список_ресурсов_с_сервера"_(Failed_to_retrieve_share_list_from_server)'>"Просмотр" сети выдает ошибку "Не удалось получить список ресурсов с сервера" (Failed to retrieve share list from server)</span>
</h3>
<p>И вы используете межсетевой экран (iptables), поскольку не доверяете вашей локальной (школа, университет, отель) сети. Это может происходить по следующей причине: когда smbclient просматривает локальную сеть, он посылает широковещательный запрос на udp-порт 137. Затем серверы сети отвечают вашему клиенту, но, поскольку исходный адрес ответа отличается от адреса назначения, который видел iptables при отправке запроса, iptables не признает ответ как "установленное соединение" ("ESTABLISHED") или "относящийся к запросу" ("RELATED"), и, следовательно, пакет отбрасывается. Возможное решение - добавление:
</p>
<pre>iptables -t raw -A OUTPUT -p udp -m udp --dport 137 -j CT --helper netbios-ns
</pre>
<p>в вашу конфигурацию iptables.
</p>
<p>Для <a href="../en/Uncomplicated_Firewall.html" title="Uncomplicated Firewall">Uncomplicated Firewall</a> добавьте <code>nf_conntrack_netbios_ns</code> в конце следующей строки в <code>/etc/default/ufw</code>:
</p>
<pre>IPT_MODULES="nf_conntrack_ftp nf_nat_ftp nf_conntrack_irc nf_nat_irc"
</pre>
<p>и затем выполните следующие команды от имени root:
</p>
<pre>echo 1 &gt; /proc/sys/net/netfilter/nf_conntrack_helper
ufw allow CIFS
ufw reload
</pre>
<p>Чтобы сделать изменения постоянными, добавьте следующую строку в конце файла <code>/etc/ufw/sysctl.conf</code>:
</p>
<pre>net.netfilter.nf_conntrack_helper=1
</pre>
<h3><span class="mw-headline" id="protocol_negotiation_failed:_NT_STATUS_INVALID_NETWORK_RESPONSE">protocol negotiation failed: NT_STATUS_INVALID_NETWORK_RESPONSE</span></h3>
<p>Вероятно, клиент не имеет доступа к общим ресурсам. Удостоверьтесь, что IP-адрес клиента прописан в строке <code>hosts allow =</code> файла <code>/etc/samba/smb.conf</code>.
</p>
<p>Также проблема может быть в том, что клиент использует недопустимую версию протокола. Для проверки попробуйте подключиться с помощью <code>smbclient</code>, вручную указав максимальную версию протокола:
</p>
<pre>$ smbclient -U &lt;пользователь&gt; -L //&lt;сервер&gt; -m &lt;версия протокола, например SMB2&gt; -W &lt;домен&gt;
</pre>
<p>Если команда выполнится успешно, создайте файл конфигрурации:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.smb/smb.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[global]
  workgroup = &lt;домен&gt;
  client max protocol = SMB2</pre>
<h3>
<span id=".D0.9F.D0.BE.D0.B4.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BA_.D1.81.D0.B5.D1.80.D0.B2.D0.B5.D1.80.D1.83_.D0.B7.D0.B0.D0.B2.D0.B5.D1.80.D1.88.D0.B8.D0.BB.D0.BE.D1.81.D1.8C_.D0.BD.D0.B5.D1.83.D0.B4.D0.B0.D1.87.D0.B5.D0.B9:_.28Error_NT_STATUS_UNSUCCESSFUL.29"></span><span class="mw-headline" id="Подключение_к_серверу_завершилось_неудачей:_(Error_NT_STATUS_UNSUCCESSFUL)">Подключение к серверу завершилось неудачей: (Error NT_STATUS_UNSUCCESSFUL)</span>
</h3>
<p>Вероятно, вы указываете <code>smbclient</code> неправильное имя сервера. Чтобы узнать его, запустите на сервере команду <code>hostnamectl</code> и найдите строку "Transient hostname".
</p>
<h3>
<span id=".D0.9F.D0.BE.D0.B4.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BA_.D1.81.D0.B5.D1.80.D0.B2.D0.B5.D1.80.D1.83_.D0.B7.D0.B0.D0.B2.D0.B5.D1.80.D1.88.D0.B8.D0.BB.D0.BE.D1.81.D1.8C_.D0.BD.D0.B5.D1.83.D0.B4.D0.B0.D1.87.D0.B5.D0.B9:_.28Error_NT_STATUS_CONNECTION_REFUSED.29"></span><span class="mw-headline" id="Подключение_к_серверу_завершилось_неудачей:_(Error_NT_STATUS_CONNECTION_REFUSED)">Подключение к серверу завершилось неудачей: (Error NT_STATUS_CONNECTION_REFUSED)</span>
</h3>
<p>Убедитесь, что сервер запущен.
</p>
<h3><span class="mw-headline" id="Protocol_negotiation_failed:_NT_STATUS_CONNECTION_RESET">Protocol negotiation failed: NT_STATUS_CONNECTION_RESET</span></h3>
<p>Вероятно, на сервере запрещён SMB1. Добавьте опцию <code>client max protocol = SMB2</code> в <code>/etc/samba/smb.conf</code>.
Или просто добавьте <code>-m SMB2</code> к команде <code>smbclient</code>.
</p>
<h3>
<span id=".D0.9F.D1.80.D0.B0.D0.B2.D0.B8.D0.BB.D1.8C.D0.BD.D1.8B.D0.B9_.D0.BF.D0.B0.D1.80.D0.BE.D0.BB.D1.8C_.D0.BD.D0.B5_.D0.BF.D0.BE.D0.B4.D1.85.D0.BE.D0.B4.D0.B8.D1.82_.28.D0.BE.D1.88.D0.B8.D0.B1.D0.BA.D0.B0_1326.29"></span><span class="mw-headline" id="Правильный_пароль_не_подходит_(ошибка_1326)">Правильный пароль не подходит (ошибка 1326)</span>
</h3>
<p>В <a rel="nofollow" class="external text" href="https://www.samba.org/samba/history/samba-4.5.0.html">Samba 4.5</a> аутентификация NTLMv1 по умолчанию отключена. Рекомендуется установить последние доступные обновления на клиентах и запретить доступ для неподдерживаемых клиентов.
</p>
<p>Если вам всё ещё нужна поддержка очень старых клиентов без поддержки NTLMv2 (например, Windows XP), можно включить NTLMv1, однако это <b>не рекомендуется</b> по соображениям безопасности:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/samba/smb.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[global]
  lanman auth = yes
  ntlm auth = yes</pre>
<p>Если клиенты NTLMv2 не могут пройти аутентификацию при включенном NTLMv1, создайте на клиенте следующий файл:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/home/user/.smb/smb.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[global]
  sec = ntlmv2
  client ntlmv2 auth = yes</pre>
<p>Это изменение также влияет на общие ресурсы samba, смонтированные с помощью <b>mount.cifs</b>. Если после обновления до Samba 4.5 монтирование не удаётся, добавьте опцию <b>sec=ntlmssp</b> к команде монтирования, например:
</p>
<pre>mount.cifs //server/share /mnt/point -o sec=ntlmssp,...
</pre>
<p>Смотрите <span class="plainlinks archwiki-template-man" title="$ man 8 mount.cifs"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mount.cifs.8">mount.cifs(8)</a></span>: <b>ntlmssp</b> — Использовать хэширование паролей NTLMv2, заключённое в Raw NTLMSSP сообщении. По умолчанию в основных версиях ядра до версии 3.8 было <b>sec=ntlm</b>. В версии 3.8 значение по умолчанию было изменено на <b>sec=ntlmssp</b>.
</p>
<h3>
<span id=".D0.A1.D0.BE.D0.BF.D0.BE.D1.81.D1.82.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B7.D0.B0.D1.80.D0.B5.D0.B7.D0.B5.D1.80.D0.B2.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.BD.D1.8B.D1.85_.D1.81.D0.B8.D0.BC.D0.B2.D0.BE.D0.BB.D0.BE.D0.B2_Windows"></span><span class="mw-headline" id="Сопоставление_зарезервированных_символов_Windows">Сопоставление зарезервированных символов Windows</span>
</h3>
<p>Начиная с ядра 3.18, модуль cifs <a rel="nofollow" class="external text" href="https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=2baa2682531ff02928e2d3904800696d9e7193db">по умолчанию использует опцию "mapposix"</a>. При монтировании ресурса с использованием расширений unix и конфигурации Samba по умолчанию, файлы и каталоги, содержащие один из семи зарезервированных символов Windows <code>: \ * &lt; &gt; ? </code>, отображаются, но доступ к ним невозможен.
</p>
<p>Возможные решения:
</p>
<ul><li>Использовать недокументированную опцию монтирования <code>nomapposix</code> для cifs</li></ul>
<pre># mount.cifs //server/share /mnt/point -o nomapposix
</pre>
<ul><li>Настроить Samba для переадресации символов стиля <code>mapposix</code> ("SFM", Services for Mac) на правильные родные символы с помощью <a rel="nofollow" class="external text" href="https://www.mankier.com/8/vfs_fruit">fruit</a>
</li></ul>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/samba/smb.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[global]
  vfs objects = catia fruit
  fruit:encoding = native</pre>
<ul><li>Написать своё сопоставление запрещённых символов с помощью <a rel="nofollow" class="external text" href="https://www.mankier.com/8/vfs_catia">catia</a>
</li></ul>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/samba/smb.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[global]
  vfs objects = catia
  catia:mappings = 0x22:0xf022, 0x2a:0xf02a, 0x2f:0xf02f, 0x3a:0xf03a, 0x3c:0xf03c, 0x3e:0xf03e, 0x3f:0xf03f, 0x5c:0xf05c, 0x7c:0xf07c, 0x20:0xf020</pre>
<p>Последний подход (использование catia или fruit) имеет недостаток, заключающийся в фильтрации файлов с непечатаемыми символами.
</p>
<h3>
<span id=".D0.9F.D0.B0.D0.BF.D0.BA.D0.B0.2C_.D0.BA_.D0.BA.D0.BE.D1.82.D0.BE.D1.80.D0.BE.D0.B9_.D0.BE.D1.82.D0.BA.D1.80.D1.8B.D1.82_.D0.B4.D0.BE.D1.81.D1.82.D1.83.D0.BF_.D1.87.D0.B5.D1.80.D0.B5.D0.B7_.D0.B3.D1.80.D0.B0.D1.84.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B8.D0.B9_.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D1.84.D0.B5.D0.B9.D1.81.2C_.D0.BD.D0.B5.D0.B4.D0.BE.D1.81.D1.82.D1.83.D0.BF.D0.BD.D0.B0_.D0.B4.D0.BB.D1.8F_.D0.B3.D0.BE.D1.81.D1.82.D0.B5.D0.B9"></span><span class="mw-headline" id="Папка,_к_которой_открыт_доступ_через_графический_интерфейс,_недоступна_для_гостей">Папка, к которой открыт доступ через графический интерфейс, недоступна для гостей</span>
</h3>
<p>Этот раздел предполагает, что:
</p>
<ol>
<li>Общие папки настроены, как описано в разделе <a href="#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%BE%D0%B2_%D0%BE%D0%B1%D1%89%D0%B5%D0%B3%D0%BE_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0_%D0%BE%D1%82_%D0%B8%D0%BC%D0%B5%D0%BD%D0%B8_%D0%BE%D0%B1%D1%8B%D1%87%D0%BD%D0%BE%D0%B3%D0%BE_%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8F">#Создание ресурсов общего доступа от имени обычного пользователя</a>
</li>
<li>Общая папка создана через графический интерфейс и не пользователем root</li>
<li>Включен гостевой доступ для папки</li>
<li>Служба Samba перезапускалась с момента последнего изменения файла <code>/etc/samba/smb.conf</code>
</li>
</ol>
<p>В качестве примера далее используются следующие значения:
</p>
<ul>
<li>Общая папка находится внутри домашнего каталога пользователя (<code>/home/yourUser/Shared</code>)</li>
<li>Имя общей папки — <i>MySharedFiles</i>
</li>
<li>Гостевой доступ открыт только для чтения.</li>
<li>Пользователи Windows будут иметь доступ к содержимому общей папки без аутентификации</li>
</ul>
<h4>
<span id=".D0.9F.D1.80.D0.BE.D0.B2.D0.B5.D1.80.D1.8C.D1.82.D0.B5_.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BB.D1.8C.D0.BD.D0.BE.D1.81.D1.82.D1.8C_.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D0.B8_samba"></span><span class="mw-headline" id="Проверьте_правильность_конфигурации_samba">Проверьте правильность конфигурации samba</span>
</h4>
<p>Выполните следующую команду из терминала, чтобы проверить правильность настроек:
</p>
<pre>$ testparm
</pre>
<h4>
<span id=".D0.9F.D1.80.D0.BE.D0.B2.D0.B5.D1.80.D1.8C.D1.82.D0.B5_.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BB.D1.8C.D0.BD.D0.BE.D1.81.D1.82.D1.8C_.D1.81.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D1.8F_.D0.BE.D0.B1.D1.89.D0.B5.D0.B9_.D0.BF.D0.B0.D0.BF.D0.BA.D0.B8"></span><span class="mw-headline" id="Проверьте_правильность_создания_общей_папки">Проверьте правильность создания общей папки</span>
</h4>
<p>Выполните следующие команды из терминала:
</p>
<pre>$ cd /var/lib/samba/usershare
$ ls
</pre>
<p>Если всё хорошо, должен быть файл с именем <code>mysharedfiles</code>
</p>
<p>Посмотрите его содержимое:
</p>
<pre>$ cat mysharedfiles
</pre>
<p>Содержимое файла должно быть примерно таким:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/var/lib/samba/usershare/mysharedfiles</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">path=/home/yourUser/Shared
comment=
usershare_acl=S-1-1-0:r
guest_ok=y
sharename=MySharedFiles</pre>
<h4>
<span id=".D0.9F.D1.80.D0.BE.D0.B2.D0.B5.D1.80.D1.8C.D1.82.D0.B5_.D0.B4.D0.BE.D1.81.D1.82.D1.83.D0.BF_.D0.BA_.D0.BF.D0.B0.D0.BF.D0.BA.D0.B5_.D0.BE.D1.82_.D0.B8.D0.BC.D0.B5.D0.BD.D0.B8_.D0.B3.D0.BE.D1.81.D1.82.D1.8F"></span><span class="mw-headline" id="Проверьте_доступ_к_папке_от_имени_гостя">Проверьте доступ к папке от имени гостя</span>
</h4>
<p>Выполните следующую команду из терминала. Если будет запрошен пароль, просто нажмите Enter:
</p>
<pre>$ smbclient -L localhost
</pre>
<p>Если всё хорошо, в столбце <code>Sharename</code> должен присутствовать MySharedFiles.
</p>
<p>Выполните следующую команду, чтобы получить доступ к общей папке в качестве гостя (анонимный вход)
</p>
<pre>$ smbclient -N //localhost/MySharedFiles
</pre>
<p>Если всё хорошо, должно появиться приглашение samba-клиента:
</p>
<pre>smb: \&gt;
</pre>
<p>Проверьте, что гость может посмотреть содержимое папки:
</p>
<pre>smb: \&gt; ls
</pre>
<p>Если появится ошибка <code>NTFS_STATUS_ACCESS_DENIED</code>, то проблема скорее всего связана с правами доступа к каталогам Unix. Убедитесь, что пользователь samba имеет доступ к нужной папке и всем родительским папкам. Это можно проверить, войдя в учётную запись нужного пользователя (например, с помощью sudo) и попытавшись перейти в нужный каталог.
</p>
<h3><span class="mw-headline" id="Mount_error:_Host_is_down">Mount error: Host is down</span></h3>
<p>Такая ошибка может появиться при монтировании общих ресурсов Synology NAS. Для решения проблемы используйте опцию <code>vers=1.0</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> SMB1 имеет уязвимости в безопасности и уже использовался в успешных атаках вымогательского ПО.</div>
<h3><span class="mw-headline" id="Software_caused_connection_abort">Software caused connection abort</span></h3>
<p>Файловые менеджеры, использующие <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gvfs-smb">gvfs-smb</a></span>, могут выдавать ошибку <code>Software caused connection abort</code> при записи файла на общий ресурс/сервер. Это может быть связано с тем, что на сервере используется SMB/CIFS версии 1, которую многие маршрутизаторы используют для организации общего доступа к USB-накопителям (например, маршрутизаторы Belkin). Для записи на эти общие ресурсы укажите версию CIFS с помощью опции <code>vers=1.0</code>. Например:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/fstab</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">//СЕРВЕР/имя_ресурса /mnt/точка_монтирования cifs _netdev,guest,file_mode=0777,dir_mode=0777,vers=1.0 0 0</pre>
<p>Это также может произойти после обновления Samba до версии 4.11, в которой SMB1 отключен по умолчанию. Его можно включить с помощью следующей опции:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/samba/smb.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[global]
client min protocol = CORE</pre>
<h3>
<span id=".D0.9E.D1.88.D0.B8.D0.B1.D0.BA.D0.B0_.D0.B0.D1.83.D1.82.D0.B5.D0.BD.D1.82.D0.B8.D1.84.D0.B8.D0.BA.D0.B0.D1.86.D0.B8.D0.B8"></span><span class="mw-headline" id="Ошибка_аутентификации">Ошибка аутентификации</span>
</h3>
<p>Убедитесь в отсутствии пробелов перед именем пользователя в настройках Samba:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.samba</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">username= user
password=pass</pre>
<p>Правильно так:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.samba</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">username=user
password=pass</pre>
<h3>
<span id="Windows_1709_.D0.B8_.D0.BD.D0.BE.D0.B2.D0.B5.D0.B5_.D0.BD.D0.B5_.D0.B2.D0.B8.D0.B4.D0.B8.D1.82_.D1.81.D0.B5.D1.80.D0.B2.D0.B5.D1.80_samba_.D0.BF.D1.80.D0.B8_.D0.BF.D1.80.D0.BE.D1.81.D0.BC.D0.BE.D1.82.D1.80.D0.B5_.D1.81.D0.B5.D1.82.D0.B8"></span><span class="mw-headline" id="Windows_1709_и_новее_не_видит_сервер_samba_при_просмотре_сети">Windows 1709 и новее не видит сервер samba при просмотре сети</span>
</h3>
<p>В Windows 10 версии 1511 поддержка SMBv1 и, соответственно, обнаружение устройств NetBIOS были отключены по умолчанию. Более новые версии Windows, начиная с версии 1709 ("Fall Creators Update"), больше не позволяют установить клиент SMBv1. Это приводит к тому, что хосты с Samba не отображаются в просмотре сети в Проводнике. Хотя проблем с подключением нет и Samba будет работать нормально, пользователи могут захотеть, чтобы их хосты Samba всё-таки отображались. <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=wsdd">wsdd</a></span> реализует демон Web Service Discovery. Благодаря ему (Samba) хосты, такие как NAS, могут быть обнаружены клиентами Web Service Discovery, такими как Windows. Настройки по умолчанию должны работать для большинства установок, и всё, что вам нужно сделать, это <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Запустить">запустить</a> и <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Включить">включить</a> службу <code>wsdd.service</code>.
</p>
<p>Настройки по умолчанию (представлять себя, используя имя хоста машины и рабочую группу "WORKGROUP") должна подходить в большинстве случаев. Если нужно, вы можете изменить настройки, передав wsdd дополнительные аргументы, добавив их в <code>/etc/conf.d/wsdd</code> (подробности есть в руководстве wsdd).
</p>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/wsdd2/">wsdd2</a></span><sup><small>AUR</small></sup> делает то же самое, но написан на C, а не на Python. По умолчанию он берёт параметры <code>netbios name</code> и <code>workgroup</code> из файла <code>smb.conf</code>.
</p>
<h3>
<span id=".D0.A4.D0.B0.D0.B9.D0.BB.D1.8B_.D0.B8.D0.B7_IOS_.D0.B1.D0.BE.D0.BB.D1.8C.D1.88.D0.B5_.D0.BD.D0.B5_.D0.BC.D0.BE.D0.B3.D1.83.D1.82_.D0.BA.D0.BE.D0.BF.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D1.82.D1.8C.D1.81.D1.8F_.D0.B2_.D0.BE.D0.B1.D1.89.D0.B8.D0.B9_.D1.80.D0.B5.D1.81.D1.83.D1.80.D1.81_Samba_.D0.B2_Arch_Linux.2C_.D0.BD.D0.B0.D1.87.D0.B8.D0.BD.D0.B0.D1.8F_.D1.81_IOS_14.5"></span><span class="mw-headline" id="Файлы_из_IOS_больше_не_могут_копироваться_в_общий_ресурс_Samba_в_Arch_Linux,_начиная_с_IOS_14.5">Файлы из IOS больше не могут копироваться в общий ресурс Samba в Arch Linux, начиная с IOS 14.5</span>
</h3>
<p>Начиная с IOS 14.5 при попытке передачи данных с устройства под управлением IOS с помощью приложения "Файлы" на общий ресурс samba в Arch Linux возникает ошибка:
</p>
<pre>The operation couldn't be completed
Operation canceled
</pre>
<p>Чтобы исправить эту проблему, добавьте следующее в секцию <code>[global]</code> файла <code>smb.conf</code> и <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Перезапустите">перезапустите</a> службу <code>smb.service</code>: <a rel="nofollow" class="external autonumber" href="https://apple.stackexchange.com/questions/424681">[1]</a>
</p>
<pre>## addition for IOS Files transfer-to server
vfs object = fruit streams_xattr
</pre>
<h2>
<span id=".D0.A1.D0.BC.D0.BE.D1.82.D1.80.D0.B8.D1.82.D0.B5_.D1.82.D0.B0.D0.BA.D0.B6.D0.B5"></span><span class="mw-headline" id="Смотрите_также">Смотрите также</span>
</h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://www.samba.org/samba/docs/SambaIntro.html">Samba: An Introduction</a></li>
<li><a rel="nofollow" class="external text" href="https://www.samba.org/">Официальный сайт Samba</a></li>
<li>
<a rel="nofollow" class="external text" href="https://www.samba.org/samba/docs/Samba-HOWTO-Collection.pdf">Samba 3.2.x HOWTO and Reference Guide</a> (устаревшая, но всё ещё самая подробная документация)</li>
<li><a href="https://en.wikipedia.org/wiki/ru:Samba" class="extiw" title="wikipedia:ru:Samba">Википедия</a></li>
<li><a href="https://wiki.gentoo.org/wiki/Samba/Guide" class="extiw" title="gentoo:Samba/Guide">Gentoo:Samba/Guide</a></li>
<li><a href="https://wiki.debian.org/Samba/ServerSimple" class="extiw" title="debian:Samba/ServerSimple">Debian:Samba/ServerSimple</a></li>
<li>
<a rel="nofollow" class="external text" href="https://docs.kernel.org//filesystems/cifs/ksmbd.html">KSMBD</a><sup title="Статус последней проверки: 404">[<a href="https://en.wikipedia.org/wiki/ru:%D0%92%D0%B8%D0%BA%D0%B8%D0%BF%D0%B5%D0%B4%D0%B8%D1%8F:%D0%9C%D1%91%D1%80%D1%82%D0%B2%D1%8B%D0%B5_%D1%81%D1%81%D1%8B%D0%BB%D0%BA%D0%B8" class="extiw" title="wikipedia:ru:Википедия:Мёртвые ссылки">устаревшая ссылка</a> 2023-06-17 ⓘ]</sup> - Сервер ядра linux, реализующий протокол SMB3 в пространстве ядра для обмена файлами по сети.</li>
<li><a rel="nofollow" class="external text" href="https://runos.ru/sekrety-optimizacii-samba">Ускорение работы Samba</a></li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../ru/Category:Network_sharing.html" title="Category:Network sharing (Русский)">Network sharing (Русский)</a></li>
<li><a href="../ru/Category:Servers.html" title="Category:Servers (Русский)">Servers (Русский)</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Samba_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;oldid=808595">https://wiki.archlinux.org/index.php?title=Samba_(Русский)&amp;oldid=808595</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 18 May 2024, at 06:31.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
