<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>mkinitcpio (Русский) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Mkinitcpio_Русский rootpage-Mkinitcpio_Русский skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Установка" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Установка</div>
		</a>
		
		<ul id="toc-Установка-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Создание_загрузочного_образа" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BE%D1%87%D0%BD%D0%BE%D0%B3%D0%BE_%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%B0">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Создание загрузочного образа</div>
		</a>
		
			<button aria-controls="toc-Создание_загрузочного_образа-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Создание загрузочного образа subsection</span>
			</button>
		
		<ul id="toc-Создание_загрузочного_образа-sublist" class="vector-toc-list">
			<li id="toc-Автоматическая_генерация" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%90%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%B3%D0%B5%D0%BD%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D1%8F">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Автоматическая генерация</div>
			</a>
			
			<ul id="toc-Автоматическая_генерация-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Ручная_генерация" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A0%D1%83%D1%87%D0%BD%D0%B0%D1%8F_%D0%B3%D0%B5%D0%BD%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D1%8F">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.2</span>Ручная генерация</div>
			</a>
			
			<ul id="toc-Ручная_генерация-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Варианты_создания_initcpio" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%92%D0%B0%D1%80%D0%B8%D0%B0%D0%BD%D1%82%D1%8B_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D1%8F_initcpio">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.3</span>Варианты создания initcpio</div>
			</a>
			
			<ul id="toc-Варианты_создания_initcpio-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Unified_kernel_images" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Unified_kernel_images">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.4</span>Unified kernel images</div>
			</a>
			
			<ul id="toc-Unified_kernel_images-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Настройка" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Настройка</div>
		</a>
		
			<button aria-controls="toc-Настройка-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Настройка subsection</span>
			</button>
		
		<ul id="toc-Настройка-sublist" class="vector-toc-list">
			<li id="toc-MODULES" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#MODULES">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>MODULES</div>
			</a>
			
			<ul id="toc-MODULES-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-BINARIES_и_FILES" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#BINARIES_%D0%B8_FILES">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>BINARIES и FILES</div>
			</a>
			
			<ul id="toc-BINARIES_и_FILES-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-HOOKS" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#HOOKS">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3</span>HOOKS</div>
			</a>
			
			<ul id="toc-HOOKS-sublist" class="vector-toc-list">
				<li id="toc-Build_hooks" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Build_hooks">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.1</span>Build hooks</div>
			</a>
			
			<ul id="toc-Build_hooks-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Runtime_hooks" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Runtime_hooks">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.2</span>Runtime hooks</div>
			</a>
			
			<ul id="toc-Runtime_hooks-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Доступные_хуки" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%94%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%BD%D1%8B%D0%B5_%D1%85%D1%83%D0%BA%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3.3</span>Доступные хуки</div>
			</a>
			
			<ul id="toc-Доступные_хуки-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-COMPRESSION" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#COMPRESSION">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.4</span>COMPRESSION</div>
			</a>
			
			<ul id="toc-COMPRESSION-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-COMPRESSION_OPTIONS" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#COMPRESSION_OPTIONS">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.5</span>COMPRESSION_OPTIONS</div>
			</a>
			
			<ul id="toc-COMPRESSION_OPTIONS-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Настройка_во_время_выполнения" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_%D0%B2%D0%BE_%D0%B2%D1%80%D0%B5%D0%BC%D1%8F_%D0%B2%D1%8B%D0%BF%D0%BE%D0%BB%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Настройка во время выполнения</div>
		</a>
		
			<button aria-controls="toc-Настройка_во_время_выполнения-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Настройка во время выполнения subsection</span>
			</button>
		
		<ul id="toc-Настройка_во_время_выполнения-sublist" class="vector-toc-list">
			<li id="toc-init_from_base_hook" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#init_from_base_hook">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>init from base hook</div>
			</a>
			
			<ul id="toc-init_from_base_hook-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-При_использовании_RAID" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%B8_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B8_RAID">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2</span>При использовании RAID</div>
			</a>
			
			<ul id="toc-При_использовании_RAID-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-При_использовании_net" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%B8_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B8_net">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.3</span>При использовании net</div>
			</a>
			
			<ul id="toc-При_использовании_net-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-При_использовании_lvm" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%B8_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B8_lvm">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4</span>При использовании lvm</div>
			</a>
			
			<ul id="toc-При_использовании_lvm-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-При_зашифрованном_корневом_разделе" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%B8_%D0%B7%D0%B0%D1%88%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D0%BE%D0%BC_%D0%BA%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D0%BE%D0%BC_%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB%D0%B5">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.5</span>При зашифрованном корневом разделе</div>
			</a>
			
			<ul id="toc-При_зашифрованном_корневом_разделе-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-/usr_на_отдельном_разделе" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#/usr_%D0%BD%D0%B0_%D0%BE%D1%82%D0%B4%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D0%BC_%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB%D0%B5">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.6</span>/usr на отдельном разделе</div>
			</a>
			
			<ul id="toc-/usr_на_отдельном_разделе-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Решение_проблем" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%A0%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Решение проблем</div>
		</a>
		
			<button aria-controls="toc-Решение_проблем-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Решение проблем subsection</span>
			</button>
		
		<ul id="toc-Решение_проблем-sublist" class="vector-toc-list">
			<li id="toc-Распаковка_образа" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A0%D0%B0%D1%81%D0%BF%D0%B0%D0%BA%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%B0">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1</span>Распаковка образа</div>
			</a>
			
			<ul id="toc-Распаковка_образа-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Изменение_и_упаковка_образа" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%98%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B8_%D1%83%D0%BF%D0%B0%D0%BA%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%B0">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2</span>Изменение и упаковка образа</div>
			</a>
			
			<ul id="toc-Изменение_и_упаковка_образа-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id='toc-"/dev_must_be_mounted",_хотя_он_и_так_примонтирован' class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href='#"/dev_must_be_mounted",_%D1%85%D0%BE%D1%82%D1%8F_%D0%BE%D0%BD_%D0%B8_%D1%82%D0%B0%D0%BA_%D0%BF%D1%80%D0%B8%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD'>
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.3</span>"/dev must be mounted", хотя он и так примонтирован</div>
			</a>
			
			<ul id='toc-"/dev_must_be_mounted",_хотя_он_и_так_примонтирован-sublist' class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Possibly_missing_firmware_for_module_XXXX" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Possibly_missing_firmware_for_module_XXXX">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.4</span>Possibly missing firmware for module XXXX</div>
			</a>
			
			<ul id="toc-Possibly_missing_firmware_for_module_XXXX-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-No_PS/2_controller_found" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#No_PS/2_controller_found">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.5</span>No PS/2 controller found</div>
			</a>
			
			<ul id="toc-No_PS/2_controller_found-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Стандартная_процедура_восстановления" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A1%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D0%BD%D0%B0%D1%8F_%D0%BF%D1%80%D0%BE%D1%86%D0%B5%D0%B4%D1%83%D1%80%D0%B0_%D0%B2%D0%BE%D1%81%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.6</span>Стандартная процедура восстановления</div>
			</a>
			
			<ul id="toc-Стандартная_процедура_восстановления-sublist" class="vector-toc-list">
				<li id="toc-Загрузка_выполняется_на_одной_машине_и_терпит_неудачу_на_другой" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%97%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B0_%D0%B2%D1%8B%D0%BF%D0%BE%D0%BB%D0%BD%D1%8F%D0%B5%D1%82%D1%81%D1%8F_%D0%BD%D0%B0_%D0%BE%D0%B4%D0%BD%D0%BE%D0%B9_%D0%BC%D0%B0%D1%88%D0%B8%D0%BD%D0%B5_%D0%B8_%D1%82%D0%B5%D1%80%D0%BF%D0%B8%D1%82_%D0%BD%D0%B5%D1%83%D0%B4%D0%B0%D1%87%D1%83_%D0%BD%D0%B0_%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.6.1</span>Загрузка выполняется на одной машине и терпит неудачу на другой</div>
			</a>
			
			<ul id="toc-Загрузка_выполняется_на_одной_машине_и_терпит_неудачу_на_другой-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Смотрите_также" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%A1%D0%BC%D0%BE%D1%82%D1%80%D0%B8%D1%82%D0%B5_%D1%82%D0%B0%D0%BA%D0%B6%D0%B5">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>Смотрите также</div>
		</a>
		
		<ul id="toc-Смотрите_также-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading">mkinitcpio (Русский)</h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 6 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-6" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">6 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-de mw-list-item"><a href="https://wiki.archlinux.de/title/Mkinitcpio" title="Mkinitcpio – Deutsch" lang="de" hreflang="de" class="interlanguage-link-target"><span>Deutsch</span></a></li>
<li class="interlanguage-link interwiki-en mw-list-item"><a href="../en/Mkinitcpio.html" title="Mkinitcpio – English" lang="en" hreflang="en" class="interlanguage-link-target"><span>English</span></a></li>
<li class="interlanguage-link interwiki-fr mw-list-item"><a href="../fr/Mkinitcpio.html" title="Mkinitcpio – français" lang="fr" hreflang="fr" class="interlanguage-link-target"><span>Français</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Mkinitcpio" title="Mkinitcpio – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-pt mw-list-item"><a href="../pt/Mkinitcpio.html" title="Mkinitcpio – português" lang="pt" hreflang="pt" class="interlanguage-link-target"><span>Português</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/Mkinitcpio" title="Mkinitcpio – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="ru" dir="ltr">
<p><span>
</span>
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Состояние перевода:</strong> На этой странице представлен перевод статьи <a href="../en/Mkinitcpio.html" title="Mkinitcpio">mkinitcpio</a>. Дата последней синхронизации: 21 января 2022. Вы можете <a href="../ru/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (Русский)">помочь</a> синхронизировать перевод, если в английской версии произошли <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Mkinitcpio&amp;diff=0&amp;oldid=711806">изменения</a>.</div>
<div class="archwiki-template-meta-related-articles">
<p>Ссылки по теме</p>
<ul>
<li><a href="../en/Booster.html" title="Booster">Booster</a></li>
<li><a href="../en/General_troubleshooting.html#Boot_problems" class="mw-redirect" title="Boot debugging">Отладка загрузки</a></li>
<li><a href="../en/Dracut.html" title="Dracut">dracut</a></li>
<li><a href="../ru/Kernel_module.html" class="mw-redirect" title="Модули ядра">Модули ядра</a></li>
<li><a href="../en/Mkinitcpio/Minimal_initramfs.html" title="Mkinitcpio/Minimal initramfs">mkinitcpio/Minimal initramfs</a></li>
<li><a href="../ru/Systemd.html" title="Systemd (Русский)">systemd (Русский)</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://gitlab.archlinux.org/archlinux/mkinitcpio/mkinitcpio">mkinitcpio</a> — это bash-скрипт, используемый для создания <a href="https://en.wikipedia.org/wiki/ru:initrd" class="extiw" title="wikipedia:ru:initrd">начального загрузочного диска</a> системы. Из <span class="plainlinks archwiki-template-man" title="$ man 8 mkinitcpio"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mkinitcpio.8">mkinitcpio(8)</a></span> man page:
</p>
<dl><dd><i>The initial ramdisk is in essence a very small environment (early userspace) which loads various kernel modules and sets up necessary things before handing over control to init. This makes it possible to have, for example, encrypted root file systems and root file systems on a software RAID array. mkinitcpio allows for easy extension with custom hooks, has autodetection at runtime, and many other features.</i></dd></dl>
<p>Традиционно ядро отвечает за обнаружение всего оборудования и выполняет задачи на ранних этапах <a href="../ru/Arch_boot_process.html" title="Arch boot process (Русский)">процесса загрузки</a> до монтирования корневой файловой системы. Однако по мере развития технологий эти задачи становятся всё более сложными.
</p>
<p>В настоящее время корневая файловая система может быть на широком диапазоне аппаратных средств от SCSI до SATA и USB дисков, управляемых различными контроллерами от разных производителей. Кроме того корневая файловая система может быть зашифрована или сжата, находиться в RAID массиве или группе логических томов. Простой способ справиться с этой сложностью является передача управления в пользовательском пространстве: начальный загрузочный диск.
Смотрите также: <a rel="nofollow" class="external text" href="https://web.archive.org/web/20150906053013/http://archlinux.me/brain0/2010/02/13/early-userspace-in-arch-linux/">/dev/brain0 » Blog Archive » Early Userspace in Arch Linux</a>.
</p>
<p>mkinitcpio создан разработчиками Arch Linux и вкладами сообщества. Смотрите <a rel="nofollow" class="external text" href="https://gitlab.archlinux.org/archlinux/mkinitcpio/mkinitcpio">public Git repository</a>.
</p>
<meta property="mw:PageProp/toc">
<h2>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0"></span><span class="mw-headline" id="Установка">Установка</span>
</h2>
<p><a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установите">Установите</a> пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mkinitcpio">mkinitcpio</a></span>, который является зависимостью пакета <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span>, поэтому большинство пользователей уже установили его.
</p>
<p>Продвинутые пользователи могут захотеть установить последнюю версию mkinitcpio из Git с пакетом <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/mkinitcpio-git/">mkinitcpio-git</a></span><sup><small>AUR</small></sup>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> <b>Настоятельно</b> рекомендуется читать <a rel="nofollow" class="external text" href="https://lists.archlinux.org/mailman3/lists/arch-projects.lists.archlinux.org/">arch-projects mailing list</a> при использовании <i>mkinitcpio</i> из Git!</div>
<h2>
<span id=".D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D0.B5_.D0.B7.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BE.D1.87.D0.BD.D0.BE.D0.B3.D0.BE_.D0.BE.D0.B1.D1.80.D0.B0.D0.B7.D0.B0"></span><span class="mw-headline" id="Создание_загрузочного_образа">Создание загрузочного образа</span>
</h2>
<h3>
<span id=".D0.90.D0.B2.D1.82.D0.BE.D0.BC.D0.B0.D1.82.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B0.D1.8F_.D0.B3.D0.B5.D0.BD.D0.B5.D1.80.D0.B0.D1.86.D0.B8.D1.8F"></span><span class="mw-headline" id="Автоматическая_генерация">Автоматическая генерация</span>
</h3>
<p>Каждый раз, когда ядро устанавливается или обновляется, <a href="../ru/Pacman.html#%D0%A5%D1%83%D0%BA%D0%B8" title="Pacman (Русский)">pacman-хук</a> генерирует файл предустановки (<i>.preset</i>) и сохраняет его в <code>/etc/mkinitcpio.d/</code>. Например, для официального пакета <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span> создаётся файл <code>linux.preset</code>. Предустановка — это просто список информации, необходимой для создания начальных образов RAM-диска, вместо того, чтобы вручную указывать различные параметры и расположение выходных файлов.
По умолчанию mkinitcpio генерирует два образа после установки или обновления ядра:
</p>
<ol>
<li>
<i>default</i>, создаваемый в соответствии с директивами, указанными в <a href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0">настройках</a>, и</li>
<li>
<i>fallback</i>, который создается с точно таким же конфигурационным файлом за исключением хука <b>autodetect</b>, что позволяет включить в него все модули.</li>
</ol>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> <i>.preset</i> файлы используются для автоматической пересборки initramfs после обновления ядра. Будьте внимательны при их редактировании.</div>
<h3>
<span id=".D0.A0.D1.83.D1.87.D0.BD.D0.B0.D1.8F_.D0.B3.D0.B5.D0.BD.D0.B5.D1.80.D0.B0.D1.86.D0.B8.D1.8F"></span><span class="mw-headline" id="Ручная_генерация">Ручная генерация</span>
</h3>
<p>Чтобы запустить скрипт вручную, обратитесь к <span class="plainlinks archwiki-template-man" title="$ man 8 mkinitcpio"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mkinitcpio.8">mkinitcpio(8)</a></span> для чтения инструкций. В частности, чтобы (повторно) сгенерировать предустановку, предоставленную пакетом ядра, используйте параметр <code>-p</code>/<code>--preset</code> с именем нужной предустановки.
Для стандартного ядра Arch Linux, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span>:
</p>
<pre># mkinitcpio -p linux
</pre>
<p>Чтобы (повторно) сгенерировать все существующие предустановки, используйте параметр <code>-P</code>/<code>--allpresets</code>. Обычно это используется для регенерации всех образов initramfs после изменения глобальных <a href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0">настроек</a>:
</p>
<pre># mkinitcpio -P
</pre>
<p>Параметр <code>-p</code> (сокращение от <i>preset</i>) указывает на использование preset файла из <code>/etc/mkinitcpio.d</code> (т.е. <code>/etc/mkinitcpio.d/linux.preset</code> для <code>linux</code>). preset файл определяет параметры сборки initramfs образа вместо указания файла конфигурации и выходной файл каждый раз.
</p>
<p>Можно создать любое количество initramfs с различными конфигурациями. Необходимый initramfs должен быть прописан в <a href="../ru/Arch_boot_process.html#%D0%97%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D1%87%D0%B8%D0%BA" title="Arch boot process (Русский)">конфигурационном файле загрузчика</a>.
</p>
<h3>
<span id=".D0.92.D0.B0.D1.80.D0.B8.D0.B0.D0.BD.D1.82.D1.8B_.D1.81.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D1.8F_initcpio"></span><span class="mw-headline" id="Варианты_создания_initcpio">Варианты создания initcpio</span>
</h3>
<p>Пользователи могут вручную создать образ с помощью альтернативного конфигурационного файла. Например, следующее будет генерировать initramfs образ в соответствии с <code>/etc/mkinitcpio-custom.conf</code> и сохранит его в <code>/boot/linux-custom.img</code>.
</p>
<pre># mkinitcpio --config /etc/mkinitcpio-custom.conf --generate /boot/initramfs-custom.img
</pre>
<p>Если необходимо создать образ с ядром отличным от загруженного, добавьте параметр с версией ядра. Доступные версии ядер можно посмотреть в <code>/usr/lib/modules</code>, синтаксис соответствует выводу <code>uname -r</code> для каждого ядра.
</p>
<pre># mkinitcpio --generate /boot/initramfs-custom2.img --kernel 5.7.12-arch1-1
</pre>
<h3><span class="mw-headline" id="Unified_kernel_images">Unified kernel images</span></h3>
<p>С версии 31 <i>mkinitcpio</i> также может генерировать <a href="../en/Unified_kernel_image.html" title="Unified kernel image">unified kernel image</a>.
</p>
<h2>
<span id=".D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0"></span><span class="mw-headline" id="Настройка">Настройка</span>
</h2>
<p><code>/etc/mkinitcpio.conf</code> - основной конфигурационный файл <b>mkinitcpio</b>. Кроме того, в каталоге <code>/etc/mkinitcpio.d</code> располагаются preset файлы (e.g. <code>/etc/mkinitcpio.d/linux.preset</code>).
</p>
<p>Можно изменять шесть переменных в конфигурационном файле:
</p>
<dl>
<dt><code>MODULES</code></dt>
<dd>Модули ядра, которые будут загружены до выполнения хуков.</dd>
<dt><code>BINARIES</code></dt>
<dd>Дополнительные исполняемые файлы, которые необходимо включить в initramfs.</dd>
<dt><code>FILES</code></dt>
<dd>Дополнительные файлы, которые необходимо включить в initramfs.</dd>
<dt><code>HOOKS</code></dt>
<dd>Hooks - скрипты, выполняемые в initramfs.</dd>
<dt><code>COMPRESSION</code></dt>
<dd>Тип используемого сжатия initramfs.</dd>
<dt><code>COMPRESSION_OPTIONS</code></dt>
<dd>Дополнительные опции архиваторов. Использование этого параметра не рекомендуется. mkinitcpio будет обрабатывать особые требования к архиваторам (например <code>--check=crc32</code> для xz), что может привести к невозможности запуска системы.</dd>
</dl>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> 
<ul>
<li>Некоторые хуки, которые могут быть нужны для вашей системы, вроде <b>lvm2</b>, <b>mdadm</b>, и <b>encrypt</b>, <b>НЕ</b> включены по умолчанию. Смотрите раздел <a href="#HOOKS">#HOOKS</a>, чтобы узнать, как их включить и настроить.</li>
<li>Если у вас более одного контроллера дисков, использующих одно пространство имён устройств (например, 2 SCSI/SATA или IDE контроллера), и они требуют разных модулей, используйте <a href="../ru/Persistent_block_device_naming.html" class="mw-redirect" title="Постоянные имена для блочных устройств">постоянные имена для блочных устройств</a>, чтобы быть уверенным, что вы смонтировали действительно то, что хотели. Без этого устройства могут поменяться местами и вы получите kernel panic при загрузке.</li>
</ul>
</div>
<h3><span class="mw-headline" id="MODULES">MODULES</span></h3>
<p>Указывает какие модули ядра должны быть загружены прежде чем что-либо будет сделано.
</p>
<p>Для модулей с суффиксом <code>?</code> не будет выводиться ошибка, если они не будут найдены. Это может быть полезно для пользовательских ядер.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> 
<ul>
<li>При использовании <b>reiser4</b> обязательно добавьте его в массив <code>MODULES</code>.</li>
<li>При использовании хука <b>encrypt</b> или <b>sd-encrypt</b> модули клавиатуры и/или файловых систем, необходимые для разблокировки устройства LUKS во время загрузки системы, нужно добавить в массив <code>MODULES</code>, когда целевая система отличается от той, которая использовалась для запуска <i>mkinitcpio</i>. Например, если вы используете keyfile в файловой системе ext2, но во время запуска mkinitcpio файловая система ext2 не смонтирована, добавьте <code>ext2</code>. Подробнее смотрите <a href="../en/Dm-crypt/System_configuration.html#cryptkey" title="Dm-crypt/System configuration">dm-crypt/System configuration#cryptkey</a>.</li>
<li>Если клавиатура подключена через USB3-хаб и вы хотите использовать её для разблокировки LUKS устройства, добавьте <code>usbhid xhci_hcd</code>.</li>
<li>При использовании дисплеев, подключенных к док-станции, вам может потребоваться добавить модуль для вашей видеокарты, чтобы сделать вывод initrd видимым (например <code>i915</code> для большинства карт Intel).</li>
</ul>
</div>
<h3>
<span id="BINARIES_.D0.B8_FILES"></span><span class="mw-headline" id="BINARIES_и_FILES">BINARIES и FILES</span>
</h3>
<p>Указывают какие файлы необходимо добавить в initramfs. <code>BINARIES</code> и <code>FILES</code> будут добавлены до запуска хуков и использоваться для переопределения файлов использаемых хуками. <code>BINARIES</code> - бинарные файлы из <code>PATH</code>, необходимые для работы библиотеки будут автоматически добавлены. <code>FILES</code> добавляет файлы как есть. Например:
</p>
<pre>FILES=(/etc/modprobe.d/modprobe.conf)
</pre>
<pre>BINARIES=(kexec)
</pre>
<p>И <code>BINARIES</code>, и <code>FILES</code> являются <a href="../ru/Bash.html" title="Bash (Русский)">bash</a>-массивами, в них можно добавить несколько файлов с пробелом в качестве разделителя.
</p>
<h3><span class="mw-headline" id="HOOKS">HOOKS</span></h3>
<p>Параметр <code>HOOKS</code> наиболее важный в файле настроек. Хуки - это небольшие скрипты, которые описывают что будет добавлено к образу, а также дополнительные действия, выполняемые при загрузке системы. Хуки указываются по имени и выполняются по порядку.
</p>
<p>Значение по умолчанию для <code>HOOKS</code> должно быть достаточным для большинства простых установок с одним диском. Для корневых устройств, которые являются многоуровневыми или многоблочными устройствами, такими как <a href="../en/LVM.html" title="LVM">LVM</a>, <a href="../en/LVM_on_software_RAID.html" class="mw-redirect" title="Software RAID and LVM">mdadm</a> или <a href="../en/Dm-crypt.html" title="Dm-crypt">dm-crypt</a>, см. cоответствующие страницы вики для дальнейшей необходимой конфигурации.
</p>
<h4><span class="mw-headline" id="Build_hooks">Build hooks</span></h4>
<p>Build hooks - хуки сборки. Располагаются в <code>/usr/lib/initcpio/install/</code>; пользовательские хуки можно добавить в <code>/etc/initcpio/install/</code>. Эти файлы используются mkinitcpio во время сборки initramfs. Должны содержать две функции: <code>build</code> и <code>help</code>. Функция <code>build</code> перечисляет модули, файлы, исполняемые файлы, которые добавляются в образ. Функция <code>help</code> содержит описание действий хука.
</p>
<p>Для получения списка всех доступных хуков:
</p>
<pre>$ mkinitcpio -L
</pre>
<p>Используйте опцию <code>-H</code>/<code>--hookhelp</code> для вывода информации о конкретном хуке:
</p>
<pre>$ mkinitcpio -H udev
</pre>
<h4><span class="mw-headline" id="Runtime_hooks">Runtime hooks</span></h4>
<p>Runtime hooks - хуки времени выполнения. Располагаются в <code>/usr/lib/initcpio/hooks/</code>, пользовательские хуки могут быть помещены в <code>/etc/initcpio/hooks/</code>. Для любого runtime-хука всегда должен быть build-хук с тем же именем, в котором имеется вызов <code>add_runscript</code>, указывающий на добавление runtime-хука в образ. Эти файлы обрабатываются командным интерпретатором ash из busybox во время early userspace. Они запускаются по порядку записи в <code>HOOKS</code> за исключением хуков очистки. Runtime хуки могут содержать несколько функций:
</p>
<p><code>run_earlyhook</code>: Функции с таким именем будут запускаться один раз после установки API файловых систем и обработки командной строки ядра. Как правило, здесь запускаются дополнительные демоны, такие как udev, необходимые для раннего процесса загрузки.
</p>
<p><code>run_hook</code>: Функции с таким именем запускаются вскоре после ранних хуков. Это наиболее распространенная точка хуков, и здесь должны выполняться операции, такие как сборка многоуровневых блочных устройств.
</p>
<p><code>run_latehook</code>: Функции c этим именем запускаются после того, как была примонтирована корневая файловая система. Это следует использовать, умеренно, для дальнейшей настройки корневой ФС или для монтирования других файловых систем, таких как <code>/usr</code>.
</p>
<p><code>run_cleanuphook</code>: Функции с этим именем запускаются как можно позже, и в порядке обратном, порядку их перечисления в <code>HOOKS</code> файла конфигурации. Эти хуки должны использоваться для любой очистки в последнюю минуту, например, для закрытия всех демонов, запущенных ранними хуками.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Runtime-хуки используются только в busybox init. Хук <b>systemd</b> запускает инициализацию на основе systemd, который вместо runtime-хуков использует юниты systemd.</div>
<h4>
<span id=".D0.94.D0.BE.D1.81.D1.82.D1.83.D0.BF.D0.BD.D1.8B.D0.B5_.D1.85.D1.83.D0.BA.D0.B8"></span><span class="mw-headline" id="Доступные_хуки">Доступные хуки</span>
</h4>
<p>Таблица стандартных хуков и как они влияют на создание и выполнение образа. Обратите внимание, что эта таблица не является полной, так как пакеты могут предоставлять свои хуки.
</p>
<table class="wikitable">
<tbody>
<tr>
<th>busybox init</th>
<th>systemd init</th>
<th><a href="#Build_hooks">Build hook</a></th>
<th>
<a href="#Runtime_hooks">Runtime hook</a>
</th>
</tr>
<tr>
<td colspan="2" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>base</b></td>
<td>Устанавливает все начальные каталоги, базовые утилиты и библиотеки. Всегда ставьте этот хук первым, за исключением случаев, когда вы действительно знаете, что делаете, если не используется хук <b>systemd</b>.
<p>Предоставляет busybox recovery shell при использовании совместно с хуком <b>systemd</b>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Командная оболочка восстановления недоступна, так как аккаунт root в initramfs <a rel="nofollow" class="external text" href="https://gitlab.archlinux.org/archlinux/packaging/packages/systemd/-/commit/292cdf8a2f7dd7c6c7d91d2b59617391935c837c">заблокирован</a>. Смотрите <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/70408">FS#70408</a>.</div>
</td>
<td data-sort-value="5" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;">–
</td>
</tr>
<tr>
<td style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>udev</b></td>
<td rowspan="3" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>systemd</b></td>
<td>Добавляет udev, udevadm и небольшое подмножество правил udev в образ.</td>
<td>Udev автоматически создает файл устройства для корня и загружает необходимые модули для его работы. Рекомендуется использовать.
</td>
</tr>
<tr>
<td style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>usr</b></td>
<td>Добавляет поддержку отделного <code>/usr</code> раздела. Подробнее: <a href="#/usr_%D0%BD%D0%B0_%D0%BE%D1%82%D0%B4%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D0%BC_%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB%D0%B5">#/usr на отдельном разделе</a>
</td>
<td>Монтирует раздел <code>/usr</code> после монтирования корневой файловой системы.
</td>
</tr>

<tr>
<td style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>resume</b></td>
<td data-sort-value="5" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;">–</td>
<td>Необходим для работы спящего режима (suspend to disk). Смотрите <a href="../ru/Power_management/Suspend_and_hibernate.html" class="mw-redirect" title="Ждущий и спящий режимы">Ждущий и спящий режимы</a>.
</td>
</tr>
<tr>
<td style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>btrfs</b></td>
<td style="background: #ddd; color: inherit; vertical-align: middle; text-align: center;">--</td>
<td>Sets the required modules to enable <a href="../en/Btrfs.html" title="Btrfs">Btrfs</a> for using multiple devices with Btrfs. This hook is not required for using Btrfs on a single device.</td>
<td>Runs <code>btrfs device scan</code> to assemble a multi-device Btrfs root file system when <b>udev</b> hook or <b>systemd</b> hook is not present. The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=btrfs-progs">btrfs-progs</a></span> package is required for this hook.
</td>
</tr>
<tr>
<td colspan="2" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>autodetect</b></td>
<td>Уменьшает размер initramfs, пытаясь определить, какие модули вам нужны, сканируя sysfs. Проверьте список модулей, которые он добавил. Он должен запускаться раньше других подсистем. Все обработчики, выполняемые до него, будут включать все модули.</td>
<td data-sort-value="5" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;">–
</td>
</tr>
<tr>
<td colspan="2" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>modconf</b></td>
<td>Добавляет конфигурационные файлы modprobe из <code>/etc/modprobe.d/</code> и <code>/usr/lib/modprobe.d/</code>
</td>
<td data-sort-value="5" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;">–
</td>
</tr>
<tr>
<td colspan="2" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>block</b></td>
<td>Добавляет все модули блочных устройств, ранее предоставляемые другими хуками (<i>fw</i>, <i>mmc</i>, <i>pata</i>, <i>sata</i>, <i>scsi</i>, <i>usb</i>, <i>virtio</i>).</td>
<td data-sort-value="5" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;">–
</td>
</tr>
<tr>
<td style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>net</b></td>
<td style="background: #ddd; color: inherit; vertical-align: middle; text-align: center;"><i>не реализован</i></td>
<td>Добавляет поддержку сети. Установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mkinitcpio-nfs-utils">mkinitcpio-nfs-utils</a></span> для использования этого хука. Подробнее: <a href="#%D0%9F%D1%80%D0%B8_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B8_net">#При использовании net</a>
</td>
<td>Требуется для корневой файловой системы через NFS.
</td>
</tr>
<tr>
<td style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>dmraid</b></td>
<td style="background: #ddd; color: inherit; vertical-align: middle; text-align: center;"><i>?</i></td>
<td>Поддержка корневой файловой системы на fakeRAID массивах. Необходимо установить пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dmraid">dmraid</a></span>. Обратите внимание, что необходимо использовать <code>mdadm</code> с хуком <b>mdadm_udev</b> с fakeRAID если ваш контроллер поддерживает это. Подробнее: <a href="#%D0%9F%D1%80%D0%B8_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B8_RAID">#При использовании RAID</a>
</td>
<td>Находит и монтирует fakeRAID блочные устройства, используя <code>dmraid</code>.
</td>
</tr>
<tr>
<td colspan="2" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>mdadm_udev</b></td>
<td>Обеспечивает поддержку для сборки RAID массивов с помощью udev. Необходимо установить пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mdadm">mdadm</a></span>. Если вы используете этот хук с массивом FakeRAID, рекомендуется включить <code>mdmon</code> в секции <code>BINARIES</code>. Подробнее: <a href="#%D0%9F%D1%80%D0%B8_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B8_RAID">#При использовании RAID</a>
</td>
<td data-sort-value="5" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;">–
</td>
</tr>
<tr>
<td colspan="2" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>keyboard</b></td>
<td>Добавляет модули, необходимые для работы клавиатур. Используйте этот хук, если необходимо использовать USB-клавиатуру на ранней стадии загрузки (для ввода пароля от заширфованных данных или для работы в командной оболочке). В качестве побочного эффекта также могут быть добавлены модули для некоторых устройств ввода без клавиатуры, но на это не следует полагаться. Заменяет старый хук <i>usbinput</i>.
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Для систем, которые загружаются с различными конфигурациями оборудования (например, ноутбуки с внешней клавиатурой или внутренней клавиатурой или <a href="https://en.wikipedia.org/wiki/Headless_computer" class="extiw" title="wikipedia:Headless computer">headless-системы</a>), этот хук необходимо поместить перед <b>autodetect</b>, чтобы иметь возможность использовать клавиатуру во время загрузки, например, чтобы разблокировать зашифрованное устройство при использовании хука <code>encrypt</code>.</div>
</td>
<td data-sort-value="5" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;">–
</td>
</tr>
<tr>
<td style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>keymap</b></td>
<td rowspan="2" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>sd-vconsole</b></td>
<td>Добавляет в initramfs раскладки, указанные в <code>/etc/vconsole.conf</code>. При использовании <a href="../en/Dm-crypt/Encrypting_an_entire_system.html" title="Dm-crypt/Encrypting an entire system">шифрования системы</a> добавляйте его перед хуком <code>encrypt</code>.</td>
<td>Загружает раскладки, указанные в <code>/etc/vconsole.conf</code>.
</td>
</tr>
<tr>
<td style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>consolefont</b></td>
<td>Добавляет в initramfs <a href="../ru/Linux_console.html#%D0%9F%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%BD%D1%8B%D0%B5_%D0%B8%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F" title="Linux console (Русский)">консольный шрифт</a>, указанный в <code>/etc/vconsole.conf</code>.</td>
<td>Загружает шрифт, указанный в <code>/etc/vconsole.conf</code>.
</td>
</tr>
<tr>
<td style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>encrypt</b></td>
<td style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>sd-encrypt</b></td>
<td>Добавлет модуль ядра <code>dm_crypt</code> и <code>cryptsetup</code>. Требуется пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=cryptsetup">cryptsetup</a></span>.
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Обратите внимание на замечания для хука <i>keyboard</i> выше для разблокировки зашифрованного устройства во время загрузки, а также примечания о файловых системах в <a href="#MODULES">#MODULES</a>, если вы используете файл для разблокировки.</div>
</td>
<td>Определяет и подключает зашифрованый корневой раздел. Смотрите <a href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_%D0%B2%D0%BE_%D0%B2%D1%80%D0%B5%D0%BC%D1%8F_%D0%B2%D1%8B%D0%BF%D0%BE%D0%BB%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F">#Настройка во время выполнения</a> для дальнейшей настройки.
<p>Для <b>sd-encrypt</b> смотрите <a href="../en/Dm-crypt/System_configuration.html#Using_systemd-cryptsetup-generator" title="Dm-crypt/System configuration">dm-crypt/System configuration#Using systemd-cryptsetup-generator</a>.
</p>
</td>
</tr>
<tr>
<td colspan="2" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>lvm2</b></td>
<td>Добавляет поддержку <code>lvm</code>. Требует установленного пакета <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lvm2">lvm2</a></span>. Необходим, если корневая файловая система на <a href="../en/LVM.html" title="LVM">LVM</a>.</td>
<td data-sort-value="5" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;">–
</td>
</tr>
<tr>
<td colspan="2" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>fsck</b></td>
<td>Добавляет исполняемый файл fsck и необходимые обработчики файловых систем для проверки корневой файловой системы (и <code>/usr</code>, если он на отдельном разделе) перед монтированием. Если стоит после хука <b>autodetect</b>, то будут добавлены только обработчики для вашей корневой файловой системы. Использование этого хука настоятельно рекомендуется и <b>обязательно</b> с отдельным <code>/usr</code> разделом. При включении этого хука крайне рекомендуется также включить все необходимые модули для обеспечения работы вашей клавиатуры в early userspace. <br>Использование этого хука требует, чтобы rw передавался в <a href="../ru/Kernel_parameters.html" title="Kernel parameters (Русский)">командной строке ядра</a> (<a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?pid=1307895#p1307895">обсуждение</a>). Смотрите <a href="../ru/Fsck.html#%D0%9F%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0_%D0%BF%D1%80%D0%B8_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B5" title="Fsck (Русский)">fsck (Русский)#Проверка при загрузке</a> для подробностей.</td>
<td data-sort-value="5" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;">–
</td>
</tr>
<tr>
<td colspan="2" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;"><b>filesystems</b></td>
<td>Включает в образ модули необходимых файловых систем. Этот хук <b>обязателен</b>, если Вы не указываете модули файловых систем в  MODULES.</td>
<td data-sort-value="5" style="background: inherit; color: inherit; vertical-align: middle; text-align: center;">–
</td>
</tr>
</tbody>
</table>
<h3><span class="mw-headline" id="COMPRESSION">COMPRESSION</span></h3>
<p>Ядро поддерживает несколько форматов для сжатия initramfs - <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gzip">gzip</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bzip2">bzip2</a></span>, lzma, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xz">xz</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lzo">lzo</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lz4">lz4</a></span> и <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=zstd">zstd</a></span>. По умолчанию mkinitcpio использует zstd; имейте в виду, что сжатие zstd работает в многопоточном режиме (с опцией <code>-T0</code>, которая запускает столько же потоков, сколько ядер в процессоре).
</p>
<p>Стандартный <code>mkinitcpio.conf</code> имеет различные закомментированные варианты <code>COMPRESSION</code>. Раскомментируйте один, чтобы выбрать необходимый формат сжатия. Чтобы создать несжатый образ, укажите <code>COMPRESSION=<b>cat</b></code> в конфигурации или используйте <code>-z cat</code> в командной строке.
</p>
<p>Убедитесь, что для метода, который вы хотите использовать, установлена ​​правильная утилита сжатия файлов.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> Со степенью сжатия около 2.5 на образе в режиме высокого сжатия (<code>-9</code>) lz4 обеспечивает самую быструю скорость распаковки за счет более медленного однопоточного сжатия. Немного лучшее сжатие даёт lzo, который при этом всё ещё довольно быстро распаковывается. zstd предлагает универсальное решение с многопоточным сжатием и широким диапазоном уровней сжатия с помощью своих опций — смотрите <span class="plainlinks archwiki-template-man" title="$ man 1 zstd"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/zstd.1#Operation_modifiers">zstd(1) § Operation modifiers</a></span>. xz достигает наименьшего размера с коэффициентом уменьшения около 5 в предустановке высокой степени сжатия (<code>-9</code>) за счёт гораздо более низкой скорости распаковки.</div>
<h3><span class="mw-headline" id="COMPRESSION_OPTIONS">COMPRESSION_OPTIONS</span></h3>
<p>Это дополнительные флаги, переданные программе, указанной <code> COMPRESSION</code>, например:
</p>
<pre>COMPRESSION_OPTIONS=(-9)
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Эту опцию можно не трогать: <i>mkinitcpio</i> сам позаботится о том, чтобы любой поддерживаемый метод сжатия имел необходимые флаги для создания рабочего образа. Кроме того, неправильное использование этого параметра может привести к <b>незагружаемой системе</b>, если ядро не сможет распаковать результирующий архив.</div>
<h2>
<span id=".D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_.D0.B2.D0.BE_.D0.B2.D1.80.D0.B5.D0.BC.D1.8F_.D0.B2.D1.8B.D0.BF.D0.BE.D0.BB.D0.BD.D0.B5.D0.BD.D0.B8.D1.8F"></span><span class="mw-headline" id="Настройка_во_время_выполнения">Настройка во время выполнения</span>
</h2>
<p>Настройки среды выполнения могут быть переданы в <code>init</code> и некоторые хуки через параметры ядра, которые обычно задаются в загрузчике. Приведённые ниже параметры могут быть добавлены в командную строку ядра для изменения поведения по умолчанию. Подробности смотрите в статьях <a href="../ru/Kernel_parameters.html" class="mw-redirect" title="Параметры ядра">Параметры ядра</a> и <a href="../ru/Arch_boot_process.html" class="mw-redirect" title="Процесс загрузки Arch">Процесс загрузки Arch</a>.
</p>
<h3><span class="mw-headline" id="init_from_base_hook">init from base hook</span></h3>
<dl>
<dt><code>root</code></dt>
<dd>Это самый важный параметр, указываемый в командной строке ядра, поскольку он определяет, какое устройство будет смонтировано как корневая ФС. <i>mkinitcpio</i> поддерживает большой набор форматов, например: <pre>root=/dev/sda1                                                # /dev node
root=LABEL=CorsairF80                                         # метка
root=UUID=ea1c4959-406c-45d0-a144-912f4e86b207                # UUID
root=PARTUUID=14420948-2cea-4de7-b042-40f67c618660            # GPT UUID раздела</pre> <div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Следующие параметры загрузки изменяют поведение <code>init</code> по умолчанию в среде initramfs. Подробнее смотрите <code>/usr/lib/initcpio/init</code>. Они не будут работать при использовании хука <code>systemd</code>, так как он заменит <code>init</code> из хука <code>base</code>.</div>
</dd>
</dl>
<dl>
<dt><code>break</code></dt>
<dd>Если указан <code>break</code> или <code>break=premount</code>, <code>init</code> приостановит процесс загрузки (после загрузки хуков, но перед монтированием корневой ФС) и запустит интерактивную оболочку, которую можно использовать для устранения неполадок. Эту оболочку можно запустить после монтирования корневой ФС, указав <code>break=postmount</code>. После выхода из оболочки продолжится обычная загрузка.</dd>
</dl>
<dl>
<dt><code>disablehooks</code></dt>
<dd>Отключает runtime-хуки, перечисленные через запятую <code>disablehooks=хук1[,хук2,...]</code>. Например: <pre>disablehooks=resume</pre>
</dd>
</dl>
<dl>
<dt><code>earlymodules</code></dt>
<dd>Изменяет порядок загрузки модулей, загружая указанные здесь модули раньше остальных: <code>earlymodules=модуль1[,модуль2,...]</code>. (Это может использоваться, например, для обеспечения правильного порядка нескольких сетевых интерфейсов.)</dd>
</dl>
<p>Смотрите <a href="../ru/General_troubleshooting.html#%D0%9F%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B8" class="mw-redirect" title="Устранение часто встречающихся неполадок">Устранение часто встречающихся неполадок#Проблемы загрузки</a> и <span class="plainlinks archwiki-template-man" title="$ man 8 mkinitcpio"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mkinitcpio.8">mkinitcpio(8)</a></span> для более подробной информации.
</p>
<h3>
<span id=".D0.9F.D1.80.D0.B8_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B8_RAID"></span><span class="mw-headline" id="При_использовании_RAID">При использовании RAID</span>
</h3>
<p>Смотрите <a href="../en/RAID.html#Configure_mkinitcpio" title="RAID">RAID#Configure mkinitcpio</a>.
</p>
<h3>
<span id=".D0.9F.D1.80.D0.B8_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B8_net"></span><span class="mw-headline" id="При_использовании_net">При использовании net</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> NFSv4 ещё не поддерживается <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/28287">FS#28287</a>.</div>
<p><b>Требуемые пакеты</b>
</p>
<p>Хук <code>net</code> требует пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mkinitcpio-nfs-utils">mkinitcpio-nfs-utils</a></span>.
</p>
<p><b>Параметры ядра</b>
</p>
<p>Полную и актуальную информацию можно найти в официальной <a rel="nofollow" class="external text" href="https://docs.kernel.org/admin-guide/nfs/nfsroot.html">документации ядра</a>.
</p>
<p><b>ip=</b>
</p>
<p>Этот параметр сообщает ядру, как настраивать IP-адреса устройств и таблицу маршрутизации. Может принимать до девяти аргументов, разделённых двоеточиями:
</p>
<p><code>ip=&lt;client-ip&gt;:&lt;server-ip&gt;:&lt;gw-ip&gt;:&lt;netmask&gt;:&lt;hostname&gt;:&lt;device&gt;:&lt;autoconf&gt;:&lt;dns0-ip&gt;:&lt;dns1-ip&gt;:&lt;ntp0-ip&gt;</code>.
</p>
<p>Если этот параметр не указан, все поля считаются пустыми и используются значения по умолчанию, описанные в <a rel="nofollow" class="external text" href="https://docs.kernel.org/admin-guide/nfs/nfsroot.html">документации ядра</a>. В целом это подразумевает, что ядро пытается настроить всё с помощью автоконфигурации.
</p>
<p>Можно указать <code>&lt;autoconf&gt;</code> в одиночку как значение параметра <code>ip</code> (без всех двоеточий перед ним). Значение <code>ip=off</code> или <code>ip=none</code> отключает автоконфигурацию. Чаще всего используется <code>ip=dhcp</code>.
</p>
<p><i>Разъяснение параметров:</i>
</p>
<pre> &lt;client-ip&gt;   IP адрес клиента. Если пустой, то автоматически назначается
               протоколом RARP/BOOTP/DHCP. Какой протокол используется
               зависит от параметра &lt;autoconf&gt;. Если его значение не пустое,
               то autocnf работает корректно.
 
 &lt;server-ip&gt;   IP адрес NFS сервера. Если используется RARP для определения
               адреса клиента и этот параметр не пуст, то принимаются ответы
               только от указанного сервера.
               Для использования разных RARP и NFS серверов,
               укажите ваш RARP сервер здесь (или оставьте пустым), и
               укажите ваш NFS сервер в параметре `nfsroot'
               (см. выше). Если тут пусто, будет использован сервер, ответивший
               на RARP/BOOTP/DHCP запрос.
 
 &lt;gw-ip&gt;       IP адрес шлюза если сервер в другой подсети. Если тут пусто,
               предполагается, что сервер находится в одной подсети, если значение
               не получено по BOOTP/DHCP.
 
 &lt;netmask&gt;     Маска подсети для локального интерфейса. Если тут пусто,
               используется маска по умолчанию в зависимости от класса IP,
               если конечно не переопределена значением из BOOTP/DHCP ответа.
 
 &lt;hostname&gt;    Имя машины клиента. Если пусто, используется IP адрес в виде ASCII
               строки, или значение полученное по BOOTP/DHCP.
 
 &lt;device&gt;      Имя сетевого устройства. Если тут пусто, все устройства будут использованы
               для RARP/BOOTP/DHCP запросов, и все настройки будут получены из первого
               пришедшего ответа. Если вы имеете только одно сетевое устройство, можно спокойно
               оставить поле пустым.
 
 &lt;autoconf&gt;	Какой метод использовать для автонастройки: 'rarp', 'bootp', или 'dhcp'.
               Если значение 'both', 'all' или пусто, все протоколы будут использованы.
               'off', 'static' или 'none' означают запрет автонастройки.
 
 &lt;dns0-ip&gt;     IP-адрес основного DNS-сервера. Определяется автоматически при включенном autoconf.
               Значение доступно в /proc/net/pnp с префиксом "nameserver ".
 
 &lt;dns1-ip&gt;     IP-адрес запасного DNS-сервера, аналогично &lt;dns0-ip&gt;.
 
 &lt;ntp0-ip&gt;     IP-адрес NTP-сервера. Определяется автоматически при включенном autoconf.
               Значение доступно в /proc/net/ipconfig/ntp_servers, ядром не используется.
</pre>
<p>Полное объяснение параметров можно почитать в <a rel="nofollow" class="external text" href="https://docs.kernel.org/admin-guide/nfs/nfsroot.html">документации ядра</a> (на английском).
</p>
<p><i>Примеры:</i>
</p>
<pre> ip=127.0.0.1:::::lo:none  --&gt; Разрешить lo интерфейс.
 ip=192.168.1.1:::::eth2:none --&gt; Статический eth2 интерфейс.
 ip=:::::eth0:dhcp --&gt; Разрешить dhcp протокол для настройки интерфейса eth0.
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Используйте имена устройств ядра (например, <code>eth0</code>) для параметра <code>&lt;device&gt;</code>; постоянные имена (например, <code>enp2s0</code>) не будут работать. Подробнее смотрите <a href="../ru/Network_configuration.html#%D0%A1%D0%B5%D1%82%D0%B5%D0%B2%D1%8B%D0%B5_%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D1%8B" class="mw-redirect" title="Настройка сети">Настройка сети#Сетевые интерфейсы</a>.</div>
<p><b>BOOTIF=</b>
</p>
<p>Если у вас несколько сетевых карт, в этом параметре можно указать MAC-адрес интерфейса, с которого вы загружаетесь. Это часто бывает полезно, так как нумерация интерфейсов может измениться, или в сочетании с опцией pxelinux IPAPPEND 2 или IPAPPEND 3. Если не указан, будет использоваться <code>eth0</code>.
</p>
<p>Пример
</p>
<pre>BOOTIF=01-A1-B2-C3-D4-E5-F6  # Обратите внимание на ведущий "01-" и верхний регистр.
</pre>
<p><b>nfsroot=</b>
</p>
<p>Если параметр 'nfsroot' НЕ передан, будет использовано значение по умолчанию "/tftpboot/%s".
</p>
<pre> nfsroot=[&lt;server-ip&gt;:]&lt;root-dir&gt;[,&lt;nfs-options&gt;]
</pre>
<p><i>Описание параметров:</i>
</p>
<pre> &lt;server-ip&gt;   IP адрес NFS сервера. Если параметр отсутствует
               адрес по умолчанию определяется по переменной
               `ip' (см. ниже). Одно из применений этого параметра -
               использование разных серверов для 
               RARP и NFS. Обычно можете оставить этот параметр пустым.
 
 &lt;root-dir&gt;    Путь к директории, которая будет корневой на клиенте. Если тут
               написано "%s", то оно будет заменено на ASCII представление IP
               клиента.
 
 &lt;nfs-options&gt; Стандартные опции NFS. Все опции разделены запятыми.
               Если опция отсутствует будут использованы следующие значения по умолчанию:
                       port            = как скажет portmap демон на сервере
                       rsize           = 1024
                       wsize           = 1024
                       timeo           = 7
                       retrans         = 3
                       acregmin        = 3
                       acregmax        = 60
                       acdirmin        = 30
                       acdirmax        = 60
                       flags           = hard, nointr, noposix, cto, ac
</pre>
<p>Полное описание параметров можно почитать в <code>mkinitcpio -H net</code> (на английском).
</p>
<h3>
<span id=".D0.9F.D1.80.D0.B8_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B8_lvm"></span><span class="mw-headline" id="При_использовании_lvm">При использовании lvm</span>
</h3>
<p>Если ваш корень находится на <a href="../en/LVM.html" title="LVM">LVM</a>, смотрите <a href="../en/Install_Arch_Linux_on_LVM.html#Adding_mkinitcpio_hooks" title="Install Arch Linux on LVM">Install Arch Linux on LVM#Adding mkinitcpio hooks</a>.
</p>
<h3>
<span id=".D0.9F.D1.80.D0.B8_.D0.B7.D0.B0.D1.88.D0.B8.D1.84.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.BD.D0.BE.D0.BC_.D0.BA.D0.BE.D1.80.D0.BD.D0.B5.D0.B2.D0.BE.D0.BC_.D1.80.D0.B0.D0.B7.D0.B4.D0.B5.D0.BB.D0.B5"></span><span class="mw-headline" id="При_зашифрованном_корневом_разделе">При зашифрованном корневом разделе</span>
</h3>
<p>Если у вас <a href="../en/Dm-crypt/Encrypting_an_entire_system.html" title="Dm-crypt/Encrypting an entire system">зашифрованный корень</a>, смотрите <a href="../en/Dm-crypt/System_configuration.html#mkinitcpio" title="Dm-crypt/System configuration">dm-crypt/System configuration#mkinitcpio</a> для информации о том, какие хуки нужно добавлять.
</p>
<h3>
<span id=".2Fusr_.D0.BD.D0.B0_.D0.BE.D1.82.D0.B4.D0.B5.D0.BB.D1.8C.D0.BD.D0.BE.D0.BC_.D1.80.D0.B0.D0.B7.D0.B4.D0.B5.D0.BB.D0.B5"></span><span class="mw-headline" id="/usr_на_отдельном_разделе">/usr на отдельном разделе</span>
</h3>
<p>Если у вас <code>/usr</code> на отдельном разделе, вы должны соблюдать следующие требования:
</p>
<ul>
<li>Добавьте хук <code>fsck</code>, а в файле <code>/etc/fstab</code> укажите для <code>passno</code> значение <code>2</code>, чтобы запускалась проверка этого раздела при загрузке системы. Без этого хука <code>/usr</code> проверяться не будет.</li>
<li>Если не используется хук systemd, добавьте хук <code>usr</code>, который будет монтировать раздел <code>/usr</code> после монтирования корневой ФС.</li>
</ul>
<h2>
<span id=".D0.A0.D0.B5.D1.88.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC"></span><span class="mw-headline" id="Решение_проблем">Решение проблем</span>
</h2>
<h3>
<span id=".D0.A0.D0.B0.D1.81.D0.BF.D0.B0.D0.BA.D0.BE.D0.B2.D0.BA.D0.B0_.D0.BE.D0.B1.D1.80.D0.B0.D0.B7.D0.B0"></span><span class="mw-headline" id="Распаковка_образа">Распаковка образа</span>
</h3>
<p>Если вам интересно посмотреть, что находится внутри образа initramfs, вы можете распаковать его.
</p>
<p>Образ initramfs является архивом SVR4 CPIO, созданным с помощью команд <code>find</code> и <code>bsdcpio</code> и опционально сжатым с форматом сжатия, понятным ядру. Подробнее о сжатии смотрите в разделе <a href="#COMPRESSION">#COMPRESSION</a>.
</p>
<p><i>mkinitcpio</i> включает в себя инструмент <span class="plainlinks archwiki-template-man" title="$ man 1 lsinitcpio"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lsinitcpio.1">lsinitcpio(1)</a></span>, позволяющий посмотреть и/или извлечь содержимое образов initramfs.
</p>
<p>Просмотр списка файлов в образе:
</p>
<pre># lsinitcpio /boot/initramfs-linux.img
</pre>
<p>Извлечение всех файлов в текущий каталог:
</p>
<pre># lsinitcpio -x /boot/initramfs-linux.img
</pre>
<p>Более удобный обзор самых важных частей образа:
</p>
<pre># lsinitcpio -a /boot/initramfs-linux.img
</pre>
<h3>
<span id=".D0.98.D0.B7.D0.BC.D0.B5.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B8_.D1.83.D0.BF.D0.B0.D0.BA.D0.BE.D0.B2.D0.BA.D0.B0_.D0.BE.D0.B1.D1.80.D0.B0.D0.B7.D0.B0"></span><span class="mw-headline" id="Изменение_и_упаковка_образа">Изменение и упаковка образа</span>
</h3>
<p>После распаковки архива описанным выше способом вы можете изменить файлы и упаковать всё обратно.
Вызовите функцию <code>build_image</code> из скрипта <code>/usr/bin/mkinitcpio</code> с параметрами
</p>
<pre>build_image <i>выходной-файл</i> <i>сжатие</i>
</pre>
<p>Это можно сделать путём создания нового скрипта с содержимым функции <code>build_image</code> и его вызова с описанными выше параметрами.
Он упакует содержимое текущего каталога в <code><i>выходной-файл</i></code>.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно:</strong> Перед перезаписью файла <code>/boot/initramfs-linux.img</code> стоит переименовать старый файл, чтобы была возможность отменить изменения. Будьте готовы к тому, что какая-нибудь ошибка помешает загрузке системы. В таком случае вам понадобится загрузиться с другой системы или Live CD, чтобы восстановить оригинал, запустить <i>mkinitcpio</i> для перезаписи ваших изменений или вручную исправить ошибки.</div>
<h3>
<span id=".22.2Fdev_must_be_mounted.22.2C_.D1.85.D0.BE.D1.82.D1.8F_.D0.BE.D0.BD_.D0.B8_.D1.82.D0.B0.D0.BA_.D0.BF.D1.80.D0.B8.D0.BC.D0.BE.D0.BD.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD"></span><span class="mw-headline" id='"/dev_must_be_mounted",_хотя_он_и_так_примонтирован'>"/dev must be mounted", хотя он и так примонтирован</span>
</h3>
<p><i>mkinitcpio</i> считает <code>/dev</code> примонтированным при наличии <code>/dev/fd/</code>. Если всё выглядит хорошо, его можно «создать» вручную:
</p>
<pre># ln -s /proc/self/fd /dev/
</pre>
<p>(Очевидно, <code>/proc</code> тоже должен быть примонтирован. <i>mkinitcpio</i> всё равно это требует и тоже это проверяет.)
</p>
<h3><span class="mw-headline" id="Possibly_missing_firmware_for_module_XXXX">Possibly missing firmware for module XXXX</span></h3>
<p>В процессе сборки initramfs после обновления ядра вы можете заметить подобные предупреждения:
</p>
<pre>==&gt; WARNING: Possibly missing firmware for module: wd719x
==&gt; WARNING: Possibly missing firmware for module: aic94xx
==&gt; WARNING: Possibly missing firmware for module: xhci_pci
</pre>
<p>Они появляются у большинства пользователей Arch Linux, так как соответствующие прошивки не поставляются пакетом <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-firmware">linux-firmware</a></span>. Если вы не используете устройства, которым нужны эти прошивки, вы можете игнорировать эти сообщения. На данный момент единственным решением для скрытия предупреждений модулей wd719x и aic94xx является установка пакетов с этими самыми прошивками. Для aic94xx установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/aic94xx-firmware/">aic94xx-firmware</a></span><sup><small>AUR</small></sup>. Для wd719x установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/wd719x-firmware/">wd719x-firmware</a></span><sup><small>AUR</small></sup>. Для xhci_pci установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/upd72020x-fw/">upd72020x-fw</a></span><sup><small>AUR</small></sup>. Смотрите связанное обсуждение <a rel="nofollow" class="external text" href="https://gist.github.com/imrvelj/c65cd5ca7f5505a65e59204f5a3f7a6d">здесь</a>.
</p>
<p>Самые распространённые файлы прошивок поставляются пакетом <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-firmware">linux-firmware</a></span>. Другие файлы прошивок можно поискать в <a href="../ru/Official_repositories.html" title="Official repositories (Русский)">официальных репозиториях</a> или <a href="../ru/Arch_User_Repository.html" title="Arch User Repository (Русский)">AUR</a>.
</p>
<h3>
<span id="No_PS.2F2_controller_found"></span><span class="mw-headline" id="No_PS/2_controller_found">No PS/2 controller found</span>
</h3>
<p>На некоторых материнских платах (в основном старых, но также и некоторых новых) контроллер i8042 не определяется автоматически. Это бывает редко, но некоторые люди всё же могут оказаться с неработающей клавиатурой. Вы можете заранее обнаружить эту ситуацию. Если у вас есть порт PS/2 и вы получаете сообщение <code>i8042: PNP: No PS/2 controller found. Probing ports directly</code>, добавьте <b>atkbd</b> в массив <code>MODULES</code>.
</p>
<h3>
<span id=".D0.A1.D1.82.D0.B0.D0.BD.D0.B4.D0.B0.D1.80.D1.82.D0.BD.D0.B0.D1.8F_.D0.BF.D1.80.D0.BE.D1.86.D0.B5.D0.B4.D1.83.D1.80.D0.B0_.D0.B2.D0.BE.D1.81.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D1.8F"></span><span class="mw-headline" id="Стандартная_процедура_восстановления">Стандартная процедура восстановления</span>
</h3>
<p>При неправильно сформированном начальном RAM-диске систему скорее всего не получится загрузить. В таком случае выполните описанную ниже процедуру восстановления системы:
</p>
<h4>
<span id=".D0.97.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BA.D0.B0_.D0.B2.D1.8B.D0.BF.D0.BE.D0.BB.D0.BD.D1.8F.D0.B5.D1.82.D1.81.D1.8F_.D0.BD.D0.B0_.D0.BE.D0.B4.D0.BD.D0.BE.D0.B9_.D0.BC.D0.B0.D1.88.D0.B8.D0.BD.D0.B5_.D0.B8_.D1.82.D0.B5.D1.80.D0.BF.D0.B8.D1.82_.D0.BD.D0.B5.D1.83.D0.B4.D0.B0.D1.87.D1.83_.D0.BD.D0.B0_.D0.B4.D1.80.D1.83.D0.B3.D0.BE.D0.B9"></span><span class="mw-headline" id="Загрузка_выполняется_на_одной_машине_и_терпит_неудачу_на_другой">Загрузка выполняется на одной машине и терпит неудачу на другой</span>
</h4>
<p><code>autodetect</code> hook скрипта <i>mkinitcpio</i> фильтрует ненужные <a href="../ru/Kernel_module.html" class="mw-redirect" title="Модули ядра">модули ядра</a> в первичном initramfs путем сканирования /sys и модулей, загруженных во время запуска. Если вы переносите /boot каталог на другую машину и последовательность загрузки терпит неудачу на стадии early userspace, то это может проиходить, потому что новое аппаратное обеспечение не определено отсутствующими модулями ядра. Обратите внимание, что для USB 2.0 и 3.0 нужны разные модули ядра. 
</p>
<p>Чтобы исправить, сначала попробуйте выбрать fallback образ в вашем <a href="../ru/Arch_boot_process.html#%D0%97%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D1%87%D0%B8%D0%BA" class="mw-redirect" title="Загрузчик">загрузчике</a>, поскольку он не фильтруется с помощью <code>autodetect</code>. После загрузки выполните <i>mkinitcpio</i> на новой машине, чтобы пересобрать первичный образ с корректными модулями. Если fallback образ не решил проблему, пропробуйте загрузиться в Arch Linux live CD/USB, выполнить chroot в установленную систему и выполнить <i>mkinitcpio</i> на новой машине. В крайнем случае, попробуйте <a href="#MODULES">вручную</a> добавить модули в initramfs.
</p>
<h2>
<span id=".D0.A1.D0.BC.D0.BE.D1.82.D1.80.D0.B8.D1.82.D0.B5_.D1.82.D0.B0.D0.BA.D0.B6.D0.B5"></span><span class="mw-headline" id="Смотрите_также">Смотрите также</span>
</h2>
<ul>
<li>Документация ядра Linux: <a rel="nofollow" class="external text" href="https://docs.kernel.org/filesystems/ramfs-rootfs-initramfs.html#what-is-rootfs">initramfs, "What is rootfs?"</a>
</li>
<li>Документация ядра Linux: <a rel="nofollow" class="external text" href="https://docs.kernel.org/admin-guide/initrd.html">initrd</a>
</li>
<li>Статья на Википедии: <a href="https://en.wikipedia.org/wiki/ru:initrd" class="extiw" title="wikipedia:ru:initrd">initrd</a>
</li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../ru/Category:Boot_process.html" title="Category:Boot process (Русский)">Boot process (Русский)</a></li>
<li><a href="../ru/Category:Kernel.html" title="Category:Kernel (Русский)">Kernel (Русский)</a></li>
<li><a href="../ru/Category:Arch_projects.html" title="Category:Arch projects (Русский)">Arch projects (Русский)</a></li>
<li><a href="../ru/Category:Commands.html" title="Category:Commands (Русский)">Commands (Русский)</a></li>
</ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Mkinitcpio_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;oldid=795811">https://wiki.archlinux.org/index.php?title=Mkinitcpio_(Русский)&amp;oldid=795811</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 2 January 2024, at 06:48.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
