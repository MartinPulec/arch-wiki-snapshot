<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-os vector-sticky-header-enabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>mkinitcpio (Русский) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.45.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Mkinitcpio_Русский rootpage-Mkinitcpio_Русский skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Установка" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Установка</span>
			</div>
		</a>
		
		<ul id="toc-Установка-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Создание_загрузочного_образа" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BE%D1%87%D0%BD%D0%BE%D0%B3%D0%BE_%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%B0">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Создание загрузочного образа</span>
			</div>
		</a>
		
			<button aria-controls="toc-Создание_загрузочного_образа-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Создание загрузочного образа subsection</span>
			</button>
		
		<ul id="toc-Создание_загрузочного_образа-sublist" class="vector-toc-list">
			<li id="toc-Автоматическая_генерация" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%90%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%B3%D0%B5%D0%BD%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D1%8F">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1</span>
					<span>Автоматическая генерация</span>
				</div>
			</a>
			
			<ul id="toc-Автоматическая_генерация-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Ручная_генерация" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A0%D1%83%D1%87%D0%BD%D0%B0%D1%8F_%D0%B3%D0%B5%D0%BD%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D1%8F">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2</span>
					<span>Ручная генерация</span>
				</div>
			</a>
			
			<ul id="toc-Ручная_генерация-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Варианты_создания_initcpio" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%92%D0%B0%D1%80%D0%B8%D0%B0%D0%BD%D1%82%D1%8B_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D1%8F_initcpio">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.3</span>
					<span>Варианты создания initcpio</span>
				</div>
			</a>
			
			<ul id="toc-Варианты_создания_initcpio-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Unified_kernel_images" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Unified_kernel_images">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.4</span>
					<span>Unified kernel images</span>
				</div>
			</a>
			
			<ul id="toc-Unified_kernel_images-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Настройка" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Настройка</span>
			</div>
		</a>
		
			<button aria-controls="toc-Настройка-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Настройка subsection</span>
			</button>
		
		<ul id="toc-Настройка-sublist" class="vector-toc-list">
			<li id="toc-MODULES" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#MODULES">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1</span>
					<span>MODULES</span>
				</div>
			</a>
			
			<ul id="toc-MODULES-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-BINARIES_и_FILES" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#BINARIES_%D0%B8_FILES">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2</span>
					<span>BINARIES и FILES</span>
				</div>
			</a>
			
			<ul id="toc-BINARIES_и_FILES-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-HOOKS" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#HOOKS">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.3</span>
					<span>HOOKS</span>
				</div>
			</a>
			
			<ul id="toc-HOOKS-sublist" class="vector-toc-list">
				<li id="toc-Build_hooks" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Build_hooks">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.3.1</span>
					<span>Build hooks</span>
				</div>
			</a>
			
			<ul id="toc-Build_hooks-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Runtime_hooks" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Runtime_hooks">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.3.2</span>
					<span>Runtime hooks</span>
				</div>
			</a>
			
			<ul id="toc-Runtime_hooks-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Post_hooks" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Post_hooks">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.3.3</span>
					<span>Post hooks</span>
				</div>
			</a>
			
			<ul id="toc-Post_hooks-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Доступные_хуки" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%94%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%BD%D1%8B%D0%B5_%D1%85%D1%83%D0%BA%D0%B8">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.3.4</span>
					<span>Доступные хуки</span>
				</div>
			</a>
			
			<ul id="toc-Доступные_хуки-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-COMPRESSION" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#COMPRESSION">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.4</span>
					<span>COMPRESSION</span>
				</div>
			</a>
			
			<ul id="toc-COMPRESSION-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-COMPRESSION_OPTIONS" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#COMPRESSION_OPTIONS">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.5</span>
					<span>COMPRESSION_OPTIONS</span>
				</div>
			</a>
			
			<ul id="toc-COMPRESSION_OPTIONS-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-MODULES_DECOMPRESS" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#MODULES_DECOMPRESS">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.6</span>
					<span>MODULES_DECOMPRESS</span>
				</div>
			</a>
			
			<ul id="toc-MODULES_DECOMPRESS-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Настройка_во_время_выполнения" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_%D0%B2%D0%BE_%D0%B2%D1%80%D0%B5%D0%BC%D1%8F_%D0%B2%D1%8B%D0%BF%D0%BE%D0%BB%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">4</span>
				<span>Настройка во время выполнения</span>
			</div>
		</a>
		
			<button aria-controls="toc-Настройка_во_время_выполнения-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Настройка во время выполнения subsection</span>
			</button>
		
		<ul id="toc-Настройка_во_время_выполнения-sublist" class="vector-toc-list">
			<li id="toc-init_из_хука_base" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#init_%D0%B8%D0%B7_%D1%85%D1%83%D0%BA%D0%B0_base">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.1</span>
					<span>init из хука base</span>
				</div>
			</a>
			
			<ul id="toc-init_из_хука_base-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-При_использовании_RAID" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%B8_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B8_RAID">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.2</span>
					<span>При использовании RAID</span>
				</div>
			</a>
			
			<ul id="toc-При_использовании_RAID-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-При_использовании_net" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%B8_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B8_net">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.3</span>
					<span>При использовании net</span>
				</div>
			</a>
			
			<ul id="toc-При_использовании_net-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-При_использовании_LVM" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%B8_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B8_LVM">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.4</span>
					<span>При использовании LVM</span>
				</div>
			</a>
			
			<ul id="toc-При_использовании_LVM-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-При_зашифрованном_корневом_разделе" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%B8_%D0%B7%D0%B0%D1%88%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D0%BE%D0%BC_%D0%BA%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D0%BE%D0%BC_%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB%D0%B5">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.5</span>
					<span>При зашифрованном корневом разделе</span>
				</div>
			</a>
			
			<ul id="toc-При_зашифрованном_корневом_разделе-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-/usr_на_отдельном_разделе" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#/usr_%D0%BD%D0%B0_%D0%BE%D1%82%D0%B4%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D0%BC_%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB%D0%B5">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.6</span>
					<span>/usr на отдельном разделе</span>
				</div>
			</a>
			
			<ul id="toc-/usr_на_отдельном_разделе-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Советы_и_рекомендации" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%A1%D0%BE%D0%B2%D0%B5%D1%82%D1%8B_%D0%B8_%D1%80%D0%B5%D0%BA%D0%BE%D0%BC%D0%B5%D0%BD%D0%B4%D0%B0%D1%86%D0%B8%D0%B8">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">5</span>
				<span>Советы и рекомендации</span>
			</div>
		</a>
		
			<button aria-controls="toc-Советы_и_рекомендации-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Советы и рекомендации subsection</span>
			</button>
		
		<ul id="toc-Советы_и_рекомендации-sublist" class="vector-toc-list">
			<li id="toc-Отключение_создания_fallback-образа_initramfs" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9E%D1%82%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D1%8F_fallback-%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%B0_initramfs">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.1</span>
					<span>Отключение создания fallback-образа initramfs</span>
				</div>
			</a>
			
			<ul id="toc-Отключение_создания_fallback-образа_initramfs-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Решение_проблем" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%A0%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">6</span>
				<span>Решение проблем</span>
			</div>
		</a>
		
			<button aria-controls="toc-Решение_проблем-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Решение проблем subsection</span>
			</button>
		
		<ul id="toc-Решение_проблем-sublist" class="vector-toc-list">
			<li id="toc-Распаковка_образа" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A0%D0%B0%D1%81%D0%BF%D0%B0%D0%BA%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%B0">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">6.1</span>
					<span>Распаковка образа</span>
				</div>
			</a>
			
			<ul id="toc-Распаковка_образа-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Изменение_и_упаковка_образа" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%98%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B8_%D1%83%D0%BF%D0%B0%D0%BA%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%B0">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">6.2</span>
					<span>Изменение и упаковка образа</span>
				</div>
			</a>
			
			<ul id="toc-Изменение_и_упаковка_образа-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-«/dev_must_be_mounted»,_хотя_он_и_так_примонтирован" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%C2%AB/dev_must_be_mounted%C2%BB,_%D1%85%D0%BE%D1%82%D1%8F_%D0%BE%D0%BD_%D0%B8_%D1%82%D0%B0%D0%BA_%D0%BF%D1%80%D0%B8%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">6.3</span>
					<span>«/dev must be mounted», хотя он и так примонтирован</span>
				</div>
			</a>
			
			<ul id="toc-«/dev_must_be_mounted»,_хотя_он_и_так_примонтирован-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Possibly_missing_firmware_for_module_XXXX" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Possibly_missing_firmware_for_module_XXXX">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">6.4</span>
					<span>Possibly missing firmware for module XXXX</span>
				</div>
			</a>
			
			<ul id="toc-Possibly_missing_firmware_for_module_XXXX-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-No_PS/2_controller_found" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#No_PS/2_controller_found">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">6.5</span>
					<span>No PS/2 controller found</span>
				</div>
			</a>
			
			<ul id="toc-No_PS/2_controller_found-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Стандартная_процедура_восстановления" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A1%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82%D0%BD%D0%B0%D1%8F_%D0%BF%D1%80%D0%BE%D1%86%D0%B5%D0%B4%D1%83%D1%80%D0%B0_%D0%B2%D0%BE%D1%81%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">6.6</span>
					<span>Стандартная процедура восстановления</span>
				</div>
			</a>
			
			<ul id="toc-Стандартная_процедура_восстановления-sublist" class="vector-toc-list">
				<li id="toc-Загрузка_выполняется_на_одной_машине_и_терпит_неудачу_на_другой" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%97%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B0_%D0%B2%D1%8B%D0%BF%D0%BE%D0%BB%D0%BD%D1%8F%D0%B5%D1%82%D1%81%D1%8F_%D0%BD%D0%B0_%D0%BE%D0%B4%D0%BD%D0%BE%D0%B9_%D0%BC%D0%B0%D1%88%D0%B8%D0%BD%D0%B5_%D0%B8_%D1%82%D0%B5%D1%80%D0%BF%D0%B8%D1%82_%D0%BD%D0%B5%D1%83%D0%B4%D0%B0%D1%87%D1%83_%D0%BD%D0%B0_%D0%B4%D1%80%D1%83%D0%B3%D0%BE%D0%B9">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">6.6.1</span>
					<span>Загрузка выполняется на одной машине и терпит неудачу на другой</span>
				</div>
			</a>
			
			<ul id="toc-Загрузка_выполняется_на_одной_машине_и_терпит_неудачу_на_другой-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Cannot_open_access_to_console,_the_root_account_is_locked" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Cannot_open_access_to_console,_the_root_account_is_locked">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">6.7</span>
					<span>Cannot open access to console, the root account is locked</span>
				</div>
			</a>
			
			<ul id="toc-Cannot_open_access_to_console,_the_root_account_is_locked-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Смотрите_также" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%A1%D0%BC%D0%BE%D1%82%D1%80%D0%B8%D1%82%D0%B5_%D1%82%D0%B0%D0%BA%D0%B6%D0%B5">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">7</span>
				<span>Смотрите также</span>
			</div>
		</a>
		
		<ul id="toc-Смотрите_также-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar no-font-mode-scale">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left" title="Table of Contents">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading">mkinitcpio (Русский)</h1>
							
</header>
				<div class="vector-column-end no-font-mode-scale">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="ru" dir="ltr">
<p><span>
</span>
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Состояние перевода:</strong> На этой странице представлен перевод статьи <a href="../en/Mkinitcpio.html" title="Mkinitcpio">mkinitcpio</a>. Дата последней синхронизации: 12 августа 2025. Вы можете <a href="../ru/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (Русский)">помочь</a> синхронизировать перевод, если в английской версии произошли <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Mkinitcpio&amp;diff=0&amp;oldid=840327">изменения</a>.</div>
<div class="archwiki-template-meta-related-articles">
<p>Ссылки по теме</p>
<ul>
<li><a href="../en/Booster.html" title="Booster">Booster</a></li>
<li><a href="../ru/General_troubleshooting.html#%D0%9F%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B8" title="General troubleshooting (Русский)">Отладка загрузки</a></li>
<li><a href="../en/Dracut.html" title="Dracut">dracut</a></li>
<li><a href="../en/d7f36cfb141212562ec357bd7c39e2bf.html" class="mw-redirect" title="Модули ядра">Модули ядра</a></li>
<li><a href="../en/Mkinitcpio/Minimal_initramfs.html" title="Mkinitcpio/Minimal initramfs">mkinitcpio/Minimal initramfs</a></li>
<li><a href="../ru/Systemd.html" title="Systemd (Русский)">systemd (Русский)</a></li>
<li><a href="../en/Unified_kernel_image.html" title="Unified kernel image">Unified kernel image</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://gitlab.archlinux.org/archlinux/mkinitcpio/mkinitcpio">mkinitcpio</a> — это bash-скрипт, используемый для создания <a href="https://en.wikipedia.org/wiki/ru:initrd" class="extiw" title="wikipedia:ru:initrd">начального загрузочного диска</a> системы. Из man-страницы <span class="plainlinks archwiki-template-man" title="$ man 8 mkinitcpio"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mkinitcpio.8">mkinitcpio(8)</a></span>:
</p>
<dl><dd>Начальный ram-диск по сути представляет собой очень маленькую среду (раннее пользовательское пространство, early userspace), которая загружает различные модули ядра и настраивает необходимые вещи перед передачей управления процессу <code>init</code>. Это позволяет, например, использовать зашифрованную корневую файловую систему или разместить её на программном RAID-массиве. <i>mkinitcpio</i> легко расширяется с помощью настраиваемых хуков, имеет автоопределение во время работы системы и многие другие функции.</dd></dl>
<p>Традиционно ядро отвечает за обнаружение всего оборудования и выполняет задачи на ранних этапах <a href="../ru/Arch_boot_process.html" title="Arch boot process (Русский)">процесса загрузки</a> до монтирования корневой файловой системы. Однако по мере развития технологий эти задачи становятся всё более сложными.
</p>
<p>В настоящее время корневая файловая система может быть на широком диапазоне аппаратных средств от SCSI до SATA и USB дисков, управляемых различными контроллерами от разных производителей. Кроме того корневая файловая система может быть зашифрована или сжата, находиться в RAID массиве или группе логических томов. Простой способ справиться с этой сложностью является передача управления в пользовательском пространстве: начальный загрузочный диск.
Смотрите также: <a rel="nofollow" class="external text" href="https://web.archive.org/web/20150906053013/http://archlinux.me/brain0/2010/02/13/early-userspace-in-arch-linux/">/dev/brain0 » Blog Archive » Early Userspace in Arch Linux</a>.
</p>
<p><i>mkinitcpio</i> разрабатывается разработчиками Arch Linux при участии сообщества. Смотрите <a rel="nofollow" class="external text" href="https://gitlab.archlinux.org/archlinux/mkinitcpio/mkinitcpio">публичный Git-репозиторий mkinitcpio</a>.
</p>
<p>Важно отметить, что существует два различных подхода к выполнению задач на этапе работы начального загрузочного диска:
</p>
<dl>
<dt>На основе Busybox</dt>
<dd>Запускается init-скрипт, который, в свою очередь, сканирует файловую систему ram-диска в поисках скриптов для выполнения (в данном контексте называемых «runtime hooks»). Плюсы: лёгкий, небольшой размер, меньше зависимостей.</dd>
<dt>На основе systemd</dt>
<dd>systemd запускается уже в начале работы начального загрузочного диска. Выполняемые задачи определяются с помощью обычных юнитов systemd. Смотрите <a rel="nofollow" class="external text" href="https://www.freedesktop.org/software/systemd/man/latest/bootup.html">процесс запуска systemd</a>. Плюсы: тесная интеграция с остальной частью экосистемы systemd, что приводит к более последовательному и оптимизированному процессу запуска. Более эффективная параллелизация определённых задач загрузки, что в некоторых случаях может привести к сокращению общего времени запуска. Более полный набор функций, например <a href="../en/Dm-crypt/System_configuration.html#Using_systemd-cryptsetup-generator" title="Dm-crypt/System configuration">systemd-cryptsetup-generator</a> с <code>/etc/crypttab.initramfs</code> или <a href="../ru/Systemd.html#%D0%90%D0%B2%D1%82%D0%BE%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_GPT-%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB%D0%B0" title="Systemd (Русский)">автомонтирование GPT-разделов</a>. Минусы: Больше зависимостей и больший размер: как правило, приводит к увеличению размера initramfs из-за включения исполняемых файлов systemd и его зависимостей. Это может немного увеличить время загрузки.</dd>
</dl>
<p>Используемый подход выбирается путём добавления или удаления <code>systemd</code> в массиве <code>HOOKS</code> в файле <code>/etc/mkinitcpio.conf</code>. Подробнее в разделе <a href="#%D0%94%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%BD%D1%8B%D0%B5_%D1%85%D1%83%D0%BA%D0%B8">#Доступные хуки</a>.
</p>
<meta property="mw:PageProp/toc">
<div class="mw-heading mw-heading2"><h2 id="Установка">
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0"></span>Установка</h2></div>
<p><a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установите">Установите</a> пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mkinitcpio">mkinitcpio</a></span>, который является зависимостью пакета <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span>, поэтому большинство пользователей уже установили его.
</p>
<p>Продвинутые пользователи могут захотеть установить последнюю версию mkinitcpio из Git с пакетом <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/mkinitcpio-git/">mkinitcpio-git</a></span><sup><small>AUR</small></sup>.
</p>
<div class="mw-heading mw-heading2"><h2 id="Создание_загрузочного_образа">
<span id=".D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D0.B5_.D0.B7.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BE.D1.87.D0.BD.D0.BE.D0.B3.D0.BE_.D0.BE.D0.B1.D1.80.D0.B0.D0.B7.D0.B0"></span>Создание загрузочного образа</h2></div>
<div class="mw-heading mw-heading3"><h3 id="Автоматическая_генерация">
<span id=".D0.90.D0.B2.D1.82.D0.BE.D0.BC.D0.B0.D1.82.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B0.D1.8F_.D0.B3.D0.B5.D0.BD.D0.B5.D1.80.D0.B0.D1.86.D0.B8.D1.8F"></span>Автоматическая генерация</h3></div>
<p>Каждый раз, когда ядро устанавливается или обновляется, <a href="../ru/Pacman.html#%D0%A5%D1%83%D0%BA%D0%B8" title="Pacman (Русский)">pacman-хук</a> генерирует файл предустановки (<i>.preset</i>) и сохраняет его в <code>/etc/mkinitcpio.d/</code>. Например, для официального пакета <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span> создаётся файл <code>linux.preset</code>. Предустановка — это просто список информации, необходимой для создания начальных образов RAM-диска, вместо того, чтобы вручную указывать различные параметры и расположение выходных файлов.
По умолчанию mkinitcpio генерирует два образа после установки или обновления ядра:
</p>
<ol>
<li>
<i>default</i>, создаваемый в соответствии с директивами, указанными в <a href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0">настройках</a>, и</li>
<li>
<i>fallback</i>, который создается с точно таким же конфигурационным файлом за исключением хука <b>autodetect</b>, что позволяет включить в него все модули.</li>
</ol>
<p>После создания файла предустановки pacman-хук запускает скрипт <i>mkinitcpio</i>, который генерирует два образа, используя информацию, указанную в этом файле.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание</strong> <i>.preset</i> файлы используются для автоматической пересборки initramfs после обновления ядра. Будьте внимательны при их редактировании.</div>
<div class="mw-heading mw-heading3"><h3 id="Ручная_генерация">
<span id=".D0.A0.D1.83.D1.87.D0.BD.D0.B0.D1.8F_.D0.B3.D0.B5.D0.BD.D0.B5.D1.80.D0.B0.D1.86.D0.B8.D1.8F"></span>Ручная генерация</h3></div>
<p>Чтобы запустить скрипт вручную, обратитесь к <span class="plainlinks archwiki-template-man" title="$ man 8 mkinitcpio"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mkinitcpio.8">mkinitcpio(8)</a></span> для чтения инструкций. В частности, чтобы (повторно) сгенерировать образ initramfs, используя предустановку, предоставленную пакетом ядра, используйте параметр <code>-p</code>/<code>--preset</code> с именем нужной предустановки. Например, для ядра <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span> используйте такую команду:
</p>
<pre># mkinitcpio -p linux
</pre>
<p>Чтобы (повторно) сгенерировать образы initramfs, используя все существующие предустановки, используйте параметр <code>-P</code>/<code>--allpresets</code>. Обычно это используется для перегенерации всех образов initramfs после изменения глобальных <a href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0">настроек</a>:
</p>
<pre># mkinitcpio -P
</pre>
<p>Можно создать любое количество образов initramfs с различными конфигурациями. Путь к нужному образу должен быть прописан в настройках <a href="../ru/Arch_boot_process.html#%D0%97%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D1%87%D0%B8%D0%BA" title="Arch boot process (Русский)">загрузчика</a>.
</p>
<div class="mw-heading mw-heading3"><h3 id="Варианты_создания_initcpio">
<span id=".D0.92.D0.B0.D1.80.D0.B8.D0.B0.D0.BD.D1.82.D1.8B_.D1.81.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D1.8F_initcpio"></span>Варианты создания initcpio</h3></div>
<p>Пользователи могут вручную создать образ с помощью альтернативного конфигурационного файла. Например, следующее будет генерировать initramfs образ в соответствии с <code>/etc/mkinitcpio-custom.conf</code> и сохранит его в <code>/boot/linux-custom.img</code>.
</p>
<pre># mkinitcpio --config /etc/mkinitcpio-custom.conf --generate /boot/initramfs-custom.img
</pre>
<p>Если необходимо создать образ с ядром отличным от загруженного, добавьте параметр с версией ядра. Доступные версии ядер можно посмотреть в <code>/usr/lib/modules</code>, синтаксис соответствует выводу <code>uname -r</code> для каждого ядра.
</p>
<pre># mkinitcpio --generate /boot/initramfs-custom2.img --kernel 5.7.12-arch1-1
</pre>
<div class="mw-heading mw-heading3"><h3 id="Unified_kernel_images">Unified kernel images</h3></div>
<p><i>mkinitcpio</i> может генерировать <a href="../en/Unified_kernel_image.html" title="Unified kernel image">unified kernel image</a> (UKI) самостоятельно или через <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=systemd-ukify">systemd-ukify</a></span>. Если <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=systemd-ukify">systemd-ukify</a></span> не установлен или явно отключен опцией <code>--no-ukify</code>, mkinitcpio соберёт UKI сам, но тогда дополнительные возможности, которые предоставляет <i>ukify</i>, будут недоступны.
</p>
<p>Подробнее в статье <a href="../en/Unified_kernel_image.html" title="Unified kernel image">Unified kernel image</a>.
</p>
<div class="mw-heading mw-heading2"><h2 id="Настройка">
<span id=".D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0"></span>Настройка</h2></div>
<p><code>/etc/mkinitcpio.conf</code> — основной файл настроек <i>mkinitcpio</i>. Поддерживаются drop-in файлы, например <code>/etc/mkinitcpio.conf.d/myhooks.conf</code> (но они игнорируются при запуске с опцией <code>-c</code> и/или использовании предустановки, содержащей <code>ALL_config</code>). Кроме того, в каталоге <code>/etc/mkinitcpio.d</code> располагаются файлы предустановок (например <code>/etc/mkinitcpio.d/linux.preset</code>).
</p>
<p>Можно изменять семь переменных в файле настроек (подробнее в документации <span class="plainlinks archwiki-template-man" title="$ man 5 mkinitcpio.conf"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mkinitcpio.conf.5#VARIABLES">mkinitcpio.conf(5) § VARIABLES</a></span>):
</p>
<dl>
<dt><code>MODULES</code></dt>
<dd>Модули ядра, которые будут загружены до выполнения хуков.</dd>
<dt><code>BINARIES</code></dt>
<dd>Дополнительные исполняемые файлы, которые необходимо включить в initramfs.</dd>
<dt><code>FILES</code></dt>
<dd>Дополнительные файлы, которые необходимо включить в initramfs.</dd>
<dt><code>HOOKS</code></dt>
<dd>Хуки — скрипты, выполняемые в initramfs.</dd>
<dt><code>COMPRESSION</code></dt>
<dd>Тип используемого сжатия initramfs.</dd>
<dt><code>COMPRESSION_OPTIONS</code></dt>
<dd>Дополнительные опции, передаваемые программе, указанной в переменной <code>COMPRESSION</code>. Использование этого параметра не рекомендуется. <i>mkinitcpio</i> будет обрабатывать особые требования к инструментам сжатия (например <code>--check=crc32</code> для xz), и неправильное использование может привести к невозможности запуска системы.</dd>
<dt><code>MODULES_DECOMPRESS</code></dt>
<dd>Разжимать ли загружаемые модули ядра и файлы прошивок перед их записью в initramfs или сохранять их в исходном сжатом виде.</dd>
</dl>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание</strong> 
<ul>
<li>Некоторые хуки, которые могут быть нужны для вашей системы, вроде <b>lvm2</b>, <b>mdadm_udev</b> и <b>encrypt</b>, <b>НЕ</b> включены по умолчанию. Смотрите раздел <a href="#HOOKS">#HOOKS</a>, чтобы узнать, как их включить и настроить.</li>
<li>Файлы предустановок, созданные через <i>mkinitcpio</i> до версии 36, устанавливают переменную <code>ALL_config</code>, что предотвращает загрузку drop-in файлов. Чтобы они загружались, закомментируйте строку <code>ALL_config="/etc/mkinitcpio.conf"</code> в старых файлах предустановок.</li>
</ul>
</div>
<div class="mw-heading mw-heading3"><h3 id="MODULES">MODULES</h3></div>
<p>Указывает, какие модули ядра должны быть загружены перед выполнением всех остальных действий.
</p>
<p>Для модулей с суффиксом <code>?</code> не будет выводиться ошибка, если они не будут найдены. Это может быть полезно для пользовательских ядер.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание</strong> 
<ul>
<li>При использовании сторонних (out-of-tree) файловых систем, которые нужно монтировать в early userspace (например, если такая файловая система используется для корневого раздела), соответствующие модули (например, <code>reiser4</code>) <b>должны</b> быть добавлены в массив <code>MODULES</code>.</li>
<li>При использовании хука <b>encrypt</b> или <b>sd-encrypt</b> модули клавиатуры и/или файловых систем, необходимые для разблокировки устройства LUKS во время загрузки системы, нужно добавить в массив <code>MODULES</code>, когда целевая система отличается от той, которая использовалась для запуска <i>mkinitcpio</i>. Например, если вы используете keyfile в файловой системе ext2, но во время запуска mkinitcpio файловая система ext2 не смонтирована, добавьте <code>ext2</code>. Подробнее смотрите <a href="../en/Dm-crypt/System_configuration.html#cryptkey" title="Dm-crypt/System configuration">dm-crypt/System configuration#cryptkey</a>.</li>
<li>Если клавиатура подключена через USB3-хаб и вы хотите использовать её для разблокировки LUKS устройства, добавьте <code>usbhid xhci_hcd</code>.</li>
<li>При использовании дисплеев, подключенных к док-станции, вам может потребоваться добавить модуль для вашей видеокарты, чтобы сделать вывод initrd видимым (например <code>i915</code> для большинства карт Intel).</li>
</ul>
</div>
<div class="mw-heading mw-heading3"><h3 id="BINARIES_и_FILES">
<span id="BINARIES_.D0.B8_FILES"></span>BINARIES и FILES</h3></div>
<p>Указывают, какие файлы необходимо добавить в initramfs. <code>BINARIES</code> и <code>FILES</code> будут добавлены перед запуском хуков и могут использоваться для переопределения файлов, используемых или предоставляемых хуками. <code>BINARIES</code> — бинарные файлы из <code>PATH</code>, все необходимые для их работы библиотеки будут добавлены автоматически. <code>FILES</code> добавляет файлы как есть. Например:
</p>
<pre>FILES=(/etc/modprobe.d/modprobe.conf)
</pre>
<pre>BINARIES=(kexec)
</pre>
<p>И <code>BINARIES</code>, и <code>FILES</code> являются <a href="../ru/Bash.html" title="Bash (Русский)">bash</a>-массивами, в них можно добавить несколько файлов с пробелом в качестве разделителя.
</p>
<div class="mw-heading mw-heading3"><h3 id="HOOKS">HOOKS</h3></div>
<p>Массив <code>HOOKS</code> наиболее важный в файле настроек. Хуки — это небольшие скрипты, которые описывают, что будет добавлено к образу, а также дополнительные действия, выполняемые при загрузке системы. Хуки указываются по имени и выполняются в порядке, заданном в массиве <code>HOOKS</code>.
</p>
<p>Значение по умолчанию для <code>HOOKS</code> должно быть достаточным для большинства простых установок с одним диском. Для корневых устройств, которые являются многоуровневыми или многоблочными устройствами, такими как <a href="../ru/LVM.html" class="mw-redirect" title="LVM (Русский)">LVM</a>, <a href="../en/Software_RAID_and_LVM.html" class="mw-redirect" title="Software RAID and LVM">mdadm</a> или <a href="../ru/Dm-crypt.html" title="Dm-crypt (Русский)">dm-crypt</a>, смотрите cоответствующие страницы вики для дальнейшей необходимой конфигурации.
</p>
<div class="mw-heading mw-heading4"><h4 id="Build_hooks">Build hooks</h4></div>
<p>Build hooks — хуки сборки. Располагаются в <code>/usr/lib/initcpio/install/</code>; пользовательские хуки можно добавить в <code>/etc/initcpio/install/</code>. <i>mkinitcpio</i> выполняет source этих файлов в bash во время сборки initramfs. Должны содержать две функции: <code>build</code> и <code>help</code>. Функция <code>build</code> перечисляет модули, файлы и исполняемые файлы, которые добавляются в образ. Функции, которые могут использовать хуки сборки, описаны в <span class="plainlinks archwiki-template-man" title="$ man 8 mkinitcpio"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mkinitcpio.8">mkinitcpio(8)</a></span>. Функция <code>help</code> выводит описание действий хука.
</p>
<p>Для получения списка всех доступных хуков:
</p>
<pre>$ mkinitcpio -L
</pre>
<p>Используйте опцию <code>-H</code>/<code>--hookhelp</code> для вывода информации о конкретном хуке:
</p>
<pre>$ mkinitcpio -H udev
</pre>
<div class="mw-heading mw-heading4"><h4 id="Runtime_hooks">Runtime hooks</h4></div>
<p>Runtime hooks — хуки времени выполнения. Располагаются в <code>/usr/lib/initcpio/hooks/</code>, пользовательские хуки можно добавить в <code>/etc/initcpio/hooks/</code>. Для любого runtime-хука всегда должен быть build-хук, имеющий такое же имя и вызывающий функцию <code>add_runscript</code>, которая добавит runtime-хук в образ. Во время early userspace выполняется source этих файлов командным интерпретатором ash из busybox. Они запускаются по порядку записи в <code>HOOKS</code>, за исключением хуков очистки. Runtime-хуки могут содержать несколько функций:
</p>
<p><code>run_earlyhook</code>: Функции с таким именем будут запускаться один раз после монтирования API файловых систем и обработки командной строки ядра. Как правило, здесь запускаются дополнительные демоны, такие как udev, необходимые для раннего процесса загрузки.
</p>
<p><code>run_hook</code>: Функции с таким именем запускаются вскоре после ранних хуков. Эта функция используется чаще всего, и здесь должны выполняться операции, такие как сборка многоуровневых блочных устройств.
</p>
<p><code>run_latehook</code>: Функции c этим именем запускаются после того, как была примонтирована корневая файловая система. Это следует использовать ограниченно для дальнейшей настройки корневой ФС или для монтирования других файловых систем, таких как <code>/usr</code>.
</p>
<p><code>run_cleanuphook</code>: Функции с этим именем запускаются как можно позже и в порядке обратном порядку их перечисления в массиве <code>HOOKS</code> из файла настроек. Эти хуки должны использоваться для любой очистки в последнюю минуту, например, для закрытия всех демонов, запущенных ранними хуками.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание</strong> Runtime-хуки используются только в busybox init. Хук <b>systemd</b> запускает инициализацию на основе systemd, который вместо runtime-хуков использует юниты systemd.</div>
<div class="mw-heading mw-heading4"><h4 id="Post_hooks">Post hooks</h4></div>
<p>Post hooks — исполняемые файлы, которые выполняются после завершения создания образа initramfs. Располагаются в <code>/usr/lib/initcpio/post/</code>, пользовательские хуки можно добавить в <code>/etc/initcpio/post/</code>. Их можно использовать для дополнительных задач вроде подписи созданного образа.
</p>
<p>Каждый исполняемый файл запускается с тремя аргументами в таком порядке:
</p>
<ol>
<li>использованное <b>ядро</b> (иногда может быть пустым);</li>
<li>созданный <b>образ initramfs</b>;</li>
<li>(опционально) созданный <b>unified kernel image</b>.</li>
</ol>
<p>Также устанавливаются переменные окружения <code>KERNELVERSION</code>, содержащая полную версию ядра, и <code>KERNELDESTINATION</code>, содержащая путь, в котором должно находиться ядро, чтобы оно могло быть загружено.
</p>
<div class="mw-heading mw-heading4"><h4 id="Доступные_хуки">
<span id=".D0.94.D0.BE.D1.81.D1.82.D1.83.D0.BF.D0.BD.D1.8B.D0.B5_.D1.85.D1.83.D0.BA.D0.B8"></span>Доступные хуки</h4></div>
<p>Таблица стандартных хуков и как они влияют на создание и выполнение образа. Обратите внимание, что эта таблица не является полной, так как пакеты могут предоставлять свои хуки.
</p>
<table class="wikitable">
<tbody>
<tr>
<th>busybox init</th>
<th>systemd init</th>
<th><a href="#Build_hooks">Build hook</a></th>
<th>
<a href="#Runtime_hooks">Runtime hook</a> (только busybox init)
</th>
</tr>
<tr>
<td class="archwiki-table-cell"><b>base</b></td>
<td class="archwiki-table-cell archwiki-template-grey"><i>опционален</i></td>
<td>Устанавливает все начальные каталоги, базовые утилиты и библиотеки. Всегда ставьте этот хук первым, за исключением случаев, когда вы действительно знаете, что делаете, если не используется хук <b>systemd</b>. <br>Опционален при использовании хука <b>systemd</b>, поскольку он лишь предоставляет busybox recovery shell. <div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание</strong> Командная оболочка восстановления недоступна, так как аккаунт root в initramfs <a rel="nofollow" class="external text" href="https://gitlab.archlinux.org/archlinux/packaging/packages/systemd/-/commit/292cdf8a2f7dd7c6c7d91d2b59617391935c837c">заблокирован</a>. Смотрите <a rel="nofollow" class="external text" href="https://gitlab.archlinux.org/archlinux/mkinitcpio/mkinitcpio/-/issues/205">archlinux/mkinitcpio/mkinitcpio#205</a>.</div>
</td>
<td class="archwiki-table-cell" data-sort-value="5">–
</td>
</tr>
<tr>
<td class="archwiki-table-cell"><b>udev</b></td>
<td rowspan="3" class="archwiki-table-cell"><b>systemd</b></td>
<td>Добавляет в образ udevd, udevadm и небольшое подмножество правил udev.</td>
<td>Запускает демон udev и обрабатывает uevents из ядра, создавая файлы устройств. Поскольку он упрощает процесс загрузки, не требуя от пользователя явного указания необходимых модулей, его использование рекомендуется.
</td>
</tr>
<tr>
<td class="archwiki-table-cell"><b>usr</b></td>
<td>Добавляет поддержку отдельного раздела <code>/usr</code>. Подробнее: <a href="#/usr_%D0%BD%D0%B0_%D0%BE%D1%82%D0%B4%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D0%BC_%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB%D0%B5">#/usr на отдельном разделе</a>
</td>
<td>Монтирует раздел <code>/usr</code> после монтирования корневой файловой системы.
</td>
</tr>

<tr>
<td class="archwiki-table-cell"><b>resume</b></td>
<td>Добавляет модули ядра <code>lzo</code> и <code>lz4</code>, позволяющие загрузить образ памяти, созданный при уходе в спящий режим, если этот образ сжат алгоритмом, не используемым по умолчанию. Добавляет исполняемый файл <span class="plainlinks archwiki-template-man" title="$ man 8 systemd-hibernate-resume"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-hibernate-resume.8">systemd-hibernate-resume(8)</a></span> для поддержки загрузки образа памяти, указанного в UEFI-переменной <code>HibernateLocation</code>.</td>
<td>Пытается возобновить систему после спящего режима. Подробнее в разделе <a href="../en/00e6b22a7dcd3009b66946a04c741cf5.html#%D0%93%D0%B8%D0%B1%D0%B5%D1%80%D0%BD%D0%B0%D1%86%D0%B8%D1%8F" class="mw-redirect" title="Ждущий и спящий режимы">Ждущий и спящий режимы#Гибернация</a>.
</td>
</tr>
<tr>
<td class="archwiki-table-cell"><b>btrfs</b></td>
<td class="archwiki-table-cell archwiki-template-grey">–</td>
<td>Устанавливает необходимые модули для использования файловой системы <a href="../ru/Btrfs.html" title="Btrfs (Русский)">Btrfs</a>, расположенной на нескольких устройствах. Для использования хука нужно установить <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=btrfs-progs">btrfs-progs</a></span>. Этот хук не требуется, если Btrfs расположена на одном устройстве, так как для этого достаточно хука <code>filesystems</code>.</td>
<td>Запускает <code>btrfs device scan</code> для сборки корневой файловой системы Btrfs, расположенной на нескольких устройствах, когда хуки <b>udev</b> и <b>systemd</b> отсутствуют. Для использования хука нужно установить <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=btrfs-progs">btrfs-progs</a></span>.
</td>
</tr>
<tr>
<td colspan="2" class="archwiki-table-cell"><b>autodetect</b></td>
<td>Уменьшает размер initramfs, пытаясь определить, какие модули вам нужны, сканируя sysfs. Проверьте список модулей, которые он добавил. Он должен запускаться раньше других подсистем. Все обработчики, выполняемые до него, будут включать все модули.</td>
<td class="archwiki-table-cell" data-sort-value="5">–
</td>
</tr>
<tr>
<td colspan="2" class="archwiki-table-cell"><b>microcode</b></td>
<td>Перед основным образом initramfs добавляет несжатый образ, содержащий файлы с обновлениями <a href="../ru/Microcode.html" title="Microcode (Русский)">микрокода</a> для процессоров Intel и AMD. Использует файлы микрокода из каталогов <code>/usr/lib/firmware/amd-ucode/</code> и <code>/usr/lib/firmware/intel-ucode/</code>, если они доступны, иначе извлекает <code>/boot/amd-ucode.img</code> и <code>/boot/intel-ucode.img</code>.<br> Если перед этим хуком находится хук <b>autodetect</b>, будут добавлены файлы микрокода только для того процессора, на котором была запущена генерация образа. <br> Этот хук заменяет устаревший флаг <code>--microcode</code> и опцию <code>microcode</code> в файлах предустановок. Он также позволяет убрать из настроек загрузчика второй параметр <code>initrd</code>, указывающий на отдельный образ с микрокодом, поскольку микрокод теперь находится в одном файле с основным образом initramfs.</td>
<td class="archwiki-table-cell" data-sort-value="5">–
</td>
</tr>
<tr>
<td colspan="2" class="archwiki-table-cell"><b>modconf</b></td>
<td>Добавляет конфигурационные файлы modprobe из <code>/etc/modprobe.d/</code> и <code>/usr/lib/modprobe.d/</code>
</td>
<td class="archwiki-table-cell" data-sort-value="5">–
</td>
</tr>
<tr>
<td colspan="2" class="archwiki-table-cell"><b>kms</b></td>
<td>Добавляет модули видеокарт для <a href="../ru/Kernel_mode_setting.html#%D0%A0%D0%B0%D0%BD%D0%BD%D0%B8%D0%B9_%D0%B7%D0%B0%D0%BF%D1%83%D1%81%D0%BA_KMS" title="Kernel mode setting (Русский)">раннего запуска KMS</a>. Также добавляет модули, необходимые для экранов конфиденциальности (privacy screens), встроенных в ЖК-панели некоторых ноутбуков.</td>
<td class="archwiki-table-cell" data-sort-value="5">–
</td>
</tr>
<tr>
<td colspan="2" class="archwiki-table-cell"><b>keyboard</b></td>
<td>Добавляет модули, необходимые для работы клавиатур. Используйте этот хук, если необходимо использовать USB-клавиатуру на ранней стадии загрузки (для ввода пароля от зашифрованных данных или для работы в командной оболочке). В качестве побочного эффекта также могут быть добавлены модули для некоторых устройств ввода без клавиатуры, но на это не следует полагаться.
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание</strong> Для систем, которые загружаются с различными конфигурациями оборудования (например, ноутбуки с внешней клавиатурой или внутренней клавиатурой или <a href="https://en.wikipedia.org/wiki/Headless_computer" class="extiw" title="wikipedia:Headless computer">headless-системы</a>), этот хук необходимо поместить перед <b>autodetect</b>, чтобы иметь возможность использовать клавиатуру во время загрузки, например, чтобы разблокировать зашифрованное устройство при использовании хука <code>encrypt</code>.</div>
</td>
<td class="archwiki-table-cell" data-sort-value="5">–
</td>
</tr>
<tr>
<td class="archwiki-table-cell"><b>keymap</b></td>
<td rowspan="2" class="archwiki-table-cell"><b>sd-vconsole</b></td>
<td>Добавляет в initramfs раскладки, указанные в <code>/etc/vconsole.conf</code>. При использовании <a href="../ru/Dm-crypt/Encrypting_an_entire_system.html" title="Dm-crypt (Русский)/Encrypting an entire system (Русский)">шифрования системы</a> добавляйте его перед хуком <code>encrypt</code>.</td>
<td>Загружает раскладки, указанные в <code>/etc/vconsole.conf</code>.
</td>
</tr>
<tr>
<td class="archwiki-table-cell"><b>consolefont</b></td>
<td>Добавляет в образ <a href="../ru/Linux_console.html#%D0%9F%D0%BE%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%BD%D0%B0%D1%8F_%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D1%8F" title="Linux console (Русский)">консольный шрифт</a>, указанный в <code>/etc/vconsole.conf</code>.</td>
<td>Загружает шрифт, указанный в <code>/etc/vconsole.conf</code>.
</td>
</tr>
<tr>
<td colspan="2" class="archwiki-table-cell"><b>block</b></td>
<td>Добавляет в образ модули блочных устройств. Если перед этим хуком находится хук <b>autodetect</b>, будут добавлены только модули, используемые в системе. Исключения — модули <code>ahci</code>, <code>sd_mod</code>, <code>usb_storage</code>, <code>uas</code>, <code>mmc_block</code>, <code>nvme</code>, <code>virtio_scsi</code> и <code>virtio_blk</code>, которые добавляются всегда.</td>
<td class="archwiki-table-cell" data-sort-value="5">–
</td>
</tr>
<tr>
<td class="archwiki-table-cell"><b>net</b></td>
<td class="archwiki-table-cell archwiki-template-grey"><i>не реализован</i></td>
<td>Добавляет модули, необходимые для сетевых устройств. Для использования хука нужно установить <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mkinitcpio-nfs-utils">mkinitcpio-nfs-utils</a></span>. Подробнее: <a href="#%D0%9F%D1%80%D0%B8_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B8_net">#При использовании net</a>
</td>
<td>Занимается обработкой корневой файловой системы, расположенной на NFS.
</td>
</tr>
<tr>
<td class="archwiki-table-cell"><b>dmraid</b></td>
<td class="archwiki-table-cell archwiki-template-grey"><i>?</i></td>
<td>Поддержка корневой файловой системы на fakeRAID массивах. Необходимо установить пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dmraid">dmraid</a></span>. Обратите внимание, что рекомендуется использовать <a href="../ru/RAID.html" class="mw-redirect" title="RAID (Русский)">mdadm</a> с хуком <b>mdadm_udev</b> с fakeRAID, если ваш контроллер поддерживает это. Подробнее: <a href="#%D0%9F%D1%80%D0%B8_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B8_RAID">#При использовании RAID</a>
</td>
<td>Находит и монтирует fakeRAID блочные устройства, используя <code>dmraid</code>.
</td>
</tr>
<tr>
<td colspan="2" class="archwiki-table-cell"><b>mdadm_udev</b></td>
<td>Обеспечивает поддержку сборки RAID-массивов с помощью udev. Для использования хука нужно установить <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mdadm">mdadm</a></span>. Подробнее: <a href="../en/RAID.html#Configure_mkinitcpio" title="RAID">RAID#Configure mkinitcpio</a>
</td>
<td class="archwiki-table-cell" data-sort-value="5">–
</td>
</tr>
<tr>
<td class="archwiki-table-cell"><b>encrypt</b></td>
<td class="archwiki-table-cell"><b>sd-encrypt</b></td>
<td>Добавляет в образ модуль ядра <code>dm_crypt</code> и инструмент <code>cryptsetup</code>. Для использования хука нужно установить <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=cryptsetup">cryptsetup</a></span>. <div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание</strong> Обратите внимание на замечания для хука <i>keyboard</i> выше для разблокировки зашифрованного устройства во время загрузки, а также примечания о файловых системах в <a href="#MODULES">#MODULES</a>, если вы используете файл для разблокировки.</div>
</td>
<td>Определяет и подключает зашифрованный корневой раздел. Смотрите <a href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_%D0%B2%D0%BE_%D0%B2%D1%80%D0%B5%D0%BC%D1%8F_%D0%B2%D1%8B%D0%BF%D0%BE%D0%BB%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F">#Настройка во время выполнения</a> для дальнейшей настройки.
<p>Для <b>sd-encrypt</b> смотрите <a href="../en/Dm-crypt/System_configuration.html#Using_systemd-cryptsetup-generator" title="Dm-crypt/System configuration">dm-crypt/System configuration#Using systemd-cryptsetup-generator</a>.
</p>
</td>
</tr>
<tr>
<td colspan="2" class="archwiki-table-cell"><b>lvm2</b></td>
<td>Добавляет в образ модуль ядра device mapper и инструмент <code>lvm</code>. Для использования хука нужно установить <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lvm2">lvm2</a></span>. Необходим, если корневая файловая система находится на <a href="../ru/LVM.html" class="mw-redirect" title="LVM (Русский)">LVM</a>.</td>
<td class="archwiki-table-cell" data-sort-value="5">–
</td>
</tr>
<tr>
<td colspan="2" class="archwiki-table-cell"><b>filesystems</b></td>
<td>Добавляет в образ модули необходимых файловых систем. Этот хук <b>обязателен</b>, если вы не указываете модули файловых систем в <code>MODULES</code>.</td>
<td class="archwiki-table-cell" data-sort-value="5">–
</td>
</tr>
<tr>
<td colspan="2" class="archwiki-table-cell"><b>fsck</b></td>
<td>Добавляет исполняемый файл fsck и необходимые обработчики файловых систем для проверки корневой файловой системы (и <code>/usr</code>, если он на отдельном разделе) перед монтированием. Если стоит после хука <b>autodetect</b>, то будут добавлены только обработчики для вашей корневой файловой системы. Использование этого хука настоятельно рекомендуется и <b>обязательно</b> с отдельным <code>/usr</code> разделом. При включении этого хука крайне рекомендуется также включить все необходимые модули для обеспечения работы вашей клавиатуры в early userspace. <br>Использование этого хука требует, чтобы rw передавался в <a href="../ru/Kernel_parameters.html" title="Kernel parameters (Русский)">командной строке ядра</a> (<a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?pid=1307895#p1307895">обсуждение</a>). Смотрите <a href="../ru/Fsck.html#%D0%9F%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0_%D0%BF%D1%80%D0%B8_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B5" title="Fsck (Русский)">fsck (Русский)#Проверка при загрузке</a> для подробностей.</td>
<td class="archwiki-table-cell" data-sort-value="5">–
</td>
</tr>
<tr>
<td colspan="2" class="archwiki-table-cell"><b>acpi_override</b></td>
<td>Добавляет в ранний несжатый образ файлы ACPI Machine Language (<i>.aml</i>) из каталогов <code>/usr/initcpio/acpi_override/</code> и <code>/etc/initcpio/acpi_override/</code>, чтобы ядро могло переопределить таблицы ACPI (например <a href="../en/DSDT.html" title="DSDT">DSDT</a>) на раннем этапе загрузки.<a rel="nofollow" class="external autonumber" href="https://docs.kernel.org/admin-guide/acpi/initrd_table_override.html">[1]</a>
</td>
<td class="archwiki-table-cell" data-sort-value="5">–
</td>
</tr>
</tbody>
</table>
<div class="mw-heading mw-heading3"><h3 id="COMPRESSION">COMPRESSION</h3></div>
<p>Ядро поддерживает несколько форматов для сжатия initramfs: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gzip">gzip</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bzip2">bzip2</a></span>, lzma (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xz">xz</a></span>), <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xz">xz</a></span>, lzo (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lzop">lzop</a></span>), <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lz4">lz4</a></span> и <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=zstd">zstd</a></span>. По умолчанию mkinitcpio использует zstd для ядра 5.9 и более новых версий или gzip для старых версий.
</p>
<p>Стандартный <code>mkinitcpio.conf</code> имеет различные закомментированные варианты <code>COMPRESSION</code>. Раскомментируйте один из них, чтобы выбрать необходимый формат сжатия, и убедитесь, что соответствующий инструмент сжатия установлен в системе. Чтобы создать несжатый образ, укажите <code>COMPRESSION=<b>cat</b></code> в конфигурации или используйте <code>-z cat</code> в командной строке.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет</strong> 
<ul>
<li>Инструменты сжатия lz4 и xz используют многопоточность по умолчанию, а сжатие zstd запускается в многопоточном режиме (с опцией <code>-T0</code>, которая запускает столько же потоков, сколько ядер в процессоре).</li>
<li>Со степенью сжатия около 2.5 на образе в режиме высокого сжатия (<code>-9</code>) lz4 обеспечивает самую быструю скорость распаковки. Немного лучшее сжатие даёт lzo, который при этом всё ещё довольно быстро распаковывается. zstd предлагает универсальное решение с многопоточным сжатием и широким диапазоном уровней сжатия с помощью своих опций — смотрите <span class="plainlinks archwiki-template-man" title="$ man 1 zstd"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/zstd.1#Operation_modifiers">zstd(1) § Operation modifiers</a></span>. xz достигает наименьшего размера с коэффициентом уменьшения около 5 в предустановке высокой степени сжатия (<code>-9</code>) за счёт гораздо более низкой скорости распаковки.</li>
</ul>
</div>
<div class="mw-heading mw-heading3"><h3 id="COMPRESSION_OPTIONS">COMPRESSION_OPTIONS</h3></div>
<p>Это дополнительные флаги, передаваемые программе, указанной в переменной <code>COMPRESSION</code>, например:
</p>
<pre>COMPRESSION_OPTIONS=(-9)
</pre>
<p>Эту опцию можно не трогать: <i>mkinitcpio</i> сам позаботится о том, чтобы любой поддерживаемый метод сжатия имел необходимые флаги для создания рабочего образа.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно</strong> Неправильное использование этого параметра может привести к <b>незагружаемой системе</b>, если ядро не сможет распаковать полученный архив.</div>
<p>При использовании сжатия zstd можно сэкономить место для пользовательских ядер (особенно при использовании <a href="../ru/Dual_boot_with_Windows.html" class="mw-redirect" title="Dual boot with Windows (Русский)">двойной загрузки</a> с монтированием системного раздела EFI в <code>/boot</code>) с помощью опции <code>--long</code>. Однако системы с небольшим объёмом оперативной памяти могут не осилить распаковку образа initramfs при использовании этой опции. Опция <code>-v</code> также может быть полезна для просмотра подробностей во время генерации образа initramfs. Например:
</p>
<pre>COMPRESSION="zstd"
COMPRESSION_OPTIONS=(-v -5 --long)
</pre>
<p>Самое сильное, но самое медленное сжатие можно получить при использовании xz с опцией <code>-9e</code> и распаковки файлов модулей и прошивок перед их записью в initramfs:
</p>
<pre>COMPRESSION="xz"
COMPRESSION_OPTIONS=(-9e)
MODULES_DECOMPRESS="yes"
</pre>
<div class="mw-heading mw-heading3"><h3 id="MODULES_DECOMPRESS">MODULES_DECOMPRESS</h3></div>
<p>Переменная <code>MODULES_DECOMPRESS</code> контролирует, будут ли файлы модулей ядра и прошивок разжаты перед их записью в образ initramfs. Значение по умолчанию — <code>no</code>.
</p>
<p>Arch сжимает модули официальных <a href="../ru/Kernel.html" title="Kernel (Русский)">ядер</a> и файлы прошивок в <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-firmware">linux-firmware</a></span> с помощью zstd с уровнем сжатия 19. При использовании более высокого уровня сжатия для initramfs установка <code>MODULES_DECOMPRESS="yes"</code> позволит ещё сильнее уменьшить размер initramfs. Это достигается за счёт увеличения использования памяти и процессора на ранних этапах загрузки, что негативно сказывается на системах с небольшим объёмом памяти или слабым процессором, поскольку во время загрузки системы ядро будет тратить больше времени на распаковку образа initramfs целиком вместо того, чтобы по отдельности распаковывать только нужные файлы модулей и прошивок.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет</strong> Чтобы избежать повторного сжатия уже сжатых файлов, перед завершением генерации initramfs все файлы с расширениями <i>.bz2</i>, <i>.gz</i>, <i>.lz4</i>, <i>.lzma</i>, <i>.lzo</i>, <i>.xz</i> и <i>.zst</i> перемещаются в ранний несжатый образ.</div>
<div class="mw-heading mw-heading2"><h2 id="Настройка_во_время_выполнения">
<span id=".D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_.D0.B2.D0.BE_.D0.B2.D1.80.D0.B5.D0.BC.D1.8F_.D0.B2.D1.8B.D0.BF.D0.BE.D0.BB.D0.BD.D0.B5.D0.BD.D0.B8.D1.8F"></span>Настройка во время выполнения</h2></div>
<p>Настройки среды выполнения могут быть переданы в <code>init</code> и некоторые хуки через параметры ядра, которые обычно задаются в загрузчике. Приведённые ниже параметры могут быть добавлены в командную строку ядра для изменения поведения по умолчанию. Подробности смотрите в статьях <a href="../en/5214e6a2d0cf2537f999cde8ef4fe460.html" class="mw-redirect" title="Параметры ядра">Параметры ядра</a> и <a href="../en/f2e9f6edc5d89a8480c98767e03da2b6.html" class="mw-redirect" title="Процесс загрузки Arch">Процесс загрузки Arch</a>.
</p>
<div class="mw-heading mw-heading3"><h3 id="init_из_хука_base">
<span id="init_.D0.B8.D0.B7_.D1.85.D1.83.D0.BA.D0.B0_base"></span>init из хука base</h3></div>
<dl>
<dt><code>root=</code></dt>
<dd>Это самый важный параметр, указываемый в командной строке ядра, поскольку он определяет, какое устройство будет смонтировано как корневая ФС. <i>mkinitcpio</i> поддерживает большой набор форматов; примеры есть в разделе <a href="../en/be8feb38641b6491562fb14ebc4b9dd1.html#%D0%9F%D0%B0%D1%80%D0%B0%D0%BC%D0%B5%D1%82%D1%80%D1%8B_%D1%8F%D0%B4%D1%80%D0%B0" class="mw-redirect" title="Постоянные имена для блочных устройств">Постоянные имена для блочных устройств#Параметры ядра</a>.</dd>
</dl>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание</strong> Следующие параметры загрузки изменяют поведение <code>init</code> по умолчанию в среде initramfs. Подробнее смотрите <code>/usr/lib/initcpio/init</code>. Они не будут работать при использовании хука <code>systemd</code>, так как он заменит <code>init</code> из хука <code>base</code>.</div>
<dl>
<dt><code>break</code></dt>
<dd>Если указан <code>break</code> или <code>break=premount</code>, <code>init</code> приостановит процесс загрузки (после загрузки хуков, но перед монтированием корневой ФС) и запустит интерактивную оболочку, которую можно использовать для устранения неполадок. Эту оболочку можно запустить после монтирования корневой ФС, указав <code>break=postmount</code>. После выхода из оболочки продолжится обычная загрузка.</dd>
</dl>
<dl>
<dt><code>disablehooks=</code></dt>
<dd>Отключает runtime-хуки, перечисленные через запятую: <code>disablehooks=хук1[,хук2,...]</code>. Например: <pre>disablehooks=resume</pre>
</dd>
</dl>
<dl>
<dt><code>earlymodules=</code></dt>
<dd>Изменяет порядок загрузки модулей, загружая указанные здесь модули раньше остальных: <code>earlymodules=модуль1[,модуль2,...]</code>. (Это может использоваться, например, для обеспечения правильного порядка нескольких сетевых интерфейсов.)</dd>
</dl>
<p>Смотрите <a href="../en/831dc971aa371c3aedc0c1e0870eeb44.html#%D0%9F%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B8" class="mw-redirect" title="Устранение часто встречающихся неполадок">Устранение часто встречающихся неполадок#Проблемы загрузки</a> и <span class="plainlinks archwiki-template-man" title="$ man 8 mkinitcpio"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mkinitcpio.8">mkinitcpio(8)</a></span> для более подробной информации.
</p>
<div class="mw-heading mw-heading3"><h3 id="При_использовании_RAID">
<span id=".D0.9F.D1.80.D0.B8_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B8_RAID"></span>При использовании RAID</h3></div>
<p>Смотрите <a href="../en/RAID.html#Configure_mkinitcpio" title="RAID">RAID#Configure mkinitcpio</a>.
</p>
<div class="mw-heading mw-heading3"><h3 id="При_использовании_net">
<span id=".D0.9F.D1.80.D0.B8_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B8_net"></span>При использовании net</h3></div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание</strong> NFSv4 ещё не поддерживается <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/28287">FS#28287</a>.</div>
<p><b>Требуемые пакеты</b>
</p>
<p>Хук <code>net</code> требует пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mkinitcpio-nfs-utils">mkinitcpio-nfs-utils</a></span>.
</p>
<p><b>Параметры ядра</b>
</p>
<p>Полную и актуальную информацию можно найти в официальной <a rel="nofollow" class="external text" href="https://docs.kernel.org/admin-guide/nfs/nfsroot.html">документации ядра</a>.
</p>
<p><b>ip=</b>
</p>
<p>Этот параметр сообщает ядру, как настраивать IP-адреса устройств и таблицу маршрутизации. Может принимать до девяти аргументов, разделённых двоеточиями:
</p>
<p><code>ip=&lt;client-ip&gt;:&lt;server-ip&gt;:&lt;gw-ip&gt;:&lt;netmask&gt;:&lt;hostname&gt;:&lt;device&gt;:&lt;autoconf&gt;:&lt;dns0-ip&gt;:&lt;dns1-ip&gt;:&lt;ntp0-ip&gt;</code>.
</p>
<p>Если этот параметр не указан, все поля считаются пустыми и используются значения по умолчанию, описанные в <a rel="nofollow" class="external text" href="https://docs.kernel.org/admin-guide/nfs/nfsroot.html">документации ядра</a>. В целом это подразумевает, что ядро пытается настроить всё с помощью автоконфигурации.
</p>
<p>Можно указать <code>&lt;autoconf&gt;</code> в одиночку как значение параметра <code>ip</code> (без всех двоеточий перед ним). Значение <code>ip=off</code> или <code>ip=none</code> отключает автоконфигурацию. Чаще всего используется <code>ip=dhcp</code>.
</p>
<p><i>Разъяснение параметров:</i>
</p>
<pre> &lt;client-ip&gt;   IP адрес клиента. Если пустой, то автоматически назначается
               протоколом RARP/BOOTP/DHCP. Какой протокол используется
               зависит от параметра &lt;autoconf&gt;. Если его значение не пустое,
               то autocnf работает корректно.
 
 &lt;server-ip&gt;   IP адрес NFS сервера. Если используется RARP для определения
               адреса клиента и этот параметр не пуст, то принимаются ответы
               только от указанного сервера.
               Для использования разных RARP и NFS серверов,
               укажите ваш RARP сервер здесь (или оставьте пустым), и
               укажите ваш NFS сервер в параметре `nfsroot'
               (см. выше). Если тут пусто, будет использован сервер, ответивший
               на RARP/BOOTP/DHCP запрос.
 
 &lt;gw-ip&gt;       IP адрес шлюза если сервер в другой подсети. Если тут пусто,
               предполагается, что сервер находится в одной подсети, если значение
               не получено по BOOTP/DHCP.
 
 &lt;netmask&gt;     Маска подсети для локального интерфейса. Если тут пусто,
               используется маска по умолчанию в зависимости от класса IP,
               если конечно не переопределена значением из BOOTP/DHCP ответа.
 
 &lt;hostname&gt;    Имя машины клиента. Если пусто, используется IP адрес в виде ASCII
               строки, или значение полученное по BOOTP/DHCP.
 
 &lt;device&gt;      Имя сетевого устройства. Если тут пусто, все устройства будут использованы
               для RARP/BOOTP/DHCP запросов, и все настройки будут получены из первого
               пришедшего ответа. Если вы имеете только одно сетевое устройство, можно спокойно
               оставить поле пустым.
 
 &lt;autoconf&gt;	Какой метод использовать для автонастройки: 'rarp', 'bootp', или 'dhcp'.
               Если значение 'both', 'all' или пусто, все протоколы будут использованы.
               'off', 'static' или 'none' означают запрет автонастройки.
 
 &lt;dns0-ip&gt;     IP-адрес основного DNS-сервера. Определяется автоматически при включенном autoconf.
               Значение доступно в /proc/net/pnp с префиксом "nameserver ".
 
 &lt;dns1-ip&gt;     IP-адрес запасного DNS-сервера, аналогично &lt;dns0-ip&gt;.
 
 &lt;ntp0-ip&gt;     IP-адрес NTP-сервера. Определяется автоматически при включенном autoconf.
               Значение доступно в /proc/net/ipconfig/ntp_servers, ядром не используется.
</pre>
<p>Полное объяснение параметров можно почитать в <a rel="nofollow" class="external text" href="https://docs.kernel.org/admin-guide/nfs/nfsroot.html">документации ядра</a> (на английском).
</p>
<p><i>Примеры:</i>
</p>
<pre> ip=127.0.0.1:::::lo:none  --&gt; Разрешить lo интерфейс.
 ip=192.168.1.1:::::eth2:none --&gt; Статический eth2 интерфейс.
 ip=:::::eth0:dhcp --&gt; Разрешить dhcp протокол для настройки интерфейса eth0.
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание</strong> Используйте имена устройств ядра (например, <code>eth0</code>) для параметра <code>&lt;device&gt;</code>; постоянные имена (например, <code>enp2s0</code>) не будут работать. Подробнее смотрите <a href="../en/e0d2ff57df210ca74b60ba9c2d84bb6b.html#%D0%A1%D0%B5%D1%82%D0%B5%D0%B2%D1%8B%D0%B5_%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D1%8B" class="mw-redirect" title="Настройка сети">Настройка сети#Сетевые интерфейсы</a>.</div>
<p><b>BOOTIF=</b>
</p>
<p>Если у вас несколько сетевых карт, в этом параметре можно указать MAC-адрес интерфейса, с которого вы загружаетесь. Это часто бывает полезно, так как нумерация интерфейсов может измениться, или в сочетании с опцией pxelinux IPAPPEND 2 или IPAPPEND 3. Если не указан, будет использоваться <code>eth0</code>.
</p>
<p>Пример
</p>
<pre>BOOTIF=01-A1-B2-C3-D4-E5-F6  # Обратите внимание на ведущий "01-" и верхний регистр.
</pre>
<p><b>nfsroot=</b>
</p>
<p>Если параметр <code>nfsroot</code> НЕ передан, будет использовано значение по умолчанию <code>/tftpboot/%s</code>.
</p>
<pre> nfsroot=[&lt;server-ip&gt;:]&lt;root-dir&gt;[,&lt;nfs-options&gt;]
</pre>
<p><i>Описание параметров:</i>
</p>
<pre> &lt;server-ip&gt;   IP адрес NFS сервера. Если параметр отсутствует
               адрес по умолчанию определяется по переменной
               `ip' (см. ниже). Одно из применений этого параметра -
               использование разных серверов для
               RARP и NFS. Обычно можете оставить этот параметр пустым.
 
 &lt;root-dir&gt;    Путь к директории, которая будет корневой на клиенте. Если тут
               написано "%s", то оно будет заменено на ASCII представление IP
               клиента.
 
 &lt;nfs-options&gt; Стандартные опции NFS. Все опции разделены запятыми.
               Если опция отсутствует будут использованы следующие значения по умолчанию:
                       port            = как скажет portmap демон на сервере
                       rsize           = 1024
                       wsize           = 1024
                       timeo           = 7
                       retrans         = 3
                       acregmin        = 3
                       acregmax        = 60
                       acdirmin        = 30
                       acdirmax        = 60
                       flags           = hard, nointr, noposix, cto, ac
</pre>
<p>Полное описание параметров можно почитать в <code>mkinitcpio -H net</code> (на английском).
</p>
<div class="mw-heading mw-heading3"><h3 id="При_использовании_LVM">
<span id=".D0.9F.D1.80.D0.B8_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B8_LVM"></span>При использовании LVM</h3></div>
<p>Если ваш корень находится на <a href="../ru/LVM.html" class="mw-redirect" title="LVM (Русский)">LVM</a>, смотрите <a href="../en/Install_Arch_Linux_on_LVM.html#Adding_mkinitcpio_hooks" title="Install Arch Linux on LVM">Install Arch Linux on LVM#Adding mkinitcpio hooks</a>.
</p>
<div class="mw-heading mw-heading3"><h3 id="При_зашифрованном_корневом_разделе">
<span id=".D0.9F.D1.80.D0.B8_.D0.B7.D0.B0.D1.88.D0.B8.D1.84.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.BD.D0.BE.D0.BC_.D0.BA.D0.BE.D1.80.D0.BD.D0.B5.D0.B2.D0.BE.D0.BC_.D1.80.D0.B0.D0.B7.D0.B4.D0.B5.D0.BB.D0.B5"></span>При зашифрованном корневом разделе</h3></div>
<p>Если у вас <a href="../ru/Dm-crypt/Encrypting_an_entire_system.html" title="Dm-crypt (Русский)/Encrypting an entire system (Русский)">зашифрованный корень</a>, смотрите <a href="../en/Dm-crypt/System_configuration.html#mkinitcpio" title="Dm-crypt/System configuration">dm-crypt/System configuration#mkinitcpio</a> для информации о том, какие хуки нужно добавлять.
</p>
<div class="mw-heading mw-heading3"><h3 id="/usr_на_отдельном_разделе">
<span id=".2Fusr_.D0.BD.D0.B0_.D0.BE.D1.82.D0.B4.D0.B5.D0.BB.D1.8C.D0.BD.D0.BE.D0.BC_.D1.80.D0.B0.D0.B7.D0.B4.D0.B5.D0.BB.D0.B5"></span>/usr на отдельном разделе</h3></div>
<p>Если у вас <code>/usr</code> на отдельном разделе, вы должны соблюдать следующие требования:
</p>
<ul>
<li>Добавьте хук <code>fsck</code>, а в файле <code>/etc/fstab</code> укажите для <code>passno</code> значение <code>2</code>, чтобы запускалась проверка этого раздела при загрузке системы. Без этого хука <code>/usr</code> проверяться не будет.</li>
<li>Если не используется хук systemd, добавьте хук <code>usr</code>, который будет монтировать раздел <code>/usr</code> после монтирования корневой ФС.</li>
</ul>
<div class="mw-heading mw-heading2"><h2 id="Советы_и_рекомендации">
<span id=".D0.A1.D0.BE.D0.B2.D0.B5.D1.82.D1.8B_.D0.B8_.D1.80.D0.B5.D0.BA.D0.BE.D0.BC.D0.B5.D0.BD.D0.B4.D0.B0.D1.86.D0.B8.D0.B8"></span>Советы и рекомендации</h2></div>
<div class="mw-heading mw-heading3"><h3 id="Отключение_создания_fallback-образа_initramfs">
<span id=".D0.9E.D1.82.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D1.81.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D1.8F_fallback-.D0.BE.D0.B1.D1.80.D0.B0.D0.B7.D0.B0_initramfs"></span>Отключение создания fallback-образа initramfs</h3></div>
<p>Создание fallback-образов можно отключить:
</p>
<ul>
<li>Измените строку <code>PRESETS=('default' 'fallback')</code> на <code>PRESETS=('default')</code> в соответствующих файлах <i>.preset</i> в каталоге <code>/etc/mkinitcpio.d/</code>.</li>
<li>Удалите fallback-образ initramfs из каталога <code>/boot/</code>.</li>
<li>Обновите настройки вашего <a href="../ru/Arch_boot_process.html#%D0%97%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D1%87%D0%B8%D0%BA" title="Arch boot process (Русский)">загрузчика</a>.</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно</strong> Отключение генерации fallback-образа initramfs лишит вас дополнительного способа загрузить систему в случае проблем со стандартным образом initramfs. Перед отключением убедитесь, что у вас под рукой есть загрузочный <a href="../ru/USB_flash_installation_medium.html" title="USB flash installation medium (Русский)">установочный носитель</a>, который можно будет использовать для восстановления системы.</div>
<div class="mw-heading mw-heading2"><h2 id="Решение_проблем">
<span id=".D0.A0.D0.B5.D1.88.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC"></span>Решение проблем</h2></div>
<div class="mw-heading mw-heading3"><h3 id="Распаковка_образа">
<span id=".D0.A0.D0.B0.D1.81.D0.BF.D0.B0.D0.BA.D0.BE.D0.B2.D0.BA.D0.B0_.D0.BE.D0.B1.D1.80.D0.B0.D0.B7.D0.B0"></span>Распаковка образа</h3></div>
<p>Если вам интересно посмотреть, что находится внутри образа initramfs, вы можете распаковать его.
</p>
<p>Образ initramfs является архивом SVR4 CPIO, созданным с помощью команд <code>find</code> и <code>bsdcpio</code> и опционально сжатым с форматом сжатия, понятным ядру. Подробнее о сжатии смотрите в разделе <a href="#COMPRESSION">#COMPRESSION</a>.
</p>
<p><i>mkinitcpio</i> включает в себя инструмент <span class="plainlinks archwiki-template-man" title="$ man 1 lsinitcpio"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lsinitcpio.1">lsinitcpio(1)</a></span>, позволяющий посмотреть и/или извлечь содержимое образов initramfs.
</p>
<p>Просмотр списка файлов в образе:
</p>
<pre># lsinitcpio /boot/initramfs-linux.img
</pre>
<p>Извлечение всех файлов в текущий каталог:
</p>
<pre># lsinitcpio -x /boot/initramfs-linux.img
</pre>
<p>Более удобный обзор самых важных частей образа:
</p>
<pre># lsinitcpio -a /boot/initramfs-linux.img
</pre>
<div class="mw-heading mw-heading3"><h3 id="Изменение_и_упаковка_образа">
<span id=".D0.98.D0.B7.D0.BC.D0.B5.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B8_.D1.83.D0.BF.D0.B0.D0.BA.D0.BE.D0.B2.D0.BA.D0.B0_.D0.BE.D0.B1.D1.80.D0.B0.D0.B7.D0.B0"></span>Изменение и упаковка образа</h3></div>
<p>После распаковки архива описанным выше способом вы можете изменить файлы и упаковать всё обратно.
Вызовите функцию <code>build_image</code> из скрипта <code>/usr/bin/mkinitcpio</code> с параметрами
</p>
<pre>build_image <i>выходной-файл</i> <i>сжатие</i>
</pre>
<p>Это можно сделать путём создания нового скрипта с содержимым функции <code>build_image</code> и его вызова с описанными выше параметрами.
Он упакует содержимое текущего каталога в <code><i>выходной-файл</i></code>.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно</strong> Перед перезаписью файла <code>/boot/initramfs-linux.img</code> стоит переименовать старый файл, чтобы была возможность отменить изменения. Будьте готовы к тому, что какая-нибудь ошибка помешает загрузке системы. В таком случае вам понадобится загрузиться с другой системы или Live CD, чтобы восстановить оригинал, запустить <i>mkinitcpio</i> для перезаписи ваших изменений или вручную исправить ошибки.</div>
<div class="mw-heading mw-heading3"><h3 id="«/dev_must_be_mounted»,_хотя_он_и_так_примонтирован">
<span id=".C2.AB.2Fdev_must_be_mounted.C2.BB.2C_.D1.85.D0.BE.D1.82.D1.8F_.D0.BE.D0.BD_.D0.B8_.D1.82.D0.B0.D0.BA_.D0.BF.D1.80.D0.B8.D0.BC.D0.BE.D0.BD.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD"></span>«/dev must be mounted», хотя он и так примонтирован</h3></div>
<p><i>mkinitcpio</i> считает <code>/dev</code> примонтированным при наличии <code>/dev/fd/</code>. Если всё выглядит хорошо, его можно «создать» вручную:
</p>
<pre># ln -s /proc/self/fd /dev/
</pre>
<p>(Очевидно, <code>/proc</code> тоже должен быть примонтирован. <i>mkinitcpio</i> всё равно это требует и тоже это проверяет.)
</p>
<div class="mw-heading mw-heading3"><h3 id="Possibly_missing_firmware_for_module_XXXX">Possibly missing firmware for module XXXX</h3></div>
<p>В процессе сборки initramfs после обновления ядра вы можете заметить предупреждения:
</p>
<pre>==&gt; WARNING: Possibly missing firmware for module: '<i>название_модуля</i>'
</pre>
<p>Если эти предупреждения появляются во время генерации default-образа, это может означать, что действительно требуется установка дополнительных файлов прошивок. Для часто встречающихся устройств достаточно <a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установить">установить</a> пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-firmware">linux-firmware</a></span>. Другие пакеты, предоставляющие файлы прошивок, приведены в таблице ниже; также можно попробовать поискать их в <a href="../ru/Official_repositories.html" title="Official repositories (Русский)">официальных репозиториях</a> или в <a href="../ru/Arch_User_Repository.html" title="Arch User Repository (Русский)">AUR</a>.
</p>
<p>Если же предупреждения появляются только во время генерации fallback-образа, есть три варианта:
</p>
<ul>
<li>Просто проигнорировать предупреждения, если вы уверены, что они не касаются нужного вам оборудования.</li>
<li>Если вы хотите, чтобы предупреждения исчезли, можно установить недостающие файлы прошивок. Большинство необязательных прошивок предоставляются мета-пакетом <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/mkinitcpio-firmware/">mkinitcpio-firmware</a></span><sup><small>AUR</small></sup>. Также можно отдельно установить только нужные пакеты:</li>
</ul>
<dl><dd><table class="wikitable">

<tbody>
<tr>
<th>Модуль</th>
<th>Пакет
</th>
</tr>
<tr>
<td>aic94xx</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/aic94xx-firmware/">aic94xx-firmware</a></span><sup><small>AUR</small></sup>
</td>
</tr>
<tr>
<td>ast</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ast-firmware/">ast-firmware</a></span><sup><small>AUR</small></sup>
</td>
</tr>
<tr>
<td>bfa</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-firmware-qlogic">linux-firmware-qlogic</a></span>
</td>
</tr>
<tr>
<td>bnx2x</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-firmware-broadcom">linux-firmware-broadcom</a></span>
</td>
</tr>
<tr>
<td>liquidio</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-firmware-liquidio">linux-firmware-liquidio</a></span>
</td>
</tr>
<tr>
<td>mlxsw_spectrum</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-firmware-mellanox">linux-firmware-mellanox</a></span>
</td>
</tr>
<tr>
<td>nfp</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-firmware-nfp">linux-firmware-nfp</a></span>
</td>
</tr>
<tr>
<td>qat_420xx</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-firmware-intel">linux-firmware-intel</a></span>
</td>
</tr>
<tr>
<td>qed</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-firmware-qlogic">linux-firmware-qlogic</a></span>
</td>
</tr>
<tr>
<td>qla1280</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-firmware-qlogic">linux-firmware-qlogic</a></span>
</td>
</tr>
<tr>
<td>qla2xxx</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-firmware-qlogic">linux-firmware-qlogic</a></span>
</td>
</tr>
<tr>
<td>wd719x</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/wd719x-firmware/">wd719x-firmware</a></span><sup><small>AUR</small></sup>
</td>
</tr>
<tr>
<td>xhci_pci<br>xhci_pci_renesas</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/upd72020x-fw/">upd72020x-fw</a></span><sup><small>AUR</small></sup>
</td>
</tr>
</tbody>
</table></dd></dl>
<ul><li>Если вы хотите избавиться от предупреждений, но не хотите захламлять систему неиспользуемыми файлами прошивок, можно <a href="#%D0%9E%D1%82%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D1%8F_fallback-%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%B0_initramfs">отключить создание fallback-образа initramfs</a>.</li></ul>
<p>На месте недоступных файлов прошивок можно создать файлы-пустышки, чтобы подавить предупреждения:
</p>
<pre># echo "Device not available" &gt; /usr/lib/firmware/qat_420xx.bin
# echo "Device not available" &gt; /usr/lib/firmware/qat_420xx_mmp.bin
</pre>
<div class="mw-heading mw-heading3"><h3 id="No_PS/2_controller_found">
<span id="No_PS.2F2_controller_found"></span>No PS/2 controller found</h3></div>
<p>На некоторых материнских платах (в основном старых, но также и некоторых новых) контроллер i8042 не определяется автоматически. Это бывает редко, но некоторые люди всё же могут оказаться с неработающей клавиатурой. Вы можете заранее обнаружить эту ситуацию. Если у вас есть порт PS/2 и вы получаете сообщение <code>i8042: PNP: No PS/2 controller found. Probing ports directly</code>, добавьте <code>atkbd</code> в массив <code>MODULES</code>.<a rel="nofollow" class="external autonumber" href="https://archlinux.org/news/linux-313-warning-ps2-keyboard-support-is-now-modular/">[2]</a>
</p>
<div class="mw-heading mw-heading3"><h3 id="Стандартная_процедура_восстановления">
<span id=".D0.A1.D1.82.D0.B0.D0.BD.D0.B4.D0.B0.D1.80.D1.82.D0.BD.D0.B0.D1.8F_.D0.BF.D1.80.D0.BE.D1.86.D0.B5.D0.B4.D1.83.D1.80.D0.B0_.D0.B2.D0.BE.D1.81.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D1.8F"></span>Стандартная процедура восстановления</h3></div>
<p>При неправильно сформированном начальном RAM-диске систему скорее всего не получится загрузить. В таком случае выполните описанную ниже процедуру восстановления системы:
</p>
<div class="mw-heading mw-heading4"><h4 id="Загрузка_выполняется_на_одной_машине_и_терпит_неудачу_на_другой">
<span id=".D0.97.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BA.D0.B0_.D0.B2.D1.8B.D0.BF.D0.BE.D0.BB.D0.BD.D1.8F.D0.B5.D1.82.D1.81.D1.8F_.D0.BD.D0.B0_.D0.BE.D0.B4.D0.BD.D0.BE.D0.B9_.D0.BC.D0.B0.D1.88.D0.B8.D0.BD.D0.B5_.D0.B8_.D1.82.D0.B5.D1.80.D0.BF.D0.B8.D1.82_.D0.BD.D0.B5.D1.83.D0.B4.D0.B0.D1.87.D1.83_.D0.BD.D0.B0_.D0.B4.D1.80.D1.83.D0.B3.D0.BE.D0.B9"></span>Загрузка выполняется на одной машине и терпит неудачу на другой</h4></div>
<p>Хук <code>autodetect</code> фильтрует ненужные <a href="../en/d7f36cfb141212562ec357bd7c39e2bf.html" class="mw-redirect" title="Модули ядра">модули ядра</a> в основном образе initramfs путём сканирования <code>/sys</code> и модулей, загруженных на момент запуска хука. Если вы переносите каталог <code>/boot</code> на другую машину и загрузка терпит неудачу на стадии early userspace, это может происходить из-за того, что новое оборудование не определилось из-за отсутствующих модулей ядра. Обратите внимание, что для USB 2.0 и 3.0 нужны разные модули ядра.
</p>
<p>Чтобы исправить это, сначала попробуйте выбрать fallback-образ в вашем <a href="../ru/Arch_boot_process.html#%D0%97%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D1%87%D0%B8%D0%BA" class="mw-redirect" title="Загрузчик">загрузчике</a>, поскольку его содержимое не фильтруется хуком <code>autodetect</code>. После загрузки выполните <i>mkinitcpio</i> на новой машине, чтобы пересобрать основной образ с корректными модулями. Если fallback-образ не решил проблему, попробуйте загрузиться в Arch Linux live CD/USB, выполнить chroot в установленную систему и выполнить <i>mkinitcpio</i> на новой машине. В крайнем случае, попробуйте <a href="#MODULES">вручную</a> добавить модули в initramfs.
</p>
<div class="mw-heading mw-heading3"><h3 id="Cannot_open_access_to_console,_the_root_account_is_locked">
<span id="Cannot_open_access_to_console.2C_the_root_account_is_locked"></span>Cannot open access to console, the root account is locked</h3></div>
<p>Хук <code>systemd</code> <a rel="nofollow" class="external text" href="https://gitlab.archlinux.org/archlinux/packaging/packages/systemd/-/commit/292cdf8a2f7dd7c6c7d91d2b59617391935c837c">блокирует учётную запись root</a>. Для включения можно установить <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/initcpio-hook-shadowcopy/">initcpio-hook-shadowcopy</a></span><sup><small>AUR</small></sup>, добавить хук <code>shadowcopy</code> после хука <code>systemd</code> в файле <code>/etc/mkinitcpio.conf</code> и пересобрать образы командой <code>mkinitcpio -P</code>. Подробнее в <a rel="nofollow" class="external text" href="https://github.com/iTrooz/initcpio-hook-shadowcopy">репозитории на GitHub</a>.
</p>
<div class="mw-heading mw-heading2"><h2 id="Смотрите_также">
<span id=".D0.A1.D0.BC.D0.BE.D1.82.D1.80.D0.B8.D1.82.D0.B5_.D1.82.D0.B0.D0.BA.D0.B6.D0.B5"></span>Смотрите также</h2></div>
<ul>
<li>Документация ядра Linux: <a rel="nofollow" class="external text" href="https://docs.kernel.org/filesystems/ramfs-rootfs-initramfs.html#what-is-rootfs">initramfs, "What is rootfs?"</a>
</li>
<li>Документация ядра Linux: <a rel="nofollow" class="external text" href="https://docs.kernel.org/admin-guide/initrd.html">initrd</a>
</li>
<li>Статья на Википедии: <a href="https://en.wikipedia.org/wiki/ru:initrd" class="extiw" title="wikipedia:ru:initrd">initrd</a>
</li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../ru/Category:Boot_process.html" title="Category:Boot process (Русский)">Boot process (Русский)</a></li>
<li><a href="../ru/Category:Kernel.html" title="Category:Kernel (Русский)">Kernel (Русский)</a></li>
<li><a href="../ru/Category:Arch_projects.html" title="Category:Arch projects (Русский)">Arch projects (Русский)</a></li>
<li><a href="../ru/Category:Commands.html" title="Category:Commands (Русский)">Commands (Русский)</a></li>
</ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Mkinitcpio_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;oldid=843477">https://wiki.archlinux.org/index.php?title=Mkinitcpio_(Русский)&amp;oldid=843477</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 12 August 2025, at 10:59.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><picture><source media="(min-width: 500px)" srcset="/resources/assets/poweredby_mediawiki.svg" width="88" height="31"><img src="/resources/assets/mediawiki_compact.svg" width="25" height="25" loading="lazy"></picture></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-header-container vector-sticky-header-container no-font-mode-scale">
	<div id="vector-sticky-header" class="vector-sticky-header">
		<div class="vector-sticky-header-start">
			<div class="vector-sticky-header-icon-start vector-button-flush-left vector-button-flush-right" aria-hidden="true">
				<button class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-sticky-header-search-toggle" tabindex="-1" data-event-name="ui.vector-sticky-search-form.icon"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
			</button>
		</div>
			
		<div role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box">
			<div class="vector-typeahead-search-container">
				<div class="cdx-typeahead-search cdx-typeahead-search--show-thumbnail">
					<form action="/index.php" id="vector-sticky-search-form" class="cdx-search-input cdx-search-input--has-end-button">
						<div class="cdx-search-input__input-wrapper" data-search-loc="header-moved">
							<div class="cdx-text-input cdx-text-input--has-start-icon">
								<input class="cdx-text-input__input mw-searchInput" autocomplete="off" type="search" name="search" placeholder="Search ArchWiki">
								<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
							</div>
							<input type="hidden" name="title" value="Special:Search">
						</div>
						<button class="cdx-button cdx-search-input__end-button">Search</button>
					</form>
				</div>
			</div>
		</div>
		<div class="vector-sticky-header-context-bar">
				<nav aria-label="Contents" class="vector-toc-landmark">
						
					<div id="vector-sticky-header-toc" class="vector-dropdown mw-portlet mw-portlet-sticky-header-toc vector-sticky-header-toc vector-button-flush-left">
						<input type="checkbox" id="vector-sticky-header-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-sticky-header-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
						<label id="vector-sticky-header-toc-label" for="vector-sticky-header-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
						</label>
						<div class="vector-dropdown-content">
					
						<div id="vector-sticky-header-toc-unpinned-container" class="vector-unpinned-container">
						</div>
					
						</div>
					</div>
			</nav>
				<div class="vector-sticky-header-context-bar-primary" aria-hidden="true">mkinitcpio (Русский)</div>
			</div>
		</div>
		<div class="vector-sticky-header-end" aria-hidden="true">
			<div class="vector-sticky-header-icons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-talk-sticky-header" tabindex="-1" data-event-name="talk-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbles mw-ui-icon-wikimedia-speechBubbles"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-subject-sticky-header" tabindex="-1" data-event-name="subject-sticky-header"><span class="vector-icon mw-ui-icon-article mw-ui-icon-wikimedia-article"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-history-sticky-header" tabindex="-1" data-event-name="history-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-history mw-ui-icon-wikimedia-wikimedia-history"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only mw-watchlink" id="ca-watchstar-sticky-header" tabindex="-1" data-event-name="watch-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-star mw-ui-icon-wikimedia-wikimedia-star"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only reading-lists-bookmark" id="ca-bookmark-sticky-header" tabindex="-1" data-event-name="watch-sticky-bookmark"><span class="vector-icon mw-ui-icon-wikimedia-bookmarkOutline mw-ui-icon-wikimedia-wikimedia-bookmarkOutline"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-edit-sticky-header" tabindex="-1" data-event-name="wikitext-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-wikiText mw-ui-icon-wikimedia-wikimedia-wikiText"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-ve-edit-sticky-header" tabindex="-1" data-event-name="ve-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-edit mw-ui-icon-wikimedia-wikimedia-edit"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-viewsource-sticky-header" tabindex="-1" data-event-name="ve-edit-protected-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-editLock mw-ui-icon-wikimedia-wikimedia-editLock"></span>

<span></span>
			</a>
		</div>
			<div class="vector-sticky-header-buttons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive" id="ca-addsection-sticky-header" tabindex="-1" data-event-name="addsection-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbleAdd-progressive mw-ui-icon-wikimedia-speechBubbleAdd-progressive"></span>

<span>Add topic</span>
			</a>
		</div>
			<div class="vector-sticky-header-icon-end">
				<div class="vector-user-links">
				</div>
			</div>
		</div>
	</div>
</div>
<div class="mw-portlet mw-portlet-dock-bottom emptyPortlet" id="p-dock-bottom">
	<ul>
		
	</ul>
</div>
</body>
</html>
