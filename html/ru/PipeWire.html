<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>PipeWire (Русский) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-PipeWire_Русский rootpage-PipeWire_Русский skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Установка" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Установка</div>
		</a>
		
			<button aria-controls="toc-Установка-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Установка subsection</span>
			</button>
		
		<ul id="toc-Установка-sublist" class="vector-toc-list">
			<li id="toc-Менеджер_сеансов" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9C%D0%B5%D0%BD%D0%B5%D0%B4%D0%B6%D0%B5%D1%80_%D1%81%D0%B5%D0%B0%D0%BD%D1%81%D0%BE%D0%B2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.1</span>Менеджер сеансов</div>
			</a>
			
			<ul id="toc-Менеджер_сеансов-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-GUI" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#GUI">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">1.2</span>GUI</div>
			</a>
			
			<ul id="toc-GUI-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Настройка" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Настройка</div>
		</a>
		
			<button aria-controls="toc-Настройка-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Настройка subsection</span>
			</button>
		
		<ul id="toc-Настройка-sublist" class="vector-toc-list">
			<li id="toc-Профили" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%BE%D1%84%D0%B8%D0%BB%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">2.1</span>Профили</div>
			</a>
			
			<ul id="toc-Профили-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Использование" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Использование</div>
		</a>
		
			<button aria-controls="toc-Использование-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Использование subsection</span>
			</button>
		
		<ul id="toc-Использование-sublist" class="vector-toc-list">
			<li id="toc-Аудио" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%90%D1%83%D0%B4%D0%B8%D0%BE">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1</span>Аудио</div>
			</a>
			
			<ul id="toc-Аудио-sublist" class="vector-toc-list">
				<li id="toc-Клиенты_ALSA" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9A%D0%BB%D0%B8%D0%B5%D0%BD%D1%82%D1%8B_ALSA">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.1</span>Клиенты ALSA</div>
			</a>
			
			<ul id="toc-Клиенты_ALSA-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Клиенты_PulseAudio" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9A%D0%BB%D0%B8%D0%B5%D0%BD%D1%82%D1%8B_PulseAudio">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.2</span>Клиенты PulseAudio</div>
			</a>
			
			<ul id="toc-Клиенты_PulseAudio-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Клиенты_JACK" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9A%D0%BB%D0%B8%D0%B5%D0%BD%D1%82%D1%8B_JACK">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.3</span>Клиенты JACK</div>
			</a>
			
			<ul id="toc-Клиенты_JACK-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Устройства_Bluetooth" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A3%D1%81%D1%82%D1%80%D0%BE%D0%B9%D1%81%D1%82%D0%B2%D0%B0_Bluetooth">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.4</span>Устройства Bluetooth</div>
			</a>
			
			<ul id="toc-Устройства_Bluetooth-sublist" class="vector-toc-list">
				<li id="toc-Автоматический_выбор_профиля" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#%D0%90%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%B2%D1%8B%D0%B1%D0%BE%D1%80_%D0%BF%D1%80%D0%BE%D1%84%D0%B8%D0%BB%D1%8F">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.4.1</span>Автоматический выбор профиля</div>
			</a>
			
			<ul id="toc-Автоматический_выбор_профиля-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-PipeWire_native_patch_sets" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#PipeWire_native_patch_sets">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.5</span>PipeWire native patch sets</div>
			</a>
			
			<ul id="toc-PipeWire_native_patch_sets-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Совместное_использование_аудиоустройств_по_сети" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A1%D0%BE%D0%B2%D0%BC%D0%B5%D1%81%D1%82%D0%BD%D0%BE%D0%B5_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%B0%D1%83%D0%B4%D0%B8%D0%BE%D1%83%D1%81%D1%82%D1%80%D0%BE%D0%B9%D1%81%D1%82%D0%B2_%D0%BF%D0%BE_%D1%81%D0%B5%D1%82%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.6</span>Совместное использование аудиоустройств по сети</div>
			</a>
			
			<ul id="toc-Совместное_использование_аудиоустройств_по_сети-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Работа_PipeWire_поверх_JACK" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A0%D0%B0%D0%B1%D0%BE%D1%82%D0%B0_PipeWire_%D0%BF%D0%BE%D0%B2%D0%B5%D1%80%D1%85_JACK">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.7</span>Работа PipeWire поверх JACK</div>
			</a>
			
			<ul id="toc-Работа_PipeWire_поверх_JACK-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Использование_ALSA_dmix_в_качестве_вывода_PipeWire" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_ALSA_dmix_%D0%B2_%D0%BA%D0%B0%D1%87%D0%B5%D1%81%D1%82%D0%B2%D0%B5_%D0%B2%D1%8B%D0%B2%D0%BE%D0%B4%D0%B0_PipeWire">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.8</span>Использование ALSA dmix в качестве вывода PipeWire</div>
			</a>
			
			<ul id="toc-Использование_ALSA_dmix_в_качестве_вывода_PipeWire-sublist" class="vector-toc-list">
				<li id="toc-Настройка_dmix_в_ALSA" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_dmix_%D0%B2_ALSA">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.8.1</span>Настройка dmix в ALSA</div>
			</a>
			
			<ul id="toc-Настройка_dmix_в_ALSA-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Настройка_dmix_в_PipeWire" class="vector-toc-list-item vector-toc-level-4">
			<a class="vector-toc-link" href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_dmix_%D0%B2_PipeWire">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.1.8.2</span>Настройка dmix в PipeWire</div>
			</a>
			
			<ul id="toc-Настройка_dmix_в_PipeWire-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Демонстрация_экрана_WebRTC" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%94%D0%B5%D0%BC%D0%BE%D0%BD%D1%81%D1%82%D1%80%D0%B0%D1%86%D0%B8%D1%8F_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0_WebRTC">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2</span>Демонстрация экрана WebRTC</div>
			</a>
			
			<ul id="toc-Демонстрация_экрана_WebRTC-sublist" class="vector-toc-list">
				<li id="toc-xdg-desktop-portal-wlr" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#xdg-desktop-portal-wlr">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.2.1</span>xdg-desktop-portal-wlr</div>
			</a>
			
			<ul id="toc-xdg-desktop-portal-wlr-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Видео" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%92%D0%B8%D0%B4%D0%B5%D0%BE">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">3.3</span>Видео</div>
			</a>
			
			<ul id="toc-Видео-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Постобработка_аудио" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%9F%D0%BE%D1%81%D1%82%D0%BE%D0%B1%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B0_%D0%B0%D1%83%D0%B4%D0%B8%D0%BE">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Постобработка аудио</div>
		</a>
		
			<button aria-controls="toc-Постобработка_аудио-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Постобработка аудио subsection</span>
			</button>
		
		<ul id="toc-Постобработка_аудио-sublist" class="vector-toc-list">
			<li id="toc-EasyEffects" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#EasyEffects">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.1</span>EasyEffects</div>
			</a>
			
			<ul id="toc-EasyEffects-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-NoiseTorch" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#NoiseTorch">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.2</span>NoiseTorch</div>
			</a>
			
			<ul id="toc-NoiseTorch-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Шумоподавление_для_голоса" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%A8%D1%83%D0%BC%D0%BE%D0%BF%D0%BE%D0%B4%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B4%D0%BB%D1%8F_%D0%B3%D0%BE%D0%BB%D0%BE%D1%81%D0%B0">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.3</span>Шумоподавление для голоса</div>
			</a>
			
			<ul id="toc-Шумоподавление_для_голоса-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-JamesDSP" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#JamesDSP">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.4</span>JamesDSP</div>
			</a>
			
			<ul id="toc-JamesDSP-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Плагины_LADSPA,_LV2_и_VST" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%9F%D0%BB%D0%B0%D0%B3%D0%B8%D0%BD%D1%8B_LADSPA,_LV2_%D0%B8_VST">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">4.5</span>Плагины LADSPA, LV2 и VST</div>
			</a>
			
			<ul id="toc-Плагины_LADSPA,_LV2_и_VST-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Решение_проблем" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%A0%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Решение проблем</div>
		</a>
		
			<button aria-controls="toc-Решение_проблем-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon vector-icon--x-small mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Решение проблем subsection</span>
			</button>
		
		<ul id="toc-Решение_проблем-sublist" class="vector-toc-list">
			<li id="toc-Аудио_2" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%90%D1%83%D0%B4%D0%B8%D0%BE_2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1</span>Аудио</div>
			</a>
			
			<ul id="toc-Аудио_2-sublist" class="vector-toc-list">
				<li id="toc-PipeWire_не_видит_микрофон" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#PipeWire_%D0%BD%D0%B5_%D0%B2%D0%B8%D0%B4%D0%B8%D1%82_%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%84%D0%BE%D0%BD">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.1</span>PipeWire не видит микрофон</div>
			</a>
			
			<ul id="toc-PipeWire_не_видит_микрофон-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Звук_не_переключается_автоматически_при_подключении_нового_устройства" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%97%D0%B2%D1%83%D0%BA_%D0%BD%D0%B5_%D0%BF%D0%B5%D1%80%D0%B5%D0%BA%D0%BB%D1%8E%D1%87%D0%B0%D0%B5%D1%82%D1%81%D1%8F_%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8_%D0%BF%D1%80%D0%B8_%D0%BF%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D0%B8_%D0%BD%D0%BE%D0%B2%D0%BE%D0%B3%D0%BE_%D1%83%D1%81%D1%82%D1%80%D0%BE%D0%B9%D1%81%D1%82%D0%B2%D0%B0">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.2</span>Звук не переключается автоматически при подключении нового устройства</div>
			</a>
			
			<ul id="toc-Звук_не_переключается_автоматически_при_подключении_нового_устройства-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Звук_не_переключается_автоматически_на_наушники_Bluetooth" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%97%D0%B2%D1%83%D0%BA_%D0%BD%D0%B5_%D0%BF%D0%B5%D1%80%D0%B5%D0%BA%D0%BB%D1%8E%D1%87%D0%B0%D0%B5%D1%82%D1%81%D1%8F_%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8_%D0%BD%D0%B0_%D0%BD%D0%B0%D1%83%D1%88%D0%BD%D0%B8%D0%BA%D0%B8_Bluetooth">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.3</span>Звук не переключается автоматически на наушники Bluetooth</div>
			</a>
			
			<ul id="toc-Звук_не_переключается_автоматически_на_наушники_Bluetooth-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Нет_звука_после_подключения_устройства_Bluetooth" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9D%D0%B5%D1%82_%D0%B7%D0%B2%D1%83%D0%BA%D0%B0_%D0%BF%D0%BE%D1%81%D0%BB%D0%B5_%D0%BF%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D1%8F_%D1%83%D1%81%D1%82%D1%80%D0%BE%D0%B9%D1%81%D1%82%D0%B2%D0%B0_Bluetooth">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.4</span>Нет звука после подключения устройства Bluetooth</div>
			</a>
			
			<ul id="toc-Нет_звука_после_подключения_устройства_Bluetooth-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Маленькая_громкость" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9C%D0%B0%D0%BB%D0%B5%D0%BD%D1%8C%D0%BA%D0%B0%D1%8F_%D0%B3%D1%80%D0%BE%D0%BC%D0%BA%D0%BE%D1%81%D1%82%D1%8C">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.5</span>Маленькая громкость</div>
			</a>
			
			<ul id="toc-Маленькая_громкость-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Увеличение_RLIMIT_MEMLOCK" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A3%D0%B2%D0%B5%D0%BB%D0%B8%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_RLIMIT_MEMLOCK">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.6</span>Увеличение RLIMIT_MEMLOCK</div>
			</a>
			
			<ul id="toc-Увеличение_RLIMIT_MEMLOCK-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Изменение_частоты_дискретизации" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%98%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5_%D1%87%D0%B0%D1%81%D1%82%D0%BE%D1%82%D1%8B_%D0%B4%D0%B8%D1%81%D0%BA%D1%80%D0%B5%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.7</span>Изменение частоты дискретизации</div>
			</a>
			
			<ul id="toc-Изменение_частоты_дискретизации-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Изменение_разрешённых_частот_дискретизации" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%98%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5_%D1%80%D0%B0%D0%B7%D1%80%D0%B5%D1%88%D1%91%D0%BD%D0%BD%D1%8B%D1%85_%D1%87%D0%B0%D1%81%D1%82%D0%BE%D1%82_%D0%B4%D0%B8%D1%81%D0%BA%D1%80%D0%B5%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.8</span>Изменение разрешённых частот дискретизации</div>
			</a>
			
			<ul id="toc-Изменение_разрешённых_частот_дискретизации-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Качество_звука_(качество_передискретизации)" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9A%D0%B0%D1%87%D0%B5%D1%81%D1%82%D0%B2%D0%BE_%D0%B7%D0%B2%D1%83%D0%BA%D0%B0_(%D0%BA%D0%B0%D1%87%D0%B5%D1%81%D1%82%D0%B2%D0%BE_%D0%BF%D0%B5%D1%80%D0%B5%D0%B4%D0%B8%D1%81%D0%BA%D1%80%D0%B5%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8)">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.9</span>Качество звука (качество передискретизации)</div>
			</a>
			
			<ul id="toc-Качество_звука_(качество_передискретизации)-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Внешняя_звуковая_карта_не_включается_после_переподключения" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%92%D0%BD%D0%B5%D1%88%D0%BD%D1%8F%D1%8F_%D0%B7%D0%B2%D1%83%D0%BA%D0%BE%D0%B2%D0%B0%D1%8F_%D0%BA%D0%B0%D1%80%D1%82%D0%B0_%D0%BD%D0%B5_%D0%B2%D0%BA%D0%BB%D1%8E%D1%87%D0%B0%D0%B5%D1%82%D1%81%D1%8F_%D0%BF%D0%BE%D1%81%D0%BB%D0%B5_%D0%BF%D0%B5%D1%80%D0%B5%D0%BF%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D1%8F">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.10</span>Внешняя звуковая карта не включается после переподключения</div>
			</a>
			
			<ul id="toc-Внешняя_звуковая_карта_не_включается_после_переподключения-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Нет_звука_или_pactl_info_показывает_Failure:_Connection_refused" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9D%D0%B5%D1%82_%D0%B7%D0%B2%D1%83%D0%BA%D0%B0_%D0%B8%D0%BB%D0%B8_pactl_info_%D0%BF%D0%BE%D0%BA%D0%B0%D0%B7%D1%8B%D0%B2%D0%B0%D0%B5%D1%82_Failure:_Connection_refused">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.11</span>Нет звука или pactl info показывает Failure: Connection refused</div>
			</a>
			
			<ul id="toc-Нет_звука_или_pactl_info_показывает_Failure:_Connection_refused-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Низкое_качество_звука_через_Bluetooth" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9D%D0%B8%D0%B7%D0%BA%D0%BE%D0%B5_%D0%BA%D0%B0%D1%87%D0%B5%D1%81%D1%82%D0%B2%D0%BE_%D0%B7%D0%B2%D1%83%D0%BA%D0%B0_%D1%87%D0%B5%D1%80%D0%B5%D0%B7_Bluetooth">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.12</span>Низкое качество звука через Bluetooth</div>
			</a>
			
			<ul id="toc-Низкое_качество_звука_через_Bluetooth-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Заметная_задержка_звука_при_воспроизведении" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%97%D0%B0%D0%BC%D0%B5%D1%82%D0%BD%D0%B0%D1%8F_%D0%B7%D0%B0%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D0%B0_%D0%B7%D0%B2%D1%83%D0%BA%D0%B0_%D0%BF%D1%80%D0%B8_%D0%B2%D0%BE%D1%81%D0%BF%D1%80%D0%BE%D0%B8%D0%B7%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.13</span>Заметная задержка звука при воспроизведении</div>
			</a>
			
			<ul id="toc-Заметная_задержка_звука_при_воспроизведении-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Пропадание_звука_при_проигрывании_других_потоков" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9F%D1%80%D0%BE%D0%BF%D0%B0%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D0%B7%D0%B2%D1%83%D0%BA%D0%B0_%D0%BF%D1%80%D0%B8_%D0%BF%D1%80%D0%BE%D0%B8%D0%B3%D1%80%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B8_%D0%B4%D1%80%D1%83%D0%B3%D0%B8%D1%85_%D0%BF%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%B2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.14</span>Пропадание звука при проигрывании других потоков</div>
			</a>
			
			<ul id="toc-Пропадание_звука_при_проигрывании_других_потоков-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Искажённый_звук" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%98%D1%81%D0%BA%D0%B0%D0%B6%D1%91%D0%BD%D0%BD%D1%8B%D0%B9_%D0%B7%D0%B2%D1%83%D0%BA">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.15</span>Искажённый звук</div>
			</a>
			
			<ul id="toc-Искажённый_звук-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Различные_проблемы_после_простоя" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%A0%D0%B0%D0%B7%D0%BB%D0%B8%D1%87%D0%BD%D1%8B%D0%B5_%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B_%D0%BF%D0%BE%D1%81%D0%BB%D0%B5_%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.16</span>Различные проблемы после простоя</div>
			</a>
			
			<ul id="toc-Различные_проблемы_после_простоя-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Большая_задержка_при_использовании_USB_ЦАП_(например,_ЦАП_Schiit)" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%91%D0%BE%D0%BB%D1%8C%D1%88%D0%B0%D1%8F_%D0%B7%D0%B0%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D0%B0_%D0%BF%D1%80%D0%B8_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B8_USB_%D0%A6%D0%90%D0%9F_(%D0%BD%D0%B0%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80,_%D0%A6%D0%90%D0%9F_Schiit)">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.17</span>Большая задержка при использовании USB ЦАП (например, ЦАП Schiit)</div>
			</a>
			
			<ul id="toc-Большая_задержка_при_использовании_USB_ЦАП_(например,_ЦАП_Schiit)-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Нет_звука_от_USB_ЦАП_до_30%_громкости" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9D%D0%B5%D1%82_%D0%B7%D0%B2%D1%83%D0%BA%D0%B0_%D0%BE%D1%82_USB_%D0%A6%D0%90%D0%9F_%D0%B4%D0%BE_30%_%D0%B3%D1%80%D0%BE%D0%BC%D0%BA%D0%BE%D1%81%D1%82%D0%B8">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.18</span>Нет звука от USB ЦАП до 30% громкости</div>
			</a>
			
			<ul id="toc-Нет_звука_от_USB_ЦАП_до_30%_громкости-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Аудио_в_режиме_реального_времени_не_работает" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%90%D1%83%D0%B4%D0%B8%D0%BE_%D0%B2_%D1%80%D0%B5%D0%B6%D0%B8%D0%BC%D0%B5_%D1%80%D0%B5%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE_%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8_%D0%BD%D0%B5_%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%D0%B5%D1%82">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.19</span>Аудио в режиме реального времени не работает</div>
			</a>
			
			<ul id="toc-Аудио_в_режиме_реального_времени_не_работает-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Одновременный_вывод_на_несколько_выходов_на_одной_звуковой_карте" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9E%D0%B4%D0%BD%D0%BE%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D0%B9_%D0%B2%D1%8B%D0%B2%D0%BE%D0%B4_%D0%BD%D0%B0_%D0%BD%D0%B5%D1%81%D0%BA%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE_%D0%B2%D1%8B%D1%85%D0%BE%D0%B4%D0%BE%D0%B2_%D0%BD%D0%B0_%D0%BE%D0%B4%D0%BD%D0%BE%D0%B9_%D0%B7%D0%B2%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B9_%D0%BA%D0%B0%D1%80%D1%82%D0%B5">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.20</span>Одновременный вывод на несколько выходов на одной звуковой карте</div>
			</a>
			
			<ul id="toc-Одновременный_вывод_на_несколько_выходов_на_одной_звуковой_карте-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Нет_звуков_уведомлений_в_Discord" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#%D0%9D%D0%B5%D1%82_%D0%B7%D0%B2%D1%83%D0%BA%D0%BE%D0%B2_%D1%83%D0%B2%D0%B5%D0%B4%D0%BE%D0%BC%D0%BB%D0%B5%D0%BD%D0%B8%D0%B9_%D0%B2_Discord">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.1.21</span>Нет звуков уведомлений в Discord</div>
			</a>
			
			<ul id="toc-Нет_звуков_уведомлений_в_Discord-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Видео_2" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#%D0%92%D0%B8%D0%B4%D0%B5%D0%BE_2">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2</span>Видео</div>
			</a>
			
			<ul id="toc-Видео_2-sublist" class="vector-toc-list">
				<li id="toc-OBS_ничего_не_показывает,_даже_если_спрашивает_окно/экран" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#OBS_%D0%BD%D0%B8%D1%87%D0%B5%D0%B3%D0%BE_%D0%BD%D0%B5_%D0%BF%D0%BE%D0%BA%D0%B0%D0%B7%D1%8B%D0%B2%D0%B0%D0%B5%D1%82,_%D0%B4%D0%B0%D0%B6%D0%B5_%D0%B5%D1%81%D0%BB%D0%B8_%D1%81%D0%BF%D1%80%D0%B0%D1%88%D0%B8%D0%B2%D0%B0%D0%B5%D1%82_%D0%BE%D0%BA%D0%BD%D0%BE/%D1%8D%D0%BA%D1%80%D0%B0%D0%BD">
				<div class="vector-toc-text">
				<span class="vector-toc-numb">5.2.1</span>OBS ничего не показывает, даже если спрашивает окно/экран</div>
			</a>
			
			<ul id="toc-OBS_ничего_не_показывает,_даже_если_спрашивает_окно/экран-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Смотрите_также" class="vector-toc-list-item vector-toc-level-1">
		<a class="vector-toc-link" href="#%D0%A1%D0%BC%D0%BE%D1%82%D1%80%D0%B8%D1%82%D0%B5_%D1%82%D0%B0%D0%BA%D0%B6%D0%B5">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>Смотрите также</div>
		</a>
		
		<ul id="toc-Смотрите_также-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">PipeWire (Русский)</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 5 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-5" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">5 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-en mw-list-item"><a href="../en/PipeWire.html" title="PipeWire – English" lang="en" hreflang="en" class="interlanguage-link-target"><span>English</span></a></li>
<li class="interlanguage-link interwiki-fi mw-list-item"><a href="../fi/PipeWire.html" title="PipeWire – suomi" lang="fi" hreflang="fi" class="interlanguage-link-target"><span>Suomi</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/PipeWire" title="PipeWire – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-pt mw-list-item"><a href="../pt/PipeWire.html" title="PipeWire – português" lang="pt" hreflang="pt" class="interlanguage-link-target"><span>Português</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/PipeWire" title="PipeWire – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="ru" dir="ltr">
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Состояние перевода:</strong> На этой странице представлен перевод статьи <a href="../en/PipeWire.html" title="PipeWire">PipeWire</a>. Дата последней синхронизации: 6 октября 2022. Вы можете <a href="../ru/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (Русский)">помочь</a> синхронизировать перевод, если в английской версии произошли <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=PipeWire&amp;diff=0&amp;oldid=751316">изменения</a>.</div>
<div class="archwiki-template-meta-related-articles">
<p>Ссылки по теме</p>
<ul>
<li><a href="../ru/PipeWire/Examples.html" class="mw-redirect" title="PipeWire/Примеры">PipeWire/Примеры</a></li>
<li><a href="../ru/WirePlumber.html" title="WirePlumber (Русский)">WirePlumber (Русский)</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://pipewire.org">PipeWire</a> — это новый низкоуровневый мультимедийный фреймворк. Он предназначен для захвата и воспроизведения аудио и видео с минимальной задержкой и поддерживает <a href="../ru/PulseAudio.html" title="PulseAudio (Русский)">PulseAudio</a>, <a href="../en/JACK_Audio_Connection_Kit.html" class="mw-redirect" title="JACK">JACK</a>, <a href="../en/Advanced_Linux_Sound_Architecture.html" class="mw-redirect" title="Advanced Linux Sound Architecture (Русский)">ALSA</a> и приложения, использующие <a href="../en/GStreamer.html" title="GStreamer">GStreamer</a>.
</p>
<p>Демон, основанный на этом фреймровке, может быть использован как звуковой сервер (с поддержкой возможностей PulseAudio и JACK) и как сервер для захвата видео.
</p>
<p>PipeWire также поддерживает контейнеры по типу <a href="../en/Flatpak.html" title="Flatpak">Flatpak</a> и не зависит от <a href="../ru/Users_and_groups.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B3%D1%80%D1%83%D0%BF%D0%BF%D0%B0%D0%BC%D0%B8" title="Users and groups (Русский)">пользовательских групп</a> <code>audio</code> и <code>video</code>. Вместо них он использует модель безопасности, основанную на <a href="../ru/Polkit.html" title="Polkit (Русский)">Polkit</a>, для запроса у Flatpak или Wayland разрешений для записи экрана или звука.
</p>
<meta property="mw:PageProp/toc">
<h2>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0"></span><span class="mw-headline" id="Установка">Установка</span>
</h2>
<p><a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установите">Установите</a> пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pipewire">pipewire</a></span>. Также есть пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lib32-pipewire">lib32-pipewire</a></span> для поддержки <a href="../ru/Official_repositories.html#multilib" title="Official repositories (Русский)">multilib</a>.
</p>
<p>PipeWire использует <a href="../ru/Systemd/User.html" title="Systemd (Русский)/User (Русский)">пользовательский экземпляр systemd</a> для управления сервером и автоматической активации через сокет.
</p>
<p>Документация есть в пакете <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pipewire-docs">pipewire-docs</a></span>.
</p>
<p>Pipewire может работать как прозрачная замена других звуковых серверов; подробнее в разделе <a href="#%D0%90%D1%83%D0%B4%D0%B8%D0%BE">#Аудио</a>.
</p>
<h3>
<span id=".D0.9C.D0.B5.D0.BD.D0.B5.D0.B4.D0.B6.D0.B5.D1.80_.D1.81.D0.B5.D0.B0.D0.BD.D1.81.D0.BE.D0.B2"></span><span class="mw-headline" id="Менеджер_сеансов">Менеджер сеансов</span>
</h3>
<p>Как и <a href="../en/JACK_Audio_Connection_Kit.html" class="mw-redirect" title="JACK">JACK</a>, PipeWire не реализует никакой внутренней логики подключения. Бремя отслеживания новых потоков и подключения их к соответствующему устройству вывода или приложению возлагается на внешний компонент, известный как менеджер сеансов.
</p>
<p>На данный момент доступны два менеджера сеансов:
</p>
<ul><li>
<b><a href="../ru/WirePlumber.html" title="WirePlumber (Русский)">WirePlumber</a></b> — Менеджер, основанный на модульной конструкции, с плагинами Lua, которые реализуют фактическую функциональность управления. Он более мощный чем PipeWire Media Session и рекомендуется к использованию по умолчанию.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://pipewire.pages.freedesktop.org/wireplumber/">https://pipewire.pages.freedesktop.org/wireplumber/</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=wireplumber">wireplumber</a></span>
</dd></dl>
<ul><li>
<b>PipeWire Media Session</b> — Очень простой менеджер, подходящий для простых случаев. Он был реализован в основном для тестирования и в качестве примера для создания новых менеджеров сеансов.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://gitlab.freedesktop.org/pipewire/media-session">https://gitlab.freedesktop.org/pipewire/media-session</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pipewire-media-session">pipewire-media-session</a></span>
</dd></dl>
<p>Переключиться на другой менеджер можно простой установкой соответствующего пакета, который будет конфликтовать с пакетом прошлого менеджера и заменит его.
</p>
<h3><span class="mw-headline" id="GUI">GUI</span></h3>
<ul><li>
<b>Helvum</b> — GTK обёртка для pipewire, вдохновленная подобным инструментом для JACK catia.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://gitlab.freedesktop.org/pipewire/helvum">https://gitlab.freedesktop.org/pipewire/helvum</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=helvum">helvum</a></span>
</dd></dl>
<ul><li>
<b>qpwgraph</b> — Graph/Patchbay для PipeWire на базе Qt, вдохновлённый JACK-инструментом QjackCtl.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://gitlab.freedesktop.org/rncbc/qpwgraph">https://gitlab.freedesktop.org/rncbc/qpwgraph</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=qpwgraph">qpwgraph</a></span>
</dd></dl>
<h2>
<span id=".D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0"></span><span class="mw-headline" id="Настройка">Настройка</span>
</h2>
<p>Пакет PipeWire предоставляет начальный набор конфигурационных файлов в <code>/usr/share/pipewire</code>. Не редактируйте эти файлы напрямую, так как обновления пакета перезапишут ваши изменения. Для настройки PipeWire можно скопировать файлы из <code>/usr/share/pipewire</code> в другой общесистемный каталог <code>/etc/pipewire</code> или в пользовательский каталог <code>~/.config/pipewire</code>. Файл из каталога с более высоким приоритетом заменяет собой файлы с таким же именем из других каталогов. <a rel="nofollow" class="external autonumber" href="https://gitlab.freedesktop.org/pipewire/pipewire/-/wikis/Config-PipeWire#configuration-file-pipewireconf">[1]</a>
</p>
<h3>
<span id=".D0.9F.D1.80.D0.BE.D1.84.D0.B8.D0.BB.D0.B8"></span><span class="mw-headline" id="Профили">Профили</span>
</h3>
<p>Pipewire добавляет пользовательский профиль "Pro Audio" в дополнение к профилям PulseAudio, выбираемым через pavucontrol. Эффект от этого описан здесь: <a rel="nofollow" class="external free" href="https://gitlab.freedesktop.org/pipewire/pipewire/-/wikis/FAQ#what-is-the-pro-audio-profile">https://gitlab.freedesktop.org/pipewire/pipewire/-/wikis/FAQ#what-is-the-pro-audio-profile</a>
</p>
<h2>
<span id=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Использование">Использование</span>
</h2>
<h3>
<span id=".D0.90.D1.83.D0.B4.D0.B8.D0.BE"></span><span class="mw-headline" id="Аудио">Аудио</span>
</h3>
<p>PipeWire может быть использован как звуковой сервер наподобие PulseAudio и JACK. Он нацелен их на полную замену путем предоставления реализации PulseAudio-совместимого сервера и ABI-совместимых библиотек для клиентов JACK. Подробнее смотреть <a rel="nofollow" class="external text" href="https://blogs.gnome.org/uraeus/2020/09/04/pipewire-late-summer-update-2020/">здесь</a>.
</p>
<h4>
<span id=".D0.9A.D0.BB.D0.B8.D0.B5.D0.BD.D1.82.D1.8B_ALSA"></span><span class="mw-headline" id="Клиенты_ALSA">Клиенты ALSA</span>
</h4>
<p>Установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pipewire-alsa">pipewire-alsa</a></span> (и удалите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pulseaudio-alsa">pulseaudio-alsa</a></span>, если он установлен) для перенаправления приложений, использующих ALSA API, через PipeWire.
</p>
<h4>
<span id=".D0.9A.D0.BB.D0.B8.D0.B5.D0.BD.D1.82.D1.8B_PulseAudio"></span><span class="mw-headline" id="Клиенты_PulseAudio">Клиенты PulseAudio</span>
</h4>
<p>Установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pipewire-pulse">pipewire-pulse</a></span>. Этот пакет заменит установленные <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pulseaudio">pulseaudio</a></span> и <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pulseaudio-bluetooth">pulseaudio-bluetooth</a></span>. Необходимо перезагрузиться или запустить <a href="../ru/Systemd/User.html" title="Systemd (Русский)/User (Русский)">пользовательский юнит</a> <code>pipewire-pulse.service</code> для работы.
</p>
<p>Как правило, этого достаточно для дальнейшей работы, так как сервис <code>pipewire-pulse.socket</code> должен быть автоматически включен. Для проверки работоспособности, выполните следующую команду и изучите вывод:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ pactl info</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
Имя сервера: PulseAudio (on PipeWire 0.3.16)
...</pre>
<p>Информация о дальнейшей настройке (например, касательно модулей) есть в официальной Wiki проекта: <a rel="nofollow" class="external text" href="https://gitlab.freedesktop.org/pipewire/pipewire/-/wikis/Migrate-PulseAudio">Migration from PulseAudio</a>, <a rel="nofollow" class="external text" href="https://gitlab.freedesktop.org/pipewire/pipewire/-/wikis/Config-PulseAudio">Configuration of Pipewire-Pulse</a>.
</p>
<h4>
<span id=".D0.9A.D0.BB.D0.B8.D0.B5.D0.BD.D1.82.D1.8B_JACK"></span><span class="mw-headline" id="Клиенты_JACK">Клиенты JACK</span>
</h4>
<p>Установите пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pipewire-jack">pipewire-jack</a></span>. Также есть пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lib32-pipewire-jack">lib32-pipewire-jack</a></span> для поддержки <a href="../ru/Official_repositories.html#multilib" title="Official repositories (Русский)">multilib</a>.
</p>
<p>Можно использовать <span class="plainlinks archwiki-template-man" title="$ man 1 pw-jack"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/pw-jack.1">pw-jack(1)</a></span> для запуска клиентов JACK, но технически это не обязательно, так как он служит лишь обёрткой для переменных окружения <code>PIPEWIRE_REMOTE</code>, <code>PIPEWIRE_DEBUG</code> и <code>PIPEWIRE_LATENCY</code>.
</p>
<p>Также вы можете использовать другой размер буфера путем установления нужного соотношения размера буфера и частоты дискретизации (что равно задержке в секнудах):
</p>
<pre>PIPEWIRE_LATENCY="128/48000" <i>приложение</i>
</pre>
<h4>
<span id=".D0.A3.D1.81.D1.82.D1.80.D0.BE.D0.B9.D1.81.D1.82.D0.B2.D0.B0_Bluetooth"></span><span class="mw-headline" id="Устройства_Bluetooth">Устройства Bluetooth</span>
</h4>
<p>Для управления Bluetooth audio устройствами PipeWire использует <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pipewire-pulse">pipewire-pulse</a></span>. Говоря более конкретно, сервис PipeWire проверяет наличие <code>/etc/pipewire/media-session.d/with-pulseaudio</code> и подключает модуль <code>bluez5</code> автоматически, если он установлен в системе.
</p>
<h5>
<span id=".D0.90.D0.B2.D1.82.D0.BE.D0.BC.D0.B0.D1.82.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B8.D0.B9_.D0.B2.D1.8B.D0.B1.D0.BE.D1.80_.D0.BF.D1.80.D0.BE.D1.84.D0.B8.D0.BB.D1.8F"></span><span class="mw-headline" id="Автоматический_выбор_профиля">Автоматический выбор профиля</span>
</h5>
<p>И <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pipewire-media-session">pipewire-media-session</a></span>, и <a href="../ru/WirePlumber.html" title="WirePlumber (Русский)">WirePlumber</a> могут автоматически переключаться между профилями HSP/HFP и A2DP при обнаружении входного потока.
</p>
<p>В <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pipewire-media-session">pipewire-media-session</a></span> это по умолчанию отключено. Для включения установите параметр <code>bluez5.autoswitch-profile</code> в значение <code>true</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pipewire/media-session.d/bluez-monitor.conf (или ~/.config/pipewire/media-session.d/bluez-monitor.conf)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
rules = [
    {
        ...
        actions = {
            update-props = {
                ...
                <b>bluez5.autoswitch-profile = true</b>
...</pre>
<p>В <a href="../ru/WirePlumber.html" title="WirePlumber (Русский)">WirePlumber</a> это по умолчанию включено. Отключить можно так:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/wireplumber/policy.lua.d/11-bluetooth-policy.lua (или ~/.config/wireplumber/policy.lua.d/11-bluetooth-policy.lua)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">bluetooth_policy.policy["media-role.use-headset-profile"] = false</pre>
<h4><span class="mw-headline" id="PipeWire_native_patch_sets">PipeWire native patch sets</span></h4>
<p>У нас есть Helvum для графической визуализации и создания соединений, но всего остального пока нет. Ниже приведены bash-скрипты, которые сохраняют наборы связей, загружают их и разрывают все соединения. Для сохранения и загрузки укажите имя файла в качестве аргумента.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">pw-savewires</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash

if [[ "$#" -ne 1 ]]; then
	echo
	echo 'usage: pw-savewires filename'
	echo
	exit 0
fi

rm $1 &amp;&gt; /dev/null
while IFS= read -r line; do
	link_on=`echo $line | cut -f 4 -d '"'`
	link_op=`echo $line | cut -f 6 -d '"'`
	link_in=`echo $line | cut -f 8 -d '"'`
	link_ip=`echo $line | cut -f 10 -d '"'`
	echo "Saving: " "'"$link_on:$link_op"','"$link_in:$link_ip"'"
	echo "'"$link_on:$link_op"','"$link_in:$link_ip"'" &gt;&gt; $1
done &lt; &lt;(pw-cli dump short link)
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">pw-loadwires</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/python

import sys
import csv
import os

if len(sys.argv) &lt; 2:
	print('\n usage: pw-loadwires filename\n')
	quit()

with open(sys.argv[1], newline='') as csvfile:
	pwwreader = csv.reader(csvfile, delimiter=',', quotechar='"')
	for row in pwwreader:
		print('Loading:  ' + row[0] + ' --&gt; ' + row[1])
		process = os.popen('pw-link ' + row[0] + ' ' + row[1])
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">pw-dewire</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash
while read -r line; do
	echo 'Dewiring: ' $line '...'
	pw-link -d $line
done &lt; &lt;(pw-cli dump short link {{!}} grep -Eo '^[0-9]+')
</pre>
<h4>
<span id=".D0.A1.D0.BE.D0.B2.D0.BC.D0.B5.D1.81.D1.82.D0.BD.D0.BE.D0.B5_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.B0.D1.83.D0.B4.D0.B8.D0.BE.D1.83.D1.81.D1.82.D1.80.D0.BE.D0.B9.D1.81.D1.82.D0.B2_.D0.BF.D0.BE_.D1.81.D0.B5.D1.82.D0.B8"></span><span class="mw-headline" id="Совместное_использование_аудиоустройств_по_сети">Совместное использование аудиоустройств по сети</span>
</h4>
<p>Хотя в само́м PipeWire нет сетевой прозрачности, его реализация PulseAudio поддерживает <a rel="nofollow" class="external text" href="https://gitlab.freedesktop.org/pipewire/pipewire/-/wikis/Config-PulseAudio#network-support">передачу звука по сети</a>. Простым способом обмена аудио между компьютерами в сети является использование демона <a href="../en/Avahi.html" title="Avahi">Avahi</a> для обнаружения устройств. Убедитесь, что служба <code>avahi-daemon.service</code> запущена на всех компьютерах, которые будут совместно использовать аудио.
</p>
<p>Чтобы сделать аудиоустройства доступными через сеть, загрузите соответствующие модули на хосте (убедитесь, что используется локальный IP-адрес):
</p>
<pre>$ pactl load-module module-native-protocol-tcp listen=<i>192.168.1.10</i>
$ pactl load-module module-zeroconf-publish
</pre>
<p>А на клиентах загрузите модуль обнаружения:
</p>
<pre>$ pactl load-module module-zeroconf-discover
</pre>
<h4>
<span id=".D0.A0.D0.B0.D0.B1.D0.BE.D1.82.D0.B0_PipeWire_.D0.BF.D0.BE.D0.B2.D0.B5.D1.80.D1.85_JACK"></span><span class="mw-headline" id="Работа_PipeWire_поверх_JACK">Работа PipeWire поверх JACK</span>
</h4>
<p>PipeWire также может работать как клиент JACK, если это необходимо. Подробнее <a rel="nofollow" class="external text" href="https://gitlab.freedesktop.org/pipewire/pipewire/-/wikis/JACK">смотреть здесь</a>
</p>
<h4>
<span id=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_ALSA_dmix_.D0.B2_.D0.BA.D0.B0.D1.87.D0.B5.D1.81.D1.82.D0.B2.D0.B5_.D0.B2.D1.8B.D0.B2.D0.BE.D0.B4.D0.B0_PipeWire"></span><span class="mw-headline" id="Использование_ALSA_dmix_в_качестве_вывода_PipeWire">Использование ALSA dmix в качестве вывода PipeWire</span>
</h4>
<p>Можно использовать сервер PipeWire (или несколько, отдельно для каждого пользователя) для вывода звука на ALSA через <a href="../en/Advanced_Linux_Sound_Architecture.html#Dmix" class="mw-redirect" title="Advanced Linux Sound Architecture (Русский)">ALSA dmix</a>. Это позволяет использовать ALSA в качестве основной системы вывода звука, но при этом использовать устройства, не относящиеся к ALSA, например Bluetooth-наушники.
</p>
<h5>
<span id=".D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_dmix_.D0.B2_ALSA"></span><span class="mw-headline" id="Настройка_dmix_в_ALSA">Настройка dmix в ALSA</span>
</h5>
<p>Допустим, у вас есть две звуковые карты, <code>PCH</code> и <code>HDMI</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/proc/asound/cards</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"> 0 [PCH            ]: HDA-Intel - HDA Intel PCH
                      HDA Intel PCH at 0xdff40000 irq 146
 1 [HDMI           ]: HDA-Intel - HDA ATI HDMI
                      HDA ATI HDMI at 0xdfe60000 irq 147
</pre>
<p>и PCM выглядит примерно так:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/proc/asound/pcm</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">00-00: ALC1220 Analog : ALC1220 Analog : playback 1 : capture 1
00-02: ALC1220 Alt Analog : ALC1220 Alt Analog : capture 1
01-03: HDMI 0 : HDMI 0 : playback 1
01-07: HDMI 1 : HDMI 1 : playback 1
01-08: HDMI 2 : HDMI 2 : playback 1
01-09: HDMI 3 : HDMI 3 : playback 1
01-10: HDMI 4 : HDMI 4 : playback 1
01-11: HDMI 5 : HDMI 5 : playback 1
</pre>
<p>и настройки ALSA примерно такие:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/asound.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">ctl.!default {
  type hw
  card PCH
}

pcm.!default {
  type plug
  slave.pcm "<b>dmix:PCH,0</b>"
}

pcm.dhdmi {
  type plug
  slave.pcm "<b>dmix:HDMI,9</b>"
}
</pre>
<p>В примерах ниже будут использоваться dmix-устройства <code>dmix:PCH,0</code> и <code>dmix:HDMI,9</code>.
</p>
<h5>
<span id=".D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_dmix_.D0.B2_PipeWire"></span><span class="mw-headline" id="Настройка_dmix_в_PipeWire">Настройка dmix в PipeWire</span>
</h5>
<p>Сперва нужно отключить автоматический мониторинг устройств ALSA в WirePlumber. Закомментируйте строку <code>alsa_monitor.enable()</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/wireplumber/main.lua.d/90-enable-all.lua (или ~/.config/wireplumber/main.lua.d/90-enable-all.lua)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
-- Load devices
<b>-- alsa_monitor.enable()</b>
v4l2_monitor.enable()
libcamera_monitor.enable()
...
</pre>
<p>Теперь нужно настроить PipeWire на использование dmix. В стандартном файле настроек (<code>/usr/share/pipewire/pipewire.conf</code>) есть <a rel="nofollow" class="external text" href="https://gitlab.freedesktop.org/pipewire/pipewire/-/blob/0.3.59/src/daemon/pipewire.conf.in#L219-239">закомментированный пример</a>, который можно использовать в качестве основы.
</p>
<p>Добавьте свой элемент в массив <code>context.objects</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pipewire/pipewire.conf.d/alsa-dmix.conf (или ~/.config/pipewire/pipewire.conf.d/alsa-dmix.conf)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">context.objects = [
    # Начинаем не с dmix, а с устройства ввода. Не забудьте его добавить.
    # Без настроенного устройства ввода наблюдались проблемы в Zoom.
    { factory = adapter
        args = {
            factory.name           = api.alsa.pcm.source
            node.name              = "alsa-mic-internal" # название устройства pulse (mpv)
            node.description       = "Mic Internal" # название устройства pulse (pavucontrol)
            media.class            = "Audio/Source"
            api.alsa.path          = "<b>hw:PCH,0</b>"
        }
    }
    # Теперь можно добавить dmix PCM
    { factory = adapter
        args = {
            factory.name           = api.alsa.pcm.sink # Вывод в dmix
            node.name              = "alsa-dmix-internal" # название устройства pulse (mpv)
            node.description       = "PCM Internal" # название устройства pulse (pavucontrol)
            media.class            = "Audio/Sink" # Вывод в dmix
            api.alsa.path          = "<b>dmix:PCH,0</b>"
        }
    }

    { factory = adapter
        args = {
            factory.name           = api.alsa.pcm.sink # Вывод в dmix
            node.name              = "alsa-dmix-hdmi" # название устройства pulse (mpv)
            node.description       = "PCM HDMI" # название устройства pulse (pavucontrol)
            media.class            = "Audio/Sink" # Вывод в dmix
            # это dmix из файла /etc/asound.conf
            api.alsa.path          = "<b>dmix:HDMI,9</b>"
        }
    }
]</pre>
<p>Как обычный пользователь (не root) проверьте вывод <code>wpctl status</code> и настройте источник (source) и вывод (sink) устройства по умолчанию по своему вкусу с помощью <code>wpctl set-default <i>ID</i></code>, где <code><i>ID</i></code> - это число перед именем источника/вывода.
</p>
<p>Теперь можно полноценно протестировать изменения.
</p>
<h3>
<span id=".D0.94.D0.B5.D0.BC.D0.BE.D0.BD.D1.81.D1.82.D1.80.D0.B0.D1.86.D0.B8.D1.8F_.D1.8D.D0.BA.D1.80.D0.B0.D0.BD.D0.B0_WebRTC"></span><span class="mw-headline" id="Демонстрация_экрана_WebRTC">Демонстрация экрана WebRTC</span>
</h3>
<p>Большинство браузеров для работы WebRTC и захвата рабочего стола или отдельных приложений используют X11. На Wayland используется подход, основанный на механизме разрешений.
</p>
<p>Для этого требуются пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xdg-desktop-portal">xdg-desktop-portal</a></span> и один из следующих бэкендов:
</p>
<ul>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xdg-desktop-portal-gnome">xdg-desktop-portal-gnome</a></span> для <a href="../ru/GNOME.html" title="GNOME (Русский)">GNOME</a>, который зависит от</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xdg-desktop-portal-gtk">xdg-desktop-portal-gtk</a></span> для приложений <a href="../ru/GTK.html" title="GTK (Русский)">GTK</a>.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xdg-desktop-portal-kde">xdg-desktop-portal-kde</a></span> для <a href="../ru/KDE.html" title="KDE (Русский)">KDE</a>.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xdg-desktop-portal-lxqt">xdg-desktop-portal-lxqt</a></span> for <a href="../ru/LXQt.html" title="LXQt (Русский)">LXQt</a>.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xdg-desktop-portal-wlr">xdg-desktop-portal-wlr</a></span> для оболочек, использующих композитор wlroots (напр. <a href="../en/Sway.html" title="Sway">Sway</a>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/dwl/">dwl</a></span><sup><small>AUR</small></sup>)</li>
</ul>
<p>После установки бэкенда <a href="../ru/Help:Reading.html#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%B0%D0%BC%D0%B8_systemd" class="mw-redirect" title="Перезапустите">перезапустите</a> пользовательский юнит <code>xdg-desktop-portal.service</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> В <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xdg-desktop-portal">xdg-desktop-portal</a></span> 1.10.0 исправлено несоответствие между спецификацией и реализацией интерфейса D-Bus. <a rel="nofollow" class="external autonumber" href="https://github.com/flatpak/xdg-desktop-portal/pull/609">[2]</a> Как следствие, некоторые клиенты могут не работать с xdg-desktop-portal 1.10.0 или более новыми версиями.</div>
<p>Firefox (84+) поддерживает данный механизм по умолчанию. Для Chromium (73+) нужно активировать поддержку <a rel="nofollow" class="external text" href="https://bugs.chromium.org/p/chromium/issues/detail?id=682122">вручную</a> включением экспериментального флага:
</p>
<pre>chrome://flags/#enable-webrtc-pipewire-capturer
</pre>
<p>В <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=obs-studio">obs-studio</a></span> (27+) этот метод реализован в виде источника «Захват экрана (PipeWire)».
</p>
<p>Обратите внимание, что поддерживается только захват экрана целиком, а не отдельного окна/приложения <a rel="nofollow" class="external autonumber" href="https://github.com/emersion/xdg-desktop-portal-wlr/wiki/FAQ#will-this-let-me-share-individual-windows">[3]</a><a rel="nofollow" class="external autonumber" href="https://github.com/KDE/xdg-desktop-portal-kde/blob/master/TODO">[4]</a>.
</p>
<h4><span class="mw-headline" id="xdg-desktop-portal-wlr">xdg-desktop-portal-wlr</span></h4>
<p>Для работы <code>xdg-desktop-portal-wlr</code> необходимо, чтобы в <a href="../ru/Systemd/User.html#%D0%9F%D0%B5%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5_%D0%BE%D0%BA%D1%80%D1%83%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F" title="Systemd (Русский)/User (Русский)">пользовательском сеансе systemd</a> присутствовали переменные окружения <code>XDG_CURRENT_DESKTOP</code> и <code>WAYLAND_DISPLAY</code>. Переменная <code>XDG_CURRENT_DESKTOP</code> должна содержать название используемого вами композитора, например <code>XDG_CURRENT_DESKTOP=sway</code>. Переменную <code>WAYLAND_DISPLAY</code> композитор прописывает автоматически. Рекомендуемый способ перенести эти переменные окружения в пользовательский сеанс systemd — выполнить команду <code>systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP</code> после запуска композитора, например, в файле настроек композитора. Смотрите <a rel="nofollow" class="external autonumber" href="https://github.com/emersion/xdg-desktop-portal-wlr#running">[5]</a> и <a rel="nofollow" class="external autonumber" href="https://github.com/emersion/xdg-desktop-portal-wlr/wiki">[6]</a> для более подробной информации.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> Если у вас несколько мониторов, то, чтобы выбрать один из них, установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=slurp">slurp</a></span> и добавьте следующую конфигурацию (смотрите <span class="plainlinks archwiki-template-man" title="$ man 5 xdg-desktop-portal-wlr"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/xdg-desktop-portal-wlr.5#SCREENCAST_OPTIONS">xdg-desktop-portal-wlr(5) § SCREENCAST OPTIONS</a></span>):
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/xdg-desktop-portal-wlr/config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">chooser_type = simple
chooser_cmd = slurp -f %o -ro</pre>
<p>Когда запрашивается доступ к экрану, <code>slurp</code> покажет вам курсор с перекрестием, и вам нужно будет щёлкнуть на экран, к которому вы хотите предоставить доступ. После выбора <code>xdg-desktop-portal-wlr</code> предоставит доступ к этому экрану.
</p>
</div>
<h3>
<span id=".D0.92.D0.B8.D0.B4.D0.B5.D0.BE"></span><span class="mw-headline" id="Видео">Видео</span>
</h3>
<p>Большинство приложений, которые полагаются на <a href="../en/GStreamer.html" title="GStreamer">GStreamer</a> для обработки, например, видеопотоков, должны работать «из коробки», используя плагин PipeWire GStreamer; смотрите <a href="../en/GStreamer.html#PipeWire" title="GStreamer">GStreamer#PipeWire</a>. Поэтому такие приложения, как, например, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=cheese">cheese</a></span>, уже могут использовать его для захвата видео.
</p>
<p>Скрипт <code>pw-v4l2</code> из пакета <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pipewire-v4l2">pipewire-v4l2</a></span> выполняет предзагрузку библиотеки (<code>/lib/pipewire-0.3/v4l2/libpw-v4l2.so</code>), которая перехватывает вызовы v4l2 и направляет видео через pipewire.
</p>
<h2>
<span id=".D0.9F.D0.BE.D1.81.D1.82.D0.BE.D0.B1.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.BA.D0.B0_.D0.B0.D1.83.D0.B4.D0.B8.D0.BE"></span><span class="mw-headline" id="Постобработка_аудио">Постобработка аудио</span>
</h2>
<h3><span class="mw-headline" id="EasyEffects">EasyEffects</span></h3>
<p>EasyEffects (ранее PulseEffects) это GTK утилита предоставляющая большой набор аудио эффектов и фильтров для использования в потоках отдельных приложений и микрофона. Присутствуют большинство основных эффектов, таких как эквалайзер, выравнивание громкости, усиления низких частот, дэ-эссер и подавления шумов. Полный список эффектов и фильтров можно посмотреть <a rel="nofollow" class="external text" href="https://github.com/wwmm/easyeffects">на GitHub</a>.
</p>
<p>Для использования установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=easyeffects">easyeffects</a></span>. Так же можете посмотреть <a rel="nofollow" class="external text" href="https://github.com/wwmm/easyeffects/wiki/Community-presets">коллекцию пользовательских пресетов</a> для настройки.
Смотрите также <a rel="nofollow" class="external text" href="https://github.com/jaakkopasanen/AutoEq">AutoEq</a> — коллекция предустановок эквалайзера для наушников, созданная искусственным интеллектом.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Про старую версию — PulseEffects — можно прочитать здесь: <a href="../ru/PulseAudio.html#PulseEffects" title="PulseAudio (Русский)">PulseAudio (Русский)#PulseEffects</a>.</div>
<h3><span class="mw-headline" id="NoiseTorch">NoiseTorch</span></h3>
<p>NoiseTorch это альтернативный способ для шумоподавления. Для использования установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/noisetorch/">noisetorch</a></span><sup><small>AUR</small></sup>, либо одну из этих версий пакета <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/noisetorch-bin/">noisetorch-bin</a></span><sup><small>AUR</small></sup> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/noisetorch-git/">noisetorch-git</a></span><sup><small>AUR</small></sup>
</p>
<p>После запуска модуля требуется выбрать нужный микрофон. Имеется возможность выбора нужного порога активации. Для того, что бы не фильтровать голос, установите максимальный уровень.
</p>
<p>Можно сделать автозапуск с помощью systemd; смотрите <a rel="nofollow" class="external autonumber" href="https://github.com/noisetorch/NoiseTorch/wiki/Start-automatically-with-Systemd">[7]</a>. Обратите внимание, что путь к исполняемому файлу noisetorch другой при установке из AUR.
</p>
<h3>
<span id=".D0.A8.D1.83.D0.BC.D0.BE.D0.BF.D0.BE.D0.B4.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B4.D0.BB.D1.8F_.D0.B3.D0.BE.D0.BB.D0.BE.D1.81.D0.B0"></span><span class="mw-headline" id="Шумоподавление_для_голоса">Шумоподавление для голоса</span>
</h3>
<p>Установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=noise-suppression-for-voice">noise-suppression-for-voice</a></span> и смотрите <a rel="nofollow" class="external free" href="https://github.com/werman/noise-suppression-for-voice#pipewire">https://github.com/werman/noise-suppression-for-voice#pipewire</a> для настройки. После, установите источник подавления шумов по умолчанию в настройках аудио. Возможно потребуется перезапустить приложение.
</p>
<h3><span class="mw-headline" id="JamesDSP">JamesDSP</span></h3>
<p><a rel="nofollow" class="external text" href="https://github.com/Audio4Linux/JDSP4Linux#readme">JamesDSP for Linux</a> (пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/jamesdsp/">jamesdsp</a></span><sup><small>AUR</small></sup>) предоставляет звуковые эффекты с открытым исходным кодом для PipeWire и PulseAudio. Он использует свой собственный движок эффектов и не зависит от LADSPA, Calf и т.д. Изначально JamesDSP был опубликован как обработчик звуковых эффектов для устройств Android.
</p>
<h3>
<span id=".D0.9F.D0.BB.D0.B0.D0.B3.D0.B8.D0.BD.D1.8B_LADSPA.2C_LV2_.D0.B8_VST"></span><span class="mw-headline" id="Плагины_LADSPA,_LV2_и_VST">Плагины LADSPA, LV2 и VST</span>
</h3>
<p>Если вы хотите использовать плагины LADSPA, LV2 и VST, вы можете применить их используя виртуальный аудиовход Pulseaudio и хост Jack Carla. Установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pipewire-pulse">pipewire-pulse</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pipewire-jack">pipewire-jack</a></span> и <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=carla">carla</a></span>. Для начала создайте новый аудиовход в Pulseaudio под названием <code>default_null_sink</code>.
</p>
<pre>pactl load-module module-null-sink object.linger=1 media.class=Audio/Sink sink_name=default_null_sink channel_map=FL,FR
</pre>
<p>Запустите Carla через PipeWire <code>pw-jack carla-rack</code>. Во вкладке <i>Rack</i> добавьте плагины по желанию. Удостоверьтесь, что они имеют тип <i>stereo</i>. Вы можете поменять их очередность, в которой они будут работать, начиная с верха списка. После этого переместитесь во вкладку <i>Patchbay</i> и подключите <code>default_null_sink</code> к вводу Carla, а вывод Carla к нужному устройству воспроизведения (наушники, колонки, HDMI и т.п.). Сохраните конфигурацию в домашнюю директорию, напр. в <code>~/Documents/carla_sink_effects.carxp</code>.
</p>
<p>Вы можете протестировать эффекты в любом медиа приложение, производящем звук, например просмотром видео в браузере. Есть два способа сделать это. Открыть в Carla вкладку <i>Patchbay</i>, и перенаправить соединения нужного приложения к <code>default_null_sink</code>. Второй способ через <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pavucontrol">pavucontrol</a></span>, так же перенаправить аудио поток нужного приложения к аудиовходу <code>default_null_sink</code> (Этот способ запомнит перенаправление, поэтому последующие экземпляры приложения автоматически перенаправится на <code>default_null_sink</code>).
</p>
<p>Для применения вышеописанных настроек, необходимо создать два пользовательских systemd юнита:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/systemd/user/jack-carla-rack.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Load Carla Rack JACK host

[Service]
PassEnvironment="PIPEWIRE_LINK_PASSIVE=true"
Type=exec
ExecStart=/usr/bin/pw-jack carla-rack -n

[Install]
WantedBy=default.target</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/systemd/user/pulseaudio-null-sink@.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Load %i Pulseaudio null sink
Before=jack-carla-rack.service
After=pipewire-pulse.service

[Service]
Type=oneshot
ExecStart=/usr/bin/pactl load-module module-null-sink object.linger=1 media.class=Audio/Sink sink_name=%i channel_map=FL,FR
ExecStop=/usr/bin/pactl unload-module module-null-sink
RemainAfterExit=yes

[Install]
WantedBy=default.target</pre>
<p>Затем измените сервис <i>jack-carla-rack</i>, указав полный путь к вашему сохраненному файлу конфигурации в строке <i>Environment</i>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/systemd/user/jack-carla-rack.service.d/override.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Service]
Environment="CARLA_CONFIG_FILE=/home/username/Documents/carla_sink_effects.carxp"
ExecStart=
ExecStart=/usr/bin/pw-jack carla-rack -n $CARLA_CONFIG_FILE</pre>
<p>И наконец, включите <a href="../ru/Systemd/User.html" title="Systemd (Русский)/User (Русский)">пользовательские юниты</a> <code>pulseaudio-null-sink@default_null_sink.service</code> и <code>jack-carla-rack.service</code>.
</p>
<p>Обратите внимание, если вы установите <code>default_null_sink</code> как устройство по умолчанию, все приложения будут автоматически перенаправляться к этому аудиовходу и клавиши громкости будут менять его уровень, а не громкость устройств воспроизведения. Для того, чтобы изменять клавишами уровень громкости устройства, необходимо оставить его по умолчанию и перенаправлять аудиопоток приложения к <code>default_null_sink</code> через pavucontrol. (PipeWire запомнит перенаправление и использует его для последующих экземпляров приложений).
</p>
<h2>
<span id=".D0.A0.D0.B5.D1.88.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC"></span><span class="mw-headline" id="Решение_проблем">Решение проблем</span>
</h2>
<h3>
<span id=".D0.90.D1.83.D0.B4.D0.B8.D0.BE_2"></span><span class="mw-headline" id="Аудио_2">Аудио</span>
</h3>
<h4>
<span id="PipeWire_.D0.BD.D0.B5_.D0.B2.D0.B8.D0.B4.D0.B8.D1.82_.D0.BC.D0.B8.D0.BA.D1.80.D0.BE.D1.84.D0.BE.D0.BD"></span><span class="mw-headline" id="PipeWire_не_видит_микрофон">PipeWire не видит микрофон</span>
</h4>
<p>Модуль <code>alsa-monitor</code> по умолчанию использует <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=alsa-card-profiles">alsa-card-profiles</a></span> для обнаружения устройств. Если этот метод не работает, попробуйте выключить <code>api.alsa.use-acp</code> и/или включить <code>api.alsa.use-ucm</code>.
</p>
<p>Если используется <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pipewire-media-session">pipewire-media-session</a></span>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pipewire/media-session.d/alsa-monitor.conf (или ~/.config/pipewire/media-session.d/alsa-monitor.conf)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
rules = [
    {
        ...
        actions = {
        update-props = {
            ...
            <b>api.alsa.use-acp = false</b>
...</pre>
<p>Если используется <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=wireplumber">wireplumber</a></span>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/wireplumber/main.lua.d/50-alsa-config.lua (или ~/.config/wireplumber/main.lua.d/50-alsa-config.lua)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
alsa_monitor.rules = {
    {
        ...
        apply_properties = {
            -- Использование устройств ALSA-Card-Profile. Они используют UCM или
            -- конфигурацию профиля для настройки параметров устройства и микшера.
            <b>-- ["api.alsa.use-acp"] = true,</b>
 
            -- Использование UCM вместо profile по возможности. Можно отключить,
            -- чтобы не пытаться использовать профиль UCM.
            <b>["api.alsa.use-ucm"] = true,</b>
...</pre>
<p>Затем перезапустите PipeWire и проверьте список доступных устройств:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ pw-record --list-targets</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Available targets ("*" denotes default): 62
	58: description="Built-in Audio" prio=1872
	60: description="Built-in Audio" prio=2000
*	62: description="Built-in Audio (Loopback PCM)" prio=1984</pre>
<p>Другой вариант решения, предложенный <a rel="nofollow" class="external text" href="https://gitlab.freedesktop.org/pipewire/pipewire/-/issues/2332">в баг-трекере</a> — добавить микрофон вручную. Сперва убедитесь, что ALSA видит микрофон.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ arecord -l</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">**** List of CAPTURE Hardware Devices ****
card <i>номер_карты</i>: <i>имя_карты</i>, device <i>номер_устройства</i>: <i>имя_устройства</i>
  ...
</pre>
<p>Выберите свой микрофон из списка, а для дальнейшего тестирования микрофона выполните следующие команды.
</p>
<pre>$ arecord --duration=5 --format=dat --device=hw:<i>номер_карты</i>,<i>номер_устройства</i> test-mic.wav # запись с микрофона
$ aplay test-mic.wav # воспроизведение записи</pre>
<p>Если <code>arecord</code> успешно записывает микрофон, но PipeWire его не видит, попробуйте добавить файл настроек для ручного добавления микрофона.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pipewire/pipewire.conf.d/microphone.conf (или ~/.config/pipewire/pipewire.conf.d/microphone.conf)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">context.objects = [
    { factory = adapter
        args = {
            factory.name           = api.alsa.pcm.source
            node.name              = "microphone"
            node.description       = "Undetected Microphone"
            media.class            = "Audio/Source"
            api.alsa.path          = "hw:<i>номер_карты</i>,<i>номер_устройства</i>"
        }
    }
]</pre>
<p>Перезапустите PipeWire для применения изменений.
</p>
<h4>
<span id=".D0.97.D0.B2.D1.83.D0.BA_.D0.BD.D0.B5_.D0.BF.D0.B5.D1.80.D0.B5.D0.BA.D0.BB.D1.8E.D1.87.D0.B0.D0.B5.D1.82.D1.81.D1.8F_.D0.B0.D0.B2.D1.82.D0.BE.D0.BC.D0.B0.D1.82.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B8_.D0.BF.D1.80.D0.B8_.D0.BF.D0.BE.D0.B4.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B8_.D0.BD.D0.BE.D0.B2.D0.BE.D0.B3.D0.BE_.D1.83.D1.81.D1.82.D1.80.D0.BE.D0.B9.D1.81.D1.82.D0.B2.D0.B0"></span><span class="mw-headline" id="Звук_не_переключается_автоматически_при_подключении_нового_устройства">Звук не переключается автоматически при подключении нового устройства</span>
</h4>
<p>Чтобы автоматически переключаться на вновь подключенные устройства, раскомментируйте следующую строку (выделена жирным):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/share/pipewire/pipewire-pulse.conf (или добавьте в ~/.config/pipewire/pipewire.conf)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
context.exec = [
    { path = "pactl"        args = "load-module module-always-sink" }
    <b>{ path = "pactl"        args = "load-module module-switch-on-connect" }</b>
    #{ path = "/usr/bin/sh"  args = "~/.config/pipewire/default.pw" }
]
...</pre>
<p>Перезапустите пользовательские юниты <code>pipewire.service</code> и <code>pipewire-pulse.service</code> для применения изменений.
</p>
<h4>
<span id=".D0.97.D0.B2.D1.83.D0.BA_.D0.BD.D0.B5_.D0.BF.D0.B5.D1.80.D0.B5.D0.BA.D0.BB.D1.8E.D1.87.D0.B0.D0.B5.D1.82.D1.81.D1.8F_.D0.B0.D0.B2.D1.82.D0.BE.D0.BC.D0.B0.D1.82.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B8_.D0.BD.D0.B0_.D0.BD.D0.B0.D1.83.D1.88.D0.BD.D0.B8.D0.BA.D0.B8_Bluetooth"></span><span class="mw-headline" id="Звук_не_переключается_автоматически_на_наушники_Bluetooth">Звук не переключается автоматически на наушники Bluetooth</span>
</h4>
<p>Выполните <code>pactl load-module module-switch-on-connect</code> и настройте среду рабочего стола на автоматический запуск этой команды при входе в систему. Возможно, вам потребуется выполнить <code>wpctl set-default &lt;id&gt;</code>. Найти <code>&lt;id&gt;</code> можно в выводе команды <code>wpctl status</code>. Смотрите <a rel="nofollow" class="external text" href="https://gitlab.freedesktop.org/pipewire/wireplumber/-/issues/89">wireplumber issue #89</a> для более подробной информации.
</p>
<h4>
<span id=".D0.9D.D0.B5.D1.82_.D0.B7.D0.B2.D1.83.D0.BA.D0.B0_.D0.BF.D0.BE.D1.81.D0.BB.D0.B5_.D0.BF.D0.BE.D0.B4.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D1.8F_.D1.83.D1.81.D1.82.D1.80.D0.BE.D0.B9.D1.81.D1.82.D0.B2.D0.B0_Bluetooth"></span><span class="mw-headline" id="Нет_звука_после_подключения_устройства_Bluetooth">Нет звука после подключения устройства Bluetooth</span>
</h4>
<p>По состоянию на 2020-12-07, если у вас нет звука после подключения Bluetooth устройства, вам скорее всего потребуется переключить стандартный аудиопоток или перенаправить его к требуемому. Воспользуйтесь <code>pactl list sinks</code> для просмотра доступных потоков и <code>pactl set-default-sink</code> для смены стандартного потока на bluetooth устройство. Можно автоматизировать через <a href="../ru/Udev.html" title="Udev (Русский)">udev</a>, используя <a rel="nofollow" class="external text" href="https://gist.github.com/tinywrkb/04e7fd644afa9b92d33a3a99ab07ee9e">данный скрипт</a> как пример.
</p>
<p>Обсуждение данной проблемы можно посмотреть <a rel="nofollow" class="external text" href="https://www.reddit.com/r/archlinux/comments/jydd02/pipewirepulse_03164_in_testing_now_replaces/gd3m7fu/?context=3">здесь</a>. По словам автора скрипта, профиль гарнитуры (HSP) все еще может иметь проблемы.
</p>
<h4>
<span id=".D0.9C.D0.B0.D0.BB.D0.B5.D0.BD.D1.8C.D0.BA.D0.B0.D1.8F_.D0.B3.D1.80.D0.BE.D0.BC.D0.BA.D0.BE.D1.81.D1.82.D1.8C"></span><span class="mw-headline" id="Маленькая_громкость">Маленькая громкость</span>
</h4>
<p>После замены PulseAudio на Pipewire громкость была как задумано, но после перезагрузки звук невыносимо тихий.
</p>
<p>Откройте <code>alsamixer</code>, нажимайте <code>F6</code> для выбора нужной звуковой карты и удостоверьтесь, что уровень громкости стоит на 100%. <code>alsactl</code> должен сохранить настройки после перезагрузки.
</p>
<h4>
<span id=".D0.A3.D0.B2.D0.B5.D0.BB.D0.B8.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_RLIMIT_MEMLOCK"></span><span class="mw-headline" id="Увеличение_RLIMIT_MEMLOCK">Увеличение RLIMIT_MEMLOCK</span>
</h4>
<pre>Dec 13 11:11:11 HOST pipewire-pulse[99999]: Failed to mlock memory 0x7f4f659d8000 32832: This is not a problem but for best performance, consider increasing RLIMIT_MEMLOCK
</pre>
<p>Установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=realtime-privileges">realtime-privileges</a></span> и добавьте пользователя в группу <code>realtime</code>.
</p>
<p>Также, увеличение memlock с 64кБ до 128кБ должно хватить для решение проблемы. Если вы запускаете <code>pipewire-pulse</code> через <a href="../ru/Systemd/User.html" class="mw-redirect" title="Systemd/User (Русский)">systemd/User (Русский)</a>, допишите:
</p>
<pre>имя_пользователя	soft	memlock	64
имя_пользователя	hard	memlock	128
</pre>
<p>в <code>/etc/security/limits.d/username.conf</code>
</p>
<h4>
<span id=".D0.98.D0.B7.D0.BC.D0.B5.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5_.D1.87.D0.B0.D1.81.D1.82.D0.BE.D1.82.D1.8B_.D0.B4.D0.B8.D1.81.D0.BA.D1.80.D0.B5.D1.82.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8"></span><span class="mw-headline" id="Изменение_частоты_дискретизации">Изменение частоты дискретизации</span>
</h4>
<p>По умолчанию PipeWire глобально устанавливает частоту дискретизации равную 48КГц. Если вы хотите изменить ее (например если ваш ЦАП поддерживает более высокое значение), можно прописать своё значение по умолчанию:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pipewire/pipewire.conf (или ~/.config/pipewire/pipewire.conf)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
context.properties = {
    ...
    <b>default.clock.rate          = <i>частота_дискретизации'</i></b><i></i>
    ...</pre>
<h4>
<span id=".D0.98.D0.B7.D0.BC.D0.B5.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5_.D1.80.D0.B0.D0.B7.D1.80.D0.B5.D1.88.D1.91.D0.BD.D0.BD.D1.8B.D1.85_.D1.87.D0.B0.D1.81.D1.82.D0.BE.D1.82_.D0.B4.D0.B8.D1.81.D0.BA.D1.80.D0.B5.D1.82.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8"></span><span class="mw-headline" id="Изменение_разрешённых_частот_дискретизации">Изменение разрешённых частот дискретизации</span>
</h4>
<p>PipeWire также может динамически изменять выходную частоту дискретизации, поддерживаемую вашим ЦАП. Частота дискретизации соответствует частоте дискретизации воспроизводимого аудиопотока.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pipewire/pipewire.conf (или ~/.config/pipewire/pipewire.conf)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
context.properties = {
    ...
    <b>default.clock.allowed-rates = [ <i>частота_1</i> <i>частота_2</i> <i>частота_3</i> ... ]</b>
    ...</pre>
<p>например, <code>[ 44100 48000 88200 96000 ]</code>. Поддерживаемые значения должны быть описаны в инструкции к вашему ЦАП.
</p>
<p>По <a rel="nofollow" class="external text" href="https://gitlab.freedesktop.org/pipewire/pipewire/-/issues/1523">словам разработчика</a>，PipeWire допускает до 16 различных частот дискретизации и переключается по возможности. Это означает, что с приведёнными выше настройками <b>передискретизация не производится</b>, если используемая в аудиопотоке частота поддерживается устройством.
</p>
<p>Чтобы проверить, с какой выходной частотой дискретизации и форматом дискретизации данные отправляются на ЦАП (возможно, вам понадобится изменить цифры):
</p>
<pre>$ cat /proc/asound/card0/pcm0p/sub0/hw_params
</pre>
<p>Чтобы проверить, какая частота дискретизации используется на входе, измените <code>pcm0p</code> на <code>pcm0c</code>. (<code>c</code> означает «capture» — захват, <code>p</code> означает «playback» — воспроизведение).
</p>
<h4>
<span id=".D0.9A.D0.B0.D1.87.D0.B5.D1.81.D1.82.D0.B2.D0.BE_.D0.B7.D0.B2.D1.83.D0.BA.D0.B0_.28.D0.BA.D0.B0.D1.87.D0.B5.D1.81.D1.82.D0.B2.D0.BE_.D0.BF.D0.B5.D1.80.D0.B5.D0.B4.D0.B8.D1.81.D0.BA.D1.80.D0.B5.D1.82.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8.29"></span><span class="mw-headline" id="Качество_звука_(качество_передискретизации)">Качество звука (качество передискретизации)</span>
</h4>
<p>Если вы использовали PulseAudio с <code>resample-method = speex-float-10</code> или <code>soxr-vhq</code>, то вам стоит раскомментировать и изменить строку <code>resample.quality = 4</code> на <code>10</code> или максимальное <code>15</code> в блоке <code>stream.properties</code> в файлах <code>/etc/pipewire/client.conf</code> и <code>/etc/pipewire/pipewire-pulse.conf</code>. (скопируйте их из <code>/usr/share/pipewire/</code>, если они не существуют). Не забудьте перезапустить пользовательские юниты <code>pipewire.service</code> и <code>pipewire-pulse.socket</code> (никогда не забывайте про перезапуск <code>pipewire-pulse.socket</code>, если хотите применить изменения настроек).
</p>
<p>Разница в качестве между <code>10</code> и <code>15</code> незначительна, но разница в загрузке процессора составляет 2-3 раза. А разница в задержке между <code>4</code>, <code>10</code>, <code>15</code> ещё никем не исследована. Использование <code>resample.quality = 15</code> на 44100→48000 Гц на Ryzen 2600 приводит к тому, что процессы <code>pipewire</code> или <code>pipewire-pulse</code> нагружают одно ядро CPU на 4.0%.
</p>
<p>Вы можете сравнить ресемплеры здесь: <a rel="nofollow" class="external free" href="https://src.infinitewave.ca/">https://src.infinitewave.ca/</a> (не обращайте внимания на всё, что выше 18 КГц и более 120 дБ). speex указан как "Xiph.org Speex".
</p>
<p>PipeWire использует свой собственный алгоритм передискретизации под названием Spa. Как и в случае <code>sox</code> и Speex <code>speexenc</code>, алгоритм PipeWire доступен в виде автономной версии: <code>spa-resample</code>. Использование:
</p>
<pre>$ spa-resample -q 15 -f s24 -r 48000 input16bit44100orAnythingElse.wav output24bit48000hz.wav
</pre>
<p>Вероятно, можно как-то использовать другие ресемплеры, создав свой собственный выход. Или просто использовать плагин в проигрывателе (например, в Qmmp есть плагин SoX).
</p>
<h4>
<span id=".D0.92.D0.BD.D0.B5.D1.88.D0.BD.D1.8F.D1.8F_.D0.B7.D0.B2.D1.83.D0.BA.D0.BE.D0.B2.D0.B0.D1.8F_.D0.BA.D0.B0.D1.80.D1.82.D0.B0_.D0.BD.D0.B5_.D0.B2.D0.BA.D0.BB.D1.8E.D1.87.D0.B0.D0.B5.D1.82.D1.81.D1.8F_.D0.BF.D0.BE.D1.81.D0.BB.D0.B5_.D0.BF.D0.B5.D1.80.D0.B5.D0.BF.D0.BE.D0.B4.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D1.8F"></span><span class="mw-headline" id="Внешняя_звуковая_карта_не_включается_после_переподключения">Внешняя звуковая карта не включается после переподключения</span>
</h4>
<p>Проверьте <code>~/.config/pipewire-media-session/default-profile</code>. Если присутствуют значения с стандартным профилем "off", удалите их. Если же это не поможет, удалите все файлы из <code>~/.config/pipewire/media-session.d/</code> и перезапустите пользовательскую службу <code>pipewire.service</code>.
</p>
<h4>
<span id=".D0.9D.D0.B5.D1.82_.D0.B7.D0.B2.D1.83.D0.BA.D0.B0_.D0.B8.D0.BB.D0.B8_pactl_info_.D0.BF.D0.BE.D0.BA.D0.B0.D0.B7.D1.8B.D0.B2.D0.B0.D0.B5.D1.82_Failure:_Connection_refused"></span><span class="mw-headline" id="Нет_звука_или_pactl_info_показывает_Failure:_Connection_refused">Нет звука или pactl info показывает Failure: Connection refused</span>
</h4>
<p>Эта ошибка говорит о том, что приложение не может присоединиться к службе PipeWire-Pulse. Убедитесь, что <code>/etc/pipewire/pipewire-pulse.conf</code> существует и файл не пустой, и перезапустите пользовательскую службу <code>pipewire-pulse.service</code>.
</p>
<p>Если этот способ не исправит ошибку, запустите <code>strace -f -o /tmp/pipe.txt pactl info</code> для дебага и используйте <code>/tmp/pipe.txt</code> для помощи в IRC чате <a rel="nofollow" class="external text" href="ircs://irc.oftc.net/pipewire">#pipewire</a> или списках рассылки.
</p>
<h4>
<span id=".D0.9D.D0.B8.D0.B7.D0.BA.D0.BE.D0.B5_.D0.BA.D0.B0.D1.87.D0.B5.D1.81.D1.82.D0.B2.D0.BE_.D0.B7.D0.B2.D1.83.D0.BA.D0.B0_.D1.87.D0.B5.D1.80.D0.B5.D0.B7_Bluetooth"></span><span class="mw-headline" id="Низкое_качество_звука_через_Bluetooth">Низкое качество звука через Bluetooth</span>
</h4>
<p>В случае, если звук через Bluetooth заикается, проверьте статус пользовательского юнита <code>pipewire.service</code>. Если у вас есть ошибки по типу:
</p>
<pre>Feb 17 18:23:01 HOST pipewire[249297]: (bluez_input.18:54:CF:04:00:56.a2dp-sink-60) client too slow! rate:512/48000 pos:370688 status:triggered
</pre>
<p>проверьте используемый кодек командой <code>pactl list sinks</code> и попробуйте поменять его изменением <code>bluez5.codecs</code> на один из следующих: <code>sbc aac ldac aptx aptx_hd</code>. Также можно попробовать включить поддержку mSBC (исправляет микрофон на Sony 1000XM3, то есть Headphones WH-1000XM3 и Earbuds WF-1000XM3), и кодек SBC-XQ.
</p>
<p>Если используется <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pipewire-media-session">pipewire-media-session</a></span>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pipewire/media-session.d/bluez-monitor.conf (или ~/.config/pipewire/media-session.d/bluez-monitor.conf)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
properties = {
  ...
  <b>bluez5.enable-msbc = true</b>
  <b>bluez5.enable-sbc-xq = true</b>
  <b>bluez5.codecs = [sbc sbc_xq]</b>
...</pre>
<p>Если используется <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=wireplumber">wireplumber</a></span>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/wireplumber/bluetooth.lua.d/51-bluez-config.lua (или ~/.config/wireplumber/bluetooth.lua.d/51-bluez-config.lua)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">bluez_monitor.properties = {
  ["bluez5.enable-sbc-xq"] = true,
  ["bluez5.enable-msbc"] = true,
  ["bluez5.codecs"] = "[sbc sbc_xq]",
}</pre>
<p>Перезапустите пользовательскую службу <code>pipewire.service</code> для применения изменений.
</p>
<h4>
<span id=".D0.97.D0.B0.D0.BC.D0.B5.D1.82.D0.BD.D0.B0.D1.8F_.D0.B7.D0.B0.D0.B4.D0.B5.D1.80.D0.B6.D0.BA.D0.B0_.D0.B7.D0.B2.D1.83.D0.BA.D0.B0_.D0.BF.D1.80.D0.B8_.D0.B2.D0.BE.D1.81.D0.BF.D1.80.D0.BE.D0.B8.D0.B7.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D0.B8"></span><span class="mw-headline" id="Заметная_задержка_звука_при_воспроизведении">Заметная задержка звука при воспроизведении</span>
</h4>
<p>Обычно это происходит после отключения узла в период неактивности.
</p>
<p>Если вы используете <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pipewire-media-session">pipewire-media-session</a></span>, отключить это можно путём редактирования одного из файлов <code>/etc/pipewire/media-session.d/*-monitor.conf</code> в зависимости от того, где происходит задержка, заменив значение <code>session.suspend-timeout-seconds</code> на 0 для отключения или поэкспериментировав с другими значениями.
</p>
<p>Либо же закомментируйте строку <code>suspend-node</code> в файле <code>/etc/pipewire/media-session.d/media-session.conf</code>.
</p>
<p>Перезапустите службы <code>pipewire</code> и <code>pipewire-pulse</code> для применения изменений, или перезагрузитесь.
</p>
<p>Если вы используете <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=wireplumber">wireplumber</a></span>, создайте новый файл для переопределения настроек по умолчанию:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/wireplumber/main.lua.d/51-disable-suspension.lua
(или /etc/wireplumber/main.lua.d/51-disable-suspension.lua)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">table.insert (alsa_monitor.rules, {
  matches = {
    {
      -- Соответствует всем источникам.
      { "node.name", "matches", "alsa_input.*" },
    },
    {
      -- Соответствует всем выводам.
      { "node.name", "matches", "alsa_output.*" },
    },
  },
  apply_properties = {
    ["session.suspend-timeout-seconds"] = 0,  -- 0 выключает приостановку
  },
})</pre>
<p>Вместо полного отключения приостановки можно задать желаемое количество секунд задержки перед приостановкой.
</p>
<h4>
<span id=".D0.9F.D1.80.D0.BE.D0.BF.D0.B0.D0.B4.D0.B0.D0.BD.D0.B8.D0.B5_.D0.B7.D0.B2.D1.83.D0.BA.D0.B0_.D0.BF.D1.80.D0.B8_.D0.BF.D1.80.D0.BE.D0.B8.D0.B3.D1.80.D1.8B.D0.B2.D0.B0.D0.BD.D0.B8.D0.B8_.D0.B4.D1.80.D1.83.D0.B3.D0.B8.D1.85_.D0.BF.D0.BE.D1.82.D0.BE.D0.BA.D0.BE.D0.B2"></span><span class="mw-headline" id="Пропадание_звука_при_проигрывании_других_потоков">Пропадание звука при проигрывании других потоков</span>
</h4>
<p>Обычно проблему можно диагностировать в <a href="../ru/Systemd/Journal.html" title="Systemd (Русский)/Journal (Русский)">журнале</a> пользовательской службы <code>pipewire-pulse.service</code>, в котором могут обнаружиться такие строки:
</p>
<pre>pipewire-pulse[21740]: pulse-server 0x56009b9d5de0: [Nightly] UNDERFLOW channel:0 offset:370676 underrun:940
</pre>
<p>Согласно <a rel="nofollow" class="external text" href="https://gitlab.freedesktop.org/pipewire/pipewire/-/wikis/Troubleshooting#underrununderflow-and-broken-pipe-errors">официальному гайду PipeWire по решению проблем</a>, для решения проблемы при использовании <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pipewire-media-session">pipewire-media-session</a></span> измените следующие настройки:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pipewire/media-session.d/alsa-monitor.conf (или ~/.config/pipewire/media-session.d/alsa-monitor.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">api.alsa.headroom = 1024</pre>
<p>При использовании <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=wireplumber">wireplumber</a></span>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/wireplumber/main.lua.d/50-alsa-config.lua (или ~/.config/wireplumber/main.lua.d/50-alsa-config.lua)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">apply_properties = {
    ["api.alsa.headroom"] = 1024,
},</pre>
<p>Если звук заикается из-за блокировки страниц в ядре или создаваемых планировщиком задержек, смотрите <a href="../en/Gaming.html#Tweaking_kernel_parameters_for_response_time_consistency" title="Gaming">Gaming#Tweaking kernel parameters for response time consistency</a>.
</p>
<h4>
<span id=".D0.98.D1.81.D0.BA.D0.B0.D0.B6.D1.91.D0.BD.D0.BD.D1.8B.D0.B9_.D0.B7.D0.B2.D1.83.D0.BA"></span><span class="mw-headline" id="Искажённый_звук">Искажённый звук</span>
</h4>
<ul>
<li>Для микрофонов, найдите проблемную звуковую карту в <code>alsamixer</code> и уменьшите уровень "Mic Boost" или "Internal Mic Boost".</li>
<li>Попробуйте уменьшить частоту дискретизации до <code>44100</code> (44.1 кГц), как описано в разделе <a href="#%D0%98%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5_%D1%87%D0%B0%D1%81%D1%82%D0%BE%D1%82%D1%8B_%D0%B4%D0%B8%D1%81%D0%BA%D1%80%D0%B5%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8">#Изменение частоты дискретизации</a>.</li>
</ul>
<h4>
<span id=".D0.A0.D0.B0.D0.B7.D0.BB.D0.B8.D1.87.D0.BD.D1.8B.D0.B5_.D0.BF.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC.D1.8B_.D0.BF.D0.BE.D1.81.D0.BB.D0.B5_.D0.BF.D1.80.D0.BE.D1.81.D1.82.D0.BE.D1.8F"></span><span class="mw-headline" id="Различные_проблемы_после_простоя">Различные проблемы после простоя</span>
</h4>
<p>Если звук пропал или исказился после пробуждения системы после сна, возможно потребуется реинициализировать ALSA:
</p>
<pre># alsactl init
</pre>
<h4>
<span id=".D0.91.D0.BE.D0.BB.D1.8C.D1.88.D0.B0.D1.8F_.D0.B7.D0.B0.D0.B4.D0.B5.D1.80.D0.B6.D0.BA.D0.B0_.D0.BF.D1.80.D0.B8_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B8_USB_.D0.A6.D0.90.D0.9F_.28.D0.BD.D0.B0.D0.BF.D1.80.D0.B8.D0.BC.D0.B5.D1.80.2C_.D0.A6.D0.90.D0.9F_Schiit.29"></span><span class="mw-headline" id="Большая_задержка_при_использовании_USB_ЦАП_(например,_ЦАП_Schiit)">Большая задержка при использовании USB ЦАП (например, ЦАП Schiit)</span>
</h4>
<p>Изменение частоты дискретизации или формата может помочь уменьшить задержку с некоторыми ЦАП, такими как Schiit Hel 2.<a rel="nofollow" class="external autonumber" href="https://www.reddit.com/r/osugame/comments/msifdd/usb_dacamp_and_audio_lag/">[8]</a>
Используя правила соответствия в <i>pipewire-media-session</i>, мы можем установить свойства для устройств.<a rel="nofollow" class="external autonumber" href="https://gitlab.freedesktop.org/pipewire/pipewire/-/wikis/Config-pipewire-media-session#matching-rules">[9]</a><sup title="Статус последней проверки: 404">[<a href="https://en.wikipedia.org/wiki/ru:%D0%92%D0%B8%D0%BA%D0%B8%D0%BF%D0%B5%D0%B4%D0%B8%D1%8F:%D0%9C%D1%91%D1%80%D1%82%D0%B2%D1%8B%D0%B5_%D1%81%D1%81%D1%8B%D0%BB%D0%BA%D0%B8" class="extiw" title="wikipedia:ru:Википедия:Мёртвые ссылки">устаревшая ссылка</a> 2024-07-30 ⓘ]</sup>
</p>
<p>Скопируйте стандартный файл настроек <code>/usr/share/pipewire/media-session.d/alsa-monitor.conf</code> в <code>/etc/pipewire/media-session.d/</code> или <code>~/.config/pipewire/media-session.d/</code>.
Затем добавьте примерно такой блок правил:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pipewire/media-session.d/alsa-monitor.conf (или ~/.config/pipewire/media-session.d/alsa-monitor.conf)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
rules = {
    ...
    {
        matches = [
            {
                node.name = "alsa_output.<i>имя-узла</i>"
            }
        ]
        actions = {
            update-props = {
                audio.format = "S24_3LE"
                audio.rate = 96000
                # Удваивайте это значение, пока не возникнут проблемы
                api.alsa.period-size = 128
...</pre>
<p>Узнать <code>alsa_output.<i>имя-узла</i></code> можно с помощью <code>pw-top</code>.
</p>
<p>Ваш ЦАП может поддерживать другой формат или частоту дискретизации. Можно проверить, что поддерживает ЦАП, через <a href="../en/Advanced_Linux_Sound_Architecture.html" class="mw-redirect" title="Advanced Linux Sound Architecture (Русский)">ALSA</a>:
</p>
<p>Сначала узнайте номер карты вашего ЦАП:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ aplay -l</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
card 3: S2 [Schiit Hel 2], device 0: USB Audio [USB Audio]
  Subdevices: 0/1
  Subdevice #0: subdevice #0
...
</pre>
<p>В данном примере это карта 3.
Получите все поддерживаемые частоты дискретизации и форматы:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ cat /proc/asound/card<i>X</i>/stream<i>X</i></pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
Playback:
  ...
  Interface 1
    Altset 1
    Format: S16_LE
    Channels: 2
    Endpoint: 0x05 (5 OUT) (ASYNC)
    Rates: 44100, 48000, 88200, 96000, 176400, 192000, 352800, 384000
    Data packet interval: 125 us
    Bits: 16
    ...
  Interface 1
    Altset 2
    Format: S24_3LE
    Channels: 2
    Endpoint: 0x05 (5 OUT) (ASYNC)
    Rates: 44100, 48000, 88200, 96000, 176400, 192000, 352800, 384000
    Data packet interval: 125 us
    Bits: 24
    ...
  Interface 1
    Altset 3
    Format: S32_LE
    Channels: 2
    Endpoint: 0x05 (5 OUT) (ASYNC)
    Rates: 44100, 48000, 88200, 96000, 176400, 192000, 352800, 384000
    Data packet interval: 125 us
    Bits: 32
    ...
...
</pre>
<p>В данном случае случае <code>S16_LE, S24_3LE, S32_LE</code> — это поддерживаемые форматы, а <code>44100, 48000, 88200, 96000, 176400, 192000, 352800, 384000</code> — поддерживаемые частоты дискретизации для всех форматов.
</p>
<h4>
<span id=".D0.9D.D0.B5.D1.82_.D0.B7.D0.B2.D1.83.D0.BA.D0.B0_.D0.BE.D1.82_USB_.D0.A6.D0.90.D0.9F_.D0.B4.D0.BE_30.25_.D0.B3.D1.80.D0.BE.D0.BC.D0.BA.D0.BE.D1.81.D1.82.D0.B8"></span><span class="mw-headline" id="Нет_звука_от_USB_ЦАП_до_30%_громкости">Нет звука от USB ЦАП до 30% громкости</span>
</h4>
<p>Некоторые USB ЦАП не выдают звук, если громкость ниже определённой <a rel="nofollow" class="external autonumber" href="https://gitlab.freedesktop.org/pipewire/pipewire/-/issues/1117">[10]</a>. Обычно это около 25-30%, что приводит к некомфортному начальному уровню громкости и невозможности поддерживать низкий уровень громкости. Решением является игнорирование аппаратного управления громкостью путём установки <code>["api.alsa.soft-mixer"]</code> в <code>true</code>.
</p>
<p>Если используется <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=wireplumber">wireplumber</a></span>, можно обновить конфигурацию <code>/usr/share/wireplumber/main.lua.d/50-alsa-config.lua</code>, добавив туда фрагмент с помощью <code>table.insert</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/wireplumber/main.lua.d/51-volume-fix.lua</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">table.insert (alsa_monitor.rules, {
    matches = {
      {
        -- Это правило охватывает все карты.
        { "device.name", "matches", "alsa_card.*" },
      },
    },
    -- Применение свойств в найденным объектам.
    apply_properties = {
      -- Не использовать аппаратный микшер для управления громкостью.
      -- Использовать только программную громкость. Микшер по-прежнему
      -- используется для отключения неиспользуемых путей в зависимости
      -- от выбранного порта.
      ["api.alsa.soft-mixer"] = true,
    }
  })</pre>
<p>Затем перезапустите pipewire. Установите мастер-громкость в <code>alsamixer</code>, а затем сохраните настройки с помощью <code># alsactl store</code>. Теперь микшер громкости должен работать без проблем.
</p>
<h4>
<span id=".D0.90.D1.83.D0.B4.D0.B8.D0.BE_.D0.B2_.D1.80.D0.B5.D0.B6.D0.B8.D0.BC.D0.B5_.D1.80.D0.B5.D0.B0.D0.BB.D1.8C.D0.BD.D0.BE.D0.B3.D0.BE_.D0.B2.D1.80.D0.B5.D0.BC.D0.B5.D0.BD.D0.B8_.D0.BD.D0.B5_.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.B0.D0.B5.D1.82"></span><span class="mw-headline" id="Аудио_в_режиме_реального_времени_не_работает">Аудио в режиме реального времени не работает</span>
</h4>
<p>Если в статусе пользовательского юнита <code>pipewire.service</code> есть ошибка <code>RTKit error: org.freedesktop.DBus.Error.AccessDenied</code>, это означает, что демон pipewire не получил приоритет реального времени. Смотрите <a rel="nofollow" class="external autonumber" href="https://gitlab.freedesktop.org/pipewire/pipewire/-/issues/1069">[11]</a> для более подробной информации.
</p>
<h4>
<span id=".D0.9E.D0.B4.D0.BD.D0.BE.D0.B2.D1.80.D0.B5.D0.BC.D0.B5.D0.BD.D0.BD.D1.8B.D0.B9_.D0.B2.D1.8B.D0.B2.D0.BE.D0.B4_.D0.BD.D0.B0_.D0.BD.D0.B5.D1.81.D0.BA.D0.BE.D0.BB.D1.8C.D0.BA.D0.BE_.D0.B2.D1.8B.D1.85.D0.BE.D0.B4.D0.BE.D0.B2_.D0.BD.D0.B0_.D0.BE.D0.B4.D0.BD.D0.BE.D0.B9_.D0.B7.D0.B2.D1.83.D0.BA.D0.BE.D0.B2.D0.BE.D0.B9_.D0.BA.D0.B0.D1.80.D1.82.D0.B5"></span><span class="mw-headline" id="Одновременный_вывод_на_несколько_выходов_на_одной_звуковой_карте">Одновременный вывод на несколько выходов на одной звуковой карте</span>
</h4>
<p>Создайте копию файла <code>/usr/share/alsa-card-profile/mixer/profile-sets/default.conf</code>, чтобы изменения были постоянными. В нём мы определим профиль, объединяющий два стандартных отображения для аналогового и HDMI выводов.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/share/alsa-card-profile/mixer/profile-sets/multiple.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[General]
auto-profiles = no

[Mapping analog-stereo]
device-strings = front:%f
channel-map = left,right
paths-output = analog-output analog-output-lineout analog-output-speaker analog-output-headphones analog-output-headphones-2
paths-input = analog-input-front-mic analog-input-rear-mic analog-input-internal-mic analog-input-dock-mic analog-input analog-input-mic analog-input-linein analog-input-aux analog-input-video analog-input-tvtuner analog-input-fm analog-input-mic-line analog-input-headphone-mic analog-input-headset-mic
priority = 15

[Mapping hdmi-stereo]
description = Digital Stereo (HDMI)
device-strings = hdmi:%f
paths-output = hdmi-output-0
channel-map = left,right
priority = 9
direction = output

[Profile multiple]
description = Analog Stereo Duplex + Digital Stereo (HDMI) Output
output-mappings = analog-stereo hdmi-stereo
input-mappings = analog-stereo</pre>
<p>Теперь настроим pipewire-media-session на использование нового профиля карты для нужных устройств. Идентификаторы можно узнать с помощью <code>$ pw-cli dump device</code>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pipewire/media-session.d/alsa-monitor.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">rules = [
    {
        matches = [ { alsa.card_name = "HDA Intel PCH" } ]
        actions = {
            update-props = {
                api.alsa.use-acp = true
                device.profile-set = "multiple.conf"
                device.profile = "multiple"
                api.acp.auto-profile = false
                api.acp.auto-port = false
            }
        }
    }
]</pre>
<h4>
<span id=".D0.9D.D0.B5.D1.82_.D0.B7.D0.B2.D1.83.D0.BA.D0.BE.D0.B2_.D1.83.D0.B2.D0.B5.D0.B4.D0.BE.D0.BC.D0.BB.D0.B5.D0.BD.D0.B8.D0.B9_.D0.B2_Discord"></span><span class="mw-headline" id="Нет_звуков_уведомлений_в_Discord">Нет звуков уведомлений в Discord</span>
</h4>
<p>Это может быть вызвано слишком низким значением min.quantum, попробуйте установить его на более чем 700. Можно сделать переопределение специально для Discord, добавив следующее правило в раздел pulse.rules в pipewire-pulse.conf.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pipewire/pipewire-pulse.conf (или ~/.config/pipewire/pipewire-pulse.conf)</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
pulse.rules = [
  ...
    {
        # Discord notification sounds fix
        matches = [ { application.process.binary = "Discord" } ]
        actions = {
            update-props = {
                pulse.min.quantum      = 1024/48000     # 21ms
            }
        }
    }
...</pre>
<h3>
<span id=".D0.92.D0.B8.D0.B4.D0.B5.D0.BE_2"></span><span class="mw-headline" id="Видео_2">Видео</span>
</h3>
<h4>
<span id="OBS_.D0.BD.D0.B8.D1.87.D0.B5.D0.B3.D0.BE_.D0.BD.D0.B5_.D0.BF.D0.BE.D0.BA.D0.B0.D0.B7.D1.8B.D0.B2.D0.B0.D0.B5.D1.82.2C_.D0.B4.D0.B0.D0.B6.D0.B5_.D0.B5.D1.81.D0.BB.D0.B8_.D1.81.D0.BF.D1.80.D0.B0.D1.88.D0.B8.D0.B2.D0.B0.D0.B5.D1.82_.D0.BE.D0.BA.D0.BD.D0.BE.2F.D1.8D.D0.BA.D1.80.D0.B0.D0.BD"></span><span class="mw-headline" id="OBS_ничего_не_показывает,_даже_если_спрашивает_окно/экран">OBS ничего не показывает, даже если спрашивает окно/экран</span>
</h4>
<p>Если вы уверены, что у вас установлен <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xdg-desktop-portal">xdg-desktop-portal</a></span>, а также <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xdg-desktop-portal-gtk">xdg-desktop-portal-gtk</a></span> или <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xdg-desktop-portal-kde">xdg-desktop-portal-kde</a></span>, проверьте статус этих демонов.
</p>
<p>В OBS, если всё работает, в стандартном выводе должно быть что-то такое:
</p>
<pre>...
info: [pipewire] desktop selected, setting up screencast
info: [pipewire] created stream 0x5632d7456850
info: [pipewire] playing stream…
</pre>
<p>Для многомониторных установок пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=slurp">slurp</a></span> позволит захватить все экраны.
</p>
<h2>
<span id=".D0.A1.D0.BC.D0.BE.D1.82.D1.80.D0.B8.D1.82.D0.B5_.D1.82.D0.B0.D0.BA.D0.B6.D0.B5"></span><span class="mw-headline" id="Смотрите_также">Смотрите также</span>
</h2>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.freedesktop.org/pipewire/pipewire/-/wikis/home">Wiki</a> — PipeWire вики на Freedesktop GitLab</li>
<li>
<a rel="nofollow" class="external text" href="https://blogs.gnome.org/uraeus/2018/01/26/an-update-on-pipewire-the-multimedia-revolution-an-update/">Pipewire Update Blog Post</a> — Пост в блоге от января 2018 с описанием состояния разработки на тот момент</li>
<li>
<a rel="nofollow" class="external text" href="https://blogs.gnome.org/uraeus/2020/09/04/pipewire-late-summer-update-2020/">PipeWire Late Summer Update 2020</a> — Пост в блоге от сентября 2020</li>
</ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../ru/Category:Multimedia.html" title="Category:Multimedia (Русский)">Multimedia (Русский)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li></ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=PipeWire_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;oldid=813438">https://wiki.archlinux.org/index.php?title=PipeWire_(Русский)&amp;oldid=813438</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 30 July 2024, at 15:33.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
