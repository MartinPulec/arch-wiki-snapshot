<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-client-preferences-disabled vector-feature-client-prefs-pinned-disabled vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Full system backup with tar (Español) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.42.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Full_system_backup_with_tar_Español rootpage-Full_system_backup_with_tar_Español skin-vector-2022 action-view skin--responsive">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" role="navigation" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Descripción" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Descripci%C3%B3n">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">1</span>Descripción</div>
		</a>
		
		<ul id="toc-Descripción-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Arrancar_con_LiveCD" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Arrancar_con_LiveCD">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">2</span>Arrancar con LiveCD</div>
		</a>
		
		<ul id="toc-Arrancar_con_LiveCD-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Cambiar_a_un_entorno_enjaulado" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Cambiar_a_un_entorno_enjaulado">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">3</span>Cambiar a un entorno enjaulado</div>
		</a>
		
		<ul id="toc-Cambiar_a_un_entorno_enjaulado-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Montar_otras_particiones" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Montar_otras_particiones">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">4</span>Montar otras particiones</div>
		</a>
		
		<ul id="toc-Montar_otras_particiones-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Excluir_archivos" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Excluir_archivos">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">5</span>Excluir archivos</div>
		</a>
		
		<ul id="toc-Excluir_archivos-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Script_para_realizar_la_copia_de_seguridad" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Script_para_realizar_la_copia_de_seguridad">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">6</span>Script para realizar la copia de seguridad</div>
		</a>
		
		<ul id="toc-Script_para_realizar_la_copia_de_seguridad-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Restaurar" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Restaurar">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">7</span>Restaurar</div>
		</a>
		
		<ul id="toc-Restaurar-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Realizar_copia_de_seguridad_con_compresión_parallel" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Realizar_copia_de_seguridad_con_compresi%C3%B3n_parallel">
			<div class="vector-toc-text">
			<span class="vector-toc-numb">8</span>Realizar copia de seguridad con compresión parallel</div>
		</a>
		
		<ul id="toc-Realizar_copia_de_seguridad_con_compresión_parallel-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav role="navigation" aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Full system backup with tar (Español)</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang">
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 3 languages">
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-3" aria-hidden="true"><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">3 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-en mw-list-item"><a href="../en/Full_system_backup_with_tar.html" title="Full system backup with tar – English" lang="en" hreflang="en" class="interlanguage-link-target"><span>English</span></a></li>
<li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://wiki.archlinux.jp/index.php/Tar_%E3%81%AB%E3%82%88%E3%82%8B%E3%83%95%E3%83%AB%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E3%83%90%E3%83%83%E3%82%AF%E3%82%A2%E3%83%83%E3%83%97" title="Tar によるフルシステムバックアップ – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target"><span>日本語</span></a></li>
<li class="interlanguage-link interwiki-zh-hans mw-list-item"><a href="https://wiki.archlinuxcn.org/wiki/Full_system_backup_with_tar" title="Full system backup with tar – 中文（简体）" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target"><span>中文（简体）</span></a></li>
			</ul>
			
		</div>

	</div>
</div>
</header>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-client-prefs-landmark" aria-label="Appearance">
						</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="es" dir="ltr">
<div class="archwiki-template-box archwiki-template-box-note">Esta traducción de <a href="../en/Full_system_backup_with_tar.html" title="Full system backup with tar">Full system backup with tar</a> fue revisada el <b>2019-11-15</b>. Si existen <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Full_system_backup_with_tar&amp;diff=0&amp;oldid=563848">cambios</a> puede <a href="../es/ArchWiki:Translation_Team/Contributing.html" title="ArchWiki:Translation Team (Español)/Contributing (Español)">actualizarla</a> o avisar al <a href="../es/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (Español)">equipo de traducción</a>.</div>
<div class="archwiki-template-meta-related-articles">
<p>Artículos relacionados</p>
<ul>
<li><a href="../es/Full_system_backup_with_SquashFS.html" title="Full system backup with SquashFS (Español)">Full system backup with SquashFS (Español)</a></li>
</ul>
</div>
<p>Este artículo le enseñará como hacer una copia de seguridad de todo el sistema con <a href="../es/Archiving_and_compression.html" class="mw-redirect" title="Tar (Español)">tar</a>.
</p>
<meta property="mw:PageProp/toc">
<h2>
<span id="Descripci.C3.B3n"></span><span class="mw-headline" id="Descripción">Descripción</span>
</h2>
<p>Crear una copia de seguridad con <a href="https://en.wikipedia.org/wiki/es:Tar" class="extiw" title="wikipedia:es:Tar">tar</a> tiene la ventaja de usar compresión que puede ayudar a guardar espacio en disco, y aportar simplicidad. El proceso solo requiere varios pasos, que son:
</p>
<ol>
<li>Arrancar desde un LiveCD.</li>
<li>Pasar al entorno enjaulado de la instalación Linux.</li>
<li>Montar (si hubiesen) otras particiones/discos.</li>
<li>Añadir exclusiones.</li>
<li>Utilizar el script de respaldo para hacer la copia de seguridad</li>
</ol>
<p>Para reducir al mínimo la inactividad la copia de seguridad puede alternativamente realizarse en un sistema en ejecución usando <a href="../es/LVM.html#Instant%C3%A1neas/Snapshots" title="LVM (Español)">instantáneas LVM</a>,
si todos los sistemas de archivos están montados en volúmenes LVM.
</p>
<h2><span class="mw-headline" id="Arrancar_con_LiveCD">Arrancar con LiveCD</span></h2>
<p>Muchos LiveCD, USB... tienen la capacidad de dejarle cambiar al entorno enjaulado de su instalación. Aunque no es requisito montar una jaula para hacer la copia de seguridad, esto proporciona la capacidad para ejecutar el script sin tener que pasarlo a un dispositivo de almacenamiento temporal o tener que ubicarlo en el sistema de archivos. El medio vivo debe compartir con la instalación linux la misma arquitectura (es decir, i686 o x86_64).
</p>
<h2><span class="mw-headline" id="Cambiar_a_un_entorno_enjaulado">Cambiar a un entorno enjaulado</span></h2>
<p>Lo primero que debería tener es un entorno de para ejecutar scripts («scripting») en su instalación Linux. Si no sabe lo que es, significa que puede ejecutar cualquier script que pueda tener como si fuera un programa normal. Si no pudiese, vea este <a rel="nofollow" class="external text" href="https://linuxtidbits.wordpress.com/2009/12/03/setting-up-a-scripting-environment/">artículo</a> para saber como hacerlo. Lo siguiente que necesita es pasar al entorno enjaulado, para aprender más sobre este proceso, lea <a href="../es/Chroot.html" class="mw-redirect" title="Change root (Español)">esto</a>. Dentro de una jaula, no necesita ningún sistema de archivos temporal (<code>/proc</code>, <code>/sys</code> y <code>/dev</code>). Estos sistemas de archivos se inicializan durante el arranque y en verdad no debe hacer una copia de ellos, ya que pueden interferir con la correcta (y necesaria) inicialización del sistema, que puede cambiar con cualquier actualización. Para cambiar al entorno enjaulado, tiene que montar la partición raíz de su instalación Linux. Por ejemplo:
</p>
<pre>mkdir /mnt/arch
mount /dev/&lt;su partición o disco&gt;
</pre>
<p>Use <code>fdisk -l</code> para descubrir sus particiones y discos. Una vez lo sepa, ejecute <code>chroot</code>:
</p>
<pre>cd /mnt/arch
chroot . /bin/bash
</pre>
<p>Este ejemplo claramente usa bash pero puede utilizar otros intérpretes de órdenes si están disponibles. Ahora se encontrará en su entorno de scripting (esto es proporcionado si se haya cargado el archivo de configuración <code>~/.bashrc</code> al entrar en la jaula):
</p>
<pre>cat ~/.bash_profile
# Si usa bash, carga la configuración del archivo local .bashrc
source ~/.bashrc
</pre>
<h2><span class="mw-headline" id="Montar_otras_particiones">Montar otras particiones</span></h2>
<p>Otras particiones que use tendrán que ser montadas en su ubicaciones correspondientes (por ejemplo, si tiene una partición <code>/home</code> separada).
</p>
<h2><span class="mw-headline" id="Excluir_archivos">Excluir archivos</span></h2>
<p><code>tar</code> tiene la capacidad de ignorar ciertos archivos y carpetas. La sintaxis requiere colocar cada archivo o carpeta a ignorar en una línea distinta. <code>tar</code> también tiene la capacidad de entender expresiones regulares (regexps).  Por ejemplo:
</p>
<pre># No copias antiguas                                                               
/opt/backup/arch-full*                                                                   
                                                                                
# No archivos temporales                                                           
/tmp/*

# No a la caché de pacman
/var/cache/pacman/pkg/
...
</pre>
<h2><span class="mw-headline" id="Script_para_realizar_la_copia_de_seguridad">Script para realizar la copia de seguridad</span></h2>
<p>Respaldar con tar es un proceso directo. Aquí tiene un script básico que puede hacerlo y que hace además unas cuantas comprobaciones. Tendrá que modificar este script definiendo la ubicación donde poner la copia, los archivos a excluir (si tiene alguno), y ejecutarlo una vez haya pasado al entorno <code>chroot</code> y montado todas las particiones.
</p>
<pre>#!/bin/bash
# Copia completa del sistema

# Destino de la copia
backdest=/opt/backup

# Etiquetas para la copia
#PC=${HOSTNAME}
pc=pavilion
distro=arch
type=full
date=$(date "+%F")
backupfile="$backdest/$distro-$type-$date.tar.gz"

# Exclusión de ubicación de archivo
prog=${0##*/} # Nombre de programa según el nombre del archivo
excdir="/home/&lt;user&gt;/.bin/root/backup"
exclude_file="$excdir/$prog-exc.txt"

# Comprobación de jaula
echo -n "Recuerde hacer chroot desde un LiveCD. ¿Ejecutar la copia de seguridad? (s/n): "
read executeback

# Comprobar si el archivo de exclusión existe
if [ ! -f $exclude_file ]; then
  echo -n "No existen ningún archivo excluido, ¿continuar? (s/n): "
  read continue
  if [ $continue == "n" ]; then exit; fi
fi

if [ $executeback = "s" ]; then
  # -p y --xattrs almacenan todos los permisos y atributos extendidos.
  # Sin ambos, muchos programas dejarán de funcionar.
  # Es seguro eliminar el indicador detallado (-v). Si estás usando un
  # terminal lenta, esto puede acelerar el proceso de copia de seguridad.
  tar --exclude-from=$exclude_file --xattrs -czpvf $backupfile /
fi</pre>
<h2><span class="mw-headline" id="Restaurar">Restaurar</span></h2>
<p>Para restaurar desde una copia de seguridad anterior, monte todas las particiones relevantes, cambie el directorio de trabajo actual al directorio raíz y ejecute:
</p>
<pre>bsdtar --xattrs -xpf $backupfile
</pre>
<p>reemplazando $backupfile con el archivo de respaldo. La eliminación de todos los archivos que se agregaron desde que se realizó la copia de seguridad debe realizarse manualmente. Recreando los sistemas de archivos es una manera fácil de hacer esto.
</p>
<h2>
<span id="Realizar_copia_de_seguridad_con_compresi.C3.B3n_parallel"></span><span class="mw-headline" id="Realizar_copia_de_seguridad_con_compresión_parallel">Realizar copia de seguridad con compresión parallel</span>
</h2>
<p>Para realizar una copia de seguridad con compresión parallel (<a href="https://en.wikipedia.org/wiki/es:Multiprocesamiento_sim%C3%A9trico" class="extiw" title="wikipedia:es:Multiprocesamiento simétrico">SMP</a>), utilice <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pbzip2">pbzip2</a></span> (Parallel bzip2).
</p>
<p>Primero haga una copia de seguridad de los archivos en un archivo tarball simple sin compresión:
</p>
<pre># tar -cvf /<i>ruta_de_destino</i>/etc-backup.tar /etc
</pre>
<p>Luego utilice pbzip2 para comprimirlo con parallel:
</p>
<pre>$ pbzip2 /ruta/a/directorio/elegid/etc-backup.tar.bz2
</pre>
<p>Almacene <code>etc-backup.tar.bz2</code> en uno o más medios sin conexión, como una memoria USB, disco duro externo o CD-R. Ocasionalmente verifique la integridad del proceso de copia de seguridad comparando los archivos y directorios originales con sus copias de seguridad. Posiblemente mantenga una lista de «hashes» de los archivos respaldados para hacer la comparación más rápida.
</p>
<p>Restaure los archivos corruptos de <code>/etc</code> extrayendo el archivo <code>etc-backup.tar.bz2</code> en un directorio de trabajo temporal y copiando archivos y directorios individuales según sea necesario. Para restaurar todo el directorio <code>/etc</code> con todo su contenido, ejecute la siguiente orden como root:
</p>
<pre>tar -xvjf etc-backup.tar.bz2 -C /
</pre>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../es/Category:Backup.html" title="Category:Backup (Español)">Backup (Español)</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Full_system_backup_with_tar_(Espa%C3%B1ol)&amp;oldid=725522">https://wiki.archlinux.org/index.php?title=Full_system_backup_with_tar_(Español)&amp;oldid=725522</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 6 April 2022, at 06:02.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><img src="/resources/assets/poweredby_mediawiki_88x31.png" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul>
		<li>
		<button class="cdx-button cdx-button--icon-only vector-limited-width-toggle" id=""><span class="vector-icon mw-ui-icon-fullScreen mw-ui-icon-wikimedia-fullScreen"></span>

<span>Toggle limited content width</span>
</button>
</li>
	</ul>
</div>
</body>
</html>
