<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-os vector-sticky-header-enabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>ClamAV (Español) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.45.1">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="https://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-ClamAV_Español rootpage-ClamAV_Español skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Instalación" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Instalaci%C3%B3n">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Instalación</span>
			</div>
		</a>
		
		<ul id="toc-Instalación-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Configuración" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Configuraci%C3%B3n">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Configuración</span>
			</div>
		</a>
		
			<button aria-controls="toc-Configuración-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Configuración subsection</span>
			</button>
		
		<ul id="toc-Configuración-sublist" class="vector-toc-list">
			<li id="toc-Habilitación_de_la_protección_en_tiempo_real_OnAccessScan" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Habilitaci%C3%B3n_de_la_protecci%C3%B3n_en_tiempo_real_OnAccessScan">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1</span>
					<span>Habilitación de la protección en tiempo real OnAccessScan</span>
				</div>
			</a>
			
			<ul id="toc-Habilitación_de_la_protección_en_tiempo_real_OnAccessScan-sublist" class="vector-toc-list">
				<li id="toc-Creación_de_notificaciones_emergentes_para_alertas" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Creaci%C3%B3n_de_notificaciones_emergentes_para_alertas">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1.1</span>
					<span>Creación de notificaciones emergentes para alertas</span>
				</div>
			</a>
			
			<ul id="toc-Creación_de_notificaciones_emergentes_para_alertas-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Actualizando_la_base_de_datos" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Actualizando_la_base_de_datos">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Actualizando la base de datos</span>
			</div>
		</a>
		
		<ul id="toc-Actualizando_la_base_de_datos-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Iniciar_el_demonio_ClamAV_+_OnAccessScanning" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Iniciar_el_demonio_ClamAV_+_OnAccessScanning">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">4</span>
				<span>Iniciar el demonio ClamAV + OnAccessScanning</span>
			</div>
		</a>
		
		<ul id="toc-Iniciar_el_demonio_ClamAV_+_OnAccessScanning-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Prueba_del_software" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Prueba_del_software">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">5</span>
				<span>Prueba del software</span>
			</div>
		</a>
		
			<button aria-controls="toc-Prueba_del_software-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Prueba del software subsection</span>
			</button>
		
		<ul id="toc-Prueba_del_software-sublist" class="vector-toc-list">
			<li id="toc-Protección_en_tiempo_real" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Protecci%C3%B3n_en_tiempo_real">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">5.1</span>
					<span>Protección en tiempo real</span>
				</div>
			</a>
			
			<ul id="toc-Protección_en_tiempo_real-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Añadiendo_más_repositorios_de_bases_de_datos/firmas" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#A%C3%B1adiendo_m%C3%A1s_repositorios_de_bases_de_datos/firmas">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">6</span>
				<span>Añadiendo más repositorios de bases de datos/firmas</span>
			</div>
		</a>
		
			<button aria-controls="toc-Añadiendo_más_repositorios_de_bases_de_datos/firmas-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Añadiendo más repositorios de bases de datos/firmas subsection</span>
			</button>
		
		<ul id="toc-Añadiendo_más_repositorios_de_bases_de_datos/firmas-sublist" class="vector-toc-list">
			<li id="toc-Opción_n.°_1:_Configurar_Fangfrisch" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Opci%C3%B3n_n.%C2%B0_1:_Configurar_Fangfrisch">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">6.1</span>
					<span>Opción n.° 1: Configurar Fangfrisch</span>
				</div>
			</a>
			
			<ul id="toc-Opción_n.°_1:_Configurar_Fangfrisch-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Opción_n.°_2:_Configurar_clamav-unofficial-sigs" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Opci%C3%B3n_n.%C2%B0_2:_Configurar_clamav-unofficial-sigs">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">6.2</span>
					<span>Opción n.° 2: Configurar clamav-unofficial-sigs</span>
				</div>
			</a>
			
			<ul id="toc-Opción_n.°_2:_Configurar_clamav-unofficial-sigs-sublist" class="vector-toc-list">
				<li id="toc-Base_de_datos_de_MalwarePatrol" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Base_de_datos_de_MalwarePatrol">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">6.2.1</span>
					<span>Base de datos de MalwarePatrol</span>
				</div>
			</a>
			
			<ul id="toc-Base_de_datos_de_MalwarePatrol-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Análisis_de_virus" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#An%C3%A1lisis_de_virus">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">7</span>
				<span>Análisis de virus</span>
			</div>
		</a>
		
			<button aria-controls="toc-Análisis_de_virus-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Análisis de virus subsection</span>
			</button>
		
		<ul id="toc-Análisis_de_virus-sublist" class="vector-toc-list">
			<li id="toc-usar_el_análisis_independiente" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#usar_el_an%C3%A1lisis_independiente">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">7.1</span>
					<span>usar el análisis independiente</span>
				</div>
			</a>
			
			<ul id="toc-usar_el_análisis_independiente-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-usando_el_demonio" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#usando_el_demonio">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">7.2</span>
					<span>usando el demonio</span>
				</div>
			</a>
			
			<ul id="toc-usando_el_demonio-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Usando_milter" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Usando_milter">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">8</span>
				<span>Usando milter</span>
			</div>
		</a>
		
		<ul id="toc-Usando_milter-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Consejos_y_trucos" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Consejos_y_trucos">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">9</span>
				<span>Consejos y trucos</span>
			</div>
		</a>
		
		<ul id="toc-Consejos_y_trucos-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Ejecutar_en_múltiples_hilos" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Ejecutar_en_m%C3%BAltiples_hilos">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">10</span>
				<span>Ejecutar en múltiples hilos</span>
			</div>
		</a>
		
			<button aria-controls="toc-Ejecutar_en_múltiples_hilos-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Ejecutar en múltiples hilos subsection</span>
			</button>
		
		<ul id="toc-Ejecutar_en_múltiples_hilos-sublist" class="vector-toc-list">
			<li id="toc-Usar_clamscan" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Usar_clamscan">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">10.1</span>
					<span>Usar clamscan</span>
				</div>
			</a>
			
			<ul id="toc-Usar_clamscan-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Uso_de_clamdscan" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Uso_de_clamdscan">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">10.2</span>
					<span>Uso de clamdscan</span>
				</div>
			</a>
			
			<ul id="toc-Uso_de_clamdscan-sublist" class="vector-toc-list">
				<li id="toc-Habilitar_TCPSocket" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Habilitar_TCPSocket">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">10.2.1</span>
					<span>Habilitar TCPSocket</span>
				</div>
			</a>
			
			<ul id="toc-Habilitar_TCPSocket-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Solución_de_problemas" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Soluci%C3%B3n_de_problemas">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">11</span>
				<span>Solución de problemas</span>
			</div>
		</a>
		
			<button aria-controls="toc-Solución_de_problemas-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Solución de problemas subsection</span>
			</button>
		
		<ul id="toc-Solución_de_problemas-sublist" class="vector-toc-list">
			<li id="toc-Error:_Clamd_NO_fue_notificado" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Error:_Clamd_NO_fue_notificado">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">11.1</span>
					<span>Error: Clamd NO fue notificado</span>
				</div>
			</a>
			
			<ul id="toc-Error:_Clamd_NO_fue_notificado-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Error:_No_se_encontraron_archivos_de_base_de_datos_compatibles" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Error:_No_se_encontraron_archivos_de_base_de_datos_compatibles">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">11.2</span>
					<span>Error: No se encontraron archivos de base de datos compatibles</span>
				</div>
			</a>
			
			<ul id="toc-Error:_No_se_encontraron_archivos_de_base_de_datos_compatibles-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Error:_No_se_puede_crear_el_directorio_temporal" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Error:_No_se_puede_crear_el_directorio_temporal">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">11.3</span>
					<span>Error: No se puede crear el directorio temporal</span>
				</div>
			</a>
			
			<ul id="toc-Error:_No_se_puede_crear_el_directorio_temporal-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Véase_también" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#V%C3%A9ase_tambi%C3%A9n">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">12</span>
				<span>Véase también</span>
			</div>
		</a>
		
		<ul id="toc-Véase_también-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar no-font-mode-scale">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left" title="Table of Contents">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">ClamAV (Español)</span></h1>
							
</header>
				<div class="vector-column-end no-font-mode-scale">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From ArchWiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="es" dir="ltr">
<p><a rel="nofollow" class="external text" href="https://www.clamav.net">Clam AntiVirus</a> es un conjunto de herramientas de antivirus de código abierto (GPL) para UNIX. Proporciona una serie de utilidades que incluyen un demonio multiproceso flexible y escalable, un escáner de línea de órdenes y una herramienta avanzada para actualizaciones automáticas de las bases de datos. Debido a que el uso principal de ClamAV es en servidores de archivos/correos electrónicos para escritorios de Windows, detecta principalmente virus y malware de Windows con sus firmas incorporadas.
</p>
<p>La situación actual de los productos antimalware en Linux es inadecuada debido a varios factores:
</p>
<ol>
<li>Variedad limitada: En comparación con Windows, hay menos usuarios/clientes, lo que resulta en un interés limitado de las empresas en desarrollar productos para Linux.</li>
<li>Complacencia: Muchos creen que Linux es intrínsecamente seguro, lo que genera una falta de conocimiento y atención en la protección contra malware. Esto crea una brecha en los mecanismos de defensa proactivos.</li>
<li>Falta de funcionalidades: Las herramientas existentes a menudo carecen de funciones avanzadas, comunes en los productos antimalware de Windows, lo que las hace menos efectivas en Linux.</li>
</ol>
<p>Esto es especialmente grave porque la cantidad de malware en Linux está aumentando, al igual que la posible superficie de ataque debido al creciente número de servidores y dispositivos IoT basados en Linux.
</p>
<p>Actualmente, en Linux, una de las pocas soluciones antimalware existentes y en desarrollo activo es ClamAV.
</p>
<meta property="mw:PageProp/toc">
<div class="mw-heading mw-heading2"><h2 id="Instalación">
<span id="Instalaci.C3.B3n"></span>Instalación</h2></div>
<p><a href="../es/Install.html" class="mw-redirect" title="Install (Español)">Instale</a> el paquete <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=clamav">clamav</a></span>.
</p>
<p>Esto instalará las siguientes herramientas: 
</p>
<pre>clamd: ClamAV Daemon
clamonacc: Protección en tiempo real
clamdscan: Un simple cliente de escaneo
clamdtop: Una interfaz de monitoreo de recursos para clamd
freshclam: Daemon para actualizaciones de firmas de virus
clamconf: Herramienta para crear y comprobar archivos de configuración

</pre>
<p>Todas las herramientas, servicios y demonios relacionados con ClamAV se comunican con clamd vía socket.
</p>
<p>Por defecto esto se hace a través de un socket local configurado y llamado "LocalSocket".
</p>
<p>ClamAV también ofrece la posibilidad de permitir la comunicación a través de ubicaciones remotas mediante el uso de un socket de red que está configurado y los nombres como "TCPSocket". 
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Advertencia</strong>  Tenga en cuenta la siguiente advertencia sobre la seguridad del puerto de almeja al cambiar la configuración para usar TCPSocket en lugar de LocalSocket. Generalmente utilice un socket local unix, pero tenga en cuenta que este puerto no está autenticado o protegido.
<p>Para más detalles, véase:
</p>
<p><a rel="nofollow" class="external free" href="https://blog.clamav.net/2016/06/regarding-use-of-clamav-daemons-tcp.html">https://blog.clamav.net/2016/06/regarding-use-of-clamav-daemons-tcp.html</a>
</p>
<p><a rel="nofollow" class="external free" href="https://docs.clamav.net/manual/Usage/Scanning.html.clamd-v0101">https://docs.clamav.net/manual/Usage/Scanning.html.clamd-v0101</a><sup>[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">enlace roto</a> 2025-08-15]</sup> (Daemon y luego sección ClamD)
</p>
</div>
<p>Otra cosa importante a tener en cuenta es que al usar LocalSocket, clamd deberá ejecutarse bajo un usuario con los permisos adecuados para escanear los archivos que planea incluir en su monitoreo.
</p>
<div class="mw-heading mw-heading2"><h2 id="Configuración">
<span id="Configuraci.C3.B3n"></span>Configuración</h2></div>
<p>Los archivos de configuración predeterminados ya deberían existir. De lo contrario, puede crearlos manualmente con clamconf:
</p>
<pre># clamconf -g freshclam.conf &gt; freshclam.conf
# clamconf -g clamd.conf &gt; clamd.conf
# clamconf -g clamav-milter.conf &gt; clamav-milter.conf
</pre>
<p>Los siguientes archivos contienen las opciones de configuración relevantes.
</p>
<ul>
<li>freshclam: <code>/etc/clamav/freshclam.conf</code>
</li>
<li>clamd: <code>/etc/clamav/clamd.conf</code>
</li>
<li>clamd mail filtering: <code>/etc/clamav/clamav-milter.conf</code>
</li>
</ul>
<p>Por último, puede comprobar sus archivos de configuración ejecutando <code>clamconf</code>.
</p>
<p>La instalación predeterminada creará configuraciones predeterminadas válidas, como el usuario y el grupo de clamav y la configuración de clamd requerida.
</p>
<p>Se pueden establecer configuraciones adicionales recomendadas:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/clamav/clamd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># Registrar la hora con cada mensaje.
# Predeterminado: no
LogTime yes

# Registrar información adicional sobre el archivo infectado, como su tamaño y hash, junto con el nombre del virus.
ExtendedDetectionInfo yes

# Ejecutar como otro usuario (clamd debe iniciarse como root para que esta opción funcione).
# Predeterminado: no perder privilegios.
Usuario clamav

# Se escanean los directorios a la máxima profundidad.
# Predeterminado: 15
MaxDirectoryRecursion 20

DetectPUA yes
HeuristicAlerts yes
ScanPE yes
ScanELF yes
ScanOLE2 yes
ScanPDF yes
ScanSWF yes
ScanXMLDOCS yes
ScanHWP3 yes
ScanOneNote yes
ScanMail yes
ScanHTML yes
ScanArchive yes
Bytecode yes
AlertBrokenExecutables yes
AlertBrokenMedia yes
AlertEncrypted yes
AlertEncryptedArchive yes
AlertEncryptedDoc yes
AlertOLE2Macros yes
AlertPartitionIntersection yes
</pre>
<div class="mw-heading mw-heading3"><h3 id="Habilitación_de_la_protección_en_tiempo_real_OnAccessScan">
<span id="Habilitaci.C3.B3n_de_la_protecci.C3.B3n_en_tiempo_real_OnAccessScan"></span>Habilitación de la protección en tiempo real OnAccessScan</h3></div>
<p>El análisis en tiempo real es el demonio de protección en tiempo real que analiza el archivo mientras lo lee, escribe o ejecuta. Se puede configurar para notificar o prevenir/bloquear la detección.
</p>
<p>La configuración de OnAccessScan se realiza editando el archivo de configuración <code>/etc/clamav/clamd.conf</code>.
</p>
<p>Para que OnAccessScan funcione, se requieren los siguientes cambios:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/clamav/clamd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># Excluir el UID del escáner de la comprobación para evitar bucles
OnAccessExcludeUname clamav
</pre>
<p>Se recomiendan los siguientes cambios adicionales, que activarán el modo de solo notificación del escáner en tiempo real:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/clamav/clamd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">

# Establezca el punto de montaje donde se realizará el análisis recursivo.
# Puede ser cualquier ruta o varias (una línea por ruta).
OnAccessMountPath /

# Alternativamente, agregue directorios en lugar de puntos de montaje.
# OnAccessIncludePath /home

# La prevención no funciona con OnAccessMountPath.
# Funciona con OnAccessIncludePath, siempre que no se incluyan /usr ni /etc.
# Tampoco se recomienda incluir /var al activar la prevención, ya que
# esto ralentizaría la instalación de paquetes por un factor de 1000.
OnAccessPrevention no

# Realiza análisis de archivos recién creados, movidos o renombrados.
OnAccessExtraScanning yes

# Excluye opcionalmente los procesos que pertenecen a la raíz.
# OnAccessExcludeRootUID true
</pre>
<div class="mw-heading mw-heading4"><h4 id="Creación_de_notificaciones_emergentes_para_alertas">
<span id="Creaci.C3.B3n_de_notificaciones_emergentes_para_alertas"></span>Creación de notificaciones emergentes para alertas</h4></div>
<p>Hasta ahora, ClamAV registrará silenciosamente cualquier detección, pero no alertará al usuario. Se puede añadir una ventana emergente para alertar al usuario sobre cualquier detección.
</p>
<p>Primero, agregue la siguiente línea a su configuración de clamd:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/clamav/clamd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"> VirusEvent /etc/clamav/virus-event.bash
</pre>
<p>A continuación, permita que el usuario "clamav" ejecute "notify-send" como cualquier usuario con variables de entorno personalizadas mediante <a href="../en/Sudo.html" title="Sudo">sudo</a>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sudoers.d/clamav</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">clamav ALL = (ALL) NOPASSWD: SETENV: /usr/bin/notify-send</pre>
<p>A continuación, cree el archivo <code>/etc/clamav/virus-event.bash</code>, conviértalo en <a href="../es/Help:Reading.html#Hacer_ejecutable" class="mw-redirect" title="Ejecutable">ejecutable</a> y agregue lo siguiente:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/clamav/virus-event.bash</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash
PATH=/usr/bin
ALERT="Firma detectada por clamav: $CLAM_VIRUSEVENT_VIRUSNAME en $CLAM_VIRUSEVENT_FILENAME"

# Enviar una alerta a Todos los usuarios gráficos.
for ADDRESS in /run/user/*; do
USERID=${ADDRESS#/run/user/}
/usr/bin/sudo -u "#$USERID" DBUS_SESSION_BUS_ADDRESS="unix:path=$ADDRESS/bus" PATH=${PATH} \
/usr/bin/notify-send -u critic -i dialog-warning "¡Virus encontrado!" "$ALERT"
done
</pre>
<p>Esto permite cambiar o especificar el mensaje cuando el servicio de análisis en acceso de clamd detecta un virus.
</p>
<p>Por defecto, "clamonacc" pasa a "clamav" los nombres de los archivos recién accedidos para su análisis. Esto supone un problema, ya que los archivos inaccesibles para el usuario "clamav" no se pueden analizar de esta manera. En su lugar, es posible indicar a "clamonacc" (que siempre se ejecuta como "root") que utilice el paso de descriptores de archivo. <a href="../pt/Systemd.html#Editando_units_fornecidas" class="mw-redirect" title="Editar">Editar</a> <code>clamav-clamonacc.service</code> con lo siguiente:
</p>
<p>[Servicio]
ExecStart=
ExecStart=/usr/sbin/clamonacc -F <b>--fdpass</b> --log=/var/log/clamav/clamonacc.log
</p>
<p>Por último, deberá <a href="../pt/Systemd.html#Usando_units" class="mw-redirect" title="Iniciar/habilitar">iniciar/habilitar</a> o <a href="../pt/Systemd.html#Usando_units" class="mw-redirect" title="Reiniciar">reiniciar</a> <code>clamav-clamonacc.service</code>, así como <code>clamav-daemon.service</code>.
</p>
<p>Consulte: <a href="#Iniciar_el_demonio_ClamAV_+_OnAccessScanning">#Iniciar el demonio ClamAV + OnAccessScanning</a>
</p>
<p>Si recibe denegaciones de <a href="../en/AppArmor.html" title="AppArmor">AppArmor</a> sobre <i>clamd</i>, configure el perfil en modo de solo quejas:
</p>
<ol><li>aa-complain clamd</li></ol>
<div class="mw-heading mw-heading2"><h2 id="Actualizando_la_base_de_datos">Actualizando la base de datos</h2></div>
<p>Actualice las definiciones de virus con:
</p>
<pre># freshclam
</pre>
<p>Si está utilizando un proxy, edite <code>/etc/clamav/freshclam.conf</code> y actualice HTTPProxyServer, HTTPProxyPort, HTTPProxyUsername y HTTPProxyPassword.
</p>
<p>Los archivos de la base de datos se guardan en:
</p>
<ul>
<li>/var/lib/clamav/daily.cld</li>
<li>/var/lib/clamav/main.cld</li>
<li>/var/lib/clamav/bytecode.cvd</li>
</ul>
<p>Para actualizaciones automáticas, primero cree y configure el archivo freshclam.log:
</p>
<pre>touch /var/log/clamav/freshclam.log
chmod 600 /var/log/clamav/freshclam.log
chown clamav /var/log/clamav/freshclam.log
</pre>
<p><a href="../pt/Systemd.html#Usando_units" class="mw-redirect" title="Iniciar/habilitar">Iniciar/habilitar</a> <code>clamav-freshclam.service</code> o <code>clamav-freshclam-once.timer</code> para mantener las definiciones de virus actualizadas.
</p>
<p>El servicio <code>clamav-freshclam.service</code> ejecuta <code>freshclam</code> en modo demonio, con un valor predeterminado de 12 comprobaciones diarias (cada 2 horas). La frecuencia se puede modificar en <code>/etc/clamav/freshclam.conf</code>.
</p>
<p>El temporizador <code>clamav-freshclam-once.timer</code> ejecuta la comprobación de <code>freshclam</code> una vez al día. La frecuencia se puede modificar en <code>/usr/lib/systemd/system/clamav-freshclam-once.timer</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota</strong> 
<ul>
<li>Freshclam en modo demonio realiza comprobaciones cada vez que se inicia un servicio.</li>
<li>Si se realiza más de una comprobación por hora, la CDN lo bloquea durante 24 horas.</li>
<li>La unidad <code>.timer</code> sigue la programación establecida, independientemente de los reinicios o reinicios del servicio. * Puede agregar bases de datos de firmas de virus adicionales siguiendo <a href="#Agregar_m%C3%A1s_bases_de_datos/repositorios_de_firmas">#Agregar más bases de datos/repositorios de firmas</a><sup>[<a href="../en/Help:Procedures.html#Fix_broken_section_links" title="Help:Procedures">enlace roto</a>: sección no válida]</sup>.</li>
</ul>
</div>
<div class="mw-heading mw-heading2"><h2 id="Iniciar_el_demonio_ClamAV_+_OnAccessScanning">
<span id="Iniciar_el_demonio_ClamAV_.2B_OnAccessScanning"></span>Iniciar el demonio ClamAV + OnAccessScanning</h2></div>
<p>Esto cargará todas las firmas de virus en la RAM. A partir de febrero de 2024, estas firmas requieren al menos 1,6 GB de RAM libre. El doble de RAM se utilizará próximamente, durante la actualización periódica de las firmas.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota</strong> 
<ul>
<li>Deberá ejecutar <code>freshclam</code> antes de iniciar el servicio por primera vez; de lo contrario, se producirán problemas o errores que impedirán que ClamAV se inicie correctamente.</li>
<li>El demonio no es necesario si solo desea realizar análisis independientes. Consulte <a href="#An%C3%A1lisis_de_virus">Análisis de virus</a> a continuación.</li>
<li>El demonio por sí solo no realiza ninguna acción a menos que habilite el Análisis en Acceso. Consulte: <a href="#Habilitaci%C3%B3n_de_la_protecci%C3%B3n_en_tiempo_real_OnAccessScan">#Habilitación de la protección en tiempo real OnAccessScan</a>
</li>
</ul>
</div>
<p>El servicio se llama <code>clamav-daemon.service</code>. Inícielo y habilítelo para que se inicie al arrancar el sistema.
</p>
<p>Además, inicie y habilite <code>clamav-clamonacc.service</code> para la protección en tiempo real al acceder.
</p>
<div class="mw-heading mw-heading2"><h2 id="Prueba_del_software">Prueba del software</h2></div>
<p>Para asegurarse de que ClamAV y las definiciones estén instaladas correctamente, escanee el <a rel="nofollow" class="external text" href="https://www.eicar.org/download-anti-malware-testfile/">archivo de prueba EICAR</a> (una firma inofensiva sin código de virus) con "clamscan".
</p>
<pre>$ curl https://secure.eicar.org/eicar.com.txt | clamscan -
</pre>
<p>La salida <b>debe</b> incluir:
</p>
<pre>stdin: Win.Test.EICAR_HDB-1 FOUND
</pre>
<div class="mw-heading mw-heading3"><h3 id="Protección_en_tiempo_real">
<span id="Protecci.C3.B3n_en_tiempo_real"></span>Protección en tiempo real</h3></div>
<p>Puede descargar y guardar el archivo eicar en uno de los directorios que configuró para que Clamonacc monitorizara. Por ejemplo:
</p>
<pre>$ cd /home/user/Downloads/
$ wget https://secure.eicar.org/eicar.com.txt
$ cat eicar.com.txt
</pre>
<div class="mw-heading mw-heading2"><h2 id="Añadiendo_más_repositorios_de_bases_de_datos/firmas">
<span id="A.C3.B1adiendo_m.C3.A1s_repositorios_de_bases_de_datos.2Ffirmas"></span>Añadiendo más repositorios de bases de datos/firmas</h2></div>
<p>ClamAV puede usar bases de datos/firmas de otros repositorios o proveedores de seguridad.
</p>
<p>Para agregar las más importantes en un solo paso, instale <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/clamav-unofficial-sigs/">clamav-unofficial-sigs</a></span><sup><small>AUR</small></sup> (consulte la <a rel="nofollow" class="external text" href="https://github.com/extremeshok/clamav-unofficial-sigs#description">descripción de GitHub</a>) o <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/python-fangfrisch/">python-fangfrisch</a></span><sup><small>AUR</small></sup> (consulte la <a rel="nofollow" class="external text" href="https://rseichter.github.io/fangfrisch/">documentación en línea</a>). Ambos agregarán firmas/bases de datos de proveedores populares, por ejemplo, MalwarePatrol, SecuriteInfo, Yara, Linux Malware Detect, etc.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota</strong> Debe tener el servicio <code>clamav-freshclam.service</code> <a href="../pt/Systemd.html#Usando_units" class="mw-redirect" title="Iniciado">iniciado</a> para obtener actualizaciones de firmas oficiales de los servidores de réplica de ClamAV.</div>
<div class="mw-heading mw-heading3"><h3 id="Opción_n.°_1:_Configurar_Fangfrisch">
<span id="Opci.C3.B3n_n..C2.B0_1:_Configurar_Fangfrisch"></span>Opción n.° 1: Configurar Fangfrisch</h3></div>
<p><a rel="nofollow" class="external text" href="https://rseichter.github.io/fangfrisch/">Fangfrisch</a> se diseñó como un sustituto más seguro, flexible y práctico de clamav-unofficial-sigs y requiere <a rel="nofollow" class="external text" href="https://rseichter.github.io/fangfrisch/#_configuration">muy poca configuración</a> (<code>/etc/fangfrisch/fangfrisch.conf</code>).
</p>
<p>Y lo más importante, Fangfrisch nunca necesita ejecutarse con permisos de root, a diferencia de clamav-unofficial-sigs.
</p>
<p>Cree la estructura de la base de datos ejecutando:
</p>
<pre># sudo -u clamav /usr/bin/fangfrisch --conf /etc/fangfrisch/fangfrisch.conf initdb
</pre>
<p><a href="../pt/Systemd.html#Usando_units" class="mw-redirect" title="Habilitar">Habilitar</a> el <code>fangfrisch.timer</code> (a nivel de sistema).
</p>
<div class="mw-heading mw-heading3"><h3 id="Opción_n.°_2:_Configurar_clamav-unofficial-sigs">
<span id="Opci.C3.B3n_n..C2.B0_2:_Configurar_clamav-unofficial-sigs"></span>Opción n.° 2: Configurar clamav-unofficial-sigs</h3></div>
<p><a href="../pt/Systemd.html#Usando_units" class="mw-redirect" title="Habilitar">Habilitar</a> el <code>clamav-unofficial-sigs.timer</code>.
</p>
<p>Esto actualizará periódicamente las firmas no oficiales según los archivos de configuración del directorio <code>/etc/clamav-unofficial-sigs</code>.
</p>
<p>Para actualizar las firmas manualmente, ejecute lo siguiente:
</p>
<pre># clamav-unofficial-sigs.sh
</pre>
<p>Para cambiar la configuración predeterminada, consulte y modifique <code>/etc/clamav-unofficial-sigs/user.conf</code>.
</p>
<div class="mw-heading mw-heading4"><h4 id="Base_de_datos_de_MalwarePatrol">Base de datos de MalwarePatrol</h4></div>
<p>Si desea utilizar la base de datos de MalwarePatrol, regístrese en <a rel="nofollow" class="external free" href="https://malwareblocklist.org/">https://malwareblocklist.org/</a> (de pago).
</p>
<p>En <code>/etc/clamav-unofficial-sigs/user.conf</code>, modifique lo siguiente para habilitar esta función:
</p>
<pre>malwarepatrol_receipt_code="YOUR-RECEIPT-NUMBER" # Introduzca aquí su número de recibo
malwarepatrol_product_code="8" # Use 8 si tiene una cuenta gratuitar 15 si eres cliente Premium.
malwarepatrol_list="clamav_basic" # clamav_basic o clamav_ext
malwarepatrol_free="yes" # Establécelo en yes si tienes una cuenta gratuita o en no si eres cliente Premium.
</pre>
<p>Fuente: <a rel="nofollow" class="external free" href="https://www.malwarepatrol.net/clamav-configuration-guide/">https://www.malwarepatrol.net/clamav-configuration-guide/</a>
</p>
<div class="mw-heading mw-heading2"><h2 id="Análisis_de_virus">
<span id="An.C3.A1lisis_de_virus"></span>Análisis de virus</h2></div>
<p>Hay dos opciones para el análisis bajo demanda:
</p>
<div class="mw-heading mw-heading3"><h3 id="usar_el_análisis_independiente">
<span id="usar_el_an.C3.A1lisis_independiente"></span>usar el análisis independiente</h3></div>
<p><code>clamscan</code> puede usarse para analizar archivos específicos, directorios de inicio o un sistema completo:
</p>
<pre>$ clamscan myfile
$ clamscan --recursive --infected /home/archie
# clamscan --recursive --infected --exclude-dir='^/sys|^/dev' /
</pre>
<p>Si desea que <code>clamscan</code> elimine el archivo infectado, agregue la opción <code>--remove</code> al comando o puede usar <code>--move=/dir</code> para ponerlo en cuarentena.
</p>
<p>También puede usar <code>clamscan</code> para analizar archivos más grandes. En este caso, añada las opciones <code>--max-filesize=4000M</code> y <code>--max-scansize=4000M</code> al comando. '4000M' es el valor máximo posible y puede reducirse según sea necesario.
</p>
<p>Usar la opción <code>-l /path/to/file</code> imprimirá los registros de <code>clamscan</code> en un archivo de texto para localizar las infecciones reportadas.
</p>
<div class="mw-heading mw-heading3"><h3 id="usando_el_demonio">usando el demonio</h3></div>
<p><code>clamdscan</code> es similar al anterior, pero utiliza el demonio, que debe estar ejecutándose para que el comando funcione. La mayoría de las opciones se ignoran, ya que el demonio lee la configuración especificada en <code>/etc/clamav/clamd.conf</code>.
</p>
<div class="mw-heading mw-heading2"><h2 id="Usando_milter">Usando milter</h2></div>
<p>Milter escaneará su servidor de sendmail en busca de correos electrónicos con virus. Ajuste <code>/etc/clamav/clamav-milter.conf</code> según sus necesidades. Por ejemplo:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/clamav/clamav-milter.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">MilterSocket /tmp/clamav-milter.socket
MilterSocketMode 660
FixStaleSocket yes
Usuario clamav
MilterSocketGroup clamav
PidFile /run/clamav/clamav-milter.pid
TemporaryDirectory /tmp
ClamdSocket unix:/run/clamav/clamd.ctl
LogSyslog yes
LogInfected Basic</pre>
<p>Crear <code>/etc/systemd/system/clamav-milter.service</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/clamav-milter.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Descripción='ClamAV Milter
After=clamav-daemon.service

[Service]
Type=bifurcación
ExecStart=/usr/bin/clamav-milter --config-file /etc/clamav/clamav-milter.conf
Restart=Always

[Install]
WantedBy=multi-user.target</pre>
<p>Su sistema podría requerir una directiva <code>Restart=</code> diferente. Es necesaria, por ejemplo, cuando un automatismo como <a href="../en/Logrotate.html" title="Logrotate">logrotate</a> detiene el servicio.
</p>
<p><a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Enable">Enable</a> y <a href="../en/Help:Reading.html#Control_of_systemd_units" class="mw-redirect" title="Start">start</a> <code>clamav-milter.service</code>.
</p>
<p>Para <a href="../en/Postfix.html" title="Postfix">Postfix</a>, agregue las siguientes líneas a <code>/etc/postfix/main.cf</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/postfix/main.cf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">smtpd_milters = unix:/tmp/clamav-milter.socket
milter_default_action = tempfail</pre>
<p>Compruebe <a href="../en/Systemd/Journal.html" class="mw-redirect" title="Journalctl">journalctl</a> si el permiso de acceso a <code>clamav-milter.socket</code> para Postfix está configurado correctamente. De lo contrario, agregue el usuario Postfix al grupo <code>clamav</code>.
</p>
<div class="mw-heading mw-heading2"><h2 id="Consejos_y_trucos">Consejos y trucos</h2></div>
<div class="mw-heading mw-heading2"><h2 id="Ejecutar_en_múltiples_hilos">
<span id="Ejecutar_en_m.C3.BAltiples_hilos"></span>Ejecutar en múltiples hilos</h2></div>
<div class="mw-heading mw-heading3"><h3 id="Usar_clamscan">Usar clamscan</h3></div>
<p>Al escanear un archivo o directorio desde la línea de comandos con <code>clamscan</code>, solo se utiliza un hilo de la CPU. Esto puede ser adecuado si la sincronización no es crítica o si no desea que el equipo se ralentice. Si necesita escanear rápidamente un directorio grande o una unidad USB, puede usar todas las CPU disponibles para acelerar el proceso.
</p>
<p><code>clamscan</code> está diseñado para un solo subproceso, por lo que <code>xargs</code> puede usarse para ejecutar el escaneo en paralelo:
</p>
<pre>$ find /home/archie -type f -print0 | xargs -0 -P $(nproc) clamscan
</pre>
<p>En este ejemplo, el parámetro <code>-P</code> para <code>xargs</code> ejecuta <code>clamscan</code> en tantos procesos como CPU haya (indicadas por <code>nproc</code>) simultáneamente. Las opciones <code>--max-lines</code> y <code>--max-args</code> permiten un control aún más preciso de la agrupación de la carga de trabajo entre los subprocesos.
</p>
<p>Esto consumirá mucha RAM, ya que cada proceso es individual y cargará los archivos de firma. Un solo hilo consumirá alrededor de 1 GB (o más) de RAM y podría bloquear el equipo a menos que OOM sea lo suficientemente inteligente. Quizás le interese usar clamdscan en su lugar.
</p>
<div class="mw-heading mw-heading3"><h3 id="Uso_de_clamdscan">Uso de clamdscan</h3></div>
<p>Si ya tiene el demonio <code>clamd</code> ejecutándose, puede usar <code>clamdscan</code> en su lugar (consulte <a href="#Iniciar_el_demonio_ClamAV_+_OnAccessScanning">#Iniciar el demonio ClamAV + OnAccessScanning</a>):
</p>
<pre>$ clamdscan --multiscan --fdpass /home/archie
</pre>
<p>Aquí, el parámetro <code>--multiscan</code> permite que <code>clamd</code> escanee el contenido del directorio en paralelo usando los hilos disponibles. El parámetro <code>--fdpass</code> es necesario para transferir los permisos del descriptor de archivo a <code>clamd</code>, ya que el demonio se ejecuta bajo el usuario y grupo <code>clamav</code>.
</p>
<p>El número de subprocesos disponibles para <code>clamdscan</code> se determina en <code>/etc/clamav/clamd.conf</code> mediante el parámetro <code>MaxThreads</code> <span class="plainlinks archwiki-template-man" title="$ man 5 clamd.conf"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/clamd.conf.5">clamd.conf(5)</a></span>. Aunque puede ver que el número de <code>MaxThreads</code> especificado es superior a uno (el valor predeterminado actual es 10), al iniciar el análisis con <code>clamdscan</code> desde la línea de comandos y no especificar la opción <code>--multiscan</code>, solo se usará un subproceso de CPU efectivo para el análisis.
</p>
<div class="mw-heading mw-heading4"><h4 id="Habilitar_TCPSocket">Habilitar TCPSocket</h4></div>
<p>Si habilita TCPSocket en <code>/etc/clamav/clamd.conf</code>, también debe <a href="../pt/Systemd.html#Editando_units_fornecidas" class="mw-redirect" title="Editar">editar</a> <code>clamav-daemon.socket</code> (consulte el error <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/57669">FS#57669</a>). El archivo de socket <a href="../en/Systemd.html" title="Systemd">systemd</a> nDebe configurarse con un puerto y una dirección IP coincidentes:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/clamav-daemon.socket.d/override.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Socket]
ListenStream=
ListenStream=/run/clamav/clamd.ctl
ListenStream=127.0.0.1:3310</pre>
<p>Y finalmente, <a href="../pt/Systemd.html#Usando_units" class="mw-redirect" title="Reinicie">reinicie</a> <code>clamav-daemon.socket</code> para ver un enlace de Clamd en el puerto TCP 3310:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># ss -tulpn | grep clamd</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">tcp LISTEN 0 4096 127.0.0.1:3310 0.0.0.0:* Usuarios:(("clamd",pid=599,fd=4),("systemd",pid=1,fd=44))</pre>
<div class="mw-heading mw-heading2"><h2 id="Solución_de_problemas">
<span id="Soluci.C3.B3n_de_problemas"></span>Solución de problemas</h2></div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota</strong> Asegúrese de que el usuario desde el que ejecuta <code>clamscan</code> tenga permisos de lectura para los archivos de la base de datos (<code>/var/lib/clamav/*.c?d</code>)</div>
<div class="mw-heading mw-heading3"><h3 id="Error:_Clamd_NO_fue_notificado">Error: Clamd NO fue notificado</h3></div>
<p>Si recibe los siguientes mensajes después de ejecutar freshclam:
</p>
<pre>WARNING: Clamd was NOT notified: Cannot connect to clamd through /var/lib/clamav/clamd.sock connect(): No such file or directory
</pre>
<p>Añadir un archivo sock para ClamAV:
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Advertencia</strong> Consulte la advertencia en <a href="#Instalaci%C3%B3n">#Instalación</a> sobre la seguridad del puerto de clamd.</div>
<pre># touch /run/clamav/clamd.ctl
# chown clamav:clamav /run/clamav/clamd.ctl
</pre>
<p>Luego, edite <code>/etc/clamav/clamd.conf</code> y descomente esta línea:
</p>
<pre>LocalSocket /run/clamav/clamd.ctl
</pre>
<p>Guarde el archivo y <a href="../pt/Systemd.html#Usando_units" class="mw-redirect" title="Reinicie">reinicie</a> <code>clamav-daemon.service</code>.
</p>
<div class="mw-heading mw-heading3"><h3 id="Error:_No_se_encontraron_archivos_de_base_de_datos_compatibles">Error: No se encontraron archivos de base de datos compatibles</h3></div>
<p>Si recibe el siguiente error al iniciar el demonio:
</p>
<pre>LibClamAV Error: cli_loaddb(): No supported database files found in /var/lib/clamav ERROR: Not supported data format
</pre>
<p>Esto ocurre debido a una discrepancia entre la configuración <code>/etc/clamav/freshclam.conf</code>, que corresponde a <code>DatabaseDirectory</code>, y la configuración <code>/etc/clamav/clamd.conf</code>, que corresponde a <code>DatabaseDirectory</code>. <code>/etc/clamav/freshclam.conf</code> apunta a <code>/var/lib/clamav</code>, pero <code>/etc/clamav/clamd.conf</code> (directorio predeterminado) apunta a <code>/usr/share/clamav</code> o a otro directorio. Edite en <code>/etc/clamav/clamd.conf</code> y reemplácelo con el mismo <code>DatabaseDirectory</code> que en <code>/etc/clamav/freshclam.conf</code>. Después de eso, "clamav" se iniciará correctamente.
</p>
<div class="mw-heading mw-heading3"><h3 id="Error:_No_se_puede_crear_el_directorio_temporal">Error: No se puede crear el directorio temporal</h3></div>
<p>Si recibe el siguiente error, junto con una "HINT" que contiene un UID y un GID:
</p>
<pre>can't create temporary directory
</pre>
<p>Permisos correctos:
</p>
<pre># chown UID:GID /var/lib/clamav &amp;&amp; chmod 755 /var/lib/clamav
</pre>
<div class="mw-heading mw-heading2"><h2 id="Véase_también">
<span id="V.C3.A9ase_tambi.C3.A9n"></span>Véase también</h2></div>
<ul><li><a href="https://en.wikipedia.org/wiki/ClamAV" class="extiw" title="wikipedia:ClamAV">Wikipedia:ClamAV</a></li></ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../es/Category:Security.html" title="Category:Security (Español)">Security (Español)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li>
<li><a href="../en/Category:Pages_with_broken_section_links.html" title="Category:Pages with broken section links">Pages with broken section links</a></li>
</ul>
</div>
</div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=ClamAV_(Espa%C3%B1ol)&amp;oldid=857685">https://wiki.archlinux.org/index.php?title=ClamAV_(Español)&amp;oldid=857685</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 20 December 2025, at 19:57.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://terms.archlinux.org/docs/privacy-policy/">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/ArchWiki:About.html">About ArchWiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/ArchWiki:General_disclaimer.html">Disclaimers</a></li>
	<li id="footer-places-archwiki-code-of-conduct"><a href="https://terms.archlinux.org/docs/code-of-conduct/" class="extiw" title="archlinux-service-agreements:code-of-conduct">Code of conduct</a></li>
	<li id="footer-places-archwiki-terms-of-service"><a href="https://terms.archlinux.org/docs/terms-of-service/" class="extiw" title="archlinux-service-agreements:terms-of-service">Terms of service</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.gnu.org/copyleft/fdl.html" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><picture><source media="(min-width: 500px)" srcset="/resources/assets/poweredby_mediawiki.svg" width="88" height="31"><img src="/resources/assets/mediawiki_compact.svg" width="25" height="25" loading="lazy"></picture></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-header-container vector-sticky-header-container no-font-mode-scale">
	<div id="vector-sticky-header" class="vector-sticky-header">
		<div class="vector-sticky-header-start">
			<div class="vector-sticky-header-icon-start vector-button-flush-left vector-button-flush-right" aria-hidden="true">
				<button class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-sticky-header-search-toggle" tabindex="-1" data-event-name="ui.vector-sticky-search-form.icon"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
			</button>
		</div>
			
		<div role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box">
			<div class="vector-typeahead-search-container">
				<div class="cdx-typeahead-search cdx-typeahead-search--show-thumbnail">
					<form action="/index.php" id="vector-sticky-search-form" class="cdx-search-input cdx-search-input--has-end-button">
						<div class="cdx-search-input__input-wrapper" data-search-loc="header-moved">
							<div class="cdx-text-input cdx-text-input--has-start-icon">
								<input class="cdx-text-input__input mw-searchInput" autocomplete="off" type="search" name="search" placeholder="Search ArchWiki">
								<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
							</div>
							<input type="hidden" name="title" value="Special:Search">
						</div>
						<button class="cdx-button cdx-search-input__end-button">Search</button>
					</form>
				</div>
			</div>
		</div>
		<div class="vector-sticky-header-context-bar">
				<nav aria-label="Contents" class="vector-toc-landmark">
						
					<div id="vector-sticky-header-toc" class="vector-dropdown mw-portlet mw-portlet-sticky-header-toc vector-sticky-header-toc vector-button-flush-left">
						<input type="checkbox" id="vector-sticky-header-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-sticky-header-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
						<label id="vector-sticky-header-toc-label" for="vector-sticky-header-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
						</label>
						<div class="vector-dropdown-content">
					
						<div id="vector-sticky-header-toc-unpinned-container" class="vector-unpinned-container">
						</div>
					
						</div>
					</div>
			</nav>
				<div class="vector-sticky-header-context-bar-primary" aria-hidden="true"><span class="mw-page-title-main">ClamAV (Español)</span></div>
			</div>
		</div>
		<div class="vector-sticky-header-end" aria-hidden="true">
			<div class="vector-sticky-header-icons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-talk-sticky-header" tabindex="-1" data-event-name="talk-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbles mw-ui-icon-wikimedia-speechBubbles"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-subject-sticky-header" tabindex="-1" data-event-name="subject-sticky-header"><span class="vector-icon mw-ui-icon-article mw-ui-icon-wikimedia-article"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-history-sticky-header" tabindex="-1" data-event-name="history-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-history mw-ui-icon-wikimedia-wikimedia-history"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only mw-watchlink" id="ca-watchstar-sticky-header" tabindex="-1" data-event-name="watch-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-star mw-ui-icon-wikimedia-wikimedia-star"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only reading-lists-bookmark" id="ca-bookmark-sticky-header" tabindex="-1" data-event-name="watch-sticky-bookmark"><span class="vector-icon mw-ui-icon-wikimedia-bookmarkOutline mw-ui-icon-wikimedia-wikimedia-bookmarkOutline"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-edit-sticky-header" tabindex="-1" data-event-name="wikitext-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-wikiText mw-ui-icon-wikimedia-wikimedia-wikiText"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-ve-edit-sticky-header" tabindex="-1" data-event-name="ve-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-edit mw-ui-icon-wikimedia-wikimedia-edit"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-viewsource-sticky-header" tabindex="-1" data-event-name="ve-edit-protected-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-editLock mw-ui-icon-wikimedia-wikimedia-editLock"></span>

<span></span>
			</a>
		</div>
			<div class="vector-sticky-header-buttons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive" id="ca-addsection-sticky-header" tabindex="-1" data-event-name="addsection-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbleAdd-progressive mw-ui-icon-wikimedia-speechBubbleAdd-progressive"></span>

<span>Add topic</span>
			</a>
		</div>
			<div class="vector-sticky-header-icon-end">
				<div class="vector-user-links">
				</div>
			</div>
		</div>
	</div>
</div>
<div class="mw-portlet mw-portlet-dock-bottom emptyPortlet" id="p-dock-bottom">
	<ul>
		
	</ul>
</div>
</body>
</html>
